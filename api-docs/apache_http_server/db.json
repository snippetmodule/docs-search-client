{"index":"<h1>Apache HTTP Server Version 2.4 Documentation</h1>\n<div class=\"category\">\n<h2><a name=\"release\" id=\"release\">Release Notes</a></h2> <ul>\n<li><a href=\"https://httpd.apache.org/docs/2.4/en/new_features_2_4.html\">New features with Apache 2.3/2.4</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/new_features_2_2.html\">New features with Apache 2.1/2.2</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/new_features_2_0.html\">New features with Apache 2.0</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/upgrading.html\">Upgrading to 2.4 from 2.2</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/license.html\">Apache License</a></li> </ul> </div>\n<div class=\"category\">\n<h2><a name=\"manual\" id=\"manual\">Reference Manual</a></h2> <ul>\n<li><a href=\"install\">Compiling and Installing</a></li> <li><a href=\"invoking\">Starting</a></li> <li><a href=\"stopping\">Stopping or Restarting</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/mod/quickreference.html\">Run-time Configuration Directives</a></li> <li><a href=\"mod/index\">Modules</a></li> <li><a href=\"mpm\">Multi-Processing Modules (MPMs)</a></li> <li><a href=\"filter\">Filters</a></li> <li><a href=\"handler\">Handlers</a></li> <li><a href=\"expr\">Expression parser</a></li> <li><a href=\"programs/index\">Server and Supporting Programs</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/glossary.html\">Glossary</a></li> </ul> </div>\n<div class=\"category\">\n<h2><a name=\"usersguide\" id=\"usersguide\">Users' Guide</a></h2> <ul>\n<li><a href=\"getting-started\">Getting Started</a></li> <li><a href=\"bind\">Binding to Addresses and Ports</a></li> <li><a href=\"configuring\">Configuration Files</a></li> <li><a href=\"sections\">Configuration Sections</a></li> <li><a href=\"caching\">Content Caching</a></li> <li><a href=\"content-negotiation\">Content Negotiation</a></li> <li><a href=\"dso\">Dynamic Shared Objects (DSO)</a></li> <li><a href=\"env\">Environment Variables</a></li> <li><a href=\"logs\">Log Files</a></li> <li><a href=\"urlmapping\">Mapping URLs to the Filesystem</a></li> <li><a href=\"misc/perf-tuning\">Performance Tuning</a></li> <li><a href=\"misc/security_tips\">Security Tips</a></li> <li><a href=\"server-wide\">Server-Wide Configuration</a></li> <li><a href=\"ssl/index\">SSL/TLS Encryption</a></li> <li><a href=\"suexec\">Suexec Execution for CGI</a></li> <li><a href=\"rewrite/index\">URL Rewriting with mod_rewrite</a></li> <li><a href=\"vhosts/index\">Virtual Hosts</a></li> </ul> </div>\n<div class=\"category\">\n<h2><a name=\"howto\" id=\"howto\">How-To / Tutorials</a></h2> <ul>\n<li><a href=\"howto/auth\">Authentication and Authorization</a></li> <li><a href=\"howto/access\">Access Control</a></li> <li><a href=\"howto/cgi\">CGI: Dynamic Content</a></li> <li><a href=\"howto/htaccess\">.htaccess files</a></li> <li><a href=\"howto/ssi\">Server Side Includes (SSI)</a></li> <li><a href=\"howto/public_html\">Per-user Web Directories (public_html)</a></li> <li><a href=\"howto/reverse_proxy\">Reverse proxy setup guide</a></li> </ul> </div>\n<div class=\"category\">\n<h2><a name=\"platform\" id=\"platform\">Platform Specific Notes</a></h2> <ul>\n<li><a href=\"platform/windows\">Microsoft Windows</a></li> <li><a href=\"platform/rpm\">RPM-based Systems (Redhat / CentOS / Fedora)</a></li> <li><a href=\"platform/netware\">Novell NetWare</a></li> <li><a href=\"platform/ebcdic\">EBCDIC Port</a></li> </ul> </div>\n<div class=\"category\">\n<h2><a name=\"other\" id=\"other\">Other Topics</a></h2> <ul>\n<li><a href=\"http://wiki.apache.org/httpd/FAQ\">Frequently Asked Questions</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/sitemap.html\">Sitemap</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/developer/\">Documentation for Developers</a></li> <li><a href=\"http://httpd.apache.org/docs-project/\">Helping with the documentation</a></li> <li><a href=\"misc/index\">Other Notes</a></li> <li><a href=\"http://wiki.apache.org/httpd/\">Wiki</a></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/</a>\n  </p>\n</div>\n","install":"<h1>Compiling and Installing</h1>  <p>This document covers compilation and installation of the Apache HTTP Server on Unix and Unix-like systems only. For compiling and installation on Windows, see <a href=\"platform/windows\">Using Apache HTTP Server with Microsoft Windows</a> and <a href=\"platform/win_compiling\">Compiling Apache for Microsoft Windows</a>. For other platforms, see the <a href=\"platform/index\">platform</a> documentation.</p> <p>Apache httpd uses <code>libtool</code> and <code>autoconf</code> to create a build environment that looks like many other Open Source projects.</p> <p>If you are upgrading from one minor version to the next (for example, 2.4.9 to 2.4.10), please skip down to the <a href=\"#upgrading\">upgrading</a> section.</p>     <h2 id=\"overview\">Overview for the impatient</h2> <table> <tr> <td><a href=\"#download\">Download</a></td> <td>\n<pre>$ lynx http://httpd.apache.org/download.cgi</pre> </td> </tr> <tr> <td><a href=\"#extract\">Extract</a></td> <td><pre>$ gzip -d httpd-NN.tar.gz\n$ tar xvf httpd-NN.tar\n$ cd httpd-NN</pre></td> </tr> <tr> <td><a href=\"#configure\">Configure</a></td> <td>\n<pre>$ ./configure --prefix=PREFIX</pre> </td> </tr> <tr> <td><a href=\"#compile\">Compile</a></td> <td>\n<pre>$ make</pre> </td> </tr> <tr> <td><a href=\"#install\">Install</a></td> <td>\n<pre>$ make install</pre> </td> </tr> <tr> <td><a href=\"#customize\">Customize</a></td> <td>\n<pre>$ vi PREFIX/conf/httpd.conf</pre> </td> </tr> <tr> <td><a href=\"#test\">Test</a></td> <td>\n<pre>$ PREFIX/bin/apachectl -k start</pre> </td> </tr> </table> <p><em>NN</em> must be replaced with the current version number, and <em>PREFIX</em> must be replaced with the filesystem path under which the server should be installed. If <em>PREFIX</em> is not specified, it defaults to <code>/usr/local/apache2</code>.</p> <p>Each section of the compilation and installation process is described in more detail below, beginning with the requirements for compiling and installing Apache httpd.</p>   <h2 id=\"requirements\">Requirements</h2> <p>The following requirements exist for building Apache httpd:</p> <dl> <dt>APR and APR-Util</dt> <dd>Make sure you have APR and APR-Util already installed on your system. If you don't, or prefer to not use the system-provided versions, download the latest versions of both APR and APR-Util from <a href=\"http://apr.apache.org/\">Apache APR</a>, unpack them into <code>/httpd_source_tree_root/srclib/apr</code> and <code>/httpd_source_tree_root/srclib/apr-util</code> (be sure the directory names do not have version numbers; for example, the APR distribution must be under /httpd_source_tree_root/srclib/apr/) and use <code>./configure</code>'s <code>--with-included-apr</code> option. On some platforms, you may have to install the corresponding <code>-dev</code> packages to allow httpd to build against your installed copy of APR and APR-Util.</dd> <dt>Perl-Compatible Regular Expressions Library (PCRE)</dt> <dd>This library is required but not longer bundled with httpd. Download the source code from <a href=\"http://www.pcre.org/\">http://www.pcre.org</a>, or install a Port or Package. If your build system can't find the pcre-config script installed by the PCRE build, point to it using the <code>--with-pcre</code> parameter. On some platforms, you may have to install the corresponding <code>-dev</code> package to allow httpd to build against your installed copy of PCRE.</dd> <dt>Disk Space</dt> <dd>Make sure you have at least 50 MB of temporary free disk space available. After installation the server occupies approximately 10 MB of disk space. The actual disk space requirements will vary considerably based on your chosen configuration options, any third-party modules, and, of course, the size of the web site or sites that you have on the server.</dd> <dt>ANSI-C Compiler and Build System</dt> <dd>Make sure you have an ANSI-C compiler installed. The <a href=\"http://gcc.gnu.org/\">GNU C compiler (GCC)</a> from the <a href=\"http://www.gnu.org/\">Free Software Foundation (FSF)</a> is recommended. If you don't have GCC then at least make sure your vendor's compiler is ANSI compliant. In addition, your <code>PATH</code> must contain basic build tools such as <code>make</code>.</dd> <dt>Accurate time keeping</dt> <dd>Elements of the HTTP protocol are expressed as the time of day. So, it's time to investigate setting some time synchronization facility on your system. Usually the <code>ntpdate</code> or <code>xntpd</code> programs are used for this purpose which are based on the Network Time Protocol (NTP). See the <a href=\"http://www.ntp.org\">NTP homepage</a> for more details about NTP software and public time servers.</dd> <dt>\n<a href=\"http://www.perl.org/\">Perl 5</a> [OPTIONAL]</dt> <dd>For some of the support scripts like <code class=\"program\"><a href=\"programs/apxs\">apxs</a></code> or <code class=\"program\"><a href=\"programs/dbmmanage\">dbmmanage</a></code> (which are written in Perl) the Perl 5 interpreter is required (versions 5.003 or newer are sufficient). If no Perl 5 interpreter is found by the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> script, you will not be able to use the affected support scripts. Of course, you will still be able to build and use Apache httpd.</dd> </dl>   <h2 id=\"download\">Download</h2> <p>The Apache HTTP Server can be downloaded from the <a href=\"http://httpd.apache.org/download.cgi\">Apache HTTP Server download site</a>, which lists several mirrors. Most users of Apache on unix-like systems will be better off downloading and compiling a source version. The build process (described below) is easy, and it allows you to customize your server to suit your needs. In addition, binary releases are often not up to date with the latest source releases. If you do download a binary, follow the instructions in the <code>INSTALL.bindist</code> file inside the distribution.</p> <p>After downloading, it is important to verify that you have a complete and unmodified version of the Apache HTTP Server. This can be accomplished by testing the downloaded tarball against the PGP signature. Details on how to do this are available on the <a href=\"http://httpd.apache.org/download.cgi#verify\">download page</a> and an extended example is available describing the <a href=\"http://httpd.apache.org/dev/verification.html\">use of PGP</a>.</p>   <h2 id=\"extract\">Extract</h2> <p>Extracting the source from the Apache HTTP Server tarball is a simple matter of uncompressing, and then untarring:</p> <div class=\"example\"><pre>$ gzip -d httpd-NN.tar.gz\n$ tar xvf httpd-NN.tar</pre></div> <p>This will create a new directory under the current directory containing the source code for the distribution. You should <code>cd</code> into that directory before proceeding with compiling the server.</p>   <h2 id=\"configure\">Configuring the source tree</h2> <p>The next step is to configure the Apache source tree for your particular platform and personal requirements. This is done using the script <code class=\"program\"><a href=\"programs/configure\">configure</a></code> included in the root directory of the distribution. (Developers downloading an unreleased version of the Apache source tree will need to have <code>autoconf</code> and <code>libtool</code> installed and will need to run <code>buildconf</code> before proceeding with the next steps. This is not necessary for official releases.)</p> <p>To configure the source tree using all the default options, simply type <code>./configure</code>. To change the default options, <code class=\"program\"><a href=\"programs/configure\">configure</a></code> accepts a variety of variables and command line options.</p> <p>The most important option is the location <code>--prefix</code> where Apache is to be installed later, because Apache has to be configured for this location to work correctly. More fine-tuned control of the location of files is possible with additional <a href=\"programs/configure#installationdirectories\">configure options</a>.</p> <p>Also at this point, you can specify which <a href=\"programs/configure#optionalfeatures\">features</a> you want included in Apache by enabling and disabling <a href=\"mod/index\">modules</a>. Apache comes with a wide range of modules included by default. They will be compiled as <a href=\"dso\">shared objects (DSOs)</a> which can be loaded or unloaded at runtime. You can also choose to compile modules statically by using the option <code>--enable-module=static</code>.</p> <p>Additional modules are enabled using the <code>--enable-module</code> option, where <var>module</var> is the name of the module with the <code>mod_</code> string removed and with any underscore converted to a dash. Similarly, you can disable modules with the <code>--disable-module</code> option. Be careful when using these options, since <code class=\"program\"><a href=\"programs/configure\">configure</a></code> cannot warn you if the module you specify does not exist; it will simply ignore the option.</p> <p>In addition, it is sometimes necessary to provide the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> script with extra information about the location of your compiler, libraries, or header files. This is done by passing either environment variables or command line options to <code class=\"program\"><a href=\"programs/configure\">configure</a></code>. For more information, see the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> manual page. Or invoke <code class=\"program\"><a href=\"programs/configure\">configure</a></code> using the <code>--help</code> option.</p> <p>For a short impression of what possibilities you have, here is a typical example which compiles Apache for the installation tree <code>/sw/pkg/apache</code> with a particular compiler and flags plus the two additional modules <code class=\"module\"><a href=\"mod/mod_ldap\">mod_ldap</a></code> and <code class=\"module\"><a href=\"mod/mod_lua\">mod_lua</a></code>:</p> <div class=\"example\"><pre>$ CC=\"pgcc\" CFLAGS=\"-O2\" \\\n./configure --prefix=/sw/pkg/apache \\\n--enable-ldap=shared \\\n--enable-lua=shared</pre></div> <p>When <code class=\"program\"><a href=\"programs/configure\">configure</a></code> is run it will take several minutes to test for the availability of features on your system and build Makefiles which will later be used to compile the server.</p> <p>Details on all the different <code class=\"program\"><a href=\"programs/configure\">configure</a></code> options are available on the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> manual page.</p>   <h2 id=\"compile\">Build</h2> <p>Now you can build the various parts which form the Apache package by simply running the command:</p> <div class=\"example\"><pre>$ make</pre></div> <p>Please be patient here, since a base configuration takes several minutes to compile and the time will vary widely depending on your hardware and the number of modules that you have enabled.</p>   <h2 id=\"install\">Install</h2> <p>Now it's time to install the package under the configured installation <em>PREFIX</em> (see <code>--prefix</code> option above) by running:</p> <div class=\"example\"><pre>$ make install</pre></div> <p>This step will typically require root privileges, since <em>PREFIX</em> is usually a directory with restricted write permissions.</p> <p>If you are upgrading, the installation will not overwrite your configuration files or documents.</p>   <h2 id=\"customize\">Customize</h2> <p>Next, you can customize your Apache HTTP server by editing the <a href=\"configuring\">configuration files</a> under <code><em>PREFIX</em>/conf/</code>.</p> <div class=\"example\"><pre>$ vi PREFIX/conf/httpd.conf</pre></div> <p>Have a look at the Apache manual under <code><em>PREFIX</em>/docs/manual/</code> or consult <a href=\"http://httpd.apache.org/docs/2.4/\">http://httpd.apache.org/docs/2.4/</a> for the most recent version of this manual and a complete reference of available <a href=\"https://httpd.apache.org/docs/2.4/en/mod/directives.html\">configuration directives</a>.</p>   <h2 id=\"test\">Test</h2> <p>Now you can <a href=\"invoking\">start</a> your Apache HTTP server by immediately running:</p> <div class=\"example\"><pre>$ PREFIX/bin/apachectl -k start</pre></div> <p>You should then be able to request your first document via the URL <code>http://localhost/</code>. The web page you see is located under the <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code>, which will usually be <code><em>PREFIX</em>/htdocs/</code>. Then <a href=\"stopping\">stop</a> the server again by running:</p> <div class=\"example\"><pre>$ PREFIX/bin/apachectl -k stop</pre></div>   <h2 id=\"upgrading\">Upgrading</h2> <p>The first step in upgrading is to read the release announcement and the file <code>CHANGES</code> in the source distribution to find any changes that may affect your site. When changing between major releases (for example, from 2.0 to 2.2 or from 2.2 to 2.4), there will likely be major differences in the compile-time and run-time configuration that will require manual adjustments. All modules will also need to be upgraded to accommodate changes in the module API.</p> <p>Upgrading from one minor version to the next (for example, from 2.2.55 to 2.2.57) is easier. The <code>make install</code> process will not overwrite any of your existing documents, log files, or configuration files. In addition, the developers make every effort to avoid incompatible changes in the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> options, run-time configuration, or the module API between minor versions. In most cases you should be able to use an identical <code class=\"program\"><a href=\"programs/configure\">configure</a></code> command line, an identical configuration file, and all of your modules should continue to work.</p> <p>To upgrade across minor versions, start by finding the file <code>config.nice</code> in the <code>build</code> directory of your installed server or at the root of the source tree for your old install. This will contain the exact <code class=\"program\"><a href=\"programs/configure\">configure</a></code> command line that you used to configure the source tree. Then to upgrade from one version to the next, you need only copy the <code>config.nice</code> file to the source tree of the new version, edit it to make any desired changes, and then run:</p> <div class=\"example\"><pre>$ ./config.nice\n$ make\n$ make install\n$ PREFIX/bin/apachectl -k graceful-stop\n$ PREFIX/bin/apachectl -k start</pre></div> <div class=\"warning\">You should always test any new version in your environment before putting it into production. For example, you can install and run the new version along side the old one by using a different <code>--prefix</code> and a different port (by adjusting the <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> directive) to test for any incompatibilities before doing the final upgrade.</div> <p>You can pass additional arguments to <code>config.nice</code>, which will be appended to your original <code class=\"program\"><a href=\"programs/configure\">configure</a></code> options:</p> <div class=\"example\"><pre>$ ./config.nice --prefix=/home/test/apache --with-port=90</pre></div>   <h2 id=\"thirdp\">Third-party packages</h2> <p>A large number of third parties provide their own packaged distributions of the Apache HTTP Server for installation on particular platforms. This includes the various Linux distributions, various third-party Windows packages, Mac OS X, Solaris, and many more.</p> <p>Our software license not only permits, but encourages, this kind of redistribution. However, it does result in a situation where the configuration layout and defaults on your installation of the server may differ from what is stated in the documentation. While unfortunate, this situation is not likely to change any time soon.</p> <p>A <a href=\"http://wiki.apache.org/httpd/DistrosDefaultLayout\">description of these third-party distrubutions</a> is maintained in the HTTP Server wiki, and should reflect the current state of these third-party distributions. However, you will need to familiarize yourself with your particular platform's package management and installation procedures.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/install.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/install.html</a>\n  </p>\n</div>\n","invoking":"<h1>Starting Apache</h1>  <p>On Windows, Apache is normally run as a service. For details, see <a href=\"platform/windows#winsvc\">Running Apache as a Service</a>. </p> <p>On Unix, the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> program is run as a daemon that executes continuously in the background to handle requests. This document describes how to invoke <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code>.</p>     <h2 id=\"startup\">How Apache Starts</h2> <p>If the <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> specified in the configuration file is default of 80 (or any other port below 1024), then it is necessary to have root privileges in order to start apache, so that it can bind to this privileged port. Once the server has started and performed a few preliminary activities such as opening its log files, it will launch several <em>child</em> processes which do the work of listening for and answering requests from clients. The main <code>httpd</code> process continues to run as the root user, but the child processes run as a less privileged user. This is controlled by the selected <a href=\"mpm\">Multi-Processing Module</a>.</p> <p>The recommended method of invoking the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> executable is to use the <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> control script. This script sets certain environment variables that are necessary for <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> to function correctly under some operating systems, and then invokes the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> binary. <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> will pass through any command line arguments, so any <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> options may also be used with <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code>. You may also directly edit the <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> script by changing the <code>HTTPD</code> variable near the top to specify the correct location of the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> binary and any command-line arguments that you wish to be <em>always</em> present.</p> <p>The first thing that <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> does when it is invoked is to locate and read the <a href=\"configuring\">configuration file</a> <code>httpd.conf</code>. The location of this file is set at compile-time, but it is possible to specify its location at run time using the <code>-f</code> command-line option as in</p> <div class=\"example\"><pre>/usr/local/apache2/bin/apachectl -f /usr/local/apache2/conf/httpd.conf</pre></div> <p>If all goes well during startup, the server will detach from the terminal and the command prompt will return almost immediately. This indicates that the server is up and running. You can then use your browser to connect to the server and view the test page in the <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> directory.</p>   <h2 id=\"errors\">Errors During Start-up</h2> <p>If Apache suffers a fatal problem during startup, it will write a message describing the problem either to the console or to the <code class=\"directive\"><a href=\"mod/core#errorlog\">ErrorLog</a></code> before exiting. One of the most common error messages is \"<code>Unable to bind to Port ...</code>\". This message is usually caused by either:</p> <ul> <li>Trying to start the server on a privileged port when not logged in as the root user; or</li> <li>Trying to start the server when there is another instance of Apache or some other web server already bound to the same Port.</li> </ul> <p>For further trouble-shooting instructions, consult the Apache <a href=\"http://wiki.apache.org/httpd/FAQ\">FAQ</a>.</p>   <h2 id=\"boot\">Starting at Boot-Time</h2> <p>If you want your server to continue running after a system reboot, you should add a call to <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> to your system startup files (typically <code>rc.local</code> or a file in an <code>rc.N</code> directory). This will start Apache as root. Before doing this ensure that your server is properly configured for security and access restrictions.</p> <p>The <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> script is designed to act like a standard SysV init script; it can take the arguments <code>start</code>, <code>restart</code>, and <code>stop</code> and translate them into the appropriate signals to <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code>. So you can often simply link <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> into the appropriate init directory. But be sure to check the exact requirements of your system.</p>   <h2 id=\"info\">Additional Information</h2> <p>Additional information about the command-line options of <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> and <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> as well as other support programs included with the server is available on the <a href=\"programs/index\">Server and Supporting Programs</a> page. There is also documentation on all the <a href=\"mod/index\">modules</a> included with the Apache distribution and the <a href=\"https://httpd.apache.org/docs/2.4/en/mod/directives.html\">directives</a> that they provide.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/invoking.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/invoking.html</a>\n  </p>\n</div>\n","mpm":"<h1>Multi-Processing Modules (MPMs)</h1>  <p>This document describes what a Multi-Processing Module is and how they are used by the Apache HTTP Server.</p>     <h2 id=\"introduction\">Introduction</h2> <p>The Apache HTTP Server is designed to be a powerful and flexible web server that can work on a very wide variety of platforms in a range of different environments. Different platforms and different environments often require different features, or may have different ways of implementing the same feature most efficiently. Apache httpd has always accommodated a wide variety of environments through its modular design. This design allows the webmaster to choose which features will be included in the server by selecting which modules to load either at compile-time or at run-time.</p> <p>Apache HTTP Server 2.0 extends this modular design to the most basic functions of a web server. The server ships with a selection of Multi-Processing Modules (MPMs) which are responsible for binding to network ports on the machine, accepting requests, and dispatching children to handle the requests.</p> <p>Extending the modular design to this level of the server allows two important benefits:</p> <ul> <li>Apache httpd can more cleanly and efficiently support a wide variety of operating systems. In particular, the Windows version of the server is now much more efficient, since <code class=\"module\"><a href=\"mod/mpm_winnt\">mpm_winnt</a></code> can use native networking features in place of the POSIX layer used in Apache httpd 1.3. This benefit also extends to other operating systems that implement specialized MPMs.</li> <li>The server can be better customized for the needs of the particular site. For example, sites that need a great deal of scalability can choose to use a threaded MPM like <code class=\"module\"><a href=\"mod/worker\">worker</a></code> or <code class=\"module\"><a href=\"mod/event\">event</a></code>, while sites requiring stability or compatibility with older software can use a <code class=\"module\"><a href=\"mod/prefork\">prefork</a></code>.</li> </ul> <p>At the user level, MPMs appear much like other Apache httpd modules. The main difference is that one and only one MPM must be loaded into the server at any time. The list of available MPMs appears on the <a href=\"mod/index\">module index page</a>.</p>   <h2 id=\"defaults\">MPM Defaults</h2> <p>The following table lists the default MPMs for various operating systems. This will be the MPM selected if you do not make another choice at compile-time.</p> <table class=\"bordered\">\n<tr>\n<td>Netware</td>\n<td><code class=\"module\">mpm_netware</code></td>\n</tr> <tr class=\"odd\">\n<td>OS/2</td>\n<td><code class=\"module\">mpmt_os2</code></td>\n</tr> <tr>\n<td>Unix</td>\n<td>\n<code class=\"module\"><a href=\"mod/prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mod/worker\">worker</a></code>, or <code class=\"module\"><a href=\"mod/event\">event</a></code>, depending on platform capabilities</td>\n</tr> <tr class=\"odd\">\n<td>Windows</td>\n<td><code class=\"module\">mpm_winnt</code></td>\n</tr> </table> <div class=\"note\"><p>Here, 'Unix' is used to mean Unix-like operating systems, such as Linux, BSD, Solaris, Mac OS X, etc.</p></div> <p>In the case of Unix, the decision as to which MPM is installed is based on two questions:</p> <p>1. Does the system support threads?</p> <p>2. Does the system support thread-safe polling (Specifically, the kqueue and epoll functions)?</p> <p>If the answer to both questions is 'yes', the default MPM is <code class=\"module\"><a href=\"mod/event\">event</a></code>.</p> <p>If The answer to #1 is 'yes', but the answer to #2 is 'no', the default will be <code class=\"module\"><a href=\"mod/worker\">worker</a></code>.</p> <p>If the answer to both questions is 'no', then the default MPM will be <code class=\"module\"><a href=\"mod/prefork\">prefork</a></code>.</p> <p>In practical terms, this means that the default will almost always be <code class=\"module\"><a href=\"mod/event\">event</a></code>, as all modern operating systems support these two features.</p>   <h2 id=\"static\">Building an MPM as a static module</h2> <p>MPMs can be built as static modules on all platforms. A single MPM is chosen at build time and linked into the server. The server must be rebuilt in order to change the MPM.</p> <p>To override the default MPM choice, use the <code>--with-mpm=<em>NAME</em></code> option of the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> script. <em>NAME</em> is the name of the desired MPM.</p> <p>Once the server has been compiled, it is possible to determine which MPM was chosen by using <code>./httpd -l</code>. This command will list every module that is compiled into the server, including the MPM.</p>   <h2 id=\"dynamic\">Building an MPM as a DSO module</h2> <p>On Unix and similar platforms, MPMs can be built as DSO modules and dynamically loaded into the server in the same manner as other DSO modules. Building MPMs as DSO modules allows the MPM to be changed by updating the <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> directive for the MPM instead of by rebuilding the server.</p> <pre class=\"prettyprint lang-config\">LoadModule mpm_prefork_module modules/mod_mpm_prefork.so</pre> <p>Attempting to <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> more than one MPM will result in a startup failure with the following error.</p> <div class=\"example\"><pre>AH00534: httpd: Configuration error: More than one MPM loaded.</pre></div> <p>This feature is enabled using the <code>--enable-mpms-shared</code> option of the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> script. With argument <code><em>all</em></code>, all possible MPMs for the platform will be installed. Alternately, a list of MPMs can be specified as the argument.</p> <p>The default MPM, either selected automatically or specified with the <code>--with-mpm</code> option of the <code class=\"program\"><a href=\"programs/configure\">configure</a></code> script, will be loaded in the generated server configuration file. Edit the <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> directive to select a different MPM.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mpm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mpm.html</a>\n  </p>\n</div>\n","handler":"<h1>Apache's Handler Use</h1>  <p>This document describes the use of Apache's Handlers.</p>     <h2 id=\"definition\">What is a Handler</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_actions\">mod_actions</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_asis\">mod_asis</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_cgi\">mod_cgi</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_imagemap\">mod_imagemap</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_info\">mod_info</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_mime\">mod_mime</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_status\">mod_status</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_actions#action\">Action</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_mime#addhandler\">AddHandler</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_mime#removehandler\">RemoveHandler</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#sethandler\">SetHandler</a></code></li>\n</ul></td>\n</tr>\n</table> <p>A \"handler\" is an internal Apache representation of the action to be performed when a file is called. Generally, files have implicit handlers, based on the file type. Normally, all files are simply served by the server, but certain file types are \"handled\" separately.</p> <p>Handlers may also be configured explicitly, based on either filename extensions or on location, without relation to file type. This is advantageous both because it is a more elegant solution, and because it also allows for both a type <strong>and</strong> a handler to be associated with a file. (See also <a href=\"mod/mod_mime#multipleext\">Files with Multiple Extensions</a>.)</p> <p>Handlers can either be built into the server or included in a module, or they can be added with the <code class=\"directive\"><a href=\"mod/mod_actions#action\">Action</a></code> directive. The built-in handlers in the standard distribution are as follows:</p> <ul> <li>\n<strong>default-handler</strong>: Send the file using the <code>default_handler()</code>, which is the handler used by default to handle static content. (core)</li> <li>\n<strong>send-as-is</strong>: Send file with HTTP headers as is. (<code class=\"module\"><a href=\"mod/mod_asis\">mod_asis</a></code>)</li> <li>\n<strong>cgi-script</strong>: Treat the file as a CGI script. (<code class=\"module\"><a href=\"mod/mod_cgi\">mod_cgi</a></code>)</li> <li>\n<strong>imap-file</strong>: Parse as an imagemap rule file. (<code class=\"module\"><a href=\"mod/mod_imagemap\">mod_imagemap</a></code>)</li> <li>\n<strong>server-info</strong>: Get the server's configuration information. (<code class=\"module\"><a href=\"mod/mod_info\">mod_info</a></code>)</li> <li>\n<strong>server-status</strong>: Get the server's status report. (<code class=\"module\"><a href=\"mod/mod_status\">mod_status</a></code>)</li> <li>\n<strong>type-map</strong>: Parse as a type map file for content negotiation. (<code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code>)</li> </ul>   <h2 id=\"examples\">Examples</h2> <h3><a name=\"example1\" id=\"example1\">Modifying static content using a CGI script</a></h3> <p>The following directives will cause requests for files with the <code>html</code> extension to trigger the launch of the <code>footer.pl</code> CGI script.</p> <pre class=\"prettyprint lang-config\">Action add-footer /cgi-bin/footer.pl\nAddHandler add-footer .html</pre> <p>Then the CGI script is responsible for sending the originally requested document (pointed to by the <code>PATH_TRANSLATED</code> environment variable) and making whatever modifications or additions are desired.</p> <h3><a name=\"example2\" id=\"example2\">Files with HTTP headers</a></h3> <p>The following directives will enable the <code>send-as-is</code> handler, which is used for files which contain their own HTTP headers. All files in the <code>/web/htdocs/asis/</code> directory will be processed by the <code>send-as-is</code> handler, regardless of their filename extensions.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/web/htdocs/asis\"&gt;\n    SetHandler send-as-is\n&lt;/Directory&gt;</pre>   <h2 id=\"programmer\">Programmer's Note</h2> <p>In order to implement the handler features, an addition has been made to the <a href=\"https://httpd.apache.org/docs/2.4/en/developer/API.html\">Apache API</a> that you may wish to make use of. Specifically, a new record has been added to the <code>request_rec</code> structure:</p> <pre class=\"prettyprint lang-c\">char *handler</pre> <p>If you wish to have your module engage a handler, you need only to set <code>r-&gt;handler</code> to the name of the handler at any time prior to the <code>invoke_handler</code> stage of the request. Handlers are implemented as they were before, albeit using the handler name instead of a content type. While it is not necessary, the naming convention for handlers is to use a dash-separated word, with no slashes, so as to not invade the media type name-space.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/handler.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/handler.html</a>\n  </p>\n</div>\n","misc/security_tips":"<h1>Security Tips</h1>  <p>Some hints and tips on security issues in setting up a web server. Some of the suggestions will be general, others specific to Apache.</p>     <h2 id=\"uptodate\">Keep up to Date</h2> <p>The Apache HTTP Server has a good record for security and a developer community highly concerned about security issues. But it is inevitable that some problems -- small or large -- will be discovered in software after it is released. For this reason, it is crucial to keep aware of updates to the software. If you have obtained your version of the HTTP Server directly from Apache, we highly recommend you subscribe to the <a href=\"http://httpd.apache.org/lists.html#http-announce\">Apache HTTP Server Announcements List</a> where you can keep informed of new releases and security updates. Similar services are available from most third-party distributors of Apache software.</p> <p>Of course, most times that a web server is compromised, it is not because of problems in the HTTP Server code. Rather, it comes from problems in add-on code, CGI scripts, or the underlying Operating System. You must therefore stay aware of problems and updates with all the software on your system.</p>   <h2 id=\"dos\">Denial of Service (DoS) attacks</h2> <p>All network servers can be subject to denial of service attacks that attempt to prevent responses to clients by tying up the resources of the server. It is not possible to prevent such attacks entirely, but you can do certain things to mitigate the problems that they create.</p> <p>Often the most effective anti-DoS tool will be a firewall or other operating-system configurations. For example, most firewalls can be configured to restrict the number of simultaneous connections from any individual IP address or network, thus preventing a range of simple attacks. Of course this is no help against Distributed Denial of Service attacks (DDoS).</p> <p>There are also certain Apache HTTP Server configuration settings that can help mitigate problems:</p> <ul> <li>The <code class=\"directive\"><a href=\"../mod/mod_reqtimeout#requestreadtimeout\">RequestReadTimeout</a></code> directive allows to limit the time a client may take to send the request.</li> <li>The <code class=\"directive\"><a href=\"../mod/core#timeout\">TimeOut</a></code> directive should be lowered on sites that are subject to DoS attacks. Setting this to as low as a few seconds may be appropriate. As <code class=\"directive\"><a href=\"../mod/core#timeout\">TimeOut</a></code> is currently used for several different operations, setting it to a low value introduces problems with long running CGI scripts.</li> <li>The <code class=\"directive\"><a href=\"../mod/core#keepalivetimeout\">KeepAliveTimeout</a></code> directive may be also lowered on sites that are subject to DoS attacks. Some sites even turn off the keepalives completely via <code class=\"directive\"><a href=\"../mod/core#keepalive\">KeepAlive</a></code>, which has of course other drawbacks on performance.</li> <li>The values of various timeout-related directives provided by other modules should be checked.</li> <li>The directives <code class=\"directive\"><a href=\"../mod/core#limitrequestbody\">LimitRequestBody</a></code>, <code class=\"directive\"><a href=\"../mod/core#limitrequestfields\">LimitRequestFields</a></code>, <code class=\"directive\"><a href=\"../mod/core#limitrequestfieldsize\">LimitRequestFieldSize</a></code>, <code class=\"directive\"><a href=\"../mod/core#limitrequestline\">LimitRequestLine</a></code>, and <code class=\"directive\"><a href=\"../mod/core#limitxmlrequestbody\">LimitXMLRequestBody</a></code> should be carefully configured to limit resource consumption triggered by client input.</li> <li>On operating systems that support it, make sure that you use the <code class=\"directive\"><a href=\"../mod/core#acceptfilter\">AcceptFilter</a></code> directive to offload part of the request processing to the operating system. This is active by default in Apache httpd, but may require reconfiguration of your kernel.</li> <li>Tune the <code class=\"directive\"><a href=\"../mod/mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> directive to allow the server to handle the maximum number of simultaneous connections without running out of resources. See also the <a href=\"perf-tuning\">performance tuning documentation</a>.</li> <li>The use of a threaded <a href=\"../mpm\">mpm</a> may allow you to handle more simultaneous connections, thereby mitigating DoS attacks. Further, the <code class=\"module\"><a href=\"../mod/event\">event</a></code> mpm uses asynchronous processing to avoid devoting a thread to each connection. Due to the nature of the OpenSSL library the <code class=\"module\"><a href=\"../mod/event\">event</a></code> mpm is currently incompatible with <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> and other input filters. In these cases it falls back to the behaviour of the <code class=\"module\"><a href=\"../mod/worker\">worker</a></code> mpm.</li> <li>There are a number of third-party modules available through <a href=\"http://modules.apache.org/\">http://modules.apache.org/</a> that can restrict certain client behaviors and thereby mitigate DoS problems.</li> </ul>   <h2 id=\"serverroot\">Permissions on ServerRoot Directories</h2> <p>In typical operation, Apache is started by the root user, and it switches to the user defined by the <code class=\"directive\"><a href=\"../mod/mod_unixd#user\">User</a></code> directive to serve hits. As is the case with any command that root executes, you must take care that it is protected from modification by non-root users. Not only must the files themselves be writeable only by root, but so must the directories, and parents of all directories. For example, if you choose to place ServerRoot in <code>/usr/local/apache</code> then it is suggested that you create that directory as root, with commands like these:</p> <div class=\"example\"><pre>mkdir /usr/local/apache \ncd /usr/local/apache \nmkdir bin conf logs \nchown 0 . bin conf logs \nchgrp 0 . bin conf logs \nchmod 755 . bin conf logs</pre></div> <p>It is assumed that <code>/</code>, <code>/usr</code>, and <code>/usr/local</code> are only modifiable by root. When you install the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> executable, you should ensure that it is similarly protected:</p> <div class=\"example\"><pre>cp httpd /usr/local/apache/bin \nchown 0 /usr/local/apache/bin/httpd \nchgrp 0 /usr/local/apache/bin/httpd \nchmod 511 /usr/local/apache/bin/httpd</pre></div> <p>You can create an htdocs subdirectory which is modifiable by other users -- since root never executes any files out of there, and shouldn't be creating files in there.</p> <p>If you allow non-root users to modify any files that root either executes or writes on then you open your system to root compromises. For example, someone could replace the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> binary so that the next time you start it, it will execute some arbitrary code. If the logs directory is writeable (by a non-root user), someone could replace a log file with a symlink to some other system file, and then root might overwrite that file with arbitrary data. If the log files themselves are writeable (by a non-root user), then someone may be able to overwrite the log itself with bogus data.</p>   <h2 id=\"ssi\">Server Side Includes</h2> <p>Server Side Includes (SSI) present a server administrator with several potential security risks.</p> <p>The first risk is the increased load on the server. All SSI-enabled files have to be parsed by Apache, whether or not there are any SSI directives included within the files. While this load increase is minor, in a shared server environment it can become significant.</p> <p>SSI files also pose the same risks that are associated with CGI scripts in general. Using the <code>exec cmd</code> element, SSI-enabled files can execute any CGI script or program under the permissions of the user and group Apache runs as, as configured in <code>httpd.conf</code>.</p> <p>There are ways to enhance the security of SSI files while still taking advantage of the benefits they provide.</p> <p>To isolate the damage a wayward SSI file can cause, a server administrator can enable <a href=\"../suexec\">suexec</a> as described in the <a href=\"#cgi\">CGI in General</a> section.</p> <p>Enabling SSI for files with <code>.html</code> or <code>.htm</code> extensions can be dangerous. This is especially true in a shared, or high traffic, server environment. SSI-enabled files should have a separate extension, such as the conventional <code>.shtml</code>. This helps keep server load at a minimum and allows for easier management of risk.</p> <p>Another solution is to disable the ability to run scripts and programs from SSI pages. To do this replace <code>Includes</code> with <code>IncludesNOEXEC</code> in the <code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code> directive. Note that users may still use <code>&lt;--#include virtual=\"...\" --&gt;</code> to execute CGI scripts if these scripts are in directories designated by a <code class=\"directive\"><a href=\"../mod/mod_alias#scriptalias\">ScriptAlias</a></code> directive.</p>   <h2 id=\"cgi\">CGI in General</h2> <p>First of all, you always have to remember that you must trust the writers of the CGI scripts/programs or your ability to spot potential security holes in CGI, whether they were deliberate or accidental. CGI scripts can run essentially arbitrary commands on your system with the permissions of the web server user and can therefore be extremely dangerous if they are not carefully checked.</p> <p>All the CGI scripts will run as the same user, so they have potential to conflict (accidentally or deliberately) with other scripts e.g. User A hates User B, so he writes a script to trash User B's CGI database. One program which can be used to allow scripts to run as different users is <a href=\"../suexec\">suEXEC</a> which is included with Apache as of 1.2 and is called from special hooks in the Apache server code. Another popular way of doing this is with <a href=\"http://cgiwrap.sourceforge.net/\">CGIWrap</a>.</p>   <h2 id=\"nsaliasedcgi\">Non Script Aliased CGI</h2> <p>Allowing users to execute CGI scripts in any directory should only be considered if:</p> <ul> <li>You trust your users not to write scripts which will deliberately or accidentally expose your system to an attack.</li> <li>You consider security at your site to be so feeble in other areas, as to make one more potential hole irrelevant.</li> <li>You have no users, and nobody ever visits your server.</li> </ul>   <h2 id=\"saliasedcgi\">Script Aliased CGI</h2> <p>Limiting CGI to special directories gives the admin control over what goes into those directories. This is inevitably more secure than non script aliased CGI, but only if users with write access to the directories are trusted or the admin is willing to test each new CGI script/program for potential security holes.</p> <p>Most sites choose this option over the non script aliased CGI approach.</p>   <h2 id=\"dynamic\">Other sources of dynamic content</h2> <p>Embedded scripting options which run as part of the server itself, such as <code>mod_php</code>, <code>mod_perl</code>, <code>mod_tcl</code>, and <code>mod_python</code>, run under the identity of the server itself (see the <code class=\"directive\"><a href=\"../mod/mod_unixd#user\">User</a></code> directive), and therefore scripts executed by these engines potentially can access anything the server user can. Some scripting engines may provide restrictions, but it is better to be safe and assume not.</p>   <h2 id=\"dynamicsec\">Dynamic content security</h2> <p>When setting up dynamic content, such as <code>mod_php</code>, <code>mod_perl</code> or <code>mod_python</code>, many security considerations get out of the scope of <code>httpd</code> itself, and you need to consult documentation from those modules. For example, PHP lets you setup <a href=\"http://www.php.net/manual/en/ini.sect.safe-mode.php\">Safe Mode</a>, which is most usually disabled by default. Another example is <a href=\"http://www.hardened-php.net/suhosin/\">Suhosin</a>, a PHP addon for more security. For more information about those, consult each project documentation.</p> <p>At the Apache level, a module named <a href=\"http://modsecurity.org/\">mod_security</a> can be seen as a HTTP firewall and, provided you configure it finely enough, can help you enhance your dynamic content security.</p>   <h2 id=\"systemsettings\">Protecting System Settings</h2> <p>To run a really tight ship, you'll want to stop users from setting up <code>.htaccess</code> files which can override security features you've configured. Here's one way to do it.</p> <p>In the server configuration file, put</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/\"&gt;\n    AllowOverride None\n&lt;/Directory&gt;</pre> <p>This prevents the use of <code>.htaccess</code> files in all directories apart from those specifically enabled.</p> <p>Note that this setting is the default since Apache 2.3.9.</p>   <h2 id=\"protectserverfiles\">Protect Server Files by Default</h2> <p>One aspect of Apache which is occasionally misunderstood is the feature of default access. That is, unless you take steps to change it, if the server can find its way to a file through normal URL mapping rules, it can serve it to clients.</p> <p>For instance, consider the following example:</p> <div class=\"example\"><pre># cd /; ln -s / public_html \nAccessing http://localhost/~root/</pre></div> <p>This would allow clients to walk through the entire filesystem. To work around this, add the following block to your server's configuration:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/\"&gt;\n    Require all denied\n&lt;/Directory&gt;</pre> <p>This will forbid default access to filesystem locations. Add appropriate <code class=\"directive\"><a href=\"../mod/core#directory\">Directory</a></code> blocks to allow access only in those areas you wish. For example,</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/usr/users/*/public_html\"&gt;\n    Require all granted\n&lt;/Directory&gt;\n&lt;Directory \"/usr/local/httpd\"&gt;\n    Require all granted\n&lt;/Directory&gt;</pre> <p>Pay particular attention to the interactions of <code class=\"directive\"><a href=\"../mod/core#location\">Location</a></code> and <code class=\"directive\"><a href=\"../mod/core#directory\">Directory</a></code> directives; for instance, even if <code>&lt;Directory \"/\"&gt;</code> denies access, a <code>&lt;Location \"/\"&gt;</code> directive might overturn it.</p> <p>Also be wary of playing games with the <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> directive; setting it to something like <code>./</code> would have the same effect, for root, as the first example above. We strongly recommend that you include the following line in your server configuration files:</p> <pre class=\"prettyprint lang-config\">UserDir disabled root</pre>   <h2 id=\"watchyourlogs\">Watching Your Logs</h2> <p>To keep up-to-date with what is actually going on against your server you have to check the <a href=\"../logs\">Log Files</a>. Even though the log files only reports what has already happened, they will give you some understanding of what attacks is thrown against the server and allow you to check if the necessary level of security is present.</p> <p>A couple of examples:</p> <div class=\"example\"><pre>grep -c \"/jsp/source.jsp?/jsp/ /jsp/source.jsp??\" access_log \ngrep \"client denied\" error_log | tail -n 10</pre></div> <p>The first example will list the number of attacks trying to exploit the <a href=\"http://online.securityfocus.com/bid/4876/info/\">Apache Tomcat Source.JSP Malformed Request Information Disclosure Vulnerability</a>, the second example will list the ten last denied clients, for example:</p> <div class=\"example\"><pre>[Thu Jul 11 17:18:39 2002] [error] [client foo.example.com] client denied by server configuration: /usr/local/apache/htdocs/.htpasswd</pre></div> <p>As you can see, the log files only report what already has happened, so if the client had been able to access the <code>.htpasswd</code> file you would have seen something similar to:</p> <div class=\"example\"><pre>foo.example.com - - [12/Jul/2002:01:59:13 +0200] \"GET /.htpasswd HTTP/1.1\"</pre></div> <p>in your <a href=\"../logs#accesslog\">Access Log</a>. This means you probably commented out the following in your server configuration file:</p> <pre class=\"prettyprint lang-config\">&lt;Files \".ht*\"&gt;\n    Require all denied\n&lt;/Files&gt;</pre>   <h2 id=\"merging\">Merging of configuration sections</h2> <p> The merging of configuration sections is complicated and sometimes directive specific. Always test your changes when creating dependencies on how directives are merged.</p> <p> For modules that don't implement any merging logic, such as <code class=\"directive\">mod_access_compat</code>, the behavior in later sections depends on whether the later section has any directives from the module. The configuration is inherited until a change is made, at which point the configuration is <em>replaced</em> and not merged.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/misc/security_tips.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/misc/security_tips.html</a>\n  </p>\n</div>\n","mod/index":"<h1>Module Index</h1>  <p> Below is a list of all of the modules that come as part of the Apache HTTP Server distribution. See also the complete alphabetical list of <a href=\"https://httpd.apache.org/docs/2.4/en/mod/directives.html\">all Apache HTTP Server directives</a>. </p>    <h2 id=\"core\">Core Features and Multi-Processing Modules</h2> <dl> <dt><a href=\"core\">core</a></dt>\n<dd>Core Apache HTTP Server features that are always available</dd> <dt><a href=\"mpm_common\">mpm_common</a></dt>\n<dd class=\"separate\">A collection of directives that are implemented by more than one multi-processing module (MPM)</dd> <dt><a href=\"event\">event</a></dt>\n<dd>A variant of the <code class=\"module\"><a href=\"worker\">worker</a></code> MPM with the goal of consuming threads only for connections with active processing</dd> <dt><a href=\"mpm_netware\">mpm_netware</a></dt>\n<dd>Multi-Processing Module implementing an exclusively threaded web server optimized for Novell NetWare</dd> <dt><a href=\"mpmt_os2\">mpmt_os2</a></dt>\n<dd>Hybrid multi-process, multi-threaded MPM for OS/2</dd> <dt><a href=\"prefork\">prefork</a></dt>\n<dd>Implements a non-threaded, pre-forking web server</dd> <dt><a href=\"mpm_winnt\">mpm_winnt</a></dt>\n<dd>Multi-Processing Module optimized for Windows NT.</dd> <dt><a href=\"worker\">worker</a></dt>\n<dd>Multi-Processing Module implementing a hybrid multi-threaded multi-process web server</dd> </dl>  <h2 id=\"other\">Other Modules</h2> <p class=\"letters\"><a href=\"#A\"> A </a> | <a href=\"#B\"> B </a> | <a href=\"#C\"> C </a> | <a href=\"#D\"> D </a> | <a href=\"#E\"> E </a> | <a href=\"#F\"> F </a> | <a href=\"#H\"> H </a> | <a href=\"#I\"> I </a> | <a href=\"#L\"> L </a> | <a href=\"#M\"> M </a> | <a href=\"#N\"> N </a> | <a href=\"#P\"> P </a> | <a href=\"#R\"> R </a> | <a href=\"#S\"> S </a> | <a href=\"#U\"> U </a> | <a href=\"#V\"> V </a> | <a href=\"#W\"> W </a> | <a href=\"#X\"> X </a></p> <dl>\n<dt><a href=\"mod_access_compat\" id=\"A\" name=\"A\">mod_access_compat</a></dt>\n<dd>Group authorizations based on host (name or IP address)</dd> <dt><a href=\"mod_actions\">mod_actions</a></dt>\n<dd>Execute CGI scripts based on media type or request method.</dd> <dt><a href=\"mod_alias\">mod_alias</a></dt>\n<dd>Provides for mapping different parts of the host filesystem in the document tree and for URL redirection</dd> <dt><a href=\"mod_allowmethods\">mod_allowmethods</a></dt>\n<dd>Easily restrict what HTTP methods can be used on the server</dd> <dt><a href=\"mod_asis\">mod_asis</a></dt>\n<dd>Sends files that contain their own HTTP headers</dd> <dt><a href=\"mod_auth_basic\">mod_auth_basic</a></dt>\n<dd>Basic HTTP authentication</dd> <dt><a href=\"mod_auth_digest\">mod_auth_digest</a></dt>\n<dd>User authentication using MD5 Digest Authentication</dd> <dt><a href=\"mod_auth_form\">mod_auth_form</a></dt>\n<dd>Form authentication</dd> <dt><a href=\"mod_authn_anon\">mod_authn_anon</a></dt>\n<dd>Allows \"anonymous\" user access to authenticated areas</dd> <dt><a href=\"mod_authn_core\">mod_authn_core</a></dt>\n<dd>Core Authentication</dd> <dt><a href=\"mod_authn_dbd\">mod_authn_dbd</a></dt>\n<dd>User authentication using an SQL database</dd> <dt><a href=\"mod_authn_dbm\">mod_authn_dbm</a></dt>\n<dd>User authentication using DBM files</dd> <dt><a href=\"mod_authn_file\">mod_authn_file</a></dt>\n<dd>User authentication using text files</dd> <dt><a href=\"mod_authn_socache\">mod_authn_socache</a></dt>\n<dd>Manages a cache of authentication credentials to relieve the load on backends</dd> <dt><a href=\"mod_authnz_fcgi\">mod_authnz_fcgi</a></dt>\n<dd>Allows a FastCGI authorizer application to handle Apache httpd authentication and authorization</dd> <dt><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></dt>\n<dd>Allows an LDAP directory to be used to store the database for HTTP Basic authentication.</dd> <dt><a href=\"mod_authz_core\">mod_authz_core</a></dt>\n<dd>Core Authorization</dd> <dt><a href=\"mod_authz_dbd\">mod_authz_dbd</a></dt>\n<dd>Group Authorization and Login using SQL</dd> <dt><a href=\"mod_authz_dbm\">mod_authz_dbm</a></dt>\n<dd>Group authorization using DBM files</dd> <dt><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></dt>\n<dd>Group authorization using plaintext files</dd> <dt><a href=\"mod_authz_host\">mod_authz_host</a></dt>\n<dd>Group authorizations based on host (name or IP address)</dd> <dt><a href=\"mod_authz_owner\">mod_authz_owner</a></dt>\n<dd>Authorization based on file ownership</dd> <dt><a href=\"mod_authz_user\">mod_authz_user</a></dt>\n<dd>User Authorization</dd> <dt><a href=\"mod_autoindex\">mod_autoindex</a></dt>\n<dd>Generates directory indexes, automatically, similar to the Unix <code>ls</code> command or the Win32 <code>dir</code> shell command</dd> <dt><a href=\"mod_buffer\" id=\"B\" name=\"B\">mod_buffer</a></dt>\n<dd>Support for request buffering</dd> <dt><a href=\"mod_cache\" id=\"C\" name=\"C\">mod_cache</a></dt>\n<dd>RFC 2616 compliant HTTP caching filter.</dd> <dt><a href=\"mod_cache_disk\">mod_cache_disk</a></dt>\n<dd>Disk based storage module for the HTTP caching filter.</dd> <dt><a href=\"mod_cache_socache\">mod_cache_socache</a></dt>\n<dd>Shared object cache (socache) based storage module for the HTTP caching filter.</dd> <dt><a href=\"mod_cern_meta\">mod_cern_meta</a></dt>\n<dd>CERN httpd metafile semantics</dd> <dt><a href=\"mod_cgi\">mod_cgi</a></dt>\n<dd>Execution of CGI scripts</dd> <dt><a href=\"mod_cgid\">mod_cgid</a></dt>\n<dd>Execution of CGI scripts using an external CGI daemon</dd> <dt><a href=\"mod_charset_lite\">mod_charset_lite</a></dt>\n<dd>Specify character set translation or recoding</dd> <dt><a href=\"mod_data\" id=\"D\" name=\"D\">mod_data</a></dt>\n<dd>Convert response body into an RFC2397 data URL</dd> <dt><a href=\"mod_dav\">mod_dav</a></dt>\n<dd>Distributed Authoring and Versioning (<a href=\"http://www.webdav.org/\">WebDAV</a>) functionality</dd> <dt><a href=\"mod_dav_fs\">mod_dav_fs</a></dt>\n<dd>Filesystem provider for <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>\n</dd> <dt><a href=\"mod_dav_lock\">mod_dav_lock</a></dt>\n<dd>Generic locking module for <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>\n</dd> <dt><a href=\"mod_dbd\">mod_dbd</a></dt>\n<dd>Manages SQL database connections</dd> <dt><a href=\"mod_deflate\">mod_deflate</a></dt>\n<dd>Compress content before it is delivered to the client</dd> <dt><a href=\"mod_dialup\">mod_dialup</a></dt>\n<dd>Send static content at a bandwidth rate limit, defined by the various old modem standards</dd> <dt><a href=\"mod_dir\">mod_dir</a></dt>\n<dd>Provides for \"trailing slash\" redirects and serving directory index files</dd> <dt><a href=\"mod_dumpio\">mod_dumpio</a></dt>\n<dd>Dumps all I/O to error log as desired.</dd> <dt><a href=\"mod_echo\" id=\"E\" name=\"E\">mod_echo</a></dt>\n<dd>A simple echo server to illustrate protocol modules</dd> <dt><a href=\"mod_env\">mod_env</a></dt>\n<dd>Modifies the environment which is passed to CGI scripts and SSI pages</dd> <dt><a href=\"mod_example_hooks\">mod_example_hooks</a></dt>\n<dd>Illustrates the Apache module API</dd> <dt><a href=\"mod_expires\">mod_expires</a></dt>\n<dd>Generation of <code>Expires</code> and <code>Cache-Control</code> HTTP headers according to user-specified criteria</dd> <dt><a href=\"mod_ext_filter\">mod_ext_filter</a></dt>\n<dd>Pass the response body through an external program before delivery to the client</dd> <dt><a href=\"mod_file_cache\" id=\"F\" name=\"F\">mod_file_cache</a></dt>\n<dd>Caches a static list of files in memory</dd> <dt><a href=\"mod_filter\">mod_filter</a></dt>\n<dd>Context-sensitive smart filter configuration module</dd> <dt><a href=\"mod_headers\" id=\"H\" name=\"H\">mod_headers</a></dt>\n<dd>Customization of HTTP request and response headers</dd> <dt><a href=\"mod_heartbeat\">mod_heartbeat</a></dt>\n<dd>Sends messages with server status to frontend proxy</dd> <dt><a href=\"mod_heartmonitor\">mod_heartmonitor</a></dt>\n<dd>Centralized monitor for mod_heartbeat origin servers</dd> <dt><a href=\"mod_http2\">mod_http2</a></dt>\n<dd>Support for the HTTP/2 transport layer</dd> <dt><a href=\"mod_ident\" id=\"I\" name=\"I\">mod_ident</a></dt>\n<dd>RFC 1413 ident lookups</dd> <dt><a href=\"mod_imagemap\">mod_imagemap</a></dt>\n<dd>Server-side imagemap processing</dd> <dt><a href=\"mod_include\">mod_include</a></dt>\n<dd>Server-parsed html documents (Server Side Includes)</dd> <dt><a href=\"mod_info\">mod_info</a></dt>\n<dd>Provides a comprehensive overview of the server configuration</dd> <dt><a href=\"mod_isapi\">mod_isapi</a></dt>\n<dd>ISAPI Extensions within Apache for Windows</dd> <dt><a href=\"mod_lbmethod_bybusyness\" id=\"L\" name=\"L\">mod_lbmethod_bybusyness</a></dt>\n<dd>Pending Request Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</dd> <dt><a href=\"mod_lbmethod_byrequests\">mod_lbmethod_byrequests</a></dt>\n<dd>Request Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</dd> <dt><a href=\"mod_lbmethod_bytraffic\">mod_lbmethod_bytraffic</a></dt>\n<dd>Weighted Traffic Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</dd> <dt><a href=\"mod_lbmethod_heartbeat\">mod_lbmethod_heartbeat</a></dt>\n<dd>Heartbeat Traffic Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</dd> <dt><a href=\"mod_ldap\">mod_ldap</a></dt>\n<dd>LDAP connection pooling and result caching services for use by other LDAP modules</dd> <dt><a href=\"mod_log_config\">mod_log_config</a></dt>\n<dd>Logging of the requests made to the server</dd> <dt><a href=\"mod_log_debug\">mod_log_debug</a></dt>\n<dd>Additional configurable debug logging</dd> <dt><a href=\"mod_log_forensic\">mod_log_forensic</a></dt>\n<dd>Forensic Logging of the requests made to the server</dd> <dt><a href=\"mod_logio\">mod_logio</a></dt>\n<dd>Logging of input and output bytes per request</dd> <dt><a href=\"mod_lua\">mod_lua</a></dt>\n<dd>Provides Lua hooks into various portions of the httpd request processing</dd> <dt><a href=\"mod_macro\" id=\"M\" name=\"M\">mod_macro</a></dt>\n<dd>Provides macros within apache httpd runtime configuration files</dd> <dt><a href=\"mod_mime\">mod_mime</a></dt>\n<dd>Associates the requested filename's extensions with the file's behavior (handlers and filters) and content (mime-type, language, character set and encoding)</dd> <dt><a href=\"mod_mime_magic\">mod_mime_magic</a></dt>\n<dd>Determines the MIME type of a file by looking at a few bytes of its contents</dd> <dt><a href=\"mod_negotiation\" id=\"N\" name=\"N\">mod_negotiation</a></dt>\n<dd>Provides for <a href=\"../content-negotiation\">content negotiation</a>\n</dd> <dt><a href=\"mod_nw_ssl\">mod_nw_ssl</a></dt>\n<dd>Enable SSL encryption for NetWare</dd> <dt><a href=\"mod_privileges\" id=\"P\" name=\"P\">mod_privileges</a></dt>\n<dd>Support for Solaris privileges and for running virtual hosts under different user IDs.</dd> <dt><a href=\"mod_proxy\">mod_proxy</a></dt>\n<dd>Multi-protocol proxy/gateway server</dd> <dt><a href=\"mod_proxy_ajp\">mod_proxy_ajp</a></dt>\n<dd>AJP support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></dt>\n<dd>\n<code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> extension for load balancing </dd> <dt><a href=\"mod_proxy_connect\">mod_proxy_connect</a></dt>\n<dd>\n<code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> extension for <code>CONNECT</code> request handling</dd> <dt><a href=\"mod_proxy_express\">mod_proxy_express</a></dt>\n<dd>Dynamic mass reverse proxy extension for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></dt>\n<dd>FastCGI support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_fdpass\">mod_proxy_fdpass</a></dt>\n<dd>fdpass external process support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_ftp\">mod_proxy_ftp</a></dt>\n<dd>FTP support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_hcheck\">mod_proxy_hcheck</a></dt>\n<dd>Dynamic health check of Balancer members (workers) for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_html\">mod_proxy_html</a></dt>\n<dd>Rewrite HTML links in to ensure they are addressable from Clients' networks in a proxy context.</dd> <dt><a href=\"mod_proxy_http\">mod_proxy_http</a></dt>\n<dd>HTTP support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_http2\">mod_proxy_http2</a></dt>\n<dd>HTTP/2 support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_scgi\">mod_proxy_scgi</a></dt>\n<dd>SCGI gateway module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_proxy_wstunnel\">mod_proxy_wstunnel</a></dt>\n<dd>Websockets support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt><a href=\"mod_ratelimit\" id=\"R\" name=\"R\">mod_ratelimit</a></dt>\n<dd>Bandwidth Rate Limiting for Clients</dd> <dt><a href=\"mod_reflector\">mod_reflector</a></dt>\n<dd>Reflect a request body as a response via the output filter stack.</dd> <dt><a href=\"mod_remoteip\">mod_remoteip</a></dt>\n<dd>Replaces the original client IP address for the connection with the useragent IP address list presented by a proxies or a load balancer via the request headers. </dd> <dt><a href=\"mod_reqtimeout\">mod_reqtimeout</a></dt>\n<dd>Set timeout and minimum data rate for receiving requests </dd> <dt><a href=\"mod_request\">mod_request</a></dt>\n<dd>Filters to handle and make available HTTP request bodies</dd> <dt><a href=\"mod_rewrite\">mod_rewrite</a></dt>\n<dd>Provides a rule-based rewriting engine to rewrite requested URLs on the fly</dd> <dt><a href=\"mod_sed\" id=\"S\" name=\"S\">mod_sed</a></dt>\n<dd>Filter Input (request) and Output (response) content using <code>sed</code> syntax</dd> <dt><a href=\"mod_session\">mod_session</a></dt>\n<dd>Session support</dd> <dt><a href=\"mod_session_cookie\">mod_session_cookie</a></dt>\n<dd>Cookie based session support</dd> <dt><a href=\"mod_session_crypto\">mod_session_crypto</a></dt>\n<dd>Session encryption support</dd> <dt><a href=\"mod_session_dbd\">mod_session_dbd</a></dt>\n<dd>DBD/SQL based session support</dd> <dt><a href=\"mod_setenvif\">mod_setenvif</a></dt>\n<dd>Allows the setting of environment variables based on characteristics of the request</dd> <dt><a href=\"mod_slotmem_plain\">mod_slotmem_plain</a></dt>\n<dd>Slot-based shared memory provider.</dd> <dt><a href=\"mod_slotmem_shm\">mod_slotmem_shm</a></dt>\n<dd>Slot-based shared memory provider.</dd> <dt><a href=\"mod_so\">mod_so</a></dt>\n<dd>Loading of executable code and modules into the server at start-up or restart time</dd> <dt><a href=\"mod_socache_dbm\">mod_socache_dbm</a></dt>\n<dd>DBM based shared object cache provider.</dd> <dt><a href=\"mod_socache_dc\">mod_socache_dc</a></dt>\n<dd>Distcache based shared object cache provider.</dd> <dt><a href=\"mod_socache_memcache\">mod_socache_memcache</a></dt>\n<dd>Memcache based shared object cache provider.</dd> <dt><a href=\"mod_socache_shmcb\">mod_socache_shmcb</a></dt>\n<dd>shmcb based shared object cache provider.</dd> <dt><a href=\"mod_speling\">mod_speling</a></dt>\n<dd>Attempts to correct mistaken URLs by ignoring capitalization, or attempting to correct various minor misspellings.</dd> <dt><a href=\"mod_ssl\">mod_ssl</a></dt>\n<dd>Strong cryptography using the Secure Sockets Layer (SSL) and Transport Layer Security (TLS) protocols</dd> <dt><a href=\"mod_status\">mod_status</a></dt>\n<dd>Provides information on server activity and performance</dd> <dt><a href=\"mod_substitute\">mod_substitute</a></dt>\n<dd>Perform search and replace operations on response bodies</dd> <dt><a href=\"mod_suexec\">mod_suexec</a></dt>\n<dd>Allows CGI scripts to run as a specified user and Group</dd> <dt><a href=\"mod_unique_id\" id=\"U\" name=\"U\">mod_unique_id</a></dt>\n<dd>Provides an environment variable with a unique identifier for each request</dd> <dt><a href=\"mod_unixd\">mod_unixd</a></dt>\n<dd>Basic (required) security for Unix-family platforms.</dd> <dt><a href=\"mod_userdir\">mod_userdir</a></dt>\n<dd>User-specific directories</dd> <dt><a href=\"mod_usertrack\">mod_usertrack</a></dt>\n<dd> <em>Clickstream</em> logging of user activity on a site </dd> <dt><a href=\"mod_version\" id=\"V\" name=\"V\">mod_version</a></dt>\n<dd>Version dependent configuration</dd> <dt><a href=\"mod_vhost_alias\">mod_vhost_alias</a></dt>\n<dd>Provides for dynamically configured mass virtual hosting</dd> <dt><a href=\"mod_watchdog\" id=\"W\" name=\"W\">mod_watchdog</a></dt>\n<dd>provides infrastructure for other modules to periodically run tasks</dd> <dt><a href=\"mod_xml2enc\" id=\"X\" name=\"X\">mod_xml2enc</a></dt>\n<dd>Enhanced charset/internationalisation support for libxml2-based filter modules</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/</a>\n  </p>\n</div>\n","filter":"<h1>Filters</h1>  <p>This document describes the use of filters in Apache.</p>     <h2 id=\"intro\">Filtering in Apache 2</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_filter\">mod_filter</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_deflate\">mod_deflate</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_ext_filter\">mod_ext_filter</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_include\">mod_include</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_charset_lite\">mod_charset_lite</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_reflector\">mod_reflector</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_buffer\">mod_buffer</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_data\">mod_data</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_ratelimit\">mod_ratelimit</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_reqtimeout\">mod_reqtimeout</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_request\">mod_request</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_sed\">mod_sed</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_substitute\">mod_substitute</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_xml2enc\">mod_xml2enc</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_proxy_html\">mod_proxy_html</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_filter#filterchain\">FilterChain</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_filter#filterdeclare\">FilterDeclare</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_filter#filterprotocol\">FilterProtocol</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_filter#filterprovider\">FilterProvider</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_mime#addinputfilter\">AddInputFilter</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_mime#addoutputfilter\">AddOutputFilter</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_mime#removeinputfilter\">RemoveInputFilter</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_mime#removeoutputfilter\">RemoveOutputFilter</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_reflector#reflectorheader\">ReflectorHeader</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_ext_filter#extfilterdefine\">ExtFilterDefine</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_ext_filter#extfilteroptions\">ExtFilterOptions</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#setinputfilter\">SetInputFilter</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#setoutputfilter\">SetOutputFilter</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The Filter Chain is available in Apache 2.0 and higher, and enables applications to process incoming and outgoing data in a highly flexible and configurable manner, regardless of where the data comes from. We can pre-process incoming data, and post-process outgoing data, at will. This is basically independent of the traditional request processing phases.</p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/filter_arch.png\" width=\"569\" height=\"392\" alt=\"Filters can be chained, in a Data Axis orthogonal to request processing\"> </p> <p>Some examples of filtering in the standard Apache distribution are:</p> <ul> <li>\n<code class=\"module\"><a href=\"mod/mod_include\">mod_include</a></code>, implements server-side includes.</li> <li>\n<code class=\"module\"><a href=\"mod/mod_ssl\">mod_ssl</a></code>, implements SSL encryption (https).</li> <li>\n<code class=\"module\"><a href=\"mod/mod_deflate\">mod_deflate</a></code>, implements compression/decompression on the fly.</li> <li>\n<code class=\"module\"><a href=\"mod/mod_charset_lite\">mod_charset_lite</a></code>, transcodes between different character sets.</li> <li>\n<code class=\"module\"><a href=\"mod/mod_ext_filter\">mod_ext_filter</a></code>, runs an external program as a filter.</li> </ul> <p>Apache also uses a number of filters internally to perform functions like chunking and byte-range handling.</p> <p>A wider range of applications are implemented by third-party filter modules available from <a href=\"http://modules.apache.org/\">modules.apache.org</a> and elsewhere. A few of these are:</p> <ul> <li>HTML and XML processing and rewriting</li> <li>XSLT transforms and XIncludes</li> <li>XML Namespace support</li> <li>File Upload handling and decoding of HTML Forms</li> <li>Image processing</li> <li>Protection of vulnerable applications such as PHP scripts</li> <li>Text search-and-replace editing</li> </ul>   <h2 id=\"smart\">Smart Filtering</h2> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/mod_filter_new.png\" width=\"423\" height=\"331\" alt=\"Smart filtering applies different filter providers according to the state of request processing\"> </p> <p><code class=\"module\"><a href=\"mod/mod_filter\">mod_filter</a></code>, included in Apache 2.1 and later, enables the filter chain to be configured dynamically at run time. So for example you can set up a proxy to rewrite HTML with an HTML filter and JPEG images with a completely separate filter, despite the proxy having no prior information about what the origin server will send. This works by using a filter harness, that dispatches to different providers according to the actual contents at runtime. Any filter may be either inserted directly in the chain and run unconditionally, or used as a provider and inserted dynamically. For example,</p> <ul> <li>an HTML processing filter will only run if the content is text/html or application/xhtml+xml</li> <li>A compression filter will only run if the input is a compressible type and not already compressed</li> <li>A charset conversion filter will be inserted if a text document is not already in the desired charset</li> </ul>   <h2 id=\"service\">Exposing Filters as an HTTP Service</h2> <p>Filters can be used to process content originating from the client in addition to processing content originating on the server using the <code class=\"module\"><a href=\"mod/mod_reflector\">mod_reflector</a></code> module.</p> <p><code class=\"module\"><a href=\"mod/mod_reflector\">mod_reflector</a></code> accepts POST requests from clients, and reflects the content request body received within the POST request back in the response, passing through the output filter stack on the way back to the client.</p> <p>This technique can be used as an alternative to a web service running within an application server stack, where an output filter provides the transformation required on the request body. For example, the <code class=\"module\"><a href=\"mod/mod_deflate\">mod_deflate</a></code> module might be used to provide a general compression service, or an image transformation filter might be turned into an image transformation service.</p>   <h2 id=\"using\">Using Filters</h2> <p>There are two ways to use filtering: Simple and Dynamic. In general, you should use one or the other; mixing them can have unexpected consequences (although simple Input filtering can be mixed freely with either simple or dynamic Output filtering).</p> <p>The Simple Way is the only way to configure input filters, and is sufficient for output filters where you need a static filter chain. Relevant directives are <code class=\"directive\"><a href=\"mod/core#setinputfilter\">SetInputFilter</a></code>, <code class=\"directive\"><a href=\"mod/core#setoutputfilter\">SetOutputFilter</a></code>, <code class=\"directive\"><a href=\"mod/mod_mime#addinputfilter\">AddInputFilter</a></code>, <code class=\"directive\"><a href=\"mod/mod_mime#addoutputfilter\">AddOutputFilter</a></code>, <code class=\"directive\"><a href=\"mod/mod_mime#removeinputfilter\">RemoveInputFilter</a></code>, and <code class=\"directive\"><a href=\"mod/mod_mime#removeoutputfilter\">RemoveOutputFilter</a></code>.</p> <p>The Dynamic Way enables both static and flexible, dynamic configuration of output filters, as discussed in the <code class=\"module\"><a href=\"mod/mod_filter\">mod_filter</a></code> page. Relevant directives are <code class=\"directive\"><a href=\"mod/mod_filter#filterchain\">FilterChain</a></code>, <code class=\"directive\"><a href=\"mod/mod_filter#filterdeclare\">FilterDeclare</a></code>, and <code class=\"directive\"><a href=\"mod/mod_filter#filterprovider\">FilterProvider</a></code>.</p> <p>One further directive <code class=\"directive\"><a href=\"mod/mod_filter#addoutputfilterbytype\">AddOutputFilterByType</a></code> is still supported, but deprecated. Use dynamic configuration instead.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/filter.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/filter.html</a>\n  </p>\n</div>\n","programs/index":"<h1>Server and Supporting Programs</h1>  <p>This page documents all the executable programs included with the Apache HTTP Server.</p>    <h2 id=\"index\">Index</h2> <dl> <dt><code class=\"program\"><a href=\"httpd\">httpd</a></code></dt> <dd>Apache hypertext transfer protocol server</dd> <dt><code class=\"program\"><a href=\"apachectl\">apachectl</a></code></dt> <dd>Apache HTTP server control interface</dd> <dt><code class=\"program\"><a href=\"ab\">ab</a></code></dt> <dd>Apache HTTP server benchmarking tool</dd> <dt><code class=\"program\"><a href=\"apxs\">apxs</a></code></dt> <dd>APache eXtenSion tool</dd> <dt><code class=\"program\"><a href=\"configure\">configure</a></code></dt> <dd>Configure the source tree</dd> <dt><code class=\"program\"><a href=\"dbmmanage\">dbmmanage</a></code></dt> <dd>Create and update user authentication files in DBM format for basic authentication</dd> <dt><code class=\"program\"><a href=\"fcgistarter\">fcgistarter</a></code></dt> <dd>Start a FastCGI program</dd> <dt><code class=\"program\"><a href=\"htcacheclean\">htcacheclean</a></code></dt> <dd>Clean up the disk cache</dd> <dt><code class=\"program\"><a href=\"htdigest\">htdigest</a></code></dt> <dd>Create and update user authentication files for digest authentication</dd> <dt><code class=\"program\"><a href=\"htdbm\">htdbm</a></code></dt> <dd>Manipulate DBM password databases.</dd> <dt><code class=\"program\"><a href=\"htpasswd\">htpasswd</a></code></dt> <dd>Create and update user authentication files for basic authentication</dd> <dt><code class=\"program\"><a href=\"httxt2dbm\">httxt2dbm</a></code></dt> <dd>Create dbm files for use with RewriteMap</dd> <dt><code class=\"program\"><a href=\"logresolve\">logresolve</a></code></dt> <dd>Resolve hostnames for IP-addresses in Apache logfiles</dd> <dt><code class=\"program\"><a href=\"log_server_status\">log_server_status</a></code></dt> <dd>Periodically log the server's status</dd> <dt><code class=\"program\"><a href=\"rotatelogs\">rotatelogs</a></code></dt> <dd>Rotate Apache logs without having to kill the server</dd> <dt><code class=\"program\"><a href=\"split-logfile\">split-logfile</a></code></dt> <dd>Split a multi-vhost logfile into per-host logfiles</dd> <dt><code class=\"program\"><a href=\"suexec\">suexec</a></code></dt> <dd>Switch User For Exec</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/</a>\n  </p>\n</div>\n","getting-started":"<h1>Getting Started</h1>  <p>If you're completely new to the Apache HTTP Server, or even to running a website at all, you might not know where to start, or what questions to ask. This document walks you through the basics.</p>     <h2 id=\"clientserver\">Clients, Servers, and URLs</h2> <p> Addresses on the Web are expressed with URLs - Uniform Resource Locators - which specify a protocol (e.g. <code>http</code>), a servername (e.g. <code>www.apache.org</code>), a URL-path (e.g. <code>/docs/current/getting-started.html</code>), and possibly a query string (e.g. <code>?arg=value</code>) used to pass additional arguments to the server. </p> <p>A client (e.g., a web browser) connects to a server (e.g., your Apache HTTP Server), with the specified protocol, and makes a <strong>request</strong> for a resource using the URL-path.</p> <p>The URL-path may represent any number of things on the server. It may be a file (like <code>getting-started.html</code>) a handler (like <a href=\"mod/mod_status\">server-status</a>) or some kind of program file (like <code>index.php</code>). We'll discuss this more below in the <a href=\"#content\">Web Site Content</a> section.</p> <p> The server will send a <strong>response</strong> consisting of a status code and, optionally, a response body. The status code indicates whether the request was successful, and, if not, what kind of error condition there was. This tells the client what it should do with the response. You can read about the possible response codes in <a href=\"http://wiki.apache.org/httpd/CommonHTTPStatusCodes\">HTTP Server wiki</a>.</p> <p>Details of the transaction, and any error conditions, are written to log files. This is discussed in greater detail below in the <a href=\"#logs\">Logs Files and Troubleshooting</a> section.</p>   <h2 id=\"dns\">Hostnames and DNS</h2> <p>In order to connect to a server, the client will first have to resolve the servername to an IP address - the location on the Internet where the server resides. Thus, in order for your web server to be reachable, it is necessary that the servername be in DNS.</p> <p>If you don't know how to do this, you'll need to contact your network administrator, or Internet service provider, to perform this step for you.</p> <p>More than one hostname may point to the same IP address, and more than one IP address can be attached to the same physical server. Thus, you can run more than one web site on the same physical server, using a feature called <a href=\"vhosts/index\">virtual hosts</a>.</p> <p>If you are testing a server that is not Internet-accessible, you can put host names in your hosts file in order to do local resolution. For example, you might want to put a record in your hosts file to map a request for <code>www.example.com</code> to your local system, for testing purposes. This entry would look like:</p> <div class=\"example\"><pre>127.0.0.1 www.example.com</pre></div> <p>A hosts file will probably be located at <code>/etc/hosts</code> or <code>C:\\Windows\\system32\\drivers\\etc\\hosts</code>.</p> <p>You can read more about the hosts file at <a href=\"http://en.wikipedia.org/wiki/Hosts_(file)\">Wikipedia.org/wiki/Hosts_(file)</a>, and more about DNS at <a href=\"http://en.wikipedia.org/wiki/Domain_Name_System\">Wikipedia.org/wiki/Domain_Name_System</a>.</p>   <h2 id=\"configuration\">Configuration Files and Directives</h2> <p>The Apache HTTP Server is configured via simple text files. These files may be located any of a variety of places, depending on how exactly you installed the server. Common locations for these files may be found <a href=\"http://wiki.apache.org/httpd/DistrosDefaultLayout\">in the httpd wiki</a>. If you installed httpd from source, the default location of the configuration files is <code>/usr/local/apache2/conf</code>. The default configuration file is usually called <code>httpd.conf</code>. This, too, can vary in third-party distributions of the server.</p> <p>The configuration is frequently broken into multiple smaller files, for ease of management. These files are loaded via the <code class=\"directive\"><a href=\"mod/core#include\">Include</a></code> directive. The names or locations of these sub-files are not magical, and may vary greatly from one installation to another. Arrange and subdivide these files as makes the most sense to <strong>you</strong>. If the file arrangement you have by default doesn't make sense to you, feel free to rearrange it.</p> <p>The server is configured by placing <a href=\"https://httpd.apache.org/docs/2.4/en/mod/quickreference.html\">configuration directives</a> in these configuration files. A directive is a keyword followed by one or more arguments that set its value.</p> <p>The question of \"<em>Where should I put that directive?</em>\" is generally answered by considering where you want a directive to be effective. If it is a global setting, it should appear in the configuration file, outside of any <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code>, or other section. If it is to apply only to a particular directory, then it should go inside a <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> section referring to that directory, and so on. See the <a href=\"sections\">Configuration Sections</a> document for further discussion of these sections.</p> <p>In addition to the main configuration files, certain directives may go in <code>.htaccess</code> files located in the content directories. <code>.htaccess</code> files are primarily for people who do not have access to the main server configuration file(s). You can read more about <code>.htaccess</code> files in the <a href=\"howto/htaccess\"><code>.htaccess</code> howto</a>.</p>   <h2 id=\"content\">Web Site Content</h2> <p>Web site content can take many different forms, but may be broadly divided into static and dynamic content.</p> <p>Static content is things like HTML files, image files, CSS files, and other files that reside in the filesystem. The <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> directive specifies where in your filesystem you should place these files. This directive is either set globally, or per virtual host. Look in your configuration file(s) to determine how this is set for your server.</p> <p>Typically, a document called <code>index.html</code> will be served when a directory is requested without a file name being specified. For example, if <code>DocumentRoot</code> is set to <code>/var/www/html</code> and a request is made for <code>http://www.example.com/work/</code>, the file <code>/var/www/html/work/index.html</code> will be served to the client.</p> <p>Dynamic content is anything that is generated at request time, and may change from one request to another. There are numerous ways that dynamic content may be generated. Various <a href=\"handler\">handlers</a> are available to generate content. <a href=\"howto/cgi\">CGI programs</a> may be written to generate content for your site.</p> <p>Third-party modules like mod_php may be used to write code that does a variety of things. Many third-party applications, written using a variety of languages and tools, are available for download and installation on your Apache HTTP Server. Support of these third-party things is beyond the scope of this documentation, and you should find their documentation or other support forums to answer your questions about them.</p>   <h2 id=\"logs\">Log Files and Troubleshooting</h2> <p>As an Apache HTTP Server administrator, your most valuable assets are the log files, and, in particular, the error log. Troubleshooting any problem without the error log is like driving with your eyes closed.</p> <p>The location of the error log is defined by the <code class=\"directive\"><a href=\"mod/core#errorlog\">ErrorLog</a></code> directive, which may be set globally, or per virtual host. Entries in the error log tell you what went wrong, and when. They often also tell you how to fix it. Each error log message contains an error code, which you can search for online for even more detailed descriptions of how to address the problem. You can also configure your error log to contain a log ID which you can then correlate to an access log entry, so that you can determine what request caused the error condition.</p> <p>You can read more about logging in the <a href=\"logs\">logs documentation</a>.</p>   <h2 id=\"other\">What's next?</h2> <p>Once you have the prerequisites under your belt, it's time to move on.</p> <p>This document covers only the bare basics. We hope that this gets you started, but there are many other things that you might need to know.</p> <ul> <li><a href=\"http://httpd.apache.org/download.cgi\">Download</a></li> <li><a href=\"install\">Install</a></li> <li><a href=\"configuring\">Configure</a></li> <li><a href=\"invoking\">Start</a></li> <li><a href=\"http://wiki.apache.org/httpd/FAQ\">Frequently Asked Questions</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/getting-started.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/getting-started.html</a>\n  </p>\n</div>\n","bind":"<h1>Binding to Addresses and Ports</h1>  <p>Configuring Apache HTTP Server to listen on specific addresses and ports.</p>     <h2 id=\"overview\">Overview</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/core\">core</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mpm_common\">mpm_common</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code></li>\n</ul></td>\n</tr>\n</table> <p>When httpd starts, it binds to some port and address on the local machine and waits for incoming requests. By default, it listens to all addresses on the machine. However, it may need to be told to listen on specific ports, or only on selected addresses, or a combination of both. This is often combined with the <a href=\"vhosts/index\">Virtual Host</a> feature, which determines how <code>httpd</code> responds to different IP addresses, hostnames and ports.</p> <p>The <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> directive tells the server to accept incoming requests only on the specified port(s) or address-and-port combinations. If only a port number is specified in the <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> directive, the server listens to the given port on all interfaces. If an IP address is given as well as a port, the server will listen on the given port and interface. Multiple <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> directives may be used to specify a number of addresses and ports to listen on. The server will respond to requests from any of the listed addresses and ports.</p> <p>For example, to make the server accept connections on both port 80 and port 8000, on all interfaces, use:</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\">Listen 80\nListen 8000</pre> </div> <p>To make the server accept connections on port 80 for one interface, and port 8000 on another, use</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\">Listen 192.0.2.1:80\nListen 192.0.2.5:8000</pre> </div> <p>IPv6 addresses must be enclosed in square brackets, as in the following example:</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\">Listen [2001:db8::a00:20ff:fea7:ccea]:80</pre> </div> <div class=\"warning\">\n<p>Overlapping <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> directives will result in a fatal error which will prevent the server from starting up.</p> <div class=\"example\"><pre>(48)Address already in use: make_sock: could not bind to address [::]:80</pre></div> <p>See <a href=\"http://wiki.apache.org/httpd/CouldNotBindToAddress\">the discussion in the wiki</a> for further troubleshooting tips.</p> </div>   <h2 id=\"ipv6\">Special IPv6 Considerations</h2> <p>A growing number of platforms implement IPv6, and <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> supports IPv6 on most of these platforms, allowing httpd to allocate IPv6 sockets, and to handle requests sent over IPv6.</p> <p>One complicating factor for httpd administrators is whether or not an IPv6 socket can handle both IPv4 connections and IPv6 connections. Handling IPv4 connections with an IPv6 socket uses IPv4-mapped IPv6 addresses, which are allowed by default on most platforms, but are disallowed by default on FreeBSD, NetBSD, and OpenBSD, in order to match the system-wide policy on those platforms. On systems where it is disallowed by default, a special <code class=\"program\"><a href=\"programs/configure\">configure</a></code> parameter can change this behavior for httpd.</p> <p>On the other hand, on some platforms, such as Linux and Tru64, the <strong>only</strong> way to handle both IPv6 and IPv4 is to use mapped addresses. If you want <code>httpd</code> to handle IPv4 and IPv6 connections with a minimum of sockets, which requires using IPv4-mapped IPv6 addresses, specify the <code>--enable-v4-mapped</code> <code class=\"program\"><a href=\"programs/configure\">configure</a></code> option.</p> <p><code>--enable-v4-mapped</code> is the default on all platforms except FreeBSD, NetBSD, and OpenBSD, so this is probably how your httpd was built.</p> <p>If you want httpd to handle IPv4 connections only, regardless of what your platform and APR will support, specify an IPv4 address on all <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> directives, as in the following examples:</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\">Listen 0.0.0.0:80\nListen 192.0.2.1:80</pre> </div> <p>If your platform supports it and you want httpd to handle IPv4 and IPv6 connections on separate sockets (i.e., to disable IPv4-mapped addresses), specify the <code>--disable-v4-mapped</code> <code class=\"program\"><a href=\"programs/configure\">configure</a></code> option. <code>--disable-v4-mapped</code> is the default on FreeBSD, NetBSD, and OpenBSD.</p>   <h2 id=\"protocol\">Specifying the protocol with Listen</h2> <p>The optional second <var>protocol</var> argument of <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> is not required for most configurations. If not specified, <code>https</code> is the default for port 443 and <code>http</code> the default for all other ports. The protocol is used to determine which module should handle a request, and to apply protocol specific optimizations with the <code class=\"directive\"><a href=\"mod/core#acceptfilter\">AcceptFilter</a></code> directive.</p> <p>You only need to set the protocol if you are running on non-standard ports. For example, running an <code>https</code> site on port 8443:</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\">Listen 192.170.2.1:8443 https</pre> </div>   <h2 id=\"virtualhost\">How This Works With Virtual Hosts</h2> <p> The <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> directive does not implement Virtual Hosts - it only tells the main server what addresses and ports to listen on. If no <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> directives are used, the server will behave in the same way for all accepted requests. However, <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> can be used to specify a different behavior for one or more of the addresses or ports. To implement a VirtualHost, the server must first be told to listen to the address and port to be used. Then a <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> section should be created for the specified address and port to set the behavior of this virtual host. Note that if the <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> is set for an address and port that the server is not listening to, it cannot be accessed.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/bind.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/bind.html</a>\n  </p>\n</div>\n","stopping":"<h1>Stopping and Restarting Apache HTTP Server</h1>  <p>This document covers stopping and restarting Apache HTTP Server on Unix-like systems. Windows NT, 2000 and XP users should see <a href=\"platform/windows#winsvc\">Running httpd as a Service</a> and Windows 9x and ME users should see <a href=\"platform/windows#wincons\">Running httpd as a Console Application</a> for information on how to control httpd on those platforms.</p>     <h2 id=\"introduction\">Introduction</h2> <p>In order to stop or restart the Apache HTTP Server, you must send a signal to the running <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> processes. There are two ways to send the signals. First, you can use the unix <code>kill</code> command to directly send signals to the processes. You will notice many <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> executables running on your system, but you should not send signals to any of them except the parent, whose pid is in the <code class=\"directive\"><a href=\"mod/mpm_common#pidfile\">PidFile</a></code>. That is to say you shouldn't ever need to send signals to any process except the parent. There are four signals that you can send the parent: <code><a href=\"#term\">TERM</a></code>, <code><a href=\"#graceful\">USR1</a></code>, <code><a href=\"#hup\">HUP</a></code>, and <code><a href=\"#gracefulstop\">WINCH</a></code>, which will be described in a moment.</p> <p>To send a signal to the parent you should issue a command such as:</p> <div class=\"example\"><pre>kill -TERM `cat /usr/local/apache2/logs/httpd.pid`</pre></div> <p>The second method of signaling the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> processes is to use the <code>-k</code> command line options: <code>stop</code>, <code>restart</code>, <code>graceful</code> and <code>graceful-stop</code>, as described below. These are arguments to the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> binary, but we recommend that you send them using the <code class=\"program\"><a href=\"programs/apachectl\">apachectl</a></code> control script, which will pass them through to <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code>.</p> <p>After you have signaled <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code>, you can read about its progress by issuing:</p> <div class=\"example\"><pre>tail -f /usr/local/apache2/logs/error_log</pre></div> <p>Modify those examples to match your <code class=\"directive\"><a href=\"mod/core#serverroot\">ServerRoot</a></code> and <code class=\"directive\"><a href=\"mod/mpm_common#pidfile\">PidFile</a></code> settings.</p>   <h2 id=\"term\">Stop Now</h2> <dl>\n<dt>Signal: TERM</dt> <dd><code>apachectl -k stop</code></dd> </dl> <p>Sending the <code>TERM</code> or <code>stop</code> signal to the parent causes it to immediately attempt to kill off all of its children. It may take it several seconds to complete killing off its children. Then the parent itself exits. Any requests in progress are terminated, and no further requests are served.</p>   <h2 id=\"graceful\">Graceful Restart</h2> <dl>\n<dt>Signal: USR1</dt> <dd><code>apachectl -k graceful</code></dd> </dl> <p>The <code>USR1</code> or <code>graceful</code> signal causes the parent process to <em>advise</em> the children to exit after their current request (or to exit immediately if they're not serving anything). The parent re-reads its configuration files and re-opens its log files. As each child dies off the parent replaces it with a child from the new <em>generation</em> of the configuration, which begins serving new requests immediately.</p> <p>This code is designed to always respect the process control directive of the MPMs, so the number of processes and threads available to serve clients will be maintained at the appropriate values throughout the restart process. Furthermore, it respects <code class=\"directive\"><a href=\"mod/mpm_common#startservers\">StartServers</a></code> in the following manner: if after one second at least <code class=\"directive\"><a href=\"mod/mpm_common#startservers\">StartServers</a></code> new children have not been created, then create enough to pick up the slack. Hence the code tries to maintain both the number of children appropriate for the current load on the server, and respect your wishes with the <code class=\"directive\"><a href=\"mod/mpm_common#startservers\">StartServers</a></code> parameter.</p> <p>Users of <code class=\"module\"><a href=\"mod/mod_status\">mod_status</a></code> will notice that the server statistics are <strong>not</strong> set to zero when a <code>USR1</code> is sent. The code was written to both minimize the time in which the server is unable to serve new requests (they will be queued up by the operating system, so they're not lost in any event) and to respect your tuning parameters. In order to do this it has to keep the <em>scoreboard</em> used to keep track of all children across generations.</p> <p>The status module will also use a <code>G</code> to indicate those children which are still serving requests started before the graceful restart was given.</p> <p>At present there is no way for a log rotation script using <code>USR1</code> to know for certain that all children writing the pre-restart log have finished. We suggest that you use a suitable delay after sending the <code>USR1</code> signal before you do anything with the old log. For example if most of your hits take less than 10 minutes to complete for users on low bandwidth links then you could wait 15 minutes before doing anything with the old log.</p> <div class=\"note\"> <p>When you issue a restart, a syntax check is first run, to ensure that there are no errors in the configuration files. If your configuration file has errors in it, you will get an error message about that syntax error, and the server will refuse to restart. This avoids the situation where the server halts and then cannot restart, leaving you with a non-functioning server.</p> <p>This still will not guarantee that the server will restart correctly. To check the semantics of the configuration files as well as the syntax, you can try starting <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> as a non-root user. If there are no errors it will attempt to open its sockets and logs and fail because it's not root (or because the currently running <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> already has those ports bound). If it fails for any other reason then it's probably a config file error and the error should be fixed before issuing the graceful restart.</p>\n</div>   <h2 id=\"hup\">Restart Now</h2> <dl>\n<dt>Signal: HUP</dt> <dd><code>apachectl -k restart</code></dd> </dl> <p>Sending the <code>HUP</code> or <code>restart</code> signal to the parent causes it to kill off its children like in <code>TERM</code>, but the parent doesn't exit. It re-reads its configuration files, and re-opens any log files. Then it spawns a new set of children and continues serving hits.</p> <p>Users of <code class=\"module\"><a href=\"mod/mod_status\">mod_status</a></code> will notice that the server statistics are set to zero when a <code>HUP</code> is sent.</p> <div class=\"note\">As with a graceful restart, a syntax check is run before the restart is attempted. If your configuration file has errors in it, the restart will not be attempted, and you will receive notification of the syntax error(s).</div>   <h2 id=\"gracefulstop\">Graceful Stop</h2> <dl>\n<dt>Signal: WINCH</dt> <dd><code>apachectl -k graceful-stop</code></dd> </dl> <p>The <code>WINCH</code> or <code>graceful-stop</code> signal causes the parent process to <em>advise</em> the children to exit after their current request (or to exit immediately if they're not serving anything). The parent will then remove its <code class=\"directive\"><a href=\"mod/mpm_common#pidfile\">PidFile</a></code> and cease listening on all ports. The parent will continue to run, and monitor children which are handling requests. Once all children have finalised and exited or the timeout specified by the <code class=\"directive\"><a href=\"mod/mpm_common#gracefulshutdowntimeout\">GracefulShutdownTimeout</a></code> has been reached, the parent will also exit. If the timeout is reached, any remaining children will be sent the <code>TERM</code> signal to force them to exit.</p> <p>A <code>TERM</code> signal will immediately terminate the parent process and all children when in the \"graceful\" state. However as the <code class=\"directive\"><a href=\"mod/mpm_common#pidfile\">PidFile</a></code> will have been removed, you will not be able to use <code>apachectl</code> or <code>httpd</code> to send this signal.</p> <div class=\"note\">\n<p>The <code>graceful-stop</code> signal allows you to run multiple identically configured instances of <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> at the same time. This is a powerful feature when performing graceful upgrades of httpd, however it can also cause deadlocks and race conditions with some configurations.</p> <p>Care has been taken to ensure that on-disk files such as lock files (<code class=\"directive\"><a href=\"mod/core#mutex\">Mutex</a></code>) and Unix socket files (<code class=\"directive\"><a href=\"mod/mod_cgid#scriptsock\">ScriptSock</a></code>) contain the server PID, and should coexist without problem. However, if a configuration directive, third-party module or persistent CGI utilises any other on-disk lock or state files, care should be taken to ensure that multiple running instances of <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> do not clobber each other's files.</p> <p>You should also be wary of other potential race conditions, such as using <code class=\"program\"><a href=\"programs/rotatelogs\">rotatelogs</a></code> style piped logging. Multiple running instances of <code class=\"program\"><a href=\"programs/rotatelogs\">rotatelogs</a></code> attempting to rotate the same logfiles at the same time may destroy each other's logfiles.</p>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/stopping.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/stopping.html</a>\n  </p>\n</div>\n","configuring":"<h1>Configuration Files</h1>  <p>This document describes the files used to configure Apache HTTP Server.</p>     <h2 id=\"main\">Main Configuration Files</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"mod/mod_mime\">mod_mime</a></code></li></ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#ifdefine\">&lt;IfDefine&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#include\">Include</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_mime#typesconfig\">TypesConfig</a></code></li>\n</ul></td>\n</tr>\n</table> <p>Apache HTTP Server is configured by placing <a href=\"https://httpd.apache.org/docs/2.4/en/mod/directives.html\">directives</a> in plain text configuration files. The main configuration file is usually called <code>httpd.conf</code>. The location of this file is set at compile-time, but may be overridden with the <code>-f</code> command line flag. In addition, other configuration files may be added using the <code class=\"directive\"><a href=\"mod/core#include\">Include</a></code> directive, and wildcards can be used to include many configuration files. Any directive may be placed in any of these configuration files. Changes to the main configuration files are only recognized by httpd when it is started or restarted.</p> <p>The server also reads a file containing mime document types; the filename is set by the <code class=\"directive\"><a href=\"mod/mod_mime#typesconfig\">TypesConfig</a></code> directive, and is <code>mime.types</code> by default.</p>   <h2 id=\"syntax\">Syntax of the Configuration Files</h2> <p>httpd configuration files contain one directive per line. The backslash \"\\\" may be used as the last character on a line to indicate that the directive continues onto the next line. There must be no other characters or white space between the backslash and the end of the line.</p> <p>Arguments to directives are separated by whitespace. If an argument contains spaces, you must enclose that argument in quotes.</p> <p>Directives in the configuration files are case-insensitive, but arguments to directives are often case sensitive. Lines that begin with the hash character \"#\" are considered comments, and are ignored. Comments may <strong>not</strong> be included on the same line as a configuration directive. White space occurring before a directive is ignored, so you may indent directives for clarity. Blank lines are also ignored.</p> <p>The values of variables defined with the <code class=\"directive\"><a href=\"mod/core#define\">Define</a></code> of or shell environment variables can be used in configuration file lines using the syntax <code>${VAR}</code>. If \"VAR\" is the name of a valid variable, the value of that variable is substituted into that spot in the configuration file line, and processing continues as if that text were found directly in the configuration file. Variables defined with <code class=\"directive\"><a href=\"mod/core#define\">Define</a></code> take precedence over shell environment variables. If the \"VAR\" variable is not found, the characters <code>${VAR}</code> are left unchanged, and a warning is logged. Variable names may not contain colon \":\" characters, to avoid clashes with <code class=\"directive\"><a href=\"mod/mod_rewrite#rewritemap\">RewriteMap</a></code>'s syntax.</p> <p>Only shell environment variables defined before the server is started can be used in expansions. Environment variables defined in the configuration file itself, for example with <code class=\"directive\"><a href=\"mod/mod_env#setenv\">SetEnv</a></code>, take effect too late to be used for expansions in the configuration file.</p> <p>The maximum length of a line in normal configuration files, after variable substitution and joining any continued lines, is approximately 16 MiB. In <a href=\"configuring#htaccess\">.htaccess files</a>, the maximum length is 8190 characters.</p> <p>You can check your configuration files for syntax errors without starting the server by using <code>apachectl configtest</code> or the <code>-t</code> command line option.</p> <p>You can use <code class=\"module\"><a href=\"mod/mod_info\">mod_info</a></code>'s <code>-DDUMP_CONFIG</code> to dump the configuration with all included files and environment variables resolved and all comments and non-matching <code class=\"directive\"><a href=\"mod/core#ifdefine\">&lt;IfDefine&gt;</a></code> and <code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code> sections removed. However, the output does not reflect the merging or overriding that may happen for repeated directives.</p>   <h2 id=\"modules\">Modules</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"mod/mod_so\">mod_so</a></code></li></ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code></li>\n</ul></td>\n</tr>\n</table> <p>httpd is a modular server. This implies that only the most basic functionality is included in the core server. Extended features are available through <a href=\"mod/index\">modules</a> which can be loaded into httpd. By default, a base set of modules is included in the server at compile-time. If the server is compiled to use <a href=\"dso\">dynamically loaded</a> modules, then modules can be compiled separately and added at any time using the <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> directive. Otherwise, httpd must be recompiled to add or remove modules. Configuration directives may be included conditional on a presence of a particular module by enclosing them in an <code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code> block. However, <code class=\"directive\">&lt;IfModule&gt;</code> blocks are not required, and in some cases may mask the fact that you're missing an important module.</p> <p>To see which modules are currently compiled into the server, you can use the <code>-l</code> command line option. You can also see what modules are loaded dynamically using the <code>-M</code> command line option.</p>   <h2 id=\"scope\">Scope of Directives</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#directorymatch\">&lt;DirectoryMatch&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#locationmatch\">&lt;LocationMatch&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code></li>\n</ul></td>\n</tr>\n</table> <p>Directives placed in the main configuration files apply to the entire server. If you wish to change the configuration for only a part of the server, you can scope your directives by placing them in <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#directorymatch\">&lt;DirectoryMatch&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code>, and <code class=\"directive\"><a href=\"mod/core#locationmatch\">&lt;LocationMatch&gt;</a></code> sections. These sections limit the application of the directives which they enclose to particular filesystem locations or URLs. They can also be nested, allowing for very fine grained configuration.</p> <p>httpd has the capability to serve many different websites simultaneously. This is called <a href=\"vhosts/index\">Virtual Hosting</a>. Directives can also be scoped by placing them inside <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> sections, so that they will only apply to requests for a particular website.</p> <p>Although most directives can be placed in any of these sections, some directives do not make sense in some contexts. For example, directives controlling process creation can only be placed in the main server context. To find which directives can be placed in which sections, check the Context of the directive. For further information, we provide details on <a href=\"sections\">How Directory, Location and Files sections work</a>.</p>   <h2 id=\"htaccess\">.htaccess Files</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#accessfilename\">AccessFileName</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#allowoverride\">AllowOverride</a></code></li>\n</ul></td>\n</tr>\n</table> <p>httpd allows for decentralized management of configuration via special files placed inside the web tree. The special files are usually called <code>.htaccess</code>, but any name can be specified in the <code class=\"directive\"><a href=\"mod/core#accessfilename\">AccessFileName</a></code> directive. Directives placed in <code>.htaccess</code> files apply to the directory where you place the file, and all sub-directories. The <code>.htaccess</code> files follow the same syntax as the main configuration files. Since <code>.htaccess</code> files are read on every request, changes made in these files take immediate effect.</p> <p>To find which directives can be placed in <code>.htaccess</code> files, check the Context of the directive. The server administrator further controls what directives may be placed in <code>.htaccess</code> files by configuring the <code class=\"directive\"><a href=\"mod/core#allowoverride\">AllowOverride</a></code> directive in the main configuration files.</p> <p>For more information on <code>.htaccess</code> files, see the <a href=\"howto/htaccess\">.htaccess tutorial</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/configuring.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/configuring.html</a>\n  </p>\n</div>\n","dso":"<h1>Dynamic Shared Object (DSO) Support</h1>  <p>The Apache HTTP Server is a modular program where the administrator can choose the functionality to include in the server by selecting a set of modules. Modules will be compiled as Dynamic Shared Objects (DSOs) that exist separately from the main <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> binary file. DSO modules may be compiled at the time the server is built, or they may be compiled and added at a later time using the Apache Extension Tool (<code class=\"program\"><a href=\"programs/apxs\">apxs</a></code>).</p> <p>Alternatively, the modules can be statically compiled into the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> binary when the server is built.</p> <p>This document describes how to use DSO modules as well as the theory behind their use.</p>     <h2 id=\"implementation\">Implementation</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"mod/mod_so\">mod_so</a></code></li></ul></td>\n<td><ul><li><code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code></li></ul></td>\n</tr>\n</table> <p>The DSO support for loading individual Apache httpd modules is based on a module named <code class=\"module\"><a href=\"mod/mod_so\">mod_so</a></code> which must be statically compiled into the Apache httpd core. It is the only module besides <code class=\"module\"><a href=\"mod/core\">core</a></code> which cannot be put into a DSO itself. Practically all other distributed Apache httpd modules will then be placed into a DSO. After a module is compiled into a DSO named <code>mod_foo.so</code> you can use <code class=\"module\"><a href=\"mod/mod_so\">mod_so</a></code>'s <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> directive in your <code>httpd.conf</code> file to load this module at server startup or restart.</p> <p>The DSO builds for individual modules can be disabled via <code class=\"program\"><a href=\"programs/configure\">configure</a></code>'s <code>--enable-mods-static</code> option as discussed in the <a href=\"install\">install documentation</a>.</p> <p>To simplify this creation of DSO files for Apache httpd modules (especially for third-party modules) a support program named <code class=\"program\"><a href=\"programs/apxs\">apxs</a></code> (<dfn>APache eXtenSion</dfn>) is available. It can be used to build DSO based modules <em>outside of</em> the Apache httpd source tree. The idea is simple: When installing Apache HTTP Server the <code class=\"program\"><a href=\"programs/configure\">configure</a></code>'s <code>make install</code> procedure installs the Apache httpd C header files and puts the platform-dependent compiler and linker flags for building DSO files into the <code class=\"program\"><a href=\"programs/apxs\">apxs</a></code> program. This way the user can use <code class=\"program\"><a href=\"programs/apxs\">apxs</a></code> to compile his Apache httpd module sources without the Apache httpd distribution source tree and without having to fiddle with the platform-dependent compiler and linker flags for DSO support.</p>   <h2 id=\"usage\">Usage Summary</h2> <p>To give you an overview of the DSO features of Apache HTTP Server 2.x, here is a short and concise summary:</p> <ol> <li> <p>Build and install a <em>distributed</em> Apache httpd module, say <code>mod_foo.c</code>, into its own DSO <code>mod_foo.so</code>:</p> <div class=\"example\"><pre>$ ./configure --prefix=/path/to/install --enable-foo\n$ make install</pre></div> </li> <li> <p>Configure Apache HTTP Server with all modules enabled. Only a basic set will be loaded during server startup. You can change the set of loaded modules by activating or deactivating the <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> directives in <code>httpd.conf</code>.</p> <div class=\"example\"><pre>$ ./configure --enable-mods-shared=all\n$ make install</pre></div> </li> <li> <p>Some modules are only useful for developers and will not be build. when using the module set <em>all</em>. To build all available modules including developer modules use <em>reallyall</em>. In addition the <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> directives for all built modules can be activated via the configure option <code>--enable-load-all-modules</code>.</p> <div class=\"example\"><pre>$ ./configure --enable-mods-shared=reallyall --enable-load-all-modules\n$ make install</pre></div> </li> <li> Build and install a <em>third-party</em> Apache httpd module, say <code>mod_foo.c</code>, into its own DSO <code>mod_foo.so</code> <em>outside of</em> the Apache httpd source tree using <code class=\"program\"><a href=\"programs/apxs\">apxs</a></code>: <div class=\"example\"><pre>$ cd /path/to/3rdparty\n$ apxs -cia mod_foo.c</pre></div> </li> </ol> <p>In all cases, once the shared module is compiled, you must use a <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> directive in <code>httpd.conf</code> to tell Apache httpd to activate the module.</p> <p>See the <a href=\"programs/apxs\">apxs documentation</a> for more details.</p>   <h2 id=\"background\">Background</h2> <p>On modern Unix derivatives there exists a mechanism called dynamic linking/loading of <em>Dynamic Shared Objects</em> (DSO) which provides a way to build a piece of program code in a special format for loading it at run-time into the address space of an executable program.</p> <p>This loading can usually be done in two ways: automatically by a system program called <code>ld.so</code> when an executable program is started or manually from within the executing program via a programmatic system interface to the Unix loader through the system calls <code>dlopen()/dlsym()</code>.</p> <p>In the first way the DSO's are usually called <em>shared libraries</em> or <em>DSO libraries</em> and named <code>libfoo.so</code> or <code>libfoo.so.1.2</code>. They reside in a system directory (usually <code>/usr/lib</code>) and the link to the executable program is established at build-time by specifying <code>-lfoo</code> to the linker command. This hard-codes library references into the executable program file so that at start-time the Unix loader is able to locate <code>libfoo.so</code> in <code>/usr/lib</code>, in paths hard-coded via linker-options like <code>-R</code> or in paths configured via the environment variable <code>LD_LIBRARY_PATH</code>. It then resolves any (yet unresolved) symbols in the executable program which are available in the DSO.</p> <p>Symbols in the executable program are usually not referenced by the DSO (because it's a reusable library of general code) and hence no further resolving has to be done. The executable program has no need to do anything on its own to use the symbols from the DSO because the complete resolving is done by the Unix loader. (In fact, the code to invoke <code>ld.so</code> is part of the run-time startup code which is linked into every executable program which has been bound non-static). The advantage of dynamic loading of common library code is obvious: the library code needs to be stored only once, in a system library like <code>libc.so</code>, saving disk space for every program.</p> <p>In the second way the DSO's are usually called <em>shared objects</em> or <em>DSO files</em> and can be named with an arbitrary extension (although the canonical name is <code>foo.so</code>). These files usually stay inside a program-specific directory and there is no automatically established link to the executable program where they are used. Instead the executable program manually loads the DSO at run-time into its address space via <code>dlopen()</code>. At this time no resolving of symbols from the DSO for the executable program is done. But instead the Unix loader automatically resolves any (yet unresolved) symbols in the DSO from the set of symbols exported by the executable program and its already loaded DSO libraries (especially all symbols from the ubiquitous <code>libc.so</code>). This way the DSO gets knowledge of the executable program's symbol set as if it had been statically linked with it in the first place.</p> <p>Finally, to take advantage of the DSO's API the executable program has to resolve particular symbols from the DSO via <code>dlsym()</code> for later use inside dispatch tables <em>etc.</em> In other words: The executable program has to manually resolve every symbol it needs to be able to use it. The advantage of such a mechanism is that optional program parts need not be loaded (and thus do not spend memory) until they are needed by the program in question. When required, these program parts can be loaded dynamically to extend the base program's functionality.</p> <p>Although this DSO mechanism sounds straightforward there is at least one difficult step here: The resolving of symbols from the executable program for the DSO when using a DSO to extend a program (the second way). Why? Because \"reverse resolving\" DSO symbols from the executable program's symbol set is against the library design (where the library has no knowledge about the programs it is used by) and is neither available under all platforms nor standardized. In practice the executable program's global symbols are often not re-exported and thus not available for use in a DSO. Finding a way to force the linker to export all global symbols is the main problem one has to solve when using DSO for extending a program at run-time.</p> <p>The shared library approach is the typical one, because it is what the DSO mechanism was designed for, hence it is used for nearly all types of libraries the operating system provides.</p>   <h2 id=\"advantages\">Advantages and Disadvantages</h2> <p>The above DSO based features have the following advantages:</p> <ul> <li>The server package is more flexible at run-time because the server process can be assembled at run-time via <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> <code>httpd.conf</code> configuration directives instead of <code class=\"program\"><a href=\"programs/configure\">configure</a></code> options at build-time. For instance, this way one is able to run different server instances (standard &amp; SSL version, minimalistic &amp; dynamic version [mod_perl, mod_php], <em>etc.</em>) with only one Apache httpd installation.</li> <li>The server package can be easily extended with third-party modules even after installation. This is a great benefit for vendor package maintainers, who can create an Apache httpd core package and additional packages containing extensions like PHP, mod_perl, mod_security, <em>etc.</em>\n</li> <li>Easier Apache httpd module prototyping, because with the DSO/<code class=\"program\"><a href=\"programs/apxs\">apxs</a></code> pair you can both work outside the Apache httpd source tree and only need an <code>apxs -i</code> command followed by an <code>apachectl restart</code> to bring a new version of your currently developed module into the running Apache HTTP Server.</li> </ul> <p>DSO has the following disadvantages:</p> <ul> <li>The server is approximately 20% slower at startup time because of the symbol resolving overhead the Unix loader now has to do.</li> <li>The server is approximately 5% slower at execution time under some platforms, because position independent code (PIC) sometimes needs complicated assembler tricks for relative addressing, which are not necessarily as fast as absolute addressing.</li> <li>Because DSO modules cannot be linked against other DSO-based libraries (<code>ld -lfoo</code>) on all platforms (for instance a.out-based platforms usually don't provide this functionality while ELF-based platforms do) you cannot use the DSO mechanism for all types of modules. Or in other words, modules compiled as DSO files are restricted to only use symbols from the Apache httpd core, from the C library (<code>libc</code>) and all other dynamic or static libraries used by the Apache httpd core, or from static library archives (<code>libfoo.a</code>) containing position independent code. The only chances to use other code is to either make sure the httpd core itself already contains a reference to it or loading the code yourself via <code>dlopen()</code>.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/dso.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/dso.html</a>\n  </p>\n</div>\n","env":"<h1>Environment Variables in Apache</h1>  <p>There are two kinds of environment variables that affect the Apache HTTP Server.</p> <p>First, there are the environment variables controlled by the underlying operating system. These are set before the server starts. They can be used in expansions in configuration files, and can optionally be passed to CGI scripts and SSI using the PassEnv directive.</p> <p>Second, the Apache HTTP Server provides a mechanism for storing information in named variables that are also called <em>environment variables</em>. This information can be used to control various operations such as logging or access control. The variables are also used as a mechanism to communicate with external programs such as CGI scripts. This document discusses different ways to manipulate and use these variables.</p> <p>Although these variables are referred to as <em>environment variables</em>, they are not the same as the environment variables controlled by the underlying operating system. Instead, these variables are stored and manipulated in an internal Apache structure. They only become actual operating system environment variables when they are provided to CGI scripts and Server Side Include scripts. If you wish to manipulate the operating system environment under which the server itself runs, you must use the standard environment manipulation mechanisms provided by your operating system shell.</p>     <h2 id=\"setting\">Setting Environment Variables</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_env\">mod_env</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_setenvif\">mod_setenvif</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_unique_id\">mod_unique_id</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_setenvif#browsermatch\">BrowserMatch</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_setenvif#browsermatchnocase\">BrowserMatchNoCase</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_env#passenv\">PassEnv</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_rewrite#rewriterule\">RewriteRule</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_env#setenv\">SetEnv</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_setenvif#setenvif\">SetEnvIf</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_setenvif#setenvifnocase\">SetEnvIfNoCase</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_env#unsetenv\">UnsetEnv</a></code></li>\n</ul></td>\n</tr>\n</table> <h3><a name=\"basic-manipulation\" id=\"basic-manipulation\">Basic Environment Manipulation</a></h3> <p>The most basic way to set an environment variable in Apache is using the unconditional <code class=\"directive\"><a href=\"mod/mod_env#setenv\">SetEnv</a></code> directive. Variables may also be passed from the environment of the shell which started the server using the <code class=\"directive\"><a href=\"mod/mod_env#passenv\">PassEnv</a></code> directive.</p> <h3><a name=\"conditional\" id=\"conditional\">Conditional Per-Request Settings</a></h3> <p>For additional flexibility, the directives provided by <code class=\"module\"><a href=\"mod/mod_setenvif\">mod_setenvif</a></code> allow environment variables to be set on a per-request basis, conditional on characteristics of particular requests. For example, a variable could be set only when a specific browser (User-Agent) is making a request, or only when a specific Referer [sic] header is found. Even more flexibility is available through the <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code>'s <code class=\"directive\"><a href=\"mod/mod_rewrite#rewriterule\">RewriteRule</a></code> which uses the <code>[E=...]</code> option to set environment variables.</p> <h3><a name=\"unique-identifiers\" id=\"unique-identifiers\">Unique Identifiers</a></h3> <p>Finally, <code class=\"module\"><a href=\"mod/mod_unique_id\">mod_unique_id</a></code> sets the environment variable <code>UNIQUE_ID</code> for each request to a value which is guaranteed to be unique across \"all\" requests under very specific conditions.</p> <h3><a name=\"standard-cgi\" id=\"standard-cgi\">Standard CGI Variables</a></h3> <p>In addition to all environment variables set within the Apache configuration and passed from the shell, CGI scripts and SSI pages are provided with a set of environment variables containing meta-information about the request as required by the <a href=\"http://www.ietf.org/rfc/rfc3875\">CGI specification</a>.</p> <h3><a name=\"caveats\" id=\"caveats\">Some Caveats</a></h3> <ul> <li>It is not possible to override or change the standard CGI variables using the environment manipulation directives.</li> <li>When <code class=\"program\"><a href=\"programs/suexec\">suexec</a></code> is used to launch CGI scripts, the environment will be cleaned down to a set of <em>safe</em> variables before CGI scripts are launched. The list of <em>safe</em> variables is defined at compile-time in <code>suexec.c</code>.</li> <li>For portability reasons, the names of environment variables may contain only letters, numbers, and the underscore character. In addition, the first character may not be a number. Characters which do not match this restriction will be replaced by an underscore when passed to CGI scripts and SSI pages.</li> <li>A special case are HTTP headers which are passed to CGI scripts and the like via environment variables (see below). They are converted to uppercase and only dashes are replaced with underscores; if the header contains any other (invalid) character, the whole header is silently dropped. See <a href=\"#fixheader\"> below</a> for a workaround.</li> <li>The <code class=\"directive\"><a href=\"mod/mod_env#setenv\">SetEnv</a></code> directive runs late during request processing meaning that directives such as <code class=\"directive\"><a href=\"mod/mod_setenvif#setenvif\">SetEnvIf</a></code> and <code class=\"directive\"><a href=\"mod/mod_rewrite#rewritecond\">RewriteCond</a></code> will not see the variables set with it.</li> <li>When the server looks up a path via an internal <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#subrequest\" title=\"see glossary\">subrequest</a> such as looking for a <code class=\"directive\"><a href=\"mod/mod_dir#directoryindex\">DirectoryIndex</a></code> or generating a directory listing with <code class=\"module\"><a href=\"mod/mod_autoindex\">mod_autoindex</a></code>, per-request environment variables are <em>not</em> inherited in the subrequest. Additionally, <code class=\"directive\"><a href=\"mod/mod_setenvif#setenvif\">SetEnvIf</a></code> directives are not separately evaluated in the subrequest due to the API phases <code class=\"module\"><a href=\"mod/mod_setenvif\">mod_setenvif</a></code> takes action in.</li> </ul>   <h2 id=\"using\">Using Environment Variables</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_authz_host\">mod_authz_host</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_cgi\">mod_cgi</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_ext_filter\">mod_ext_filter</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_headers\">mod_headers</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_include\">mod_include</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_log_config\">mod_log_config</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_authz_core#require\">Require</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_access_compat#deny\">Deny</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_ext_filter#extfilterdefine\">ExtFilterDefine</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_headers#header\">Header</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_rewrite#rewritecond\">RewriteCond</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_rewrite#rewriterule\">RewriteRule</a></code></li>\n</ul></td>\n</tr>\n</table> <h3><a name=\"cgi-scripts\" id=\"cgi-scripts\">CGI Scripts</a></h3> <p>One of the primary uses of environment variables is to communicate information to CGI scripts. As discussed above, the environment passed to CGI scripts includes standard meta-information about the request in addition to any variables set within the Apache configuration. For more details, see the <a href=\"howto/cgi\">CGI tutorial</a>.</p> <h3><a name=\"ssi-pages\" id=\"ssi-pages\">SSI Pages</a></h3> <p>Server-parsed (SSI) documents processed by <code class=\"module\"><a href=\"mod/mod_include\">mod_include</a></code>'s <code>INCLUDES</code> filter can print environment variables using the <code>echo</code> element, and can use environment variables in flow control elements to makes parts of a page conditional on characteristics of a request. Apache also provides SSI pages with the standard CGI environment variables as discussed above. For more details, see the <a href=\"howto/ssi\">SSI tutorial</a>.</p> <h3><a name=\"access-control\" id=\"access-control\">Access Control</a></h3> <p>Access to the server can be controlled based on the value of environment variables using the <code>allow from env=</code> and <code>deny from env=</code> directives. In combination with <code class=\"directive\"><a href=\"mod/mod_setenvif#setenvif\">SetEnvIf</a></code>, this allows for flexible control of access to the server based on characteristics of the client. For example, you can use these directives to deny access to a particular browser (User-Agent). </p> <h3><a name=\"logging\" id=\"logging\">Conditional Logging</a></h3> <p>Environment variables can be logged in the access log using the <code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code> option <code>%e</code>. In addition, the decision on whether or not to log requests can be made based on the status of environment variables using the conditional form of the <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> directive. In combination with <code class=\"directive\"><a href=\"mod/mod_setenvif#setenvif\">SetEnvIf</a></code> this allows for flexible control of which requests are logged. For example, you can choose not to log requests for filenames ending in <code>gif</code>, or you can choose to only log requests from clients which are outside your subnet.</p> <h3><a name=\"response-headers\" id=\"response-headers\">Conditional Response Headers</a></h3> <p>The <code class=\"directive\"><a href=\"mod/mod_headers#header\">Header</a></code> directive can use the presence or absence of an environment variable to determine whether or not a certain HTTP header will be placed in the response to the client. This allows, for example, a certain response header to be sent only if a corresponding header is received in the request from the client.</p> <h3><a name=\"external-filter\" id=\"external-filter\">External Filter Activation</a></h3> <p>External filters configured by <code class=\"module\"><a href=\"mod/mod_ext_filter\">mod_ext_filter</a></code> using the <code class=\"directive\"><a href=\"mod/mod_ext_filter#extfilterdefine\">ExtFilterDefine</a></code> directive can by activated conditional on an environment variable using the <code>disableenv=</code> and <code>enableenv=</code> options.</p> <h3><a name=\"url-rewriting\" id=\"url-rewriting\">URL Rewriting</a></h3> <p>The <code>%{ENV:<em>variable</em>}</code> form of <em>TestString</em> in the <code class=\"directive\"><a href=\"mod/mod_rewrite#rewritecond\">RewriteCond</a></code> allows <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code>'s rewrite engine to make decisions conditional on environment variables. Note that the variables accessible in <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code> without the <code>ENV:</code> prefix are not actually environment variables. Rather, they are variables special to <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code> which cannot be accessed from other modules.</p>   <h2 id=\"special\">Special Purpose Environment Variables</h2> <p>Interoperability problems have led to the introduction of mechanisms to modify the way Apache behaves when talking to particular clients. To make these mechanisms as flexible as possible, they are invoked by defining environment variables, typically with <code class=\"directive\"><a href=\"mod/mod_setenvif#browsermatch\">BrowserMatch</a></code>, though <code class=\"directive\"><a href=\"mod/mod_env#setenv\">SetEnv</a></code> and <code class=\"directive\"><a href=\"mod/mod_env#passenv\">PassEnv</a></code> could also be used, for example.</p> <h3><a name=\"downgrade\" id=\"downgrade\">downgrade-1.0</a></h3> <p>This forces the request to be treated as a HTTP/1.0 request even if it was in a later dialect.</p> <h3><a name=\"force-gzip\" id=\"force-gzip\">force-gzip</a></h3> <p>If you have the <code>DEFLATE</code> filter activated, this environment variable will ignore the accept-encoding setting of your browser and will send compressed output unconditionally.</p> <h3><a name=\"force-no-vary\" id=\"force-no-vary\">force-no-vary</a></h3> <p>This causes any <code>Vary</code> fields to be removed from the response header before it is sent back to the client. Some clients don't interpret this field correctly; setting this variable can work around this problem. Setting this variable also implies <strong>force-response-1.0</strong>.</p> <h3><a name=\"force-response\" id=\"force-response\">force-response-1.0</a></h3> <p>This forces an HTTP/1.0 response to clients making an HTTP/1.0 request. It was originally implemented as a result of a problem with AOL's proxies. Some HTTP/1.0 clients may not behave correctly when given an HTTP/1.1 response, and this can be used to interoperate with them.</p> <h3><a name=\"gzip-only-text-html\" id=\"gzip-only-text-html\">gzip-only-text/html</a></h3> <p>When set to a value of \"1\", this variable disables the <code>DEFLATE</code> output filter provided by <code class=\"module\"><a href=\"mod/mod_deflate\">mod_deflate</a></code> for content-types other than <code>text/html</code>. If you'd rather use statically compressed files, <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> evaluates the variable as well (not only for gzip, but for all encodings that differ from \"identity\").</p> <h3><a name=\"no-gzip\" id=\"no-gzip\">no-gzip</a></h3> <p>When set, the <code>DEFLATE</code> filter of <code class=\"module\"><a href=\"mod/mod_deflate\">mod_deflate</a></code> will be turned off and <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> will refuse to deliver encoded resources.</p> <h3><a name=\"no-cache\" id=\"no-cache\">no-cache</a></h3> <p><em>Available in versions 2.2.12 and later</em></p> <p>When set, <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> will not save an otherwise cacheable response. This environment variable does not influence whether a response already in the cache will be served for the current request.</p> <h3><a name=\"nokeepalive\" id=\"nokeepalive\">nokeepalive</a></h3> <p>This disables <code class=\"directive\"><a href=\"mod/core#keepalive\">KeepAlive</a></code> when set.</p> <h3><a name=\"prefer-language\" id=\"prefer-language\">prefer-language</a></h3> <p>This influences <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code>'s behaviour. If it contains a language tag (such as <code>en</code>, <code>ja</code> or <code>x-klingon</code>), <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> tries to deliver a variant with that language. If there's no such variant, the normal <a href=\"content-negotiation\">negotiation</a> process applies.</p> <h3><a name=\"redirect-carefully\" id=\"redirect-carefully\">redirect-carefully</a></h3> <p>This forces the server to be more careful when sending a redirect to the client. This is typically used when a client has a known problem handling redirects. This was originally implemented as a result of a problem with Microsoft's WebFolders software which has a problem handling redirects on directory resources via DAV methods.</p> <h3><a name=\"suppress-error-charset\" id=\"suppress-error-charset\">suppress-error-charset</a></h3> <p><em>Available in versions after 2.0.54</em></p> <p>When Apache issues a redirect in response to a client request, the response includes some actual text to be displayed in case the client can't (or doesn't) automatically follow the redirection. Apache ordinarily labels this text according to the character set which it uses, which is ISO-8859-1.</p> <p> However, if the redirection is to a page that uses a different character set, some broken browser versions will try to use the character set from the redirection text rather than the actual page. This can result in Greek, for instance, being incorrectly rendered.</p> <p>Setting this environment variable causes Apache to omit the character set for the redirection text, and these broken browsers will then correctly use that of the destination page.</p> <div class=\"warning\"> <p><strong>Security note</strong></p> <p>Sending error pages without a specified character set may allow a cross-site-scripting attack for existing browsers (MSIE) which do not follow the HTTP/1.1 specification and attempt to \"guess\" the character set from the content. Such browsers can be easily fooled into using the UTF-7 character set, and UTF-7 content from input data (such as the request-URI) will not be escaped by the usual escaping mechanisms designed to prevent cross-site-scripting attacks.</p> </div> <h3><a name=\"proxy\" id=\"proxy\">force-proxy-request-1.0, proxy-nokeepalive, proxy-sendchunked, proxy-sendcl, proxy-chain-auth, proxy-interim-response, proxy-initial-not-pooled</a></h3> <p>These directives alter the protocol behavior of <code class=\"module\"><a href=\"mod/mod_proxy\">mod_proxy</a></code>. See the <code class=\"module\"><a href=\"mod/mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod/mod_proxy_http\">mod_proxy_http</a></code> documentation for more details.</p>   <h2 id=\"examples\">Examples</h2> <h3><a name=\"fixheader\" id=\"fixheader\">Passing broken headers to CGI scripts</a></h3> <p>Starting with version 2.4, Apache is more strict about how HTTP headers are converted to environment variables in <code class=\"module\"><a href=\"mod/mod_cgi\">mod_cgi </a></code> and other modules: Previously any invalid characters in header names were simply translated to underscores. This allowed for some potential cross-site-scripting attacks via header injection (see <a href=\"http://events.ccc.de/congress/2007/Fahrplan/events/2212.en.html\"> Unusual Web Bugs</a>, slide 19/20).</p> <p>If you have to support a client which sends broken headers and which can't be fixed, a simple workaround involving <code class=\"module\"><a href=\"mod/mod_setenvif\">mod_setenvif </a></code> and <code class=\"module\"><a href=\"mod/mod_headers\">mod_headers</a></code> allows you to still accept these headers:</p> <pre class=\"prettyprint lang-config\"># \n# The following works around a client sending a broken Accept_Encoding\n# header.\n#\nSetEnvIfNoCase ^Accept.Encoding$ ^(.*)$ fix_accept_encoding=$1\nRequestHeader set Accept-Encoding %{fix_accept_encoding}e env=fix_accept_encoding</pre> <h3><a name=\"misbehaving\" id=\"misbehaving\">Changing protocol behavior with misbehaving clients</a></h3> <p>Earlier versions recommended that the following lines be included in httpd.conf to deal with known client problems. Since the affected clients are no longer seen in the wild, this configuration is likely no-longer necessary.</p> <pre class=\"prettyprint lang-config\">#\n# The following directives modify normal HTTP response behavior.\n# The first directive disables keepalive for Netscape 2.x and browsers that\n# spoof it. There are known problems with these browser implementations.\n# The second directive is for Microsoft Internet Explorer 4.0b2\n# which has a broken HTTP/1.1 implementation and does not properly\n# support keepalive when it is used on 301 or 302 (redirect) responses.\n#\nBrowserMatch \"Mozilla/2\" nokeepalive\nBrowserMatch \"MSIE 4\\.0b2;\" nokeepalive downgrade-1.0 force-response-1.0\n\n#\n# The following directive disables HTTP/1.1 responses to browsers which\n# are in violation of the HTTP/1.0 spec by not being able to understand a\n# basic 1.1 response.\n#\nBrowserMatch \"RealPlayer 4\\.0\" force-response-1.0\nBrowserMatch \"Java/1\\.0\" force-response-1.0\nBrowserMatch \"JDK/1\\.0\" force-response-1.0</pre> <h3><a name=\"no-img-log\" id=\"no-img-log\">Do not log requests for images in the access log</a></h3> <p>This example keeps requests for images from appearing in the access log. It can be easily modified to prevent logging of particular directories, or to prevent logging of requests coming from particular hosts.</p> <pre class=\"prettyprint lang-config\">SetEnvIf Request_URI \\.gif image-request\nSetEnvIf Request_URI \\.jpg image-request\nSetEnvIf Request_URI \\.png image-request\nCustomLog logs/access_log common env=!image-request</pre> <h3><a name=\"image-theft\" id=\"image-theft\">Prevent \"Image Theft\"</a></h3> <p>This example shows how to keep people not on your server from using images on your server as inline-images on their pages. This is not a recommended configuration, but it can work in limited circumstances. We assume that all your images are in a directory called <code>/web/images</code>.</p> <pre class=\"prettyprint lang-config\">SetEnvIf Referer \"^http://www\\.example\\.com/\" local_referal\n# Allow browsers that do not send Referer info\nSetEnvIf Referer \"^$\" local_referal\n&lt;Directory \"/web/images\"&gt;\n    Require env local_referal\n&lt;/Directory&gt;</pre> <p>For more information about this technique, see the \"<a href=\"http://www.serverwatch.com/tutorials/article.php/1132731\">Keeping Your Images from Adorning Other Sites</a>\" tutorial on ServerWatch.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/env.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/env.html</a>\n  </p>\n</div>\n","urlmapping":"<h1>Mapping URLs to Filesystem Locations</h1>  <p>This document explains how the Apache HTTP Server uses the URL of a request to determine the filesystem location from which to serve a file.</p>     <h2 id=\"related\">Related Modules and Directives</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_actions\">mod_actions</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_alias\">mod_alias</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_autoindex\">mod_autoindex</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_dir\">mod_dir</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_imagemap\">mod_imagemap</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_proxy\">mod_proxy</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_speling\">mod_speling</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_userdir\">mod_userdir</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_vhost_alias\">mod_vhost_alias</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_alias#alias\">Alias</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_alias#aliasmatch\">AliasMatch</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_speling#checkspelling\">CheckSpelling</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_dir#directoryindex\">DirectoryIndex</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#errordocument\">ErrorDocument</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#options\">Options</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_proxy#proxypass\">ProxyPass</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_proxy#proxypassreverse\">ProxyPassReverse</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_proxy#proxypassreversecookiedomain\">ProxyPassReverseCookieDomain</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_proxy#proxypassreversecookiepath\">ProxyPassReverseCookiePath</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_alias#redirect\">Redirect</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_alias#redirectmatch\">RedirectMatch</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_rewrite#rewritecond\">RewriteCond</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_rewrite#rewriterule\">RewriteRule</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_alias#scriptalias\">ScriptAlias</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_alias#scriptaliasmatch\">ScriptAliasMatch</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_userdir#userdir\">UserDir</a></code></li>\n</ul></td>\n</tr>\n</table>   <h2 id=\"documentroot\">DocumentRoot</h2> <p>In deciding what file to serve for a given request, httpd's default behavior is to take the URL-Path for the request (the part of the URL following the hostname and port) and add it to the end of the <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> specified in your configuration files. Therefore, the files and directories underneath the <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> make up the basic document tree which will be visible from the web.</p> <p>For example, if <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> were set to <code>/var/www/html</code> then a request for <code>http://www.example.com/fish/guppies.html</code> would result in the file <code>/var/www/html/fish/guppies.html</code> being served to the requesting client.</p> <p>If a directory is requested (i.e. a path ending with <code>/</code>), the file served from that directory is defined by the <code class=\"directive\"><a href=\"mod/mod_dir#directoryindex\">DirectoryIndex</a></code> directive. For example, if <code>DocumentRoot</code> were set as above, and you were to set:</p> <div class=\"example\"><pre>DirectoryIndex index.html index.php</pre></div> <p>Then a request for <code>http://www.example.com/fish/</code> will cause httpd to attempt to serve the file <code>/var/www/html/fish/index.html</code>. In the event that that file does not exist, it will next attempt to serve the file <code>/var/www/html/fish/index.php</code>.</p> <p>If neither of these files existed, the next step is to attempt to provide a directory index, if <code class=\"module\"><a href=\"mod/mod_autoindex\">mod_autoindex</a></code> is loaded and configured to permit that.</p> <p>httpd is also capable of <a href=\"vhosts/index\">Virtual Hosting</a>, where the server receives requests for more than one host. In this case, a different <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> can be specified for each virtual host, or alternatively, the directives provided by the module <code class=\"module\"><a href=\"mod/mod_vhost_alias\">mod_vhost_alias</a></code> can be used to dynamically determine the appropriate place from which to serve content based on the requested IP address or hostname.</p> <p>The <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> directive is set in your main server configuration file (<code>httpd.conf</code>) and, possibly, once per additional <a href=\"vhosts/index\">Virtual Host</a> you create.</p>   <h2 id=\"outside\">Files Outside the DocumentRoot</h2> <p>There are frequently circumstances where it is necessary to allow web access to parts of the filesystem that are not strictly underneath the <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code>. httpd offers several different ways to accomplish this. On Unix systems, symbolic links can bring other parts of the filesystem under the <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code>. For security reasons, httpd will follow symbolic links only if the <code class=\"directive\"><a href=\"mod/core#options\">Options</a></code> setting for the relevant directory includes <code>FollowSymLinks</code> or <code>SymLinksIfOwnerMatch</code>.</p> <p>Alternatively, the <code class=\"directive\"><a href=\"mod/mod_alias#alias\">Alias</a></code> directive will map any part of the filesystem into the web space. For example, with</p> <pre class=\"prettyprint lang-config\">Alias \"/docs\" \"/var/web\"</pre> <p>the URL <code>http://www.example.com/docs/dir/file.html</code> will be served from <code>/var/web/dir/file.html</code>. The <code class=\"directive\"><a href=\"mod/mod_alias#scriptalias\">ScriptAlias</a></code> directive works the same way, with the additional effect that all content located at the target path is treated as <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#cgi\" title=\"see glossary\">CGI</a> scripts.</p> <p>For situations where you require additional flexibility, you can use the <code class=\"directive\"><a href=\"mod/mod_alias#aliasmatch\">AliasMatch</a></code> and <code class=\"directive\"><a href=\"mod/mod_alias#scriptaliasmatch\">ScriptAliasMatch</a></code> directives to do powerful <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> based matching and substitution. For example,</p> <pre class=\"prettyprint lang-config\">ScriptAliasMatch \"^/~([a-zA-Z0-9]+)/cgi-bin/(.+)\"   \"/home/$1/cgi-bin/$2\"</pre> <p>will map a request to <code>http://example.com/~user/cgi-bin/script.cgi</code> to the path <code>/home/user/cgi-bin/script.cgi</code> and will treat the resulting file as a CGI script.</p>   <h2 id=\"user\">User Directories</h2> <p>Traditionally on Unix systems, the home directory of a particular <em>user</em> can be referred to as <code>~user/</code>. The module <code class=\"module\"><a href=\"mod/mod_userdir\">mod_userdir</a></code> extends this idea to the web by allowing files under each user's home directory to be accessed using URLs such as the following.</p> <div class=\"example\"><code>http://www.example.com/~user/file.html</code></div> <p>For security reasons, it is inappropriate to give direct access to a user's home directory from the web. Therefore, the <code class=\"directive\"><a href=\"mod/mod_userdir#userdir\">UserDir</a></code> directive specifies a directory underneath the user's home directory where web files are located. Using the default setting of <code>Userdir public_html</code>, the above URL maps to a file at a directory like <code>/home/user/public_html/file.html</code> where <code>/home/user/</code> is the user's home directory as specified in <code>/etc/passwd</code>.</p> <p>There are also several other forms of the <code>Userdir</code> directive which you can use on systems where <code>/etc/passwd</code> does not contain the location of the home directory.</p> <p>Some people find the \"~\" symbol (which is often encoded on the web as <code>%7e</code>) to be awkward and prefer to use an alternate string to represent user directories. This functionality is not supported by mod_userdir. However, if users' home directories are structured in a regular way, then it is possible to use the <code class=\"directive\"><a href=\"mod/mod_alias#aliasmatch\">AliasMatch</a></code> directive to achieve the desired effect. For example, to make <code>http://www.example.com/upages/user/file.html</code> map to <code>/home/user/public_html/file.html</code>, use the following <code>AliasMatch</code> directive:</p> <pre class=\"prettyprint lang-config\">AliasMatch \"^/upages/([a-zA-Z0-9]+)(/(.*))?$\"   \"/home/$1/public_html/$3\"</pre>   <h2 id=\"redirect\">URL Redirection</h2> <p>The configuration directives discussed in the above sections tell httpd to get content from a specific place in the filesystem and return it to the client. Sometimes, it is desirable instead to inform the client that the requested content is located at a different URL, and instruct the client to make a new request with the new URL. This is called <em>redirection</em> and is implemented by the <code class=\"directive\"><a href=\"mod/mod_alias#redirect\">Redirect</a></code> directive. For example, if the contents of the directory <code>/foo/</code> under the <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> are moved to the new directory <code>/bar/</code>, you can instruct clients to request the content at the new location as follows:</p> <pre class=\"prettyprint lang-config\">Redirect permanent \"/foo/\"   \"http://www.example.com/bar/\"</pre> <p>This will redirect any URL-Path starting in <code>/foo/</code> to the same URL path on the <code>www.example.com</code> server with <code>/bar/</code> substituted for <code>/foo/</code>. You can redirect clients to any server, not only the origin server.</p> <p>httpd also provides a <code class=\"directive\"><a href=\"mod/mod_alias#redirectmatch\">RedirectMatch</a></code> directive for more complicated rewriting problems. For example, to redirect requests for the site home page to a different site, but leave all other requests alone, use the following configuration:</p> <pre class=\"prettyprint lang-config\">RedirectMatch permanent \"^/$\"    \"http://www.example.com/startpage.html\"</pre> <p>Alternatively, to temporarily redirect all pages on one site to a particular page on another site, use the following:</p> <pre class=\"prettyprint lang-config\">RedirectMatch temp \".*\"  \"http://othersite.example.com/startpage.html\"</pre>   <h2 id=\"proxy\">Reverse Proxy</h2> <p>httpd also allows you to bring remote documents into the URL space of the local server. This technique is called <em>reverse proxying</em> because the web server acts like a proxy server by fetching the documents from a remote server and returning them to the client. It is different from normal (forward) proxying because, to the client, it appears the documents originate at the reverse proxy server.</p> <p>In the following example, when clients request documents under the <code>/foo/</code> directory, the server fetches those documents from the <code>/bar/</code> directory on <code>internal.example.com</code> and returns them to the client as if they were from the local server.</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/foo/\" \"http://internal.example.com/bar/\"\nProxyPassReverse \"/foo/\" \"http://internal.example.com/bar/\"\nProxyPassReverseCookieDomain internal.example.com public.example.com\nProxyPassReverseCookiePath \"/foo/\" \"/bar/\"</pre> <p>The <code class=\"directive\"><a href=\"mod/mod_proxy#proxypass\">ProxyPass</a></code> configures the server to fetch the appropriate documents, while the <code class=\"directive\"><a href=\"mod/mod_proxy#proxypassreverse\">ProxyPassReverse</a></code> directive rewrites redirects originating at <code>internal.example.com</code> so that they target the appropriate directory on the local server. Similarly, the <code class=\"directive\"><a href=\"mod/mod_proxy#proxypassreversecookiedomain\">ProxyPassReverseCookieDomain</a></code> and <code class=\"directive\"><a href=\"mod/mod_proxy#proxypassreversecookiepath\">ProxyPassReverseCookiePath</a></code> rewrite cookies set by the backend server.</p> <p>It is important to note, however, that links inside the documents will not be rewritten. So any absolute links on <code>internal.example.com</code> will result in the client breaking out of the proxy server and requesting directly from <code>internal.example.com</code>. You can modify these links (and other content) in a page as it is being served to the client using <code class=\"module\"><a href=\"mod/mod_substitute\">mod_substitute</a></code>.</p> <pre class=\"prettyprint lang-config\">Substitute \"s/internal\\.example\\.com/www.example.com/i\"</pre> <p>For more sophisticated rewriting of links in HTML and XHTML, the <code class=\"module\"><a href=\"mod/mod_proxy_html\">mod_proxy_html</a></code> module is also available. It allows you to create maps of URLs that need to be rewritten, so that complex proxying scenarios can be handled.</p>   <h2 id=\"rewrite\">Rewriting Engine</h2> <p>When even more powerful substitution is required, the rewriting engine provided by <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code> can be useful. The directives provided by this module can use characteristics of the request such as browser type or source IP address in deciding from where to serve content. In addition, mod_rewrite can use external database files or programs to determine how to handle a request. The rewriting engine is capable of performing all three types of mappings discussed above: internal redirects (aliases), external redirects, and proxying. Many practical examples employing mod_rewrite are discussed in the <a href=\"rewrite/index\">detailed mod_rewrite documentation</a>.</p>   <h2 id=\"notfound\">File Not Found</h2> <p>Inevitably, URLs will be requested for which no matching file can be found in the filesystem. This can happen for several reasons. In some cases, it can be a result of moving documents from one location to another. In this case, it is best to use <a href=\"#redirect\">URL redirection</a> to inform clients of the new location of the resource. In this way, you can assure that old bookmarks and links will continue to work, even though the resource is at a new location.</p> <p>Another common cause of \"File Not Found\" errors is accidental mistyping of URLs, either directly in the browser, or in HTML links. httpd provides the module <code class=\"module\"><a href=\"mod/mod_speling\">mod_speling</a></code> (sic) to help with this problem. When this module is activated, it will intercept \"File Not Found\" errors and look for a resource with a similar filename. If one such file is found, mod_speling will send an HTTP redirect to the client informing it of the correct location. If several \"close\" files are found, a list of available alternatives will be presented to the client.</p> <p>An especially useful feature of mod_speling, is that it will compare filenames without respect to case. This can help systems where users are unaware of the case-sensitive nature of URLs and the unix filesystem. But using mod_speling for anything more than the occasional URL correction can place additional load on the server, since each \"incorrect\" request is followed by a URL redirection and a new request from the client.</p> <p><code class=\"module\"><a href=\"mod/mod_dir\">mod_dir</a></code> provides <code class=\"directive\"><a href=\"mod/mod_dir#fallbackresource\">FallbackResource</a></code>, which can be used to map virtual URIs to a real resource, which then serves them. This is a very useful replacement for <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code> when implementing a 'front controller'</p> <p>If all attempts to locate the content fail, httpd returns an error page with HTTP status code 404 (file not found). The appearance of this page is controlled with the <code class=\"directive\"><a href=\"mod/core#errordocument\">ErrorDocument</a></code> directive and can be customized in a flexible manner as discussed in the <a href=\"custom-error\">Custom error responses</a> document.</p>   <h2 id=\"other\">Other URL Mapping Modules</h2> <p>Other modules available for URL mapping include:</p> <ul> <li>\n<code class=\"module\"><a href=\"mod/mod_actions\">mod_actions</a></code> - Maps a request to a CGI script based on the request method, or resource MIME type.</li> <li>\n<code class=\"module\"><a href=\"mod/mod_dir\">mod_dir</a></code> - Provides basic mapping of a trailing slash into an index file such as <code>index.html</code>.</li> <li>\n<code class=\"module\"><a href=\"mod/mod_imagemap\">mod_imagemap</a></code> - Maps a request to a URL based on where a user clicks on an image embedded in a HTML document.</li> <li>\n<code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> - Selects an appropriate document based on client preferences such as language or content compression.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/urlmapping.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/urlmapping.html</a>\n  </p>\n</div>\n","server-wide":"<h1>Server-Wide Configuration</h1>  <p>This document explains some of the directives provided by the <code class=\"module\"><a href=\"mod/core\">core</a></code> server which are used to configure the basic operations of the server.</p>     <h2 id=\"identification\">Server Identification</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#servername\">ServerName</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#serveradmin\">ServerAdmin</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#serversignature\">ServerSignature</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#servertokens\">ServerTokens</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#usecanonicalname\">UseCanonicalName</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#usecanonicalphysicalport\">UseCanonicalPhysicalPort</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The <code class=\"directive\"><a href=\"mod/core#serveradmin\">ServerAdmin</a></code> and <code class=\"directive\"><a href=\"mod/core#servertokens\">ServerTokens</a></code> directives control what information about the server will be presented in server-generated documents such as error messages. The <code class=\"directive\"><a href=\"mod/core#servertokens\">ServerTokens</a></code> directive sets the value of the Server HTTP response header field.</p> <p>The <code class=\"directive\"><a href=\"mod/core#servername\">ServerName</a></code>, <code class=\"directive\"><a href=\"mod/core#usecanonicalname\">UseCanonicalName</a></code> and <code class=\"directive\"><a href=\"mod/core#usecanonicalphysicalport\">UseCanonicalPhysicalPort</a></code> directives are used by the server to determine how to construct self-referential URLs. For example, when a client requests a directory, but does not include the trailing slash in the directory name, httpd must redirect the client to the full name including the trailing slash so that the client will correctly resolve relative references in the document.</p>   <h2 id=\"locations\">File Locations</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mpm_common#coredumpdirectory\">CoreDumpDirectory</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#errorlog\">ErrorLog</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#mutex\">Mutex</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mpm_common#pidfile\">PidFile</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mpm_common#scoreboardfile\">ScoreBoardFile</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#serverroot\">ServerRoot</a></code></li>\n</ul></td>\n</tr>\n</table> <p>These directives control the locations of the various files that httpd needs for proper operation. When the pathname used does not begin with a slash (/), the files are located relative to the <code class=\"directive\"><a href=\"mod/core#serverroot\">ServerRoot</a></code>. Be careful about locating files in paths which are writable by non-root users. See the <a href=\"misc/security_tips#serverroot\">security tips</a> documentation for more details.</p>   <h2 id=\"resource\">Limiting Resource Usage</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#limitrequestbody\">LimitRequestBody</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#limitrequestfields\">LimitRequestFields</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#limitrequestfieldsize\">LimitRequestFieldsize</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#limitrequestline\">LimitRequestLine</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#rlimitcpu\">RLimitCPU</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#rlimitmem\">RLimitMEM</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#rlimitnproc\">RLimitNPROC</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mpm_common#threadstacksize\">ThreadStackSize</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The <code class=\"directive\">LimitRequest</code>* directives are used to place limits on the amount of resources httpd will use in reading requests from clients. By limiting these values, some kinds of denial of service attacks can be mitigated.</p> <p>The <code class=\"directive\">RLimit</code>* directives are used to limit the amount of resources which can be used by processes forked off from the httpd children. In particular, this will control resources used by CGI scripts and SSI exec commands.</p> <p>The <code class=\"directive\"><a href=\"mod/mpm_common#threadstacksize\">ThreadStackSize</a></code> directive is used with some platforms to control the stack size.</p>   <h2 id=\"implementation\">Implementation Choices</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td></td>\n<td><ul><li><code class=\"directive\"><a href=\"mod/core#mutex\">Mutex</a></code></li></ul></td>\n</tr>\n</table> <p>The <code class=\"directive\">Mutex</code> directive can be used to change the underlying implementation used for mutexes, in order to relieve functional or performance problems with <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a>'s default choice.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/server-wide.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/server-wide.html</a>\n  </p>\n</div>\n","expr":"<h1>Expressions in Apache HTTP Server</h1>  <p>Historically, there are several syntax variants for expressions used to express a condition in the different modules of the Apache HTTP Server. There is some ongoing effort to only use a single variant, called <em>ap_expr</em>, for all configuration directives. This document describes the <em>ap_expr</em> expression parser. </p> <p>The <em>ap_expr</em> expression is intended to replace most other expression variants in HTTPD. For example, the deprecated <code class=\"directive\"><a href=\"mod/mod_ssl#sslrequire\">SSLRequire</a></code> expressions can be replaced by <a href=\"mod/mod_authz_core#reqexpr\">Require expr</a>. </p>     <h2 id=\"grammar\">Grammar in Backus-Naur Form notation</h2> <p><a href=\"http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form\">Backus-Naur Form</a> (BNF) is a notation technique for context-free grammars, often used to describe the syntax of languages used in computing. In most cases, expressions are used to express boolean values. For these, the starting point in the BNF is <code>expr</code>. However, a few directives like <code class=\"directive\"><a href=\"mod/mod_log_debug#logmessage\">LogMessage</a></code> accept expressions that evaluate to a string value. For those, the starting point in the BNF is <code>string</code>. </p> <blockquote> <pre>expr        ::= \"<strong>true</strong>\" | \"<strong>false</strong>\"\n              | \"<strong>!</strong>\" expr\n              | expr \"<strong>&amp;&amp;</strong>\" expr\n              | expr \"<strong>||</strong>\" expr\n              | \"<strong>(</strong>\" expr \"<strong>)</strong>\"\n              | comp\n\ncomp        ::= stringcomp\n              | integercomp\n              | unaryop word\n              | word binaryop word\n              | word \"<strong>in</strong>\" \"<strong>{</strong>\" wordlist \"<strong>}</strong>\"\n              | word \"<strong>in</strong>\" listfunction\n              | word \"<strong>=~</strong>\" regex\n              | word \"<strong>!~</strong>\" regex\n\n\nstringcomp  ::= word \"<strong>==</strong>\" word\n              | word \"<strong>!=</strong>\" word\n              | word \"<strong>&lt;</strong>\"  word\n              | word \"<strong>&lt;=</strong>\" word\n              | word \"<strong>&gt;</strong>\"  word\n              | word \"<strong>&gt;=</strong>\" word\n\nintegercomp ::= word \"<strong>-eq</strong>\" word | word \"<strong>eq</strong>\" word\n              | word \"<strong>-ne</strong>\" word | word \"<strong>ne</strong>\" word\n              | word \"<strong>-lt</strong>\" word | word \"<strong>lt</strong>\" word\n              | word \"<strong>-le</strong>\" word | word \"<strong>le</strong>\" word\n              | word \"<strong>-gt</strong>\" word | word \"<strong>gt</strong>\" word\n              | word \"<strong>-ge</strong>\" word | word \"<strong>ge</strong>\" word\n\nwordlist    ::= word\n              | wordlist \"<strong>,</strong>\" word\n\nword        ::= word \"<strong>.</strong>\" word\n              | digit\n              | \"<strong>'</strong>\" string \"<strong>'</strong>\"\n              | \"<strong>\"</strong>\" string \"<strong>\"</strong>\"\n              | variable\n              | rebackref\n              | function\n\nstring      ::= stringpart\n              | string stringpart\n\nstringpart  ::= cstring\n              | variable\n              | rebackref\n\ncstring     ::= ...\ndigit       ::= [0-9]+\n\nvariable    ::= \"<strong>%{</strong>\" varname \"<strong>}</strong>\"\n              | \"<strong>%{</strong>\" funcname \"<strong>:</strong>\" funcargs \"<strong>}</strong>\"\n\nrebackref   ::= \"<strong>$</strong>\" [0-9]\n\nfunction     ::= funcname \"<strong>(</strong>\" word \"<strong>)</strong>\"\n\nlistfunction ::= listfuncname \"<strong>(</strong>\" word \"<strong>)</strong>\"</pre> </blockquote>   <h2 id=\"vars\">Variables</h2> <p>The expression parser provides a number of variables of the form <code>%{HTTP_HOST}</code>. Note that the value of a variable may depend on the phase of the request processing in which it is evaluated. For example, an expression used in an <code class=\"directive\">&lt;If &gt;</code> directive is evaluated before authentication is done. Therefore, <code>%{REMOTE_USER}</code> will not be set in this case.</p> <p>The following variables provide the values of the named HTTP request headers. The values of other headers can be obtained with the <code>req</code> <a href=\"#functions\">function</a>. Using these variables may cause the header name to be added to the Vary header of the HTTP response, except where otherwise noted for the directive accepting the expression. The <code>req_novary</code> <a href=\"#functions\">function</a> may be used to circumvent this behavior.</p> <table class=\"bordered\">\n<tr class=\"header\"><th>Name</th></tr> <tr><td><code>HTTP_ACCEPT</code></td></tr> <tr class=\"odd\"><td><code>HTTP_COOKIE</code></td></tr> <tr><td><code>HTTP_FORWARDED</code></td></tr> <tr class=\"odd\"><td><code>HTTP_HOST</code></td></tr> <tr><td><code>HTTP_PROXY_CONNECTION</code></td></tr> <tr class=\"odd\"><td><code>HTTP_REFERER</code></td></tr> <tr><td><code>HTTP_USER_AGENT</code></td></tr> </table> <p>Other request related variables</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Name</th>\n<th>Description</th>\n</tr> <tr>\n<td><code>REQUEST_METHOD</code></td> <td>The HTTP method of the incoming request (e.g. <code>GET</code>)</td>\n</tr> <tr class=\"odd\">\n<td><code>REQUEST_SCHEME</code></td> <td>The scheme part of the request's URI</td>\n</tr> <tr>\n<td><code>REQUEST_URI</code></td> <td>The path part of the request's URI</td>\n</tr> <tr class=\"odd\">\n<td><code>DOCUMENT_URI</code></td> <td>Same as <code>REQUEST_URI</code>\n</td>\n</tr> <tr>\n<td><code>REQUEST_FILENAME</code></td> <td>The full local filesystem path to the file or script matching the request, if this has already been determined by the server at the time <code>REQUEST_FILENAME</code> is referenced. Otherwise, such as when used in virtual host context, the same value as <code>REQUEST_URI</code> </td>\n</tr> <tr class=\"odd\">\n<td><code>SCRIPT_FILENAME</code></td> <td>Same as <code>REQUEST_FILENAME</code>\n</td>\n</tr> <tr>\n<td><code>LAST_MODIFIED</code></td> <td>The date and time of last modification of the file in the format <code>20101231235959</code>, if this has already been determined by the server at the time <code>LAST_MODIFIED</code> is referenced. </td>\n</tr> <tr class=\"odd\">\n<td><code>SCRIPT_USER</code></td> <td>The user name of the owner of the script.</td>\n</tr> <tr>\n<td><code>SCRIPT_GROUP</code></td> <td>The group name of the group of the script.</td>\n</tr> <tr class=\"odd\">\n<td><code>PATH_INFO</code></td> <td>The trailing path name information, see <code class=\"directive\"><a href=\"mod/core#acceptpathinfo\">AcceptPathInfo</a></code>\n</td>\n</tr> <tr>\n<td><code>QUERY_STRING</code></td> <td>The query string of the current request</td>\n</tr> <tr class=\"odd\">\n<td><code>IS_SUBREQ</code></td> <td>\"<code>true</code>\" if the current request is a subrequest, \"<code>false</code>\" otherwise</td>\n</tr> <tr>\n<td><code>THE_REQUEST</code></td> <td>The complete request line (e.g., \"<code>GET /index.html HTTP/1.1</code>\")</td>\n</tr> <tr class=\"odd\">\n<td><code>REMOTE_ADDR</code></td> <td>The IP address of the remote host</td>\n</tr> <tr>\n<td><code>REMOTE_HOST</code></td> <td>The host name of the remote host</td>\n</tr> <tr class=\"odd\">\n<td><code>REMOTE_USER</code></td> <td>The name of the authenticated user, if any (not available during <code class=\"directive\">&lt;If &gt;</code>)</td>\n</tr> <tr>\n<td><code>REMOTE_IDENT</code></td> <td>The user name set by <code class=\"module\"><a href=\"mod/mod_ident\">mod_ident</a></code>\n</td>\n</tr> <tr class=\"odd\">\n<td><code>SERVER_NAME</code></td> <td>The <code class=\"directive\"><a href=\"mod/core#servername\">ServerName</a></code> of the current vhost</td>\n</tr> <tr>\n<td><code>SERVER_PORT</code></td> <td>The server port of the current vhost, see <code class=\"directive\"><a href=\"mod/core#servername\">ServerName</a></code>\n</td>\n</tr> <tr class=\"odd\">\n<td><code>SERVER_ADMIN</code></td> <td>The <code class=\"directive\"><a href=\"mod/core#serveradmin\">ServerAdmin</a></code> of the current vhost</td>\n</tr> <tr>\n<td><code>SERVER_PROTOCOL</code></td> <td>The protocol used by the request</td>\n</tr> <tr class=\"odd\">\n<td><code>DOCUMENT_ROOT</code></td> <td>The <code class=\"directive\"><a href=\"mod/core#documentroot\">DocumentRoot</a></code> of the current vhost</td>\n</tr> <tr>\n<td><code>AUTH_TYPE</code></td> <td>The configured <code class=\"directive\"><a href=\"mod/mod_authn_core#authtype\">AuthType</a></code> (e.g. \"<code>basic</code>\")</td>\n</tr> <tr class=\"odd\">\n<td><code>CONTENT_TYPE</code></td> <td>The content type of the response (not available during <code class=\"directive\">&lt;If &gt;</code>)</td>\n</tr> <tr>\n<td><code>HANDLER</code></td> <td>The name of the <a href=\"handler\">handler</a> creating the response</td>\n</tr> <tr class=\"odd\">\n<td><code>HTTP2</code></td> <td>\"<code>on</code>\" if the request uses http/2, \"<code>off</code>\" otherwise</td>\n</tr> <tr>\n<td><code>HTTPS</code></td> <td>\"<code>on</code>\" if the request uses https, \"<code>off</code>\" otherwise</td>\n</tr> <tr class=\"odd\">\n<td><code>IPV6</code></td> <td>\"<code>on</code>\" if the connection uses IPv6, \"<code>off</code>\" otherwise</td>\n</tr> <tr>\n<td><code>REQUEST_STATUS</code></td> <td>The HTTP error status of the request (not available during <code class=\"directive\">&lt;If &gt;</code>)</td>\n</tr> <tr class=\"odd\">\n<td><code>REQUEST_LOG_ID</code></td> <td>The error log id of the request (see <code class=\"directive\"><a href=\"mod/core#errorlogformat\">ErrorLogFormat</a></code>)</td>\n</tr> <tr>\n<td><code>CONN_LOG_ID</code></td> <td>The error log id of the connection (see <code class=\"directive\"><a href=\"mod/core#errorlogformat\">ErrorLogFormat</a></code>)</td>\n</tr> <tr class=\"odd\">\n<td><code>CONN_REMOTE_ADDR</code></td> <td>The peer IP address of the connection (see the <code class=\"module\"><a href=\"mod/mod_remoteip\">mod_remoteip</a></code> module)</td>\n</tr> <tr>\n<td><code>CONTEXT_PREFIX</code></td> <td></td>\n</tr> <tr class=\"odd\">\n<td><code>CONTEXT_DOCUMENT_ROOT</code></td> <td></td>\n</tr> </table> <p>Misc variables</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Name</th>\n<th>Description</th>\n</tr> <tr>\n<td><code>TIME_YEAR</code></td> <td>The current year (e.g. <code>2010</code>)</td>\n</tr> <tr class=\"odd\">\n<td><code>TIME_MON</code></td> <td>The current month (<code>1</code>, ..., <code>12</code>)</td>\n</tr> <tr>\n<td><code>TIME_DAY</code></td> <td>The current day of the month</td>\n</tr> <tr class=\"odd\">\n<td><code>TIME_HOUR</code></td> <td>The hour part of the current time (<code>0</code>, ..., <code>23</code>)</td>\n</tr> <tr>\n<td><code>TIME_MIN</code></td> <td>The minute part of the current time </td>\n</tr> <tr class=\"odd\">\n<td><code>TIME_SEC</code></td> <td>The second part of the current time </td>\n</tr> <tr>\n<td><code>TIME_WDAY</code></td> <td>The day of the week (starting with <code>0</code> for Sunday)</td>\n</tr> <tr class=\"odd\">\n<td><code>TIME</code></td> <td>The date and time in the format <code>20101231235959</code>\n</td>\n</tr> <tr>\n<td><code>SERVER_SOFTWARE</code></td> <td>The server version string</td>\n</tr> <tr class=\"odd\">\n<td><code>API_VERSION</code></td> <td>The date of the API version (module magic number)</td>\n</tr> </table> <p>Some modules register additional variables, see e.g. <code class=\"module\"><a href=\"mod/mod_ssl\">mod_ssl</a></code>.</p>   <h2 id=\"binop\">Binary operators</h2> <p>With the exception of some built-in comparison operators, binary operators have the form \"<code>-[a-zA-Z][a-zA-Z0-9_]+</code>\", i.e. a minus and at least two characters. The name is not case sensitive. Modules may register additional binary operators.</p> <h3><a name=\"comp\" id=\"comp\">Comparison operators</a></h3> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Name</th>\n<th>Alternative</th> <th>Description</th>\n</tr> <tr>\n<td><code>==</code></td> <td><code>=</code></td> <td>String equality</td>\n</tr> <tr class=\"odd\">\n<td><code>!=</code></td> <td></td> <td>String inequality</td>\n</tr> <tr>\n<td><code>&lt;</code></td> <td></td> <td>String less than</td>\n</tr> <tr class=\"odd\">\n<td><code>&lt;=</code></td> <td></td> <td>String less than or equal</td>\n</tr> <tr>\n<td><code>&gt;</code></td> <td></td> <td>String greater than</td>\n</tr> <tr class=\"odd\">\n<td><code>&gt;=</code></td> <td></td> <td>String greater than or equal</td>\n</tr> <tr>\n<td><code>-eq</code></td> <td><code>eq</code></td> <td>Integer equality</td>\n</tr> <tr class=\"odd\">\n<td><code>-ne</code></td> <td><code>ne</code></td> <td>Integer inequality</td>\n</tr> <tr>\n<td><code>-lt</code></td> <td><code>lt</code></td> <td>Integer less than</td>\n</tr> <tr class=\"odd\">\n<td><code>-le</code></td> <td><code>le</code></td> <td>Integer less than or equal</td>\n</tr> <tr>\n<td><code>-gt</code></td> <td><code>gt</code></td> <td>Integer greater than</td>\n</tr> <tr class=\"odd\">\n<td><code>-ge</code></td> <td><code>ge</code></td> <td>Integer greater than or equal</td>\n</tr> </table> <h3><a name=\"binaryother\" id=\"binaryother\">Other binary operators</a></h3> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Name</th>\n<th>Description</th>\n</tr> <tr>\n<td><code>-ipmatch</code></td> <td>IP address matches address/netmask</td>\n</tr> <tr class=\"odd\">\n<td><code>-strmatch</code></td> <td>left string matches pattern given by right string (containing wildcards *, ?, [])</td>\n</tr> <tr>\n<td><code>-strcmatch</code></td> <td>same as <code>-strmatch</code>, but case insensitive</td>\n</tr> <tr class=\"odd\">\n<td><code>-fnmatch</code></td> <td>same as <code>-strmatch</code>, but slashes are not matched by wildcards</td>\n</tr> </table>   <h2 id=\"unnop\">Unary operators</h2> <p>Unary operators take one argument and have the form \"<code>-[a-zA-Z]</code>\", i.e. a minus and one character. The name <em>is</em> case sensitive. Modules may register additional unary operators.</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Name</th>\n<th>Description</th>\n<th>Restricted</th>\n</tr> <tr>\n<td><code>-d</code></td> <td>The argument is treated as a filename. True if the file exists and is a directory</td>\n<td>yes</td>\n</tr> <tr class=\"odd\">\n<td><code>-e</code></td> <td>The argument is treated as a filename. True if the file (or dir or special) exists</td>\n<td>yes</td>\n</tr> <tr>\n<td><code>-f</code></td> <td>The argument is treated as a filename. True if the file exists and is regular file</td>\n<td>yes</td>\n</tr> <tr class=\"odd\">\n<td><code>-s</code></td> <td>The argument is treated as a filename. True if the file exists and is not empty</td>\n<td>yes</td>\n</tr> <tr>\n<td><code>-L</code></td> <td>The argument is treated as a filename. True if the file exists and is symlink</td>\n<td>yes</td>\n</tr> <tr class=\"odd\">\n<td><code>-h</code></td> <td>The argument is treated as a filename. True if the file exists and is symlink (same as <code>-L</code>)</td>\n<td>yes</td>\n</tr> <tr>\n<td><code>-F</code></td> <td>True if string is a valid file, accessible via all the server's currently-configured access controls for that path. This uses an internal subrequest to do the check, so use it with care - it can impact your server's performance!</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>-U</code></td> <td>True if string is a valid URL, accessible via all the server's currently-configured access controls for that path. This uses an internal subrequest to do the check, so use it with care - it can impact your server's performance!</td>\n<td></td>\n</tr> <tr>\n<td><code>-A</code></td> <td>Alias for <code>-U</code>\n</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>-n</code></td> <td>True if string is not empty</td>\n<td></td>\n</tr> <tr>\n<td><code>-z</code></td> <td>True if string is empty</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>-T</code></td> <td>False if string is empty, \"<code>0</code>\", \"<code>off</code>\", \"<code>false</code>\", or \"<code>no</code>\" (case insensitive). True otherwise.</td>\n<td></td>\n</tr> <tr>\n<td><code>-R</code></td> <td>Same as \"<code>%{REMOTE_ADDR} -ipmatch ...</code>\", but more efficient </td>\n<td></td>\n</tr> </table> <p>The operators marked as \"restricted\" are not available in some modules like <code class=\"module\"><a href=\"mod/mod_include\">mod_include</a></code>.</p>   <h2 id=\"functions\">Functions</h2> <p>Normal string-valued functions take one string as argument and return a string. Functions names are not case sensitive. Modules may register additional functions.</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Name</th>\n<th>Description</th>\n<th>Restricted</th>\n</tr> <tr>\n<td>\n<code>req</code>, <code>http</code>\n</td> <td>Get HTTP request header; header names may be added to the Vary header, see below</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>req_novary</code></td> <td>Same as <code>req</code>, but header names will not be added to the Vary header</td>\n<td></td>\n</tr> <tr>\n<td><code>resp</code></td> <td>Get HTTP response header</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>reqenv</code></td> <td>Lookup request environment variable (as a shortcut, <code>v</code> can be used too to access variables).</td>\n<td></td>\n</tr> <tr>\n<td><code>osenv</code></td> <td>Lookup operating system environment variable</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>note</code></td> <td>Lookup request note</td>\n<td></td>\n</tr> <tr>\n<td><code>env</code></td> <td>Return first match of <code>note</code>, <code>reqenv</code>, <code>osenv</code>\n</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>tolower</code></td> <td>Convert string to lower case</td>\n<td></td>\n</tr> <tr>\n<td><code>toupper</code></td> <td>Convert string to upper case</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>escape</code></td> <td>Escape special characters in %hex encoding</td>\n<td></td>\n</tr> <tr>\n<td><code>unescape</code></td> <td>Unescape %hex encoded string, leaving encoded slashes alone; return empty string if %00 is found</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>base64</code></td> <td>Encode the string using base64 encoding</td>\n<td></td>\n</tr> <tr>\n<td><code>unbase64</code></td> <td>Decode base64 encoded string, return truncated string if 0x00 is found</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>md5</code></td> <td>Hash the string using MD5, then encode the hash with hexadecimal encoding</td>\n<td></td>\n</tr> <tr>\n<td><code>sha1</code></td> <td>Hash the string using SHA1, then encode the hash with hexadecimal encoding</td>\n<td></td>\n</tr> <tr class=\"odd\">\n<td><code>file</code></td> <td>Read contents from a file (including line endings, when present) </td>\n<td>yes</td>\n</tr> <tr>\n<td><code>filesize</code></td> <td>Return size of a file (or 0 if file does not exist or is not regular file)</td>\n<td>yes</td>\n</tr> </table> <p>The functions marked as \"restricted\" are not available in some modules like <code class=\"module\"><a href=\"mod/mod_include\">mod_include</a></code>.</p> <p>When the functions <code>req</code> or <code>http</code> are used, the header name will automatically be added to the Vary header of the HTTP response, except where otherwise noted for the directive accepting the expression. The <code>req_novary</code> function can be used to prevent names from being added to the Vary header.</p> <p>In addition to string-valued functions, there are also list-valued functions which take one string as argument and return a wordlist, i.e. a list of strings. The wordlist can be used with the special <code>-in</code> operator. Functions names are not case sensitive. Modules may register additional functions.</p> <p>There are no built-in list-valued functions. <code class=\"module\"><a href=\"mod/mod_ssl\">mod_ssl</a></code> provides <code>PeerExtList</code>. See the description of <code class=\"directive\"><a href=\"mod/mod_ssl#sslrequire\">SSLRequire</a></code> for details (but <code>PeerExtList</code> is also usable outside of <code class=\"directive\"><a href=\"mod/mod_ssl#sslrequire\">SSLRequire</a></code>).</p>   <h2 id=\"examples\">Example expressions</h2> <p>The following examples show how expressions might be used to evaluate requests:</p> <pre class=\"prettyprint lang-config\"># Compare the host name to example.com and redirect to www.example.com if it matches\n&lt;If \"%{HTTP_HOST} == 'example.com'\"&gt;\n    Redirect permanent \"/\" \"http://www.example.com/\"\n&lt;/If&gt;\n\n# Force text/plain if requesting a file with the query string contains 'forcetext'\n&lt;If \"%{QUERY_STRING} =~ /forcetext/\"&gt;\n    ForceType text/plain\n&lt;/If&gt;\n\n# Only allow access to this content during business hours\n&lt;Directory \"/foo/bar/business\"&gt;\n    Require expr %{TIME_HOUR} -gt 9 &amp;&amp; %{TIME_HOUR} -lt 17\n&lt;/Directory&gt;\t\n\n# Check a HTTP header for a list of values\n&lt;If \"%{HTTP:X-example-header} in { 'foo', 'bar', 'baz' }\"&gt;\n    Header set matched true\n&lt;/If&gt;\n\n# Check an environment variable for a regular expression, negated.\n&lt;If \"! reqenv('REDIRECT_FOO') =~ /bar/\"&gt;\n    Header set matched true\n&lt;/If&gt;\n\n# Check result of URI mapping by running in Directory context with -f\n&lt;Directory \"/var/www\"&gt;\n    AddEncoding x-gzip gz\n&lt;If \"-f '%{REQUEST_FILENAME}.unzipme' &amp;&amp; ! %{HTTP:Accept-Encoding} =~ /gzip/\"&gt;\n      SetOutputFilter INFLATE\n&lt;/If&gt;\n&lt;/Directory&gt;\n\n# Check against the client IP\n&lt;If \"-R '192.168.1.0/24'\"&gt;\n    Header set matched true\n&lt;/If&gt;\n\n# Function example in boolean context\n&lt;If \"md5('foo') == 'acbd18db4cc2f85cedef654fccc4a4d8'\"&gt;\n  Header set checksum-matched true\n&lt;/If&gt;\n\n# Function example in string context\nHeader set foo-checksum \"expr=%{md5:foo}\"\n\n# This delays the evaluation of the condition clause compared to &lt;If&gt;\nHeader always set CustomHeader my-value \"expr=%{REQUEST_URI} =~ m#^/special_path.php$#\"</pre>   <h2 id=\"other\">Other</h2> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Name</th>\n<th>Alternative</th> <th>Description</th>\n</tr> <tr>\n<td><code>-in</code></td> <td><code>in</code></td> <td>string contained in wordlist</td>\n</tr> <tr class=\"odd\">\n<td><code>/regexp/</code></td> <td><code>m#regexp#</code></td> <td>Regular expression (the second form allows different delimiters than /)</td>\n</tr> <tr>\n<td><code>/regexp/i</code></td> <td><code>m#regexp#i</code></td> <td>Case insensitive regular expression</td>\n</tr> <tr class=\"odd\">\n<td><pre>$0 ... $9</pre></td> <td></td> <td>Regular expression backreferences</td>\n</tr> </table> <h3><a name=\"rebackref\" id=\"rebackref\">Regular expression backreferences</a></h3> <p>The strings <code>$0</code> ... <code>$9</code> allow to reference the capture groups from a previously executed, successfully matching regular expressions. They can normally only be used in the same expression as the matching regex, but some modules allow special uses.</p>   <h2 id=\"sslrequire\">Comparison with SSLRequire</h2> <p>The <em>ap_expr</em> syntax is mostly a superset of the syntax of the deprecated <code class=\"directive\"><a href=\"mod/mod_ssl#sslrequire\">SSLRequire</a></code> directive. The differences are described in <code class=\"directive\"><a href=\"mod/mod_ssl#sslrequire\">SSLRequire</a></code>'s documentation.</p>   <h2 id=\"compatibility\">Version History</h2> <p>The <code>req_novary</code> <a href=\"#functions\">function</a> is available for versions 2.4.4 and later.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/expr.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/expr.html</a>\n  </p>\n</div>\n","sections":"<h1>Configuration Sections</h1>  <p>Directives in the <a href=\"configuring\">configuration files</a> may apply to the entire server, or they may be restricted to apply only to particular directories, files, hosts, or URLs. This document describes how to use configuration section containers or <code>.htaccess</code> files to change the scope of other configuration directives.</p>     <h2 id=\"types\">Types of Configuration Section Containers</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/core\">core</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_version\">mod_version</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_proxy\">mod_proxy</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#directorymatch\">&lt;DirectoryMatch&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#if\">&lt;If&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#ifdefine\">&lt;IfDefine&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_version#ifversion\">&lt;IfVersion&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#locationmatch\">&lt;LocationMatch&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_proxy#proxy\">&lt;Proxy&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_proxy#proxymatch\">&lt;ProxyMatch&gt;</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code></li>\n</ul></td>\n</tr>\n</table> <p>There are two basic types of containers. Most containers are evaluated for each request. The enclosed directives are applied only for those requests that match the containers. The <code class=\"directive\"><a href=\"mod/core#ifdefine\">&lt;IfDefine&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code>, and <code class=\"directive\"><a href=\"mod/mod_version#ifversion\">&lt;IfVersion&gt;</a></code> containers, on the other hand, are evaluated only at server startup and restart. If their conditions are true at startup, then the enclosed directives will apply to all requests. If the conditions are not true, the enclosed directives will be ignored.</p> <p>The <code class=\"directive\"><a href=\"mod/core#ifdefine\">&lt;IfDefine&gt;</a></code> directive encloses directives that will only be applied if an appropriate parameter is defined on the <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> command line. For example, with the following configuration, all requests will be redirected to another site only if the server is started using <code>httpd -DClosedForNow</code>:</p> <pre class=\"prettyprint lang-config\">&lt;IfDefine ClosedForNow&gt;\n    Redirect \"/\" \"http://otherserver.example.com/\"\n&lt;/IfDefine&gt;</pre> <p>The <code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code> directive is very similar, except it encloses directives that will only be applied if a particular module is available in the server. The module must either be statically compiled in the server, or it must be dynamically compiled and its <code class=\"directive\"><a href=\"mod/mod_so#loadmodule\">LoadModule</a></code> line must be earlier in the configuration file. This directive should only be used if you need your configuration file to work whether or not certain modules are installed. It should not be used to enclose directives that you want to work all the time, because it can suppress useful error messages about missing modules.</p> <p>In the following example, the <code class=\"directive\"><a href=\"mod/mod_mime_magic#mimemagicfile\">MimeMagicFile</a></code> directive will be applied only if <code class=\"module\"><a href=\"mod/mod_mime_magic\">mod_mime_magic</a></code> is available.</p> <pre class=\"prettyprint lang-config\">&lt;IfModule mod_mime_magic.c&gt;\n    MimeMagicFile \"conf/magic\"\n&lt;/IfModule&gt;</pre> <p>The <code class=\"directive\"><a href=\"mod/mod_version#ifversion\">&lt;IfVersion&gt;</a></code> directive is very similar to <code class=\"directive\"><a href=\"mod/core#ifdefine\">&lt;IfDefine&gt;</a></code> and <code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code>, except it encloses directives that will only be applied if a particular version of the server is executing. This module is designed for the use in test suites and large networks which have to deal with different httpd versions and different configurations.</p> <pre class=\"prettyprint lang-config\">&lt;IfVersion &gt;= 2.4&gt;\n    # this happens only in versions greater or\n    # equal 2.4.0.\n&lt;/IfVersion&gt;</pre> <p><code class=\"directive\"><a href=\"mod/core#ifdefine\">&lt;IfDefine&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#ifmodule\">&lt;IfModule&gt;</a></code>, and the <code class=\"directive\"><a href=\"mod/mod_version#ifversion\">&lt;IfVersion&gt;</a></code> can apply negative conditions by preceding their test with \"!\". Also, these sections can be nested to achieve more complex restrictions.</p>   <h2 id=\"file-and-web\">Filesystem, Webspace, and Boolean Expressions</h2> <p>The most commonly used configuration section containers are the ones that change the configuration of particular places in the filesystem or webspace. First, it is important to understand the difference between the two. The filesystem is the view of your disks as seen by your operating system. For example, in a default install, Apache httpd resides at <code>/usr/local/apache2</code> in the Unix filesystem or <code>\"c:/Program Files/Apache Group/Apache2\"</code> in the Windows filesystem. (Note that forward slashes should always be used as the path separator in Apache httpd configuration files, even for Windows.) In contrast, the webspace is the view of your site as delivered by the web server and seen by the client. So the path <code>/dir/</code> in the webspace corresponds to the path <code>/usr/local/apache2/htdocs/dir/</code> in the filesystem of a default Apache httpd install on Unix. The webspace need not map directly to the filesystem, since webpages may be generated dynamically from databases or other locations.</p> <h3><a name=\"filesystem\" id=\"filesystem\">Filesystem Containers</a></h3> <p>The <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> and <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> directives, along with their <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regex</a> counterparts, apply directives to parts of the filesystem. Directives enclosed in a <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> section apply to the named filesystem directory and all subdirectories of that directory (as well as the files in those directories). The same effect can be obtained using <a href=\"howto/htaccess\">.htaccess files</a>. For example, in the following configuration, directory indexes will be enabled for the <code>/var/web/dir1</code> directory and all subdirectories.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/var/web/dir1\"&gt;\n    Options +Indexes\n&lt;/Directory&gt;</pre> <p>Directives enclosed in a <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> section apply to any file with the specified name, regardless of what directory it lies in. So for example, the following configuration directives will, when placed in the main section of the configuration file, deny access to any file named <code>private.html</code> regardless of where it is found.</p> <pre class=\"prettyprint lang-config\">&lt;Files \"private.html\"&gt;\n    Require all denied\n&lt;/Files&gt;</pre> <p>To address files found in a particular part of the filesystem, the <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> and <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> sections can be combined. For example, the following configuration will deny access to <code>/var/web/dir1/private.html</code>, <code>/var/web/dir1/subdir2/private.html</code>, <code>/var/web/dir1/subdir3/private.html</code>, and any other instance of <code>private.html</code> found under the <code>/var/web/dir1/</code> directory.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/var/web/dir1\"&gt;\n    &lt;Files \"private.html\"&gt;\n        Require all denied\n    &lt;/Files&gt;\n&lt;/Directory&gt;</pre> <h3><a name=\"webspace\" id=\"webspace\">Webspace Containers</a></h3> <p>The <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> directive and its <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regex</a> counterpart, on the other hand, change the configuration for content in the webspace. For example, the following configuration prevents access to any URL-path that begins in /private. In particular, it will apply to requests for <code>http://yoursite.example.com/private</code>, <code>http://yoursite.example.com/private123</code>, and <code>http://yoursite.example.com/private/dir/file.html</code> as well as any other requests starting with the <code>/private</code> string.</p> <pre class=\"prettyprint lang-config\">&lt;LocationMatch \"^/private\"&gt;\n    Require all denied\n&lt;/LocationMatch&gt;</pre> <p>The <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> directive need not have anything to do with the filesystem. For example, the following example shows how to map a particular URL to an internal Apache HTTP Server handler provided by <code class=\"module\"><a href=\"mod/mod_status\">mod_status</a></code>. No file called <code>server-status</code> needs to exist in the filesystem.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/server-status\"&gt;\n    SetHandler server-status\n&lt;/Location&gt;</pre> <h3><a name=\"overlapping-webspace\" id=\"overlapping-webspace\">Overlapping Webspace</a></h3> <p>In order to have two overlapping URLs one has to consider the order in which certain sections or directives are evaluated. For <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> this would be:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/foo\"&gt;\n&lt;/Location&gt;\n&lt;Location \"/foo/bar\"&gt;\n&lt;/Location&gt;</pre> <p><code class=\"directive\"><a href=\"mod/mod_alias#alias\">&lt;Alias&gt;</a></code>es on the other hand, are mapped vice-versa:</p> <pre class=\"prettyprint lang-config\">Alias \"/foo/bar\" \"/srv/www/uncommon/bar\"\nAlias \"/foo\" \"/srv/www/common/foo\"</pre> <p>The same is true for the <code class=\"directive\"><a href=\"mod/mod_proxy#proxypass\">ProxyPass</a></code> directives:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/special-area\" \"http://special.example.com\" smax=5 max=10\nProxyPass \"/\" \"balancer://mycluster/\" stickysession=JSESSIONID|jsessionid nofailover=On</pre> <h3><a name=\"wildcards\" id=\"wildcards\">Wildcards and Regular Expressions</a></h3> <p>The <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code>, and <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> directives can each use shell-style wildcard characters as in <code>fnmatch</code> from the C standard library. The character \"*\" matches any sequence of characters, \"?\" matches any single character, and \"[<em>seq</em>]\" matches any character in <em>seq</em>. The \"/\" character will not be matched by any wildcard; it must be specified explicitly.</p> <p>If even more flexible matching is required, each container has a regular expression (regex) counterpart <code class=\"directive\"><a href=\"mod/core#directorymatch\">&lt;DirectoryMatch&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code>, and <code class=\"directive\"><a href=\"mod/core#locationmatch\">&lt;LocationMatch&gt;</a></code> that allow perl-compatible <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expressions</a> to be used in choosing the matches. But see the section below on configuration merging to find out how using regex sections will change how directives are applied.</p> <p>A non-regex wildcard section that changes the configuration of all user directories could look as follows:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/home/*/public_html\"&gt;\n    Options Indexes\n&lt;/Directory&gt;</pre> <p>Using regex sections, we can deny access to many types of image files at once:</p> <pre class=\"prettyprint lang-config\">&lt;FilesMatch \"\\.(?i:gif|jpe?g|png)$\"&gt;\n    Require all denied\n&lt;/FilesMatch&gt;</pre> <p>Regular expressions containing <strong>named groups and backreferences</strong> are added to the environment with the corresponding name in uppercase. This allows elements of filename paths and URLs to be referenced from within <a href=\"expr\">expressions</a> and modules like <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code>.</p> <pre class=\"prettyprint lang-config\">&lt;DirectoryMatch \"^/var/www/combined/(?&lt;SITENAME&gt;[^/]+)\"&gt;\n    require ldap-group \"cn=%{env:MATCH_SITENAME},ou=combined,o=Example\"\n&lt;/DirectoryMatch&gt;</pre> <h3><a name=\"expressions\" id=\"expressions\">Boolean expressions</a></h3> <p>The <code class=\"directive\"><a href=\"mod/core#if\">&lt;If&gt;</a></code> directive change the configuration depending on a condition which can be expressed by a boolean expression. For example, the following configuration denies access if the HTTP Referer header does not start with \"http://www.example.com/\".</p> <pre class=\"prettyprint lang-config\">&lt;If \"!(%{HTTP_REFERER} -strmatch 'http://www.example.com/*')\"&gt;\n    Require all denied\n&lt;/If&gt;</pre> <h3><a name=\"whichwhen\" id=\"whichwhen\">What to use When</a></h3> <p>Choosing between filesystem containers and webspace containers is actually quite easy. When applying directives to objects that reside in the filesystem always use <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> or <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code>. When applying directives to objects that do not reside in the filesystem (such as a webpage generated from a database), use <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code>.</p> <p>It is important to never use <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> when trying to restrict access to objects in the filesystem. This is because many different webspace locations (URLs) could map to the same filesystem location, allowing your restrictions to be circumvented. For example, consider the following configuration:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/dir/\"&gt;\n    Require all denied\n&lt;/Location&gt;</pre> <p>This works fine if the request is for <code>http://yoursite.example.com/dir/</code>. But what if you are on a case-insensitive filesystem? Then your restriction could be easily circumvented by requesting <code>http://yoursite.example.com/DIR/</code>. The <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> directive, in contrast, will apply to any content served from that location, regardless of how it is called. (An exception is filesystem links. The same directory can be placed in more than one part of the filesystem using symbolic links. The <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> directive will follow the symbolic link without resetting the pathname. Therefore, for the highest level of security, symbolic links should be disabled with the appropriate <code class=\"directive\"><a href=\"mod/core#options\">Options</a></code> directive.)</p> <p>If you are, perhaps, thinking that none of this applies to you because you use a case-sensitive filesystem, remember that there are many other ways to map multiple webspace locations to the same filesystem location. Therefore you should always use the filesystem containers when you can. There is, however, one exception to this rule. Putting configuration restrictions in a <code>&lt;Location \"/\"&gt;</code> section is perfectly safe because this section will apply to all requests regardless of the specific URL.</p> <h3><a name=\"nesting\" id=\"nesting\">Nesting of sections</a></h3> <p>Some section types can be nested inside other section types. On the one hand, <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> can be used inside <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>. On the other hand, <code class=\"directive\"><a href=\"mod/core#if\">&lt;If&gt;</a></code> can be used inside <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code>, and <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> sections. The regex counterparts of the named section behave identically.</p> <p>Nested sections are merged after non-nested sections of the same type.</p>   <h2 id=\"virtualhost\">Virtual Hosts</h2> <p>The <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> container encloses directives that apply to specific hosts. This is useful when serving multiple hosts from the same machine with a different configuration for each. For more information, see the <a href=\"vhosts/index\">Virtual Host Documentation</a>.</p>   <h2 id=\"proxy\">Proxy</h2> <p>The <code class=\"directive\"><a href=\"mod/mod_proxy#proxy\">&lt;Proxy&gt;</a></code> and <code class=\"directive\"><a href=\"mod/mod_proxy#proxymatch\">&lt;ProxyMatch&gt;</a></code> containers apply enclosed configuration directives only to sites accessed through <code class=\"module\"><a href=\"mod/mod_proxy\">mod_proxy</a></code>'s proxy server that match the specified URL. For example, the following configuration will allow only a subset of clients to access the <code>www.example.com</code> website using the proxy server:</p> <pre class=\"prettyprint lang-config\">&lt;Proxy \"http://www.example.com/*\"&gt;\n    Require host yournetwork.example.com\n&lt;/Proxy&gt;</pre>   <h2 id=\"whatwhere\">What Directives are Allowed?</h2> <p>To find out what directives are allowed in what types of configuration sections, check the Context of the directive. Everything that is allowed in <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> sections is also syntactically allowed in <code class=\"directive\"><a href=\"mod/core#directorymatch\">&lt;DirectoryMatch&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#locationmatch\">&lt;LocationMatch&gt;</a></code>, <code class=\"directive\"><a href=\"mod/mod_proxy#proxy\">&lt;Proxy&gt;</a></code>, and <code class=\"directive\"><a href=\"mod/mod_proxy#proxymatch\">&lt;ProxyMatch&gt;</a></code> sections. There are some exceptions, however:</p> <ul> <li>The <code class=\"directive\"><a href=\"mod/core#allowoverride\">AllowOverride</a></code> directive works only in <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> sections.</li> <li>The <code>FollowSymLinks</code> and <code>SymLinksIfOwnerMatch</code> <code class=\"directive\"><a href=\"mod/core#options\">Options</a></code> work only in <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> sections or <code>.htaccess</code> files.</li> <li>The <code class=\"directive\"><a href=\"mod/core#options\">Options</a></code> directive cannot be used in <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> and <code class=\"directive\"><a href=\"mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code> sections.</li> </ul>   <h2 id=\"merging\">How the sections are merged</h2> <p>The configuration sections are applied in a very particular order. Since this can have important effects on how configuration directives are interpreted, it is important to understand how this works.</p> <p>The order of merging is:</p> <ol> <li> <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> (except regular expressions) and <code>.htaccess</code> done simultaneously (with <code>.htaccess</code>, if allowed, overriding <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>)</li> <li>\n<code class=\"directive\"><a href=\"mod/core#directorymatch\">&lt;DirectoryMatch&gt;</a></code> (and <code>&lt;Directory \"~\"&gt;</code>)</li> <li>\n<code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> and <code class=\"directive\"><a href=\"mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code> done simultaneously</li> <li>\n<code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> and <code class=\"directive\"><a href=\"mod/core#locationmatch\">&lt;LocationMatch&gt;</a></code> done simultaneously</li> <li>\n<code class=\"directive\"><a href=\"mod/core#if\">&lt;If&gt;</a></code> </li> </ol> <p>Apart from <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>, each group is processed in the order that they appear in the configuration files. <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> (group 1 above) is processed in the order shortest directory component to longest. So for example, <code>&lt;Directory \"/var/web/dir\"&gt;</code> will be processed before <code>&lt;Directory \"/var/web/dir/subdir\"&gt;</code>. If multiple <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> sections apply to the same directory they are processed in the configuration file order. Configurations included via the <code class=\"directive\"><a href=\"mod/core#include\">Include</a></code> directive will be treated as if they were inside the including file at the location of the <code class=\"directive\"><a href=\"mod/core#include\">Include</a></code> directive.</p> <p>Sections inside <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> sections are applied <em>after</em> the corresponding sections outside the virtual host definition. This allows virtual hosts to override the main server configuration.</p> <p>When the request is served by <code class=\"module\"><a href=\"mod/mod_proxy\">mod_proxy</a></code>, the <code class=\"directive\"><a href=\"mod/mod_proxy#proxy\">&lt;Proxy&gt;</a></code> container takes the place of the <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> container in the processing order.</p> <div class=\"note\">\n<p><strong>Technical Note</strong></p> There is actually a <code>&lt;Location&gt;</code>/<code>&lt;LocationMatch&gt;</code> sequence performed just before the name translation phase (where <code>Aliases</code> and <code>DocumentRoots</code> are used to map URLs to filenames). The results of this sequence are completely thrown away after the translation has completed. </div> <h3><a name=\"relationship-module-configuration\" id=\"relationship-module-configuration\">Relationship between modules and configuration sections</a></h3> <p>One question that often arises after reading how configuration sections are merged is related to how and when directives of specific modules like <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code> are processed. The answer is not trivial and needs a bit of background. Each httpd module manages its own configuration, and each of its directives in httpd.conf specify one piece of configuration in a particular context. httpd does not execute a command as it is read.</p> <p>At runtime, the core of httpd iterates over the defined configuration sections in the order described above to determine which ones apply to the current request. When the first section matches, it is considered the current configuration for this request. If a subsequent section matches too, then each module with a directive in either of the sections is given a chance to merge its configuration between the two sections. The result is a third configuration, and the process goes on until all the configuration sections are evaluated.</p> <p>After the above step, the \"real\" processing of the HTTP request begins: each module has a chance to run and perform whatever tasks they like. They can retrieve their own final merged configuration from the core of the httpd to determine how they should act.</p> <p>An example can help to visualize the whole process. The following configuration uses the <code class=\"directive\"><a href=\"mod/mod_headers#header\">Header</a></code> directive of <code class=\"module\"><a href=\"mod/mod_headers\">mod_headers</a></code> to set a specific HTTP header. What value will httpd set in the <code>CustomHeaderName</code> header for a request to <code>/example/index.html</code> ? </p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/\"&gt;\n    Header set CustomHeaderName one\n    &lt;FilesMatch \".*\"&gt;\n        Header set CustomHeaderName three\n    &lt;/FilesMatch&gt;\n&lt;/Directory&gt;\n\n&lt;Directory \"/example\"&gt;\n    Header set CustomHeaderName two\n&lt;/Directory&gt;</pre> <ul> <li>\n<code class=\"directive\">Directory</code> \"/\" matches and an initial configuration to set the <code>CustomHeaderName</code> header with the value <code>one</code> is created.</li> <li>\n<code class=\"directive\">Directory</code> \"/example\" matches, and since <code class=\"module\"><a href=\"mod/mod_headers\">mod_headers</a></code> specifies in its code to override in case of a merge, a new configuration is created to set the <code>CustomHeaderName</code> header with the value <code>two</code>.</li> <li>\n<code class=\"directive\">FilesMatch</code> \".*\" matches and another merge opportunity arises, causing the <code>CustomHeaderName</code> header to be set with the value <code>three</code>.</li> <li>Eventually during the next steps of the HTTP request processing <code class=\"module\"><a href=\"mod/mod_headers\">mod_headers</a></code> will be called and it will receive the configuration to set the <code>CustomHeaderName</code> header with the value <code>three</code>. <code class=\"module\"><a href=\"mod/mod_headers\">mod_headers</a></code> normally uses this configuration to perfom its job, namely setting the foo header. This does not mean that a module can't perform a more complex action like discarding directives because not needed or deprecated, etc..</li> </ul> <p>This is true for .htaccess too since they have the same priority as <code class=\"directive\">Directory</code> in the merge order. The important concept to understand is that configuration sections like <code class=\"directive\">Directory</code> and <code class=\"directive\">FilesMatch</code> are not comparable to module specific directives like <code class=\"directive\"><a href=\"mod/mod_headers#header\">Header</a></code> or <code class=\"directive\"><a href=\"mod/mod_rewrite#rewriterule\">RewriteRule</a></code> because they operate on different levels. </p> <h3><a name=\"merge-examples\" id=\"merge-examples\">Some useful examples</a></h3> <p>Below is an artificial example to show the order of merging. Assuming they all apply to the request, the directives in this example will be applied in the order A &gt; B &gt; C &gt; D &gt; E.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\n    E\n&lt;/Location&gt;\n\n&lt;Files \"f.html\"&gt;\n    D\n&lt;/Files&gt;\n\n&lt;VirtualHost *&gt;\n&lt;Directory \"/a/b\"&gt;\n    B\n&lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n\n&lt;DirectoryMatch \"^.*b$\"&gt;\n    C\n&lt;/DirectoryMatch&gt;\n\n&lt;Directory \"/a/b\"&gt;\n    A\n&lt;/Directory&gt;</pre> <p>For a more concrete example, consider the following. Regardless of any access restrictions placed in <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code> sections, the <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> section will be evaluated last and will allow unrestricted access to the server. In other words, order of merging is important, so be careful!</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\n    Require all granted\n&lt;/Location&gt;\n\n# Woops!  This &lt;Directory&gt; section will have no effect\n&lt;Directory \"/\"&gt;\n    &lt;RequireAll&gt;\n        Require all granted\n        Require not host badguy.example.com\n    &lt;/RequireAll&gt;\n&lt;/Directory&gt;</pre><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/sections.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/sections.html</a>\n  </p>\n</div>\n","caching":"<h1>Caching Guide</h1>  <p>This document supplements the <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code>, <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code>, <code class=\"module\"><a href=\"mod/mod_file_cache\">mod_file_cache</a></code> and <a href=\"programs/htcacheclean\">htcacheclean</a> reference documentation. It describes how to use the Apache HTTP Server's caching features to accelerate web and proxy serving, while avoiding common problems and misconfigurations.</p>     <h2 id=\"introduction\">Introduction</h2> <p>The Apache HTTP server offers a range of caching features that are designed to improve the performance of the server in various ways.</p> <dl> <dt>Three-state RFC2616 HTTP caching</dt> <dd> <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> and its provider modules <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code> provide intelligent, HTTP-aware caching. The content itself is stored in the cache, and mod_cache aims to honor all of the various HTTP headers and options that control the cacheability of content as described in <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html\">Section 13 of RFC2616</a>. <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> is aimed at both simple and complex caching configurations, where you are dealing with proxied content, dynamic local content or have a need to speed up access to local files on a potentially slow disk. </dd> <dt>Two-state key/value shared object caching</dt> <dd> The <a href=\"socache\">shared object cache API</a> (socache) and its provider modules provide a server wide key/value based shared object cache. These modules are designed to cache low level data such as SSL sessions and authentication credentials. Backends allow the data to be stored server wide in shared memory, or datacenter wide in a cache such as memcache or distcache. </dd> <dt>Specialized file caching</dt> <dd> <code class=\"module\"><a href=\"mod/mod_file_cache\">mod_file_cache</a></code> offers the ability to pre-load files into memory on server startup, and can improve access times and save file handles on files that are accessed often, as there is no need to go to disk on each request. </dd> </dl> <p>To get the most from this document, you should be familiar with the basics of HTTP, and have read the Users' Guides to <a href=\"urlmapping\">Mapping URLs to the Filesystem</a> and <a href=\"content-negotiation\">Content negotiation</a>.</p>   <h2 id=\"http-caching\">Three-state RFC2616 HTTP caching</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_cache#cacheenable\">CacheEnable</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_cache#cachedisable\">CacheDisable</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#usecanonicalname\">UseCanonicalName</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_negotiation#cachenegotiateddocs\">CacheNegotiatedDocs</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The HTTP protocol contains built in support for an in-line caching mechanism <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html\"> described by section 13 of RFC2616</a>, and the <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> module can be used to take advantage of this.</p> <p>Unlike a simple two state key/value cache where the content disappears completely when no longer fresh, an HTTP cache includes a mechanism to retain stale content, and to ask the origin server whether this stale content has changed and if not, make it fresh again.</p> <p>An entry in an HTTP cache exists in one of three states:</p> <dl> <dt>Fresh</dt> <dd> If the content is new enough (younger than its <strong>freshness lifetime</strong>), it is considered <strong>fresh</strong>. An HTTP cache is free to serve fresh content without making any calls to the origin server at all. </dd> <dt>Stale</dt> <dd> <p>If the content is too old (older than its <strong>freshness lifetime</strong>), it is considered <strong>stale</strong>. An HTTP cache should contact the origin server and check whether the content is still fresh before serving stale content to a client. The origin server will either respond with replacement content if not still valid, or ideally, the origin server will respond with a code to tell the cache the content is still fresh, without the need to generate or send the content again. The content becomes fresh again and the cycle continues.</p> <p>The HTTP protocol does allow the cache to serve stale data under certain circumstances, such as when an attempt to freshen the data with an origin server has failed with a 5xx error, or when another request is already in the process of freshening the given entry. In these cases a <code>Warning</code> header is added to the response.</p> </dd> <dt>Non Existent</dt> <dd> If the cache gets full, it reserves the option to delete content from the cache to make space. Content can be deleted at any time, and can be stale or fresh. The <a href=\"programs/htcacheclean\">htcacheclean</a> tool can be run on a once off basis, or deployed as a daemon to keep the size of the cache within the given size, or the given number of inodes. The tool attempts to delete stale content before attempting to delete fresh content. </dd> </dl> <p>Full details of how HTTP caching works can be found in <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html\"> Section 13 of RFC2616</a>.</p> <h3>Interaction with the Server</h3> <p>The <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> module hooks into the server in two possible places depending on the value of the <code class=\"directive\"><a href=\"mod/mod_cache#cachequickhandler\">CacheQuickHandler</a></code> directive: </p> <dl> <dt>Quick handler phase</dt> <dd> <p>This phase happens very early on during the request processing, just after the request has been parsed. If the content is found within the cache, it is served immediately and almost all request processing is bypassed.</p> <p>In this scenario, the cache behaves as if it has been \"bolted on\" to the front of the server.</p> <p>This mode offers the best performance, as the majority of server processing is bypassed. This mode however also bypasses the authentication and authorization phases of server processing, so this mode should be chosen with care when this is important.</p> <p> Requests with an \"Authorization\" header (for example, HTTP Basic Authentication) are neither cacheable nor served from the cache when <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> is running in this phase.</p> </dd> <dt>Normal handler phase</dt> <dd> <p>This phase happens late in the request processing, after all the request phases have completed.</p> <p>In this scenario, the cache behaves as if it has been \"bolted on\" to the back of the server.</p> <p>This mode offers the most flexibility, as the potential exists for caching to occur at a precisely controlled point in the filter chain, and cached content can be filtered or personalized before being sent to the client.</p> </dd> </dl> <p>If the URL is not found within the cache, <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> will add a <a href=\"filter\">filter</a> to the filter stack in order to record the response to the cache, and then stand down, allowing normal request processing to continue. If the content is determined to be cacheable, the content will be saved to the cache for future serving, otherwise the content will be ignored.</p> <p>If the content found within the cache is stale, the <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> module converts the request into a <strong>conditional request</strong>. If the origin server responds with a normal response, the normal response is cached, replacing the content already cached. If the origin server responds with a 304 Not Modified response, the content is marked as fresh again, and the cached content is served by the filter instead of saving it.</p> <h3>Improving Cache Hits</h3> <p>When a virtual host is known by one of many different server aliases, ensuring that <code class=\"directive\"><a href=\"mod/core#usecanonicalname\">UseCanonicalName</a></code> is set to <code>On</code> can dramatically improve the ratio of cache hits. This is because the hostname of the virtual-host serving the content is used within the cache key. With the setting set to <code>On</code> virtual-hosts with multiple server names or aliases will not produce differently cached entities, and instead content will be cached as per the canonical hostname.</p> <h3>Freshness Lifetime</h3> <p>Well formed content that is intended to be cached should declare an explicit freshness lifetime with the <code>Cache-Control</code> header's <code>max-age</code> or <code>s-maxage</code> fields, or by including an <code>Expires</code> header.</p> <p>At the same time, the origin server defined freshness lifetime can be overridden by a client when the client presents their own <code>Cache-Control</code> header within the request. In this case, the lowest freshness lifetime between request and response wins.</p> <p>When this freshness lifetime is missing from the request or the response, a default freshness lifetime is applied. The default freshness lifetime for cached entities is one hour, however this can be easily over-ridden by using the <code class=\"directive\"><a href=\"mod/mod_cache#cachedefaultexpire\">CacheDefaultExpire</a></code> directive.</p> <p>If a response does not include an <code>Expires</code> header but does include a <code>Last-Modified</code> header, <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> can infer a freshness lifetime based on a heuristic, which can be controlled through the use of the <code class=\"directive\"><a href=\"mod/mod_cache#cachelastmodifiedfactor\">CacheLastModifiedFactor</a></code> directive.</p> <p>For local content, or for remote content that does not define its own <code>Expires</code> header, <code class=\"module\"><a href=\"mod/mod_expires\">mod_expires</a></code> may be used to fine-tune the freshness lifetime by adding <code>max-age</code> and <code>Expires</code>.</p> <p>The maximum freshness lifetime may also be controlled by using the <code class=\"directive\"><a href=\"mod/mod_cache#cachemaxexpire\">CacheMaxExpire</a></code>.</p> <h3>A Brief Guide to Conditional Requests</h3> <p>When content expires from the cache and becomes stale, rather than pass on the original request, httpd will modify the request to make it conditional instead.</p> <p>When an <code>ETag</code> header exists in the original cached response, <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> will add an <code>If-None-Match</code> header to the request to the origin server. When a <code>Last-Modified</code> header exists in the original cached response, <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> will add an <code>If-Modified-Since</code> header to the request to the origin server. Performing either of these actions makes the request <strong>conditional</strong>.</p> <p>When a conditional request is received by an origin server, the origin server should check whether the ETag or the Last-Modified parameter has changed, as appropriate for the request. If not, the origin should respond with a terse \"304 Not Modified\" response. This signals to the cache that the stale content is still fresh should be used for subsequent requests until the content's new freshness lifetime is reached again.</p> <p>If the content has changed, then the content is served as if the request were not conditional to begin with.</p> <p>Conditional requests offer two benefits. Firstly, when making such a request to the origin server, if the content from the origin matches the content in the cache, this can be determined easily and without the overhead of transferring the entire resource.</p> <p>Secondly, a well designed origin server will be designed in such a way that conditional requests will be significantly cheaper to produce than a full response. For static files, typically all that is involved is a call to <code>stat()</code> or similar system call, to see if the file has changed in size or modification time. As such, even local content may still be served faster from the cache if it has not changed.</p> <p>Origin servers should make every effort to support conditional requests as is practical, however if conditional requests are not supported, the origin will respond as if the request was not conditional, and the cache will respond as if the content had changed and save the new content to the cache. In this case, the cache will behave like a simple two state cache, where content is effectively either fresh or deleted.</p> <h3>What Can be Cached?</h3> <p>The full definition of which responses can be cached by an HTTP cache is defined in <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.4\"> RFC2616 Section 13.4 Response Cacheability</a>, and can be summed up as follows:</p> <ol> <li>Caching must be enabled for this URL. See the <code class=\"directive\"><a href=\"mod/mod_cache#cacheenable\">CacheEnable</a></code> and <code class=\"directive\"><a href=\"mod/mod_cache#cachedisable\">CacheDisable</a></code> directives.</li> <li>The response must have a HTTP status code of 200, 203, 300, 301 or 410.</li> <li>The request must be a HTTP GET request.</li> <li>If the response contains an \"Authorization:\" header, it must also contain an \"s-maxage\", \"must-revalidate\" or \"public\" option in the \"Cache-Control:\" header, or it won't be cached.</li> <li>If the URL included a query string (e.g. from a HTML form GET method) it will not be cached unless the response specifies an explicit expiration by including an \"Expires:\" header or the max-age or s-maxage directive of the \"Cache-Control:\" header, as per RFC2616 sections 13.9 and 13.2.1.</li> <li>If the response has a status of 200 (OK), the response must also include at least one of the \"Etag\", \"Last-Modified\" or the \"Expires\" headers, or the max-age or s-maxage directive of the \"Cache-Control:\" header, unless the <code class=\"directive\"><a href=\"mod/mod_cache#cacheignorenolastmod\">CacheIgnoreNoLastMod</a></code> directive has been used to require otherwise.</li> <li>If the response includes the \"private\" option in a \"Cache-Control:\" header, it will not be stored unless the <code class=\"directive\"><a href=\"mod/mod_cache#cachestoreprivate\">CacheStorePrivate</a></code> has been used to require otherwise.</li> <li>Likewise, if the response includes the \"no-store\" option in a \"Cache-Control:\" header, it will not be stored unless the <code class=\"directive\"><a href=\"mod/mod_cache#cachestorenostore\">CacheStoreNoStore</a></code> has been used.</li> <li>A response will not be stored if it includes a \"Vary:\" header containing the match-all \"*\".</li> </ol> <h3>What Should Not be Cached?</h3> <p>It should be up to the client creating the request, or the origin server constructing the response to decide whether or not the content should be cacheable or not by correctly setting the <code>Cache-Control</code> header, and <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> should be left alone to honor the wishes of the client or server as appropriate. </p> <p>Content that is time sensitive, or which varies depending on the particulars of the request that are not covered by HTTP negotiation, should not be cached. This content should declare itself uncacheable using the <code>Cache-Control</code> header.</p> <p>If content changes often, expressed by a freshness lifetime of minutes or seconds, the content can still be cached, however it is highly desirable that the origin server supports <strong>conditional requests</strong> correctly to ensure that full responses do not have to be generated on a regular basis.</p> <p>Content that varies based on client provided request headers can be cached through intelligent use of the <code>Vary</code> response header.</p> <h3>Variable/Negotiated Content</h3> <p>When the origin server is designed to respond with different content based on the value of headers in the request, for example to serve multiple languages at the same URL, HTTP's caching mechanism makes it possible to cache multiple variants of the same page at the same URL.</p> <p>This is done by the origin server adding a <code>Vary</code> header to indicate which headers must be taken into account by a cache when determining whether two variants are different from one another.</p> <p>If for example, a response is received with a vary header such as;</p> <div class=\"example\"><pre>Vary: negotiate,accept-language,accept-charset</pre></div> <p><code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> will only serve the cached content to requesters with accept-language and accept-charset headers matching those of the original request.</p> <p>Multiple variants of the content can be cached side by side, <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> uses the <code>Vary</code> header and the corresponding values of the request headers listed by <code>Vary</code> to decide on which of many variants to return to the client.</p> <h3><a name=\"disk\" id=\"disk\">Caching to Disk</a></h3> <p>The <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> module relies on specific backend store implementations in order to manage the cache, and for caching to disk <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code> is provided to support this.</p> <p>Typically the module will be configured as so;</p> <pre class=\"prettyprint lang-config\">CacheRoot   \"/var/cache/apache/\"\nCacheEnable disk /\nCacheDirLevels 2\nCacheDirLength 1</pre> <p>Importantly, as the cached files are locally stored, operating system in-memory caching will typically be applied to their access also. So although the files are stored on disk, if they are frequently accessed it is likely the operating system will ensure that they are actually served from memory.</p> <h3>Understanding the Cache-Store</h3> <p>To store items in the cache, <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code> creates a 22 character hash of the URL being requested. This hash incorporates the hostname, protocol, port, path and any CGI arguments to the URL, as well as elements defined by the Vary header to ensure that multiple URLs do not collide with one another.</p> <p>Each character may be any one of 64-different characters, which mean that overall there are 64^22 possible hashes. For example, a URL might be hashed to <code>xyTGxSMO2b68mBCykqkp1w</code>. This hash is used as a prefix for the naming of the files specific to that URL within the cache, however first it is split up into directories as per the <code class=\"directive\"><a href=\"mod/mod_cache_disk#cachedirlevels\">CacheDirLevels</a></code> and <code class=\"directive\"><a href=\"mod/mod_cache_disk#cachedirlength\">CacheDirLength</a></code> directives.</p> <p><code class=\"directive\"><a href=\"mod/mod_cache_disk#cachedirlevels\">CacheDirLevels</a></code> specifies how many levels of subdirectory there should be, and <code class=\"directive\"><a href=\"mod/mod_cache_disk#cachedirlength\">CacheDirLength</a></code> specifies how many characters should be in each directory. With the example settings given above, the hash would be turned into a filename prefix as <code>/var/cache/apache/x/y/TGxSMO2b68mBCykqkp1w</code>.</p> <p>The overall aim of this technique is to reduce the number of subdirectories or files that may be in a particular directory, as most file-systems slow down as this number increases. With setting of \"1\" for <code class=\"directive\"><a href=\"mod/mod_cache_disk#cachedirlength\">CacheDirLength</a></code> there can at most be 64 subdirectories at any particular level. With a setting of 2 there can be 64 * 64 subdirectories, and so on. Unless you have a good reason not to, using a setting of \"1\" for <code class=\"directive\"><a href=\"mod/mod_cache_disk#cachedirlength\">CacheDirLength</a></code> is recommended.</p> <p>Setting <code class=\"directive\"><a href=\"mod/mod_cache_disk#cachedirlevels\">CacheDirLevels</a></code> depends on how many files you anticipate to store in the cache. With the setting of \"2\" used in the above example, a grand total of 4096 subdirectories can ultimately be created. With 1 million files cached, this works out at roughly 245 cached URLs per directory.</p> <p>Each URL uses at least two files in the cache-store. Typically there is a \".header\" file, which includes meta-information about the URL, such as when it is due to expire and a \".data\" file which is a verbatim copy of the content to be served.</p> <p>In the case of a content negotiated via the \"Vary\" header, a \".vary\" directory will be created for the URL in question. This directory will have multiple \".data\" files corresponding to the differently negotiated content.</p> <h3>Maintaining the Disk Cache</h3> <p>The <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code> module makes no attempt to regulate the amount of disk space used by the cache, although it will gracefully stand down on any disk error and behave as if the cache was never present.</p> <p>Instead, provided with httpd is the <a href=\"programs/htcacheclean\">htcacheclean</a> tool which allows you to clean the cache periodically. Determining how frequently to run <a href=\"programs/htcacheclean\">htcacheclean</a> and what target size to use for the cache is somewhat complex and trial and error may be needed to select optimal values.</p> <p><a href=\"programs/htcacheclean\">htcacheclean</a> has two modes of operation. It can be run as persistent daemon, or periodically from cron. <a href=\"programs/htcacheclean\">htcacheclean</a> can take up to an hour or more to process very large (tens of gigabytes) caches and if you are running it from cron it is recommended that you determine how long a typical run takes, to avoid running more than one instance at a time.</p> <p>It is also recommended that an appropriate \"nice\" level is chosen for htcacheclean so that the tool does not cause excessive disk io while the server is running.</p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/caching_fig1.gif\" alt=\"\" width=\"600\" height=\"406\"><br> <a id=\"figure1\" name=\"figure1\"><dfn>Figure 1</dfn></a>: Typical cache growth / clean sequence.</p> <p>Because <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code> does not itself pay attention to how much space is used you should ensure that <a href=\"programs/htcacheclean\">htcacheclean</a> is configured to leave enough \"grow room\" following a clean.</p>   <h2 id=\"socache-caching\">Two-state Key/Value Shared Object Caching</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_authn_socache\">mod_authn_socache</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_socache_dbm\">mod_socache_dbm</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_socache_dc\">mod_socache_dc</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_socache_memcache\">mod_socache_memcache</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_socache_shmcb\">mod_socache_shmcb</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_ssl\">mod_ssl</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_authn_socache#authncachesocache\">AuthnCacheSOCache</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_ssl#sslsessioncache\">SSLSessionCache</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_ssl#sslstaplingcache\">SSLStaplingCache</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The Apache HTTP server offers a low level shared object cache for caching information such as SSL sessions, or authentication credentials, within the <a href=\"socache\">socache</a> interface.</p> <p>Additional modules are provided for each implementation, offering the following backends:</p> <dl> <dt><code class=\"module\"><a href=\"mod/mod_socache_dbm\">mod_socache_dbm</a></code></dt> <dd>DBM based shared object cache.</dd> <dt><code class=\"module\"><a href=\"mod/mod_socache_dc\">mod_socache_dc</a></code></dt> <dd>Distcache based shared object cache.</dd> <dt><code class=\"module\"><a href=\"mod/mod_socache_memcache\">mod_socache_memcache</a></code></dt> <dd>Memcache based shared object cache.</dd> <dt><code class=\"module\"><a href=\"mod/mod_socache_shmcb\">mod_socache_shmcb</a></code></dt> <dd>Shared memory based shared object cache.</dd> </dl> <h3><a name=\"mod_authn_socache-caching\" id=\"mod_authn_socache-caching\">Caching Authentication Credentials</a></h3> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"mod/mod_authn_socache\">mod_authn_socache</a></code></li></ul></td>\n<td><ul><li><code class=\"directive\"><a href=\"mod/mod_authn_socache#authncachesocache\">AuthnCacheSOCache</a></code></li></ul></td>\n</tr>\n</table> <p>The <code class=\"module\"><a href=\"mod/mod_authn_socache\">mod_authn_socache</a></code> module allows the result of authentication to be cached, relieving load on authentication backends.</p> <h3><a name=\"mod_ssl-caching\" id=\"mod_ssl-caching\">Caching SSL Sessions</a></h3> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"mod/mod_ssl\">mod_ssl</a></code></li></ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_ssl#sslsessioncache\">SSLSessionCache</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_ssl#sslstaplingcache\">SSLStaplingCache</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The <code class=\"module\"><a href=\"mod/mod_ssl\">mod_ssl</a></code> module uses the <code>socache</code> interface to provide a session cache and a stapling cache.</p>   <h2 id=\"file-caching\">Specialized File Caching</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"mod/mod_file_cache\">mod_file_cache</a></code></li></ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_file_cache#cachefile\">CacheFile</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_file_cache#mmapfile\">MMapFile</a></code></li>\n</ul></td>\n</tr>\n</table> <p>On platforms where a filesystem might be slow, or where file handles are expensive, the option exists to pre-load files into memory on startup.</p> <p>On systems where opening files is slow, the option exists to open the file on startup and cache the file handle. These options can help on systems where access to static files is slow.</p> <h3><a name=\"filehandle\" id=\"filehandle\">File-Handle Caching</a></h3> <p>The act of opening a file can itself be a source of delay, particularly on network filesystems. By maintaining a cache of open file descriptors for commonly served files, httpd can avoid this delay. Currently httpd provides one implementation of File-Handle Caching.</p> <h4>CacheFile</h4> <p>The most basic form of caching present in httpd is the file-handle caching provided by <code class=\"module\"><a href=\"mod/mod_file_cache\">mod_file_cache</a></code>. Rather than caching file-contents, this cache maintains a table of open file descriptors. Files to be cached in this manner are specified in the configuration file using the <code class=\"directive\"><a href=\"mod/mod_file_cache#cachefile\">CacheFile</a></code> directive.</p> <p>The <code class=\"directive\"><a href=\"mod/mod_file_cache#cachefile\">CacheFile</a></code> directive instructs httpd to open the file when it is started and to re-use this file-handle for all subsequent access to this file.</p> <pre class=\"prettyprint lang-config\">CacheFile /usr/local/apache2/htdocs/index.html</pre> <p>If you intend to cache a large number of files in this manner, you must ensure that your operating system's limit for the number of open files is set appropriately.</p> <p>Although using <code class=\"directive\"><a href=\"mod/mod_file_cache#cachefile\">CacheFile</a></code> does not cause the file-contents to be cached per-se, it does mean that if the file changes while httpd is running these changes will not be picked up. The file will be consistently served as it was when httpd was started.</p> <p>If the file is removed while httpd is running, it will continue to maintain an open file descriptor and serve the file as it was when httpd was started. This usually also means that although the file will have been deleted, and not show up on the filesystem, extra free space will not be recovered until httpd is stopped and the file descriptor closed.</p> <h3><a name=\"inmemory\" id=\"inmemory\">In-Memory Caching</a></h3> <p>Serving directly from system memory is universally the fastest method of serving content. Reading files from a disk controller or, even worse, from a remote network is orders of magnitude slower. Disk controllers usually involve physical processes, and network access is limited by your available bandwidth. Memory access on the other hand can take mere nano-seconds.</p> <p>System memory isn't cheap though, byte for byte it's by far the most expensive type of storage and it's important to ensure that it is used efficiently. By caching files in memory you decrease the amount of memory available on the system. As we'll see, in the case of operating system caching, this is not so much of an issue, but when using httpd's own in-memory caching it is important to make sure that you do not allocate too much memory to a cache. Otherwise the system will be forced to swap out memory, which will likely degrade performance.</p> <h4>Operating System Caching</h4> <p>Almost all modern operating systems cache file-data in memory managed directly by the kernel. This is a powerful feature, and for the most part operating systems get it right. For example, on Linux, let's look at the difference in the time it takes to read a file for the first time and the second time;</p> <div class=\"example\"><pre>colm@coroebus:~$ time cat testfile &gt; /dev/null\nreal    0m0.065s\nuser    0m0.000s\nsys     0m0.001s\ncolm@coroebus:~$ time cat testfile &gt; /dev/null\nreal    0m0.003s\nuser    0m0.003s\nsys     0m0.000s</pre></div> <p>Even for this small file, there is a huge difference in the amount of time it takes to read the file. This is because the kernel has cached the file contents in memory.</p> <p>By ensuring there is \"spare\" memory on your system, you can ensure that more and more file-contents will be stored in this cache. This can be a very efficient means of in-memory caching, and involves no extra configuration of httpd at all.</p> <p>Additionally, because the operating system knows when files are deleted or modified, it can automatically remove file contents from the cache when necessary. This is a big advantage over httpd's in-memory caching which has no way of knowing when a file has changed.</p> <p>Despite the performance and advantages of automatic operating system caching there are some circumstances in which in-memory caching may be better performed by httpd.</p> <h4>MMapFile Caching</h4> <p><code class=\"module\"><a href=\"mod/mod_file_cache\">mod_file_cache</a></code> provides the <code class=\"directive\"><a href=\"mod/mod_file_cache#mmapfile\">MMapFile</a></code> directive, which allows you to have httpd map a static file's contents into memory at start time (using the mmap system call). httpd will use the in-memory contents for all subsequent accesses to this file.</p> <pre class=\"prettyprint lang-config\">MMapFile /usr/local/apache2/htdocs/index.html</pre> <p>As with the <code class=\"directive\"><a href=\"mod/mod_file_cache#cachefile\">CacheFile</a></code> directive, any changes in these files will not be picked up by httpd after it has started.</p> <p> The <code class=\"directive\"><a href=\"mod/mod_file_cache#mmapfile\">MMapFile</a></code> directive does not keep track of how much memory it allocates, so you must ensure not to over-use the directive. Each httpd child process will replicate this memory, so it is critically important to ensure that the files mapped are not so large as to cause the system to swap memory.</p>   <h2 id=\"security\">Security Considerations</h2> <h3>Authorization and Access Control</h3> <p>Using <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> in its default state where <code class=\"directive\"><a href=\"mod/mod_cache#cachequickhandler\">CacheQuickHandler</a></code> is set to <code>On</code> is very much like having a caching reverse-proxy bolted to the front of the server. Requests will be served by the caching module unless it determines that the origin server should be queried just as an external cache would, and this drastically changes the security model of httpd.</p> <p>As traversing a filesystem hierarchy to examine potential <code>.htaccess</code> files would be a very expensive operation, partially defeating the point of caching (to speed up requests), <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> makes no decision about whether a cached entity is authorised for serving. In other words; if <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> has cached some content, it will be served from the cache as long as that content has not expired.</p> <p>If, for example, your configuration permits access to a resource by IP address you should ensure that this content is not cached. You can do this by using the <code class=\"directive\"><a href=\"mod/mod_cache#cachedisable\">CacheDisable</a></code> directive, or <code class=\"module\"><a href=\"mod/mod_expires\">mod_expires</a></code>. Left unchecked, <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> - very much like a reverse proxy - would cache the content when served and then serve it to any client, on any IP address.</p> <p>When the <code class=\"directive\"><a href=\"mod/mod_cache#cachequickhandler\">CacheQuickHandler</a></code> directive is set to <code>Off</code>, the full set of request processing phases are executed and the security model remains unchanged.</p> <h3>Local exploits</h3> <p>As requests to end-users can be served from the cache, the cache itself can become a target for those wishing to deface or interfere with content. It is important to bear in mind that the cache must at all times be writable by the user which httpd is running as. This is in stark contrast to the usually recommended situation of maintaining all content unwritable by the Apache user.</p> <p>If the Apache user is compromised, for example through a flaw in a CGI process, it is possible that the cache may be targeted. When using <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code>, it is relatively easy to insert or modify a cached entity.</p> <p>This presents a somewhat elevated risk in comparison to the other types of attack it is possible to make as the Apache user. If you are using <code class=\"module\"><a href=\"mod/mod_cache_disk\">mod_cache_disk</a></code> you should bear this in mind - ensure you upgrade httpd when security upgrades are announced and run CGI processes as a non-Apache user using <a href=\"suexec\">suEXEC</a> if possible.</p> <h3>Cache Poisoning</h3> <p>When running httpd as a caching proxy server, there is also the potential for so-called cache poisoning. Cache Poisoning is a broad term for attacks in which an attacker causes the proxy server to retrieve incorrect (and usually undesirable) content from the origin server.</p> <p>For example if the DNS servers used by your system running httpd are vulnerable to DNS cache poisoning, an attacker may be able to control where httpd connects to when requesting content from the origin server. Another example is so-called HTTP request-smuggling attacks.</p> <p>This document is not the correct place for an in-depth discussion of HTTP request smuggling (instead, try your favourite search engine) however it is important to be aware that it is possible to make a series of requests, and to exploit a vulnerability on an origin webserver such that the attacker can entirely control the content retrieved by the proxy.</p> <h3>Denial of Service / Cachebusting</h3> <p>The Vary mechanism allows multiple variants of the same URL to be cached side by side. Depending on header values provided by the client, the cache will select the correct variant to return to the client. This mechanism can become a problem when an attempt is made to vary on a header that is known to contain a wide range of possible values under normal use, for example the <code>User-Agent</code> header. Depending on the popularity of the particular web site thousands or millions of duplicate cache entries could be created for the same URL, crowding out other entries in the cache.</p> <p>In other cases, there may be a need to change the URL of a particular resource on every request, usually by adding a \"cachebuster\" string to the URL. If this content is declared cacheable by a server for a significant freshness lifetime, these entries can crowd out legitimate entries in a cache. While <code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> provides a <code class=\"directive\"><a href=\"mod/mod_cache#cacheignoreurlsessionidentifiers\">CacheIgnoreURLSessionIdentifiers</a></code> directive, this directive should be used with care to ensure that downstream proxy or browser caches aren't subjected to the same denial of service issue.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/caching.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/caching.html</a>\n  </p>\n</div>\n","logs":"<h1>Log Files</h1>  <p>In order to effectively manage a web server, it is necessary to get feedback about the activity and performance of the server as well as any problems that may be occurring. The Apache HTTP Server provides very comprehensive and flexible logging capabilities. This document describes how to configure its logging capabilities, and how to understand what the logs contain.</p>     <h2 id=\"overview\">Overview</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_log_config\">mod_log_config</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_log_forensic\">mod_log_forensic</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_logio\">mod_logio</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_cgi\">mod_cgi</a></code></li>\n</ul></td>\n<td></td>\n</tr>\n</table> <p> The Apache HTTP Server provides a variety of different mechanisms for logging everything that happens on your server, from the initial request, through the URL mapping process, to the final resolution of the connection, including any errors that may have occurred in the process. In addition to this, third-party modules may provide logging capabilities, or inject entries into the existing log files, and applications such as CGI programs, or PHP scripts, or other handlers, may send messages to the server error log. </p> <p> In this document we discuss the logging modules that are a standard part of the http server. </p>   <h2 id=\"security\">Security Warning</h2> <p>Anyone who can write to the directory where Apache httpd is writing a log file can almost certainly gain access to the uid that the server is started as, which is normally root. Do <em>NOT</em> give people write access to the directory the logs are stored in without being aware of the consequences; see the <a href=\"misc/security_tips\">security tips</a> document for details.</p> <p>In addition, log files may contain information supplied directly by the client, without escaping. Therefore, it is possible for malicious clients to insert control-characters in the log files, so care must be taken in dealing with raw logs.</p>   <h2 id=\"errorlog\">Error Log</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"mod/core\">core</a></code></li></ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/core#errorlog\">ErrorLog</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#errorlogformat\">ErrorLogFormat</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/core#loglevel\">LogLevel</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The server error log, whose name and location is set by the <code class=\"directive\"><a href=\"mod/core#errorlog\">ErrorLog</a></code> directive, is the most important log file. This is the place where Apache httpd will send diagnostic information and record any errors that it encounters in processing requests. It is the first place to look when a problem occurs with starting the server or with the operation of the server, since it will often contain details of what went wrong and how to fix it.</p> <p>The error log is usually written to a file (typically <code>error_log</code> on Unix systems and <code>error.log</code> on Windows and OS/2). On Unix systems it is also possible to have the server send errors to <code>syslog</code> or <a href=\"#piped\">pipe them to a program</a>.</p> <p>The format of the error log is defined by the <code class=\"directive\"><a href=\"mod/core#errorlogformat\">ErrorLogFormat</a></code> directive, with which you can customize what values are logged. A default is format defined if you don't specify one. A typical log message follows:</p> <div class=\"example\"><pre>[Fri Sep 09 10:42:29.902022 2011] [core:error] [pid 35708:tid 4328636416] [client 72.15.99.187] File does not exist: /usr/local/apache2/htdocs/favicon.ico</pre></div> <p>The first item in the log entry is the date and time of the message. The next is the module producing the message (core, in this case) and the severity level of that message. This is followed by the process ID and, if appropriate, the thread ID, of the process that experienced the condition. Next, we have the client address that made the request. And finally is the detailed error message, which in this case indicates a request for a file that did not exist.</p> <p>A very wide variety of different messages can appear in the error log. Most look similar to the example above. The error log will also contain debugging output from CGI scripts. Any information written to <code>stderr</code> by a CGI script will be copied directly to the error log.</p> <p>Putting a <code>%L</code> token in both the error log and the access log will produce a log entry ID with which you can correlate the entry in the error log with the entry in the access log. If <code class=\"module\"><a href=\"mod/mod_unique_id\">mod_unique_id</a></code> is loaded, its unique request ID will be used as the log entry ID, too.</p> <p>During testing, it is often useful to continuously monitor the error log for any problems. On Unix systems, you can accomplish this using:</p> <div class=\"example\"><pre>tail -f error_log</pre></div>   <h2 id=\"permodule\">Per-module logging</h2> <p>The <code class=\"directive\"><a href=\"mod/core#loglevel\">LogLevel</a></code> directive allows you to specify a log severity level on a per-module basis. In this way, if you are troubleshooting a problem with just one particular module, you can turn up its logging volume without also getting the details of other modules that you're not interested in. This is particularly useful for modules such as <code class=\"module\"><a href=\"mod/mod_proxy\">mod_proxy</a></code> or <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code> where you want to know details about what it's trying to do.</p> <p>Do this by specifying the name of the module in your <code class=\"directive\">LogLevel</code> directive:</p> <pre class=\"prettyprint lang-config\">LogLevel info rewrite:trace5</pre> <p>This sets the main <code class=\"directive\">LogLevel</code> to info, but turns it up to <code>trace5</code> for <code class=\"module\"><a href=\"mod/mod_rewrite\">mod_rewrite</a></code>.</p> <div class=\"note\">This replaces the per-module logging directives, such as <code>RewriteLog</code>, that were present in earlier versions of the server.</div>   <h2 id=\"accesslog\">Access Log</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_log_config\">mod_log_config</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_setenvif\">mod_setenvif</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_setenvif#setenvif\">SetEnvIf</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The server access log records all requests processed by the server. The location and content of the access log are controlled by the <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> directive. The <code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code> directive can be used to simplify the selection of the contents of the logs. This section describes how to configure the server to record information in the access log.</p> <p>Of course, storing the information in the access log is only the start of log management. The next step is to analyze this information to produce useful statistics. Log analysis in general is beyond the scope of this document, and not really part of the job of the web server itself. For more information about this topic, and for applications which perform log analysis, check the <a href=\"http://dmoz.org/Computers/Software/Internet/Site_Management/Log_Analysis/\"> Open Directory</a>. </p> <p>Various versions of Apache httpd have used other modules and directives to control access logging, including mod_log_referer, mod_log_agent, and the <code>TransferLog</code> directive. The <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> directive now subsumes the functionality of all the older directives.</p> <p>The format of the access log is highly configurable. The format is specified using a format string that looks much like a C-style printf(1) format string. Some examples are presented in the next sections. For a complete list of the possible contents of the format string, see the <code class=\"module\"><a href=\"mod/mod_log_config\">mod_log_config</a></code> <a href=\"mod/mod_log_config#formats\">format strings</a>.</p> <h3><a name=\"common\" id=\"common\">Common Log Format</a></h3> <p>A typical configuration for the access log might look as follows.</p> <pre class=\"prettyprint lang-config\">LogFormat \"%h %l %u %t \\\"%r\\\" %&gt;s %b\" common\nCustomLog logs/access_log common</pre> <p>This defines the <em>nickname</em> <code>common</code> and associates it with a particular log format string. The format string consists of percent directives, each of which tell the server to log a particular piece of information. Literal characters may also be placed in the format string and will be copied directly into the log output. The quote character (<code>\"</code>) must be escaped by placing a backslash before it to prevent it from being interpreted as the end of the format string. The format string may also contain the special control characters \"<code>\\n</code>\" for new-line and \"<code>\\t</code>\" for tab.</p> <p>The <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> directive sets up a new log file using the defined <em>nickname</em>. The filename for the access log is relative to the <code class=\"directive\"><a href=\"mod/core#serverroot\">ServerRoot</a></code> unless it begins with a slash.</p> <p>The above configuration will write log entries in a format known as the Common Log Format (CLF). This standard format can be produced by many different web servers and read by many log analysis programs. The log file entries produced in CLF will look something like this:</p> <div class=\"example\"><pre>127.0.0.1 - frank [10/Oct/2000:13:55:36 -0700] \"GET /apache_pb.gif HTTP/1.0\" 200 2326</pre></div> <p>Each part of this log entry is described below.</p> <dl> <dt>\n<code>127.0.0.1</code> (<code>%h</code>)</dt> <dd>This is the IP address of the client (remote host) which made the request to the server. If <code class=\"directive\"><a href=\"mod/core#hostnamelookups\">HostnameLookups</a></code> is set to <code>On</code>, then the server will try to determine the hostname and log it in place of the IP address. However, this configuration is not recommended since it can significantly slow the server. Instead, it is best to use a log post-processor such as <code class=\"program\"><a href=\"programs/logresolve\">logresolve</a></code> to determine the hostnames. The IP address reported here is not necessarily the address of the machine at which the user is sitting. If a proxy server exists between the user and the server, this address will be the address of the proxy, rather than the originating machine.</dd> <dt>\n<code>-</code> (<code>%l</code>)</dt> <dd>The \"hyphen\" in the output indicates that the requested piece of information is not available. In this case, the information that is not available is the RFC 1413 identity of the client determined by <code>identd</code> on the clients machine. This information is highly unreliable and should almost never be used except on tightly controlled internal networks. Apache httpd will not even attempt to determine this information unless <code class=\"directive\"><a href=\"mod/mod_ident#identitycheck\">IdentityCheck</a></code> is set to <code>On</code>.</dd> <dt>\n<code>frank</code> (<code>%u</code>)</dt> <dd>This is the userid of the person requesting the document as determined by HTTP authentication. The same value is typically provided to CGI scripts in the <code>REMOTE_USER</code> environment variable. If the status code for the request (see below) is 401, then this value should not be trusted because the user is not yet authenticated. If the document is not password protected, this part will be \"<code>-</code>\" just like the previous one.</dd> <dt>\n<code>[10/Oct/2000:13:55:36 -0700]</code> (<code>%t</code>)</dt> <dd> The time that the request was received. The format is:  <pre>[day/month/year:hour:minute:second zone]\nday = 2*digit\nmonth = 3*letter\nyear = 4*digit\nhour = 2*digit\nminute = 2*digit\nsecond = 2*digit\nzone = (`+' | `-') 4*digit</pre>  <p>It is possible to have the time displayed in another format by specifying <code>%{format}t</code> in the log format string, where <code>format</code> is either as in <code>strftime(3)</code> from the C standard library, or one of the supported special tokens. For details see the <code class=\"module\"><a href=\"mod/mod_log_config\">mod_log_config</a></code> <a href=\"mod/mod_log_config#formats\">format strings</a>.</p> </dd> <dt>\n<code>\"GET /apache_pb.gif HTTP/1.0\"</code> (<code>\\\"%r\\\"</code>)</dt> <dd>The request line from the client is given in double quotes. The request line contains a great deal of useful information. First, the method used by the client is <code>GET</code>. Second, the client requested the resource <code>/apache_pb.gif</code>, and third, the client used the protocol <code>HTTP/1.0</code>. It is also possible to log one or more parts of the request line independently. For example, the format string \"<code>%m %U%q %H</code>\" will log the method, path, query-string, and protocol, resulting in exactly the same output as \"<code>%r</code>\".</dd> <dt>\n<code>200</code> (<code>%&gt;s</code>)</dt> <dd>This is the status code that the server sends back to the client. This information is very valuable, because it reveals whether the request resulted in a successful response (codes beginning in 2), a redirection (codes beginning in 3), an error caused by the client (codes beginning in 4), or an error in the server (codes beginning in 5). The full list of possible status codes can be found in the <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616.txt\">HTTP specification</a> (RFC2616 section 10).</dd> <dt>\n<code>2326</code> (<code>%b</code>)</dt> <dd>The last part indicates the size of the object returned to the client, not including the response headers. If no content was returned to the client, this value will be \"<code>-</code>\". To log \"<code>0</code>\" for no content, use <code>%B</code> instead.</dd> </dl> <h3><a name=\"combined\" id=\"combined\">Combined Log Format</a></h3> <p>Another commonly used format string is called the Combined Log Format. It can be used as follows.</p> <pre class=\"prettyprint lang-config\">LogFormat \"%h %l %u %t \\\"%r\\\" %&gt;s %b \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"\" combined\nCustomLog log/access_log combined</pre> <p>This format is exactly the same as the Common Log Format, with the addition of two more fields. Each of the additional fields uses the percent-directive <code>%{<em>header</em>}i</code>, where <em>header</em> can be any HTTP request header. The access log under this format will look like:</p> <div class=\"example\"><pre>127.0.0.1 - frank [10/Oct/2000:13:55:36 -0700] \"GET /apache_pb.gif HTTP/1.0\" 200 2326 \"http://www.example.com/start.html\" \"Mozilla/4.08 [en] (Win98; I ;Nav)\"</pre></div> <p>The additional fields are:</p> <dl> <dt>\n<code>\"http://www.example.com/start.html\"</code> (<code>\\\"%{Referer}i\\\"</code>)</dt> <dd>The \"Referer\" (sic) HTTP request header. This gives the site that the client reports having been referred from. (This should be the page that links to or includes <code>/apache_pb.gif</code>).</dd> <dt>\n<code>\"Mozilla/4.08 [en] (Win98; I ;Nav)\"</code> (<code>\\\"%{User-agent}i\\\"</code>)</dt> <dd>The User-Agent HTTP request header. This is the identifying information that the client browser reports about itself.</dd> </dl> <h3><a name=\"multiple\" id=\"multiple\">Multiple Access Logs</a></h3> <p>Multiple access logs can be created simply by specifying multiple <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> directives in the configuration file. For example, the following directives will create three access logs. The first contains the basic CLF information, while the second and third contain referer and browser information. The last two <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> lines show how to mimic the effects of the <code>ReferLog</code> and <code>AgentLog</code> directives.</p> <pre class=\"prettyprint lang-config\">LogFormat \"%h %l %u %t \\\"%r\\\" %&gt;s %b\" common\nCustomLog logs/access_log common\nCustomLog logs/referer_log \"%{Referer}i -&gt; %U\"\nCustomLog logs/agent_log \"%{User-agent}i\"</pre> <p>This example also shows that it is not necessary to define a nickname with the <code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code> directive. Instead, the log format can be specified directly in the <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> directive.</p> <h3><a name=\"conditional\" id=\"conditional\">Conditional Logs</a></h3> <p>There are times when it is convenient to exclude certain entries from the access logs based on characteristics of the client request. This is easily accomplished with the help of <a href=\"env\">environment variables</a>. First, an environment variable must be set to indicate that the request meets certain conditions. This is usually accomplished with <code class=\"directive\"><a href=\"mod/mod_setenvif#setenvif\">SetEnvIf</a></code>. Then the <code>env=</code> clause of the <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> directive is used to include or exclude requests where the environment variable is set. Some examples:</p> <pre class=\"prettyprint lang-config\"># Mark requests from the loop-back interface\nSetEnvIf Remote_Addr \"127\\.0\\.0\\.1\" dontlog\n# Mark requests for the robots.txt file\nSetEnvIf Request_URI \"^/robots\\.txt$\" dontlog\n# Log what remains\nCustomLog logs/access_log common env=!dontlog</pre> <p>As another example, consider logging requests from english-speakers to one log file, and non-english speakers to a different log file.</p> <pre class=\"prettyprint lang-config\">SetEnvIf Accept-Language \"en\" english\nCustomLog logs/english_log common env=english\nCustomLog logs/non_english_log common env=!english</pre> <p>In a caching scenario one would want to know about the efficiency of the cache. A very simple method to find this out would be:</p> <pre class=\"prettyprint lang-config\">SetEnv CACHE_MISS 1\nLogFormat \"%h %l %u %t \"%r \" %&gt;s %b %{CACHE_MISS}e\" common-cache\nCustomLog logs/access_log common-cache</pre> <p><code class=\"module\"><a href=\"mod/mod_cache\">mod_cache</a></code> will run before <code class=\"module\"><a href=\"mod/mod_env\">mod_env</a></code> and, when successful, will deliver the content without it. In that case a cache hit will log <code>-</code>, while a cache miss will log <code>1</code>.</p> <p>In addition to the <code>env=</code> syntax, <code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code> supports logging values conditional upon the HTTP response code:</p> <pre class=\"prettyprint lang-config\">LogFormat \"%400,501{User-agent}i\" browserlog\nLogFormat \"%!200,304,302{Referer}i\" refererlog</pre> <p>In the first example, the <code>User-agent</code> will be logged if the HTTP status code is 400 or 501. In other cases, a literal \"-\" will be logged instead. Likewise, in the second example, the <code>Referer</code> will be logged if the HTTP status code is <strong>not</strong> 200, 204, or 302. (Note the \"!\" before the status codes.</p> <p>Although we have just shown that conditional logging is very powerful and flexible, it is not the only way to control the contents of the logs. Log files are more useful when they contain a complete record of server activity. It is often easier to simply post-process the log files to remove requests that you do not want to consider.</p>   <h2 id=\"rotation\">Log Rotation</h2> <p>On even a moderately busy server, the quantity of information stored in the log files is very large. The access log file typically grows 1 MB or more per 10,000 requests. It will consequently be necessary to periodically rotate the log files by moving or deleting the existing logs. This cannot be done while the server is running, because Apache httpd will continue writing to the old log file as long as it holds the file open. Instead, the server must be <a href=\"stopping\">restarted</a> after the log files are moved or deleted so that it will open new log files.</p> <p>By using a <em>graceful</em> restart, the server can be instructed to open new log files without losing any existing or pending connections from clients. However, in order to accomplish this, the server must continue to write to the old log files while it finishes serving old requests. It is therefore necessary to wait for some time after the restart before doing any processing on the log files. A typical scenario that simply rotates the logs and compresses the old logs to save space is:</p> <div class=\"example\"><pre>mv access_log access_log.old\nmv error_log error_log.old\napachectl graceful\nsleep 600\ngzip access_log.old error_log.old</pre></div> <p>Another way to perform log rotation is using <a href=\"#piped\">piped logs</a> as discussed in the next section.</p>   <h2 id=\"piped\">Piped Logs</h2> <p>Apache httpd is capable of writing error and access log files through a pipe to another process, rather than directly to a file. This capability dramatically increases the flexibility of logging, without adding code to the main server. In order to write logs to a pipe, simply replace the filename with the pipe character \"<code>|</code>\", followed by the name of the executable which should accept log entries on its standard input. The server will start the piped-log process when the server starts, and will restart it if it crashes while the server is running. (This last feature is why we can refer to this technique as \"reliable piped logging\".)</p> <p>Piped log processes are spawned by the parent Apache httpd process, and inherit the userid of that process. This means that piped log programs usually run as root. It is therefore very important to keep the programs simple and secure.</p> <p>One important use of piped logs is to allow log rotation without having to restart the server. The Apache HTTP Server includes a simple program called <code class=\"program\"><a href=\"programs/rotatelogs\">rotatelogs</a></code> for this purpose. For example, to rotate the logs every 24 hours, you can use:</p> <pre class=\"prettyprint lang-config\">CustomLog \"|/usr/local/apache/bin/rotatelogs /var/log/access_log 86400\" common</pre> <p>Notice that quotes are used to enclose the entire command that will be called for the pipe. Although these examples are for the access log, the same technique can be used for the error log.</p> <p>As with conditional logging, piped logs are a very powerful tool, but they should not be used where a simpler solution like off-line post-processing is available.</p> <p>By default the piped log process is spawned without invoking a shell. Use \"<code>|$</code>\" instead of \"<code>|</code>\" to spawn using a shell (usually with <code>/bin/sh -c</code>):</p> <pre class=\"prettyprint lang-config\"># Invoke \"rotatelogs\" using a shell\nCustomLog \"|$/usr/local/apache/bin/rotatelogs   /var/log/access_log 86400\" common</pre> <p>This was the default behaviour for Apache 2.2. Depending on the shell specifics this might lead to an additional shell process for the lifetime of the logging pipe program and signal handling problems during restart. For compatibility reasons with Apache 2.2 the notation \"<code>||</code>\" is also supported and equivalent to using \"<code>|</code>\".</p> <div class=\"note\">\n<p><strong>Windows note</strong></p> <p>Note that on Windows, you may run into problems when running many piped logger processes, especially when HTTPD is running as a service. This is caused by running out of desktop heap space. The desktop heap space given to each service is specified by the third argument to the <code>SharedSection</code> parameter in the HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SessionManager\\SubSystems\\Windows registry value. <strong>Change this value with care</strong>; the normal caveats for changing the Windows registry apply, but you might also exhaust the desktop heap pool if the number is adjusted too high.</p> </div>   <h2 id=\"virtualhost\">Virtual Hosts</h2> <p>When running a server with many <a href=\"vhosts/index\">virtual hosts</a>, there are several options for dealing with log files. First, it is possible to use logs exactly as in a single-host server. Simply by placing the logging directives outside the <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> sections in the main server context, it is possible to log all requests in the same access log and error log. This technique does not allow for easy collection of statistics on individual virtual hosts.</p> <p>If <code class=\"directive\"><a href=\"mod/mod_log_config#customlog\">CustomLog</a></code> or <code class=\"directive\"><a href=\"mod/core#errorlog\">ErrorLog</a></code> directives are placed inside a <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> section, all requests or errors for that virtual host will be logged only to the specified file. Any virtual host which does not have logging directives will still have its requests sent to the main server logs. This technique is very useful for a small number of virtual hosts, but if the number of hosts is very large, it can be complicated to manage. In addition, it can often create problems with <a href=\"vhosts/fd-limits\">insufficient file descriptors</a>.</p> <p>For the access log, there is a very good compromise. By adding information on the virtual host to the log format string, it is possible to log all hosts to the same log, and later split the log into individual files. For example, consider the following directives.</p> <pre class=\"prettyprint lang-config\">LogFormat \"%v %l %u %t \\\"%r\\\" %&gt;s %b\" comonvhost\nCustomLog logs/access_log comonvhost</pre> <p>The <code>%v</code> is used to log the name of the virtual host that is serving the request. Then a program like <a href=\"programs/split-logfile\">split-logfile</a> can be used to post-process the access log in order to split it into one file per virtual host.</p>   <h2 id=\"other\">Other Log Files</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod/mod_logio\">mod_logio</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_log_config\">mod_log_config</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_log_forensic\">mod_log_forensic</a></code></li>\n<li><code class=\"module\"><a href=\"mod/mod_cgi\">mod_cgi</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_log_config#bufferedlogs\">BufferedLogs</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_log_forensic#forensiclog\">ForensicLog</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mpm_common#pidfile\">PidFile</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_cgi#scriptlog\">ScriptLog</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_cgi#scriptlogbuffer\">ScriptLogBuffer</a></code></li>\n<li><code class=\"directive\"><a href=\"mod/mod_cgi#scriptloglength\">ScriptLogLength</a></code></li>\n</ul></td>\n</tr>\n</table> <h3>Logging actual bytes sent and received</h3> <p><code class=\"module\"><a href=\"mod/mod_logio\">mod_logio</a></code> adds in two additional <code class=\"directive\"><a href=\"mod/mod_log_config#logformat\">LogFormat</a></code> fields (%I and %O) that log the actual number of bytes received and sent on the network.</p> <h3>Forensic Logging</h3> <p><code class=\"module\"><a href=\"mod/mod_log_forensic\">mod_log_forensic</a></code> provides for forensic logging of client requests. Logging is done before and after processing a request, so the forensic log contains two log lines for each request. The forensic logger is very strict with no customizations. It can be an invaluable debugging and security tool.</p> <h3><a name=\"pidfile\" id=\"pidfile\">PID File</a></h3> <p>On startup, Apache httpd saves the process id of the parent httpd process to the file <code>logs/httpd.pid</code>. This filename can be changed with the <code class=\"directive\"><a href=\"mod/mpm_common#pidfile\">PidFile</a></code> directive. The process-id is for use by the administrator in restarting and terminating the daemon by sending signals to the parent process; on Windows, use the -k command line option instead. For more information see the <a href=\"stopping\">Stopping and Restarting</a> page.</p> <h3><a name=\"scriptlog\" id=\"scriptlog\">Script Log</a></h3> <p>In order to aid in debugging, the <code class=\"directive\"><a href=\"mod/mod_cgi#scriptlog\">ScriptLog</a></code> directive allows you to record the input to and output from CGI scripts. This should only be used in testing - not for live servers. More information is available in the <a href=\"mod/mod_cgi\">mod_cgi</a> documentation.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/logs.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/logs.html</a>\n  </p>\n</div>\n","ssl/index":"<h1>Apache SSL/TLS Encryption</h1>  <p>The Apache HTTP Server module <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> provides an interface to the <a href=\"http://www.openssl.org/\">OpenSSL</a> library, which provides Strong Encryption using the Secure Sockets Layer and Transport Layer Security protocols.</p>     <h2 id=\"documentation\">Documentation</h2> <ul> <li><a href=\"ssl_howto\">mod_ssl Configuration How-To</a></li> <li><a href=\"ssl_intro\">Introduction To SSL</a></li> <li><a href=\"ssl_compat\">Compatibility</a></li> <li><a href=\"ssl_faq\">Frequently Asked Questions</a></li> <li><a href=\"https://httpd.apache.org/docs/2.4/en/glossary.html\">Glossary</a></li> </ul>   <h2 id=\"mod-ssl\">mod_ssl</h2> <p>Extensive documentation on the directives and environment variables provided by this module is provided in the <a href=\"../mod/mod_ssl\">mod_ssl reference documentation</a>. </p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/ssl/\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/ssl/</a>\n  </p>\n</div>\n","rewrite/index":"<h1>Apache mod_rewrite</h1>  <p><code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> provides a way to modify incoming URL requests, dynamically, based on <a href=\"intro#regex\">regular expression</a> rules. This allows you to map arbitrary URLs onto your internal URL structure in any way you like.</p> <p>It supports an unlimited number of rules and an unlimited number of attached rule conditions for each rule to provide a really flexible and powerful URL manipulation mechanism. The URL manipulations can depend on various tests: server variables, environment variables, HTTP headers, time stamps, external database lookups, and various other external programs or handlers, can be used to achieve granular URL matching.</p> <p>Rewrite rules can operate on the full URLs, including the path-info and query string portions, and may be used in per-server context (<code>httpd.conf</code>), per-virtualhost context (<code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> blocks), or per-directory context (<code>.htaccess</code> files and <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> blocks). The rewritten result can lead to further rules, internal sub-processing, external request redirection, or proxy passthrough, depending on what <a href=\"flags\">flags</a> you attach to the rules.</p> <p>Since mod_rewrite is so powerful, it can indeed be rather complex. This document supplements the <a href=\"../mod/mod_rewrite\">reference documentation</a>, and attempts to allay some of that complexity, and provide highly annotated examples of common scenarios that you may handle with mod_rewrite. But we also attempt to show you when you should not use mod_rewrite, and use other standard Apache features instead, thus avoiding this unnecessary complexity.</p> <ul> <li><a href=\"../mod/mod_rewrite\">mod_rewrite reference documentation</a></li> <li><a href=\"intro\">Introduction to regular expressions and mod_rewrite</a></li> <li><a href=\"remapping\">Using mod_rewrite for redirection and remapping of URLs</a></li> <li><a href=\"access\">Using mod_rewrite to control access</a></li> <li><a href=\"vhosts\">Dynamic virtual hosts with mod_rewrite</a></li> <li><a href=\"proxy\">Dynamic proxying with mod_rewrite</a></li> <li><a href=\"rewritemap\">Using RewriteMap</a></li> <li><a href=\"advanced\">Advanced techniques</a></li> <li><a href=\"avoid\">When <strong>NOT</strong> to use mod_rewrite</a></li> <li><a href=\"flags\">RewriteRule Flags</a></li> <li><a href=\"tech\">Technical details</a></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/</a>\n  </p>\n</div>\n","content-negotiation":"<h1>Content Negotiation</h1>  <p>Apache HTTPD supports content negotiation as described in the HTTP/1.1 specification. It can choose the best representation of a resource based on the browser-supplied preferences for media type, languages, character set and encoding. It also implements a couple of features to give more intelligent handling of requests from browsers that send incomplete negotiation information.</p> <p>Content negotiation is provided by the <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> module, which is compiled in by default.</p>     <h2 id=\"about\">About Content Negotiation</h2> <p>A resource may be available in several different representations. For example, it might be available in different languages or different media types, or a combination. One way of selecting the most appropriate choice is to give the user an index page, and let them select. However it is often possible for the server to choose automatically. This works because browsers can send, as part of each request, information about what representations they prefer. For example, a browser could indicate that it would like to see information in French, if possible, else English will do. Browsers indicate their preferences by headers in the request. To request only French representations, the browser would send</p> <div class=\"example\"><pre>Accept-Language: fr</pre></div> <p>Note that this preference will only be applied when there is a choice of representations and they vary by language.</p> <p>As an example of a more complex request, this browser has been configured to accept French and English, but prefer French, and to accept various media types, preferring HTML over plain text or other text types, and preferring GIF or JPEG over other media types, but also allowing any other media type as a last resort:</p> <div class=\"example\"><pre>Accept-Language: fr; q=1.0, en; q=0.5\nAccept: text/html; q=1.0, text/*; q=0.8, image/gif; q=0.6, image/jpeg; q=0.6, image/*; q=0.5, */*; q=0.1</pre></div> <p>httpd supports 'server driven' content negotiation, as defined in the HTTP/1.1 specification. It fully supports the <code>Accept</code>, <code>Accept-Language</code>, <code>Accept-Charset</code> and <code>Accept-Encoding</code> request headers. httpd also supports 'transparent' content negotiation, which is an experimental negotiation protocol defined in RFC 2295 and RFC 2296. It does not offer support for 'feature negotiation' as defined in these RFCs.</p> <p>A <strong>resource</strong> is a conceptual entity identified by a URI (RFC 2396). An HTTP server like Apache HTTP Server provides access to <strong>representations</strong> of the resource(s) within its namespace, with each representation in the form of a sequence of bytes with a defined media type, character set, encoding, etc. Each resource may be associated with zero, one, or more than one representation at any given time. If multiple representations are available, the resource is referred to as <strong>negotiable</strong> and each of its representations is termed a <strong>variant</strong>. The ways in which the variants for a negotiable resource vary are called the <strong>dimensions</strong> of negotiation.</p>   <h2 id=\"negotiation\">Negotiation in httpd</h2> <p>In order to negotiate a resource, the server needs to be given information about each of the variants. This is done in one of two ways:</p> <ul> <li>Using a type map (<em>i.e.</em>, a <code>*.var</code> file) which names the files containing the variants explicitly, or</li> <li>Using a 'MultiViews' search, where the server does an implicit filename pattern match and chooses from among the results.</li> </ul> <h3><a name=\"type-map\" id=\"type-map\">Using a type-map file</a></h3> <p>A type map is a document which is associated with the handler named <code>type-map</code> (or, for backwards-compatibility with older httpd configurations, the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME-type</a> <code>application/x-type-map</code>). Note that to use this feature, you must have a handler set in the configuration that defines a file suffix as <code>type-map</code>; this is best done with</p> <pre class=\"prettyprint lang-config\">AddHandler type-map .var</pre> <p>in the server configuration file.</p> <p>Type map files should have the same name as the resource which they are describing, followed by the extension <code>.var</code>. In the examples shown below, the resource is named <code>foo</code>, so the type map file is named <code>foo.var</code>.</p> <p>This file should have an entry for each available variant; these entries consist of contiguous HTTP-format header lines. Entries for different variants are separated by blank lines. Blank lines are illegal within an entry. It is conventional to begin a map file with an entry for the combined entity as a whole (although this is not required, and if present will be ignored). An example map file is shown below.</p> <p>URIs in this file are relative to the location of the type map file. Usually, these files will be located in the same directory as the type map file, but this is not required. You may provide absolute or relative URIs for any file located on the same server as the map file.</p> <div class=\"example\"><pre>URI: foo\n\nURI: foo.en.html\nContent-type: text/html\nContent-language: en\n\nURI: foo.fr.de.html\nContent-type: text/html;charset=iso-8859-2\nContent-language: fr, de</pre></div> <p>Note also that a typemap file will take precedence over the filename's extension, even when Multiviews is on. If the variants have different source qualities, that may be indicated by the \"qs\" parameter to the media type, as in this picture (available as JPEG, GIF, or ASCII-art): </p> <div class=\"example\"><pre>URI: foo\n\nURI: foo.jpeg\nContent-type: image/jpeg; qs=0.8\n\nURI: foo.gif\nContent-type: image/gif; qs=0.5\n\nURI: foo.txt\nContent-type: text/plain; qs=0.01</pre></div> <p>qs values can vary in the range 0.000 to 1.000. Note that any variant with a qs value of 0.000 will never be chosen. Variants with no 'qs' parameter value are given a qs factor of 1.0. The qs parameter indicates the relative 'quality' of this variant compared to the other available variants, independent of the client's capabilities. For example, a JPEG file is usually of higher source quality than an ASCII file if it is attempting to represent a photograph. However, if the resource being represented is an original ASCII art, then an ASCII representation would have a higher source quality than a JPEG representation. A qs value is therefore specific to a given variant depending on the nature of the resource it represents.</p> <p>The full list of headers recognized is available in the <a href=\"mod/mod_negotiation#typemaps\">mod_negotiation typemap</a> documentation.</p> <h3><a name=\"multiviews\" id=\"multiviews\">Multiviews</a></h3> <p><code>MultiViews</code> is a per-directory option, meaning it can be set with an <code class=\"directive\"><a href=\"mod/core#options\">Options</a></code> directive within a <code class=\"directive\"><a href=\"mod/core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"mod/core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"mod/core#files\">&lt;Files&gt;</a></code> section in <code>httpd.conf</code>, or (if <code class=\"directive\"><a href=\"mod/core#allowoverride\">AllowOverride</a></code> is properly set) in <code>.htaccess</code> files. Note that <code>Options All</code> does not set <code>MultiViews</code>; you have to ask for it by name.</p> <p>The effect of <code>MultiViews</code> is as follows: if the server receives a request for <code>/some/dir/foo</code>, if <code>/some/dir</code> has <code>MultiViews</code> enabled, and <code>/some/dir/foo</code> does <em>not</em> exist, then the server reads the directory looking for files named foo.*, and effectively fakes up a type map which names all those files, assigning them the same media types and content-encodings it would have if the client had asked for one of them by name. It then chooses the best match to the client's requirements.</p> <p><code>MultiViews</code> may also apply to searches for the file named by the <code class=\"directive\"><a href=\"mod/mod_dir#directoryindex\">DirectoryIndex</a></code> directive, if the server is trying to index a directory. If the configuration files specify</p> <pre class=\"prettyprint lang-config\">DirectoryIndex index</pre> <p>then the server will arbitrate between <code>index.html</code> and <code>index.html3</code> if both are present. If neither are present, and <code>index.cgi</code> is there, the server will run it.</p> <p>If one of the files found when reading the directory does not have an extension recognized by <code>mod_mime</code> to designate its Charset, Content-Type, Language, or Encoding, then the result depends on the setting of the <code class=\"directive\"><a href=\"mod/mod_mime#multiviewsmatch\">MultiViewsMatch</a></code> directive. This directive determines whether handlers, filters, and other extension types can participate in MultiViews negotiation.</p>   <h2 id=\"methods\">The Negotiation Methods</h2> <p>After httpd has obtained a list of the variants for a given resource, either from a type-map file or from the filenames in the directory, it invokes one of two methods to decide on the 'best' variant to return, if any. It is not necessary to know any of the details of how negotiation actually takes place in order to use httpd's content negotiation features. However the rest of this document explains the methods used for those interested. </p> <p>There are two negotiation methods:</p> <ol> <li>\n<strong>Server driven negotiation with the httpd algorithm</strong> is used in the normal case. The httpd algorithm is explained in more detail below. When this algorithm is used, httpd can sometimes 'fiddle' the quality factor of a particular dimension to achieve a better result. The ways httpd can fiddle quality factors is explained in more detail below.</li> <li>\n<strong>Transparent content negotiation</strong> is used when the browser specifically requests this through the mechanism defined in RFC 2295. This negotiation method gives the browser full control over deciding on the 'best' variant, the result is therefore dependent on the specific algorithms used by the browser. As part of the transparent negotiation process, the browser can ask httpd to run the 'remote variant selection algorithm' defined in RFC 2296.</li> </ol> <h3><a name=\"dimensions\" id=\"dimensions\">Dimensions of Negotiation</a></h3> <table> <tr valign=\"top\"> <th>Dimension</th> <th>Notes</th> </tr> <tr valign=\"top\"> <td>Media Type</td> <td>Browser indicates preferences with the <code>Accept</code> header field. Each item can have an associated quality factor. Variant description can also have a quality factor (the \"qs\" parameter).</td> </tr> <tr valign=\"top\"> <td>Language</td> <td>Browser indicates preferences with the <code>Accept-Language</code> header field. Each item can have a quality factor. Variants can be associated with none, one or more than one language.</td> </tr> <tr valign=\"top\"> <td>Encoding</td> <td>Browser indicates preference with the <code>Accept-Encoding</code> header field. Each item can have a quality factor.</td> </tr> <tr valign=\"top\"> <td>Charset</td> <td>Browser indicates preference with the <code>Accept-Charset</code> header field. Each item can have a quality factor. Variants can indicate a charset as a parameter of the media type.</td> </tr> </table> <h3><a name=\"algorithm\" id=\"algorithm\">httpd Negotiation Algorithm</a></h3> <p>httpd can use the following algorithm to select the 'best' variant (if any) to return to the browser. This algorithm is not further configurable. It operates as follows:</p> <ol> <li>First, for each dimension of the negotiation, check the appropriate <em>Accept*</em> header field and assign a quality to each variant. If the <em>Accept*</em> header for any dimension implies that this variant is not acceptable, eliminate it. If no variants remain, go to step 4.</li> <li> Select the 'best' variant by a process of elimination. Each of the following tests is applied in order. Any variants not selected at each test are eliminated. After each test, if only one variant remains, select it as the best match and proceed to step 3. If more than one variant remains, move on to the next test. <ol> <li>Multiply the quality factor from the <code>Accept</code> header with the quality-of-source factor for this variants media type, and select the variants with the highest value.</li> <li>Select the variants with the highest language quality factor.</li> <li>Select the variants with the best language match, using either the order of languages in the <code>Accept-Language</code> header (if present), or else the order of languages in the <code>LanguagePriority</code> directive (if present).</li> <li>Select the variants with the highest 'level' media parameter (used to give the version of text/html media types).</li> <li>Select variants with the best charset media parameters, as given on the <code>Accept-Charset</code> header line. Charset ISO-8859-1 is acceptable unless explicitly excluded. Variants with a <code>text/*</code> media type but not explicitly associated with a particular charset are assumed to be in ISO-8859-1.</li> <li>Select those variants which have associated charset media parameters that are <em>not</em> ISO-8859-1. If there are no such variants, select all variants instead.</li> <li>Select the variants with the best encoding. If there are variants with an encoding that is acceptable to the user-agent, select only these variants. Otherwise if there is a mix of encoded and non-encoded variants, select only the unencoded variants. If either all variants are encoded or all variants are not encoded, select all variants.</li> <li>Select the variants with the smallest content length.</li> <li>Select the first variant of those remaining. This will be either the first listed in the type-map file, or when variants are read from the directory, the one whose file name comes first when sorted using ASCII code order.</li> </ol> </li> <li>The algorithm has now selected one 'best' variant, so return it as the response. The HTTP response header <code>Vary</code> is set to indicate the dimensions of negotiation (browsers and caches can use this information when caching the resource). End.</li> <li>To get here means no variant was selected (because none are acceptable to the browser). Return a 406 status (meaning \"No acceptable representation\") with a response body consisting of an HTML document listing the available variants. Also set the HTTP <code>Vary</code> header to indicate the dimensions of variance.</li> </ol>   <h2 id=\"better\">Fiddling with Quality Values</h2> <p>httpd sometimes changes the quality values from what would be expected by a strict interpretation of the httpd negotiation algorithm above. This is to get a better result from the algorithm for browsers which do not send full or accurate information. Some of the most popular browsers send <code>Accept</code> header information which would otherwise result in the selection of the wrong variant in many cases. If a browser sends full and correct information these fiddles will not be applied.</p> <h3><a name=\"wildcards\" id=\"wildcards\">Media Types and Wildcards</a></h3> <p>The <code>Accept:</code> request header indicates preferences for media types. It can also include 'wildcard' media types, such as \"image/*\" or \"*/*\" where the * matches any string. So a request including:</p> <div class=\"example\"><pre>Accept: image/*, */*</pre></div> <p>would indicate that any type starting \"image/\" is acceptable, as is any other type. Some browsers routinely send wildcards in addition to explicit types they can handle. For example:</p> <div class=\"example\"><pre>Accept: text/html, text/plain, image/gif, image/jpeg, */*</pre></div> <p>The intention of this is to indicate that the explicitly listed types are preferred, but if a different representation is available, that is ok too. Using explicit quality values, what the browser really wants is something like:</p> <div class=\"example\"><pre>Accept: text/html, text/plain, image/gif, image/jpeg, */*; q=0.01</pre></div> <p>The explicit types have no quality factor, so they default to a preference of 1.0 (the highest). The wildcard */* is given a low preference of 0.01, so other types will only be returned if no variant matches an explicitly listed type.</p> <p>If the <code>Accept:</code> header contains <em>no</em> q factors at all, httpd sets the q value of \"*/*\", if present, to 0.01 to emulate the desired behavior. It also sets the q value of wildcards of the format \"type/*\" to 0.02 (so these are preferred over matches against \"*/*\". If any media type on the <code>Accept:</code> header contains a q factor, these special values are <em>not</em> applied, so requests from browsers which send the explicit information to start with work as expected.</p> <h3><a name=\"exceptions\" id=\"exceptions\">Language Negotiation Exceptions</a></h3> <p>New in httpd 2.0, some exceptions have been added to the negotiation algorithm to allow graceful fallback when language negotiation fails to find a match.</p> <p>When a client requests a page on your server, but the server cannot find a single page that matches the <code>Accept-language</code> sent by the browser, the server will return either a \"No Acceptable Variant\" or \"Multiple Choices\" response to the client. To avoid these error messages, it is possible to configure httpd to ignore the <code>Accept-language</code> in these cases and provide a document that does not explicitly match the client's request. The <code class=\"directive\"><a href=\"mod/mod_negotiation#forcelanguagepriority\">ForceLanguagePriority</a></code> directive can be used to override one or both of these error messages and substitute the servers judgement in the form of the <code class=\"directive\"><a href=\"mod/mod_negotiation#languagepriority\">LanguagePriority</a></code> directive.</p> <p>The server will also attempt to match language-subsets when no other match can be found. For example, if a client requests documents with the language <code>en-GB</code> for British English, the server is not normally allowed by the HTTP/1.1 standard to match that against a document that is marked as simply <code>en</code>. (Note that it is almost surely a configuration error to include <code>en-GB</code> and not <code>en</code> in the <code>Accept-Language</code> header, since it is very unlikely that a reader understands British English, but doesn't understand English in general. Unfortunately, many current clients have default configurations that resemble this.) However, if no other language match is possible and the server is about to return a \"No Acceptable Variants\" error or fallback to the <code class=\"directive\"><a href=\"mod/mod_negotiation#languagepriority\">LanguagePriority</a></code>, the server will ignore the subset specification and match <code>en-GB</code> against <code>en</code> documents. Implicitly, httpd will add the parent language to the client's acceptable language list with a very low quality value. But note that if the client requests \"en-GB; q=0.9, fr; q=0.8\", and the server has documents designated \"en\" and \"fr\", then the \"fr\" document will be returned. This is necessary to maintain compliance with the HTTP/1.1 specification and to work effectively with properly configured clients.</p> <p>In order to support advanced techniques (such as cookies or special URL-paths) to determine the user's preferred language, since httpd 2.0.47 <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> recognizes the <a href=\"env\">environment variable</a> <code>prefer-language</code>. If it exists and contains an appropriate language tag, <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> will try to select a matching variant. If there's no such variant, the normal negotiation process applies.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SetEnvIf Cookie \"language=(.+)\" prefer-language=$1\nHeader append Vary cookie</pre> </div>   <h2 id=\"extensions\">Extensions to Transparent Content Negotiation</h2> <p>httpd extends the transparent content negotiation protocol (RFC 2295) as follows. A new <code>{encoding ..}</code> element is used in variant lists to label variants which are available with a specific content-encoding only. The implementation of the RVSA/1.0 algorithm (RFC 2296) is extended to recognize encoded variants in the list, and to use them as candidate variants whenever their encodings are acceptable according to the <code>Accept-Encoding</code> request header. The RVSA/1.0 implementation does not round computed quality factors to 5 decimal places before choosing the best variant.</p>   <h2 id=\"naming\">Note on hyperlinks and naming conventions</h2> <p>If you are using language negotiation you can choose between different naming conventions, because files can have more than one extension, and the order of the extensions is normally irrelevant (see the <a href=\"mod/mod_mime#multipleext\">mod_mime</a> documentation for details).</p> <p>A typical file has a MIME-type extension (<em>e.g.</em>, <code>html</code>), maybe an encoding extension (<em>e.g.</em>, <code>gz</code>), and of course a language extension (<em>e.g.</em>, <code>en</code>) when we have different language variants of this file.</p> <p>Examples:</p> <ul> <li>foo.en.html</li> <li>foo.html.en</li> <li>foo.en.html.gz</li> </ul> <p>Here some more examples of filenames together with valid and invalid hyperlinks:</p> <table class=\"bordered\"> <tr> <th>Filename</th> <th>Valid hyperlink</th> <th>Invalid hyperlink</th> </tr> <tr> <td><em>foo.html.en</em></td> <td>foo<br> foo.html</td> <td>-</td> </tr> <tr> <td><em>foo.en.html</em></td> <td>foo</td> <td>foo.html</td> </tr> <tr> <td><em>foo.html.en.gz</em></td> <td>foo<br> foo.html</td> <td>foo.gz<br> foo.html.gz</td> </tr> <tr> <td><em>foo.en.html.gz</em></td> <td>foo</td> <td>foo.html<br> foo.html.gz<br> foo.gz</td> </tr> <tr> <td><em>foo.gz.html.en</em></td> <td>foo<br> foo.gz<br> foo.gz.html</td> <td>foo.html</td> </tr> <tr> <td><em>foo.html.gz.en</em></td> <td>foo<br> foo.html<br> foo.html.gz</td> <td>foo.gz</td> </tr> </table> <p>Looking at the table above, you will notice that it is always possible to use the name without any extensions in a hyperlink (<em>e.g.</em>, <code>foo</code>). The advantage is that you can hide the actual type of a document rsp. file and can change it later, <em>e.g.</em>, from <code>html</code> to <code>shtml</code> or <code>cgi</code> without changing any hyperlink references.</p> <p>If you want to continue to use a MIME-type in your hyperlinks (<em>e.g.</em> <code>foo.html</code>) the language extension (including an encoding extension if there is one) must be on the right hand side of the MIME-type extension (<em>e.g.</em>, <code>foo.html.en</code>).</p>   <h2 id=\"caching\">Note on Caching</h2> <p>When a cache stores a representation, it associates it with the request URL. The next time that URL is requested, the cache can use the stored representation. But, if the resource is negotiable at the server, this might result in only the first requested variant being cached and subsequent cache hits might return the wrong response. To prevent this, httpd normally marks all responses that are returned after content negotiation as non-cacheable by HTTP/1.0 clients. httpd also supports the HTTP/1.1 protocol features to allow caching of negotiated responses.</p> <p>For requests which come from a HTTP/1.0 compliant client (either a browser or a cache), the directive <code class=\"directive\"><a href=\"mod/mod_negotiation#cachenegotiateddocs\">CacheNegotiatedDocs</a></code> can be used to allow caching of responses which were subject to negotiation. This directive can be given in the server config or virtual host, and takes no arguments. It has no effect on requests from HTTP/1.1 clients.</p> <p>For HTTP/1.1 clients, httpd sends a <code>Vary</code> HTTP response header to indicate the negotiation dimensions for the response. Caches can use this information to determine whether a subsequent request can be served from the local copy. To encourage a cache to use the local copy regardless of the negotiation dimensions, set the <code>force-no-vary</code> <a href=\"env#special\">environment variable</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/content-negotiation.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/content-negotiation.html</a>\n  </p>\n</div>\n","suexec":"<h1>suEXEC Support</h1>  <p>The <strong>suEXEC</strong> feature provides users of the Apache HTTP Server the ability to run <strong>CGI</strong> and <strong>SSI</strong> programs under user IDs different from the user ID of the calling web server. Normally, when a CGI or SSI program executes, it runs as the same user who is running the web server.</p> <p>Used properly, this feature can reduce considerably the security risks involved with allowing users to develop and run private CGI or SSI programs. However, if suEXEC is improperly configured, it can cause any number of problems and possibly create new holes in your computer's security. If you aren't familiar with managing <em>setuid root</em> programs and the security issues they present, we highly recommend that you not consider using suEXEC.</p>     <h2 id=\"before\">Before we begin</h2> <p>Before jumping head-first into this document, you should be aware that certain assumptions are made about you and the environment in which you will be using suexec.</p> <p>First, it is assumed that you are using a UNIX derivative operating system that is capable of <strong>setuid</strong> and <strong>setgid</strong> operations. All command examples are given in this regard. Other platforms, if they are capable of supporting suEXEC, may differ in their configuration.</p> <p>Second, it is assumed you are familiar with some basic concepts of your computer's security and its administration. This involves an understanding of <strong>setuid/setgid</strong> operations and the various effects they may have on your system and its level of security.</p> <p>Third, it is assumed that you are using an <strong>unmodified</strong> version of suEXEC code. All code for suEXEC has been carefully scrutinized and tested by the developers as well as numerous beta testers. Every precaution has been taken to ensure a simple yet solidly safe base of code. Altering this code can cause unexpected problems and new security risks. It is <strong>highly</strong> recommended you not alter the suEXEC code unless you are well versed in the particulars of security programming and are willing to share your work with the Apache HTTP Server development team for consideration.</p> <p>Fourth, and last, it has been the decision of the Apache HTTP Server development team to <strong>NOT</strong> make suEXEC part of the default installation of Apache httpd. To this end, suEXEC configuration requires of the administrator careful attention to details. After due consideration has been given to the various settings for suEXEC, the administrator may install suEXEC through normal installation methods. The values for these settings need to be carefully determined and specified by the administrator to properly maintain system security during the use of suEXEC functionality. It is through this detailed process that we hope to limit suEXEC installation only to those who are careful and determined enough to use it.</p> <p>Still with us? Yes? Good. Let's move on!</p>   <h2 id=\"model\">suEXEC Security Model</h2> <p>Before we begin configuring and installing suEXEC, we will first discuss the security model you are about to implement. By doing so, you may better understand what exactly is going on inside suEXEC and what precautions are taken to ensure your system's security.</p> <p><strong>suEXEC</strong> is based on a setuid \"wrapper\" program that is called by the main Apache HTTP Server. This wrapper is called when an HTTP request is made for a CGI or SSI program that the administrator has designated to run as a userid other than that of the main server. When such a request is made, Apache httpd provides the suEXEC wrapper with the program's name and the user and group IDs under which the program is to execute.</p> <p>The wrapper then employs the following process to determine success or failure -- if any one of these conditions fail, the program logs the failure and exits with an error, otherwise it will continue:</p> <ol> <li> <strong>Is the user executing this wrapper a valid user of this system?</strong> <p class=\"indent\"> This is to ensure that the user executing the wrapper is truly a user of the system. </p> </li> <li> <strong>Was the wrapper called with the proper number of arguments?</strong> <p class=\"indent\"> The wrapper will only execute if it is given the proper number of arguments. The proper argument format is known to the Apache HTTP Server. If the wrapper is not receiving the proper number of arguments, it is either being hacked, or there is something wrong with the suEXEC portion of your Apache httpd binary. </p> </li> <li> <strong>Is this valid user allowed to run the wrapper?</strong> <p class=\"indent\"> Is this user the user allowed to run this wrapper? Only one user (the Apache user) is allowed to execute this program. </p> </li> <li> <strong>Does the target CGI or SSI program have an unsafe hierarchical reference?</strong> <p class=\"indent\"> Does the target CGI or SSI program's path contain a leading '/' or have a '..' backreference? These are not allowed; the target CGI/SSI program must reside within suEXEC's document root (see <code>--with-suexec-docroot=<em>DIR</em></code> below). </p> </li> <li> <strong>Is the target user name valid?</strong> <p class=\"indent\"> Does the target user exist? </p> </li> <li> <strong>Is the target group name valid?</strong> <p class=\"indent\"> Does the target group exist? </p> </li> <li> <strong>Is the target user <em>NOT</em> superuser?</strong> <p class=\"indent\"> suEXEC does not allow <code><em>root</em></code> to execute CGI/SSI programs. </p> </li> <li> <strong>Is the target userid <em>ABOVE</em> the minimum ID number?</strong> <p class=\"indent\"> The minimum user ID number is specified during configuration. This allows you to set the lowest possible userid that will be allowed to execute CGI/SSI programs. This is useful to block out \"system\" accounts. </p> </li> <li> <strong>Is the target group <em>NOT</em> the superuser group?</strong> <p class=\"indent\"> Presently, suEXEC does not allow the <code><em>root</em></code> group to execute CGI/SSI programs. </p> </li> <li> <strong>Is the target groupid <em>ABOVE</em> the minimum ID number?</strong> <p class=\"indent\"> The minimum group ID number is specified during configuration. This allows you to set the lowest possible groupid that will be allowed to execute CGI/SSI programs. This is useful to block out \"system\" groups. </p> </li> <li> <strong>Can the wrapper successfully become the target user and group?</strong> <p class=\"indent\"> Here is where the program becomes the target user and group via setuid and setgid calls. The group access list is also initialized with all of the groups of which the user is a member. </p> </li> <li> <strong>Can we change directory to the one in which the target CGI/SSI program resides?</strong> <p class=\"indent\"> If it doesn't exist, it can't very well contain files. If we can't change directory to it, it might as well not exist. </p> </li> <li> <strong>Is the directory within the httpd webspace?</strong> <p class=\"indent\"> If the request is for a regular portion of the server, is the requested directory within suEXEC's document root? If the request is for a <code class=\"directive\"><a href=\"mod/mod_userdir#userdir\">UserDir</a></code>, is the requested directory within the directory configured as suEXEC's userdir (see <a href=\"#install\">suEXEC's configuration options</a>)? </p> </li> <li> <strong>Is the directory <em>NOT</em> writable by anyone else?</strong> <p class=\"indent\"> We don't want to open up the directory to others; only the owner user may be able to alter this directories contents. </p> </li> <li> <strong>Does the target CGI/SSI program exist?</strong> <p class=\"indent\"> If it doesn't exists, it can't very well be executed. </p> </li> <li> <strong>Is the target CGI/SSI program <em>NOT</em> writable by anyone else?</strong> <p class=\"indent\"> We don't want to give anyone other than the owner the ability to change the CGI/SSI program. </p> </li> <li> <strong>Is the target CGI/SSI program <em>NOT</em> setuid or setgid?</strong> <p class=\"indent\"> We do not want to execute programs that will then change our UID/GID again. </p> </li> <li> <strong>Is the target user/group the same as the program's user/group?</strong> <p class=\"indent\"> Is the user the owner of the file? </p> </li> <li> <strong>Can we successfully clean the process environment to ensure safe operations?</strong> <p class=\"indent\"> suEXEC cleans the process' environment by establishing a safe execution PATH (defined during configuration), as well as only passing through those variables whose names are listed in the safe environment list (also created during configuration). </p> </li> <li> <strong>Can we successfully become the target CGI/SSI program and execute?</strong> <p class=\"indent\"> Here is where suEXEC ends and the target CGI/SSI program begins. </p> </li> </ol> <p>This is the standard operation of the suEXEC wrapper's security model. It is somewhat stringent and can impose new limitations and guidelines for CGI/SSI design, but it was developed carefully step-by-step with security in mind.</p> <p>For more information as to how this security model can limit your possibilities in regards to server configuration, as well as what security risks can be avoided with a proper suEXEC setup, see the <a href=\"#jabberwock\">\"Beware the Jabberwock\"</a> section of this document.</p>   <h2 id=\"install\">Configuring &amp; Installing suEXEC</h2> <p>Here's where we begin the fun.</p> <p><strong>suEXEC configuration options</strong><br> </p> <dl> <dt><code>--enable-suexec</code></dt> <dd>This option enables the suEXEC feature which is never installed or activated by default. At least one <code>--with-suexec-xxxxx</code> option has to be provided together with the <code>--enable-suexec</code> option to let APACI accept your request for using the suEXEC feature.</dd> <dt><code>--with-suexec-bin=<em>PATH</em></code></dt> <dd>The path to the <code>suexec</code> binary must be hard-coded in the server for security reasons. Use this option to override the default path. <em>e.g.</em> <code>--with-suexec-bin=/usr/sbin/suexec</code>\n</dd> <dt><code>--with-suexec-caller=<em>UID</em></code></dt> <dd>The <a href=\"mod/mpm_common#user\">username</a> under which httpd normally runs. This is the only user allowed to execute the suEXEC wrapper.</dd> <dt><code>--with-suexec-userdir=<em>DIR</em></code></dt> <dd>Define to be the subdirectory under users' home directories where suEXEC access should be allowed. All executables under this directory will be executable by suEXEC as the user so they should be \"safe\" programs. If you are using a \"simple\" <code class=\"directive\"><a href=\"mod/mod_userdir#userdir\">UserDir</a></code> directive (ie. one without a \"*\" in it) this should be set to the same value. suEXEC will not work properly in cases where the <code class=\"directive\"><a href=\"mod/mod_userdir#userdir\">UserDir</a></code> directive points to a location that is not the same as the user's home directory as referenced in the <code>passwd</code> file. Default value is \"<code>public_html</code>\".<br> If you have virtual hosts with a different <code class=\"directive\"><a href=\"mod/mod_userdir#userdir\">UserDir</a></code> for each, you will need to define them to all reside in one parent directory; then name that parent directory here. <strong>If this is not defined properly, \"~userdir\" cgi requests will not work!</strong>\n</dd> <dt><code>--with-suexec-docroot=<em>DIR</em></code></dt> <dd>Define as the DocumentRoot set for httpd. This will be the only hierarchy (aside from <code class=\"directive\"><a href=\"mod/mod_userdir#userdir\">UserDir</a></code>s) that can be used for suEXEC behavior. The default directory is the <code>--datadir</code> value with the suffix \"<code>/htdocs</code>\", <em>e.g.</em> if you configure with \"<code>--datadir=/home/apache</code>\" the directory \"<code>/home/apache/htdocs</code>\" is used as document root for the suEXEC wrapper.</dd> <dt><code>--with-suexec-uidmin=<em>UID</em></code></dt> <dd>Define this as the lowest UID allowed to be a target user for suEXEC. For most systems, 500 or 100 is common. Default value is 100.</dd> <dt><code>--with-suexec-gidmin=<em>GID</em></code></dt> <dd>Define this as the lowest GID allowed to be a target group for suEXEC. For most systems, 100 is common and therefore used as default value.</dd> <dt><code>--with-suexec-logfile=<em>FILE</em></code></dt> <dd>This defines the filename to which all suEXEC transactions and errors are logged (useful for auditing and debugging purposes). By default the logfile is named \"<code>suexec_log</code>\" and located in your standard logfile directory (<code>--logfiledir</code>).</dd> <dt><code>--with-suexec-safepath=<em>PATH</em></code></dt> <dd>Define a safe PATH environment to pass to CGI executables. Default value is \"<code>/usr/local/bin:/usr/bin:/bin</code>\".</dd> </dl> <h3>Compiling and installing the suEXEC wrapper</h3> <p>If you have enabled the suEXEC feature with the <code>--enable-suexec</code> option the <code>suexec</code> binary (together with httpd itself) is automatically built if you execute the <code>make</code> command.</p> <p>After all components have been built you can execute the command <code>make install</code> to install them. The binary image <code>suexec</code> is installed in the directory defined by the <code>--sbindir</code> option. The default location is \"/usr/local/apache2/bin/suexec\".</p> <p>Please note that you need <strong><em>root privileges</em></strong> for the installation step. In order for the wrapper to set the user ID, it must be installed as owner <code><em>root</em></code> and must have the setuserid execution bit set for file modes.</p> <h3>Setting paranoid permissions</h3> <p>Although the suEXEC wrapper will check to ensure that its caller is the correct user as specified with the <code>--with-suexec-caller</code> <code class=\"program\"><a href=\"programs/configure\">configure</a></code> option, there is always the possibility that a system or library call suEXEC uses before this check may be exploitable on your system. To counter this, and because it is best-practise in general, you should use filesystem permissions to ensure that only the group httpd runs as may execute suEXEC.</p> <p>If for example, your web server is configured to run as:</p> <pre class=\"prettyprint lang-config\">User www\nGroup webgroup</pre> <p>and <code class=\"program\"><a href=\"programs/suexec\">suexec</a></code> is installed at \"/usr/local/apache2/bin/suexec\", you should run:</p> <div class=\"example\"><pre>chgrp webgroup /usr/local/apache2/bin/suexec\nchmod 4750 /usr/local/apache2/bin/suexec</pre></div> <p>This will ensure that only the group httpd runs as can even execute the suEXEC wrapper.</p>   <h2 id=\"enable\">Enabling &amp; Disabling suEXEC</h2> <p>Upon startup of httpd, it looks for the file <code class=\"program\"><a href=\"programs/suexec\">suexec</a></code> in the directory defined by the <code>--sbindir</code> option (default is \"/usr/local/apache/sbin/suexec\"). If httpd finds a properly configured suEXEC wrapper, it will print the following message to the error log:</p> <div class=\"example\"><pre>[notice] suEXEC mechanism enabled (wrapper: /path/to/suexec)</pre></div> <p>If you don't see this message at server startup, the server is most likely not finding the wrapper program where it expects it, or the executable is not installed <em>setuid root</em>.</p> <p>If you want to enable the suEXEC mechanism for the first time and an Apache HTTP Server is already running you must kill and restart httpd. Restarting it with a simple HUP or USR1 signal will not be enough. </p> <p>If you want to disable suEXEC you should kill and restart httpd after you have removed the <code class=\"program\"><a href=\"programs/suexec\">suexec</a></code> file.</p>   <h2 id=\"usage\">Using suEXEC</h2> <p>Requests for CGI programs will call the suEXEC wrapper only if they are for a virtual host containing a <code class=\"directive\"><a href=\"mod/mod_suexec#suexecusergroup\">SuexecUserGroup</a></code> directive or if they are processed by <code class=\"module\"><a href=\"mod/mod_userdir\">mod_userdir</a></code>.</p> <p><strong>Virtual Hosts:</strong><br> One way to use the suEXEC wrapper is through the <code class=\"directive\"><a href=\"mod/mod_suexec#suexecusergroup\">SuexecUserGroup</a></code> directive in <code class=\"directive\"><a href=\"mod/core#virtualhost\">VirtualHost</a></code> definitions. By setting this directive to values different from the main server user ID, all requests for CGI resources will be executed as the <em>User</em> and <em>Group</em> defined for that <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code>. If this directive is not specified for a <code class=\"directive\"><a href=\"mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> then the main server userid is assumed.</p> <p><strong>User directories:</strong><br> Requests that are processed by <code class=\"module\"><a href=\"mod/mod_userdir\">mod_userdir</a></code> will call the suEXEC wrapper to execute CGI programs under the userid of the requested user directory. The only requirement needed for this feature to work is for CGI execution to be enabled for the user and that the script must meet the scrutiny of the <a href=\"#model\">security checks</a> above. See also the <code>--with-suexec-userdir</code> <a href=\"#install\">compile time option</a>.</p>   <h2 id=\"debug\">Debugging suEXEC</h2> <p>The suEXEC wrapper will write log information to the file defined with the <code>--with-suexec-logfile</code> option as indicated above. If you feel you have configured and installed the wrapper properly, have a look at this log and the error_log for the server to see where you may have gone astray.</p>   <h2 id=\"jabberwock\">Beware the Jabberwock: Warnings &amp; Examples</h2> <p><strong>NOTE!</strong> This section may not be complete. For the latest revision of this section of the documentation, see the <a href=\"http://httpd.apache.org/docs/2.4/suexec.html\">Online Documentation</a> version.</p> <p>There are a few points of interest regarding the wrapper that can cause limitations on server setup. Please review these before submitting any \"bugs\" regarding suEXEC.</p> <ul> <li><strong>suEXEC Points Of Interest</strong></li> <li> Hierarchy limitations <p class=\"indent\"> For security and efficiency reasons, all suEXEC requests must remain within either a top-level document root for virtual host requests, or one top-level personal document root for userdir requests. For example, if you have four VirtualHosts configured, you would need to structure all of your VHosts' document roots off of one main httpd document hierarchy to take advantage of suEXEC for VirtualHosts. (Example forthcoming.) </p> </li> <li> suEXEC's PATH environment variable <p class=\"indent\"> This can be a dangerous thing to change. Make certain every path you include in this define is a <strong>trusted</strong> directory. You don't want to open people up to having someone from across the world running a trojan horse on them. </p> </li> <li> Altering the suEXEC code <p class=\"indent\"> Again, this can cause <strong>Big Trouble</strong> if you try this without knowing what you are doing. Stay away from it if at all possible. </p> </li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/suexec.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/suexec.html</a>\n  </p>\n</div>\n","vhosts/index":"<h1>Apache Virtual Host documentation</h1>  <p>The term <cite>Virtual Host</cite> refers to the practice of running more than one web site (such as <code>company1.example.com</code> and <code>company2.example.com</code>) on a single machine. Virtual hosts can be \"<a href=\"ip-based\">IP-based</a>\", meaning that you have a different IP address for every web site, or \"<a href=\"name-based\">name-based</a>\", meaning that you have multiple names running on each IP address. The fact that they are running on the same physical server is not apparent to the end user.</p> <p>Apache was one of the first servers to support IP-based virtual hosts right out of the box. Versions 1.1 and later of Apache support both IP-based and name-based virtual hosts (vhosts). The latter variant of virtual hosts is sometimes also called <em>host-based</em> or <em>non-IP virtual hosts</em>.</p> <p>Below is a list of documentation pages which explain all details of virtual host support in Apache HTTP Server:</p>     <h2 id=\"support\">Virtual Host Support</h2> <ul> <li>\n<a href=\"name-based\">Name-based Virtual Hosts</a> (More than one web site per IP address)</li> <li>\n<a href=\"ip-based\">IP-based Virtual Hosts</a> (An IP address for each web site)</li> <li><a href=\"examples\">Virtual Host examples for common setups</a></li> <li>\n<a href=\"fd-limits\">File Descriptor Limits</a> (or, <em>Too many log files</em>)</li> <li><a href=\"mass\">Dynamically Configured Mass Virtual Hosting</a></li> <li><a href=\"details\">In-Depth Discussion of Virtual Host Matching</a></li> </ul>   <h2 id=\"directives\">Configuration directives</h2> <ul> <li><code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code></li> <li><code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code></li> <li><code class=\"directive\"><a href=\"../mod/core#serveralias\">ServerAlias</a></code></li> <li><code class=\"directive\"><a href=\"../mod/core#serverpath\">ServerPath</a></code></li> </ul> <p>If you are trying to debug your virtual host configuration, you may find the Apache <code>-S</code> command line switch useful. That is, type the following command:</p> <div class=\"example\"><pre>/usr/local/apache2/bin/httpd -S</pre></div> <p>This command will dump out a description of how Apache parsed the configuration file. Careful examination of the IP addresses and server names may help uncover configuration mistakes. (See the docs for the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> program for other command line options)</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/vhosts/index.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/vhosts/index.html</a>\n  </p>\n</div>\n","howto/access":"<h1>Access Control</h1>  <p>Access control refers to any means of controlling access to any resource. This is separate from <a href=\"auth\">authentication and authorization</a>.</p>     <h2 id=\"related\">Related Modules and Directives</h2> <p>Access control can be done by several different modules. The most important of these are <code class=\"module\"><a href=\"../mod/mod_authz_core\">mod_authz_core</a></code> and <code class=\"module\"><a href=\"../mod/mod_authz_host\">mod_authz_host</a></code>. Also discussed in this document is access control using <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>.</p>   <h2 id=\"host\">Access control by host</h2> <p> If you wish to restrict access to portions of your site based on the host address of your visitors, this is most easily done using <code class=\"module\"><a href=\"../mod/mod_authz_host\">mod_authz_host</a></code>. </p> <p>The <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> provides a variety of different ways to allow or deny access to resources. In conjunction with the <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireall\">RequireAll</a></code>, <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireany\">RequireAny</a></code>, and <code class=\"directive\"><a href=\"../mod/mod_authz_core#requirenone\">RequireNone</a></code> directives, these requirements may be combined in arbitrarily complex ways, to enforce whatever your access policy happens to be.</p> <div class=\"warning\"><p> The <code class=\"directive\"><a href=\"../mod/mod_access_compat#allow\">Allow</a></code>, <code class=\"directive\"><a href=\"../mod/mod_access_compat#deny\">Deny</a></code>, and <code class=\"directive\"><a href=\"../mod/mod_access_compat#order\">Order</a></code> directives, provided by <code class=\"module\"><a href=\"../mod/mod_access_compat\">mod_access_compat</a></code>, are deprecated and will go away in a future version. You should avoid using them, and avoid outdated tutorials recommending their use. </p></div> <p>The usage of these directives is:</p> <pre class=\"prettyprint lang-config\">Require host address\nRequire ip ip.address</pre> <p>In the first form, <var>address</var> is a fully qualified domain name (or a partial domain name); you may provide multiple addresses or domain names, if desired.</p> <p>In the second form, <var>ip.address</var> is an IP address, a partial IP address, a network/netmask pair, or a network/nnn CIDR specification. Either IPv4 or IPv6 addresses may be used.</p> <p>See <a href=\"../mod/mod_authz_host#requiredirectives\">the mod_authz_host documentation</a> for further examples of this syntax.</p> <p>You can insert <code>not</code> to negate a particular requirement. Note, that since a <code>not</code> is a negation of a value, it cannot be used by itself to allow or deny a request, as <em>not true</em> does not constitute <em>false</em>. Thus, to deny a visit using a negation, the block must have one element that evaluates as true or false. For example, if you have someone spamming your message board, and you want to keep them out, you could do the following:</p> <pre class=\"prettyprint lang-config\">&lt;RequireAll&gt;\n    Require all granted\n    Require not ip 10.252.46.165\n&lt;/RequireAll&gt;</pre> <p>Visitors coming from that address (<code>10.252.46.165</code>) will not be able to see the content covered by this directive. If, instead, you have a machine name, rather than an IP address, you can use that.</p> <pre class=\"prettyprint lang-config\">Require not host <var>host.example.com</var>\n    </pre> <p>And, if you'd like to block access from an entire domain, you can specify just part of an address or domain name:</p> <pre class=\"prettyprint lang-config\">Require not ip 192.168.205\nRequire not host phishers.example.com moreidiots.example\nRequire not host gov</pre> <p>Use of the <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireall\">RequireAll</a></code>, <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireany\">RequireAny</a></code>, and <code class=\"directive\"><a href=\"../mod/mod_authz_core#requirenone\">RequireNone</a></code> directives may be used to enforce more complex sets of requirements.</p>   <h2 id=\"env\">Access control by arbitrary variables</h2> <p>Using the <code class=\"directive\"><a href=\"../mod/core#if\">&lt;If&gt;</a></code>, you can allow or deny access based on arbitrary environment variables or request header values. For example, to deny access based on user-agent (the browser type) you might do the following:</p> <pre class=\"prettyprint lang-config\">&lt;If \"%{HTTP_USER_AGENT} == 'BadBot'\"&gt;\n    Require all denied\n&lt;/If&gt;</pre> <p>Using the <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> <code>expr</code> syntax, this could also be written as:</p> <pre class=\"prettyprint lang-config\">Require expr %{HTTP_USER_AGENT} != 'BadBot'</pre> <div class=\"note\">\n<p><strong>Warning:</strong></p> <p>Access control by <code>User-Agent</code> is an unreliable technique, since the <code>User-Agent</code> header can be set to anything at all, at the whim of the end user.</p> </div> <p>See <a href=\"../expr\">the expressions document</a> for a further discussion of what expression syntaxes and variables are available to you.</p>   <h2 id=\"rewrite\">Access control with mod_rewrite</h2> <p>The <code>[F]</code> <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> flag causes a 403 Forbidden response to be sent. Using this, you can deny access to a resource based on arbitrary criteria.</p> <p>For example, if you wish to block access to a resource between 8pm and 6am, you can do this using <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>.</p> <pre class=\"prettyprint lang-config\">RewriteEngine On\nRewriteCond \"%{TIME_HOUR}\" \"&gt;=20\" [OR]\nRewriteCond \"%{TIME_HOUR}\" \"&lt;07\"\nRewriteRule \"^/fridge\"     \"-\" [F]</pre> <p>This will return a 403 Forbidden response for any request after 8pm or before 7am. This technique can be used for any criteria that you wish to check. You can also redirect, or otherwise rewrite these requests, if that approach is preferred.</p> <p>The <code class=\"directive\"><a href=\"../mod/core#if\">&lt;If&gt;</a></code> directive, added in 2.4, replaces many things that <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> has traditionally been used to do, and you should probably look there first before resorting to mod_rewrite.</p>   <h2 id=\"moreinformation\">More information</h2> <p>The <a href=\"../expr\">expression engine</a> gives you a great deal of power to do a variety of things based on arbitrary server variables, and you should consult that document for more detail.</p> <p>Also, you should read the <code class=\"module\"><a href=\"../mod/mod_authz_core\">mod_authz_core</a></code> documentation for examples of combining multiple access requirements and specifying how they interact.</p> <p>See also the <a href=\"auth\">Authentication and Authorization</a> howto.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/howto/access.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/howto/access.html</a>\n  </p>\n</div>\n","misc/perf-tuning":"<h1>Apache Performance Tuning</h1>  <p>Apache 2.x is a general-purpose webserver, designed to provide a balance of flexibility, portability, and performance. Although it has not been designed specifically to set benchmark records, Apache 2.x is capable of high performance in many real-world situations.</p> <p>Compared to Apache 1.3, release 2.x contains many additional optimizations to increase throughput and scalability. Most of these improvements are enabled by default. However, there are compile-time and run-time configuration choices that can significantly affect performance. This document describes the options that a server administrator can configure to tune the performance of an Apache 2.x installation. Some of these configuration options enable the httpd to better take advantage of the capabilities of the hardware and OS, while others allow the administrator to trade functionality for speed.</p>     <h2 id=\"hardware\">Hardware and Operating System Issues</h2> <p>The single biggest hardware issue affecting webserver performance is RAM. A webserver should never ever have to swap, as swapping increases the latency of each request beyond a point that users consider \"fast enough\". This causes users to hit stop and reload, further increasing the load. You can, and should, control the <code class=\"directive\"><a href=\"../mod/mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> setting so that your server does not spawn so many children that it starts swapping. The procedure for doing this is simple: determine the size of your average Apache process, by looking at your process list via a tool such as <code>top</code>, and divide this into your total available memory, leaving some room for other processes.</p> <p>Beyond that the rest is mundane: get a fast enough CPU, a fast enough network card, and fast enough disks, where \"fast enough\" is something that needs to be determined by experimentation.</p> <p>Operating system choice is largely a matter of local concerns. But some guidelines that have proven generally useful are:</p> <ul> <li> <p>Run the latest stable release and patch level of the operating system that you choose. Many OS suppliers have introduced significant performance improvements to their TCP stacks and thread libraries in recent years.</p> </li> <li> <p>If your OS supports a <code>sendfile(2)</code> system call, make sure you install the release and/or patches needed to enable it. (With Linux, for example, this means using Linux 2.4 or later. For early releases of Solaris 8, you may need to apply a patch.) On systems where it is available, <code>sendfile</code> enables Apache 2 to deliver static content faster and with lower CPU utilization.</p> </li> </ul>   <h2 id=\"runtime\">Run-Time Configuration Issues</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"../mod/mod_dir\">mod_dir</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mpm_common\">mpm_common</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_status\">mod_status</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_dir#directoryindex\">DirectoryIndex</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#hostnamelookups\">HostnameLookups</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#enablemmap\">EnableMMAP</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#enablesendfile\">EnableSendfile</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#keepalivetimeout\">KeepAliveTimeout</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/prefork#maxspareservers\">MaxSpareServers</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/prefork#minspareservers\">MinSpareServers</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mpm_common#startservers\">StartServers</a></code></li>\n</ul></td>\n</tr>\n</table> <h3><a name=\"dns\" id=\"dns\">HostnameLookups and other DNS considerations</a></h3> <p>Prior to Apache 1.3, <code class=\"directive\"><a href=\"../mod/core#hostnamelookups\">HostnameLookups</a></code> defaulted to <code>On</code>. This adds latency to every request because it requires a DNS lookup to complete before the request is finished. In Apache 1.3 this setting defaults to <code>Off</code>. If you need to have addresses in your log files resolved to hostnames, use the <code class=\"program\"><a href=\"../programs/logresolve\">logresolve</a></code> program that comes with Apache, or one of the numerous log reporting packages which are available.</p> <p>It is recommended that you do this sort of postprocessing of your log files on some machine other than the production web server machine, in order that this activity not adversely affect server performance.</p> <p>If you use any <code><code class=\"directive\"><a href=\"../mod/mod_access_compat#allow\">Allow</a></code> from domain</code> or <code><code class=\"directive\"><a href=\"../mod/mod_access_compat#deny\">Deny</a></code> from domain</code> directives (i.e., using a hostname, or a domain name, rather than an IP address) then you will pay for two DNS lookups (a reverse, followed by a forward lookup to make sure that the reverse is not being spoofed). For best performance, therefore, use IP addresses, rather than names, when using these directives, if possible.</p> <p>Note that it's possible to scope the directives, such as within a <code>&lt;Location \"/server-status\"&gt;</code> section. In this case the DNS lookups are only performed on requests matching the criteria. Here's an example which disables lookups except for <code>.html</code> and <code>.cgi</code> files:</p> <pre class=\"prettyprint lang-config\">HostnameLookups off\n&lt;Files ~ \"\\.(html|cgi)$\"&gt;\n  HostnameLookups on\n&lt;/Files&gt;</pre> <p>But even still, if you just need DNS names in some CGIs you could consider doing the <code>gethostbyname</code> call in the specific CGIs that need it.</p> <h3><a name=\"symlinks\" id=\"symlinks\">FollowSymLinks and SymLinksIfOwnerMatch</a></h3> <p>Wherever in your URL-space you do not have an <code>Options FollowSymLinks</code>, or you do have an <code>Options SymLinksIfOwnerMatch</code>, Apache will need to issue extra system calls to check up on symlinks. (One extra call per filename component.) For example, if you had:</p> <pre class=\"prettyprint lang-config\">DocumentRoot \"/www/htdocs\"\n&lt;Directory \"/\"&gt;\n  Options SymLinksIfOwnerMatch\n&lt;/Directory&gt;</pre> <p>and a request is made for the URI <code>/index.html</code>, then Apache will perform <code>lstat(2)</code> on <code>/www</code>, <code>/www/htdocs</code>, and <code>/www/htdocs/index.html</code>. The results of these <code>lstats</code> are never cached, so they will occur on every single request. If you really desire the symlinks security checking, you can do something like this:</p> <pre class=\"prettyprint lang-config\">DocumentRoot \"/www/htdocs\"\n&lt;Directory \"/\"&gt;\n  Options FollowSymLinks\n&lt;/Directory&gt;\n\n&lt;Directory \"/www/htdocs\"&gt;\n  Options -FollowSymLinks +SymLinksIfOwnerMatch\n&lt;/Directory&gt;</pre> <p>This at least avoids the extra checks for the <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> path. Note that you'll need to add similar sections if you have any <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code> or <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> paths outside of your document root. For highest performance, and no symlink protection, set <code>FollowSymLinks</code> everywhere, and never set <code>SymLinksIfOwnerMatch</code>.</p> <h3><a name=\"htaccess\" id=\"htaccess\">AllowOverride</a></h3> <p>Wherever in your URL-space you allow overrides (typically <code>.htaccess</code> files), Apache will attempt to open <code>.htaccess</code> for each filename component. For example,</p> <pre class=\"prettyprint lang-config\">DocumentRoot \"/www/htdocs\"\n&lt;Directory \"/\"&gt;\n  AllowOverride all\n&lt;/Directory&gt;</pre> <p>and a request is made for the URI <code>/index.html</code>. Then Apache will attempt to open <code>/.htaccess</code>, <code>/www/.htaccess</code>, and <code>/www/htdocs/.htaccess</code>. The solutions are similar to the previous case of <code>Options FollowSymLinks</code>. For highest performance use <code>AllowOverride None</code> everywhere in your filesystem.</p> <h3><a name=\"negotiation\" id=\"negotiation\">Negotiation</a></h3> <p>If at all possible, avoid content negotiation if you're really interested in every last ounce of performance. In practice the benefits of negotiation outweigh the performance penalties. There's one case where you can speed up the server. Instead of using a wildcard such as:</p> <pre class=\"prettyprint lang-config\">DirectoryIndex index</pre> <p>Use a complete list of options:</p> <pre class=\"prettyprint lang-config\">DirectoryIndex index.cgi index.pl index.shtml index.html</pre> <p>where you list the most common choice first.</p> <p>Also note that explicitly creating a <code>type-map</code> file provides better performance than using <code>MultiViews</code>, as the necessary information can be determined by reading this single file, rather than having to scan the directory for files.</p> <p>If your site needs content negotiation, consider using <code>type-map</code> files, rather than the <code>Options MultiViews</code> directive to accomplish the negotiation. See the <a href=\"../content-negotiation\">Content Negotiation</a> documentation for a full discussion of the methods of negotiation, and instructions for creating <code>type-map</code> files.</p> <h3>Memory-mapping</h3> <p>In situations where Apache 2.x needs to look at the contents of a file being delivered--for example, when doing server-side-include processing--it normally memory-maps the file if the OS supports some form of <code>mmap(2)</code>.</p> <p>On some platforms, this memory-mapping improves performance. However, there are cases where memory-mapping can hurt the performance or even the stability of the httpd:</p> <ul> <li> <p>On some operating systems, <code>mmap</code> does not scale as well as <code>read(2)</code> when the number of CPUs increases. On multiprocessor Solaris servers, for example, Apache 2.x sometimes delivers server-parsed files faster when <code>mmap</code> is disabled.</p> </li> <li> <p>If you memory-map a file located on an NFS-mounted filesystem and a process on another NFS client machine deletes or truncates the file, your process may get a bus error the next time it tries to access the mapped file content.</p> </li> </ul> <p>For installations where either of these factors applies, you should use <code>EnableMMAP off</code> to disable the memory-mapping of delivered files. (Note: This directive can be overridden on a per-directory basis.)</p> <h3>Sendfile</h3> <p>In situations where Apache 2.x can ignore the contents of the file to be delivered -- for example, when serving static file content -- it normally uses the kernel sendfile support for the file if the OS supports the <code>sendfile(2)</code> operation.</p> <p>On most platforms, using sendfile improves performance by eliminating separate read and send mechanics. However, there are cases where using sendfile can harm the stability of the httpd:</p> <ul> <li> <p>Some platforms may have broken sendfile support that the build system did not detect, especially if the binaries were built on another box and moved to such a machine with broken sendfile support.</p> </li> <li> <p>With an NFS-mounted filesystem, the kernel may be unable to reliably serve the network file through its own cache.</p> </li> </ul> <p>For installations where either of these factors applies, you should use <code>EnableSendfile off</code> to disable sendfile delivery of file contents. (Note: This directive can be overridden on a per-directory basis.)</p> <h3><a name=\"process\" id=\"process\">Process Creation</a></h3> <p>Prior to Apache 1.3 the <code class=\"directive\"><a href=\"../mod/prefork#minspareservers\">MinSpareServers</a></code>, <code class=\"directive\"><a href=\"../mod/prefork#maxspareservers\">MaxSpareServers</a></code>, and <code class=\"directive\"><a href=\"../mod/mpm_common#startservers\">StartServers</a></code> settings all had drastic effects on benchmark results. In particular, Apache required a \"ramp-up\" period in order to reach a number of children sufficient to serve the load being applied. After the initial spawning of <code class=\"directive\"><a href=\"../mod/mpm_common#startservers\">StartServers</a></code> children, only one child per second would be created to satisfy the <code class=\"directive\"><a href=\"../mod/prefork#minspareservers\">MinSpareServers</a></code> setting. So a server being accessed by 100 simultaneous clients, using the default <code class=\"directive\"><a href=\"../mod/mpm_common#startservers\">StartServers</a></code> of <code>5</code> would take on the order of 95 seconds to spawn enough children to handle the load. This works fine in practice on real-life servers because they aren't restarted frequently. But it does really poorly on benchmarks which might only run for ten minutes.</p> <p>The one-per-second rule was implemented in an effort to avoid swamping the machine with the startup of new children. If the machine is busy spawning children, it can't service requests. But it has such a drastic effect on the perceived performance of Apache that it had to be replaced. As of Apache 1.3, the code will relax the one-per-second rule. It will spawn one, wait a second, then spawn two, wait a second, then spawn four, and it will continue exponentially until it is spawning 32 children per second. It will stop whenever it satisfies the <code class=\"directive\"><a href=\"../mod/prefork#minspareservers\">MinSpareServers</a></code> setting.</p> <p>This appears to be responsive enough that it's almost unnecessary to twiddle the <code class=\"directive\"><a href=\"../mod/prefork#minspareservers\">MinSpareServers</a></code>, <code class=\"directive\"><a href=\"../mod/prefork#maxspareservers\">MaxSpareServers</a></code> and <code class=\"directive\"><a href=\"../mod/mpm_common#startservers\">StartServers</a></code> knobs. When more than 4 children are spawned per second, a message will be emitted to the <code class=\"directive\"><a href=\"../mod/core#errorlog\">ErrorLog</a></code>. If you see a lot of these errors, then consider tuning these settings. Use the <code class=\"module\"><a href=\"../mod/mod_status\">mod_status</a></code> output as a guide.</p> <p>Related to process creation is process death induced by the <code class=\"directive\"><a href=\"../mod/mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code> setting. By default this is <code>0</code>, which means that there is no limit to the number of connections handled per child. If your configuration currently has this set to some very low number, such as <code>30</code>, you may want to bump this up significantly. If you are running SunOS or an old version of Solaris, limit this to <code>10000</code> or so because of memory leaks.</p> <p>When keep-alives are in use, children will be kept busy doing nothing waiting for more requests on the already open connection. The default <code class=\"directive\"><a href=\"../mod/core#keepalivetimeout\">KeepAliveTimeout</a></code> of <code>5</code> seconds attempts to minimize this effect. The tradeoff here is between network bandwidth and server resources. In no event should you raise this above about <code>60</code> seconds, as <a href=\"http://www.hpl.hp.com/techreports/Compaq-DEC/WRL-95-4.html\"> most of the benefits are lost</a>.</p>   <h2 id=\"compiletime\">Compile-Time Configuration Issues</h2> <h3>Choosing an MPM</h3> <p>Apache 2.x supports pluggable concurrency models, called <a href=\"../mpm\">Multi-Processing Modules</a> (MPMs). When building Apache, you must choose an MPM to use. There are platform-specific MPMs for some platforms: <code class=\"module\"><a href=\"../mod/mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"../mod/mpmt_os2\">mpmt_os2</a></code>, and <code class=\"module\"><a href=\"../mod/mpm_winnt\">mpm_winnt</a></code>. For general Unix-type systems, there are several MPMs from which to choose. The choice of MPM can affect the speed and scalability of the httpd:</p> <ul> <li>The <code class=\"module\"><a href=\"../mod/worker\">worker</a></code> MPM uses multiple child processes with many threads each. Each thread handles one connection at a time. Worker generally is a good choice for high-traffic servers because it has a smaller memory footprint than the prefork MPM.</li> <li>The <code class=\"module\"><a href=\"../mod/event\">event</a></code> MPM is threaded like the Worker MPM, but is designed to allow more requests to be served simultaneously by passing off some processing work to supporting threads, freeing up the main threads to work on new requests.</li> <li>The <code class=\"module\"><a href=\"../mod/prefork\">prefork</a></code> MPM uses multiple child processes with one thread each. Each process handles one connection at a time. On many systems, prefork is comparable in speed to worker, but it uses more memory. Prefork's threadless design has advantages over worker in some situations: it can be used with non-thread-safe third-party modules, and it is easier to debug on platforms with poor thread debugging support.</li> </ul> <p>For more information on these and other MPMs, please see the MPM <a href=\"../mpm\">documentation</a>.</p> <h3><a name=\"modules\" id=\"modules\">Modules</a></h3> <p>Since memory usage is such an important consideration in performance, you should attempt to eliminate modules that you are not actually using. If you have built the modules as <a href=\"../dso\">DSOs</a>, eliminating modules is a simple matter of commenting out the associated <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive for that module. This allows you to experiment with removing modules and seeing if your site still functions in their absence.</p> <p>If, on the other hand, you have modules statically linked into your Apache binary, you will need to recompile Apache in order to remove unwanted modules.</p> <p>An associated question that arises here is, of course, what modules you need, and which ones you don't. The answer here will, of course, vary from one web site to another. However, the <em>minimal</em> list of modules which you can get by with tends to include <code class=\"module\"><a href=\"../mod/mod_mime\">mod_mime</a></code>, <code class=\"module\"><a href=\"../mod/mod_dir\">mod_dir</a></code>, and <code class=\"module\"><a href=\"../mod/mod_log_config\">mod_log_config</a></code>. <code>mod_log_config</code> is, of course, optional, as you can run a web site without log files. This is, however, not recommended.</p> <h3>Atomic Operations</h3> <p>Some modules, such as <code class=\"module\"><a href=\"../mod/mod_cache\">mod_cache</a></code> and recent development builds of the worker MPM, use APR's atomic API. This API provides atomic operations that can be used for lightweight thread synchronization.</p> <p>By default, APR implements these operations using the most efficient mechanism available on each target OS/CPU platform. Many modern CPUs, for example, have an instruction that does an atomic compare-and-swap (CAS) operation in hardware. On some platforms, however, APR defaults to a slower, mutex-based implementation of the atomic API in order to ensure compatibility with older CPU models that lack such instructions. If you are building Apache for one of these platforms, and you plan to run only on newer CPUs, you can select a faster atomic implementation at build time by configuring Apache with the <code>--enable-nonportable-atomics</code> option:</p> <div class=\"example\"><pre>./buildconf\n./configure --with-mpm=worker --enable-nonportable-atomics=yes</pre></div> <p>The <code>--enable-nonportable-atomics</code> option is relevant for the following platforms:</p> <ul> <li>Solaris on SPARC<br> By default, APR uses mutex-based atomics on Solaris/SPARC. If you configure with <code>--enable-nonportable-atomics</code>, however, APR generates code that uses a SPARC v8plus opcode for fast hardware compare-and-swap. If you configure Apache with this option, the atomic operations will be more efficient (allowing for lower CPU utilization and higher concurrency), but the resulting executable will run only on UltraSPARC chips. </li> <li>Linux on x86<br> By default, APR uses mutex-based atomics on Linux. If you configure with <code>--enable-nonportable-atomics</code>, however, APR generates code that uses a 486 opcode for fast hardware compare-and-swap. This will result in more efficient atomic operations, but the resulting executable will run only on 486 and later chips (and not on 386). </li> </ul> <h3>mod_status and ExtendedStatus On</h3> <p>If you include <code class=\"module\"><a href=\"../mod/mod_status\">mod_status</a></code> and you also set <code>ExtendedStatus On</code> when building and running Apache, then on every request Apache will perform two calls to <code>gettimeofday(2)</code> (or <code>times(2)</code> depending on your operating system), and (pre-1.3) several extra calls to <code>time(2)</code>. This is all done so that the status report contains timing indications. For highest performance, set <code>ExtendedStatus off</code> (which is the default).</p> <h3>accept Serialization - Multiple Sockets</h3> <div class=\"warning\">\n<p><strong>Warning:</strong></p> <p>This section has not been fully updated to take into account changes made in the 2.x version of the Apache HTTP Server. Some of the information may still be relevant, but please use it with care.</p> </div> <p>This discusses a shortcoming in the Unix socket API. Suppose your web server uses multiple <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> statements to listen on either multiple ports or multiple addresses. In order to test each socket to see if a connection is ready, Apache uses <code>select(2)</code>. <code>select(2)</code> indicates that a socket has <em>zero</em> or <em>at least one</em> connection waiting on it. Apache's model includes multiple children, and all the idle ones test for new connections at the same time. A naive implementation looks something like this (these examples do not match the code, they're contrived for pedagogical purposes):</p> <pre class=\"prettyprint lang-c\">        for (;;) {\n          for (;;) {\n            fd_set accept_fds;\n\n            FD_ZERO (&amp;accept_fds);\n            for (i = first_socket; i &lt;= last_socket; ++i) {\n              FD_SET (i, &amp;accept_fds);\n            }\n            rc = select (last_socket+1, &amp;accept_fds, NULL, NULL, NULL);\n            if (rc &lt; 1) continue;\n            new_connection = -1;\n            for (i = first_socket; i &lt;= last_socket; ++i) {\n              if (FD_ISSET (i, &amp;accept_fds)) {\n                new_connection = accept (i, NULL, NULL);\n                if (new_connection != -1) break;\n              }\n            }\n            if (new_connection != -1) break;\n          }\n          process_the(new_connection);\n        }</pre> <p>But this naive implementation has a serious starvation problem. Recall that multiple children execute this loop at the same time, and so multiple children will block at <code>select</code> when they are in between requests. All those blocked children will awaken and return from <code>select</code> when a single request appears on any socket. (The number of children which awaken varies depending on the operating system and timing issues.) They will all then fall down into the loop and try to <code>accept</code> the connection. But only one will succeed (assuming there's still only one connection ready). The rest will be <em>blocked</em> in <code>accept</code>. This effectively locks those children into serving requests from that one socket and no other sockets, and they'll be stuck there until enough new requests appear on that socket to wake them all up. This starvation problem was first documented in <a href=\"http://bugs.apache.org/index/full/467\">PR#467</a>. There are at least two solutions.</p> <p>One solution is to make the sockets non-blocking. In this case the <code>accept</code> won't block the children, and they will be allowed to continue immediately. But this wastes CPU time. Suppose you have ten idle children in <code>select</code>, and one connection arrives. Then nine of those children will wake up, try to <code>accept</code> the connection, fail, and loop back into <code>select</code>, accomplishing nothing. Meanwhile none of those children are servicing requests that occurred on other sockets until they get back up to the <code>select</code> again. Overall this solution does not seem very fruitful unless you have as many idle CPUs (in a multiprocessor box) as you have idle children (not a very likely situation).</p> <p>Another solution, the one used by Apache, is to serialize entry into the inner loop. The loop looks like this (differences highlighted):</p> <pre class=\"prettyprint lang-c\">        for (;;) {\n          <strong>accept_mutex_on ();</strong>\n          for (;;) {\n            fd_set accept_fds;\n            \n            FD_ZERO (&amp;accept_fds);\n            for (i = first_socket; i &lt;= last_socket; ++i) {\n              FD_SET (i, &amp;accept_fds);\n            }\n            rc = select (last_socket+1, &amp;accept_fds, NULL, NULL, NULL);\n            if (rc &lt; 1) continue;\n            new_connection = -1;\n            for (i = first_socket; i &lt;= last_socket; ++i) {\n              if (FD_ISSET (i, &amp;accept_fds)) {\n                new_connection = accept (i, NULL, NULL);\n                if (new_connection != -1) break;\n              }\n            }\n            if (new_connection != -1) break;\n          }\n          <strong>accept_mutex_off ();</strong>\n          process the new_connection;\n        }</pre> <p><a id=\"serialize\" name=\"serialize\">The functions</a> <code>accept_mutex_on</code> and <code>accept_mutex_off</code> implement a mutual exclusion semaphore. Only one child can have the mutex at any time. There are several choices for implementing these mutexes. The choice is defined in <code>src/conf.h</code> (pre-1.3) or <code>src/include/ap_config.h</code> (1.3 or later). Some architectures do not have any locking choice made, on these architectures it is unsafe to use multiple <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> directives.</p> <p>The <code class=\"directive\"><a href=\"../mod/core#mutex\">Mutex</a></code> directive can be used to change the mutex implementation of the <code>mpm-accept</code> mutex at run-time. Special considerations for different mutex implementations are documented with that directive.</p> <p>Another solution that has been considered but never implemented is to partially serialize the loop -- that is, let in a certain number of processes. This would only be of interest on multiprocessor boxes where it's possible that multiple children could run simultaneously, and the serialization actually doesn't take advantage of the full bandwidth. This is a possible area of future investigation, but priority remains low because highly parallel web servers are not the norm.</p> <p>Ideally you should run servers without multiple <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> statements if you want the highest performance. But read on.</p> <h3>accept Serialization - Single Socket</h3> <p>The above is fine and dandy for multiple socket servers, but what about single socket servers? In theory they shouldn't experience any of these same problems because all the children can just block in <code>accept(2)</code> until a connection arrives, and no starvation results. In practice this hides almost the same \"spinning\" behavior discussed above in the non-blocking solution. The way that most TCP stacks are implemented, the kernel actually wakes up all processes blocked in <code>accept</code> when a single connection arrives. One of those processes gets the connection and returns to user-space. The rest spin in the kernel and go back to sleep when they discover there's no connection for them. This spinning is hidden from the user-land code, but it's there nonetheless. This can result in the same load-spiking wasteful behavior that a non-blocking solution to the multiple sockets case can.</p> <p>For this reason we have found that many architectures behave more \"nicely\" if we serialize even the single socket case. So this is actually the default in almost all cases. Crude experiments under Linux (2.0.30 on a dual Pentium pro 166 w/128Mb RAM) have shown that the serialization of the single socket case causes less than a 3% decrease in requests per second over unserialized single-socket. But unserialized single-socket showed an extra 100ms latency on each request. This latency is probably a wash on long haul lines, and only an issue on LANs. If you want to override the single socket serialization, you can define <code>SINGLE_LISTEN_UNSERIALIZED_ACCEPT</code>, and then single-socket servers will not serialize at all.</p> <h3>Lingering Close</h3> <p>As discussed in <a href=\"http://www.ics.uci.edu/pub/ietf/http/draft-ietf-http-connection-00.txt\"> draft-ietf-http-connection-00.txt</a> section 8, in order for an HTTP server to <strong>reliably</strong> implement the protocol, it needs to shut down each direction of the communication independently. (Recall that a TCP connection is bi-directional. Each half is independent of the other.)</p> <p>When this feature was added to Apache, it caused a flurry of problems on various versions of Unix because of shortsightedness. The TCP specification does not state that the <code>FIN_WAIT_2</code> state has a timeout, but it doesn't prohibit it. On systems without the timeout, Apache 1.2 induces many sockets stuck forever in the <code>FIN_WAIT_2</code> state. In many cases this can be avoided by simply upgrading to the latest TCP/IP patches supplied by the vendor. In cases where the vendor has never released patches (<em>i.e.</em>, SunOS4 -- although folks with a source license can patch it themselves), we have decided to disable this feature.</p> <p>There are two ways to accomplish this. One is the socket option <code>SO_LINGER</code>. But as fate would have it, this has never been implemented properly in most TCP/IP stacks. Even on those stacks with a proper implementation (<em>i.e.</em>, Linux 2.0.31), this method proves to be more expensive (cputime) than the next solution.</p> <p>For the most part, Apache implements this in a function called <code>lingering_close</code> (in <code>http_main.c</code>). The function looks roughly like this:</p> <pre class=\"prettyprint lang-c\">        void lingering_close (int s)\n        {\n          char junk_buffer[2048];\n          \n          /* shutdown the sending side */\n          shutdown (s, 1);\n\n          signal (SIGALRM, lingering_death);\n          alarm (30);\n\n          for (;;) {\n            select (s for reading, 2 second timeout);\n            if (error) break;\n            if (s is ready for reading) {\n              if (read (s, junk_buffer, sizeof (junk_buffer)) &lt;= 0) {\n                break;\n              }\n              /* just toss away whatever is here */\n            }\n          }\n          \n          close (s);\n        }</pre> <p>This naturally adds some expense at the end of a connection, but it is required for a reliable implementation. As HTTP/1.1 becomes more prevalent, and all connections are persistent, this expense will be amortized over more requests. If you want to play with fire and disable this feature, you can define <code>NO_LINGCLOSE</code>, but this is not recommended at all. In particular, as HTTP/1.1 pipelined persistent connections come into use, <code>lingering_close</code> is an absolute necessity (and <a href=\"http://www.w3.org/Protocols/HTTP/Performance/Pipeline.html\"> pipelined connections are faster</a>, so you want to support them).</p> <h3>Scoreboard File</h3> <p>Apache's parent and children communicate with each other through something called the scoreboard. Ideally this should be implemented in shared memory. For those operating systems that we either have access to, or have been given detailed ports for, it typically is implemented using shared memory. The rest default to using an on-disk file. The on-disk file is not only slow, but it is unreliable (and less featured). Peruse the <code>src/main/conf.h</code> file for your architecture, and look for either <code>USE_MMAP_SCOREBOARD</code> or <code>USE_SHMGET_SCOREBOARD</code>. Defining one of those two (as well as their companions <code>HAVE_MMAP</code> and <code>HAVE_SHMGET</code> respectively) enables the supplied shared memory code. If your system has another type of shared memory, edit the file <code>src/main/http_main.c</code> and add the hooks necessary to use it in Apache. (Send us back a patch too, please.)</p> <div class=\"note\">Historical note: The Linux port of Apache didn't start to use shared memory until version 1.2 of Apache. This oversight resulted in really poor and unreliable behavior of earlier versions of Apache on Linux.</div> <h3>DYNAMIC_MODULE_LIMIT</h3> <p>If you have no intention of using dynamically loaded modules (you probably don't if you're reading this and tuning your server for every last ounce of performance), then you should add <code>-DDYNAMIC_MODULE_LIMIT=0</code> when building your server. This will save RAM that's allocated only for supporting dynamically loaded modules.</p>   <h2 id=\"trace\">Appendix: Detailed Analysis of a Trace</h2> <p>Here is a system call trace of Apache 2.0.38 with the worker MPM on Solaris 8. This trace was collected using:</p> <div class=\"example\"><pre>truss -l -p httpd_child_pid.</pre></div> <p>The <code>-l</code> option tells truss to log the ID of the LWP (lightweight process--Solaris' form of kernel-level thread) that invokes each system call.</p> <p>Other systems may have different system call tracing utilities such as <code>strace</code>, <code>ktrace</code>, or <code>par</code>. They all produce similar output.</p> <p>In this trace, a client has requested a 10KB static file from the httpd. Traces of non-static requests or requests with content negotiation look wildly different (and quite ugly in some cases).</p> <div class=\"example\"><pre>/67:    accept(3, 0x00200BEC, 0x00200C0C, 1) (sleeping...)\n/67:    accept(3, 0x00200BEC, 0x00200C0C, 1)            = 9</pre></div> <p>In this trace, the listener thread is running within LWP #67.</p> <div class=\"note\">Note the lack of <code>accept(2)</code> serialization. On this particular platform, the worker MPM uses an unserialized accept by default unless it is listening on multiple ports.</div> <div class=\"example\"><pre>/65:    lwp_park(0x00000000, 0)                         = 0\n/67:    lwp_unpark(65, 1)                               = 0</pre></div> <p>Upon accepting the connection, the listener thread wakes up a worker thread to do the request processing. In this trace, the worker thread that handles the request is mapped to LWP #65.</p> <div class=\"example\"><pre>/65:    getsockname(9, 0x00200BA4, 0x00200BC4, 1)       = 0</pre></div> <p>In order to implement virtual hosts, Apache needs to know the local socket address used to accept the connection. It is possible to eliminate this call in many situations (such as when there are no virtual hosts, or when <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> directives are used which do not have wildcard addresses). But no effort has yet been made to do these optimizations. </p> <div class=\"example\"><pre>/65:    brk(0x002170E8)                                 = 0\n/65:    brk(0x002190E8)                                 = 0</pre></div> <p>The <code>brk(2)</code> calls allocate memory from the heap. It is rare to see these in a system call trace, because the httpd uses custom memory allocators (<code>apr_pool</code> and <code>apr_bucket_alloc</code>) for most request processing. In this trace, the httpd has just been started, so it must call <code>malloc(3)</code> to get the blocks of raw memory with which to create the custom memory allocators.</p> <div class=\"example\"><pre>/65:    fcntl(9, F_GETFL, 0x00000000)                   = 2\n/65:    fstat64(9, 0xFAF7B818)                          = 0\n/65:    getsockopt(9, 65535, 8192, 0xFAF7B918, 0xFAF7B910, 2190656) = 0\n/65:    fstat64(9, 0xFAF7B818)                          = 0\n/65:    getsockopt(9, 65535, 8192, 0xFAF7B918, 0xFAF7B914, 2190656) = 0\n/65:    setsockopt(9, 65535, 8192, 0xFAF7B918, 4, 2190656) = 0\n/65:    fcntl(9, F_SETFL, 0x00000082)                   = 0</pre></div> <p>Next, the worker thread puts the connection to the client (file descriptor 9) in non-blocking mode. The <code>setsockopt(2)</code> and <code>getsockopt(2)</code> calls are a side-effect of how Solaris' libc handles <code>fcntl(2)</code> on sockets.</p> <div class=\"example\"><pre>/65:    read(9, \" G E T   / 1 0 k . h t m\".., 8000)     = 97</pre></div> <p>The worker thread reads the request from the client.</p> <div class=\"example\"><pre>/65:    stat(\"/var/httpd/apache/httpd-8999/htdocs/10k.html\", 0xFAF7B978) = 0\n/65:    open(\"/var/httpd/apache/httpd-8999/htdocs/10k.html\", O_RDONLY) = 10</pre></div> <p>This httpd has been configured with <code>Options FollowSymLinks</code> and <code>AllowOverride None</code>. Thus it doesn't need to <code>lstat(2)</code> each directory in the path leading up to the requested file, nor check for <code>.htaccess</code> files. It simply calls <code>stat(2)</code> to verify that the file: 1) exists, and 2) is a regular file, not a directory.</p> <div class=\"example\"><pre>/65:    sendfilev(0, 9, 0x00200F90, 2, 0xFAF7B53C)      = 10269</pre></div> <p>In this example, the httpd is able to send the HTTP response header and the requested file with a single <code>sendfilev(2)</code> system call. Sendfile semantics vary among operating systems. On some other systems, it is necessary to do a <code>write(2)</code> or <code>writev(2)</code> call to send the headers before calling <code>sendfile(2)</code>.</p> <div class=\"example\"><pre>/65:    write(4, \" 1 2 7 . 0 . 0 . 1   -  \".., 78)      = 78</pre></div> <p>This <code>write(2)</code> call records the request in the access log. Note that one thing missing from this trace is a <code>time(2)</code> call. Unlike Apache 1.3, Apache 2.x uses <code>gettimeofday(3)</code> to look up the time. On some operating systems, like Linux or Solaris, <code>gettimeofday</code> has an optimized implementation that doesn't require as much overhead as a typical system call.</p> <div class=\"example\"><pre>/65:    shutdown(9, 1, 1)                               = 0\n/65:    poll(0xFAF7B980, 1, 2000)                       = 1\n/65:    read(9, 0xFAF7BC20, 512)                        = 0\n/65:    close(9)                                        = 0</pre></div> <p>The worker thread does a lingering close of the connection.</p> <div class=\"example\"><pre>/65:    close(10)                                       = 0\n/65:    lwp_park(0x00000000, 0)         (sleeping...)</pre></div> <p>Finally the worker thread closes the file that it has just delivered and blocks until the listener assigns it another connection.</p> <div class=\"example\"><pre>/67:    accept(3, 0x001FEB74, 0x001FEB94, 1) (sleeping...)</pre></div> <p>Meanwhile, the listener thread is able to accept another connection as soon as it has dispatched this connection to a worker thread (subject to some flow-control logic in the worker MPM that throttles the listener if all the available workers are busy). Though it isn't apparent from this trace, the next <code>accept(2)</code> can (and usually does, under high load conditions) occur in parallel with the worker thread's handling of the just-accepted connection.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/misc/perf-tuning.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/misc/perf-tuning.html</a>\n  </p>\n</div>\n","howto/cgi":"<h1>Apache Tutorial: Dynamic Content with CGI</h1>      <h2 id=\"intro\">Introduction</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"../mod/mod_alias\">mod_alias</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_cgi\">mod_cgi</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_cgid\">mod_cgid</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"../mod/mod_mime#addhandler\">AddHandler</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_alias#scriptalias\">ScriptAlias</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The CGI (Common Gateway Interface) defines a way for a web server to interact with external content-generating programs, which are often referred to as CGI programs or CGI scripts. It is the simplest, and most common, way to put dynamic content on your web site. This document will be an introduction to setting up CGI on your Apache web server, and getting started writing CGI programs.</p>   <h2 id=\"configuring\">Configuring Apache to permit CGI</h2> <p>In order to get your CGI programs to work properly, you'll need to have Apache configured to permit CGI execution. There are several ways to do this.</p> <div class=\"warning\">Note: If Apache has been built with shared module support you need to ensure that the module is loaded; in your <code>httpd.conf</code> you need to make sure the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive has not been commented out. A correctly configured directive may look like this: <pre class=\"prettyprint lang-config\">LoadModule cgid_module modules/mod_cgid.so</pre> On Windows, or using a non-threaded MPM like prefork, A correctly configured directive may look like this: <pre class=\"prettyprint lang-config\">LoadModule cgi_module modules/mod_cgi.so</pre> </div> <h3><a name=\"scriptalias\" id=\"scriptalias\">ScriptAlias</a></h3> <p>The <code class=\"directive\"><a href=\"../mod/mod_alias#scriptalias\">ScriptAlias</a></code> directive tells Apache that a particular directory is set aside for CGI programs. Apache will assume that every file in this directory is a CGI program, and will attempt to execute it, when that particular resource is requested by a client.</p> <p>The <code class=\"directive\"><a href=\"../mod/mod_alias#scriptalias\">ScriptAlias</a></code> directive looks like:</p> <pre class=\"prettyprint lang-config\">ScriptAlias \"/cgi-bin/\" \"/usr/local/apache2/cgi-bin/\"</pre> <p>The example shown is from your default <code>httpd.conf</code> configuration file, if you installed Apache in the default location. The <code class=\"directive\"><a href=\"../mod/mod_alias#scriptalias\">ScriptAlias</a></code> directive is much like the <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code> directive, which defines a URL prefix that is to mapped to a particular directory. <code class=\"directive\">Alias</code> and <code class=\"directive\">ScriptAlias</code> are usually used for directories that are outside of the <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> directory. The difference between <code class=\"directive\">Alias</code> and <code class=\"directive\">ScriptAlias</code> is that <code class=\"directive\">ScriptAlias</code> has the added meaning that everything under that URL prefix will be considered a CGI program. So, the example above tells Apache that any request for a resource beginning with <code>/cgi-bin/</code> should be served from the directory <code>/usr/local/apache2/cgi-bin/</code>, and should be treated as a CGI program.</p> <p>For example, if the URL <code>http://www.example.com/cgi-bin/test.pl</code> is requested, Apache will attempt to execute the file <code>/usr/local/apache2/cgi-bin/test.pl</code> and return the output. Of course, the file will have to exist, and be executable, and return output in a particular way, or Apache will return an error message.</p> <h3><a name=\"nonscriptalias\" id=\"nonscriptalias\">CGI outside of ScriptAlias directories</a></h3> <p>CGI programs are often restricted to <code class=\"directive\"><a href=\"../mod/mod_alias#scriptalias\">ScriptAlias</a></code>'ed directories for security reasons. In this way, administrators can tightly control who is allowed to use CGI programs. However, if the proper security precautions are taken, there is no reason why CGI programs cannot be run from arbitrary directories. For example, you may wish to let users have web content in their home directories with the <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> directive. If they want to have their own CGI programs, but don't have access to the main <code>cgi-bin</code> directory, they will need to be able to run CGI programs elsewhere.</p> <p>There are two steps to allowing CGI execution in an arbitrary directory. First, the <code>cgi-script</code> handler must be activated using the <code class=\"directive\"><a href=\"../mod/mod_mime#addhandler\">AddHandler</a></code> or <code class=\"directive\"><a href=\"../mod/core#sethandler\">SetHandler</a></code> directive. Second, <code>ExecCGI</code> must be specified in the <code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code> directive.</p> <h3><a name=\"options\" id=\"options\">Explicitly using Options to permit CGI execution</a></h3> <p>You could explicitly use the <code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code> directive, inside your main server configuration file, to specify that CGI execution was permitted in a particular directory:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/usr/local/apache2/htdocs/somedir\"&gt;\n    Options +ExecCGI\n&lt;/Directory&gt;</pre> <p>The above directive tells Apache to permit the execution of CGI files. You will also need to tell the server what files are CGI files. The following <code class=\"directive\"><a href=\"../mod/mod_mime#addhandler\">AddHandler</a></code> directive tells the server to treat all files with the <code>cgi</code> or <code>pl</code> extension as CGI programs:</p> <pre class=\"prettyprint lang-config\">AddHandler cgi-script .cgi .pl</pre> <h3><a name=\"htaccess\" id=\"htaccess\">.htaccess files</a></h3> <p>The <a href=\"htaccess\"><code>.htaccess</code> tutorial</a> shows how to activate CGI programs if you do not have access to <code>httpd.conf</code>.</p> <h3><a name=\"userdir\" id=\"userdir\">User Directories</a></h3> <p>To allow CGI program execution for any file ending in <code>.cgi</code> in users' directories, you can use the following configuration.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/home/*/public_html\"&gt;\n    Options +ExecCGI\n    AddHandler cgi-script .cgi\n&lt;/Directory&gt;</pre> <p>If you wish designate a <code>cgi-bin</code> subdirectory of a user's directory where everything will be treated as a CGI program, you can use the following.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/home/*/public_html/cgi-bin\"&gt;\n    Options ExecCGI\n    SetHandler cgi-script\n&lt;/Directory&gt;</pre>   <h2 id=\"writing\">Writing a CGI program</h2> <p>There are two main differences between ``regular'' programming, and CGI programming.</p> <p>First, all output from your CGI program must be preceded by a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME-type</a> header. This is HTTP header that tells the client what sort of content it is receiving. Most of the time, this will look like:</p> <div class=\"example\"><pre>Content-type: text/html</pre></div> <p>Secondly, your output needs to be in HTML, or some other format that a browser will be able to display. Most of the time, this will be HTML, but occasionally you might write a CGI program that outputs a gif image, or other non-HTML content.</p> <p>Apart from those two things, writing a CGI program will look a lot like any other program that you might write.</p> <h3><a name=\"firstcgi\" id=\"firstcgi\">Your first CGI program</a></h3> <p>The following is an example CGI program that prints one line to your browser. Type in the following, save it to a file called <code>first.pl</code>, and put it in your <code>cgi-bin</code> directory.</p> <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl\nprint \"Content-type: text/html\\n\\n\";\nprint \"Hello, World.\";</pre> <p>Even if you are not familiar with Perl, you should be able to see what is happening here. The first line tells Apache (or whatever shell you happen to be running under) that this program can be executed by feeding the file to the interpreter found at the location <code>/usr/bin/perl</code>. The second line prints the content-type declaration we talked about, followed by two carriage-return newline pairs. This puts a blank line after the header, to indicate the end of the HTTP headers, and the beginning of the body. The third line prints the string \"Hello, World.\". And that's the end of it.</p> <p>If you open your favorite browser and tell it to get the address</p> <div class=\"example\"><code>http://www.example.com/cgi-bin/first.pl</code></div> <p>or wherever you put your file, you will see the one line <code>Hello, World.</code> appear in your browser window. It's not very exciting, but once you get that working, you'll have a good chance of getting just about anything working.</p>   <h2 id=\"troubleshoot\">But it's still not working!</h2> <p>There are four basic things that you may see in your browser when you try to access your CGI program from the web:</p> <dl> <dt>The output of your CGI program</dt> <dd>Great! That means everything worked fine. If the output is correct, but the browser is not processing it correctly, make sure you have the correct <code>Content-Type</code> set in your CGI program.</dd> <dt>The source code of your CGI program or a \"POST Method Not Allowed\" message</dt> <dd>That means that you have not properly configured Apache to process your CGI program. Reread the section on <a href=\"#configuring\">configuring Apache</a> and try to find what you missed.</dd> <dt>A message starting with \"Forbidden\"</dt> <dd>That means that there is a permissions problem. Check the <a href=\"#errorlogs\">Apache error log</a> and the section below on <a href=\"#permissions\">file permissions</a>.</dd> <dt>A message saying \"Internal Server Error\"</dt> <dd>If you check the <a href=\"#errorlogs\">Apache error log</a>, you will probably find that it says \"Premature end of script headers\", possibly along with an error message generated by your CGI program. In this case, you will want to check each of the below sections to see what might be preventing your CGI program from emitting the proper HTTP headers.</dd> </dl> <h3><a name=\"permissions\" id=\"permissions\">File permissions</a></h3> <p>Remember that the server does not run as you. That is, when the server starts up, it is running with the permissions of an unprivileged user - usually <code>nobody</code>, or <code>www</code> - and so it will need extra permissions to execute files that are owned by you. Usually, the way to give a file sufficient permissions to be executed by <code>nobody</code> is to give everyone execute permission on the file:</p> <div class=\"example\"><pre>chmod a+x first.pl</pre></div> <p>Also, if your program reads from, or writes to, any other files, those files will need to have the correct permissions to permit this.</p> <h3><a name=\"pathinformation\" id=\"pathinformation\">Path information and environment</a></h3> <p>When you run a program from your command line, you have certain information that is passed to the shell without you thinking about it. For example, you have a <code>PATH</code>, which tells the shell where it can look for files that you reference.</p> <p>When a program runs through the web server as a CGI program, it may not have the same <code>PATH</code>. Any programs that you invoke in your CGI program (like <code>sendmail</code>, for example) will need to be specified by a full path, so that the shell can find them when it attempts to execute your CGI program.</p> <p>A common manifestation of this is the path to the script interpreter (often <code>perl</code>) indicated in the first line of your CGI program, which will look something like:</p> <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl</pre> <p>Make sure that this is in fact the path to the interpreter.</p> <div class=\"warning\"> When editing CGI scripts on Windows, end-of-line characters may be appended to the interpreter path. Ensure that files are then transferred to the server in ASCII mode. Failure to do so may result in \"Command not found\" warnings from the OS, due to the unrecognized end-of-line character being interpreted as a part of the interpreter filename. </div> <h3><a name=\"missingenv\" id=\"missingenv\">Missing environment variables</a></h3> <p>If your CGI program depends on non-standard <a href=\"#env\">environment variables</a>, you will need to assure that those variables are passed by Apache.</p> <p>When you miss HTTP headers from the environment, make sure they are formatted according to <a href=\"http://tools.ietf.org/html/rfc2616\">RFC 2616</a>, section 4.2: Header names must start with a letter, followed only by letters, numbers or hyphen. Any header violating this rule will be dropped silently.</p> <h3><a name=\"syntaxerrors\" id=\"syntaxerrors\">Program errors</a></h3> <p>Most of the time when a CGI program fails, it's because of a problem with the program itself. This is particularly true once you get the hang of this CGI stuff, and no longer make the above two mistakes. The first thing to do is to make sure that your program runs from the command line before testing it via the web server. For example, try:</p> <div class=\"example\"><pre>cd /usr/local/apache2/cgi-bin\n./first.pl</pre></div> <p>(Do not call the <code>perl</code> interpreter. The shell and Apache should find the interpreter using the <a href=\"#pathinformation\">path information</a> on the first line of the script.)</p> <p>The first thing you see written by your program should be a set of HTTP headers, including the <code>Content-Type</code>, followed by a blank line. If you see anything else, Apache will return the <code>Premature end of script headers</code> error if you try to run it through the server. See <a href=\"#writing\">Writing a CGI program</a> above for more details.</p> <h3><a name=\"errorlogs\" id=\"errorlogs\">Error logs</a></h3> <p>The error logs are your friend. Anything that goes wrong generates message in the error log. You should always look there first. If the place where you are hosting your web site does not permit you access to the error log, you should probably host your site somewhere else. Learn to read the error logs, and you'll find that almost all of your problems are quickly identified, and quickly solved.</p> <h3><a name=\"suexec\" id=\"suexec\">Suexec</a></h3> <p>The <a href=\"../suexec\">suexec</a> support program allows CGI programs to be run under different user permissions, depending on which virtual host or user home directory they are located in. Suexec has very strict permission checking, and any failure in that checking will result in your CGI programs failing with <code>Premature end of script headers</code>.</p> <p>To check if you are using suexec, run <code>apachectl -V</code> and check for the location of <code>SUEXEC_BIN</code>. If Apache finds an <code class=\"program\"><a href=\"../programs/suexec\">suexec</a></code> binary there on startup, suexec will be activated.</p> <p>Unless you fully understand suexec, you should not be using it. To disable suexec, simply remove (or rename) the <code class=\"program\"><a href=\"../programs/suexec\">suexec</a></code> binary pointed to by <code>SUEXEC_BIN</code> and then restart the server. If, after reading about <a href=\"../suexec\">suexec</a>, you still wish to use it, then run <code>suexec -V</code> to find the location of the suexec log file, and use that log file to find what policy you are violating.</p>   <h2 id=\"behindscenes\">What's going on behind the scenes?</h2> <p>As you become more advanced in CGI programming, it will become useful to understand more about what's happening behind the scenes. Specifically, how the browser and server communicate with one another. Because although it's all very well to write a program that prints \"Hello, World.\", it's not particularly useful.</p> <h3><a name=\"env\" id=\"env\">Environment variables</a></h3> <p>Environment variables are values that float around you as you use your computer. They are useful things like your path (where the computer searches for the actual file implementing a command when you type it), your username, your terminal type, and so on. For a full list of your normal, every day environment variables, type <code>env</code> at a command prompt.</p> <p>During the CGI transaction, the server and the browser also set environment variables, so that they can communicate with one another. These are things like the browser type (Netscape, IE, Lynx), the server type (Apache, IIS, WebSite), the name of the CGI program that is being run, and so on.</p> <p>These variables are available to the CGI programmer, and are half of the story of the client-server communication. The complete list of required variables is at <a href=\"http://www.ietf.org/rfc/rfc3875\">Common Gateway Interface RFC</a>.</p> <p>This simple Perl CGI program will display all of the environment variables that are being passed around. Two similar programs are included in the <code>cgi-bin</code> directory of the Apache distribution. Note that some variables are required, while others are optional, so you may see some variables listed that were not in the official list. In addition, Apache provides many different ways for you to <a href=\"../env\">add your own environment variables</a> to the basic ones provided by default.</p> <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl\nuse strict;\nuse warnings;\n\nprint \"Content-type: text/html\\n\\n\";\nforeach my $key (keys %ENV) {\n    print \"$key --&gt; $ENV{$key}&lt;br&gt;\";\n}</pre> <h3><a name=\"stdin\" id=\"stdin\">STDIN and STDOUT</a></h3> <p>Other communication between the server and the client happens over standard input (<code>STDIN</code>) and standard output (<code>STDOUT</code>). In normal everyday context, <code>STDIN</code> means the keyboard, or a file that a program is given to act on, and <code>STDOUT</code> usually means the console or screen.</p> <p>When you <code>POST</code> a web form to a CGI program, the data in that form is bundled up into a special format and gets delivered to your CGI program over <code>STDIN</code>. The program then can process that data as though it was coming in from the keyboard, or from a file</p> <p>The \"special format\" is very simple. A field name and its value are joined together with an equals (=) sign, and pairs of values are joined together with an ampersand (&amp;). Inconvenient characters like spaces, ampersands, and equals signs, are converted into their hex equivalent so that they don't gum up the works. The whole data string might look something like:</p> <div class=\"example\"><code>name=Rich%20Bowen&amp;city=Lexington&amp;state=KY&amp;sidekick=Squirrel%20Monkey</code></div> <p>You'll sometimes also see this type of string appended to a URL. When that is done, the server puts that string into the environment variable called <code>QUERY_STRING</code>. That's called a <code>GET</code> request. Your HTML form specifies whether a <code>GET</code> or a <code>POST</code> is used to deliver the data, by setting the <code>METHOD</code> attribute in the <code>FORM</code> tag.</p> <p>Your program is then responsible for splitting that string up into useful information. Fortunately, there are libraries and modules available to help you process this data, as well as handle other of the aspects of your CGI program.</p>   <h2 id=\"libraries\">CGI modules/libraries</h2> <p>When you write CGI programs, you should consider using a code library, or module, to do most of the grunt work for you. This leads to fewer errors, and faster development.</p> <p>If you're writing CGI programs in Perl, modules are available on <a href=\"http://www.cpan.org/\">CPAN</a>. The most popular module for this purpose is <code>CGI.pm</code>. You might also consider <code>CGI::Lite</code>, which implements a minimal set of functionality, which is all you need in most programs.</p> <p>If you're writing CGI programs in C, there are a variety of options. One of these is the <code>CGIC</code> library, from <a href=\"http://www.boutell.com/cgic/\">http://www.boutell.com/cgic/</a>.</p>   <h2 id=\"moreinfo\">For more information</h2> <p>The current CGI specification is available in the <a href=\"http://www.ietf.org/rfc/rfc3875\">Common Gateway Interface RFC</a>.</p> <p>When you post a question about a CGI problem that you're having, whether to a mailing list, or to a newsgroup, make sure you provide enough information about what happened, what you expected to happen, and how what actually happened was different, what server you're running, what language your CGI program was in, and, if possible, the offending code. This will make finding your problem much simpler.</p> <p>Note that questions about CGI problems should <strong>never</strong> be posted to the Apache bug database unless you are sure you have found a problem in the Apache source code.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/howto/cgi.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/howto/cgi.html</a>\n  </p>\n</div>\n","howto/htaccess":"<h1>Apache HTTP Server Tutorial: .htaccess files</h1>  <p><code>.htaccess</code> files provide a way to make configuration changes on a per-directory basis.</p>     <h2 id=\"related\">.htaccess files</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"../mod/core\">core</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_authn_file\">mod_authn_file</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_authz_groupfile\">mod_authz_groupfile</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_cgi\">mod_cgi</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_include\">mod_include</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_mime\">mod_mime</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"../mod/core#accessfilename\">AccessFileName</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_mime#addhandler\">AddHandler</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#sethandler\">SetHandler</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_authn_core#authtype\">AuthType</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_authn_core#authname\">AuthName</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_authn_file#authuserfile\">AuthUserFile</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_authz_groupfile#authgroupfile\">AuthGroupFile</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code></li>\n</ul></td>\n</tr>\n</table> <div class=\"note\">You should avoid using <code>.htaccess</code> files completely if you have access to httpd main server config file. Using <code>.htaccess</code> files slows down your Apache http server. Any directive that you can include in a <code>.htaccess</code> file is better set in a <code class=\"directive\"><a href=\"../mod/core#directory\">Directory</a></code> block, as it will have the same effect with better performance.</div>   <h2 id=\"what\">What they are/How to use them</h2> <p><code>.htaccess</code> files (or \"distributed configuration files\") provide a way to make configuration changes on a per-directory basis. A file, containing one or more configuration directives, is placed in a particular document directory, and the directives apply to that directory, and all subdirectories thereof.</p> <div class=\"note\">\n<p><strong>Note:</strong></p> <p>If you want to call your <code>.htaccess</code> file something else, you can change the name of the file using the <code class=\"directive\"><a href=\"../mod/core#accessfilename\">AccessFileName</a></code> directive. For example, if you would rather call the file <code>.config</code> then you can put the following in your server configuration file:</p> <pre class=\"prettyprint lang-config\">AccessFileName \".config\"</pre> </div> <p>In general, <code>.htaccess</code> files use the same syntax as the <a href=\"../configuring#syntax\">main configuration files</a>. What you can put in these files is determined by the <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> directive. This directive specifies, in categories, what directives will be honored if they are found in a <code>.htaccess</code> file. If a directive is permitted in a <code>.htaccess</code> file, the documentation for that directive will contain an Override section, specifying what value must be in <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> in order for that directive to be permitted.</p> <p>For example, if you look at the documentation for the <code class=\"directive\"><a href=\"../mod/core#adddefaultcharset\">AddDefaultCharset</a></code> directive, you will find that it is permitted in <code>.htaccess</code> files. (See the Context line in the directive summary.) The Override line reads <code>FileInfo</code>. Thus, you must have at least <code>AllowOverride FileInfo</code> in order for this directive to be honored in <code>.htaccess</code> files.</p> <div class=\"example\">\n<h3>Example:</h3>\n<table> <tr> <td>Context:</td> <td>server config, virtual host, directory, .htaccess</td> </tr> <tr> <td>Override:</td> <td>FileInfo</td> </tr> </table>\n</div> <p>If you are unsure whether a particular directive is permitted in a <code>.htaccess</code> file, look at the documentation for that directive, and check the Context line for \".htaccess\".</p>   <h2 id=\"when\">When (not) to use .htaccess files</h2> <p>In general, you should only use <code>.htaccess</code> files when you don't have access to the main server configuration file. There is, for example, a common misconception that user authentication should always be done in <code>.htaccess</code> files, and, in more recent years, another misconception that <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> directives must go in <code>.htaccess</code> files. This is simply not the case. You can put user authentication configurations in the main server configuration, and this is, in fact, the preferred way to do things. Likewise, <code>mod_rewrite</code> directives work better, in many respects, in the main server configuration.</p> <p><code>.htaccess</code> files should be used in a case where the content providers need to make configuration changes to the server on a per-directory basis, but do not have root access on the server system. In the event that the server administrator is not willing to make frequent configuration changes, it might be desirable to permit individual users to make these changes in <code>.htaccess</code> files for themselves. This is particularly true, for example, in cases where ISPs are hosting multiple user sites on a single machine, and want their users to be able to alter their configuration.</p> <p>However, in general, use of <code>.htaccess</code> files should be avoided when possible. Any configuration that you would consider putting in a <code>.htaccess</code> file, can just as effectively be made in a <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> section in your main server configuration file.</p> <p>There are two main reasons to avoid the use of <code>.htaccess</code> files.</p> <p>The first of these is performance. When <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> is set to allow the use of <code>.htaccess</code> files, httpd will look in every directory for <code>.htaccess</code> files. Thus, permitting <code>.htaccess</code> files causes a performance hit, whether or not you actually even use them! Also, the <code>.htaccess</code> file is loaded every time a document is requested.</p> <p>Further note that httpd must look for <code>.htaccess</code> files in all higher-level directories, in order to have a full complement of directives that it must apply. (See section on <a href=\"#how\">how directives are applied</a>.) Thus, if a file is requested out of a directory <code>/www/htdocs/example</code>, httpd must look for the following files:</p> <div class=\"example\"><pre>/.htaccess\n/www/.htaccess\n/www/htdocs/.htaccess\n/www/htdocs/example/.htaccess</pre></div> <p>And so, for each file access out of that directory, there are 4 additional file-system accesses, even if none of those files are present. (Note that this would only be the case if <code>.htaccess</code> files were enabled for <code>/</code>, which is not usually the case.)</p> <p>In the case of <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> directives, in <code>.htaccess</code> context these regular expressions must be re-compiled with every request to the directory, whereas in main server configuration context they are compiled once and cached. Additionally, the rules themselves are more complicated, as one must work around the restrictions that come with per-directory context and <code>mod_rewrite</code>. Consult the <a href=\"../rewrite/intro#htaccess\">Rewrite Guide</a> for more detail on this subject.</p> <p>The second consideration is one of security. You are permitting users to modify server configuration, which may result in changes over which you have no control. Carefully consider whether you want to give your users this privilege. Note also that giving users less privileges than they need will lead to additional technical support requests. Make sure you clearly tell your users what level of privileges you have given them. Specifying exactly what you have set <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> to, and pointing them to the relevant documentation, will save yourself a lot of confusion later.</p> <p>Note that it is completely equivalent to put a <code>.htaccess</code> file in a directory <code>/www/htdocs/example</code> containing a directive, and to put that same directive in a Directory section <code>&lt;Directory \"/www/htdocs/example\"&gt;</code> in your main server configuration:</p> <p><code>.htaccess</code> file in <code>/www/htdocs/example</code>:</p> <div class=\"example\">\n<h3>Contents of .htaccess file in <code>/www/htdocs/example</code>\n</h3>\n<pre class=\"prettyprint lang-config\">AddType text/example \".exm\"</pre> </div> <div class=\"example\">\n<h3>Section from your <code>httpd.conf</code> file</h3>\n<pre class=\"prettyprint lang-config\">&lt;Directory \"/www/htdocs/example\"&gt;\n    AddType text/example \".exm\"\n&lt;/Directory&gt;</pre> </div> <p>However, putting this configuration in your server configuration file will result in less of a performance hit, as the configuration is loaded once when httpd starts, rather than every time a file is requested.</p> <p>The use of <code>.htaccess</code> files can be disabled completely by setting the <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> directive to <code>none</code>:</p> <pre class=\"prettyprint lang-config\">AllowOverride None</pre>   <h2 id=\"how\">How directives are applied</h2> <p>The configuration directives found in a <code>.htaccess</code> file are applied to the directory in which the <code>.htaccess</code> file is found, and to all subdirectories thereof. However, it is important to also remember that there may have been <code>.htaccess</code> files in directories higher up. Directives are applied in the order that they are found. Therefore, a <code>.htaccess</code> file in a particular directory may override directives found in <code>.htaccess</code> files found higher up in the directory tree. And those, in turn, may have overridden directives found yet higher up, or in the main server configuration file itself.</p> <p>Example:</p> <p>In the directory <code>/www/htdocs/example1</code> we have a <code>.htaccess</code> file containing the following:</p> <pre class=\"prettyprint lang-config\">Options +ExecCGI</pre> <p>(Note: you must have \"<code>AllowOverride Options</code>\" in effect to permit the use of the \"<code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code>\" directive in <code>.htaccess</code> files.)</p> <p>In the directory <code>/www/htdocs/example1/example2</code> we have a <code>.htaccess</code> file containing:</p> <pre class=\"prettyprint lang-config\">Options Includes</pre> <p>Because of this second <code>.htaccess</code> file, in the directory <code>/www/htdocs/example1/example2</code>, CGI execution is not permitted, as only <code>Options Includes</code> is in effect, which completely overrides any earlier setting that may have been in place.</p> <h3><a name=\"merge\" id=\"merge\">Merging of .htaccess with the main configuration files</a></h3> <p>As discussed in the documentation on <a href=\"../sections\">Configuration Sections</a>, <code>.htaccess</code> files can override the <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> sections for the corresponding directory, but will be overridden by other types of configuration sections from the main configuration files. This fact can be used to enforce certain configurations, even in the presence of a liberal <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> setting. For example, to prevent script execution while allowing anything else to be set in <code>.htaccess</code> you can use:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/htdocs\"&gt;\n    AllowOverride All\n&lt;/Directory&gt;\n\n&lt;Location \"/\"&gt;\n    Options +IncludesNoExec -ExecCGI\n&lt;/Location&gt;</pre> <div class=\"note\">This example assumes that your <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> is <code>/www/htdocs</code>.</div>   <h2 id=\"auth\">Authentication example</h2> <p>If you jumped directly to this part of the document to find out how to do authentication, it is important to note one thing. There is a common misconception that you are required to use <code>.htaccess</code> files in order to implement password authentication. This is not the case. Putting authentication directives in a <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> section, in your main server configuration file, is the preferred way to implement this, and <code>.htaccess</code> files should be used only if you don't have access to the main server configuration file. See <a href=\"#when\">above</a> for a discussion of when you should and should not use <code>.htaccess</code> files.</p> <p>Having said that, if you still think you need to use a <code>.htaccess</code> file, you may find that a configuration such as what follows may work for you.</p> <p><code>.htaccess</code> file contents:</p> <pre class=\"prettyprint lang-config\">AuthType Basic\nAuthName \"Password Required\"\nAuthUserFile \"/www/passwords/password.file\"\nAuthGroupFile \"/www/passwords/group.file\"\nRequire group admins</pre> <p>Note that <code>AllowOverride AuthConfig</code> must be in effect for these directives to have any effect.</p> <p>Please see the <a href=\"auth\">authentication tutorial</a> for a more complete discussion of authentication and authorization.</p>   <h2 id=\"ssi\">Server Side Includes example</h2> <p>Another common use of <code>.htaccess</code> files is to enable Server Side Includes for a particular directory. This may be done with the following configuration directives, placed in a <code>.htaccess</code> file in the desired directory:</p> <pre class=\"prettyprint lang-config\">Options +Includes\nAddType text/html shtml\nAddHandler server-parsed shtml</pre> <p>Note that <code>AllowOverride Options</code> and <code>AllowOverride FileInfo</code> must both be in effect for these directives to have any effect.</p> <p>Please see the <a href=\"ssi\">SSI tutorial</a> for a more complete discussion of server-side includes.</p>   <h2 id=\"rewrite\">Rewrite Rules in .htaccess files</h2> <p>When using <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> in <code>.htaccess</code> files, be aware that the per-directory context changes things a bit. In particular, rules are taken to be relative to the current directory, rather than being the original requested URI. Consider the following examples:</p> <pre class=\"prettyprint lang-config\"># In httpd.conf\nRewriteRule \"^/images/(.+)\\.jpg\" \"/images/$1.png\"\n\n# In .htaccess in root dir\nRewriteRule \"^images/(.+)\\.jpg\" \"images/$1.png\"\n\n# In .htaccess in images/\nRewriteRule \"^(.+)\\.jpg\" \"$1.png\"</pre> <p>In a <code>.htaccess</code> in your document directory, the leading slash is removed from the value supplied to <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code>, and in the <code>images</code> subdirectory, <code>/images/</code> is removed from it. Thus, your regular expression needs to omit that portion as well.</p> <p>Consult the <a href=\"../rewrite/index\">mod_rewrite documentation</a> for further details on using <code>mod_rewrite</code>.</p>   <h2 id=\"cgi\">CGI example</h2> <p>Finally, you may wish to use a <code>.htaccess</code> file to permit the execution of CGI programs in a particular directory. This may be implemented with the following configuration:</p> <pre class=\"prettyprint lang-config\">Options +ExecCGI\nAddHandler cgi-script cgi pl</pre> <p>Alternately, if you wish to have all files in the given directory be considered to be CGI programs, this may be done with the following configuration:</p> <pre class=\"prettyprint lang-config\">Options +ExecCGI\nSetHandler cgi-script</pre> <p>Note that <code>AllowOverride Options</code> and <code>AllowOverride FileInfo</code> must both be in effect for these directives to have any effect.</p> <p>Please see the <a href=\"cgi\">CGI tutorial</a> for a more complete discussion of CGI programming and configuration.</p>   <h2 id=\"troubleshoot\">Troubleshooting</h2> <p>When you put configuration directives in a <code>.htaccess</code> file, and you don't get the desired effect, there are a number of things that may be going wrong.</p> <p>Most commonly, the problem is that <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> is not set such that your configuration directives are being honored. Make sure that you don't have a <code>AllowOverride None</code> in effect for the file scope in question. A good test for this is to put garbage in your <code>.htaccess</code> file and reload the page. If a server error is not generated, then you almost certainly have <code>AllowOverride None</code> in effect.</p> <p>If, on the other hand, you are getting server errors when trying to access documents, check your httpd error log. It will likely tell you that the directive used in your <code>.htaccess</code> file is not permitted.</p> <div class=\"example\"><pre>[Fri Sep 17 18:43:16 2010] [alert] [client 192.168.200.51] /var/www/html/.htaccess: DirectoryIndex not allowed here</pre></div> <p>This will indicate either that you've used a directive that is never permitted in <code>.htaccess</code> files, or that you simply don't have <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> set to a level sufficient for the directive you've used. Consult the documentation for that particular directive to determine which is the case.</p> <p>Alternately, it may tell you that you had a syntax error in your usage of the directive itself.</p> <div class=\"example\"><pre>[Sat Aug 09 16:22:34 2008] [alert] [client 192.168.200.51] /var/www/html/.htaccess: RewriteCond: bad flag delimiters</pre></div> <p>In this case, the error message should be specific to the particular syntax error that you have committed.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/howto/htaccess.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/howto/htaccess.html</a>\n  </p>\n</div>\n","howto/public_html":"<h1>Per-user web directories</h1>  <p>On systems with multiple users, each user can be permitted to have a web site in their home directory using the <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> directive. Visitors to a URL <code>http://example.com/~username/</code> will get content out of the home directory of the user \"<code>username</code>\", out of the subdirectory specified by the <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> directive.</p> <p>Note that, by default, access to these directories is <strong>not</strong> enabled. You can enable access when using <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> by uncommenting the line:</p> <pre class=\"prettyprint lang-config\">#Include conf/extra/httpd-userdir.conf</pre> <p>in the default config file <code>conf/httpd.conf</code>, and adapting the <code>httpd-userdir.conf</code> file as necessary, or by including the appropriate directives in a <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> block within the main config file.</p>     <h2 id=\"related\">Per-user web directories</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"../mod/mod_userdir\">mod_userdir</a></code></li></ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#directorymatch\">DirectoryMatch</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code></li>\n</ul></td>\n</tr>\n</table>   <h2 id=\"userdir\">Setting the file path with UserDir</h2> <p>The <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> directive specifies a directory out of which per-user content is loaded. This directive may take several different forms.</p> <p>If a path is given which does not start with a leading slash, it is assumed to be a directory path relative to the home directory of the specified user. Given this configuration:</p> <pre class=\"prettyprint lang-config\">UserDir public_html</pre> <p>the URL <code>http://example.com/~rbowen/file.html</code> will be translated to the file path <code>/home/rbowen/public_html/file.html</code></p> <p>If a path is given starting with a slash, a directory path will be constructed using that path, plus the username specified. Given this configuration:</p> <pre class=\"prettyprint lang-config\">UserDir /var/html</pre> <p>the URL <code>http://example.com/~rbowen/file.html</code> will be translated to the file path <code>/var/html/rbowen/file.html</code></p> <p>If a path is provided which contains an asterisk (*), a path is used in which the asterisk is replaced with the username. Given this configuration:</p> <pre class=\"prettyprint lang-config\">UserDir /var/www/*/docs</pre> <p>the URL <code>http://example.com/~rbowen/file.html</code> will be translated to the file path <code>/var/www/rbowen/docs/file.html</code></p> <p>Multiple directories or directory paths can also be set.</p> <pre class=\"prettyprint lang-config\">UserDir public_html /var/html</pre> <p>For the URL <code>http://example.com/~rbowen/file.html</code>, Apache will search for <code>~rbowen</code>. If it isn't found, Apache will search for <code>rbowen</code> in <code>/var/html</code>. If found, the above URL will then be translated to the file path <code>/var/html/rbowen/file.html</code></p>   <h2 id=\"redirect\">Redirecting to external URLs</h2> <p>The <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> directive can be used to redirect user directory requests to external URLs.</p> <pre class=\"prettyprint lang-config\">UserDir http://example.org/users/*/</pre> <p>The above example will redirect a request for <code>http://example.com/~bob/abc.html</code> to <code>http://example.org/users/bob/abc.html</code>.</p>   <h2 id=\"enable\">Restricting what users are permitted to use this feature</h2> <p>Using the syntax shown in the UserDir documentation, you can restrict what users are permitted to use this functionality:</p> <pre class=\"prettyprint lang-config\">UserDir disabled root jro fish</pre> <p>The configuration above will enable the feature for all users except for those listed in the <code>disabled</code> statement. You can, likewise, disable the feature for all but a few users by using a configuration like the following:</p> <pre class=\"prettyprint lang-config\">UserDir disabled\nUserDir enabled rbowen krietz</pre> <p>See <code class=\"directive\"><a href=\"../mod/mod_userdir#userdir\">UserDir</a></code> documentation for additional examples.</p>   <h2 id=\"cgi\">Enabling a cgi directory for each user</h2> <p>In order to give each user their own cgi-bin directory, you can use a <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> directive to make a particular subdirectory of a user's home directory cgi-enabled.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/home/*/public_html/cgi-bin/\"&gt;\n    Options ExecCGI\n    SetHandler cgi-script\n&lt;/Directory&gt;</pre> <p>Then, presuming that <code>UserDir</code> is set to <code>public_html</code>, a cgi program <code>example.cgi</code> could be loaded from that directory as:</p> <div class=\"example\"><code>http://example.com/~rbowen/cgi-bin/example.cgi</code></div>   <h2 id=\"htaccess\">Allowing users to alter configuration</h2> <p>If you want to allows users to modify the server configuration in their web space, they will need to use <code>.htaccess</code> files to make these changes. Ensure that you have set <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> to a value sufficient for the directives that you want to permit the users to modify. See the <a href=\"htaccess\">.htaccess tutorial</a> for additional details on how this works.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/howto/public_html.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/howto/public_html.html</a>\n  </p>\n</div>\n","platform/rpm":"<h1>Using Apache With RPM Based Systems (Redhat / CentOS / Fedora)</h1>  <p>While many distributions make Apache httpd available as operating system supported packages, it can sometimes be desirable to install and use the canonical version of Apache httpd on these systems, replacing the natively provided versions of the packages.</p> <p>While the Apache httpd project does not currently create binary RPMs for the various distributions out there, it is easy to build your own binary RPMs from the canonical Apache httpd tarball.</p> <p>This document explains how to build, install, configure and run Apache httpd 2.4 under Unix systems supporting the RPM packaging format.</p>     <h2 id=\"creating\">Creating a Source RPM</h2> <p>The Apache httpd source tarball can be converted into an SRPM as follows:</p> <div class=\"example\"><pre>rpmbuild -ts httpd-2.4.x.tar.bz2</pre></div>   <h2 id=\"building\">Building RPMs</h2> <p>RPMs can be built directly from the Apache httpd source tarballs using the following command:</p> <div class=\"example\"><pre>rpmbuild -tb httpd-2.4.x.tar.bz2</pre></div> <p>Corresponding \"-devel\" packages will be required to be installed on your build system prior to building the RPMs, the <code>rpmbuild</code> command will automatically calculate what RPMs are required and will list any dependencies that are missing on your system. These \"-devel\" packages will not be required after the build is completed, and can be safely removed.</p> <p>If successful, the following RPMs will be created:</p> <dl> <dt>httpd-2.4.x-1.i686.rpm</dt> <dd>The core server and basic module set.</dd> <dt>httpd-debuginfo-2.4.x-1.i686.rpm</dt> <dd>Debugging symbols for the server and all modules.</dd> <dt>httpd-devel-2.4.x-1.i686.rpm</dt> <dd>Headers and development files for the server.</dd> <dt>httpd-manual-2.4.x-1.i686.rpm</dt> <dd>The webserver manual.</dd> <dt>httpd-tools-2.4.x-1.i686.rpm</dt> <dd>Supporting tools for the webserver.</dd> <dt>mod_authnz_ldap-2.4.x-1.i686.rpm</dt> <dd>\n<code class=\"module\"><a href=\"../mod/mod_ldap\">mod_ldap</a></code> and <code class=\"module\"><a href=\"../mod/mod_authnz_ldap\">mod_authnz_ldap</a></code>, with corresponding dependency on openldap.</dd> <dt>mod_lua-2.4.x-1.i686.rpm</dt> <dd>\n<code class=\"module\"><a href=\"../mod/mod_lua\">mod_lua</a></code> module, with corresponding dependency on lua.</dd> <dt>mod_proxy_html-2.4.x-1.i686.rpm</dt> <dd>\n<code class=\"module\"><a href=\"../mod/mod_proxy_html\">mod_proxy_html</a></code> module, with corresponding dependency on libxml2.</dd> <dt>mod_socache_dc-2.4.x-1.i686.rpm</dt> <dd>\n<code class=\"module\"><a href=\"../mod/mod_socache_dc\">mod_socache_dc</a></code> module, with corresponding dependency on distcache.</dd> <dt>mod_ssl-2.4.x-1.i686.rpm</dt> <dd>\n<code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> module, with corresponding dependency on openssl.</dd> </dl>   <h2 id=\"installing\">Installing the Server</h2> <p>The <code>httpd</code> RPM is the only RPM necessary to get a basic server to run. Install it as follows:</p> <div class=\"example\"><pre>rpm -U httpd-2.4.x-1.i686.rpm</pre></div> <p>Self contained modules are included with the server. Modules that depend on external libraries are provided as separate RPMs to install if needed.</p>   <h2 id=\"default\">Configuring the Default Instance of Apache httpd</h2> <p>The default configuration for the server is installed by default beneath the <code>/etc/httpd</code> directory, with logs written by default to <code>/var/log/httpd</code>. The environment for the webserver is set by default within the optional <code>/etc/sysconfig/httpd</code> file.</p> <p>Start the server as follows:</p> <div class=\"example\"><pre>service httpd restart</pre></div>   <h2 id=\"additional\">Configuring Additional Instances of Apache httpd on the Same Machine</h2> <p>It is possible to configure additional instances of the Apache httpd server running independently alongside each other on the same machine. These instances can have independent configurations, and can potentially run as separate users if so configured.</p> <p>This was done by making the httpd startup script aware of its own name. This name is then used to find the environment file for the server, and in turn, the server root of the server instance.</p> <p>To create an additional instance called <code>httpd-additional</code>, follow these steps:</p> <ul> <li>Create a symbolic link to the startup script for the additional server: <div class=\"example\"><pre>ln -s /etc/rc.d/init.d/httpd /etc/rc.d/init.d/httpd-additional\nchkconfig --add httpd-additional</pre></div> </li> <li>Create an environment file for the server, using the <code>/etc/sysconfig/httpd</code> file as a template: <div class=\"example\"><pre># template from httpd\ncp /etc/sysconfig/httpd /etc/sysconfig/httpd-additional</pre></div> <div class=\"example\"><pre># blank template\ntouch /etc/sysconfig/httpd-additional</pre></div> Edit <code>/etc/sysconfig/httpd-additional</code> and pass the server root of the new server instance within the <code>OPTIONS</code> environment variable. <div class=\"example\"><pre>OPTIONS=\"-d /etc/httpd-additional -f conf/httpd-additional.conf\"</pre></div> </li> <li>Edit the server configuration file <code>/etc/httpd-additional/conf/httpd-additional.conf</code> to ensure the correct ports and paths are configured. </li> <li>Start the server as follows: <div class=\"example\"><pre>service httpd-additional restart</pre></div> </li> <li>Repeat this process as required for each server instance.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/platform/rpm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/platform/rpm.html</a>\n  </p>\n</div>\n","howto/auth":"<h1>Authentication and Authorization</h1>  <p>Authentication is any process by which you verify that someone is who they claim they are. Authorization is any process by which someone is allowed to be where they want to go, or to have information that they want to have.</p> <p>For general access control, see the <a href=\"access\">Access Control How-To</a>.</p>     <h2 id=\"related\">Related Modules and Directives</h2> <p>There are three types of modules involved in the authentication and authorization process. You will usually need to choose at least one module from each group.</p> <ul> <li>Authentication type (see the <code class=\"directive\"><a href=\"../mod/mod_authn_core#authtype\">AuthType</a></code> directive) <ul> <li><code class=\"module\"><a href=\"../mod/mod_auth_basic\">mod_auth_basic</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_auth_digest\">mod_auth_digest</a></code></li> </ul> </li> <li>Authentication provider (see the <code class=\"directive\"><a href=\"../mod/mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> and <code class=\"directive\"><a href=\"../mod/mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> directives) <ul> <li><code class=\"module\"><a href=\"../mod/mod_authn_anon\">mod_authn_anon</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authn_dbd\">mod_authn_dbd</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authn_file\">mod_authn_file</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authnz_ldap\">mod_authnz_ldap</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authn_socache\">mod_authn_socache</a></code></li> </ul> </li> <li>Authorization (see the <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> directive) <ul> <li><code class=\"module\"><a href=\"../mod/mod_authnz_ldap\">mod_authnz_ldap</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authz_dbd\">mod_authz_dbd</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authz_dbm\">mod_authz_dbm</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authz_groupfile\">mod_authz_groupfile</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authz_host\">mod_authz_host</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authz_owner\">mod_authz_owner</a></code></li> <li><code class=\"module\"><a href=\"../mod/mod_authz_user\">mod_authz_user</a></code></li> </ul> </li> </ul> <p>In addition to these modules, there are also <code class=\"module\"><a href=\"../mod/mod_authn_core\">mod_authn_core</a></code> and <code class=\"module\"><a href=\"../mod/mod_authz_core\">mod_authz_core</a></code>. These modules implement core directives that are core to all auth modules.</p> <p>The module <code class=\"module\"><a href=\"../mod/mod_authnz_ldap\">mod_authnz_ldap</a></code> is both an authentication and authorization provider. The module <code class=\"module\"><a href=\"../mod/mod_authz_host\">mod_authz_host</a></code> provides authorization and access control based on hostname, IP address or characteristics of the request, but is not part of the authentication provider system. For backwards compatibility with the mod_access, there is a new module <code class=\"module\"><a href=\"../mod/mod_access_compat\">mod_access_compat</a></code>.</p> <p>You probably also want to take a look at the <a href=\"access\">Access Control</a> howto, which discusses the various ways to control access to your server.</p>   <h2 id=\"introduction\">Introduction</h2> <p>If you have information on your web site that is sensitive or intended for only a small group of people, the techniques in this article will help you make sure that the people that see those pages are the people that you wanted to see them.</p> <p>This article covers the \"standard\" way of protecting parts of your web site that most of you are going to use.</p> <div class=\"note\">\n<p><strong>Note:</strong></p> <p>If your data really needs to be secure, consider using <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> in addition to any authentication.</p> </div>   <h2 id=\"theprerequisites\">The Prerequisites</h2> <p>The directives discussed in this article will need to go either in your main server configuration file (typically in a <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> section), or in per-directory configuration files (<code>.htaccess</code> files).</p> <p>If you plan to use <code>.htaccess</code> files, you will need to have a server configuration that permits putting authentication directives in these files. This is done with the <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> directive, which specifies which directives, if any, may be put in per-directory configuration files.</p> <p>Since we're talking here about authentication, you will need an <code class=\"directive\"><a href=\"../mod/core#allowoverride\">AllowOverride</a></code> directive like the following:</p> <pre class=\"prettyprint lang-config\">AllowOverride AuthConfig</pre> <p>Or, if you are just going to put the directives directly in your main server configuration file, you will of course need to have write permission to that file.</p> <p>And you'll need to know a little bit about the directory structure of your server, in order to know where some files are kept. This should not be terribly difficult, and I'll try to make this clear when we come to that point.</p> <p>You will also need to make sure that the modules <code class=\"module\"><a href=\"../mod/mod_authn_core\">mod_authn_core</a></code> and <code class=\"module\"><a href=\"../mod/mod_authz_core\">mod_authz_core</a></code> have either been built into the httpd binary or loaded by the httpd.conf configuration file. Both of these modules provide core directives and functionality that are critical to the configuration and use of authentication and authorization in the web server.</p>   <h2 id=\"gettingitworking\">Getting it working</h2> <p>Here's the basics of password protecting a directory on your server.</p> <p>First, you need to create a password file. Exactly how you do this will vary depending on what authentication provider you have chosen. More on that later. To start with, we'll use a text password file.</p> <p>This file should be placed somewhere not accessible from the web. This is so that folks cannot download the password file. For example, if your documents are served out of <code>/usr/local/apache/htdocs</code>, you might want to put the password file(s) in <code>/usr/local/apache/passwd</code>.</p> <p>To create the file, use the <code class=\"program\"><a href=\"../programs/htpasswd\">htpasswd</a></code> utility that came with Apache. This will be located in the <code>bin</code> directory of wherever you installed Apache. If you have installed Apache from a third-party package, it may be in your execution path.</p> <p>To create the file, type:</p> <div class=\"example\"><pre>htpasswd -c /usr/local/apache/passwd/passwords rbowen</pre></div> <p><code class=\"program\"><a href=\"../programs/htpasswd\">htpasswd</a></code> will ask you for the password, and then ask you to type it again to confirm it:</p> <div class=\"example\"><pre># htpasswd -c /usr/local/apache/passwd/passwords rbowen\nNew password: mypassword\nRe-type new password: mypassword\nAdding password for user rbowen</pre></div> <p>If <code class=\"program\"><a href=\"../programs/htpasswd\">htpasswd</a></code> is not in your path, of course you'll have to type the full path to the file to get it to run. With a default installation, it's located at <code>/usr/local/apache2/bin/htpasswd</code></p> <p>Next, you'll need to configure the server to request a password and tell the server which users are allowed access. You can do this either by editing the <code>httpd.conf</code> file or using an <code>.htaccess</code> file. For example, if you wish to protect the directory <code>/usr/local/apache/htdocs/secret</code>, you can use the following directives, either placed in the file <code>/usr/local/apache/htdocs/secret/.htaccess</code>, or placed in <code>httpd.conf</code> inside a &lt;Directory \"/usr/local/apache/htdocs/secret\"&gt; section.</p> <pre class=\"prettyprint lang-config\">AuthType Basic\nAuthName \"Restricted Files\"\n# (Following line optional)\nAuthBasicProvider file\nAuthUserFile \"/usr/local/apache/passwd/passwords\"\nRequire user rbowen</pre> <p>Let's examine each of those directives individually. The <code class=\"directive\"><a href=\"../mod/mod_authn_core#authtype\">AuthType</a></code> directive selects that method that is used to authenticate the user. The most common method is <code>Basic</code>, and this is the method implemented by <code class=\"module\"><a href=\"../mod/mod_auth_basic\">mod_auth_basic</a></code>. It is important to be aware, however, that Basic authentication sends the password from the client to the server unencrypted. This method should therefore not be used for highly sensitive data, unless accompanied by <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code>. Apache supports one other authentication method: <code>AuthType Digest</code>. This method is implemented by <code class=\"module\"><a href=\"../mod/mod_auth_digest\">mod_auth_digest</a></code> and was intended to be more secure. This is no longer the case and the connection should be encrypted with <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> instead.</p> <p>The <code class=\"directive\"><a href=\"../mod/mod_authn_core#authname\">AuthName</a></code> directive sets the <dfn>Realm</dfn> to be used in the authentication. The realm serves two major functions. First, the client often presents this information to the user as part of the password dialog box. Second, it is used by the client to determine what password to send for a given authenticated area.</p> <p>So, for example, once a client has authenticated in the <code>\"Restricted Files\"</code> area, it will automatically retry the same password for any area on the same server that is marked with the <code>\"Restricted Files\"</code> Realm. Therefore, you can prevent a user from being prompted more than once for a password by letting multiple restricted areas share the same realm. Of course, for security reasons, the client will always need to ask again for the password whenever the hostname of the server changes.</p> <p>The <code class=\"directive\"><a href=\"../mod/mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> is, in this case, optional, since <code>file</code> is the default value for this directive. You'll need to use this directive if you are choosing a different source for authentication, such as <code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code> or <code class=\"module\"><a href=\"../mod/mod_authn_dbd\">mod_authn_dbd</a></code>.</p> <p>The <code class=\"directive\"><a href=\"../mod/mod_authn_file#authuserfile\">AuthUserFile</a></code> directive sets the path to the password file that we just created with <code class=\"program\"><a href=\"../programs/htpasswd\">htpasswd</a></code>. If you have a large number of users, it can be quite slow to search through a plain text file to authenticate the user on each request. Apache also has the ability to store user information in fast database files. The <code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code> module provides the <code class=\"directive\"><a href=\"../mod/mod_authn_dbm#authdbmuserfile\">AuthDBMUserFile</a></code> directive. These files can be created and manipulated with the <code class=\"program\"><a href=\"../programs/dbmmanage\">dbmmanage</a></code> and <code class=\"program\"><a href=\"../programs/htdbm\">htdbm</a></code> programs. Many other types of authentication options are available from third party modules in the <a href=\"http://modules.apache.org/\">Apache Modules Database</a>.</p> <p>Finally, the <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> directive provides the authorization part of the process by setting the user that is allowed to access this region of the server. In the next section, we discuss various ways to use the <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> directive.</p>   <h2 id=\"lettingmorethanonepersonin\">Letting more than one person in</h2> <p>The directives above only let one person (specifically someone with a username of <code>rbowen</code>) into the directory. In most cases, you'll want to let more than one person in. This is where the <code class=\"directive\"><a href=\"../mod/mod_authz_groupfile#authgroupfile\">AuthGroupFile</a></code> comes in.</p> <p>If you want to let more than one person in, you'll need to create a group file that associates group names with a list of users in that group. The format of this file is pretty simple, and you can create it with your favorite editor. The contents of the file will look like this:</p> <div class=\"example\"><pre>GroupName: rbowen dpitts sungo rshersey</pre></div> <p>That's just a list of the members of the group in a long line separated by spaces.</p> <p>To add a user to your already existing password file, type:</p> <div class=\"example\"><pre>htpasswd /usr/local/apache/passwd/passwords dpitts</pre></div> <p>You'll get the same response as before, but it will be appended to the existing file, rather than creating a new file. (It's the <code>-c</code> that makes it create a new password file).</p> <p>Now, you need to modify your <code>.htaccess</code> file or <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> block to look like the following:</p> <pre class=\"prettyprint lang-config\">AuthType Basic\nAuthName \"By Invitation Only\"\n# Optional line:\nAuthBasicProvider file\nAuthUserFile \"/usr/local/apache/passwd/passwords\"\nAuthGroupFile \"/usr/local/apache/passwd/groups\"\nRequire group GroupName</pre> <p>Now, anyone that is listed in the group <code>GroupName</code>, and has an entry in the <code>password</code> file, will be let in, if they type the correct password.</p> <p>There's another way to let multiple users in that is less specific. Rather than creating a group file, you can just use the following directive:</p> <pre class=\"prettyprint lang-config\">Require valid-user</pre> <p>Using that rather than the <code>Require user rbowen</code> line will allow anyone in that is listed in the password file, and who correctly enters their password.</p>   <h2 id=\"possibleproblems\">Possible problems</h2> <p>Because of the way that Basic authentication is specified, your username and password must be verified every time you request a document from the server. This is even if you're reloading the same page, and for every image on the page (if they come from a protected directory). As you can imagine, this slows things down a little. The amount that it slows things down is proportional to the size of the password file, because it has to open up that file, and go down the list of users until it gets to your name. And it has to do this every time a page is loaded.</p> <p>A consequence of this is that there's a practical limit to how many users you can put in one password file. This limit will vary depending on the performance of your particular server machine, but you can expect to see slowdowns once you get above a few hundred entries, and may wish to consider a different authentication method at that time.</p>   <h2 id=\"dbmdbd\">Alternate password storage</h2> <p>Because storing passwords in plain text files has the above problems, you may wish to store your passwords somewhere else, such as in a database.</p> <p><code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code> and <code class=\"module\"><a href=\"../mod/mod_authn_dbd\">mod_authn_dbd</a></code> are two modules which make this possible. Rather than selecting <code><code class=\"directive\"><a href=\"../mod/mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> file</code>, instead you can choose <code>dbm</code> or <code>dbd</code> as your storage format.</p> <p>To select a dbm file rather than a text file, for example:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/docs/private\"&gt;\n    AuthName \"Private\"\n    AuthType Basic\n    AuthBasicProvider dbm\n    AuthDBMUserFile \"/www/passwords/passwd.dbm\"\n    Require valid-user\n&lt;/Directory&gt;</pre> <p>Other options are available. Consult the <code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code> documentation for more details.</p>   <h2 id=\"multprovider\">Using multiple providers</h2> <p>With the introduction of the new provider based authentication and authorization architecture, you are no longer locked into a single authentication or authorization method. In fact any number of the providers can be mixed and matched to provide you with exactly the scheme that meets your needs. In the following example, both the file and LDAP based authentication providers are being used.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/docs/private\"&gt;\n    AuthName \"Private\"\n    AuthType Basic\n    AuthBasicProvider file ldap\n    AuthUserFile \"/usr/local/apache/passwd/passwords\"\n    AuthLDAPURL ldap://ldaphost/o=yourorg\n    Require valid-user\n&lt;/Directory&gt;</pre> <p>In this example the file provider will attempt to authenticate the user first. If it is unable to authenticate the user, the LDAP provider will be called. This allows the scope of authentication to be broadened if your organization implements more than one type of authentication store. Other authentication and authorization scenarios may include mixing one type of authentication with a different type of authorization. For example, authenticating against a password file yet authorizing against an LDAP directory.</p> <p>Just as multiple authentication providers can be implemented, multiple authorization methods can also be used. In this example both file group authorization as well as LDAP group authorization is being used.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/docs/private\"&gt;\n    AuthName \"Private\"\n    AuthType Basic\n    AuthBasicProvider file\n    AuthUserFile \"/usr/local/apache/passwd/passwords\"\n    AuthLDAPURL ldap://ldaphost/o=yourorg\n    AuthGroupFile \"/usr/local/apache/passwd/groups\"\n    Require group GroupName\n    Require ldap-group cn=mygroup,o=yourorg\n&lt;/Directory&gt;</pre> <p>To take authorization a little further, authorization container directives such as <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireall\">&lt;RequireAll&gt;</a></code> and <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireany\">&lt;RequireAny&gt;</a></code> allow logic to be applied so that the order in which authorization is handled can be completely controlled through the configuration. See <a href=\"../mod/mod_authz_core#logic\">Authorization Containers</a> for an example of how they may be applied.</p>   <h2 id=\"beyond\">Beyond just authorization</h2> <p>The way that authorization can be applied is now much more flexible than just a single check against a single data store. Ordering, logic and choosing how authorization will be done is now possible.</p> <h3><a name=\"authandororder\" id=\"authandororder\">Applying logic and ordering</a></h3> <p>Controlling how and in what order authorization will be applied has been a bit of a mystery in the past. In Apache 2.2 a provider-based authentication mechanism was introduced to decouple the actual authentication process from authorization and supporting functionality. One of the side benefits was that authentication providers could be configured and called in a specific order which didn't depend on the load order of the auth module itself. This same provider based mechanism has been brought forward into authorization as well. What this means is that the <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> directive not only specifies which authorization methods should be used, it also specifies the order in which they are called. Multiple authorization methods are called in the same order in which the <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> directives appear in the configuration.</p> <p>With the introduction of authorization container directives such as <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireall\">&lt;RequireAll&gt;</a></code> and <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireany\">&lt;RequireAny&gt;</a></code>, the configuration also has control over when the authorization methods are called and what criteria determines when access is granted. See <a href=\"../mod/mod_authz_core#logic\">Authorization Containers</a> for an example of how they may be used to express complex authorization logic.</p> <p>By default all <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> directives are handled as though contained within a <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireany\">&lt;RequireAny&gt;</a></code> container directive. In other words, if any of the specified authorization methods succeed, then authorization is granted.</p> <h3><a name=\"reqaccessctrl\" id=\"reqaccessctrl\">Using authorization providers for access control</a></h3> <p>Authentication by username and password is only part of the story. Frequently you want to let people in based on something other than who they are. Something such as where they are coming from.</p> <p>The authorization providers <code>all</code>, <code>env</code>, <code>host</code> and <code>ip</code> let you allow or deny access based on other host based criteria such as host name or ip address of the machine requesting a document.</p> <p>The usage of these providers is specified through the <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> directive. This directive registers the authorization providers that will be called during the authorization stage of the request processing. For example:</p> <pre class=\"prettyprint lang-config\">Require ip <var>address</var></pre> <p>where <var>address</var> is an IP address (or a partial IP address) or:</p> <pre class=\"prettyprint lang-config\">Require host <var>domain_name</var></pre> <p>where <var>domain_name</var> is a fully qualified domain name (or a partial domain name); you may provide multiple addresses or domain names, if desired.</p> <p>For example, if you have someone spamming your message board, and you want to keep them out, you could do the following:</p> <pre class=\"prettyprint lang-config\">&lt;RequireAll&gt;\n    Require all granted\n    Require not ip 10.252.46.165\n&lt;/RequireAll&gt;</pre> <p>Visitors coming from that address will not be able to see the content covered by this directive. If, instead, you have a machine name, rather than an IP address, you can use that.</p> <pre class=\"prettyprint lang-config\">&lt;RequireAll&gt;\n    Require all granted\n    Require not host host.example.com\n&lt;/RequireAll&gt;</pre> <p>And, if you'd like to block access from an entire domain, you can specify just part of an address or domain name:</p> <pre class=\"prettyprint lang-config\">&lt;RequireAll&gt;\n    Require all granted\n    Require not ip 192.168.205\n    Require not host phishers.example.com moreidiots.example\n    Require not host ke\n&lt;/RequireAll&gt;</pre> <p>Using <code class=\"directive\"><a href=\"../mod/mod_authz_core#requireall\">&lt;RequireAll&gt;</a></code> with multiple <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">&lt;Require&gt;</a></code> directives, each negated with <code>not</code>, will only allow access, if all of negated conditions are true. In other words, access will be blocked, if any of the negated conditions fails.</p> <h3><a name=\"filesystem\" id=\"filesystem\">Access Control backwards compatibility</a></h3> <p>One of the side effects of adopting a provider based mechanism for authentication is that the previous access control directives <code class=\"directive\"><a href=\"../mod/mod_access_compat#order\">Order</a></code>, <code class=\"directive\"><a href=\"../mod/mod_access_compat#allow\">Allow</a></code>, <code class=\"directive\"><a href=\"../mod/mod_access_compat#deny\">Deny</a></code> and <code class=\"directive\"><a href=\"../mod/mod_access_compat#satisfy\">Satisfy</a></code> are no longer needed. However to provide backwards compatibility for older configurations, these directives have been moved to the <code class=\"module\"><a href=\"../mod/mod_access_compat\">mod_access_compat</a></code> module.</p> <div class=\"warning\">\n<p><strong>Note</strong></p> <p>The directives provided by <code class=\"module\"><a href=\"../mod/mod_access_compat\">mod_access_compat</a></code> have been deprecated by <code class=\"module\"><a href=\"../mod/mod_authz_host\">mod_authz_host</a></code>. Mixing old directives like <code class=\"directive\"><a href=\"../mod/mod_access_compat#order\">Order</a></code>, <code class=\"directive\"><a href=\"../mod/mod_access_compat#allow\">Allow</a></code> or <code class=\"directive\"><a href=\"../mod/mod_access_compat#deny\">Deny</a></code> with new ones like <code class=\"directive\"><a href=\"../mod/mod_authz_core#require\">Require</a></code> is technically possible but discouraged. The <code class=\"module\"><a href=\"../mod/mod_access_compat\">mod_access_compat</a></code> module was created to support configurations containing only old directives to facilitate the 2.4 upgrade. Please check the <a href=\"https://httpd.apache.org/docs/2.4/en/upgrading.html\">upgrading</a> guide for more information. </p> </div>   <h2 id=\"socache\">Authentication Caching</h2> <p>There may be times when authentication puts an unacceptable load on a provider or on your network. This is most likely to affect users of <code class=\"module\"><a href=\"../mod/mod_authn_dbd\">mod_authn_dbd</a></code> (or third-party/custom providers). To deal with this, HTTPD 2.3/2.4 introduces a new caching provider <code class=\"module\"><a href=\"../mod/mod_authn_socache\">mod_authn_socache</a></code> to cache credentials and reduce the load on the origin provider(s).</p> <p>This may offer a substantial performance boost to some users.</p>   <h2 id=\"moreinformation\">More information</h2> <p>You should also read the documentation for <code class=\"module\"><a href=\"../mod/mod_auth_basic\">mod_auth_basic</a></code> and <code class=\"module\"><a href=\"../mod/mod_authz_host\">mod_authz_host</a></code> which contain some more information about how this all works. The directive <code class=\"directive\"><a href=\"../mod/mod_authn_core#authnprovideralias\">&lt;AuthnProviderAlias&gt;</a></code> can also help in simplifying certain authentication configurations.</p> <p>The various ciphers supported by Apache for authentication data are explained in <a href=\"../misc/password_encryptions\">Password Encryptions</a>.</p> <p>And you may want to look at the <a href=\"access\">Access Control</a> howto, which discusses a number of related topics.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/howto/auth.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/howto/auth.html</a>\n  </p>\n</div>\n","howto/ssi":"<h1>Apache httpd Tutorial: Introduction to Server Side Includes</h1>  <p>Server-side includes provide a means to add dynamic content to existing HTML documents.</p>     <h2 id=\"related\">Introduction</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"../mod/mod_include\">mod_include</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_cgi\">mod_cgi</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_expires\">mod_expires</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_include#xbithack\">XBitHack</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_mime#addtype\">AddType</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#setoutputfilter\">SetOutputFilter</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_setenvif#browsermatchnocase\">BrowserMatchNoCase</a></code></li>\n</ul></td>\n</tr>\n</table> <p>This article deals with Server Side Includes, usually called simply SSI. In this article, I'll talk about configuring your server to permit SSI, and introduce some basic SSI techniques for adding dynamic content to your existing HTML pages.</p> <p>In the latter part of the article, we'll talk about some of the somewhat more advanced things that can be done with SSI, such as conditional statements in your SSI directives.</p>   <h2 id=\"what\">What are SSI?</h2> <p>SSI (Server Side Includes) are directives that are placed in HTML pages, and evaluated on the server while the pages are being served. They let you add dynamically generated content to an existing HTML page, without having to serve the entire page via a CGI program, or other dynamic technology.</p> <p>For example, you might place a directive into an existing HTML page, such as:</p> <div class=\"example\"><pre>&lt;!--#echo var=\"DATE_LOCAL\" --&gt;</pre></div> <p>And, when the page is served, this fragment will be evaluated and replaced with its value:</p> <div class=\"example\"><pre>Tuesday, 15-Jan-2013 19:28:54 EST</pre></div> <p>The decision of when to use SSI, and when to have your page entirely generated by some program, is usually a matter of how much of the page is static, and how much needs to be recalculated every time the page is served. SSI is a great way to add small pieces of information, such as the current time - shown above. But if a majority of your page is being generated at the time that it is served, you need to look for some other solution.</p>   <h2 id=\"configuring\">Configuring your server to permit SSI</h2> <p>To permit SSI on your server, you must have the following directive either in your <code>httpd.conf</code> file, or in a <code>.htaccess</code> file:</p> <pre class=\"prettyprint lang-config\">Options +Includes</pre> <p>This tells Apache that you want to permit files to be parsed for SSI directives. Note that most configurations contain multiple <code class=\"directive\"><a href=\"../mod/core#options\">Options</a></code> directives that can override each other. You will probably need to apply the <code>Options</code> to the specific directory where you want SSI enabled in order to assure that it gets evaluated last.</p> <p>Not just any file is parsed for SSI directives. You have to tell Apache which files should be parsed. There are two ways to do this. You can tell Apache to parse any file with a particular file extension, such as <code>.shtml</code>, with the following directives:</p> <pre class=\"prettyprint lang-config\">AddType text/html .shtml\nAddOutputFilter INCLUDES .shtml</pre> <p>One disadvantage to this approach is that if you wanted to add SSI directives to an existing page, you would have to change the name of that page, and all links to that page, in order to give it a <code>.shtml</code> extension, so that those directives would be executed.</p> <p>The other method is to use the <code class=\"directive\"><a href=\"../mod/mod_include#xbithack\">XBitHack</a></code> directive:</p> <pre class=\"prettyprint lang-config\">XBitHack on</pre> <p><code class=\"directive\"><a href=\"../mod/mod_include#xbithack\">XBitHack</a></code> tells Apache to parse files for SSI directives if they have the execute bit set. So, to add SSI directives to an existing page, rather than having to change the file name, you would just need to make the file executable using <code>chmod</code>.</p> <div class=\"example\"><pre>chmod +x pagename.html</pre></div> <p>A brief comment about what not to do. You'll occasionally see people recommending that you just tell Apache to parse all <code>.html</code> files for SSI, so that you don't have to mess with <code>.shtml</code> file names. These folks have perhaps not heard about <code class=\"directive\"><a href=\"../mod/mod_include#xbithack\">XBitHack</a></code>. The thing to keep in mind is that, by doing this, you're requiring that Apache read through every single file that it sends out to clients, even if they don't contain any SSI directives. This can slow things down quite a bit, and is not a good idea.</p> <p>Of course, on Windows, there is no such thing as an execute bit to set, so that limits your options a little.</p> <p>In its default configuration, Apache does not send the last modified date or content length HTTP headers on SSI pages, because these values are difficult to calculate for dynamic content. This can prevent your document from being cached, and result in slower perceived client performance. There are two ways to solve this:</p> <ol> <li>Use the <code>XBitHack Full</code> configuration. This tells Apache to determine the last modified date by looking only at the date of the originally requested file, ignoring the modification date of any included files.</li> <li>Use the directives provided by <code class=\"module\"><a href=\"../mod/mod_expires\">mod_expires</a></code> to set an explicit expiration time on your files, thereby letting browsers and proxies know that it is acceptable to cache them.</li> </ol>   <h2 id=\"basic\">Basic SSI directives</h2> <p>SSI directives have the following syntax:</p> <div class=\"example\"><pre>&lt;!--#function attribute=value attribute=value ... --&gt;</pre></div> <p>It is formatted like an HTML comment, so if you don't have SSI correctly enabled, the browser will ignore it, but it will still be visible in the HTML source. If you have SSI correctly configured, the directive will be replaced with its results.</p> <p>The function can be one of a number of things, and we'll talk some more about most of these in the next installment of this series. For now, here are some examples of what you can do with SSI</p> <h3><a name=\"todaysdate\" id=\"todaysdate\">Today's date</a></h3> <div class=\"example\"><pre>&lt;!--#echo var=\"DATE_LOCAL\" --&gt;</pre></div> <p>The <code>echo</code> function just spits out the value of a variable. There are a number of standard variables, which include the whole set of environment variables that are available to CGI programs. Also, you can define your own variables with the <code>set</code> function.</p> <p>If you don't like the format in which the date gets printed, you can use the <code>config</code> function, with a <code>timefmt</code> attribute, to modify that formatting.</p> <div class=\"example\"><pre>&lt;!--#config timefmt=\"%A %B %d, %Y\" --&gt;\nToday is &lt;!--#echo var=\"DATE_LOCAL\" --&gt;</pre></div> <h3><a name=\"lastmodified\" id=\"lastmodified\">Modification date of the file</a></h3> <div class=\"example\"><pre>This document last modified &lt;!--#flastmod file=\"index.html\" --&gt;</pre></div> <p>This function is also subject to <code>timefmt</code> format configurations.</p> <h3><a name=\"cgi\" id=\"cgi\">Including the results of a CGI program</a></h3> <p>This is one of the more common uses of SSI - to output the results of a CGI program, such as everybody's favorite, a ``hit counter.''</p> <div class=\"example\"><pre>&lt;!--#include virtual=\"/cgi-bin/counter.pl\" --&gt;</pre></div>   <h2 id=\"additionalexamples\">Additional examples</h2> <p>Following are some specific examples of things you can do in your HTML documents with SSI.</p> <h3><a name=\"docmodified\" id=\"docmodified\">When was this document modified?</a></h3> <p>Earlier, we mentioned that you could use SSI to inform the user when the document was most recently modified. However, the actual method for doing that was left somewhat in question. The following code, placed in your HTML document, will put such a time stamp on your page. Of course, you will have to have SSI correctly enabled, as discussed above.</p> <div class=\"example\"><pre>&lt;!--#config timefmt=\"%A %B %d, %Y\" --&gt;\nThis file last modified &lt;!--#flastmod file=\"ssi.shtml\" --&gt;</pre></div> <p>Of course, you will need to replace the <code>ssi.shtml</code> with the actual name of the file that you're referring to. This can be inconvenient if you're just looking for a generic piece of code that you can paste into any file, so you probably want to use the <code>LAST_MODIFIED</code> variable instead:</p> <div class=\"example\"><pre>&lt;!--#config timefmt=\"%D\" --&gt;\nThis file last modified &lt;!--#echo var=\"LAST_MODIFIED\" --&gt;</pre></div> <p>For more details on the <code>timefmt</code> format, go to your favorite search site and look for <code>strftime</code>. The syntax is the same.</p> <h3><a name=\"standard-footer\" id=\"standard-footer\">Including a standard footer</a></h3> <p>If you are managing any site that is more than a few pages, you may find that making changes to all those pages can be a real pain, particularly if you are trying to maintain some kind of standard look across all those pages.</p> <p>Using an include file for a header and/or a footer can reduce the burden of these updates. You just have to make one footer file, and then include it into each page with the <code>include</code> SSI command. The <code>include</code> function can determine what file to include with either the <code>file</code> attribute, or the <code>virtual</code> attribute. The <code>file</code> attribute is a file path, <em>relative to the current directory</em>. That means that it cannot be an absolute file path (starting with /), nor can it contain ../ as part of that path. The <code>virtual</code> attribute is probably more useful, and should specify a URL relative to the document being served. It can start with a /, but must be on the same server as the file being served.</p> <div class=\"example\"><pre>&lt;!--#include virtual=\"/footer.html\" --&gt;</pre></div> <p>I'll frequently combine the last two things, putting a <code>LAST_MODIFIED</code> directive inside a footer file to be included. SSI directives can be contained in the included file, and includes can be nested - that is, the included file can include another file, and so on.</p>   <h2 id=\"config\">What else can I config?</h2> <p>In addition to being able to <code>config</code> the time format, you can also <code>config</code> two other things.</p> <p>Usually, when something goes wrong with your SSI directive, you get the message</p> <div class=\"example\"><pre>[an error occurred while processing this directive]</pre></div> <p>If you want to change that message to something else, you can do so with the <code>errmsg</code> attribute to the <code>config</code> function:</p> <div class=\"example\"><pre>&lt;!--#config errmsg=\"[It appears that you don't know how to use SSI]\" --&gt;</pre></div> <p>Hopefully, end users will never see this message, because you will have resolved all the problems with your SSI directives before your site goes live. (Right?)</p> <p>And you can <code>config</code> the format in which file sizes are returned with the <code>sizefmt</code> attribute. You can specify <code>bytes</code> for a full count in bytes, or <code>abbrev</code> for an abbreviated number in Kb or Mb, as appropriate.</p>   <h2 id=\"exec\">Executing commands</h2> <p>I expect that I'll have an article some time in the coming months about using SSI with small CGI programs. For now, here's something else that you can do with the <code>exec</code> function. You can actually have SSI execute a command using the shell (<code>/bin/sh</code>, to be precise - or the DOS shell, if you're on Win32). The following, for example, will give you a directory listing.</p> <div class=\"example\"><pre>&lt;pre&gt;\n&lt;!--#exec cmd=\"ls\" --&gt;\n&lt;/pre&gt;</pre></div> <p>or, on Windows</p> <div class=\"example\"><pre>&lt;pre&gt;\n&lt;!--#exec cmd=\"dir\" --&gt;\n&lt;/pre&gt;</pre></div> <p>You might notice some strange formatting with this directive on Windows, because the output from <code>dir</code> contains the string ``&lt;<code>dir</code>&gt;'' in it, which confuses browsers.</p> <p>Note that this feature is exceedingly dangerous, as it will execute whatever code happens to be embedded in the <code>exec</code> tag. If you have any situation where users can edit content on your web pages, such as with a ``guestbook'', for example, make sure that you have this feature disabled. You can allow SSI, but not the <code>exec</code> feature, with the <code>IncludesNOEXEC</code> argument to the <code>Options</code> directive.</p>   <h2 id=\"advanced\">Advanced SSI techniques</h2> <p>In addition to spitting out content, Apache SSI gives you the option of setting variables, and using those variables in comparisons and conditionals.</p> <h3><a name=\"variables\" id=\"variables\">Setting variables</a></h3> <p>Using the <code>set</code> directive, you can set variables for later use. We'll need this later in the discussion, so we'll talk about it here. The syntax of this is as follows:</p> <div class=\"example\"><pre>&lt;!--#set var=\"name\" value=\"Rich\" --&gt;</pre></div> <p>In addition to merely setting values literally like that, you can use any other variable, including <a href=\"../env\">environment variables</a> or the variables discussed above (like <code>LAST_MODIFIED</code>, for example) to give values to your variables. You will specify that something is a variable, rather than a literal string, by using the dollar sign ($) before the name of the variable.</p> <div class=\"example\"><pre>&lt;!--#set var=\"modified\" value=\"$LAST_MODIFIED\" --&gt;</pre></div> <p>To put a literal dollar sign into the value of your variable, you need to escape the dollar sign with a backslash.</p> <div class=\"example\"><pre>&lt;!--#set var=\"cost\" value=\"\\$100\" --&gt;</pre></div> <p>Finally, if you want to put a variable in the midst of a longer string, and there's a chance that the name of the variable will run up against some other characters, and thus be confused with those characters, you can place the name of the variable in braces, to remove this confusion. (It's hard to come up with a really good example of this, but hopefully you'll get the point.)</p> <div class=\"example\"><pre>&lt;!--#set var=\"date\" value=\"${DATE_LOCAL}_${DATE_GMT}\" --&gt;</pre></div> <h3><a name=\"conditional\" id=\"conditional\">Conditional expressions</a></h3> <p>Now that we have variables, and are able to set and compare their values, we can use them to express conditionals. This lets SSI be a tiny programming language of sorts. <code class=\"module\"><a href=\"../mod/mod_include\">mod_include</a></code> provides an <code>if</code>, <code>elif</code>, <code>else</code>, <code>endif</code> structure for building conditional statements. This allows you to effectively generate multiple logical pages out of one actual page.</p> <p>The structure of this conditional construct is:</p> <div class=\"example\"><pre>&lt;!--#if expr=\"test_condition\" --&gt;\n&lt;!--#elif expr=\"test_condition\" --&gt;\n&lt;!--#else --&gt;\n&lt;!--#endif --&gt;</pre></div> <p>A <em>test_condition</em> can be any sort of logical comparison - either comparing values to one another, or testing the ``truth'' of a particular value. (A given string is true if it is nonempty.) For a full list of the comparison operators available to you, see the <code class=\"module\"><a href=\"../mod/mod_include\">mod_include</a></code> documentation.</p> <p>For example, if you wish to customize the text on your web page based on the time of day, you could use the following recipe, placed in the HTML page:</p> <div class=\"example\"><pre>Good &lt;!--#if expr=\"%{TIME_HOUR} &lt;12\" --&gt;\nmorning!\n&lt;!--#else --&gt;\nafternoon!\n&lt;!--#endif --&gt;</pre></div> <p>Any other variable (either ones that you define, or normal environment variables) can be used in conditional statements. See <a href=\"../expr\">Expressions in Apache HTTP Server</a> for more information on the expression evaluation engine.</p> <p>With Apache's ability to set environment variables with the <code>SetEnvIf</code> directives, and other related directives, this functionality can let you do a wide variety of dynamic content on the server side without resorting a full web application.</p>   <h2 id=\"conclusion\">Conclusion</h2> <p>SSI is certainly not a replacement for CGI, or other technologies used for generating dynamic web pages. But it is a great way to add small amounts of dynamic content to pages, without doing a lot of extra work.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/howto/ssi.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/howto/ssi.html</a>\n  </p>\n</div>\n","howto/reverse_proxy":"<h1>Reverse Proxy Guide</h1>  <p>In addition to being a \"basic\" web server, and providing static and dynamic content to end-users, Apache httpd (as well as most other web servers) can also act as a reverse proxy server, also-known-as a \"gateway\" server.</p> <p>In such scenarios, httpd itself does not generate or host the data, but rather the content is obtained by one or several backend servers, which normally have no direct connection to the external network. As httpd receives a request from a client, the request itself is <em>proxied</em> to one of these backend servers, which then handles the request, generates the content and then sends this content back to httpd, which then generates the actual HTTP response back to the client.</p> <p>There are numerous reasons for such an implementation, but generally the typical rationales are due to security, high-availability, load-balancing and centralized authentication/authorization. It is critical in these implementations that the layout, design and architecture of the backend infrastructure (those servers which actually handle the requests) are insulated and protected from the outside; as far as the client is concerned, the reverse proxy server <em>is</em> the sole source of all content.</p> <p>A typical implementation is below:</p> <p class=\"centered\"><img src=\"https://httpd.apache.org/docs/2.4/en/images/reverse-proxy-arch.png\" alt=\"reverse-proxy-arch\"></p>     <h2 id=\"related\">Reverse Proxy</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"../mod/mod_proxy\">mod_proxy</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_proxy_balancer\">mod_proxy_balancer</a></code></li>\n<li><code class=\"module\"><a href=\"../mod/mod_proxy_hcheck\">mod_proxy_hcheck</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/mod_proxy#balancermember\">BalancerMember</a></code></li>\n</ul></td>\n</tr>\n</table>   <h2 id=\"simple\">Simple reverse proxying</h2> <p> The <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code> directive specifies the mapping of incoming requests to the backend server (or a cluster of servers known as a <code>Balancer</code> group). The simpliest example proxies all requests (<code>\"/\"</code>) to a single backend: </p> <pre class=\"prettyprint lang-config\">ProxyPass \"/\"  \"http://www.example.com/\"</pre> <p> To ensure that and <code>Location:</code> headers generated from the backend are modified to point to the reverse proxy, instead of back to itself, the <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypassreverse\">ProxyPassReverse</a></code> directive is most often required: </p> <pre class=\"prettyprint lang-config\">ProxyPass \"/\"  \"http://www.example.com/\"\nProxyPassReverse \"/\"  \"http://www.example.com/\"</pre> <p>Only specific URIs can be proxied, as shown in this example:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/images\"  \"http://www.example.com/\"\nProxyPassReverse \"/images\"  \"http://www.example.com/\"</pre> <p>In the above, any requests which start with the <code>/images</code> path with be proxied to the specified backend, otherwise it will be handled locally. </p>   <h2 id=\"cluster\">Clusters and Balancers</h2> <p> As useful as the above is, it still has the deficiencies that should the (single) backend node go down, or become heavily loaded, that proxying those requests provides no real advantage. What is needed is the ability to define a set or group of backend servers which can handle such requests and for the reverse proxy to load balance and failover among them. This group is sometimes called a <em>cluster</em> but Apache httpd's term is a <em>balancer</em>. One defines a balancer by leveraging the <code class=\"directive\"><a href=\"../mod/mod_proxy#proxy\">&lt;Proxy&gt;</a></code> and <code class=\"directive\"><a href=\"../mod/mod_proxy#balancermember\">BalancerMember</a></code> directives as shown: </p> <pre class=\"prettyprint lang-config\">&lt;Proxy balancer://myset&gt;\n    BalancerMember http://www2.example.com:8080\n    BalancerMember http://www3.example.com:8080\n    ProxySet lbmethod=bytraffic\n&lt;/Proxy&gt;\n\nProxyPass \"/images/\"  \"balancer://myset/\"\nProxyPassReverse \"/images/\"  \"balancer://myset/\"</pre> <p> The <code>balancer://</code> scheme is what tells httpd that we are creating a balancer set, with the name <em>myset</em>. It includes 2 backend servers, which httpd calls <em>BalancerMembers</em>. In this case, any requests for <code>/images</code> will be proxied to <em>one</em> of the 2 backends. The <code class=\"directive\"><a href=\"../mod/mod_proxy#proxyset\">ProxySet</a></code> directive specifies that the <em>myset</em> Balancer use a load balancing algorithm that balances based on I/O bytes. </p> <div class=\"note\">\n<p><strong>Hint</strong></p> <p> <em>BalancerMembers</em> are also sometimes referred to as <em>workers</em>. </p> </div>   <h2 id=\"config\">Balancer and BalancerMember configuration</h2> <p> You can adjust numerous configuration details of the <em>balancers</em> and the <em>workers</em> via the various parameters defined in <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code>. For example, assuming we would want <code>http://www3.example.com:8080</code> to handle 3x the traffic with a timeout of 1 second, we would adjust the configuration as follows: </p> <pre class=\"prettyprint lang-config\">&lt;Proxy balancer://myset&gt;\n    BalancerMember http://www2.example.com:8080\n    BalancerMember http://www3.example.com:8080 loadfactor=3 timeout=1\n    ProxySet lbmethod=bytraffic\n&lt;/Proxy&gt;\n\nProxyPass \"/images\"  \"balancer://myset/\"\nProxyPassReverse \"/images\"  \"balancer://myset/\"</pre>   <h2 id=\"failover\">Failover</h2> <p> You can also fine-tune various failover scenarios, detailing which workers and even which balancers should accessed in such cases. For example, the below setup implements 2 failover cases: In the first, <code>http://hstandby.example.com:8080</code> is only sent traffic if all other workers in the <em>myset</em> balancer are not available. If that worker itself is not available, only then will the <code>http://bkup1.example.com:8080</code> and <code>http://bkup2.example.com:8080</code> workers be brought into rotation: </p> <pre class=\"prettyprint lang-config\">&lt;Proxy balancer://myset&gt;\n    BalancerMember http://www2.example.com:8080\n    BalancerMember http://www3.example.com:8080 loadfactor=3 timeout=1\n    BalancerMember http://hstandby.example.com:8080 status=+H\n    BalancerMember http://bkup1.example.com:8080 lbset=1\n    BalancerMember http://bkup2.example.com:8080 lbset=1\n    ProxySet lbmethod=byrequests\n&lt;/Proxy&gt;\n\nProxyPass \"/images/\"  \"balancer://myset/\"\nProxyPassReverse \"/images/\"  \"balancer://myset/\"</pre> <p> The magic of this failover setup is setting <code>http://hstandby.example.com:8080</code> with the <code>+H</code> status flag, which puts it in <em>hot standby</em> mode, and making the 2 <code>bkup#</code> servers part of the #1 load balancer set (the default set is 0); for failover, hot standbys (if they exist) are used 1st, when all regular workers are unavailable; load balancer sets are always tried lowest number first. </p>   <h2 id=\"manager\">Balancer Manager</h2> <p> One of the most unique and useful features of Apache httpd's reverse proxy is the embedded <em>balancer-manager</em> application. Similar to <code class=\"module\"><a href=\"../mod/mod_status\">mod_status</a></code>, <em>balancer-manager</em> displays the current working configuration and status of the enabled balancers and workers currently in use. However, not only does it display these parameters, it also allows for dynamic, runtime, on-the-fly reconfiguration of almost all of them, including adding new <em>BalancerMembers</em> (workers) to an existing balancer. To enable these capability, the following needs to be added to your configuration: </p> <pre class=\"prettyprint lang-config\">&lt;Location \"/balancer-manager\"&gt;\n    SetHandler balancer-manager\n    Require host localhost\n&lt;/Location&gt;</pre> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable the <em>balancer-manager</em> until you have <a href=\"../mod/mod_proxy#access\">secured your server</a>. In particular, ensure that access to the URL is tightly restricted.</p> </div> <p> When the reverse proxy server is accessed at that url (eg: <code>http://rproxy.example.com/balancer-manager/</code>, you will see a page similar to the below: </p> <p class=\"centered\"><img src=\"https://httpd.apache.org/docs/2.4/en/images/bal-man.png\" alt=\"balancer-manager page\"></p> <p> This form allows the devops admin to adjust various parameters, take workers offline, change load balancing methods and add new works. For example, clicking on the balancer itself, you will get the following page: </p> <p class=\"centered\"><img src=\"https://httpd.apache.org/docs/2.4/en/images/bal-man-b.png\" alt=\"balancer-manager page\"></p> <p> Whereas clicking on a worker, displays this page: </p> <p class=\"centered\"><img src=\"https://httpd.apache.org/docs/2.4/en/images/bal-man-w.png\" alt=\"balancer-manager page\"></p> <p> To have these changes persist restarts of the reverse proxy, ensure that <code class=\"directive\"><a href=\"../mod/mod_proxy#balancerpersist\">BalancerPersist</a></code> is enabled. </p>   <h2 id=\"health-check\">Dynamic Health Checks</h2> <p> Before httpd proxies a request to a worker, it can <em>\"test\"</em> if that worker is available via setting the <code>ping</code> parameter for that worker using <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code>. Oftentimes it is more useful to check the health of the workers <em>out of band</em>, in a dynamic fashion. This is achieved in Apache httpd by the <code class=\"module\"><a href=\"../mod/mod_proxy_hcheck\">mod_proxy_hcheck</a></code> module. </p>   <h2 id=\"status\">BalancerMember status flags</h2> <p> In the <em>balancer-manager</em> the current state, or <em>status</em>, of a worker is displayed and can be set/reset. The meanings of these statuses are as follows: </p> <table class=\"bordered\"> <tr>\n<th>Flag</th>\n<th>String</th>\n<th>Description</th>\n</tr> <tr>\n<td> </td>\n<td><em>Ok</em></td>\n<td>Worker is available</td>\n</tr> <tr>\n<td> </td>\n<td><em>Init</em></td>\n<td>Worker has been initialized</td>\n</tr> <tr>\n<td><code>D</code></td>\n<td><em>Dis</em></td>\n<td>Worker is disabled and will not accept any requests; will be automatically retried.</td>\n</tr> <tr>\n<td><code>S</code></td>\n<td><em>Stop</em></td>\n<td>Worker is administratively stopped; will not accept requests and will not be automatically retried</td>\n</tr> <tr>\n<td><code>I</code></td>\n<td><em>Ign</em></td>\n<td>Worker is in ignore-errors mode and will always be considered available.</td>\n</tr> <tr>\n<td><code>H</code></td>\n<td><em>Stby</em></td>\n<td>Worker is in hot-standby mode and will only be used if no other viable workers are available.</td>\n</tr> <tr>\n<td><code>E</code></td>\n<td><em>Err</em></td>\n<td>Worker is in an error state, usually due to failing pre-request check; requests will not be proxied to this worker, but it will be retried depending on the <code>retry</code> setting of the worker.</td>\n</tr> <tr>\n<td><code>N</code></td>\n<td><em>Drn</em></td>\n<td>Worker is in drain mode and will only accept existing sticky sessions destined for itself and ignore all other requests.</td>\n</tr> <tr>\n<td><code>C</code></td>\n<td><em>HcFl</em></td>\n<td>Worker has failed dynamic health check and will not be used until it passes subsequent health checks.</td>\n</tr> </table><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/howto/reverse_proxy.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/howto/reverse_proxy.html</a>\n  </p>\n</div>\n","misc/index":"<h1>Apache Miscellaneous Documentation</h1>  <p>Below is a list of additional documentation pages that apply to the Apache web server development project.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>The documents below have not been fully updated to take into account changes made in the 2.1 version of the Apache HTTP Server. Some of the information may still be relevant, but please use it with care.</p> </div> <dl> <dt><a href=\"perf-tuning\">Performance Notes - Apache Tuning</a></dt> <dd> <p>Notes about how to (run-time and compile-time) configure Apache for highest performance. Notes explaining why Apache does some things, and why it doesn't do other things (which make it slower/faster).</p> </dd> <dt><a href=\"security_tips\">Security Tips</a></dt> <dd> <p>Some \"do\"s - and \"don't\"s - for keeping your Apache web site secure.</p> </dd> <dt><a href=\"relevant_standards\">Relevant Standards</a></dt> <dd> <p>This document acts as a reference page for most of the relevant standards that Apache follows.</p> </dd> <dt><a href=\"password_encryptions\">Password Encryption Formats</a></dt> <dd> <p>Discussion of the various ciphers supported by Apache for authentication purposes.</p> </dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/misc/\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/misc/</a>\n  </p>\n</div>\n","platform/index":"<h1>Platform Specific Notes</h1>      <h2 id=\"win\">Microsoft Windows</h2> <dl> <dt>Using Apache</dt> <dd> <p>This document explains how to install, configure and run Apache 2.4 under Microsoft Windows.</p> <p>See: <a href=\"windows\">Using Apache with Microsoft Windows</a></p> </dd> </dl> <dl> <dt>Compiling Apache</dt> <dd> <p>There are many important points before you begin compiling Apache. This document explain them.</p> <p>See: <a href=\"win_compiling\">Compiling Apache for Microsoft Windows</a></p> </dd> </dl>   <h2 id=\"unix\">Unix Systems</h2> <dl> <dt>RPM Based Systems (Redhat / CentOS / Fedora)</dt> <dd> <p>This document explains how to build, install, and run Apache 2.4 on systems supporting the RPM packaging format.</p> <p>See: <a href=\"rpm\">Using Apache With RPM Based Systems</a></p> </dd> </dl>   <h2 id=\"other\">Other Platforms</h2> <dl> <dt>Novell NetWare</dt> <dd> <p>This document explains how to install, configure and run Apache 2.4 under Novell NetWare 5.1 and above.</p> <p>See: <a href=\"netware\">Using Apache With Novell NetWare</a></p> </dd> </dl> <dl> <dt>EBCDIC</dt> <dd> <p>Version 1.3 of the Apache HTTP Server is the first version which includes a port to a (non-ASCII) mainframe machine which uses the EBCDIC character set as its native codeset.</p> <div class=\"warning\">\n<strong>Warning:</strong> This document has not been updated to take into account changes made in the 2.4 version of the Apache HTTP Server. Some of the information may still be relevant, but please use it with care.</div> <p>See: <a href=\"ebcdic\">The Apache EBCDIC Port</a></p> </dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/platform/\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/platform/</a>\n  </p>\n</div>\n","platform/windows":"<h1>Using Apache HTTP Server on Microsoft Windows</h1>  <p>This document explains how to install, configure and run Apache 2.4 under Microsoft Windows. If you have questions after reviewing the documentation (and any event and error logs), you should consult the peer-supported <a href=\"http://httpd.apache.org/userslist.html\">users' mailing list</a>.</p> <p>This document assumes that you are installing a binary distribution of Apache. If you want to compile Apache yourself (possibly to help with development or tracking down bugs), see <a href=\"win_compiling\">Compiling Apache for Microsoft Windows</a>.</p>     <h2 id=\"req\">Operating System Requirements</h2> <p>The primary Windows platform for running Apache 2.4 is Windows 2000 or later. Always obtain and install the current service pack to avoid operating system bugs.</p> <div class=\"note\">Apache HTTP Server versions later than 2.2 will not run on any operating system earlier than Windows 2000.</div>   <h2 id=\"down\">Downloading Apache for Windows</h2> <p>The Apache HTTP Server Project itself does not provide binary releases of software, only source code. Individual committers <em>may</em> provide binary packages as a convenience, but it is not a release deliverable.</p> <p>If you cannot compile the Apache HTTP Server yourself, you can obtain a binary package from numerous binary distributions available on the Internet.</p> <p>Popular options for deploying Apache httpd, and, optionally, PHP and MySQL, on Microsoft Windows, include:</p> <ul> <li><a href=\"http://www.apachehaus.com/cgi-bin/download.plx\">ApacheHaus</a></li> <li><a href=\"http://www.apachelounge.com/download/\">Apache Lounge</a></li> <li><a href=\"http://bitnami.com/stack/wamp\">BitNami WAMP Stack</a></li> <li><a href=\"http://www.wampserver.com/\">WampServer</a></li> <li><a href=\"http://www.apachefriends.org/en/xampp.html\">XAMPP</a></li> </ul>   <h2 id=\"cust\">Customizing Apache for Windows</h2> <p>Apache is configured by the files in the <code>conf</code> subdirectory. These are the same files used to configure the Unix version, but there are a few different directives for Apache on Windows. See the <a href=\"https://httpd.apache.org/docs/2.4/en/mod/directives.html\">directive index</a> for all the available directives.</p> <p>The main differences in Apache for Windows are:</p> <ul> <li>\n<p>Because Apache for Windows is multithreaded, it does not use a separate process for each request, as Apache can on Unix. Instead there are usually only two Apache processes running: a parent process, and a child which handles the requests. Within the child process each request is handled by a separate thread. </p> <p>The process management directives are also different:</p> <p><code class=\"directive\"><a href=\"../mod/mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code>: Like the Unix directive, this controls how many connections a single child process will serve before exiting. However, unlike on Unix, a replacement process is not instantly available. Use the default <code>MaxConnectionsPerChild 0</code>, unless instructed to change the behavior to overcome a memory leak in third party modules or in-process applications.</p> <div class=\"warning\"><strong>Warning: The server configuration file is reread when a new child process is started. If you have modified <code>httpd.conf</code>, the new child may not start or you may receive unexpected results.</strong></div> <p><code class=\"directive\"><a href=\"../mod/mpm_common#threadsperchild\">ThreadsPerChild</a></code>: This directive is new. It tells the server how many threads it should use. This is the maximum number of connections the server can handle at once, so be sure to set this number high enough for your site if you get a lot of hits. The recommended default is <code>ThreadsPerChild 150</code>, but this must be adjusted to reflect the greatest anticipated number of simultaneous connections to accept.</p>\n</li> <li><p>The directives that accept filenames as arguments must use Windows filenames instead of Unix ones. However, because Apache may interpret backslashes as an \"escape character\" sequence, you should consistently use forward slashes in path names, not backslashes.</p></li> <li>\n<p>While filenames are generally case-insensitive on Windows, URLs are still treated internally as case-sensitive before they are mapped to the filesystem. For example, the <code class=\"directive\"><a href=\"../mod/core#location\">&lt;Location&gt;</a></code>, <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code>, and <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code> directives all use case-sensitive arguments. For this reason, it is particularly important to use the <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> directive when attempting to limit access to content in the filesystem, since this directive applies to any content in a directory, regardless of how it is accessed. If you wish to assure that only lowercase is used in URLs, you can use something like:</p> <pre class=\"prettyprint lang-config\">RewriteEngine On\nRewriteMap lowercase int:tolower\nRewriteCond \"%{REQUEST_URI}\" \"[A-Z]\"\nRewriteRule \"(.*)\" \"${lowercase:$1}\" [R,L]</pre> </li> <li><p>When running, Apache needs write access only to the logs directory and any configured cache directory tree. Due to the issue of case insensitive and short 8.3 format names, Apache must validate all path names given. This means that each directory which Apache evaluates, from the drive root up to the directory leaf, must have read, list and traverse directory permissions. If Apache2.4 is installed at C:\\Program Files, then the root directory, Program Files and Apache2.4 must all be visible to Apache.</p></li> <li>\n<p>Apache for Windows contains the ability to load modules at runtime, without recompiling the server. If Apache is compiled normally, it will install a number of optional modules in the <code>\\Apache2.4\\modules</code> directory. To activate these or other modules, the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive must be used. For example, to activate the status module, use the following (in addition to the status-activating directives in <code>access.conf</code>):</p> <pre class=\"prettyprint lang-config\">LoadModule status_module modules/mod_status.so</pre> <p>Information on <a href=\"../mod/mod_so#creating\">creating loadable modules</a> is also available.</p>\n</li> <li><p>Apache can also load ISAPI (Internet Server Application Programming Interface) extensions such as those used by Microsoft IIS and other Windows servers. <a href=\"../mod/mod_isapi\">More information is available</a>. Note that Apache <strong>cannot</strong> load ISAPI Filters, and ISAPI Handlers with some Microsoft feature extensions will not work.</p></li> <li><p>When running CGI scripts, the method Apache uses to find the interpreter for the script is configurable using the <code class=\"directive\"><a href=\"../mod/core#scriptinterpretersource\">ScriptInterpreterSource</a></code> directive.</p></li> <li><p>Since it is often difficult to manage files with names like <code>.htaccess</code> in Windows, you may find it useful to change the name of this per-directory configuration file using the <code class=\"directive\"><a href=\"../mod/core#accessfilename\">AccessFilename</a></code> directive.</p></li> <li><p>Any errors during Apache startup are logged into the Windows event log when running on Windows NT. This mechanism acts as a backup for those situations where Apache is not yet prepared to use the <code>error.log</code> file. You can review the Windows Application Event Log by using the Event Viewer, e.g. Start - Settings - Control Panel - Administrative Tools - Event Viewer.</p></li> </ul>   <h2 id=\"winsvc\">Running Apache as a Service</h2> <p>Apache comes with a utility called the Apache Service Monitor. With it you can see and manage the state of all installed Apache services on any machine on your network. To be able to manage an Apache service with the monitor, you have to first install the service (either automatically via the installation or manually). </p> <p>You can install Apache as a Windows NT service as follows from the command prompt at the Apache <code>bin</code> subdirectory:</p> <div class=\"example\"><pre>httpd.exe -k install</pre></div> <p>If you need to specify the name of the service you want to install, use the following command. You have to do this if you have several different service installations of Apache on your computer. If you specify a name during the install, you have to also specify it during any other -k operation.</p> <div class=\"example\"><pre>httpd.exe -k install -n \"MyServiceName\"</pre></div> <p>If you need to have specifically named configuration files for different services, you must use this:</p> <div class=\"example\"><pre>httpd.exe -k install -n \"MyServiceName\" -f \"c:\\files\\my.conf\"</pre></div> <p>If you use the first command without any special parameters except <code>-k install</code>, the service will be called <code>Apache2.4</code> and the configuration will be assumed to be <code>conf\\httpd.conf</code>. </p> <p>Removing an Apache service is easy. Just use:</p> <div class=\"example\"><pre>httpd.exe -k uninstall</pre></div> <p>The specific Apache service to be uninstalled can be specified by using:</p> <div class=\"example\"><pre>httpd.exe -k uninstall -n \"MyServiceName\"</pre></div> <p>Normal starting, restarting and shutting down of an Apache service is usually done via the Apache Service Monitor, by using commands like <code>NET START Apache2.4</code> and <code>NET STOP Apache2.4</code> or via normal Windows service management. Before starting Apache as a service by any means, you should test the service's configuration file by using:</p> <div class=\"example\"><pre>httpd.exe -n \"MyServiceName\" -t</pre></div> <p>You can control an Apache service by its command line switches, too. To start an installed Apache service you'll use this:</p> <div class=\"example\"><pre>httpd.exe -k start -n \"MyServiceName\"</pre></div> <p>To stop an Apache service via the command line switches, use this:</p> <div class=\"example\"><pre>httpd.exe -k stop -n \"MyServiceName\"</pre></div> <p>or</p> <div class=\"example\"><pre>httpd.exe -k shutdown -n \"MyServiceName\"</pre></div> <p>You can also restart a running service and force it to reread its configuration file by using:</p> <div class=\"example\"><pre>httpd.exe -k restart -n \"MyServiceName\"</pre></div> <p>By default, all Apache services are registered to run as the system user (the <code>LocalSystem</code> account). The <code>LocalSystem</code> account has no privileges to your network via any Windows-secured mechanism, including the file system, named pipes, DCOM, or secure RPC. It has, however, wide privileges locally. </p> <div class=\"warning\"><strong>Never grant any network privileges to the <code>LocalSystem</code> account! If you need Apache to be able to access network resources, create a separate account for Apache as noted below.</strong></div> <p>It is recommended that users create a separate account for running Apache service(s). If you have to access network resources via Apache, this is required.</p> <ol> <li>Create a normal domain user account, and be sure to memorize its password.</li> <li>Grant the newly-created user a privilege of <code>Log on as a service</code> and <code>Act as part of the operating system</code>. On Windows NT 4.0 these privileges are granted via User Manager for Domains, but on Windows 2000 and XP you probably want to use Group Policy for propagating these settings. You can also manually set these via the Local Security Policy MMC snap-in. </li> <li>Confirm that the created account is a member of the Users group.</li> <li>Grant the account read and execute (RX) rights to all document and script folders (<code>htdocs</code> and <code>cgi-bin</code> for example).</li> <li>Grant the account change (RWXD) rights to the Apache <code>logs</code> directory.</li> <li>Grant the account read and execute (RX) rights to the <code>httpd.exe</code> binary executable.</li> </ol> <div class=\"note\">It is usually a good practice to grant the user the Apache service runs as read and execute (RX) access to the whole Apache2.4 directory, except the <code>logs</code> subdirectory, where the user has to have at least change (RWXD) rights.</div> <p>If you allow the account to log in as a user and as a service, then you can log on with that account and test that the account has the privileges to execute the scripts, read the web pages, and that you can start Apache in a console window. If this works, and you have followed the steps above, Apache should execute as a service with no problems.</p> <div class=\"note\">\n<strong>Error code 2186</strong> is a good indication that you need to review the \"Log On As\" configuration for the service, since Apache cannot access a required network resource. Also, pay close attention to the privileges of the user Apache is configured to run as.</div> <p>When starting Apache as a service you may encounter an error message from the Windows Service Control Manager. For example, if you try to start Apache by using the Services applet in the Windows Control Panel, you may get the following message:</p> <div class=\"example\"><pre>Could not start the Apache2.4 service on \\\\COMPUTER \nError 1067; The process terminated unexpectedly.</pre></div> <p>You will get this generic error if there is any problem with starting the Apache service. In order to see what is really causing the problem you should follow the instructions for Running Apache for Windows from the Command Prompt.</p> <p>If you are having problems with the service, it is suggested you follow the instructions below to try starting httpd.exe from a console window, and work out the errors before struggling to start it as a service again.</p>   <h2 id=\"wincons\">Running Apache as a Console Application</h2> <p>Running Apache as a service is usually the recommended way to use it, but it is sometimes easier to work from the command line, especially during initial configuration and testing.</p> <p>To run Apache from the command line as a console application, use the following command:</p> <div class=\"example\"><code>httpd.exe</code></div> <p>Apache will execute, and will remain running until it is stopped by pressing Control-C.</p> <p>You can also run Apache via the shortcut Start Apache in Console placed to <code>Start Menu --&gt; Programs --&gt; Apache HTTP Server 2.4.xx --&gt; Control Apache Server</code> during the installation. This will open a console window and start Apache inside it. If you don't have Apache installed as a service, the window will remain visible until you stop Apache by pressing Control-C in the console window where Apache is running in. The server will exit in a few seconds. However, if you do have Apache installed as a service, the shortcut starts the service. If the Apache service is running already, the shortcut doesn't do anything.</p> <p>If Apache is running as a service, you can tell it to stop by opening another console window and entering:</p> <div class=\"example\"><pre>httpd.exe -k shutdown</pre></div> <p>Running as a service should be preferred over running in a console window because this lets Apache end any current operations and clean up gracefully.</p> <p>But if the server is running in a console window, you can only stop it by pressing Control-C in the same window.</p> <p>You can also tell Apache to restart. This forces it to reread the configuration file. Any operations in progress are allowed to complete without interruption. To restart Apache, either press Control-Break in the console window you used for starting Apache, or enter</p> <div class=\"example\"><pre>httpd.exe -k restart</pre></div> <p>if the server is running as a service.</p> <div class=\"note\">Note for people familiar with the Unix version of Apache: these commands provide a Windows equivalent to <code>kill -TERM <em>pid</em></code> and <code>kill -USR1 <em>pid</em></code>. The command line option used, <code>-k</code>, was chosen as a reminder of the <code>kill</code> command used on Unix.</div> <p>If the Apache console window closes immediately or unexpectedly after startup, open the Command Prompt from the Start Menu --&gt; Programs. Change to the folder to which you installed Apache, type the command <code>httpd.exe</code>, and read the error message. Then change to the logs folder, and review the <code>error.log</code> file for configuration mistakes. Assuming httpd was installed into <code>C:\\Program Files\\Apache Software Foundation\\Apache2.4\\</code>, you can do the following:</p> <div class=\"example\"><pre>c: \ncd \"\\Program Files\\Apache Software Foundation\\Apache2.4\\bin\" \nhttpd.exe</pre></div> <p>Then wait for Apache to stop, or press Control-C. Then enter the following:</p> <div class=\"example\"><pre>cd ..\\logs \nmore &lt; error.log</pre></div> <p>When working with Apache it is important to know how it will find the configuration file. You can specify a configuration file on the command line in two ways:</p> <ul> <li>\n<p><code>-f</code> specifies an absolute or relative path to a particular configuration file:</p> <div class=\"example\"><pre>httpd.exe -f \"c:\\my server files\\anotherconfig.conf\"</pre></div> <p>or</p> <div class=\"example\"><pre>httpd.exe -f files\\anotherconfig.conf</pre></div>\n</li> <li>\n<p><code>-n</code> specifies the installed Apache service whose configuration file is to be used:</p> <div class=\"example\"><pre>httpd.exe -n \"MyServiceName\"</pre></div> </li> </ul> <p>In both of these cases, the proper <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> should be set in the configuration file.</p> <p>If you don't specify a configuration file with <code>-f</code> or <code>-n</code>, Apache will use the file name compiled into the server, such as <code>conf\\httpd.conf</code>. This built-in path is relative to the installation directory. You can verify the compiled file name from a value labelled as <code>SERVER_CONFIG_FILE</code> when invoking Apache with the <code>-V</code> switch, like this:</p> <div class=\"example\"><pre>httpd.exe -V</pre></div> <p>Apache will then try to determine its <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> by trying the following, in this order:</p> <ol> <li>A <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> directive via the <code>-C</code> command line switch.</li> <li>The <code>-d</code> switch on the command line.</li> <li>Current working directory.</li> <li>A registry entry which was created if you did a binary installation.</li> <li>The server root compiled into the server. This is <code>/apache</code> by default, you can verify it by using <code>httpd.exe -V</code> and looking for a value labelled as <code>HTTPD_ROOT</code>.</li> </ol> <p>If you did not do a binary install, Apache will in some scenarios complain about the missing registry key. This warning can be ignored if the server was otherwise able to find its configuration file.</p> <p>The value of this key is the <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> directory which contains the <code>conf</code> subdirectory. When Apache starts it reads the <code>httpd.conf</code> file from that directory. If this file contains a <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> directive which contains a different directory from the one obtained from the registry key above, Apache will forget the registry key and use the directory from the configuration file. If you copy the Apache directory or configuration files to a new location it is vital that you update the <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> directive in the <code>httpd.conf</code> file to reflect the new location.</p>   <h2 id=\"test\">Testing the Installation</h2> <p>After starting Apache (either in a console window or as a service) it will be listening on port 80 (unless you changed the <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> directive in the configuration files or installed Apache only for the current user). To connect to the server and access the default page, launch a browser and enter this URL:</p> <div class=\"example\"><code>http://localhost/</code></div> <p>Apache should respond with a welcome page and you should see \"It Works!\". If nothing happens or you get an error, look in the <code>error.log</code> file in the <code>logs</code> subdirectory. If your host is not connected to the net, or if you have serious problems with your DNS (Domain Name Service) configuration, you may have to use this URL:</p> <div class=\"example\"><code>http://127.0.0.1/</code></div> <p>If you happen to be running Apache on an alternate port, you need to explicitly put that in the URL:</p> <div class=\"example\"><code>http://127.0.0.1:8080/</code></div> <p>Once your basic installation is working, you should configure it properly by editing the files in the <code>conf</code> subdirectory. Again, if you change the configuration of the Windows NT service for Apache, first attempt to start it from the command line to make sure that the service starts with no errors.</p> <p>Because Apache <strong>cannot</strong> share the same port with another TCP/IP application, you may need to stop, uninstall or reconfigure certain other services before running Apache. These conflicting services include other WWW servers, some firewall implementations, and even some client applications (such as Skype) which will use port 80 to attempt to bypass firewall issues.</p>   <h2 id=\"windrivemap\">Configuring Access to Network Resources</h2> <p>Access to files over the network can be specified using two mechanisms provided by Windows:</p> <dl> <dt>Mapped drive letters</dt> <dd>e.g., <code>Alias \"/images/\" \"Z:/\"</code>\n</dd> <dt>UNC paths</dt> <dd>e.g., <code>Alias \"/images/\" \"//imagehost/www/images/\"</code>\n</dd> </dl> <p>Mapped drive letters allow the administrator to maintain the mapping to a specific machine and path outside of the Apache httpd configuration. However, these mappings are associated only with interactive sessions and are not directly available to Apache httpd when it is started as a service. <strong>Use only UNC paths for network resources in httpd.conf</strong> so that the resources can be accessed consistently regardless of how Apache httpd is started. (Arcane and error prone procedures may work around the restriction on mapped drive letters, but this is not recommended.)</p> <div class=\"example\">\n<h3>Example DocumentRoot with UNC path</h3>\n<pre class=\"prettyprint lang-config\">DocumentRoot \"//dochost/www/html/\"</pre> </div> <div class=\"example\">\n<h3>Example DocumentRoot with IP address in UNC path</h3>\n<pre class=\"prettyprint lang-config\">DocumentRoot \"//192.168.1.50/docs/\"</pre> </div> <div class=\"example\">\n<h3>Example Alias and corresponding Directory with UNC path</h3>\n<pre class=\"prettyprint lang-config\">Alias \"/images/\" \"//imagehost/www/images/\"\n\n&lt;Directory \"//imagehost/www/images/\"&gt;\n#...\n&lt;Directory&gt;</pre> </div> <p>When running Apache httpd as a service, you must create a separate account in order to access network resources, as described above.</p>   <h2 id=\"tuning\">Windows Tuning</h2> <ul> <li><p>If more than a few dozen piped loggers are used on an operating system instance, scaling up the \"desktop heap\" is often necessary. For more detailed information, refer to the <a href=\"../logs#piped\">piped logging</a> documentation.</p></li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/platform/windows.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/platform/windows.html</a>\n  </p>\n</div>\n","platform/netware":"<h1>Using Apache With Novell NetWare</h1>  <p>This document explains how to install, configure and run Apache 2.0 under Novell NetWare 6.0 and above. If you find any bugs, or wish to contribute in other ways, please use our <a href=\"http://httpd.apache.org/bug_report.html\">bug reporting page.</a></p> <p>The bug reporting page and dev-httpd mailing list are <em>not</em> provided to answer questions about configuration or running Apache. Before you submit a bug report or request, first consult this document, the <a href=\"http://wiki.apache.org/httpd/FAQ\">Frequently Asked Questions</a> page and the other relevant documentation topics. If you still have a question or problem, post it to the <a href=\"news://developer-forums.novell.com/novell.devsup.webserver\"> novell.devsup.webserver</a> newsgroup, where many Apache users are more than willing to answer new and obscure questions about using Apache on NetWare.</p> <p>Most of this document assumes that you are installing Apache from a binary distribution. If you want to compile Apache yourself (possibly to help with development, or to track down bugs), see the section on <a href=\"#comp\">Compiling Apache for NetWare</a> below.</p>     <h2 id=\"req\">Requirements</h2> <p>Apache 2.0 is designed to run on NetWare 6.0 service pack 3 and above. If you are running a service pack less than SP3, you must install the latest <a href=\"http://developer.novell.com/ndk/libc.htm\">NetWare Libraries for C (LibC)</a>.</p> <p>NetWare service packs are available <a href=\"http://support.novell.com/misc/patlst.htm#nw\">here</a>.</p> <p>Apache 2.0 for NetWare can also be run in a NetWare 5.1 environment as long as the latest service pack or the latest version of the <a href=\"http://developer.novell.com/ndk/libc.htm\">NetWare Libraries for C (LibC)</a> has been installed . <strong>WARNING:</strong> Apache 2.0 for NetWare has not been targeted for or tested in this environment.</p>   <h2 id=\"down\">Downloading Apache for NetWare</h2> <p>Information on the latest version of Apache can be found on the Apache web server at <a href=\"http://www.apache.org/\">http://www.apache.org/</a>. This will list the current release, any more recent alpha or beta-test releases, together with details of mirror web and anonymous ftp sites. Binary builds of the latest releases of Apache 2.0 for NetWare can be downloaded from <a href=\"http://www.apache.org/dist/httpd/binaries/netware\">here</a>.</p>   <h2 id=\"inst\">Installing Apache for NetWare</h2> <p>There is no Apache install program for NetWare currently. If you are building Apache 2.0 for NetWare from source, you will need to copy the files over to the server manually.</p> <p>Follow these steps to install Apache on NetWare from the binary download (assuming you will install to <code>sys:/apache2</code>):</p> <ul> <li>Unzip the binary download file to the root of the <code>SYS:</code> volume (may be installed to any volume)</li> <li>Edit the <code>httpd.conf</code> file setting <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> and <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> along with any file path values to reflect your correct server settings</li> <li>Add <code>SYS:/APACHE2</code> to the search path, for example: <div class=\"example\"><pre>SEARCH ADD SYS:\\APACHE2</pre></div> </li> </ul> <p>Follow these steps to install Apache on NetWare manually from your own build source (assuming you will install to <code>sys:/apache2</code>):</p> <ul> <li>Create a directory called <code>Apache2</code> on a NetWare volume</li> <li>Copy <code>APACHE2.NLM</code>, <code>APRLIB.NLM</code> to <code>SYS:/APACHE2</code>\n</li> <li>Create a directory under <code>SYS:/APACHE2</code> called <code>BIN</code>\n</li> <li>Copy <code>HTDIGEST.NLM</code>, <code>HTPASSWD.NLM</code>, <code>HTDBM.NLM</code>, <code>LOGRES.NLM</code>, <code>ROTLOGS.NLM</code> to <code>SYS:/APACHE2/BIN</code>\n</li> <li>Create a directory under <code>SYS:/APACHE2</code> called <code>CONF</code>\n</li> <li>Copy the <code>HTTPD-STD.CONF</code> file to the <code>SYS:/APACHE2/CONF</code> directory and rename to <code>HTTPD.CONF</code>\n</li> <li>Copy the <code>MIME.TYPES</code>, <code>CHARSET.CONV</code> and <code>MAGIC</code> files to <code>SYS:/APACHE2/CONF</code> directory</li> <li>Copy all files and subdirectories in <code>\\HTTPD-2.0\\DOCS\\ICONS</code> to <code>SYS:/APACHE2/ICONS</code>\n</li> <li>Copy all files and subdirectories in <code>\\HTTPD-2.0\\DOCS\\MANUAL</code> to <code>SYS:/APACHE2/MANUAL</code>\n</li> <li>Copy all files and subdirectories in <code>\\HTTPD-2.0\\DOCS\\ERROR</code> to <code>SYS:/APACHE2/ERROR</code>\n</li> <li>Copy all files and subdirectories in <code>\\HTTPD-2.0\\DOCS\\DOCROOT</code> to <code>SYS:/APACHE2/HTDOCS</code>\n</li> <li>Create the directory <code>SYS:/APACHE2/LOGS</code> on the server</li> <li>Create the directory <code>SYS:/APACHE2/CGI-BIN</code> on the server</li> <li>Create the directory <code>SYS:/APACHE2/MODULES</code> and copy all nlm modules into the <code>modules</code> directory</li> <li>Edit the <code>HTTPD.CONF</code> file searching for all <code>@@Value@@</code> markers and replacing them with the appropriate setting</li> <li>Add <code>SYS:/APACHE2</code> to the search path, for example: <div class=\"example\"><pre>SEARCH ADD SYS:\\APACHE2</pre></div> </li> </ul> <p>Apache may be installed to other volumes besides the default <code>SYS</code> volume.</p> <p>During the build process, adding the keyword \"install\" to the makefile command line will automatically produce a complete distribution package under the subdirectory <code>DIST</code>. Install Apache by simply copying the distribution that was produced by the makfiles to the root of a NetWare volume (see: <a href=\"#comp\">Compiling Apache for NetWare</a> below).</p>   <h2 id=\"run\">Running Apache for NetWare</h2> <p>To start Apache just type <code>apache</code> at the console. This will load apache in the OS address space. If you prefer to load Apache in a protected address space you may specify the address space with the load statement as follows:</p> <div class=\"example\"><pre>load address space = apache2 apache2</pre></div> <p>This will load Apache into an address space called apache2. Running multiple instances of Apache concurrently on NetWare is possible by loading each instance into its own protected address space.</p> <p>After starting Apache, it will be listening to port 80 (unless you changed the <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> directive in the configuration files). To connect to the server and access the default page, launch a browser and enter the server's name or address. This should respond with a welcome page, and a link to the Apache manual. If nothing happens or you get an error, look in the <code>error_log</code> file in the <code>logs</code> directory.</p> <p>Once your basic installation is working, you should configure it properly by editing the files in the <code>conf</code> directory.</p> <p>To unload Apache running in the OS address space just type the following at the console:</p> <div class=\"example\"><pre>unload apache2</pre></div> <p>or</p> <div class=\"example\"><pre>apache2 shutdown</pre></div> <p>If apache is running in a protected address space specify the address space in the unload statement:</p> <div class=\"example\"><pre>unload address space = apache2 apache2</pre></div> <p>When working with Apache it is important to know how it will find the configuration files. You can specify a configuration file on the command line in two ways:</p> <ul> <li>\n<code>-f</code> specifies a path to a particular configuration file</li> </ul> <div class=\"example\"><pre>apache2 -f \"vol:/my server/conf/my.conf\"</pre></div> <div class=\"example\"><pre>apache -f test/test.conf</pre></div> <p>In these cases, the proper <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> should be set in the configuration file.</p> <p>If you don't specify a configuration file name with <code>-f</code>, Apache will use the file name compiled into the server, usually <code>conf/httpd.conf</code>. Invoking Apache with the <code>-V</code> switch will display this value labeled as <code>SERVER_CONFIG_FILE</code>. Apache will then determine its <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> by trying the following, in this order:</p> <ul> <li>A <code>ServerRoot</code> directive via a <code>-C</code> switch.</li> <li>The <code>-d</code> switch on the command line.</li> <li>Current working directory</li> <li>The server root compiled into the server.</li> </ul> <p>The server root compiled into the server is usually <code>sys:/apache2</code>. invoking apache with the <code>-V</code> switch will display this value labeled as <code>HTTPD_ROOT</code>.</p> <p>Apache 2.0 for NetWare includes a set of command line directives that can be used to modify or display information about the running instance of the web server. These directives are only available while Apache is running. Each of these directives must be preceded by the keyword <code>APACHE2</code>.</p> <dl> <dt>RESTART</dt> <dd>Instructs Apache to terminate all running worker threads as they become idle, reread the configuration file and restart each worker thread based on the new configuration.</dd> <dt>VERSION</dt> <dd>Displays version information about the currently running instance of Apache.</dd> <dt>MODULES</dt> <dd>Displays a list of loaded modules both built-in and external.</dd> <dt>DIRECTIVES</dt> <dd>Displays a list of all available directives.</dd> <dt>SETTINGS</dt> <dd>Enables or disables the thread status display on the console. When enabled, the state of each running threads is displayed on the Apache console screen.</dd> <dt>SHUTDOWN</dt> <dd>Terminates the running instance of the Apache web server.</dd> <dt>HELP</dt> <dd>Describes each of the runtime directives.</dd> </dl> <p>By default these directives are issued against the instance of Apache running in the OS address space. To issue a directive against a specific instance running in a protected address space, include the -p parameter along with the name of the address space. For more information type \"apache2 Help\" on the command line.</p>   <h2 id=\"use\">Configuring Apache for NetWare</h2> <p>Apache is configured by reading configuration files usually stored in the <code>conf</code> directory. These are the same as files used to configure the Unix version, but there are a few different directives for Apache on NetWare. See the <a href=\"../mod/index\">Apache module documentation</a> for all the available directives.</p> <p>The main differences in Apache for NetWare are:</p> <ul> <li> <p>Because Apache for NetWare is multithreaded, it does not use a separate process for each request, as Apache does on some Unix implementations. Instead there are only threads running: a parent thread, and multiple child or worker threads which handle the requests.</p> <p>Therefore the \"process\"-management directives are different:</p> <p><code class=\"directive\"><a href=\"../mod/mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code> - Like the Unix directive, this controls how many connections a worker thread will serve before exiting. The recommended default, <code>MaxConnectionsPerChild 0</code>, causes the thread to continue servicing request indefinitely. It is recommended on NetWare, unless there is some specific reason, that this directive always remain set to <code>0</code>.</p> <p><code class=\"directive\"><a href=\"../mod/mpm_common#startthreads\">StartThreads</a></code> - This directive tells the server how many threads it should start initially. The recommended default is <code>StartThreads 50</code>.</p> <p><code class=\"directive\"><a href=\"../mod/mpm_common#minsparethreads\">MinSpareThreads</a></code> - This directive instructs the server to spawn additional worker threads if the number of idle threads ever falls below this value. The recommended default is <code>MinSpareThreads 10</code>.</p> <p><code class=\"directive\"><a href=\"../mod/mpm_common#maxsparethreads\">MaxSpareThreads</a></code> - This directive instructs the server to begin terminating worker threads if the number of idle threads ever exceeds this value. The recommended default is <code>MaxSpareThreads 100</code>.</p> <p><code class=\"directive\"><a href=\"../mod/mpm_netware#maxthreads\">MaxThreads</a></code> - This directive limits the total number of work threads to a maximum value. The recommended default is <code>ThreadsPerChild 250</code>.</p> <p><code class=\"directive\"><a href=\"../mod/mpm_common#threadstacksize\">ThreadStackSize</a></code> - This directive tells the server what size of stack to use for the individual worker thread. The recommended default is <code>ThreadStackSize 65536</code>.</p> </li> <li> <p>The directives that accept filenames as arguments must use NetWare filenames instead of Unix names. However, because Apache uses Unix-style names internally, forward slashes must be used rather than backslashes. It is recommended that all rooted file paths begin with a volume name. If omitted, Apache will assume the <code>SYS:</code> volume which may not be correct.</p> </li> <li> <p>Apache for NetWare has the ability to load modules at runtime, without recompiling the server. If Apache is compiled normally, it will install a number of optional modules in the <code>\\Apache2\\modules</code> directory. To activate these, or other modules, the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive must be used. For example, to active the status module, use the following:</p> <div class=\"example\"><pre>LoadModule status_module modules/status.nlm</pre></div> <p>Information on <a href=\"../mod/mod_so#creating\">creating loadable modules</a> is also available.</p> </li> </ul> <h3><a name=\"use-add\" id=\"use-add\">Additional NetWare specific directives:</a></h3> <ul> <li>\n<code class=\"directive\"><a href=\"../mod/core#cgimapextension\">CGIMapExtension</a></code> - This directive maps a CGI file extension to a script interpreter.</li> </ul> <ul> <li>\n<code class=\"directive\"><a href=\"../mod/mod_nw_ssl#securelisten\">SecureListen</a></code> - Enables SSL encryption for a specified port.</li> </ul> <ul> <li>\n<code class=\"directive\"><a href=\"../mod/mod_nw_ssl#nwssltrustedcerts\">NWSSLTrustedCerts</a></code> - Adds trusted certificates that are used to create secure connections to proxied servers.</li> </ul> <ul> <li>\n<code class=\"directive\"><a href=\"../mod/mod_nw_ssl#nwsslupgradeable\">NWSSLUpgradeable</a></code> - Allow a connection created on the specified address/port to be upgraded to an SSL connection.</li> </ul>   <h2 id=\"comp\">Compiling Apache for NetWare</h2> <p>Compiling Apache requires MetroWerks CodeWarrior 6.x or higher. Once Apache has been built, it can be installed to the root of any NetWare volume. The default is the <code>sys:/Apache2</code> directory.</p> <p>Before running the server you must fill out the <code>conf</code> directory. Copy the file <code>HTTPD-STD.CONF</code> from the distribution <code>conf</code> directory and rename it to <code>HTTPD.CONF</code>. Edit the <code>HTTPD.CONF</code> file searching for all <code>@@Value@@</code> markers and replacing them with the appropriate setting. Copy over the <code>conf/magic</code> and <code>conf/mime.types</code> files as well. Alternatively, a complete distribution can be built by including the keyword <code>install</code> when invoking the makefiles.</p> <h3><a name=\"comp-req\" id=\"comp-req\">Requirements:</a></h3> <p>The following development tools are required to build Apache 2.0 for NetWare:</p> <ul> <li>Metrowerks CodeWarrior 6.0 or higher with the <a href=\"http://developer.novell.com/ndk/cwpdk.htm\">NetWare PDK 3.0</a> or higher.</li> <li><a href=\"http://developer.novell.com/ndk/libc.htm\">NetWare Libraries for C (LibC)</a></li> <li><a href=\"http://developer.novell.com/ndk/cldap.htm\">LDAP Libraries for C</a></li> <li><a href=\"http://www.gzip.org/zlib/\">ZLIB Compression Library source code</a></li> <li>AWK utility (awk, gawk or similar). AWK can be downloaded from <a href=\"http://developer.novell.com/ndk/apache.htm\">http://developer.novell.com/ndk/apache.htm</a>. The utility must be found in your windows path and must be named <code>awk.exe</code>.</li> <li>To build using the makefiles, you will need GNU make version 3.78.1 (GMake) available at <a href=\"http://developer.novell.com/ndk/apache.htm\">http://developer.novell.com/ndk/apache.htm</a>.</li> </ul> <h3><a name=\"comp-make\" id=\"comp-make\">Building Apache using the NetWare makefiles:</a></h3> <ul> <li>Set the environment variable <code>NOVELLLIBC</code> to the location of the NetWare Libraries for C SDK, for example: <div class=\"example\"><pre>Set NOVELLLIBC=c:\\novell\\ndk\\libc</pre></div> </li> <li>Set the environment variable <code>METROWERKS</code> to the location where you installed the Metrowerks CodeWarrior compiler, for example: <div class=\"example\"><pre>Set METROWERKS=C:\\Program Files\\Metrowerks\\CodeWarrior</pre></div> If you installed to the default location <code>C:\\Program Files\\Metrowerks\\CodeWarrior</code>, you don't need to set this.</li> <li>Set the environment variable <code>LDAPSDK</code> to the location where you installed the LDAP Libraries for C, for example: <div class=\"example\"><pre>Set LDAPSDK=c:\\Novell\\NDK\\cldapsdk\\NetWare\\libc</pre></div> </li> <li>Set the environment variable <code>ZLIBSDK</code> to the location where you installed the source code for the ZLib Library, for example: <div class=\"example\"><pre>Set ZLIBSDK=D:\\NOVELL\\zlib</pre></div> </li> <li>Set the environment variable <code>PCRESDK</code> to the location where you installed the source code for the PCRE Library, for example: <div class=\"example\"><pre>Set PCRESDK=D:\\NOVELL\\pcre</pre></div> </li> <li>Set the environment variable <code>AP_WORK</code> to the full path of the <code>httpd</code> source code directory. <div class=\"example\"><pre>Set AP_WORK=D:\\httpd-2.0.x</pre></div> </li> <li>Set the environment variable <code>APR_WORK</code> to the full path of the <code>apr</code> source code directory. Typically <code>\\httpd\\srclib\\apr</code> but the APR project can be outside of the httpd directory structure. <div class=\"example\"><pre>Set APR_WORK=D:\\apr-1.x.x</pre></div> </li> <li>Set the environment variable <code>APU_WORK</code> to the full path of the <code>apr-util</code> source code directory. Typically <code>\\httpd\\srclib\\apr-util</code> but the APR-UTIL project can be outside of the httpd directory structure. <div class=\"example\"><pre>Set APU_WORK=D:\\apr-util-1.x.x</pre></div> </li> <li>Make sure that the path to the AWK utility and the GNU make utility (<code>gmake.exe</code>) have been included in the system's <code>PATH</code> environment variable.</li> <li>Download the source code and unzip to an appropriate directory on your workstation.</li> <li>Change directory to <code>\\httpd-2.0</code> and build the prebuild utilities by running \"<code>gmake -f nwgnumakefile prebuild</code>\". This target will create the directory <code>\\httpd-2.0\\nwprebuild</code> and copy each of the utilities to this location that are necessary to complete the following build steps. </li> <li>Copy the files <code>\\httpd-2.0\\nwprebuild\\GENCHARS.nlm</code> and <code>\\httpd-2.0\\nwprebuild\\DFTABLES.nlm</code> to the <code>SYS:</code> volume of a NetWare server and run them using the following commands: <div class=\"example\"><pre>SYS:\\genchars &gt; sys:\\test_char.h\nSYS:\\dftables sys:\\chartables.c</pre></div> </li> <li>Copy the files <code>test_char.h</code> and <code>chartables.c</code> to the directory <code>\\httpd-2.0\\os\\netware</code> on the build machine.</li> <li>Change directory to <code>\\httpd-2.0</code> and build Apache by running \"<code>gmake -f nwgnumakefile</code>\". You can create a distribution directory by adding an install parameter to the command, for example: <div class=\"example\"><pre>gmake -f nwgnumakefile install</pre></div> </li> </ul> <h3><a name=\"comp-add\" id=\"comp-add\">Additional make options</a></h3> <ul> <li>\n<code>gmake -f nwgnumakefile</code><p>Builds release versions of all of the binaries and copies them to a <code>\\release</code> destination directory.</p>\n</li> <li>\n<code>gmake -f nwgnumakefile DEBUG=1</code><p>Builds debug versions of all of the binaries and copies them to a <code>\\debug</code> destination directory.</p>\n</li> <li>\n<code>gmake -f nwgnumakefile install</code><p>Creates a complete Apache distribution with binaries, docs and additional support files in a <code>\\dist\\Apache2</code> directory.</p>\n</li> <li>\n<code>gmake -f nwgnumakefile prebuild</code><p>Builds all of the prebuild utilities and copies them to the <code>\\nwprebuild</code> directory.</p>\n</li> <li>\n<code>gmake -f nwgnumakefile installdev</code><p>Same as install but also creates a <code>\\lib</code> and <code>\\include</code> directory in the destination directory and copies headers and import files.</p>\n</li> <li>\n<code>gmake -f nwgnumakefile clean</code><p>Cleans all object files and binaries from the <code>\\release.o</code> or <code>\\debug.o</code> build areas depending on whether <code>DEBUG</code> has been defined.</p>\n</li> <li>\n<code>gmake -f nwgnumakefile clobber_all</code><p>Same as clean and also deletes the distribution directory if it exists.</p>\n</li> </ul> <h3><a name=\"comp-add-env\" id=\"comp-add-env\">Additional environment variable options</a></h3> <ul> <li>To build all of the experimental modules, set the environment variable <code>EXPERIMENTAL</code>: <div class=\"example\"><pre>Set EXPERIMENTAL=1</pre></div> </li> <li>To build Apache using standard BSD style sockets rather than Winsock, set the environment variable <code>USE_STDSOCKETS</code>: <div class=\"example\"><pre>Set USE_STDSOCKETS=1</pre></div> </li> </ul> <h3><a name=\"comp-mod_ssl\" id=\"comp-mod_ssl\">Building mod_ssl for the NetWare platform</a></h3> <p>By default Apache for NetWare uses the built-in module <code class=\"module\"><a href=\"../mod/mod_nw_ssl\">mod_nw_ssl</a></code> to provide SSL services. This module simply enables the native SSL services implemented in NetWare OS to handle all encryption for a given port. Alternatively, mod_ssl can also be used in the same manner as on other platforms.</p> <p>Before mod_ssl can be built for the NetWare platform, the OpenSSL libraries must be provided. This can be done through the following steps:</p> <ul> <li>Download the recent OpenSSL 0.9.8 release source code from the <a href=\"http://www.openssl.org/source/\">OpenSSL Source</a> page (older 0.9.7 versions need to be patched and are therefore not recommended).</li> <li>Edit the file <code>NetWare/set_env.bat</code> and modify any tools and utilities paths so that they correspond to your build environment.</li> <li>From the root of the OpenSSL source directory, run the following scripts: <div class=\"example\"><pre>Netware\\set_env netware-libc\nNetware\\build netware-libc</pre></div> For performance reasons you should enable to build with ASM code. Download NASM from the <a href=\"http://nasm.sourceforge.net/\">SF site</a>. Then configure OpenSSL to use ASM code: <div class=\"example\"><pre>Netware\\build netware-libc nw-nasm enable-mdc2 enable-md5</pre></div> Warning: dont use the CodeWarrior Assembler - it produces broken code! </li> <li>Before building Apache, set the environment variable <code>OSSLSDK</code> to the full path to the root of the openssl source code directory, and set WITH_MOD_SSL to 1. <div class=\"example\"><pre>Set OSSLSDK=d:\\openssl-0.9.8x\nSet WITH_MOD_SSL=1</pre></div>\n</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/platform/netware.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/platform/netware.html</a>\n  </p>\n</div>\n","platform/ebcdic":"<h1>The Apache EBCDIC Port</h1>  <div class=\"warning\">\n<strong>Warning:</strong> This document has not been updated to take into account changes made in the 2.0 version of the Apache HTTP Server. Some of the information may still be relevant, but please use it with care. </div>     <h2 id=\"overview\">Overview of the Apache EBCDIC Port</h2> <p>Version 1.3 of the Apache HTTP Server was the first version which included a port to a (non-ASCII) mainframe machine which uses the EBCDIC character set as its native codeset.</p> <p>(It is the SIEMENS family of mainframes running the <a href=\"http://www.siemens.de/servers/bs2osd/osdbc_us.htm\">BS2000/OSD operating system</a>. This mainframe OS nowadays features a SVR4-derived POSIX subsystem).</p> <p>The port was started initially to</p> <ul> <li>prove the feasibility of porting <a href=\"http://httpd.apache.org/\">the Apache HTTP server</a> to this platform</li> <li>find a \"worthy and capable\" successor for the venerable <a href=\"http://www.w3.org/Daemon/\">CERN-3.0</a> daemon (which was ported a couple of years ago), and to</li> <li>prove that Apache's preforking process model can on this platform easily outperform the accept-fork-serve model used by CERN by a factor of 5 or more.</li> </ul> <p>This document serves as a rationale to describe some of the design decisions of the port to this machine.</p>   <h2 id=\"design\">Design Goals</h2> <p>One objective of the EBCDIC port was to maintain enough backwards compatibility with the (EBCDIC) CERN server to make the transition to the new server attractive and easy. This required the addition of a configurable method to define whether a HTML document was stored in ASCII (the only format accepted by the old server) or in EBCDIC (the native document format in the POSIX subsystem, and therefore the only realistic format in which the other POSIX tools like <code>grep</code> or <code>sed</code> could operate on the documents). The current solution to this is a \"pseudo-MIME-format\" which is intercepted and interpreted by the Apache server (see below). Future versions might solve the problem by defining an \"ebcdic-handler\" for all documents which must be converted.</p>   <h2 id=\"technical\">Technical Solution</h2> <p>Since all Apache input and output is based upon the BUFF data type and its methods, the easiest solution was to add the conversion to the BUFF handling routines. The conversion must be settable at any time, so a BUFF flag was added which defines whether a BUFF object has currently enabled conversion or not. This flag is modified at several points in the HTTP protocol:</p> <ul> <li>\n<strong>set</strong> before a request is received (because the request and the request header lines are always in ASCII format)</li> <li>\n<strong>set/unset</strong> when the request body is received - depending on the content type of the request body (because the request body may contain ASCII text or a binary file)</li> <li>\n<strong>set</strong> before a reply header is sent (because the response header lines are always in ASCII format)</li> <li>\n<strong>set/unset</strong> when the response body is sent - depending on the content type of the response body (because the response body may contain text or a binary file)</li> </ul>   <h2 id=\"porting\">Porting Notes</h2> <ol> <li> <p>The relevant changes in the source are <code>#ifdef</code>'ed into two categories:</p> <dl> <dt><code>#ifdef CHARSET_EBCDIC</code></dt> <dd> <p>Code which is needed for any EBCDIC based machine. This includes character translations, differences in contiguity of the two character sets, flags which indicate which part of the HTTP protocol has to be converted and which part doesn't <em>etc.</em></p> </dd> <dt><code>#ifdef _OSD_POSIX</code></dt> <dd> <p>Code which is needed for the SIEMENS BS2000/OSD mainframe platform only. This deals with include file differences and socket implementation topics which are only required on the BS2000/OSD platform.</p> </dd> </dl> </li> <li> <p>The possibility to translate between ASCII and EBCDIC at the socket level (on BS2000 POSIX, there is a socket option which supports this) was intentionally <em>not</em> chosen, because the byte stream at the HTTP protocol level consists of a mixture of protocol related strings and non-protocol related raw file data. HTTP protocol strings are always encoded in ASCII (the <code>GET</code> request, any Header: lines, the chunking information <em>etc.</em>) whereas the file transfer parts (<em>i.e.</em>, GIF images, CGI output <em>etc.</em>) should usually be just \"passed through\" by the server. This separation between \"protocol string\" and \"raw data\" is reflected in the server code by functions like <code>bgets()</code> or <code>rvputs()</code> for strings, and functions like <code>bwrite()</code> for binary data. A global translation of everything would therefore be inadequate.</p> <p>(In the case of text files of course, provisions must be made so that EBCDIC documents are always served in ASCII)</p> </li> <li> <p>This port therefore features a built-in protocol level conversion for the server-internal strings (which the compiler translated to EBCDIC strings) and thus for all server-generated documents. The hard coded ASCII escapes <code>\\012</code> and <code>\\015</code> which are ubiquitous in the server code are an exception: they are already the binary encoding of the ASCII <code>\\n</code> and <code>\\r</code> and must not be converted to ASCII a second time. This exception is only relevant for server-generated strings; and <em>external</em> EBCDIC documents are not expected to contain ASCII newline characters.</p> </li> <li> <p>By examining the call hierarchy for the BUFF management routines, I added an \"ebcdic/ascii conversion layer\" which would be crossed on every puts/write/get/gets, and a conversion flag which allowed enabling/disabling the conversions on-the-fly. Usually, a document crosses this layer twice from its origin source (a file or CGI output) to its destination (the requesting client): <code>file -&gt; Apache</code>, and <code>Apache -&gt; client</code>.</p> <p>The server can now read the header lines of a CGI-script output in EBCDIC format, and then find out that the remainder of the script's output is in ASCII (like in the case of the output of a WWW Counter program: the document body contains a GIF image). All header processing is done in the native EBCDIC format; the server then determines, based on the type of document being served, whether the document body (except for the chunking information, of course) is in ASCII already or must be converted from EBCDIC.</p> </li> <li> <p>For Text documents (MIME types text/plain, text/html <em>etc.</em>), an implicit translation to ASCII can be used, or (if the users prefer to store some documents in raw ASCII form for faster serving, or because the files reside on a NFS-mounted directory tree) can be served without conversion.</p> <p><strong>Example:</strong></p> <p>to serve files with the suffix <code>.ahtml</code> as a raw ASCII <code>text/html</code> document without implicit conversion (and suffix <code>.ascii</code> as ASCII <code>text/plain</code>), use the directives:</p> <div class=\"example\"><pre>AddType text/x-ascii-html .ahtml \nAddType text/x-ascii-plain .ascii</pre></div> <p>Similarly, any <code>text/foo</code> MIME type can be served as \"raw ASCII\" by configuring a MIME type \"<code>text/x-ascii-foo</code>\" for it using <code>AddType</code>.</p> </li> <li> <p>Non-text documents are always served \"binary\" without conversion. This seems to be the most sensible choice for, .<em>e.g.</em>, GIF/ZIP/AU file types. This of course requires the user to copy them to the mainframe host using the \"<code>rcp -b</code>\" binary switch.</p> </li> <li> <p>Server parsed files are always assumed to be in native (<em>i.e.</em>, EBCDIC) format as used on the machine, and are converted after processing.</p> </li> <li> <p>For CGI output, the CGI script determines whether a conversion is needed or not: by setting the appropriate Content-Type, text files can be converted, or GIF output can be passed through unmodified. An example for the latter case is the wwwcount program which we ported as well.</p> </li> </ol>   <h2 id=\"document\">Document Storage Notes</h2> <h3><a name=\"binary\" id=\"binary\">Binary Files</a></h3> <p>All files with a <code>Content-Type:</code> which does not start with <code>text/</code> are regarded as <em>binary files</em> by the server and are not subject to any conversion. Examples for binary files are GIF images, gzip-compressed files and the like.</p> <p>When exchanging binary files between the mainframe host and a Unix machine or Windows PC, be sure to use the ftp \"binary\" (<code>TYPE I</code>) command, or use the <code>rcp -b</code> command from the mainframe host (the <code>-b</code> switch is not supported in unix <code>rcp</code>'s).</p> <h3><a name=\"text\" id=\"text\">Text Documents</a></h3> <p>The default assumption of the server is that Text Files (<em>i.e.</em>, all files whose <code>Content-Type:</code> starts with <code>text/</code>) are stored in the native character set of the host, EBCDIC.</p> <h3><a name=\"ssi\" id=\"ssi\">Server Side Included Documents</a></h3> <p>SSI documents must currently be stored in EBCDIC only. No provision is made to convert it from ASCII before processing.</p>   <h2 id=\"modules\">Apache Modules' Status</h2> <table class=\"bordered\"> <tr> <th>Module</th> <th>Status</th> <th>Notes</th> </tr> <tr> <td><code class=\"module\">core</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_access</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_actions</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_alias</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_asis</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_auth</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_authn_anon</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_authn_dbm</code></td> <td class=\"centered\">?</td> <td>with own <code>libdb.a</code>\n</td> </tr> <tr> <td><code class=\"module\">mod_authz_dbm</code></td> <td class=\"centered\">?</td> <td>with own <code>libdb.a</code>\n</td> </tr> <tr> <td><code class=\"module\">mod_autoindex</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_cern_meta</code></td> <td class=\"centered\">?</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_cgi</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code>mod_digest</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_dir</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_so</code></td> <td class=\"centered\">-</td> <td>no shared libs</td> </tr> <tr> <td><code class=\"module\">mod_env</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_example</code></td> <td class=\"centered\">-</td> <td>(test bed only)</td> </tr> <tr> <td><code class=\"module\">mod_expires</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_headers</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_imagemap</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_include</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_info</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code>mod_log_agent</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code>mod_log_config</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_log_referer</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_mime</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_mime_magic</code></td> <td class=\"centered\">?</td> <td>not ported yet</td> </tr> <tr> <td><code class=\"module\">mod_negotiation</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_proxy</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_rewrite</code></td> <td class=\"centered\">+</td> <td>untested</td> </tr> <tr> <td><code class=\"module\">mod_setenvif</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_speling</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_status</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_unique_id</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_userdir</code></td> <td class=\"centered\">+</td> <td></td> </tr> <tr> <td><code class=\"module\">mod_usertrack</code></td> <td class=\"centered\">?</td> <td>untested</td> </tr> </table>   <h2 id=\"third-party\">Third Party Modules' Status</h2> <table class=\"bordered\"> <tr> <th>Module</th> <th>Status</th> <th>Notes</th> </tr> <tr> <td><pre>JK (Formerly mod_jserv)</pre></td> <td class=\"centered\">-</td> <td>JAVA still being ported.</td> </tr> <tr> <td><code>mod_php3</code></td> <td class=\"centered\">+</td> <td>\n<code>mod_php3</code> runs fine, with LDAP and GD and FreeType libraries.</td> </tr> <tr> <td><code>mod_put</code></td> <td class=\"centered\">?</td> <td>untested</td> </tr> <tr> <td><code>mod_session</code></td> <td class=\"centered\">-</td> <td>untested</td> </tr> </table><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/platform/ebcdic.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/platform/ebcdic.html</a>\n  </p>\n</div>\n","platform/win_compiling":"<h1>Compiling Apache for Microsoft Windows</h1>  <p>There are many important points to consider before you begin compiling Apache HTTP Server (httpd). See <a href=\"windows\">Using Apache HTTP Server on Microsoft Windows</a> before you begin.</p> <p>httpd can be built on Windows using a cmake-based build system or with Visual Studio project files maintained by httpd developers. The cmake-based build system directly supports more versions of Visual Studio but currently has considerable functional limitations.</p>     <h2 id=\"vstudio\">Building httpd with the included Visual Studio project files</h2> <h3><a name=\"requirements\" id=\"requirements\">Requirements</a></h3> <p>Compiling Apache requires the following environment to be properly installed:</p> <ul> <li> <p>Disk Space</p> <p>Make sure you have at least 200 MB of free disk space available. After installation Apache requires approximately 80 MB of disk space, plus space for log and cache files, which can grow rapidly. The actual disk space requirements will vary considerably based on your chosen configuration and any third-party modules or libraries, especially when OpenSSL is also built. Because many files are text and very easily compressed, NTFS filesystem compression cuts these requirements in half.</p> </li> <li> <p>Appropriate Patches</p> <p>The httpd binary is built with the help of several patches to third party packages, which ensure the released code is buildable and debuggable. These patches are available and distributed from <a href=\"http://www.apache.org/dist/httpd/binaries/win32/patches_applied/\">http://www.apache.org/dist/httpd/binaries/win32/patches_applied/</a> and are recommended to be applied to obtain identical results as the \"official\" ASF distributed binaries.</p> </li> <li> <p>Microsoft Visual C++ 6.0 (Visual Studio 97) or later.</p> <p>Apache can be built using the command line tools, or from within the Visual Studio IDE Workbench. The command line build requires the environment to reflect the <code>PATH</code>, <code>INCLUDE</code>, <code>LIB</code> and other variables that can be configured with the <code>vcvars32.bat</code> script.</p> <div class=\"note\">You may want the Visual Studio Processor Pack for your older version of Visual Studio, or a full (not Express) version of newer Visual Studio editions, for the ml.exe assembler. This will allow you to build OpenSSL, if desired, using the more efficient assembly code implementation.</div> <div class=\"note\">Only the Microsoft compiler tool chain is actively supported by the active httpd contributors. Although the project regularly accepts patches to ensure MinGW and other alternative builds work and improve upon them, they are not actively maintained and are often broken in the course of normal development.</div> </li> <li> <p>Updated Microsoft Windows Platform SDK, February 2003 or later.</p> <p>An appropriate Windows Platform SDK is included by default in the full (not express/lite) versions of Visual C++ 7.1 (Visual Studio 2002) and later, these users can ignore these steps unless explicitly choosing a newer or different version of the Platform SDK.</p> <p>To use Visual C++ 6.0 or 7.0 (Studio 2000 .NET), the Platform SDK environment must be prepared using the <code>setenv.bat</code> script (installed by the Platform SDK) before starting the command line build or launching the msdev/devenv GUI environment. Installing the Platform SDK for Visual Studio Express versions (2003 and later) should adjust the default environment appropriately.</p> <div class=\"example\"><pre>\"c:\\Program Files\\Microsoft Visual Studio\\VC98\\Bin\\VCVARS32\"\n\"c:\\Program Files\\Platform SDK\\setenv.bat\"</pre></div> </li> <li> <p>Perl and awk</p> <p>Several steps recommended here require a perl interpreter during the build preparation process, but it is otherwise not required.</p> <p>To install Apache within the build system, several files are modified using the <code>awk.exe</code> utility. awk was chosen since it is a very small download (compared with Perl or WSH/VB) and accomplishes the task of modifying configuration files upon installation. Brian Kernighan's <a href=\"http://www.cs.princeton.edu/~bwk/btl.mirror/\">http://www.cs.princeton.edu/~bwk/btl.mirror/</a> site has a compiled native Win32 binary, <a href=\"http://www.cs.princeton.edu/~bwk/btl.mirror/awk95.exe\">http://www.cs.princeton.edu/~bwk/btl.mirror/awk95.exe</a> which you must save with the name <code>awk.exe</code> (rather than <code>awk95.exe</code>).</p> <div class=\"note\">If awk.exe is not found, Makefile.win's install target will not perform substitutions in the installed .conf files. You must manually modify the installed .conf files to allow the server to start. Search and replace all \"@token@\" tags as appropriate.</div> <div class=\"note\">The Visual Studio IDE will only find <code>awk.exe</code> from the PATH, or executable path specified in the menu option Tools -&gt; Options -&gt; (Projects -&gt;) Directories. Ensure awk.exe is in your system path.</div> <div class=\"note\">Also note that if you are using Cygwin tools (<a href=\"http://www.cygwin.com/\">http://www.cygwin.com/</a>) the awk utility is named <code>gawk.exe</code> and that the file <code>awk.exe</code> is really a symlink to the <code>gawk.exe</code> file. The Windows command shell does not recognize symlinks, and because of this building InstallBin will fail. A workaround is to delete <code>awk.exe</code> from the cygwin installation and copy <code>gawk.exe</code> to <code>awk.exe</code>. Also note the cygwin/mingw ports of gawk 3.0.x were buggy, please upgrade to 3.1.x before attempting to use any gawk port.</div> </li> <li> <p>[Optional] zlib library (for <code class=\"module\"><a href=\"../mod/mod_deflate\">mod_deflate</a></code>)</p> <p>Zlib must be installed into a <code>srclib</code> subdirectory named <code>zlib</code>. This must be built in-place. Zlib can be obtained from <a href=\"http://www.zlib.net/\">http://www.zlib.net/</a> -- the <code class=\"module\"><a href=\"../mod/mod_deflate\">mod_deflate</a></code> is confirmed to work correctly with version 1.2.3.</p> <div class=\"example\"><pre>nmake -f win32\\Makefile.msc\nnmake -f win32\\Makefile.msc test</pre></div> </li> <li> <p>[Optional] OpenSSL libraries (for <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> and <code>ab.exe</code> with ssl support)</p> <div class=\"note\">The OpenSSL library is cryptographic software. The country in which you currently reside may have restrictions on the import, possession, use, and/or re-export to another country, of encryption software. BEFORE using any encryption software, please check your country's laws, regulations and policies concerning the import, possession, or use, and re-export of encryption software, to see if this is permitted. See <a href=\"http://www.wassenaar.org/\">http://www.wassenaar.org/</a> for more information.</div> <p>Configuring and building OpenSSL requires perl to be installed.</p> <p>OpenSSL must be installed into a <code>srclib</code> subdirectory named <code>openssl</code>, obtained from <a href=\"http://www.openssl.org/source/\">http://www.openssl.org/source/</a>, in order to compile <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> or the <code>abs.exe</code> project, which is ab.c with SSL support enabled. To prepare OpenSSL to be linked to Apache mod_ssl or abs.exe, and disable patent encumbered features in OpenSSL, you might use the following build commands:</p> <div class=\"example\"><pre>perl Configure no-rc5 no-idea enable-mdc2 enable-zlib VC-WIN32 -Ipath/to/srclib/zlib -Lpath/to/srclib/zlib\nms\\do_masm.bat\nnmake -f ms\\ntdll.mak</pre></div> <div class=\"note\">It is not advisable to use zlib-dynamic, as that transfers the cost of deflating SSL streams to the first request which must load the zlib dll. Note the suggested patch enables the -L flag to work with windows builds, corrects the name of zdll.lib and ensures .pdb files are generated for troubleshooting. If the assembler is not installed, you would add no-asm above and use ms\\do_ms.bat instead of the ms\\do_masm.bat script.</div> </li> <li> <p>[Optional] Database libraries (for <code class=\"module\"><a href=\"../mod/mod_dbd\">mod_dbd</a></code> and <code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code>)</p> <p>The apr-util library exposes dbm (keyed database) and dbd (query oriented database) client functionality to the httpd server and its modules, such as authentication and authorization. The sdbm dbm and odbc dbd providers are compiled unconditionally.</p> <p>The dbd support includes the Oracle instantclient package, MySQL, PostgreSQL and sqlite. To build these all, for example, set up the LIB to include the library path, INCLUDE to include the headers path, and PATH to include the dll bin path of all four SDK's, and set the DBD_LIST environment variable to inform the build which client driver SDKs are installed correctly, e.g.;</p> <div class=\"example\"><pre>set DBD_LIST=sqlite3 pgsql oracle mysql</pre></div> <p>Similarly, the dbm support can be extended with DBM_LIST to build a Berkeley DB provider (db) and/or gdbm provider, by similarly configuring LIB, INCLUDE and PATH first to ensure the client library libs and headers are available.</p> <div class=\"example\"><pre>set DBM_LIST=db gdbm</pre></div> <div class=\"note\">Depending on the choice of database distributions, it may be necessary to change the actual link target name (e.g. gdbm.lib vs. libgdb.lib) that are listed in the corresponding .dsp/.mak files within the directories srclib\\apr-util\\dbd or ...\\dbm.</div> <p>See the README-win32.txt file for more hints on obtaining the various database driver SDKs.</p> </li> </ul> <h3><a name=\"unixsrcbuild\" id=\"unixsrcbuild\">Building from Unix sources</a></h3> <p>The policy of the Apache HTTP Server project is to only release Unix sources. Windows source packages made available for download have been supplied by volunteers and may not be available for every release. You can still build the server on Windows from the Unix source tarball with just a few additional steps.</p> <ol> <li>Download and unpack the Unix source tarball for the latest version.</li> <li>Download and unpack the Unix source tarball for latest version of APR, AR-Util and APR-Iconv, place these sources in directories httpd-2.x.x\\srclib\\apr, httpd-2.x.x\\srclib\\apr-util and httpd-2.x.x\\srclib\\apr-iconv</li> <li>Open a Command Prompt and CD to the httpd-2.x.x folder</li> <li>Run the line endings conversion utility at the prompt;</li> </ol> <div class=\"example\"><pre>perl srclib\\apr\\build\\lineends.pl</pre></div> <p>You can now build the server with the Visual Studio development environment using the IDE. Command-Line builds of the server are not possible from Unix sources unless you export .mak files as explained below. </p> <h3><a name=\"commandbuild\" id=\"commandbuild\">Command-Line Build</a></h3> <p><code>Makefile.win</code> is the top level Apache makefile. To compile Apache on Windows, simply use one of the following commands to build the <code>release</code> or <code>debug</code> flavor:</p> <div class=\"example\"><pre>nmake /f Makefile.win _apacher\n\nnmake /f Makefile.win _apached</pre></div> <p>Either command will compile Apache. The latter will disable optimization of the resulting files, making it easier to single step the code to find bugs and track down problems.</p> <p>You can add your apr-util dbd and dbm provider choices with the additional make (environment) variables DBD_LIST and DBM_LIST, see the comments about [Optional] Database libraries, above. Review the initial comments in Makefile.win for additional options that can be provided when invoking the build.</p> <h3><a name=\"workspacebuild\" id=\"workspacebuild\">Developer Studio Workspace IDE Build</a></h3> <p>Apache can also be compiled using VC++'s Visual Studio development environment. To simplify this process, a Visual Studio workspace, <code>Apache.dsw</code>, is provided. This workspace exposes the entire list of working <code>.dsp</code> projects that are required for the complete Apache binary release. It includes dependencies between the projects to assure that they are built in the appropriate order.</p> <p>Open the <code>Apache.dsw</code> workspace, and select <code>InstallBin</code> (<code>Release</code> or <code>Debug</code> build, as desired) as the Active Project. <code>InstallBin</code> causes all related project to be built, and then invokes <code>Makefile.win</code> to move the compiled executables and dlls. You may personalize the <code>INSTDIR=</code> choice by changing <code>InstallBin</code>'s Settings, General tab, Build command line entry. <code>INSTDIR</code> defaults to the <code>/Apache2</code> directory. If you only want a test compile (without installing) you may build the <code>BuildBin</code> project instead.</p> <p>The <code>.dsp</code> project files are distributed in Visual Studio 6.0 (98) format. Visual C++ 5.0 (97) will recognize them. Visual Studio 2002 (.NET) and later users must convert <code>Apache.dsw</code> plus the <code>.dsp</code> files into an <code>Apache.sln</code> plus <code>.msproj</code> files. Be sure you reconvert the <code>.msproj</code> file again if its source <code>.dsp</code> file changes! This is really trivial, just open <code>Apache.dsw</code> in the VC++ 7.0 IDE once again and reconvert.</p> <div class=\"note\">There is a flaw in the .vcproj conversion of .dsp files. devenv.exe will mis-parse the /D flag for RC flags containing long quoted /D'efines which contain spaces. The command: <div class=\"example\"><pre>perl srclib\\apr\\build\\cvtdsp.pl -2005</pre></div> will convert the /D flags for RC flags to use an alternate, parseable syntax; unfortunately this syntax isn't supported by Visual Studio 97 or its exported .mak files. These /D flags are used to pass the long description of the mod_apachemodule.so files to the shared .rc resource version-identifier build.</div> <p>Visual Studio 2002 (.NET) and later users should also use the Build menu, Configuration Manager dialog to uncheck both the <code>Debug</code> and <code>Release</code> Solution modules <code>abs</code>, <code class=\"module\"><a href=\"../mod/mod_deflate\">mod_deflate</a></code> and <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> components, as well as every component starting with <code>apr_db*</code>. These modules are built by invoking <code>nmake</code>, or the IDE directly with the <code>BinBuild</code> target, which builds those modules conditionally if the <code>srclib</code> directories <code>openssl</code> and/or <code>zlib</code> exist, and based on the setting of <code>DBD_LIST</code> and <code>DBM_LIST</code> environment variables.</p> <h3><a name=\"exportingmakfiles\" id=\"exportingmakfiles\">Exporting command-line .mak files</a></h3> <p>Exported <code>.mak</code> files pose a greater hassle, but they are required for Visual C++ 5.0 users to build <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code>, abs (<code class=\"program\"><a href=\"../programs/ab\">ab</a></code> with SSL support) and/or <code class=\"module\"><a href=\"../mod/mod_deflate\">mod_deflate</a></code>. The .mak files also support a broader range of C++ tool chain distributions, such as Visual Studio Express.</p> <p>You must first build all projects in order to create all dynamic auto-generated targets, so that dependencies can be parsed correctly. Build the entire project from within the Visual Studio 6.0 (98) IDE, using the <code>BuildAll</code> target, then use the Project Menu Export for all makefiles (checking on \"with dependencies\".) Run the following command to correct absolute paths into relative paths so they will build anywhere:</p> <div class=\"example\"><pre>perl srclib\\apr\\build\\fixwin32mak.pl</pre></div> <p>You must type this command from the <em>top level</em> directory of the httpd source tree. Every <code>.mak</code> and <code>.dep</code> project file within the current directory and below will be corrected, and the timestamps adjusted to reflect the <code>.dsp</code>.</p> <p>Always review the generated <code>.mak</code> and <code>.dep</code> files for Platform SDK or other local, machine specific file paths. The <code>DevStudio\\Common\\MSDev98\\bin\\</code> (VC6) directory contains a <code>sysincl.dat</code> file, which lists all exceptions. Update this file (including both forward and backslashed paths, such as both <code>sys/time.h</code> and <code>sys\\time.h</code>) to ignore such newer dependencies. Including local-install paths in a distributed <code>.mak</code> file will cause the build to fail completely.</p> <p>If you contribute back a patch that revises project files, we must commit project files in Visual Studio 6.0 format. Changes should be simple, with minimal compilation and linkage flags that can be recognized by all Visual Studio environments.</p> <h3><a name=\"installation\" id=\"installation\">Installation</a></h3> <p>Once Apache has been compiled, it needs to be installed in its server root directory. The default is the <code>\\Apache2</code> directory, of the same drive.</p> <p>To build and install all the files into the desired folder <em>dir</em> automatically, use one of the following <code>nmake</code> commands:</p> <div class=\"example\"><pre>nmake /f Makefile.win installr INSTDIR=dir\nnmake /f Makefile.win installd INSTDIR=dir</pre></div> <p>The <em>dir</em> argument to <code>INSTDIR</code> provides the installation directory; it can be omitted if Apache is to be installed into <code>\\Apache22</code> (of the current drive).</p> <h3><a name=\"projectcomponents-warn\" id=\"projectcomponents-warn\">Warning about building Apache from the development tree</a></h3> <div class=\"note\">Note only the <code>.dsp</code> files are maintained between <code>release</code> builds. The <code>.mak</code> files are NOT regenerated, due to the tremendous waste of reviewer's time. Therefore, you cannot rely on the <code>NMAKE</code> commands above to build revised <code>.dsp</code> project files unless you then export all <code>.mak</code> files yourself from the project. This is unnecessary if you build from within the Microsoft Developer Studio environment.</div>   <h2 id=\"cmake\">Building httpd with cmake</h2> <p>The primary documentation for this build mechanism is in the <code>README.cmake</code> file in the source distribution. Refer to that file for detailed instructions.</p> <p>Building httpd with cmake requires building APR and APR-util separately. Refer to their <code>README.cmake</code> files for instructions.</p> <p>The primary limitations of the cmake-based build are inherited from the APR-util project, and are listed below because of their impact on httpd:</p> <ul> <li>No cmake build for the APR-iconv subproject is available, and the APR-util cmake build cannot consume an existing APR-iconv build. Thus, <code class=\"module\"><a href=\"../mod/mod_charset_lite\">mod_charset_lite</a></code> and possibly some third-party modules cannot be used.</li> <li>The cmake build for the APR-util subproject does not support most of the optional DBM and DBD libraries supported by the included Visual Studio project files. This limits the database backends supported by a number of bundled and third-party modules.</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/platform/win_compiling.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/platform/win_compiling.html</a>\n  </p>\n</div>\n","programs/apxs":"<h1>apxs - APache eXtenSion tool</h1>  <p><code>apxs</code> is a tool for building and installing extension modules for the Apache HyperText Transfer Protocol (HTTP) server. This is achieved by building a dynamic shared object (DSO) from one or more source or object <var>files</var> which then can be loaded into the Apache server under runtime via the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive from <code class=\"module\"><a href=\"../mod/mod_so\">mod_so</a></code>.</p> <p>So to use this extension mechanism your platform has to support the DSO feature and your Apache <code class=\"program\"><a href=\"httpd\">httpd</a></code> binary has to be built with the <code class=\"module\"><a href=\"../mod/mod_so\">mod_so</a></code> module. The <code>apxs</code> tool automatically complains if this is not the case. You can check this yourself by manually running the command</p> <div class=\"example\"><pre>$ httpd -l</pre></div> <p>The module <code class=\"module\"><a href=\"../mod/mod_so\">mod_so</a></code> should be part of the displayed list. If these requirements are fulfilled you can easily extend your Apache server's functionality by installing your own modules with the DSO mechanism by the help of this <code>apxs</code> tool:</p> <div class=\"example\"><pre>$ apxs -i -a -c mod_foo.c\ngcc -fpic -DSHARED_MODULE -I/path/to/apache/include -c mod_foo.c\nld -Bshareable -o mod_foo.so mod_foo.o\ncp mod_foo.so /path/to/apache/modules/mod_foo.so\nchmod 755 /path/to/apache/modules/mod_foo.so\n[activating module `foo' in /path/to/apache/etc/httpd.conf]\n$ apachectl restart\n/path/to/apache/sbin/apachectl restart: httpd not running, trying to start\n[Tue Mar 31 11:27:55 1998] [debug] mod_so.c(303): loaded module foo_module\n/path/to/apache/sbin/apachectl restart: httpd started\n$ _</pre></div> <p>The arguments <var>files</var> can be any C source file (.c), a object file (.o) or even a library archive (.a). The <code>apxs</code> tool automatically recognizes these extensions and automatically used the C source files for compilation while just using the object and archive files for the linking phase. But when using such pre-compiled objects make sure they are compiled for position independent code (PIC) to be able to use them for a dynamically loaded shared object. For instance with GCC you always just have to use <code>-fpic</code>. For other C compilers consult its manual page or at watch for the flags <code>apxs</code> uses to compile the object files.</p> <p>For more details about DSO support in Apache read the documentation of <code class=\"module\"><a href=\"../mod/mod_so\">mod_so</a></code> or perhaps even read the <code>src/modules/standard/mod_so.c</code> source file.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>apxs -g [ -S name=value ] -n modname</pre> <pre>apxs -q [ -v ] [ -S name=value ] query ...</pre> <pre>apxs -c [ -S name=value ] [ -o dsofile ] [ -I incdir ] [ -D name=value ] [ -L libdir ] [ -l libname ] [ -Wc,compiler-flags ] [ -Wl,linker-flags ] files ...</pre> <pre>apxs -i [ -S name=value ] [ -n modname ] [ -a ] [ -A ] dso-file ...</pre> <pre>apxs -e [ -S name=value ] [ -n modname ] [ -a ] [ -A ] dso-file ...</pre>   <h2 id=\"options\">Options</h2> <h3><a name=\"options.common\" id=\"options.common\">Common Options</a></h3> <dl> <dt><code>-n modname</code></dt> <dd>This explicitly sets the module name for the <code>-i</code> (install) and <code>-g</code> (template generation) option. Use this to explicitly specify the module name. For option <code>-g</code> this is required, for option <code>-i</code> the <code>apxs</code> tool tries to determine the name from the source or (as a fallback) at least by guessing it from the filename.</dd> </dl> <h3><a name=\"options.query\" id=\"options.query\">Query Options</a></h3> <dl> <dt><code>-q</code></dt> <dd>Performs a query for variables and environment settings used to build <code>httpd</code>. When invoked without <var>query</var> parameters, it prints all known variables and their values. The optional <code>-v</code> parameter formats the list output. <p>Use this to manually determine settings used to build the <code>httpd</code> that will load your module. For instance use</p> <div class=\"example\"><pre>INC=-I`apxs -q INCLUDEDIR`</pre></div> <p>inside your own Makefiles if you need manual access to Apache's C header files.</p>\n</dd> </dl> <h3><a name=\"options.conf\" id=\"options.conf\">Configuration Options</a></h3> <dl> <dt><code>-S name=value</code></dt> <dd>This option changes the apxs settings described above.</dd> </dl> <h3><a name=\"options.template\" id=\"options.template\">Template Generation Options</a></h3> <dl> <dt><code>-g</code></dt> <dd>This generates a subdirectory <var>name</var> (see option <code>-n</code>) and there two files: A sample module source file named <code>mod_name.c</code> which can be used as a template for creating your own modules or as a quick start for playing with the apxs mechanism. And a corresponding <code>Makefile</code> for even easier build and installing of this module.</dd> </dl> <h3><a name=\"options.dso\" id=\"options.dso\">DSO Compilation Options</a></h3> <dl> <dt><code>-c</code></dt> <dd>This indicates the compilation operation. It first compiles the C source files (.c) of <var>files</var> into corresponding object files (.o) and then builds a dynamically shared object in <var>dsofile</var> by linking these object files plus the remaining object files (.o and .a) of <var>files</var>. If no <code>-o</code> option is specified the output file is guessed from the first filename in <var>files</var> and thus usually defaults to <code>mod_name.so</code>.</dd> <dt><code>-o dsofile</code></dt> <dd>Explicitly specifies the filename of the created dynamically shared object. If not specified and the name cannot be guessed from the <var>files</var> list, the fallback name <code>mod_unknown.so</code> is used.</dd> <dt><code>-D name=value</code></dt> <dd>This option is directly passed through to the compilation command(s). Use this to add your own defines to the build process.</dd> <dt><code>-I incdir</code></dt> <dd>This option is directly passed through to the compilation command(s). Use this to add your own include directories to search to the build process.</dd> <dt><code>-L libdir</code></dt> <dd>This option is directly passed through to the linker command. Use this to add your own library directories to search to the build process.</dd> <dt><code>-l libname</code></dt> <dd>This option is directly passed through to the linker command. Use this to add your own libraries to search to the build process.</dd> <dt><code>-Wc,compiler-flags</code></dt> <dd>This option passes <var>compiler-flags</var> as additional flags to the <code>libtool --mode=compile</code> command. Use this to add local compiler-specific options.</dd> <dt><code>-Wl,linker-flags</code></dt> <dd>This option passes <var>linker-flags</var> as additional flags to the <code>libtool --mode=link</code> command. Use this to add local linker-specific options.</dd> <dt><code>-p</code></dt> <dd>This option causes apxs to link against the apr/apr-util libraries. This is useful when compiling helper programs that use the apr/apr-util libraries.</dd> </dl> <h3><a name=\"options.dsoinstall\" id=\"options.dsoinstall\">DSO Installation and Configuration Options</a></h3> <dl> <dt><code>-i</code></dt> <dd>This indicates the installation operation and installs one or more dynamically shared objects into the server's <var>modules</var> directory.</dd> <dt><code>-a</code></dt> <dd>This activates the module by automatically adding a corresponding <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> line to Apache's <code>httpd.conf</code> configuration file, or by enabling it if it already exists.</dd> <dt><code>-A</code></dt> <dd>Same as option <code>-a</code> but the created <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive is prefixed with a hash sign (<code>#</code>), <em>i.e.</em>, the module is just prepared for later activation but initially disabled.</dd> <dt><code>-e</code></dt> <dd>This indicates the editing operation, which can be used with the <code>-a</code> and <code>-A</code> options similarly to the <code>-i</code> operation to edit Apache's <code>httpd.conf</code> configuration file without attempting to install the module.</dd> </dl>   <h2 id=\"examples\">Examples</h2> <p>Assume you have an Apache module named <code>mod_foo.c</code> available which should extend Apache's server functionality. To accomplish this you first have to compile the C source into a shared object suitable for loading into the Apache server under runtime via the following command:</p> <div class=\"example\"><pre>$ apxs -c mod_foo.c\n/path/to/libtool --mode=compile gcc ... -c mod_foo.c\n/path/to/libtool --mode=link gcc ... -o mod_foo.la mod_foo.slo\n$ _</pre></div> <p>Then you have to update the Apache configuration by making sure a <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive is present to load this shared object. To simplify this step <code>apxs</code> provides an automatic way to install the shared object in its \"modules\" directory and updating the <code>httpd.conf</code> file accordingly. This can be achieved by running:</p> <div class=\"example\"><pre>$ apxs -i -a mod_foo.la\n/path/to/instdso.sh mod_foo.la /path/to/apache/modules\n/path/to/libtool --mode=install cp mod_foo.la /path/to/apache/modules ... chmod 755 /path/to/apache/modules/mod_foo.so\n[activating module `foo' in /path/to/apache/conf/httpd.conf]\n$ _</pre></div> <p>This way a line named</p> <div class=\"example\"><pre>LoadModule foo_module modules/mod_foo.so</pre></div> <p>is added to the configuration file if still not present. If you want to have this disabled per default use the <code>-A</code> option, <em>i.e.</em></p> <div class=\"example\"><pre>$ apxs -i -A mod_foo.c</pre></div> <p>For a quick test of the apxs mechanism you can create a sample Apache module template plus a corresponding Makefile via:</p> <div class=\"example\"><pre>$ apxs -g -n foo\nCreating [DIR] foo\nCreating [FILE] foo/Makefile\nCreating [FILE] foo/modules.mk\nCreating [FILE] foo/mod_foo.c\nCreating [FILE] foo/.deps\n$ _</pre></div> <p>Then you can immediately compile this sample module into a shared object and load it into the Apache server:</p> <div class=\"example\"><pre>$ cd foo\n$ make all reload\napxs -c mod_foo.c\n/path/to/libtool --mode=compile gcc ... -c mod_foo.c\n/path/to/libtool --mode=link gcc ... -o mod_foo.la mod_foo.slo\napxs -i -a -n \"foo\" mod_foo.la\n/path/to/instdso.sh mod_foo.la /path/to/apache/modules\n/path/to/libtool --mode=install cp mod_foo.la /path/to/apache/modules ... chmod 755 /path/to/apache/modules/mod_foo.so\n[activating module `foo' in /path/to/apache/conf/httpd.conf]\napachectl restart\n/path/to/apache/sbin/apachectl restart: httpd not running, trying to start\n[Tue Mar 31 11:27:55 1998] [debug] mod_so.c(303): loaded module foo_module\n/path/to/apache/sbin/apachectl restart: httpd started\n$ _</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/apxs.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/apxs.html</a>\n  </p>\n</div>\n","programs/dbmmanage":"<h1>dbmmanage - Manage user authentication files in DBM format</h1>  <p><code>dbmmanage</code> is used to create and update the DBM format files used to store usernames and password for basic authentication of HTTP users via <code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code>. Resources available from the Apache HTTP server can be restricted to just the users listed in the files created by <code>dbmmanage</code>. This program can only be used when the usernames are stored in a DBM file. To use a flat-file database see <code class=\"program\"><a href=\"htpasswd\">htpasswd</a></code>.</p> <p>Another tool to maintain a DBM password database is <code class=\"program\"><a href=\"htdbm\">htdbm</a></code>.</p> <p>This manual page only lists the command line arguments. For details of the directives necessary to configure user authentication in <code class=\"program\"><a href=\"httpd\">httpd</a></code> see the httpd manual, which is part of the Apache distribution or can be found at <a href=\"http://httpd.apache.org/\">http://httpd.apache.org/</a>.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>dbmmanage [ encoding ] filename add|adduser|check|delete|update username [ encpasswd [ group[,group...] [ comment ] ] ]</pre> <pre>dbmmanage filename view [ username ]</pre> <pre>dbmmanage filename import</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>filename</code></dt> <dd>The filename of the DBM format file. Usually without the extension <code>.db</code>, <code>.pag</code>, or <code>.dir</code>.</dd> <dt><code>username</code></dt> <dd>The user for which the operations are performed. The <var>username</var> may not contain a colon (<code>:</code>).</dd> <dt><code>encpasswd</code></dt> <dd>This is the already encrypted password to use for the <code>update</code> and <code>add</code> commands. You may use a hyphen (<code>-</code>) if you want to get prompted for the password, but fill in the fields afterwards. Additionally when using the <code>update</code> command, a period (<code>.</code>) keeps the original password untouched.</dd> <dt><code>group</code></dt> <dd>A group, which the user is member of. A groupname may not contain a colon (<code>:</code>). You may use a hyphen (<code>-</code>) if you don't want to assign the user to a group, but fill in the comment field. Additionally when using the <code>update</code> command, a period (<code>.</code>) keeps the original groups untouched.</dd> <dt><code>comment</code></dt> <dd>This is the place for your opaque comments about the user, like realname, mailaddress or such things. The server will ignore this field.</dd> </dl> <h3><a name=\"options.encodings\" id=\"options.encodings\">Encodings</a></h3> <dl> <dt><code>-d</code></dt> <dd>crypt encryption (default, except on Win32, Netware)</dd> <dt><code>-m</code></dt> <dd>MD5 encryption (default on Win32, Netware)</dd> <dt><code>-s</code></dt> <dd>SHA1 encryption</dd> <dt><code>-p</code></dt> <dd>plaintext (<em>not recommended</em>)</dd> </dl> <h3><a name=\"options.commands\" id=\"options.commands\">Commands</a></h3> <dl> <dt><code>add</code></dt> <dd>Adds an entry for <var>username</var> to <var>filename</var> using the encrypted password <var>encpasswd</var>. <div class=\"example\"><pre>dbmmanage passwords.dat add rbowen foKntnEF3KSXA</pre></div> </dd> <dt><code>adduser</code></dt> <dd>Asks for a password and then adds an entry for <var>username</var> to <var>filename</var>. <div class=\"example\"><pre>dbmmanage passwords.dat adduser krietz</pre></div> </dd> <dt><code>check</code></dt> <dd>Asks for a password and then checks if <var>username</var> is in <var>filename</var> and if it's password matches the specified one. <div class=\"example\"><pre>dbmmanage passwords.dat check rbowen</pre></div> </dd> <dt><code>delete</code></dt> <dd>Deletes the <var>username</var> entry from <var>filename</var>. <div class=\"example\"><pre>dbmmanage passwords.dat delete rbowen</pre></div> </dd> <dt><code>import</code></dt> <dd>Reads <code>username:password</code> entries (one per line) from <code>STDIN</code> and adds them to <var>filename</var>. The passwords already have to be crypted.</dd> <dt><code>update</code></dt> <dd>Same as the <code>adduser</code> command, except that it makes sure <var>username</var> already exists in <var>filename</var>. <div class=\"example\"><pre>dbmmanage passwords.dat update rbowen</pre></div> </dd> <dt><code>view</code></dt> <dd>Just displays the contents of the DBM file. If you specify a <var>username</var>, it displays the particular record only. <div class=\"example\"><pre>dbmmanage passwords.dat view</pre></div> </dd> </dl>   <h2 id=\"bugs\">Bugs</h2> <p>One should be aware that there are a number of different DBM file formats in existence, and with all likelihood, libraries for more than one format may exist on your system. The three primary examples are SDBM, NDBM, the GNU project's GDBM, and Berkeley DB 2. Unfortunately, all these libraries use different file formats, and you must make sure that the file format used by <var>filename</var> is the same format that <code>dbmmanage</code> expects to see. <code>dbmmanage</code> currently has no way of determining what type of DBM file it is looking at. If used against the wrong format, will simply return nothing, or may create a different DBM file with a different name, or at worst, it may corrupt the DBM file if you were attempting to write to it.</p> <p><code>dbmmanage</code> has a list of DBM format preferences, defined by the <code>@AnyDBM::ISA</code> array near the beginning of the program. Since we prefer the Berkeley DB 2 file format, the order in which <code>dbmmanage</code> will look for system libraries is Berkeley DB 2, then NDBM, then GDBM and then SDBM. The first library found will be the library <code>dbmmanage</code> will attempt to use for all DBM file transactions. This ordering is slightly different than the standard <code>@AnyDBM::ISA</code> ordering in Perl, as well as the ordering used by the simple <code>dbmopen()</code> call in Perl, so if you use any other utilities to manage your DBM files, they must also follow this preference ordering. Similar care must be taken if using programs in other languages, like C, to access these files.</p> <p>One can usually use the <code>file</code> program supplied with most Unix systems to see what format a DBM file is in.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/dbmmanage.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/dbmmanage.html</a>\n  </p>\n</div>\n","programs/configure":"<h1>configure - Configure the source tree</h1>  <p>The <code>configure</code> script configures the source tree for compiling and installing the Apache HTTP Server on your particular platform. Various options allow the compilation of a server corresponding to your personal requirements.</p> <p>This script, included in the root directory of the source distribution, is for compilation on Unix and Unix-like systems only. For other platforms, see the <a href=\"../platform/index\">platform</a> documentation.</p>     <h2 id=\"synopsis\">Synopsis</h2> <p>You should call the <code>configure</code> script from within the root directory of the distribution.</p> <pre>./configure [OPTION]... [VAR=VALUE]...</pre> <p>To assign environment variables (e.g. <code>CC</code>, <code>CFLAGS</code> ...), specify them as <code>VAR=VALUE</code>. See <a href=\"#env\">below</a> for descriptions of some of the useful variables.</p>   <h2 id=\"options\">Options</h2> <ul> <li><a href=\"#configurationoptions\">Configuration options</a></li> <li><a href=\"#installationdirectories\">Installation directories</a></li> <li><a href=\"#systemtypes\">System types</a></li> <li><a href=\"#optionalfeatures\">Optional features</a></li> <li><a href=\"#supportopt\">Options for support programs</a></li> </ul> <h3><a name=\"configurationoptions\" id=\"configurationoptions\">Configuration options</a></h3> <p>The following options influence the behavior of <code>configure</code> itself.</p> <dl> <dt><code>-C</code></dt> <dt><code>--config-cache</code></dt> <dd>This is an alias for <code>--cache-file=config.cache</code>\n</dd> <dt><code>--cache-file=FILE</code></dt> <dd>The test results will be cached in file <var>FILE</var>. This option is disabled by default.</dd> <dt><code>-h</code></dt> <dt><code>--help [short|recursive]</code></dt> <dd>Output the help and exit. With the argument <code>short</code> only options specific to this package will displayed. The argument <code>recursive</code> displays the short help of all the included packages.</dd> <dt><code>-n</code></dt> <dt><code>--no-create</code></dt> <dd>The <code>configure</code> script is run normally but does not create output files. This is useful to check the test results before generating makefiles for compilation.</dd> <dt><code>-q</code></dt> <dt><code>--quiet</code></dt> <dd>Do not print <code>checking ...</code> messages during the configure process.</dd> <dt><code>--srcdir=DIR</code></dt> <dd>Defines directory <var>DIR</var> to be the source file directory. Default is the directory where <code>configure</code> is located, or the parent directory.</dd> <dt><code>--silent</code></dt> <dd>Same as <code>--quiet</code>\n</dd> <dt>-V</dt> <dt>--version</dt> <dd>Display copyright information and exit.</dd> </dl> <h3><a name=\"installationdirectories\" id=\"installationdirectories\">Installation directories</a></h3> <p>These options define the installation directory. The installation tree depends on the selected layout.</p> <dl> <dt><code>--prefix=PREFIX</code></dt> <dd>Install architecture-independent files in <var>PREFIX</var>. By default the installation directory is set to <code>/usr/local/apache2</code>.</dd> <dt><code>--exec-prefix=EPREFIX</code></dt> <dd>Install architecture-dependent files in <var>EPREFIX</var>. By default the installation directory is set to the <var>PREFIX</var> directory.</dd> </dl> <p>By default, <code>make install</code> will install all the files in <code>/usr/local/apache2/bin</code>, <code>/usr/local/apache2/lib</code> etc. You can specify an installation prefix other than <code>/usr/local/apache2</code> using <code>--prefix</code>, for instance <code>--prefix=$HOME</code>.</p> <h4><a name=\"layout\" id=\"layout\">Define a directory layout</a></h4> <dl> <dt><code>--enable-layout=LAYOUT</code></dt> <dd>Configure the source code and build scripts to assume an installation tree based on the layout <var>LAYOUT</var>. This allows you to separately specify the locations for each type of file within the Apache HTTP Server installation. The <code>config.layout</code> file contains several example configurations, and you can also create your own custom configuration following the examples. The different layouts in this file are grouped into <code>&lt;Layout FOO&gt;...&lt;/Layout&gt;</code> sections and referred to by name as in <code>FOO</code>. The default layout is <code>Apache</code>.</dd> </dl> <h4><a name=\"directoryfinetuning\" id=\"directoryfinetuning\">Fine tuning of the installation directories</a></h4> <p>For better control of the installation directories, use the options below. Please note that the directory defaults are set by <code>autoconf</code> and are overwritten by the corresponding layout setting.</p> <dl> <dt><code>--bindir=DIR</code></dt> <dd>Install user executables in <var>DIR</var>. The user executables are supporting programs like <code class=\"program\"><a href=\"htpasswd\">htpasswd</a></code>, <code class=\"program\"><a href=\"dbmmanage\">dbmmanage</a></code>, etc. which are useful for site administrators. By default <var>DIR</var> is set to <code>EPREFIX/bin</code>.</dd> <dt><code>--datadir=DIR</code></dt> <dd>Install read-only architecture-independent data in <var>DIR</var>. By default <code>datadir</code> is set to <code>PREFIX/share</code>. This option is offered by <code>autoconf</code> and currently unused.</dd> <dt><code>--includedir=DIR</code></dt> <dd>Install C header files in <var>DIR</var>. By default <code>includedir</code> is set to <code>EPREFIX/include</code>.</dd> <dt><code>--infodir=DIR</code></dt> <dd>Install info documentation in <var>DIR</var>. By default <code>infodir</code> is set to <code>PREFIX/info</code>. This option is currently unused.</dd> <dt><code>--libdir=DIR</code></dt> <dd>Install object code libraries in <var>DIR</var>. By default <code>libdir</code> is set to <code>EPREFIX/lib</code>.</dd> <dt><code>--libexecdir=DIR</code></dt> <dd>Install the program executables (i.e., shared modules) in <var>DIR</var>. By default <code>libexecdir</code> is set to <code>EPREFIX/modules</code>.</dd> <dt><code>--localstatedir=DIR</code></dt> <dd>Install modifiable single-machine data in <var>DIR</var>. By default <code>localstatedir</code> is set to <code>PREFIX/var</code>. This option is offered by <code>autoconf</code> and currently unused.</dd> <dt><code>--mandir=DIR</code></dt> <dd>Install the man documentation in <var>DIR</var>. By default <code>mandir</code> is set to <code>EPREFIX/man</code>.</dd> <dt><code>--oldincludedir=DIR</code></dt> <dd>Install C header files for non-gcc in <var>DIR</var>. By default <code>oldincludedir</code> is set to <code>/usr/include</code>. This option is offered by <code>autoconf</code> and currently unused.</dd> <dt><code>--sbindir=DIR</code></dt> <dd>Install the system administrator executables in <var>DIR</var>. Those are server programs like <code class=\"program\"><a href=\"httpd\">httpd</a></code>, <code class=\"program\"><a href=\"apachectl\">apachectl</a></code>, <code class=\"program\"><a href=\"suexec\">suexec</a></code>, etc. which are necessary to run the Apache HTTP Server. By default <code>sbindir</code> is set to <code>EPREFIX/sbin</code>.</dd> <dt><code>--sharedstatedir=DIR</code></dt> <dd>Install modifiable architecture-independent data in <var>DIR</var>. By default <code>sharedstatedir</code> is set to <code>PREFIX/com</code>. This option is offered by <code>autoconf</code> and currently unused.</dd> <dt><code>--sysconfdir=DIR</code></dt> <dd>Install read-only single-machine data like the server configuration files <code>httpd.conf</code>, <code>mime.types</code>, etc. in <var>DIR</var>. By default <code>sysconfdir</code> is set to <code>PREFIX/conf</code>.</dd> </dl> <h3><a name=\"systemtypes\" id=\"systemtypes\">System types</a></h3> <p>These options are used to cross-compile the Apache HTTP Server to run on another system. In normal cases, when building and running the server on the same system, these options are not used.</p> <dl> <dt><code>--build=BUILD</code></dt> <dd>Defines the system type of the system on which the tools are being built. It defaults to the result of the script <code>config.guess</code>.</dd> <dt><code>--host=HOST</code></dt> <dd>Defines the system type of the system on which the server will run. <var>HOST</var> defaults to <var>BUILD</var>.</dd> <dt><code>--target=TARGET</code></dt> <dd>Configure for building compilers for the system type <var>TARGET</var>. It defaults to <var>HOST</var>. This option is offered by <code>autoconf</code> and not necessary for the Apache HTTP Server.</dd> </dl> <h3><a name=\"optionalfeatures\" id=\"optionalfeatures\">Optional Features</a></h3> <p>These options are used to fine tune the features your HTTP server will have.</p> <h4><a name=\"generaloptfeat\" id=\"generaloptfeat\">General syntax</a></h4> <p>Generally you can use the following syntax to enable or disable a feature:</p> <dl> <dt><code>--disable-FEATURE</code></dt> <dd>Do not include <var>FEATURE</var>. This is the same as <code>--enable-FEATURE=no</code>.</dd> <dt><code>--enable-FEATURE[=ARG]</code></dt> <dd>Include <var>FEATURE</var>. The default value for <var>ARG</var> is <code>yes</code>.</dd> <dt><code>--enable-MODULE=shared</code></dt> <dd>The corresponding module will be build as DSO module. By default enabled modules are linked dynamically.</dd> <dt><code>--enable-MODULE=static</code></dt> <dd>The corresponding module will be linked statically.</dd> </dl> <div class=\"note\">\n<p><strong>Note</strong></p> <code>configure</code> will not complain about <code>--enable-foo</code> even if <var>foo</var> doesn't exist, so you need to type carefully. </div> <h4><a name=\"choosemodules\" id=\"choosemodules\">Choosing modules to compile</a></h4> <p>Most modules are compiled by default and have to be disabled explicitly or by using the keyword <code>few</code> (see <code>--enable-modules</code>, <code>--enable-mods-shared</code> and <code>--enable-mods-static</code> below for further explanation) or <code>--enable-modules=none</code> to be removed as a group.</p> <p>Other modules are not compiled by default and have to be enabled explicitly or by using the keywords <code>all</code> or <code>reallyall</code> to be available.</p> <p>To find out which modules are compiled by default, run <code>./configure -h</code> or <code>./configure --help</code> and look under <code>Optional Features</code>. Suppose you are interested in <code>mod_example1</code> and <code>mod_example2</code>, and you see this:</p> <div class=\"example\"><pre>Optional Features:\n  ...\n  --disable-example1     example module 1\n  --enable-example2      example module 2\n  ...</pre></div> <p>Then <code>mod_example1</code> is enabled by default, and you would use <code>--disable-example1</code> to not compile it. <code>mod_example2</code> is disabled by default, and you would use <code>--enable-example2</code> to compile it.</p> <h4><a name=\"mpms\" id=\"mpms\">Multi-Processing Modules</a></h4> <p><a href=\"../mpm\">Multi-Processing Modules</a>, or MPMs, implement the basic behavior of the server. A single MPM must be active in order for the server to function. The list of available MPMs appears on the <a href=\"../mod/index\">module index page</a>.</p> <p>MPMs can be built as DSOs for dynamic loading or statically linked with the server, and are enabled using the following options:</p> <dl> <dt><code>--with-mpm=MPM</code></dt> <dd> <p>Choose the default MPM for your server. If MPMs are built as DSO modules (see <code>--enable-mpms-shared</code>), this directive selects the MPM which will be loaded in the default configuration file. Otherwise, this directive selects the only available MPM, which will be statically linked into the server.</p> <p>If this option is omitted, the <a href=\"../mpm#defaults\">default MPM</a> for your operating system will be used.</p> </dd> <dt><code>--enable-mpms-shared=MPM-LIST</code></dt> <dd> <p>Enable a list of MPMs as dynamic shared modules. One of these modules must be loaded dynamically using the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive.</p> <p><var>MPM-LIST</var> is a space-separated list of MPM names enclosed by quotation marks. For example:</p> <div class=\"example\"><pre>--enable-mpms-shared='prefork worker'</pre></div> <p>Additionally you can use the special keyword <code>all</code>, which will select all MPMs which support dynamic loading on the current platform and build them as DSO modules. For example:</p> <div class=\"example\"><code>--enable-mpms-shared=all</code></div> </dd> </dl> <h4><a name=\"modules\" id=\"modules\">Third-party modules</a></h4> <p>To add additional third-party modules use the following options:</p> <dl> <dt><code>--with-module=module-type:module-file[, module-type:module-file]</code></dt> <dd>\n<p>Add one or more third-party modules to the list of statically linked modules. The module source file <code>module-file</code> will be searched in the <code>modules/module-type</code> subdirectory of your Apache HTTP server source tree. If it is not found there <code>configure</code> is considering <var>module-file</var> to be an absolute file path and tries to copy the source file into the <var>module-type</var> subdirectory. If the subdirectory doesn't exist it will be created and populated with a standard <code>Makefile.in</code>.</p> <p>This option is useful to add small external modules consisting of one source file. For more complex modules you should read the vendor's documentation.</p> <div class=\"note\">\n<p><strong>Note</strong></p> If you want to build a DSO module instead of a statically linked use <code class=\"program\"><a href=\"apxs\">apxs</a></code>.</div> </dd> </dl> <h4><a name=\"otheroptfeat\" id=\"otheroptfeat\">Cumulative and other options</a></h4> <dl> <dt><code>--enable-maintainer-mode</code></dt> <dd>Turn on debugging and compile time warnings and load all compiled modules.</dd> <dt><code>--enable-mods-shared=MODULE-LIST</code></dt> <dd> <p>Defines a list of modules to be enabled and build as dynamic shared modules. This mean, these module have to be loaded dynamically by using the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive.</p> <p><var>MODULE-LIST</var> is a space separated list of modulenames enclosed by quotation marks. The module names are given without the preceding <code>mod_</code>. For example:</p> <div class=\"example\"><pre>--enable-mods-shared='headers rewrite dav'</pre></div> <p>Additionally you can use the special keywords <code>reallyall</code>, <code>all</code>, <code>most</code> and <code>few</code>. For example,</p> <div class=\"example\"><code>--enable-mods-shared=most</code></div> <p>will compile most modules and build them as DSO modules,</p> <div class=\"example\"><code>--enable-mods-shared=few</code></div> <p>will only compile a very basic set of modules.</p> <p>The default set is <code>most</code>.</p> <p>The <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directives for the chosen modules will be automatically generated in the main configuration file. By default, all those directives will be commented out except for the modules that are either required or explicitly selected by a configure <code>--enable-foo</code> argument. You can change the set of loaded modules by activating or deactivating the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directives in <code>httpd.conf</code>. In addition the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directives for all built modules can be activated via the configure option <code>--enable-load-all-modules</code>.</p> </dd> <dt><code>--enable-mods-static=MODULE-LIST</code></dt> <dd>This option behaves similar to <code>--enable-mods-shared</code>, but will link the given modules statically. This mean, these modules will always be present while running <code class=\"program\"><a href=\"httpd\">httpd</a></code>. They need not be loaded with <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code>.</dd> <dt><code>--enable-modules=MODULE-LIST</code></dt> <dd>This option behaves like to <code>--enable-mods-shared</code>, and will also link the given modules dynamically. The special keyword <code>none</code> disables the build of all modules.</dd> <dt><code>--enable-v4-mapped</code></dt> <dd>Allow IPv6 sockets to handle IPv4 connections.</dd> <dt><code>--with-port=PORT</code></dt> <dd>This defines the port on which <code class=\"program\"><a href=\"httpd\">httpd</a></code> will listen. This port number is used when generating the configuration file <code>httpd.conf</code>. The default is 80.</dd> <dt><code>--with-program-name</code></dt> <dd>Define an alternative executable name. The default is <code>httpd</code>.</dd> </dl> <h3><a name=\"packages\" id=\"packages\">Optional packages</a></h3> <p>These options are used to define optional packages.</p> <h4><a name=\"generalpackages\" id=\"generalpackages\">General syntax</a></h4> <p>Generally you can use the following syntax to define an optional package:</p> <dl> <dt><code>--with-PACKAGE[=ARG]</code></dt> <dd>Use the package <var>PACKAGE</var>. The default value for <var>ARG</var> is <code>yes</code>.</dd> <dt><code>--without-PACKAGE</code></dt> <dd>Do not use the package <var>PACKAGE</var>. This is the same as <code>--with-PACKAGE=no</code>. This option is provided by <code>autoconf</code> but not very useful for the Apache HTTP Server.</dd> </dl> <h4><a name=\"packageopt\" id=\"packageopt\">Specific packages</a></h4> <dl> <dt><code>--with-apr=DIR|FILE</code></dt> <dd>The <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">Apache Portable Runtime</a> (APR) is part of the httpd source distribution and will automatically be build together with the HTTP server. If you want to use an already installed APR instead you have to tell <code>configure</code> the path to the <code>apr-config</code> script. You may set the absolute path and name or the directory to the installed APR. <code>apr-config</code> must exist within this directory or the subdirectory <code>bin</code>.</dd> <dt><code>--with-apr-util=DIR|FILE</code></dt> <dd>The Apache Portable Runtime Utilities (APU) are part of the httpd source distribution and will automatically be build together with the HTTP server. If you want to use an already installed APU instead you have to tell <code>configure</code> the path to the <code>apu-config</code> script. You may set the absolute path and name or the directory to the installed APU. <code>apu-config</code> must exist within this directory or the subdirectory <code>bin</code>.</dd> <dt><code>--with-ssl=DIR</code></dt> <dd>If <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> has been enabled <code>configure</code> searches for an installed OpenSSL. You can set the directory path to the SSL/TLS toolkit instead.</dd> <dt><code>--with-z=DIR</code></dt> <dd>\n<code>configure</code> searches automatically for an installed <code>zlib</code> library if your source configuration requires one (e.g., when <code class=\"module\"><a href=\"../mod/mod_deflate\">mod_deflate</a></code> is enabled). You can set the directory path to the compression library instead.</dd> </dl> <p>Several features of the Apache HTTP Server, including <code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code> and <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>'s DBM <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> use simple key/value databases for quick lookups of information. SDBM is included in the APU, so this database is always available. If you would like to use other database types, use the following options to enable them:</p> <dl> <dt><code>--with-gdbm[=path]</code></dt> <dd>If no <var>path</var> is specified, <code>configure</code> will search for the include files and libraries of a GNU DBM installation in the usual search paths. An explicit <var>path</var> will cause <code>configure</code> to look in <code>path/lib</code> and <code>path/include</code> for the relevant files. Finally, the <var>path</var> may specify specific include and library paths separated by a colon.</dd> <dt><code>--with-ndbm[=path]</code></dt> <dd>Like <code>--with-gdbm</code>, but searches for a New DBM installation.</dd> <dt><code>--with-berkeley-db[=path]</code></dt> <dd>Like <code>--with-gdbm</code>, but searches for a Berkeley DB installation.</dd> </dl> <div class=\"note\">\n<p><strong>Note</strong></p> <p>The DBM options are provided by the APU and passed through to its configuration script. They are useless when using an already installed APU defined by <code>--with-apr-util</code>.</p> <p>You may use more then one DBM implementation together with your HTTP server. The appropriated DBM type will be configured within the runtime configuration at each time.</p> </div> <h3><a name=\"supportopt\" id=\"supportopt\">Options for support programs</a></h3> <dl> <dt><code>--enable-static-support</code></dt> <dd>Build a statically linked version of the support binaries. This means, a stand-alone executable will be built with all the necessary libraries integrated. Otherwise the support binaries are linked dynamically by default.</dd> <dt><code>--enable-suexec</code></dt> <dd>Use this option to enable <code class=\"program\"><a href=\"suexec\">suexec</a></code>, which allows you to set uid and gid for spawned processes. <strong>Do not use this option unless you understand all the security implications of running a suid binary on your server.</strong> Further options to configure <code class=\"program\"><a href=\"suexec\">suexec</a></code> are described <a href=\"#suexec\">below</a>.</dd> </dl> <p>It is possible to create a statically linked binary of a single support program by using the following options:</p> <dl> <dt><code>--enable-static-ab</code></dt> <dd>Build a statically linked version of <code class=\"program\"><a href=\"ab\">ab</a></code>.</dd> <dt><code>--enable-static-checkgid</code></dt> <dd>Build a statically linked version of <code>checkgid</code>.</dd> <dt><code>--enable-static-htdbm</code></dt> <dd>Build a statically linked version of <code class=\"program\"><a href=\"htdbm\">htdbm</a></code>.</dd> <dt><code>--enable-static-htdigest</code></dt> <dd>Build a statically linked version of <code class=\"program\"><a href=\"htdigest\">htdigest</a></code>.</dd> <dt><code>--enable-static-htpasswd</code></dt> <dd>Build a statically linked version of <code class=\"program\"><a href=\"htpasswd\">htpasswd</a></code>.</dd> <dt><code>--enable-static-logresolve</code></dt> <dd>Build a statically linked version of <code class=\"program\"><a href=\"logresolve\">logresolve</a></code>.</dd> <dt><code>--enable-static-rotatelogs</code></dt> <dd>Build a statically linked version of <code class=\"program\"><a href=\"rotatelogs\">rotatelogs</a></code>.</dd> </dl> <h4><a name=\"suexec\" id=\"suexec\"><code>suexec</code> configuration options</a></h4> <p>The following options are used to fine tune the behavior of <code class=\"program\"><a href=\"suexec\">suexec</a></code>. See <a href=\"suexec#install\">Configuring and installing suEXEC</a> for further information.</p> <dl> <dt><code>--with-suexec-bin</code></dt> <dd>This defines the path to <code class=\"program\"><a href=\"suexec\">suexec</a></code> binary. Default is <code>--sbindir</code> (see <a href=\"#directoryfinetuning\">Fine tuning of installation directories</a>).</dd> <dt><code>--with-suexec-caller</code></dt> <dd>This defines the user allowed to call <code class=\"program\"><a href=\"suexec\">suexec</a></code>. It should be the same as the user under which <code class=\"program\"><a href=\"httpd\">httpd</a></code> normally runs.</dd> <dt><code>--with-suexec-docroot</code></dt> <dd>This defines the directory tree under which <code class=\"program\"><a href=\"suexec\">suexec</a></code> access is allowed for executables. Default value is <code>--datadir/htdocs</code>.</dd> <dt><code>--with-suexec-gidmin</code></dt> <dd>Define this as the lowest GID allowed to be a target user for <code class=\"program\"><a href=\"suexec\">suexec</a></code>. The default value is 100.</dd> <dt><code>--with-suexec-logfile</code></dt> <dd>This defines the filename of the <code class=\"program\"><a href=\"suexec\">suexec</a></code> logfile. By default the logfile is named <code>suexec_log</code> and located in <code>--logfiledir</code>.</dd> <dt><code>--with-suexec-safepath</code></dt> <dd>Define the value of the environment variable <code>PATH</code> to be set for processes started by <code class=\"program\"><a href=\"suexec\">suexec</a></code>. Default value is <code>/usr/local/bin:/usr/bin:/bin</code>.</dd> <dt><code>--with-suexec-userdir</code></dt> <dd>This defines the subdirectory under the user's directory that contains all executables for which <code class=\"program\"><a href=\"suexec\">suexec</a></code> access is allowed. This setting is necessary when you want to use <code class=\"program\"><a href=\"suexec\">suexec</a></code> together with user-specific directories (as provided by <code class=\"module\"><a href=\"../mod/mod_userdir\">mod_userdir</a></code>). The default is <code>public_html</code>.</dd> <dt><code>--with-suexec-uidmin</code></dt> <dd>Define this as the lowest UID allowed to be a target user for <code class=\"program\"><a href=\"suexec\">suexec</a></code>. The default value is 100.</dd> <dt><code>--with-suexec-umask</code></dt> <dd>Set <code>umask</code> for processes started by <code class=\"program\"><a href=\"suexec\">suexec</a></code>. It defaults to your system settings.</dd> </dl>   <h2 id=\"env\">Environment variables</h2> <p>There are some useful environment variables to override the choices made by <code>configure</code> or to help it to find libraries and programs with nonstandard names or locations.</p> <dl> <dt><code>CC</code></dt> <dd>Define the C compiler command to be used for compilation.</dd> <dt><code>CFLAGS</code></dt> <dd>Set C compiler flags you want to use for compilation.</dd> <dt><code>CPP</code></dt> <dd>Define the C preprocessor command to be used.</dd> <dt><code>CPPFLAGS</code></dt> <dd>Set C/C++ preprocessor flags, e.g. <code>-Iincludedir</code> if you have headers in a nonstandard directory <var>includedir</var>.</dd> <dt><code>LDFLAGS</code></dt> <dd>Set linker flags, e.g. <code>-Llibdir</code> if you have libraries in a nonstandard directory <var>libdir</var>.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/configure.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/configure.html</a>\n  </p>\n</div>\n","programs/httpd":"<h1>httpd - Apache Hypertext Transfer Protocol Server</h1>  <p><code>httpd</code> is the Apache HyperText Transfer Protocol (HTTP) server program. It is designed to be run as a standalone daemon process. When used like this it will create a pool of child processes or threads to handle requests.</p> <p>In general, <code>httpd</code> should not be invoked directly, but rather should be invoked via <code class=\"program\"><a href=\"apachectl\">apachectl</a></code> on Unix-based systems or <a href=\"../platform/windows#winsvc\">as a service on Windows NT, 2000 and XP</a> and <a href=\"../platform/windows#wincons\">as a console application on Windows 9x and ME</a>.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>httpd [ -d serverroot ] [ -f config ] [ -C directive ] [ -c directive ] [ -D parameter ] [ -e level ] [ -E file ] [ -k start|restart|graceful|stop|graceful-stop ] [ -R directory ] [ -h ] [ -l ] [ -L ] [ -S ] [ -t ] [ -v ] [ -V ] [ -X ] [ -M ] [ -T ]</pre> <p>On <a href=\"../platform/windows\">Windows systems</a>, the following additional arguments are available:</p> <pre>httpd [ -k install|config|uninstall ] [ -n name ] [ -w ]</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-d serverroot</code></dt> <dd>Set the initial value for the <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> directive to <var>serverroot</var>. This can be overridden by the ServerRoot directive in the configuration file. The default is <code>/usr/local/apache2</code>.</dd> <dt><code>-f config</code></dt> <dd>Uses the directives in the file <var>config</var> on startup. If <var>config</var> does not begin with a /, then it is taken to be a path relative to the <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code>. The default is <code>conf/httpd.conf</code>.</dd> <dt><code>-k <code>start|restart|graceful|stop|graceful-stop</code></code></dt> <dd>Signals <code>httpd</code> to start, restart, or stop. See <a href=\"../stopping\">Stopping Apache httpd</a> for more information.</dd> <dt><code>-C directive</code></dt> <dd>Process the configuration <var>directive</var> before reading config files.</dd> <dt><code>-c directive</code></dt> <dd>Process the configuration <var>directive</var> after reading config files.</dd> <dt><code>-D parameter</code></dt> <dd>Sets a configuration <var>parameter </var>which can be used with <code class=\"directive\"><a href=\"../mod/core#ifdefine\">&lt;IfDefine&gt;</a></code> sections in the configuration files to conditionally skip or process commands at server startup and restart. Also can be used to set certain less-common startup parameters including <code>-DNO_DETACH</code> (prevent the parent from forking) and <code>-DFOREGROUND</code> (prevent the parent from calling <code>setsid()</code> et al).</dd> <dt><code>-e level</code></dt> <dd>Sets the <code class=\"directive\"><a href=\"../mod/core#loglevel\">LogLevel</a></code> to <var>level</var> during server startup. This is useful for temporarily increasing the verbosity of the error messages to find problems during startup.</dd> <dt><code>-E file</code></dt> <dd>Send error messages during server startup to <var>file</var>.</dd> <dt><code>-h</code></dt> <dd>Output a short summary of available command line options.</dd> <dt><code>-l</code></dt> <dd>Output a list of modules compiled into the server. This will <strong>not</strong> list dynamically loaded modules included using the <code class=\"directive\"><a href=\"../mod/mod_so#loadmodule\">LoadModule</a></code> directive.</dd> <dt><code>-L</code></dt> <dd>Output a list of directives provided by static modules, together with expected arguments and places where the directive is valid. Directives provided by shared modules are not listed.</dd> <dt><code>-M</code></dt> <dd>Dump a list of loaded Static and Shared Modules.</dd> <dt><code>-S</code></dt> <dd>Show the settings as parsed from the config file (currently only shows the virtualhost settings).</dd> <dt>\n<code>-T</code> (Available in 2.3.8 and later)</dt> <dd>Skip document root check at startup/restart.</dd> <dt><code>-t</code></dt> <dd>Run syntax tests for configuration files only. The program immediately exits after these syntax parsing tests with either a return code of 0 (Syntax OK) or return code not equal to 0 (Syntax Error). If -D <var>DUMP</var>_<var>VHOSTS </var>is also set, details of the virtual host configuration will be printed. If -D <var>DUMP</var>_<var>MODULES </var> is set, all loaded modules will be printed.</dd> <dt><code>-v</code></dt> <dd>Print the version of <code>httpd</code>, and then exit.</dd> <dt><code>-V</code></dt> <dd>Print the version and build parameters of <code>httpd</code>, and then exit.</dd> <dt><code>-X</code></dt> <dd>Run httpd in debug mode. Only one worker will be started and the server will not detach from the console.</dd> </dl> <p>The following arguments are available only on the <a href=\"../platform/windows\">Windows platform</a>:</p> <dl> <dt><code>-k install|config|uninstall</code></dt> <dd>Install Apache httpd as a Windows NT service; change startup options for the Apache httpd service; and uninstall the Apache httpd service.</dd> <dt><code>-n name</code></dt> <dd>The <var>name</var> of the Apache httpd service to signal.</dd> <dt><code>-w</code></dt> <dd>Keep the console window open on error so that the error message can be read.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/httpd.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/httpd.html</a>\n  </p>\n</div>\n","programs/apachectl":"<h1>apachectl - Apache HTTP Server Control Interface</h1>  <p><code>apachectl</code> is a front end to the Apache HyperText Transfer Protocol (HTTP) server. It is designed to help the administrator control the functioning of the Apache <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon.</p> <p>The <code>apachectl</code> script can operate in two modes. First, it can act as a simple front-end to the <code class=\"program\"><a href=\"httpd\">httpd</a></code> command that simply sets any necessary environment variables and then invokes <code class=\"program\"><a href=\"httpd\">httpd</a></code>, passing through any command line arguments. Second, <code>apachectl</code> can act as a SysV init script, taking simple one-word arguments like <code>start</code>, <code>restart</code>, and <code>stop</code>, and translating them into appropriate signals to <code class=\"program\"><a href=\"httpd\">httpd</a></code>.</p> <p>If your Apache installation uses non-standard paths, you will need to edit the <code>apachectl</code> script to set the appropriate paths to the <code class=\"program\"><a href=\"httpd\">httpd</a></code> binary. You can also specify any necessary <code class=\"program\"><a href=\"httpd\">httpd</a></code> command line arguments. See the comments in the script for details.</p> <p>The <code>apachectl</code> script returns a 0 exit value on success, and &gt;0 if an error occurs. For more details, view the comments in the script.</p>     <h2 id=\"synopsis\">Synopsis</h2> <p>When acting in pass-through mode, <code>apachectl</code> can take all the arguments available for the <code class=\"program\"><a href=\"httpd\">httpd</a></code> binary.</p> <pre>apachectl [ httpd-argument ]</pre> <p>When acting in SysV init mode, <code>apachectl</code> takes simple, one-word commands, defined below.</p> <pre>apachectl command</pre>   <h2 id=\"options\">Options</h2> <p>Only the SysV init-style options are defined here. Other arguments are defined on the <code class=\"program\"><a href=\"httpd\">httpd</a></code> manual page.</p> <dl> <dt><code>start</code></dt> <dd>Start the Apache <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon. Gives an error if it is already running. This is equivalent to <code>apachectl -k start</code>.</dd> <dt><code>stop</code></dt> <dd>Stops the Apache <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon. This is equivalent to <code>apachectl -k stop</code>.</dd> <dt><code>restart</code></dt> <dd>Restarts the Apache <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon. If the daemon is not running, it is started. This command automatically checks the configuration files as in <code>configtest</code> before initiating the restart to make sure the daemon doesn't die. This is equivalent to <code>apachectl -k restart</code>.</dd> <dt><code>fullstatus</code></dt> <dd>Displays a full status report from <code class=\"module\"><a href=\"../mod/mod_status\">mod_status</a></code>. For this to work, you need to have <code class=\"module\"><a href=\"../mod/mod_status\">mod_status</a></code> enabled on your server and a text-based browser such as <code>lynx</code> available on your system. The URL used to access the status report can be set by editing the <code>STATUSURL</code> variable in the script.</dd> <dt><code>status</code></dt> <dd>Displays a brief status report. Similar to the <code>fullstatus</code> option, except that the list of requests currently being served is omitted.</dd> <dt><code>graceful</code></dt> <dd>Gracefully restarts the Apache <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon. If the daemon is not running, it is started. This differs from a normal restart in that currently open connections are not aborted. A side effect is that old log files will not be closed immediately. This means that if used in a log rotation script, a substantial delay may be necessary to ensure that the old log files are closed before processing them. This command automatically checks the configuration files as in <code>configtest</code> before initiating the restart to make sure Apache doesn't die. This is equivalent to <code>apachectl -k graceful</code>.</dd> <dt><code>graceful-stop</code></dt> <dd>Gracefully stops the Apache <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon. This differs from a normal stop in that currently open connections are not aborted. A side effect is that old log files will not be closed immediately. This is equivalent to <code>apachectl -k graceful-stop</code>.</dd> <dt><code>configtest</code></dt> <dd>Run a configuration file syntax test. It parses the configuration files and either reports <code>Syntax Ok</code> or detailed information about the particular syntax error. This is equivalent to <code>apachectl -t</code>.</dd> </dl> <p>The following option was available in earlier versions but has been removed.</p> <dl> <dt><code>startssl</code></dt> <dd>To start <code class=\"program\"><a href=\"httpd\">httpd</a></code> with SSL support, you should edit your configuration file to include the relevant directives and then use the normal <code>apachectl start</code>.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/apachectl.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/apachectl.html</a>\n  </p>\n</div>\n","mod/mpm_winnt":"<h1>Apache MPM winnt</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Multi-Processing Module optimized for Windows NT.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mpm_winnt_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mpm_winnt.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This Multi-Processing Module (MPM) is the default for the Windows NT operating systems. It uses a single control process which launches a single child process which in turn creates threads to handle requests</p> <p>Capacity is configured using the <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code> directive, which sets the maximum number of concurrent client connections.</p> <p>By default, this MPM uses advanced Windows APIs for accepting new client connections. In some configurations, third-party products may interfere with this implementation, with the following messages written to the web server log:</p> <div class=\"example\"><pre>Child: Encountered too many AcceptEx faults accepting client connections.\nwinnt_mpm: falling back to 'AcceptFilter none'.</pre></div> <p>The MPM falls back to a safer implementation, but some client requests were not processed correctly. In order to avoid this error, use <code class=\"directive\"><a href=\"core#acceptfilter\">AcceptFilter</a></code> with accept filter <code>none</code>.</p> <pre class=\"prettyprint lang-config\">AcceptFilter http none\nAcceptFilter https none</pre> <p><em>In Apache httpd 2.0 and 2.2, <code class=\"directive\">Win32DisableAcceptEx</code> was used for this purpose.</em></p> <p>The WinNT MPM differs from the Unix MPMs such as worker and event in several areas:</p> <ul> <li>When a child process is exiting due to shutdown, restart, or <code class=\"directive\"><a href=\"mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code>, active requests in the exiting process have <code class=\"directive\"><a href=\"core#timeout\">TimeOut</a></code> seconds to finish before processing is aborted. Alternate types of restart and shutdown are not implemented.</li> <li>New child processes read the configuration files instead of inheriting the configuration from the parent. The behavior will be the same as on Unix if the child process is created at startup or restart, but if a child process is created because the prior one crashed or reached <code class=\"directive\"><a href=\"mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code>, any pending changes to the configuration will become active in the child at that point, and the parent and child will be using a different configuration. If planned configuration changes have been partially implemented and the current configuration cannot be parsed, the replacement child process cannot start up and the server will halt. Because of this behavior, configuration files should not be changed until the time of a server restart.</li> <li>The <code>monitor</code> and <code>fatal_exception</code> hooks are not currently implemented.</li> <li>\n<code class=\"directive\">AcceptFilter</code> is implemented in the MPM and has a different type of control over handling of new connections. (Refer to the <code class=\"directive\"><a href=\"core#acceptfilter\">AcceptFilter</a></code> documentation for details.)</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mpm_winnt.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mpm_winnt.html</a>\n  </p>\n</div>\n","mod/worker":"<h1>Apache MPM worker</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Multi-Processing Module implementing a hybrid multi-threaded multi-process web server</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mpm_worker_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>worker.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This Multi-Processing Module (MPM) implements a hybrid multi-process multi-threaded server. By using threads to serve requests, it is able to serve a large number of requests with fewer system resources than a process-based server. However, it retains much of the stability of a process-based server by keeping multiple processes available, each with many threads.</p> <p>The most important directives used to control this MPM are <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code>, which controls the number of threads deployed by each child process and <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code>, which controls the maximum total number of threads that may be launched.</p>     <h2 id=\"how-it-works\">How it Works</h2> <p>A single control process (the parent) is responsible for launching child processes. Each child process creates a fixed number of server threads as specified in the <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code> directive, as well as a listener thread which listens for connections and passes them to a server thread for processing when they arrive.</p> <p>Apache HTTP Server always tries to maintain a pool of <dfn>spare</dfn> or idle server threads, which stand ready to serve incoming requests. In this way, clients do not need to wait for a new threads or processes to be created before their requests can be served. The number of processes that will initially launch is set by the <code class=\"directive\"><a href=\"mpm_common#startservers\">StartServers</a></code> directive. During operation, the server assesses the total number of idle threads in all processes, and forks or kills processes to keep this number within the boundaries specified by <code class=\"directive\"><a href=\"mpm_common#minsparethreads\">MinSpareThreads</a></code> and <code class=\"directive\"><a href=\"mpm_common#maxsparethreads\">MaxSpareThreads</a></code>. Since this process is very self-regulating, it is rarely necessary to modify these directives from their default values. The maximum number of clients that may be served simultaneously (i.e., the maximum total number of threads in all processes) is determined by the <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> directive. The maximum number of active child processes is determined by the <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> directive divided by the <code class=\"directive\"><a href=\"mpm_common#threadsperchild\"> ThreadsPerChild</a></code> directive.</p> <p>Two directives set hard limits on the number of active child processes and the number of server threads in a child process, and can only be changed by fully stopping the server and then starting it again. <code class=\"directive\"><a href=\"mpm_common#serverlimit\">ServerLimit </a></code> is a hard limit on the number of active child processes, and must be greater than or equal to the <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> directive divided by the <code class=\"directive\"><a href=\"mpm_common#threadsperchild\"> ThreadsPerChild</a></code> directive. <code class=\"directive\"><a href=\"mpm_common#threadlimit\">ThreadLimit</a></code> is a hard limit of the number of server threads, and must be greater than or equal to the <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code> directive.</p> <p>In addition to the set of active child processes, there may be additional child processes which are terminating, but where at least one server thread is still handling an existing client connection. Up to <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> terminating processes may be present, though the actual number can be expected to be much smaller. This behavior can be avoided by disabling the termination of individual child processes, which is achieved using the following:</p> <ul> <li>set the value of <code class=\"directive\"><a href=\"mpm_common#maxconnectionsperchild\"> MaxConnectionsPerChild</a></code> to zero</li> <li>set the value of <code class=\"directive\"><a href=\"mpm_common#maxsparethreads\"> MaxSpareThreads</a></code> to the same value as <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code>\n</li> </ul> <p>A typical configuration of the process-thread controls in the <code class=\"module\"><a href=\"worker\">worker</a></code> MPM could look as follows:</p> <pre class=\"prettyprint lang-config\">ServerLimit         16\nStartServers         2\nMaxRequestWorkers  150\nMinSpareThreads     25\nMaxSpareThreads     75\nThreadsPerChild     25</pre> <p>While the parent process is usually started as <code>root</code> under Unix in order to bind to port 80, the child processes and threads are launched by the server as a less-privileged user. The <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> and <code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code> directives are used to set the privileges of the Apache HTTP Server child processes. The child processes must be able to read all the content that will be served, but should have as few privileges beyond that as possible. In addition, unless <code class=\"program\"><a href=\"../programs/suexec\">suexec</a></code> is used, these directives also set the privileges which will be inherited by CGI scripts.</p> <p><code class=\"directive\"><a href=\"mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code> controls how frequently the server recycles processes by killing old ones and launching new ones.</p> <p>This MPM uses the <code>mpm-accept</code> mutex to serialize access to incoming connections when subject to the thundering herd problem (generally, when there are multiple listening sockets). The implementation aspects of this mutex can be configured with the <code class=\"directive\"><a href=\"core#mutex\">Mutex</a></code> directive. The <a href=\"../misc/perf-tuning\">performance hints</a> documentation has additional information about this mutex.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/worker.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/worker.html</a>\n  </p>\n</div>\n","mod/prefork":"<h1>Apache MPM prefork</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Implements a non-threaded, pre-forking web server</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mpm_prefork_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>prefork.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This Multi-Processing Module (MPM) implements a non-threaded, pre-forking web server. Each server process may answer incoming requests, and a parent process manages the size of the server pool. It is appropriate for sites that need to avoid threading for compatibility with non-thread-safe libraries. It is also the best MPM for isolating each request, so that a problem with a single request will not affect any other.</p> <p>This MPM is very self-regulating, so it is rarely necessary to adjust its configuration directives. Most important is that <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> be big enough to handle as many simultaneous requests as you expect to receive, but small enough to assure that there is enough physical RAM for all processes.</p>     <h2 id=\"how-it-works\">How it Works</h2> <p>A single control process is responsible for launching child processes which listen for connections and serve them when they arrive. Apache httpd always tries to maintain several <dfn>spare</dfn> or idle server processes, which stand ready to serve incoming requests. In this way, clients do not need to wait for a new child processes to be forked before their requests can be served.</p> <p>The <code class=\"directive\"><a href=\"mpm_common#startservers\">StartServers</a></code>, <code class=\"directive\"><a href=\"#minspareservers\">MinSpareServers</a></code>, <code class=\"directive\"><a href=\"#maxspareservers\">MaxSpareServers</a></code>, and <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> regulate how the parent process creates children to serve requests. In general, Apache httpd is very self-regulating, so most sites do not need to adjust these directives from their default values. Sites which need to serve more than 256 simultaneous requests may need to increase <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code>, while sites with limited memory may need to decrease <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> to keep the server from thrashing (swapping memory to disk and back). More information about tuning process creation is provided in the <a href=\"../misc/perf-tuning\">performance hints</a> documentation.</p> <p>While the parent process is usually started as <code>root</code> under Unix in order to bind to port 80, the child processes are launched by Apache httpd as a less-privileged user. The <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> and <code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code> directives are used to set the privileges of the Apache httpd child processes. The child processes must be able to read all the content that will be served, but should have as few privileges beyond that as possible.</p> <p><code class=\"directive\"><a href=\"mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code> controls how frequently the server recycles processes by killing old ones and launching new ones.</p> <p>This MPM uses the <code>mpm-accept</code> mutex to serialize access to incoming connections when subject to the thundering herd problem (generally, when there are multiple listening sockets). The implementation aspects of this mutex can be configured with the <code class=\"directive\"><a href=\"core#mutex\">Mutex</a></code> directive. The <a href=\"../misc/perf-tuning\">performance hints</a> documentation has additional information about this mutex.</p>   <div class=\"directive-section\">\n<h2 id=\"maxspareservers\">MaxSpareServers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of idle child server processes</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxSpareServers number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxSpareServers 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>prefork</td>\n</tr> </table> <p>The <code class=\"directive\">MaxSpareServers</code> directive sets the desired maximum number of <em>idle</em> child server processes. An idle process is one which is not handling a request. If there are more than <code class=\"directive\">MaxSpareServers</code> idle, then the parent process will kill off the excess processes.</p> <p>Tuning of this parameter should only be necessary on very busy sites. Setting this parameter to a large number is almost always a bad idea. If you are trying to set the value equal to or lower than <code class=\"directive\"><a href=\"#minspareservers\">MinSpareServers</a></code>, Apache HTTP Server will automatically adjust it to <code class=\"directive\">MinSpareServers</code><code>+ 1</code>.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#minspareservers\">MinSpareServers</a></code></li> <li><code class=\"directive\"><a href=\"mpm_common#startservers\">StartServers</a></code></li> <li><code class=\"directive\"><a href=\"mpm_common#maxsparethreads\">MaxSpareThreads</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"minspareservers\">MinSpareServers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Minimum number of idle child server processes</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MinSpareServers number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MinSpareServers 5</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>prefork</td>\n</tr> </table> <p>The <code class=\"directive\">MinSpareServers</code> directive sets the desired minimum number of <em>idle</em> child server processes. An idle process is one which is not handling a request. If there are fewer than <code class=\"directive\">MinSpareServers</code> idle, then the parent process creates new children: It will spawn one, wait a second, then spawn two, wait a second, then spawn four, and it will continue exponentially until it is spawning 32 children per second. It will stop whenever it satisfies the <code class=\"directive\">MinSpareServers</code> setting.</p> <p>Tuning of this parameter should only be necessary on very busy sites. Setting this parameter to a large number is almost always a bad idea.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#maxspareservers\">MaxSpareServers</a></code></li> <li><code class=\"directive\"><a href=\"mpm_common#startservers\">StartServers</a></code></li> <li><code class=\"directive\"><a href=\"mpm_common#minsparethreads\">MinSpareThreads</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/prefork.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/prefork.html</a>\n  </p>\n</div>\n","mod/mpm_netware":"<h1>Apache MPM netware</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Multi-Processing Module implementing an exclusively threaded web server optimized for Novell NetWare</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mpm_netware_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mpm_netware.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This Multi-Processing Module (MPM) implements an exclusively threaded web server that has been optimized for Novell NetWare.</p> <p>The main thread is responsible for launching child worker threads which listen for connections and serve them when they arrive. Apache HTTP Server always tries to maintain several <dfn>spare</dfn> or idle worker threads, which stand ready to serve incoming requests. In this way, clients do not need to wait for a new child threads to be spawned before their requests can be served.</p> <p>The <code class=\"directive\"><a href=\"mpm_common#startthreads\">StartThreads</a></code>, <code class=\"directive\"><a href=\"mpm_common#minsparethreads\">MinSpareThreads</a></code>, <code class=\"directive\"><a href=\"mpm_common#maxsparethreads\">MaxSpareThreads</a></code>, and <code class=\"directive\"><a href=\"#maxthreads\">MaxThreads</a></code> regulate how the main thread creates worker threads to serve requests. In general, Apache httpd is very self-regulating, so most sites do not need to adjust these directives from their default values. Sites with limited memory may need to decrease <code class=\"directive\"><a href=\"#maxthreads\">MaxThreads</a></code> to keep the server from thrashing (spawning and terminating idle threads). More information about tuning process creation is provided in the <a href=\"../misc/perf-tuning\">performance hints</a> documentation.</p> <p><code class=\"directive\"><a href=\"mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code> controls how frequently the server recycles processes by killing old ones and launching new ones. On the NetWare OS it is highly recommended that this directive remain set to 0. This allows worker threads to continue servicing requests indefinitely.</p>    <div class=\"directive-section\">\n<h2 id=\"maxthreads\">MaxThreads Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set the maximum number of worker threads</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxThreads number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxThreads 2048</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mpm_netware</td>\n</tr> </table> <p>The <code class=\"directive\">MaxThreads</code> directive sets the desired maximum number worker threads allowable. The default value is also the compiled in hard limit. Therefore it can only be lowered, for example:</p> <div class=\"example\"><pre>MaxThreads 512</pre></div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mpm_netware.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mpm_netware.html</a>\n  </p>\n</div>\n","mod/mpmt_os2":"<h1>Apache MPM os2</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Hybrid multi-process, multi-threaded MPM for OS/2</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mpm_mpmt_os2_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mpmt_os2.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The Server consists of a main, parent process and a small, static number of child processes.</p> <p>The parent process' job is to manage the child processes. This involves spawning children as required to ensure there are always <code class=\"directive\"><a href=\"mpm_common#startservers\">StartServers</a></code> processes accepting connections.</p> <p>Each child process consists of a pool of worker threads and a main thread that accepts connections and passes them to the workers via a work queue. The worker thread pool is dynamic, managed by a maintenance thread so that the number of idle threads is kept between <code class=\"directive\"><a href=\"mpm_common#minsparethreads\">MinSpareThreads</a></code> and <code class=\"directive\"><a href=\"mpm_common#maxsparethreads\">MaxSpareThreads</a></code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mpmt_os2.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mpmt_os2.html</a>\n  </p>\n</div>\n","mod/mod_so":"<h1>Apache Module mod_so</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Loading of executable code and modules into the server at start-up or restart time</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>so_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_so.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>This is a Base module (always included) on Windows</td>\n</tr>\n</table> <h3>Summary</h3> <p>On selected operating systems this module can be used to load modules into Apache HTTP Server at runtime via the <a href=\"../dso\">Dynamic Shared Object</a> (DSO) mechanism, rather than requiring a recompilation.</p> <p>On Unix, the loaded code typically comes from shared object files (usually with <code>.so</code> extension), on Windows this may either be the <code>.so</code> or <code>.dll</code> extension.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Modules built for one major version of the Apache HTTP Server will generally not work on another. (e.g. 1.3 vs. 2.0, or 2.0 vs. 2.2) There are usually API changes between one major version and another that require that modules be modified to work with the new version.</p> </div>     <h2 id=\"windows\">Creating Loadable Modules for Windows</h2> <div class=\"note\">\n<p><strong>Note</strong></p> <p>On Windows, where loadable files typically have a file extension of <code>.dll</code>, Apache httpd modules are called <code>mod_whatever.so</code>, just as they are on other platforms. However, you may encounter third-party modules, such as PHP for example, that continue to use the <code>.dll</code> convention.</p> <p>While <code>mod_so</code> still loads modules with <code>ApacheModuleFoo.dll</code> names, the new naming convention is preferred; if you are converting your loadable module for 2.0, please fix the name to this 2.0 convention.</p>\n</div> <p>The Apache httpd module API is unchanged between the Unix and Windows versions. Many modules will run on Windows with no or little change from Unix, although others rely on aspects of the Unix architecture which are not present in Windows, and will not work.</p> <p>When a module does work, it can be added to the server in one of two ways. As with Unix, it can be compiled into the server. Because Apache httpd for Windows does not have the <code>Configure</code> program of Apache httpd for Unix, the module's source file must be added to the ApacheCore project file, and its symbols must be added to the <code>os\\win32\\modules.c</code> file.</p> <p>The second way is to compile the module as a DLL, a shared library that can be loaded into the server at runtime, using the <code class=\"directive\">LoadModule</code> directive. These module DLLs can be distributed and run on any Apache httpd for Windows installation, without recompilation of the server.</p> <p>To create a module DLL, a small change is necessary to the module's source file: The module record must be exported from the DLL (which will be created later; see below). To do this, add the <code>AP_MODULE_DECLARE_DATA</code> (defined in the Apache httpd header files) to your module's module record definition. For example, if your module has:</p> <div class=\"example\"><pre>module foo_module;</pre></div> <p>Replace the above with:</p> <div class=\"example\"><pre>module AP_MODULE_DECLARE_DATA foo_module;</pre></div> <p>Note that this will only be activated on Windows, so the module can continue to be used, unchanged, with Unix if needed. Also, if you are familiar with <code>.DEF</code> files, you can export the module record with that method instead.</p> <p>Now, create a DLL containing your module. You will need to link this against the libhttpd.lib export library that is created when the libhttpd.dll shared library is compiled. You may also have to change the compiler settings to ensure that the Apache httpd header files are correctly located. You can find this library in your server root's modules directory. It is best to grab an existing module .dsp file from the tree to assure the build environment is configured correctly, or alternately compare the compiler and link options to your .dsp.</p> <p>This should create a DLL version of your module. Now simply place it in the <code>modules</code> directory of your server root, and use the <code class=\"directive\">LoadModule</code> directive to load it.</p>   <div class=\"directive-section\">\n<h2 id=\"loadfile\">LoadFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Link in the named object file or library</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LoadFile filename [filename] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_so</td>\n</tr> </table> <p>The <code class=\"directive\">LoadFile</code> directive links in the named object files or libraries when the server is started or restarted; this is used to load additional code which may be required for some module to work. <em>Filename</em> is either an absolute path or relative to <a href=\"core#serverroot\">ServerRoot</a>.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">LoadFile \"libexec/libxmlparse.so\"</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"loadmodule\">LoadModule Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Links in the object file or library, and adds to the list of active modules</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LoadModule module filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_so</td>\n</tr> </table> <p>The <code class=\"directive\">LoadModule</code> directive links in the object file or library <em>filename</em> and adds the module structure named <em>module</em> to the list of active modules. <em>Module</em> is the name of the external variable of type <code>module</code> in the file, and is listed as the Module Identifier in the module documentation.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">LoadModule status_module \"modules/mod_status.so\"</pre> <p>loads the named module from the modules subdirectory of the ServerRoot.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_so.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_so.html</a>\n  </p>\n</div>\n","mod/mod_ldap":"<h1>Apache Module mod_ldap</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>LDAP connection pooling and result caching services for use by other LDAP modules</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>ldap_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>util_ldap.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module was created to improve the performance of websites relying on backend connections to LDAP servers. In addition to the functions provided by the standard LDAP libraries, this module adds an LDAP connection pool and an LDAP shared memory cache.</p> <p>To enable this module, LDAP support must be compiled into apr-util. This is achieved by adding the <code>--with-ldap</code> flag to the <code class=\"program\"><a href=\"../programs/configure\">configure</a></code> script when building Apache.</p> <p>SSL/TLS support is dependent on which LDAP toolkit has been linked to <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a>. As of this writing, APR-util supports: <a href=\"http://www.openldap.org/\">OpenLDAP SDK</a> (2.x or later), <a href=\"http://developer.novell.com/ndk/cldap.htm\">Novell LDAP SDK</a>, <a href=\"https://wiki.mozilla.org/LDAP_C_SDK\"> Mozilla LDAP SDK</a>, native Solaris LDAP SDK (Mozilla based) or the native Microsoft LDAP SDK. See the <a href=\"http://apr.apache.org\">APR</a> website for details.</p>     <h2 id=\"exampleconfig\">Example Configuration</h2> <p>The following is an example configuration that uses <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> to increase the performance of HTTP Basic authentication provided by <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code>.</p> <pre class=\"prettyprint lang-config\"># Enable the LDAP connection pool and shared\n# memory cache. Enable the LDAP cache status\n# handler. Requires that mod_ldap and mod_authnz_ldap\n# be loaded. Change the \"yourdomain.example.com\" to\n# match your domain.\n\nLDAPSharedCacheSize 500000\nLDAPCacheEntries 1024\nLDAPCacheTTL 600\nLDAPOpCacheEntries 1024\nLDAPOpCacheTTL 600\n\n&lt;Location \"/ldap-status\"&gt;\n    SetHandler ldap-status\n\n    Require host yourdomain.example.com\n\n    Satisfy any\n    AuthType Basic\n    AuthName \"LDAP Protected\"\n    AuthBasicProvider ldap\n    AuthLDAPURL \"ldap://127.0.0.1/dc=example,dc=com?uid?one\"\n    Require valid-user\n&lt;/Location&gt;</pre>   <h2 id=\"pool\">LDAP Connection Pool</h2> <p>LDAP connections are pooled from request to request. This allows the LDAP server to remain connected and bound ready for the next request, without the need to unbind/connect/rebind. The performance advantages are similar to the effect of HTTP keepalives.</p> <p>On a busy server it is possible that many requests will try and access the same LDAP server connection simultaneously. Where an LDAP connection is in use, Apache will create a new connection alongside the original one. This ensures that the connection pool does not become a bottleneck.</p> <p>There is no need to manually enable connection pooling in the Apache configuration. Any module using this module for access to LDAP services will share the connection pool.</p> <p>LDAP connections can keep track of the ldap client credentials used when binding to an LDAP server. These credentials can be provided to LDAP servers that do not allow anonymous binds during referral chasing. To control this feature, see the <code class=\"directive\"><a href=\"#ldapreferrals\">LDAPReferrals</a></code> and <code class=\"directive\"><a href=\"#ldapreferralhoplimit\">LDAPReferralHopLimit</a></code> directives. By default, this feature is enabled.</p>   <h2 id=\"cache\">LDAP Cache</h2> <p>For improved performance, <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> uses an aggressive caching strategy to minimize the number of times that the LDAP server must be contacted. Caching can easily double or triple the throughput of Apache when it is serving pages protected with mod_authnz_ldap. In addition, the load on the LDAP server will be significantly decreased.</p> <p><code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> supports two types of LDAP caching during the search/bind phase with a <em>search/bind cache</em> and during the compare phase with two <em>operation caches</em>. Each LDAP URL that is used by the server has its own set of these three caches.</p> <h3><a name=\"search-bind\" id=\"search-bind\">The Search/Bind Cache</a></h3> <p>The process of doing a search and then a bind is the most time-consuming aspect of LDAP operation, especially if the directory is large. The search/bind cache is used to cache all searches that resulted in successful binds. Negative results (<em>i.e.</em>, unsuccessful searches, or searches that did not result in a successful bind) are not cached. The rationale behind this decision is that connections with invalid credentials are only a tiny percentage of the total number of connections, so by not caching invalid credentials, the size of the cache is reduced.</p> <p><code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> stores the username, the DN retrieved, the password used to bind, and the time of the bind in the cache. Whenever a new connection is initiated with the same username, <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> compares the password of the new connection with the password in the cache. If the passwords match, and if the cached entry is not too old, <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> bypasses the search/bind phase.</p> <p>The search and bind cache is controlled with the <code class=\"directive\"><a href=\"#ldapcacheentries\">LDAPCacheEntries</a></code> and <code class=\"directive\"><a href=\"#ldapcachettl\">LDAPCacheTTL</a></code> directives.</p> <h3><a name=\"opcaches\" id=\"opcaches\">Operation Caches</a></h3> <p>During attribute and distinguished name comparison functions, <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> uses two operation caches to cache the compare operations. The first compare cache is used to cache the results of compares done to test for LDAP group membership. The second compare cache is used to cache the results of comparisons done between distinguished names.</p> <p>Note that, when group membership is being checked, any sub-group comparison results are cached to speed future sub-group comparisons.</p> <p>The behavior of both of these caches is controlled with the <code class=\"directive\"><a href=\"#ldapopcacheentries\">LDAPOpCacheEntries</a></code> and <code class=\"directive\"><a href=\"#ldapopcachettl\">LDAPOpCacheTTL</a></code> directives.</p> <h3><a name=\"monitoring\" id=\"monitoring\">Monitoring the Cache</a></h3> <p><code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> has a content handler that allows administrators to monitor the cache performance. The name of the content handler is <code>ldap-status</code>, so the following directives could be used to access the <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> cache information:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/server/cache-info\"&gt;\n    SetHandler ldap-status\n&lt;/Location&gt;</pre> <p>By fetching the URL <code>http://servername/cache-info</code>, the administrator can get a status report of every cache that is used by <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> cache. Note that if Apache does not support shared memory, then each <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> instance has its own cache, so reloading the URL will result in different information each time, depending on which <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> instance processes the request.</p>   <h2 id=\"usingssltls\">Using SSL/TLS</h2> <p>The ability to create an SSL and TLS connections to an LDAP server is defined by the directives <code class=\"directive\"><a href=\"#ldaptrustedglobalcert\">LDAPTrustedGlobalCert</a></code>, <code class=\"directive\"><a href=\"#ldaptrustedclientcert\">LDAPTrustedClientCert</a></code> and <code class=\"directive\"><a href=\"#ldaptrustedmode\">LDAPTrustedMode</a></code>. These directives specify the CA and optional client certificates to be used, as well as the type of encryption to be used on the connection (none, SSL or TLS/STARTTLS).</p> <pre class=\"prettyprint lang-config\"># Establish an SSL LDAP connection on port 636. Requires that\n# mod_ldap and mod_authnz_ldap be loaded. Change the\n# \"yourdomain.example.com\" to match your domain.\n\nLDAPTrustedGlobalCert CA_DER \"/certs/certfile.der\"\n\n&lt;Location \"/ldap-status\"&gt;\n    SetHandler ldap-status\n\n    Require host yourdomain.example.com\n\n    Satisfy any\n    AuthType Basic\n    AuthName \"LDAP Protected\"\n    AuthBasicProvider ldap\n    AuthLDAPURL \"ldaps://127.0.0.1/dc=example,dc=com?uid?one\"\n    Require valid-user\n&lt;/Location&gt;</pre> <pre class=\"prettyprint lang-config\"># Establish a TLS LDAP connection on port 389. Requires that\n# mod_ldap and mod_authnz_ldap be loaded. Change the\n# \"yourdomain.example.com\" to match your domain.\n\nLDAPTrustedGlobalCert CA_DER \"/certs/certfile.der\"\n\n&lt;Location \"/ldap-status\"&gt;\n    SetHandler ldap-status\n\n    Require host yourdomain.example.com\n\n    Satisfy any\n    AuthType Basic\n    AuthName \"LDAP Protected\"\n    AuthBasicProvider ldap\n    AuthLDAPURL \"ldap://127.0.0.1/dc=example,dc=com?uid?one\" TLS\n    Require valid-user\n&lt;/Location&gt;</pre>   <h2 id=\"settingcerts\">SSL/TLS Certificates</h2> <p>The different LDAP SDKs have widely different methods of setting and handling both CA and client side certificates.</p> <p>If you intend to use SSL or TLS, read this section CAREFULLY so as to understand the differences between configurations on the different LDAP toolkits supported.</p> <h3><a name=\"settingcerts-netscape\" id=\"settingcerts-netscape\">Netscape/Mozilla/iPlanet SDK</a></h3> <p>CA certificates are specified within a file called cert7.db. The SDK will not talk to any LDAP server whose certificate was not signed by a CA specified in this file. If client certificates are required, an optional key3.db file may be specified with an optional password. The secmod file can be specified if required. These files are in the same format as used by the Netscape Communicator or Mozilla web browsers. The easiest way to obtain these files is to grab them from your browser installation.</p> <p>Client certificates are specified per connection using the LDAPTrustedClientCert directive by referring to the certificate \"nickname\". An optional password may be specified to unlock the certificate's private key.</p> <p>The SDK supports SSL only. An attempt to use STARTTLS will cause an error when an attempt is made to contact the LDAP server at runtime.</p> <pre class=\"prettyprint lang-config\"># Specify a Netscape CA certificate file\nLDAPTrustedGlobalCert CA_CERT7_DB \"/certs/cert7.db\"\n# Specify an optional key3.db file for client certificate support\nLDAPTrustedGlobalCert CERT_KEY3_DB \"/certs/key3.db\"\n# Specify the secmod file if required\nLDAPTrustedGlobalCert CA_SECMOD \"/certs/secmod\"\n&lt;Location \"/ldap-status\"&gt;\n    SetHandler ldap-status\n\n    Require host yourdomain.example.com\n\n    Satisfy any\n    AuthType Basic\n    AuthName \"LDAP Protected\"\n    AuthBasicProvider ldap\n    LDAPTrustedClientCert CERT_NICKNAME &lt;nickname&gt; [password]\n    AuthLDAPURL \"ldaps://127.0.0.1/dc=example,dc=com?uid?one\"\n    Require valid-user\n&lt;/Location&gt;</pre> <h3><a name=\"settingcerts-novell\" id=\"settingcerts-novell\">Novell SDK</a></h3> <p>One or more CA certificates must be specified for the Novell SDK to work correctly. These certificates can be specified as binary DER or Base64 (PEM) encoded files.</p> <p>Note: Client certificates are specified globally rather than per connection, and so must be specified with the LDAPTrustedGlobalCert directive as below. Trying to set client certificates via the LDAPTrustedClientCert directive will cause an error to be logged when an attempt is made to connect to the LDAP server..</p> <p>The SDK supports both SSL and STARTTLS, set using the LDAPTrustedMode parameter. If an ldaps:// URL is specified, SSL mode is forced, override this directive.</p> <pre class=\"prettyprint lang-config\"># Specify two CA certificate files\nLDAPTrustedGlobalCert CA_DER \"/certs/cacert1.der\"\nLDAPTrustedGlobalCert CA_BASE64 \"/certs/cacert2.pem\"\n# Specify a client certificate file and key\nLDAPTrustedGlobalCert CERT_BASE64 \"/certs/cert1.pem\"\nLDAPTrustedGlobalCert KEY_BASE64 \"/certs/key1.pem\" [password]\n# Do not use this directive, as it will throw an error\n#LDAPTrustedClientCert CERT_BASE64 \"/certs/cert1.pem\"</pre> <h3><a name=\"settingcerts-openldap\" id=\"settingcerts-openldap\">OpenLDAP SDK</a></h3> <p>One or more CA certificates must be specified for the OpenLDAP SDK to work correctly. These certificates can be specified as binary DER or Base64 (PEM) encoded files.</p> <p>Both CA and client certificates may be specified globally (LDAPTrustedGlobalCert) or per-connection (LDAPTrustedClientCert). When any settings are specified per-connection, the global settings are superceded.</p> <p>The documentation for the SDK claims to support both SSL and STARTTLS, however STARTTLS does not seem to work on all versions of the SDK. The SSL/TLS mode can be set using the LDAPTrustedMode parameter. If an ldaps:// URL is specified, SSL mode is forced. The OpenLDAP documentation notes that SSL (ldaps://) support has been deprecated to be replaced with TLS, although the SSL functionality still works.</p> <pre class=\"prettyprint lang-config\"># Specify two CA certificate files\nLDAPTrustedGlobalCert CA_DER \"/certs/cacert1.der\"\nLDAPTrustedGlobalCert CA_BASE64 \"/certs/cacert2.pem\"\n&lt;Location \"/ldap-status\"&gt;\n    SetHandler ldap-status\n\n    Require host yourdomain.example.com\n\n    LDAPTrustedClientCert CERT_BASE64 \"/certs/cert1.pem\"\n    LDAPTrustedClientCert KEY_BASE64 \"/certs/key1.pem\"\n    # CA certs respecified due to per-directory client certs\n    LDAPTrustedClientCert CA_DER \"/certs/cacert1.der\"\n    LDAPTrustedClientCert CA_BASE64 \"/certs/cacert2.pem\"\n    Satisfy any\n    AuthType Basic\n    AuthName \"LDAP Protected\"\n    AuthBasicProvider ldap\n    AuthLDAPURL \"ldaps://127.0.0.1/dc=example,dc=com?uid?one\"\n    Require valid-user\n&lt;/Location&gt;</pre> <h3><a name=\"settingcerts-solaris\" id=\"settingcerts-solaris\">Solaris SDK</a></h3> <p>SSL/TLS for the native Solaris LDAP libraries is not yet supported. If required, install and use the OpenLDAP libraries instead.</p> <h3><a name=\"settingcerts-microsoft\" id=\"settingcerts-microsoft\">Microsoft SDK</a></h3> <p>SSL/TLS certificate configuration for the native Microsoft LDAP libraries is done inside the system registry, and no configuration directives are required.</p> <p>Both SSL and TLS are supported by using the ldaps:// URL format, or by using the LDAPTrustedMode directive accordingly.</p> <p>Note: The status of support for client certificates is not yet known for this toolkit.</p>   <div class=\"directive-section\">\n<h2 id=\"ldapcacheentries\">LDAPCacheEntries Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of entries in the primary LDAP cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPCacheEntries number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPCacheEntries 1024</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>Specifies the maximum size of the primary LDAP cache. This cache contains successful search/binds. Set it to 0 to turn off search/bind caching. The default size is 1024 cached searches.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapcachettl\">LDAPCacheTTL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Time that cached items remain valid</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPCacheTTL seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPCacheTTL 600</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>Specifies the time (in seconds) that an item in the search/bind cache remains valid. The default is 600 seconds (10 minutes).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapconnectionpoolttl\">LDAPConnectionPoolTTL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Discard backend connections that have been sitting in the connection pool too long</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPConnectionPoolTTL n</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPConnectionPoolTTL -1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Apache HTTP Server 2.3.12 and later</td>\n</tr> </table> <p>Specifies the maximum age, in seconds, that a pooled LDAP connection can remain idle and still be available for use. Connections are cleaned up when they are next needed, not asynchronously.</p> <p>A setting of 0 causes connections to never be saved in the backend connection pool. The default value of -1, and any other negative value, allows connections of any age to be reused.</p> <p>For performance reasons, the reference time used by this directive is based on when the LDAP connection is returned to the pool, not the time of the last successful I/O with the LDAP server. </p> <p>Since 2.4.10, new measures are in place to avoid the reference time from being inflated by cache hits or slow requests. First, the reference time is not updated if no backend LDAP conncetions were needed. Second, the reference time uses the time the HTTP request was received instead of the time the request is completed.</p> <div class=\"note\"><p>This timeout defaults to units of seconds, but accepts suffixes for milliseconds (ms), minutes (min), and hours (h). </p></div> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapconnectiontimeout\">LDAPConnectionTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the socket connection timeout in seconds</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPConnectionTimeout seconds</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>This directive configures the LDAP_OPT_NETWORK_TIMEOUT (or LDAP_OPT_CONNECT_TIMEOUT) option in the underlying LDAP client library, when available. This value typically controls how long the LDAP client library will wait for the TCP connection to the LDAP server to complete.</p> <p> If a connection is not successful with the timeout period, either an error will be returned or the LDAP client library will attempt to connect to a secondary LDAP server if one is specified (via a space-separated list of hostnames in the <code class=\"directive\"><a href=\"mod_authnz_ldap#authldapurl\">AuthLDAPURL</a></code>).</p> <p>The default is 10 seconds, if the LDAP client library linked with the server supports the LDAP_OPT_NETWORK_TIMEOUT option.</p> <div class=\"note\">LDAPConnectionTimeout is only available when the LDAP client library linked with the server supports the LDAP_OPT_NETWORK_TIMEOUT (or LDAP_OPT_CONNECT_TIMEOUT) option, and the ultimate behavior is dictated entirely by the LDAP client library. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"ldaplibrarydebug\">LDAPLibraryDebug Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable debugging in the LDAP SDK</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPLibraryDebug 7</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>disabled</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>Turns on SDK-specific LDAP debug options that generally cause the LDAP SDK to log verbose trace information to the main Apache error log. The trace messages from the LDAP SDK provide gory details that can be useful during debugging of connectivity problems with backend LDAP servers</p> <p>This option is only configurable when Apache HTTP Server is linked with an LDAP SDK that implements <code>LDAP_OPT_DEBUG</code> or <code>LDAP_OPT_DEBUG_LEVEL</code>, such as OpenLDAP (a value of 7 is verbose) or Tivoli Directory Server (a value of 65535 is verbose).</p> <div class=\"warning\"> <p>The logged information will likely contain plaintext credentials being used or validated by LDAP authentication, so care should be taken in protecting and purging the error log when this directive is used.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapopcacheentries\">LDAPOpCacheEntries Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of entries used to cache LDAP compare operations</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPOpCacheEntries number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPOpCacheEntries 1024</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>This specifies the number of entries <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> will use to cache LDAP compare operations. The default is 1024 entries. Setting it to 0 disables operation caching.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapopcachettl\">LDAPOpCacheTTL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Time that entries in the operation cache remain valid</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPOpCacheTTL seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPOpCacheTTL 600</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>Specifies the time (in seconds) that entries in the operation cache remain valid. The default is 600 seconds.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapreferralhoplimit\">LDAPReferralHopLimit Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The maximum number of referral hops to chase before terminating an LDAP query.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPReferralHopLimit number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SDK dependent, typically between 5 and 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>This directive, if enabled by the <code class=\"directive\">LDAPReferrals</code> directive, limits the number of referral hops that are followed before terminating an LDAP query.</p> <div class=\"warning\"> <p> Support for this tunable is uncommon in LDAP SDKs.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapreferrals\">LDAPReferrals Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable referral chasing during queries to the LDAP server.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPReferrals On|Off|default</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPReferrals On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The <var>default</var> parameter is available in Apache 2.4.7 and later</td>\n</tr> </table> <p>Some LDAP servers divide their directory among multiple domains and use referrals to direct a client when a domain boundary is crossed. This is similar to a HTTP redirect. LDAP client libraries may or may not chase referrals by default. This directive explicitly configures the referral chasing in the underlying SDK.</p> <p><code class=\"directive\">LDAPReferrals</code> takes the following values:</p> <dl> <dt>\"on\"</dt> <dd> <p> When set to \"on\", the underlying SDK's referral chasing state is enabled, <code class=\"directive\">LDAPReferralHopLimit</code> is used to override the SDK's hop limit, and an LDAP rebind callback is registered.</p>\n</dd> <dt>\"off\"</dt> <dd> <p> When set to \"off\", the underlying SDK's referral chasing state is disabled completely.</p>\n</dd> <dt>\"default\"</dt> <dd> <p> When set to \"default\", the underlying SDK's referral chasing state is not changed, <code class=\"directive\">LDAPReferralHopLimit</code> is not used to overide the SDK's hop limit, and no LDAP rebind callback is registered.</p>\n</dd> </dl> <p>The directive <code class=\"directive\">LDAPReferralHopLimit</code> works in conjunction with this directive to limit the number of referral hops to follow before terminating the LDAP query. When referral processing is enabled by a value of \"On\", client credentials will be provided, via a rebind callback, for any LDAP server requiring them.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapretries\">LDAPRetries Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures the number of LDAP server retries.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPRetries number-of-retries</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPRetries 3</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>The server will retry failed LDAP requests up to <code class=\"directive\">LDAPRetries</code> times. Setting this directive to 0 disables retries.</p> <p>LDAP errors such as timeouts and refused connections are retryable.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapretrydelay\">LDAPRetryDelay Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures the delay between LDAP server retries.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPRetryDelay seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPRetryDelay 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>If <code class=\"directive\">LDAPRetryDelay</code> is set to a non-zero value, the server will delay retrying an LDAP request for the specified amount of time. Setting this directive to 0 will result in any retry to occur without delay.</p> <p>LDAP errors such as timeouts and refused connections are retryable.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapsharedcachefile\">LDAPSharedCacheFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the shared memory cache file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPSharedCacheFile directory-path/filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>Specifies the directory path and file name of the shared memory cache file. If not set, anonymous shared memory will be used if the platform supports it.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapsharedcachesize\">LDAPSharedCacheSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Size in bytes of the shared-memory cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPSharedCacheSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPSharedCacheSize 500000</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>Specifies the number of bytes to allocate for the shared memory cache. The default is 500kb. If set to 0, shared memory caching will not be used and every HTTPD process will create its own cache.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldaptimeout\">LDAPTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the timeout for LDAP search and bind operations, in seconds</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPTimeout 60</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Apache HTTP Server 2.3.5 and later</td>\n</tr> </table> <p>This directive configures the timeout for bind and search operations, as well as the LDAP_OPT_TIMEOUT option in the underlying LDAP client library, when available.</p> <p> If the timeout expires, httpd will retry in case an existing connection has been silently dropped by a firewall. However, performance will be much better if the firewall is configured to send TCP RST packets instead of silently dropping packets.</p> <div class=\"note\"> <p>Timeouts for ldap compare operations requires an SDK with LDAP_OPT_TIMEOUT, such as OpenLDAP &gt;= 2.4.4.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"ldaptrustedclientcert\">LDAPTrustedClientCert Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the file containing or nickname referring to a per connection client certificate. Not all LDAP toolkits support per connection client certificates.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPTrustedClientCert type directory-path/filename/nickname [password]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>It specifies the directory path, file name or nickname of a per connection client certificate used when establishing an SSL or TLS connection to an LDAP server. Different locations or directories may have their own independent client certificate settings. Some LDAP toolkits (notably Novell) do not support per connection client certificates, and will throw an error on LDAP server connection if you try to use this directive (Use the LDAPTrustedGlobalCert directive instead for Novell client certificates - See the SSL/TLS certificate guide above for details). The type specifies the kind of certificate parameter being set, depending on the LDAP toolkit being used. Supported types are:</p> <ul> <li>CA_DER - binary DER encoded CA certificate</li> <li>CA_BASE64 - PEM encoded CA certificate</li> <li>CERT_DER - binary DER encoded client certificate</li> <li>CERT_BASE64 - PEM encoded client certificate</li> <li>CERT_NICKNAME - Client certificate \"nickname\" (Netscape SDK)</li> <li>KEY_DER - binary DER encoded private key</li> <li>KEY_BASE64 - PEM encoded private key</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"ldaptrustedglobalcert\">LDAPTrustedGlobalCert Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the file or database containing global trusted Certificate Authority or global client certificates</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPTrustedGlobalCert type directory-path/filename [password]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>It specifies the directory path and file name of the trusted CA certificates and/or system wide client certificates <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> should use when establishing an SSL or TLS connection to an LDAP server. Note that all certificate information specified using this directive is applied globally to the entire server installation. Some LDAP toolkits (notably Novell) require all client certificates to be set globally using this directive. Most other toolkits require clients certificates to be set per Directory or per Location using LDAPTrustedClientCert. If you get this wrong, an error may be logged when an attempt is made to contact the LDAP server, or the connection may silently fail (See the SSL/TLS certificate guide above for details). The type specifies the kind of certificate parameter being set, depending on the LDAP toolkit being used. Supported types are:</p> <ul> <li>CA_DER - binary DER encoded CA certificate</li> <li>CA_BASE64 - PEM encoded CA certificate</li> <li>CA_CERT7_DB - Netscape cert7.db CA certificate database file</li> <li>CA_SECMOD - Netscape secmod database file</li> <li>CERT_DER - binary DER encoded client certificate</li> <li>CERT_BASE64 - PEM encoded client certificate</li> <li>CERT_KEY3_DB - Netscape key3.db client certificate database file</li> <li>CERT_NICKNAME - Client certificate \"nickname\" (Netscape SDK)</li> <li>CERT_PFX - PKCS#12 encoded client certificate (Novell SDK)</li> <li>KEY_DER - binary DER encoded private key</li> <li>KEY_BASE64 - PEM encoded private key</li> <li>KEY_PFX - PKCS#12 encoded private key (Novell SDK)</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"ldaptrustedmode\">LDAPTrustedMode Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the SSL/TLS mode to be used when connecting to an LDAP server.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPTrustedMode type</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>The following modes are supported:</p> <ul> <li>NONE - no encryption</li> <li>SSL - ldaps:// encryption on default port 636</li> <li>TLS - STARTTLS encryption on default port 389</li> </ul> <p>Not all LDAP toolkits support all the above modes. An error message will be logged at runtime if a mode is not supported, and the connection to the LDAP server will fail. </p> <p>If an ldaps:// URL is specified, the mode becomes SSL and the setting of LDAPTrustedMode is ignored.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ldapverifyservercert\">LDAPVerifyServerCert Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Force server certificate verification</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LDAPVerifyServerCert On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LDAPVerifyServerCert On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ldap</td>\n</tr> </table> <p>Specifies whether to force the verification of a server certificate when establishing an SSL connection to the LDAP server.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_ldap.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_ldap.html</a>\n  </p>\n</div>\n","mod/event":"<h1>Apache MPM event</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>A variant of the <code class=\"module\"><a href=\"worker\">worker</a></code> MPM with the goal of consuming threads only for connections with active processing</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mpm_event_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>event.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The <code class=\"module\"><a href=\"event\">event</a></code> Multi-Processing Module (MPM) is designed to allow more requests to be served simultaneously by passing off some processing work to the listeners threads, freeing up the worker threads to serve new requests.</p> <p>To use the <code class=\"module\"><a href=\"event\">event</a></code> MPM, add <code>--with-mpm=event</code> to the <code class=\"program\"><a href=\"../programs/configure\">configure</a></code> script's arguments when building the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code>.</p>     <h2 id=\"event-worker-relationship\">Relationship with the Worker MPM</h2> <p><code class=\"module\"><a href=\"event\">event</a></code> is based on the <code class=\"module\"><a href=\"worker\">worker</a></code> MPM, which implements a hybrid multi-process multi-threaded server. A single control process (the parent) is responsible for launching child processes. Each child process creates a fixed number of server threads as specified in the <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code> directive, as well as a listener thread which listens for connections and passes them to a worker thread for processing when they arrive.</p> <p>Run-time configuration directives are identical to those provided by <code class=\"module\"><a href=\"worker\">worker</a></code>, with the only addition of the <code class=\"directive\">AsyncRequestWorkerFactor</code>.</p>   <h2 id=\"how-it-works\">How it Works</h2> <p>This MPM tries to fix the 'keep alive problem' in HTTP. After a client completes the first request, it can keep the connection open, sending further requests using the same socket and saving significant overhead in creating TCP connections. However, Apache HTTP Server traditionally keeps an entire child process/thread waiting for data from the client, which brings its own disadvantages. To solve this problem, this MPM uses a dedicated listener thread for each process to handle both the Listening sockets, all sockets that are in a Keep Alive state, sockets where the handler and protocol filters have done their work and the ones where the only remaining thing to do is send the data to the client. </p> <p>This new architecture, leveraging non-blocking sockets and modern kernel features exposed by <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> (like Linux's epoll), no longer requires the <code>mpm-accept</code> <code class=\"directive\"><a href=\"core#mutex\">Mutex</a></code> configured to avoid the thundering herd problem.</p> <p>The total amount of connections that a single process/threads block can handle is regulated by the <code class=\"directive\">AsyncRequestWorkerFactor</code> directive.</p> <h3><a name=\"async-connections\" id=\"async-connections\">Async connections</a></h3> <p>Async connections would need a fixed dedicated worker thread with the previous MPMs but not with event. The status page of <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> shows new columns under the Async connections section:</p> <dl> <dt>Writing</dt> <dd>While sending the response to the client, it might happen that the TCP write buffer fills up because the connection is too slow. Usually in this case a <code>write()</code> to the socket returns <code>EWOULDBLOCK</code> or <code>EAGAIN</code>, to become writable again after an idle time. The worker holding the socket might be able to offload the waiting task to the listener thread, that in turn will re-assign it to the first idle worker thread available once an event will be raised for the socket (for example, \"the socket is now writable\"). Please check the Limitations section for more information. </dd> <dt>Keep-alive</dt> <dd>Keep Alive handling is the most basic improvement from the worker MPM. Once a worker thread finishes to flush the response to the client, it can offload the socket handling to the listener thread, that in turns will wait for any event from the OS, like \"the socket is readable\". If any new request comes from the client, then the listener will forward it to the first worker thread available. Conversely, if the <code class=\"directive\"><a href=\"core#keepalivetimeout\">KeepAliveTimeout</a></code> occurs then the socket will be closed by the listener. In this way the worker threads are not responsible for idle sockets and they can be re-used to serve other requests.</dd> <dt>Closing</dt> <dd>Sometimes the MPM needs to perform a lingering close, namely sending back an early error to the client while it is still transmitting data to httpd. Sending the response and then closing the connection immediately is not the correct thing to do since the client (still trying to send the rest of the request) would get a connection reset and could not read the httpd's response. So in such cases, httpd tries to read the rest of the request to allow the client to consume the response. The lingering close is time bounded but it can take relatively long time, so a worker thread can offload this work to the listener.</dd> </dl> <p>These improvements are valid for both HTTP/HTTPS connections.</p> <h3><a name=\"limitations\" id=\"limitations\">Limitations</a></h3> <p>The improved connection handling may not work for certain connection filters that have declared themselves as incompatible with event. In these cases, this MPM will fall back to the behaviour of the <code class=\"module\"><a href=\"worker\">worker</a></code> MPM and reserve one worker thread per connection. All modules shipped with the server are compatible with the event MPM.</p> <p>A similar restriction is currently present for requests involving an output filter that needs to read and/or modify the whole response body. If the connection to the client blocks while the filter is processing the data, and the amount of data produced by the filter is too big to be buffered in memory, the thread used for the request is not freed while httpd waits until the pending data is sent to the client.<br> To illustrate this point we can think about the following two situations: serving a static asset (like a CSS file) versus serving content retrieved from FCGI/CGI or a proxied server. The former is predictable, namely the event MPM has full visibility on the end of the content and it can use events: the worker thread serving the response content can flush the first bytes until <code>EWOULDBLOCK</code> or <code>EAGAIN</code> is returned, delegating the rest to the listener. This one in turn waits for an event on the socket, and delegates the work to flush the rest of the content to the first idle worker thread. Meanwhile in the latter example (FCGI/CGI/proxied content) the MPM can't predict the end of the response and a worker thread has to finish its work before returning the control to the listener. The only alternative is to buffer the response in memory, but it wouldn't be the safest option for the sake of the server's stability and memory footprint. </p> <h3><a name=\"background\" id=\"background\">Background material</a></h3> <p>The event model was made possible by the introduction of new APIs into the supported operating systems:</p> <ul> <li>epoll (Linux) </li> <li>kqueue (BSD) </li> <li>event ports (Solaris) </li> </ul> <p>Before these new APIs where made available, the traditional <code>select</code> and <code>poll</code> APIs had to be used. Those APIs get slow if used to handle many connections or if the set of connections rate of change is high. The new APIs allow to monitor much more connections and they perform way better when the set of connections to monitor changes frequently. So these APIs made it possible to write the event MPM, that scales much better with the typical HTTP pattern of many idle connections.</p> <p>The MPM assumes that the underlying <code>apr_pollset</code> implementation is reasonably threadsafe. This enables the MPM to avoid excessive high level locking, or having to wake up the listener thread in order to send it a keep-alive socket. This is currently only compatible with KQueue and EPoll.</p>   <h2 id=\"requirements\">Requirements</h2> <p>This MPM depends on <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a>'s atomic compare-and-swap operations for thread synchronization. If you are compiling for an x86 target and you don't need to support 386s, or you are compiling for a SPARC and you don't need to run on pre-UltraSPARC chips, add <code>--enable-nonportable-atomics=yes</code> to the <code class=\"program\"><a href=\"../programs/configure\">configure</a></code> script's arguments. This will cause APR to implement atomic operations using efficient opcodes not available in older CPUs.</p> <p>This MPM does not perform well on older platforms which lack good threading, but the requirement for EPoll or KQueue makes this moot.</p> <ul> <li>To use this MPM on FreeBSD, FreeBSD 5.3 or higher is recommended. However, it is possible to run this MPM on FreeBSD 5.2.1, if you use <code>libkse</code> (see <code>man libmap.conf</code>).</li> <li>For NetBSD, at least version 2.0 is recommended.</li> <li>For Linux, a 2.6 kernel is recommended. It is also necessary to ensure that your version of <code>glibc</code> has been compiled with support for EPoll.</li> </ul>   <div class=\"directive-section\">\n<h2 id=\"asyncrequestworkerfactor\">AsyncRequestWorkerFactor Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limit concurrent connections per process</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AsyncRequestWorkerFactor factor</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>2</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>event</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.13 and later</td>\n</tr> </table> <p>The event MPM handles some connections in an asynchronous way, where request worker threads are only allocated for short periods of time as needed, and other connections with one request worker thread reserved per connection. This can lead to situations where all workers are tied up and no worker thread is available to handle new work on established async connections.</p> <p>To mitigate this problem, the event MPM does two things:</p> <ul> <li>it limits the number of connections accepted per process, depending on the number of idle request workers;</li> <li>if all workers are busy, it will close connections in keep-alive state even if the keep-alive timeout has not expired. This allows the respective clients to reconnect to a different process which may still have worker threads available.</li> </ul> <p>This directive can be used to fine-tune the per-process connection limit. A <strong>process</strong> will only accept new connections if the current number of connections (not counting connections in the \"closing\" state) is lower than:</p> <p class=\"indent\"><strong> <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code> + (<code class=\"directive\">AsyncRequestWorkerFactor</code> * <var>number of idle workers</var>) </strong></p> <p>An estimation of the maximum concurrent connections across all the processes given an average value of idle worker threads can be calculated with: </p> <p class=\"indent\"><strong> (<code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code> + (<code class=\"directive\">AsyncRequestWorkerFactor</code> * <var>number of idle workers</var>)) * <code class=\"directive\"><a href=\"mpm_common#serverlimit\">ServerLimit</a></code> </strong></p> <div class=\"note\">\n<p><strong>Example</strong></p> <pre class=\"prettyprint lang-config\">ThreadsPerChild = 10\nServerLimit = 4\nAsyncRequestWorkerFactor = 2\nMaxRequestWorkers = 40\n\nidle_workers = 4 (average for all the processes to keep it simple)\n\nmax_connections = (ThreadsPerChild + (AsyncRequestWorkerFactor * idle_workers)) * ServerLimit\n                = (10 + (2 * 4)) * 4 = 72</pre> </div> <p>When all the worker threads are idle, then absolute maximum numbers of concurrent connections can be calculared in a simpler way:</p> <p class=\"indent\"><strong> (<code class=\"directive\">AsyncRequestWorkerFactor</code> + 1) * <code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> </strong></p> <div class=\"note\">\n<p><strong>Example</strong></p> <pre class=\"prettyprint lang-config\">ThreadsPerChild = 10\nServerLimit = 4\nMaxRequestWorkers = 40\nAsyncRequestWorkerFactor = 2</pre> <p>If all the processes have all threads idle then: </p> <pre class=\"prettyprint lang-config\">idle_workers = 10</pre> <p>We can calculate the absolute maximum numbers of concurrent connections in two ways:</p> <pre class=\"prettyprint lang-config\">max_connections = (ThreadsPerChild + (AsyncRequestWorkerFactor * idle_workers)) * ServerLimit\n                = (10 + (2 * 10)) * 4 = 120\n\nmax_connections = (AsyncRequestWorkerFactor + 1) * MaxRequestWorkers\n                = (2 + 1) * 40 = 120</pre> </div> <p>Tuning <code class=\"directive\">AsyncRequestWorkerFactor</code> requires knowledge about the traffic handled by httpd in each specific use case, so changing the default value requires extensive testing and data gathering from <code class=\"module\"><a href=\"mod_status\">mod_status</a></code>.</p> <p><code class=\"directive\"><a href=\"mpm_common#maxrequestworkers\">MaxRequestWorkers</a></code> was called <code class=\"directive\">MaxClients</code> prior to version 2.3.13. The above value shows that the old name did not accurately describe its meaning for the event MPM.</p> <p><code class=\"directive\">AsyncRequestWorkerFactor</code> can take non-integer arguments, e.g \"1.5\".</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/event.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/event.html</a>\n  </p>\n</div>\n","mod/mod_actions":"<h1>Apache Module mod_actions</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Execute CGI scripts based on media type or request method.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>actions_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_actions.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module has two directives. The <code class=\"directive\"><a href=\"#action\">Action</a></code> directive lets you run CGI scripts whenever a file of a certain <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME content type</a> is requested. The <code class=\"directive\"><a href=\"#script\">Script</a></code> directive lets you run CGI scripts whenever a particular method is used in a request. This makes it much easier to execute scripts that process files.</p>    <div class=\"directive-section\">\n<h2 id=\"action\">Action Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Activates a CGI script for a particular handler or content-type</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Action action-type cgi-script [virtual]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_actions</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The <code>virtual</code> modifier and handler passing were introduced in Apache 2.1</td>\n</tr> </table> <p>This directive adds an action, which will activate <var>cgi-script</var> when <var>action-type</var> is triggered by the request. The <var>cgi-script</var> is the URL-path to a resource that has been designated as a CGI script using <code class=\"directive\"><a href=\"mod_alias#scriptalias\">ScriptAlias</a></code> or <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code>. The <var>action-type</var> can be either a <a href=\"../handler\">handler</a> or a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME content type</a>. It sends the URL and file path of the requested document using the standard CGI <code>PATH_INFO</code> and <code>PATH_TRANSLATED</code> environment variables. The handler used for the particular request is passed using the <code>REDIRECT_HANDLER</code> variable.</p> <div class=\"example\">\n<h3>Example: MIME type</h3>\n<pre class=\"prettyprint lang-config\"># Requests for files of a particular MIME content type:\nAction image/gif /cgi-bin/images.cgi</pre> </div> <p>In this example, requests for files with a MIME content type of <code>image/gif</code> will be handled by the specified cgi script <code>/cgi-bin/images.cgi</code>.</p> <div class=\"example\">\n<h3>Example: File extension</h3>\n<pre class=\"prettyprint lang-config\"># Files of a particular file extension\nAddHandler my-file-type .xyz\nAction my-file-type \"/cgi-bin/program.cgi\"</pre> </div> <p>In this example, requests for files with a file extension of <code>.xyz</code> are handled by the specified cgi script <code>/cgi-bin/program.cgi</code>.</p> <p>The optional <code>virtual</code> modifier turns off the check whether the requested file really exists. This is useful, for example, if you want to use the <code class=\"directive\">Action</code> directive in virtual locations.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/news\"&gt;\n    SetHandler news-handler\n    Action news-handler \"/cgi-bin/news.cgi\" virtual\n&lt;/Location&gt;</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"script\">Script Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Activates a CGI script for a particular request method.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Script method cgi-script</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_actions</td>\n</tr> </table> <p>This directive adds an action, which will activate <var>cgi-script</var> when a file is requested using the method of <var>method</var>. The <var>cgi-script</var> is the URL-path to a resource that has been designated as a CGI script using <code class=\"directive\"><a href=\"mod_alias#scriptalias\">ScriptAlias</a></code> or <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code>. The URL and file path of the requested document is sent using the standard CGI <code>PATH_INFO</code> and <code>PATH_TRANSLATED</code> environment variables.</p> <div class=\"note\"> Any arbitrary method name may be used. <strong>Method names are case-sensitive</strong>, so <code>Script PUT</code> and <code>Script put</code> have two entirely different effects. </div> <p>Note that the <code class=\"directive\">Script</code> command defines default actions only. If a CGI script is called, or some other resource that is capable of handling the requested method internally, it will do so. Also note that <code class=\"directive\">Script</code> with a method of <code>GET</code> will only be called if there are query arguments present (<em>e.g.</em>, foo.html?hi). Otherwise, the request will proceed normally.</p> <pre class=\"prettyprint lang-config\"># All GET requests go here\nScript GET \"/cgi-bin/search\"\n\n# A CGI PUT handler\nScript PUT \"/~bob/put.cgi\"</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_actions.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_actions.html</a>\n  </p>\n</div>\n","mod/mod_asis":"<h1>Apache Module mod_asis</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Sends files that contain their own HTTP headers</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>asis_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_asis.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides the handler <code>send-as-is</code> which causes Apache HTTP Server to send the document without adding most of the usual HTTP headers.</p> <p>This can be used to send any kind of data from the server, including redirects and other special HTTP responses, without requiring a cgi-script or an nph script.</p> <p>For historical reasons, this module will also process any file with the mime type <code>httpd/send-as-is</code>.</p>     <h2 id=\"usage\">Usage</h2> <p>In the server configuration file, associate files with the <code>send-as-is</code> handler <em>e.g.</em></p> <pre class=\"prettyprint lang-config\">AddHandler send-as-is asis</pre> <p>The contents of any file with a <code>.asis</code> extension will then be sent by Apache httpd to the client with almost no changes. In particular, HTTP headers are derived from the file itself according to <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> rules, so an asis file must include valid headers, and may also use the CGI <code>Status:</code> header to determine the HTTP response code. The <code>Content-Length:</code> header will automatically be inserted or, if included, corrected by httpd.</p> <p>Here's an example of a file whose contents are sent <em>as is</em> so as to tell the client that a file has redirected.</p> <div class=\"example\"><pre>Status: 301 Now where did I leave that URL\nLocation: http://xyz.example.com/foo/bar.html\nContent-type: text/html\n\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Lame excuses'R'us&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;Fred's exceptionally wonderful page has moved to\n&lt;a href=\"http://xyz.example.com/foo/bar.html\"&gt;Joe's&lt;/a&gt; site.\n&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre></div> <div class=\"note\">\n<p><strong>Notes:</strong></p> <p>The server always adds a <code>Date:</code> and <code>Server:</code> header to the data returned to the client, so these should not be included in the file. The server does <em>not</em> add a <code>Last-Modified</code> header; it probably should.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_asis.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_asis.html</a>\n  </p>\n</div>\n","mod/mod_info":"<h1>Apache Module mod_info</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides a comprehensive overview of the server configuration</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>info_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_info.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>To configure <code class=\"module\"><a href=\"mod_info\">mod_info</a></code>, add the following to your <code>httpd.conf</code> file.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/server-info\"&gt;\n    SetHandler server-info\n&lt;/Location&gt;</pre> <p>You may wish to use <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code> inside the <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> directive to limit access to your server configuration information:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/server-info\"&gt;\n    SetHandler server-info\n    Require host example.com\n&lt;/Location&gt;</pre> <p>Once configured, the server information is obtained by accessing <code>http://your.host.example.com/server-info</code></p>     <h2 id=\"security\">Security Issues</h2> <p>Once <code class=\"module\"><a href=\"mod_info\">mod_info</a></code> is loaded into the server, its handler capability is available in <em>all</em> configuration files, including per-directory files (<em>e.g.</em>, <code>.htaccess</code>). This may have security-related ramifications for your site.</p> <p>In particular, this module can leak sensitive information from the configuration directives of other Apache modules such as system paths, usernames/passwords, database names, etc. Therefore, this module should <strong>only</strong> be used in a controlled environment and always with caution.</p> <p>You will probably want to use <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code> to limit access to your server configuration information.</p> <div class=\"example\">\n<h3>Access control</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/server-info\"&gt;\n    SetHandler server-info\n    # Allow access from server itself\n    Require ip 127.0.0.1\n\n    # Additionally, allow access from local workstation\n    Require ip 192.168.1.17\n&lt;/Location&gt;</pre> </div>   <h2 id=\"queries\">Selecting the information shown</h2> <p>By default, the server information includes a list of all enabled modules, and for each module, a description of the directives understood by that module, the hooks implemented by that module, and the relevant directives from the current configuration.</p> <p>Other views of the configuration information are available by appending a query to the <code>server-info</code> request. For example, <code>http://your.host.example.com/server-info?config</code> will show all configuration directives.</p> <dl> <dt><code>?&lt;module-name&gt;</code></dt> <dd>Only information relevant to the named module</dd> <dt><code>?config</code></dt> <dd>Just the configuration directives, not sorted by module</dd> <dt><code>?hooks</code></dt> <dd>Only the list of Hooks each module is attached to</dd> <dt><code>?list</code></dt> <dd>Only a simple list of enabled modules</dd> <dt><code>?server</code></dt> <dd>Only the basic server information</dd> </dl>   <h2 id=\"startup\">Dumping the configuration on startup</h2> <p>If the config define <code>-DDUMP_CONFIG</code> is set, <code class=\"module\"><a href=\"mod_info\">mod_info</a></code> will dump the pre-parsed configuration to <code>stdout</code> during server startup. Pre-parsed means that directives like <code class=\"directive\"><a href=\"core#ifdefine\">&lt;IfDefine&gt;</a></code> and <code class=\"directive\"><a href=\"core#ifmodule\">&lt;IfModule&gt;</a></code> are evaluated and environment varialbles are replaced. However it does not represent the final state of the configuration. In particular, it does not represent the merging or overriding that may happen for repeated directives.</p> <p>This is roughly equivalent to the <code>?config</code> query.</p>   <h2 id=\"limitations\">Known Limitations</h2> <p><code class=\"module\"><a href=\"mod_info\">mod_info</a></code> provides its information by reading the parsed configuration, rather than reading the original configuration file. There are a few limitations as a result of the way the parsed configuration tree is created:</p> <ul> <li>Directives which are executed immediately rather than being stored in the parsed configuration are not listed. These include <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>, <code class=\"directive\"><a href=\"mod_so#loadmodule\">LoadModule</a></code>, and <code class=\"directive\"><a href=\"mod_so#loadfile\">LoadFile</a></code>.</li> <li>Directives which control the configuration file itself, such as <code class=\"directive\"><a href=\"core#include\">Include</a></code>, <code class=\"directive\"><a href=\"core#ifmodule\">&lt;IfModule&gt;</a></code> and <code class=\"directive\"><a href=\"core#ifdefine\">&lt;IfDefine&gt;</a></code> are not listed, but the included configuration directives are.</li> <li>Comments are not listed. (This may be considered a feature.)</li> <li>Configuration directives from <code>.htaccess</code> files are not listed (since they do not form part of the permanent server configuration).</li> <li>Container directives such as <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> are listed normally, but <code class=\"module\"><a href=\"mod_info\">mod_info</a></code> cannot figure out the line number for the closing <code class=\"directive\"><a href=\"core#directory\">&lt;/Directory&gt;</a></code>.</li> <li>Directives generated by third party modules such as <a href=\"http://perl.apache.org\">mod_perl</a> might not be listed.</li> </ul>   <div class=\"directive-section\">\n<h2 id=\"addmoduleinfo\">AddModuleInfo Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Adds additional information to the module information displayed by the server-info handler</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddModuleInfo module-name string</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_info</td>\n</tr> </table> <p>This allows the content of <var>string</var> to be shown as HTML interpreted, <strong>Additional Information</strong> for the module <var>module-name</var>. Example:</p> <pre class=\"prettyprint lang-config\">AddModuleInfo mod_deflate.c 'See &lt;a \\\n    href=\"http://httpd.apache.org/docs/2.4/mod/mod_deflate.html\"&gt;\\\n    http://httpd.apache.org/docs/2.4/mod/mod_deflate.html&lt;/a&gt;'</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_info.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_info.html</a>\n  </p>\n</div>\n","mod/mpm_common":"<h1>Apache MPM Common Directives</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>A collection of directives that are implemented by more than one multi-processing module (MPM)</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr>\n</table>    <div class=\"directive-section\">\n<h2 id=\"coredumpdirectory\">CoreDumpDirectory Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory where Apache HTTP Server attempts to switch before dumping core</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CoreDumpDirectory directory</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for the default setting</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>\n</td>\n</tr> </table> <p>This controls the directory to which Apache httpd attempts to switch before dumping core. If your operating system is configured to create core files in the working directory of the crashing process, <code class=\"directive\">CoreDumpDirectory</code> is necessary to change working directory from the default <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code> directory, which should not be writable by the user the server runs as.</p> <p>If you want a core dump for debugging, you can use this directive to place it in a different location. This directive has no effect if your operating system is not configured to write core files to the working directory of the crashing processes.</p> <div class=\"note\">\n<p><strong>Core Dumps on Linux</strong></p> <p>If Apache httpd starts as root and switches to another user, the Linux kernel <em>disables</em> core dumps even if the directory is writable for the process. Apache httpd (2.0.46 and later) reenables core dumps on Linux 2.4 and beyond, but only if you explicitly configure a <code class=\"directive\">CoreDumpDirectory</code>.</p> </div> <div class=\"note\"> <p><strong>Core Dumps on BSD</strong></p> <p>To enable core-dumping of suid-executables on BSD-systems (such as FreeBSD), set <code>kern.sugid_coredump</code> to 1. </p> </div> <div class=\"note\">\n<p><strong>Specific signals</strong></p> <p><code class=\"directive\">CoreDumpDirectory</code> processing only occurs for a select set of fatal signals: SIGFPE, SIGILL, SIGABORT, SIGSEGV, and SIGBUS.</p> <p>On some operating systems, SIGQUIT also results in a core dump but does not go through <code class=\"directive\">CoreDumpDirectory</code> or <code class=\"directive\">EnableExceptionHook</code> processing, so the core location is dictated entirely by the operating system.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"enableexceptionhook\">EnableExceptionHook Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables a hook that runs exception handlers after a crash</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>EnableExceptionHook On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>EnableExceptionHook Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>\n</td>\n</tr> </table> <p>For safety reasons this directive is only available if the server was configured with the <code>--enable-exception-hook</code> option. It enables a hook that allows external modules to plug in and do something after a child crashed.</p> <p>There are already two modules, <code>mod_whatkilledus</code> and <code>mod_backtrace</code> that make use of this hook. Please have a look at Jeff Trawick's <a href=\"http://people.apache.org/~trawick/exception_hook.html\">EnableExceptionHook site</a> for more information about these.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"gracefulshutdowntimeout\">GracefulShutdownTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify a timeout after which a gracefully shutdown server will exit.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>GracefulShutdownTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>GracefulShutdownTimeout 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>\n</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.2 and later</td>\n</tr> </table> <p>The <code class=\"directive\">GracefulShutdownTimeout</code> specifies how many seconds after receiving a \"graceful-stop\" signal, a server should continue to run, handling the existing connections.</p> <p>Setting this value to zero means that the server will wait indefinitely until all remaining requests have been fully served.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"listen\">Listen Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>IP addresses and ports that the server listens to</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Listen [IP-address:]portnumber [protocol]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The <var>protocol</var> argument was added in 2.1.5</td>\n</tr> </table> <p>The <code class=\"directive\">Listen</code> directive instructs Apache httpd to listen to only specific IP addresses or ports; by default it responds to requests on all IP interfaces. <code class=\"directive\">Listen</code> is now a required directive. If it is not in the config file, the server will fail to start. This is a change from previous versions of Apache httpd.</p> <p>The <code class=\"directive\">Listen</code> directive tells the server to accept incoming requests on the specified port or address-and-port combination. If only a port number is specified, the server listens to the given port on all interfaces. If an IP address is given as well as a port, the server will listen on the given port and interface.</p> <p>Multiple <code class=\"directive\">Listen</code> directives may be used to specify a number of addresses and ports to listen to. The server will respond to requests from any of the listed addresses and ports.</p> <p>For example, to make the server accept connections on both port 80 and port 8000, use:</p> <pre class=\"prettyprint lang-config\">Listen 80\nListen 8000</pre> <p>To make the server accept connections on two specified interfaces and port numbers, use </p> <pre class=\"prettyprint lang-config\">Listen 192.170.2.1:80\nListen 192.170.2.5:8000</pre> <p>IPv6 addresses must be surrounded in square brackets, as in the following example:</p> <pre class=\"prettyprint lang-config\">Listen [2001:db8::a00:20ff:fea7:ccea]:80</pre> <p>The optional <var>protocol</var> argument is not required for most configurations. If not specified, <code>https</code> is the default for port 443 and <code>http</code> the default for all other ports. The protocol is used to determine which module should handle a request, and to apply protocol specific optimizations with the <code class=\"directive\"><a href=\"core#acceptfilter\">AcceptFilter</a></code> directive.</p> <p>You only need to set the protocol if you are running on non-standard ports. For example, running an <code>https</code> site on port 8443:</p> <pre class=\"prettyprint lang-config\">Listen 192.170.2.1:8443 https</pre> <div class=\"note\">\n<p><strong>Error condition</strong></p> Multiple <code class=\"directive\">Listen</code> directives for the same ip address and port will result in an <code>Address already in use</code> error message. </div> <h3>See also</h3> <ul> <li><a href=\"../dns-caveats\">DNS Issues</a></li> <li><a href=\"../bind\">Setting which addresses and ports Apache HTTP Server uses</a></li> <li><a href=\"http://wiki.apache.org/httpd/CouldNotBindToAddress\">Further discussion of the <code>Address already in use</code> error message, including other causes.</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"listenbacklog\">ListenBackLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum length of the queue of pending connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ListenBacklog backlog</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ListenBacklog 511</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> </table> <p>The maximum length of the queue of pending connections. Generally no tuning is needed or desired, however on some systems it is desirable to increase this when under a TCP SYN flood attack. See the backlog parameter to the <code>listen(2)</code> system call.</p> <p>This will often be limited to a smaller number by the operating system. This varies from OS to OS. Also note that many OSes do not use exactly what is specified as the backlog, but use a number based on (but normally larger than) what is set.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"listencoresbucketsratio\">ListenCoresBucketsRatio Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Ratio between the number of CPU cores (online) and the number of listeners' buckets</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ListenCoresBucketsRatio ratio</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ListenCoresBucketsRatio 0 (disabled)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>\n</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.4.17, with a kernel supporting the socket option <code>SO_REUSEPORT</code> and distributing new connections evenly accross listening processes' (or threads') sockets using it (eg. Linux 3.9 and later, but not the current implementations of <code>SO_REUSEPORT</code> in *BSDs.</td>\n</tr> </table> <p>A <var>ratio</var> between the number of (online) CPU cores and the number of listeners' buckets can be used to make Apache HTTP Server create <code>num_cpu_cores / ratio</code> listening buckets, each containing its own <code class=\"directive\">Listen</code>-ing socket(s) on the same port(s), and then make each child handle a single bucket (with round-robin distribution of the buckets at children creation time).</p> <div class=\"note\">\n<p><strong>Meaning of \"online\" CPU core</strong></p> <p>On Linux (and also BSD) a CPU core can be turned on/off if <a href=\"https://www.kernel.org/doc/Documentation/cpu-hotplug.txt\">Hotplug</a> is configured, therefore <code class=\"directive\">ListenCoresBucketsRatio</code> needs to take this parameter into account while calculating the number of buckets to create.</p> </div> <p><code class=\"directive\">ListenCoresBucketsRatio</code> can improve the scalability when accepting new connections is/becomes the bottleneck. On systems with a large number of CPU cores, enabling this feature has been tested to show significant performances improvement and shorter responses time.</p> <p>There must be at least twice the number of CPU cores than the configured <var>ratio</var> for this to be active. The recommended <var>ratio</var> is <code>8</code>, hence at least <code>16</code> cores should be available at runtime when this value is used. The right <var>ratio</var> to obtain maximum performance needs to be calculated for each target system, testing multiple values and observing the variations in your key performance metrics.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"maxconnectionsperchild\">MaxConnectionsPerChild Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limit on the number of connections that an individual child server will handle during its life</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxConnectionsPerChild number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxConnectionsPerChild 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available Apache HTTP Server 2.3.9 and later. The old name <code>MaxRequestsPerChild</code> is still supported.</td>\n</tr> </table> <p>The <code class=\"directive\">MaxConnectionsPerChild</code> directive sets the limit on the number of connections that an individual child server process will handle. After <code class=\"directive\">MaxConnectionsPerChild</code> connections, the child process will die. If <code class=\"directive\">MaxConnectionsPerChild</code> is <code>0</code>, then the process will never expire.</p> <p>Setting <code class=\"directive\">MaxConnectionsPerChild</code> to a non-zero value limits the amount of memory that process can consume by (accidental) memory leakage.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"maxmemfree\">MaxMemFree Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum amount of memory that the main allocator is allowed to hold without calling <code>free()</code>\n</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxMemFree KBytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxMemFree 2048</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>\n</td>\n</tr> </table> <p>The <code class=\"directive\">MaxMemFree</code> directive sets the maximum number of free Kbytes that every allocator is allowed to hold without calling <code>free()</code>. In threaded MPMs, every thread has its own allocator. When set to zero, the threshold will be set to unlimited.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"maxrequestworkers\">MaxRequestWorkers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of connections that will be processed simultaneously</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxRequestWorkers number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>\n</td>\n</tr> </table> <p>The <code class=\"directive\">MaxRequestWorkers</code> directive sets the limit on the number of simultaneous requests that will be served. Any connection attempts over the <code class=\"directive\">MaxRequestWorkers</code> limit will normally be queued, up to a number based on the <code class=\"directive\"><a href=\"#listenbacklog\">ListenBacklog</a></code> directive. Once a child process is freed at the end of a different request, the connection will then be serviced.</p> <p>For non-threaded servers (<em>i.e.</em>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>), <code class=\"directive\">MaxRequestWorkers</code> translates into the maximum number of child processes that will be launched to serve requests. The default value is <code>256</code>; to increase it, you must also raise <code class=\"directive\"><a href=\"#serverlimit\">ServerLimit</a></code>.</p> <p>For threaded and hybrid servers (<em>e.g.</em> <code class=\"module\"><a href=\"event\">event</a></code> or <code class=\"module\"><a href=\"worker\">worker</a></code>) <code class=\"directive\">MaxRequestWorkers</code> restricts the total number of threads that will be available to serve clients. For hybrid MPMs the default value is <code>16</code> (<code class=\"directive\"><a href=\"#serverlimit\">ServerLimit</a></code>) multiplied by the value of <code>25</code> (<code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code>). Therefore, to increase <code class=\"directive\">MaxRequestWorkers</code> to a value that requires more than 16 processes, you must also raise <code class=\"directive\"><a href=\"#serverlimit\">ServerLimit</a></code>.</p> <p><code class=\"directive\">MaxRequestWorkers</code> was called <code class=\"directive\">MaxClients</code> before version 2.3.13. The old name is still supported.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"maxsparethreads\">MaxSpareThreads Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of idle threads</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxSpareThreads number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> </table> <p>Maximum number of idle threads. Different MPMs deal with this directive differently.</p> <p>For <code class=\"module\"><a href=\"worker\">worker</a></code> and <code class=\"module\"><a href=\"event\">event</a></code>, the default is <code>MaxSpareThreads 250</code>. These MPMs deal with idle threads on a server-wide basis. If there are too many idle threads in the server then child processes are killed until the number of idle threads is less than this number.</p> <p>For <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code> the default is <code>MaxSpareThreads 100</code>. Since this MPM runs a single-process, the spare thread count is also server-wide.</p> <p><code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code> works similar to <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>. For <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code> the default value is <code>10</code>.</p> <div class=\"note\">\n<p><strong>Restrictions</strong></p> <p>The range of the <code class=\"directive\">MaxSpareThreads</code> value is restricted. Apache httpd will correct the given value automatically according to the following rules:</p> <ul> <li>\n<code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code> wants the value to be greater than <code class=\"directive\"><a href=\"#minsparethreads\">MinSpareThreads</a></code>.</li> <li>For <code class=\"module\"><a href=\"worker\">worker</a></code> and <code class=\"module\"><a href=\"event\">event</a></code>, the value must be greater or equal to the sum of <code class=\"directive\"><a href=\"#minsparethreads\"> MinSpareThreads</a></code> and <code class=\"directive\"><a href=\"#threadsperchild\"> ThreadsPerChild</a></code>.</li> </ul> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#minsparethreads\">MinSpareThreads</a></code></li> <li><code class=\"directive\"><a href=\"#startservers\">StartServers</a></code></li> <li><code class=\"directive\"><a href=\"prefork#maxspareservers\">MaxSpareServers</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"minsparethreads\">MinSpareThreads Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Minimum number of idle threads available to handle request spikes</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MinSpareThreads number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> </table> <p>Minimum number of idle threads to handle request spikes. Different MPMs deal with this directive differently.</p> <p><code class=\"module\"><a href=\"worker\">worker</a></code> and <code class=\"module\"><a href=\"event\">event</a></code> use a default of <code>MinSpareThreads 75</code> and deal with idle threads on a server-wide basis. If there aren't enough idle threads in the server then child processes are created until the number of idle threads is greater than <var>number</var>.</p> <p><code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code> uses a default of <code>MinSpareThreads 10</code> and, since it is a single-process MPM, tracks this on a server-wide bases.</p> <p><code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code> works similar to <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>. For <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code> the default value is <code>5</code>.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#maxsparethreads\">MaxSpareThreads</a></code></li> <li><code class=\"directive\"><a href=\"#startservers\">StartServers</a></code></li> <li><code class=\"directive\"><a href=\"prefork#minspareservers\">MinSpareServers</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"pidfile\">PidFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File where the server records the process ID of the daemon</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>PidFile filename</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>PidFile logs/httpd.pid</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> </table> <p>The <code class=\"directive\">PidFile</code> directive sets the file to which the server records the process id of the daemon. If the filename is not absolute then it is assumed to be relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">PidFile /var/run/apache.pid</pre> </div> <p>It is often useful to be able to send the server a signal, so that it closes and then re-opens its <code class=\"directive\"><a href=\"core#errorlog\">ErrorLog</a></code> and <code class=\"directive\"><a href=\"mod_log_config#transferlog\">TransferLog</a></code>, and re-reads its configuration files. This is done by sending a SIGHUP (kill -1) signal to the process id listed in the <code class=\"directive\">PidFile</code>.</p> <p>The <code class=\"directive\">PidFile</code> is subject to the same warnings about log file placement and <a href=\"../misc/security_tips#serverroot\">security</a>.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>As of Apache HTTP Server 2, we recommended that you only use the <code class=\"program\"><a href=\"../programs/apachectl\">apachectl</a></code> script, or the init script that your OS provides, for (re-)starting or stopping the server.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"receivebuffersize\">ReceiveBufferSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>TCP receive buffer size</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ReceiveBufferSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ReceiveBufferSize 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> </table> <p>The server will set the TCP receive buffer size to the number of bytes specified.</p> <p>If set to the value of <code>0</code>, the server will use the OS default.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"scoreboardfile\">ScoreBoardFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Location of the file used to store coordination data for the child processes</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScoreBoardFile file-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ScoreBoardFile logs/apache_runtime_status</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>\n</td>\n</tr> </table> <p>Apache HTTP Server uses a scoreboard to communicate between its parent and child processes. Some architectures require a file to facilitate this communication. If the file is left unspecified, Apache httpd first attempts to create the scoreboard entirely in memory (using anonymous shared memory) and, failing that, will attempt to create the file on disk (using file-based shared memory). Specifying this directive causes Apache httpd to always create the file on the disk.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ScoreBoardFile /var/run/apache_runtime_status</pre> </div> <p>File-based shared memory is useful for third-party applications that require direct access to the scoreboard.</p> <p>If you use a <code class=\"directive\">ScoreBoardFile</code> then you may see improved speed by placing it on a RAM disk. But be careful that you heed the same warnings about log file placement and <a href=\"../misc/security_tips\">security</a>.</p> <h3>See also</h3> <ul> <li><a href=\"../stopping\">Stopping and Restarting Apache HTTP Server</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"sendbuffersize\">SendBufferSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>TCP buffer size</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SendBufferSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SendBufferSize 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> </table> <p>Sets the server's TCP send buffer size to the number of bytes specified. It is often useful to set this past the OS's standard default value on high speed, high latency connections (<em>i.e.</em>, 100ms or so, such as transcontinental fast pipes).</p> <p>If set to the value of <code>0</code>, the server will use the default value provided by your OS.</p> <p>Further configuration of your operating system may be required to elicit better performance on high speed, high latency connections.</p> <div class=\"note\"> <p> On some operating systems, changes in TCP behavior resulting from a larger <code class=\"directive\">SendBufferSize</code> may not be seen unless <code class=\"directive\"><a href=\"core#enablesendfile\">EnableSendfile</a></code> is set to OFF. This interaction applies only to static files.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"serverlimit\">ServerLimit Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Upper limit on configurable number of processes</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerLimit number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>\n</td>\n</tr> </table> <p>For the <code class=\"module\"><a href=\"prefork\">prefork</a></code> MPM, this directive sets the maximum configured value for <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers</a></code> for the lifetime of the Apache httpd process. For the <code class=\"module\"><a href=\"worker\">worker</a></code> and <code class=\"module\"><a href=\"event\">event </a></code> MPMs, this directive in combination with <code class=\"directive\"><a href=\"#threadlimit\">ThreadLimit</a></code> sets the maximum configured value for <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers</a></code> for the lifetime of the Apache httpd process. Any attempts to change this directive during a restart will be ignored, but <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers</a></code> can be modified during a restart.</p> <p>Special care must be taken when using this directive. If <code class=\"directive\">ServerLimit</code> is set to a value much higher than necessary, extra, unused shared memory will be allocated. If both <code class=\"directive\">ServerLimit</code> and <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers</a></code> are set to values higher than the system can handle, Apache httpd may not start or the system may become unstable.</p> <p>With the <code class=\"module\"><a href=\"prefork\">prefork</a></code> MPM, use this directive only if you need to set <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers</a></code> higher than 256 (default). Do not set the value of this directive any higher than what you might want to set <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers</a></code> to.</p> <p>With <code class=\"module\"><a href=\"worker\">worker</a></code> and <code class=\"module\"><a href=\"event\">event</a></code>, use this directive only if your <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers </a></code> and <code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code> settings require more than 16 server processes (default). Do not set the value of this directive any higher than the number of server processes required by what you may want for <code class=\"directive\"><a href=\"#maxrequestworkers\">MaxRequestWorkers </a></code> and <code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code>.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>There is a hard limit of <code>ServerLimit 20000</code> compiled into the server (for the <code class=\"module\"><a href=\"prefork\">prefork</a></code> MPM 200000). This is intended to avoid nasty effects caused by typos. To increase it even further past this limit, you will need to modify the value of MAX_SERVER_LIMIT in the mpm source file and rebuild the server.</p> </div> <h3>See also</h3> <ul> <li><a href=\"../stopping\">Stopping and Restarting Apache HTTP Server</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"startservers\">StartServers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of child server processes created at startup</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>StartServers number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"prefork\">prefork</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> </table> <p>The <code class=\"directive\">StartServers</code> directive sets the number of child server processes created on startup. As the number of processes is dynamically controlled depending on the load, (see <code class=\"directive\"><a href=\"#minsparethreads\">MinSpareThreads</a></code>, <code class=\"directive\"><a href=\"#maxsparethreads\">MaxSpareThreads</a></code>, <code class=\"directive\"><a href=\"prefork#minspareservers\">MinSpareServers</a></code>, <code class=\"directive\"><a href=\"prefork#maxspareservers\">MaxSpareServers</a></code>) there is usually little reason to adjust this parameter.</p> <p>The default value differs from MPM to MPM. <code class=\"module\"><a href=\"worker\">worker</a></code> and <code class=\"module\"><a href=\"event\">event</a></code> default to <code>StartServers 3</code>; <code class=\"module\"><a href=\"prefork\"> prefork</a></code> defaults to <code>5</code>; <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code> defaults to <code>2</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"startthreads\">StartThreads Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of threads created on startup</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>StartThreads number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td><code class=\"module\">mpm_netware</code></td>\n</tr> </table> <p>Number of threads created on startup. As the number of threads is dynamically controlled depending on the load, (see <code class=\"directive\"><a href=\"#minsparethreads\">MinSpareThreads</a></code>, <code class=\"directive\"><a href=\"#maxsparethreads\">MaxSpareThreads</a></code>, <code class=\"directive\"><a href=\"prefork#minspareservers\">MinSpareServers</a></code>, <code class=\"directive\"><a href=\"prefork#maxspareservers\">MaxSpareServers</a></code>) there is usually little reason to adjust this parameter.</p> <p>For <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code> the default is <code>StartThreads 50</code> and, since there is only a single process, this is the total number of threads created at startup to serve requests.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"threadlimit\">ThreadLimit Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the upper limit on the configurable number of threads per child process</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ThreadLimit number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>\n</td>\n</tr> </table> <p>This directive sets the maximum configured value for <code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code> for the lifetime of the Apache httpd process. Any attempts to change this directive during a restart will be ignored, but <code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code> can be modified during a restart up to the value of this directive.</p> <p>Special care must be taken when using this directive. If <code class=\"directive\">ThreadLimit</code> is set to a value much higher than <code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code>, extra unused shared memory will be allocated. If both <code class=\"directive\">ThreadLimit</code> and <code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code> are set to values higher than the system can handle, Apache httpd may not start or the system may become unstable. Do not set the value of this directive any higher than your greatest predicted setting of <code class=\"directive\"><a href=\"#threadsperchild\">ThreadsPerChild</a></code> for the current run of Apache httpd.</p> <p>The default value for <code class=\"directive\">ThreadLimit</code> is <code>1920</code> when used with <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code> and <code>64</code> when used with the others.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>There is a hard limit of <code>ThreadLimit 20000</code> (or <code>ThreadLimit 100000</code> with <code class=\"module\"><a href=\"event\">event</a></code>, <code>ThreadLimit 15000</code> with <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>) compiled into the server. This is intended to avoid nasty effects caused by typos. To increase it even further past this limit, you will need to modify the value of MAX_THREAD_LIMIT in the mpm source file and rebuild the server.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"threadsperchild\">ThreadsPerChild Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of threads created by each child process</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ThreadsPerChild number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>See usage for details</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>\n</td>\n</tr> </table> <p>This directive sets the number of threads created by each child process. The child creates these threads at startup and never creates more. If using an MPM like <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, where there is only one child process, this number should be high enough to handle the entire load of the server. If using an MPM like <code class=\"module\"><a href=\"worker\">worker</a></code>, where there are multiple child processes, the <em>total</em> number of threads should be high enough to handle the common load on the server.</p> <p>The default value for <code class=\"directive\">ThreadsPerChild</code> is <code>64</code> when used with <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code> and <code>25</code> when used with the others.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"threadstacksize\">ThreadStackSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The size in bytes of the stack used by threads handling client connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ThreadStackSize size</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>65536 on NetWare; varies on other operating systems</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>MPM</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"event\">event</a></code>, <code class=\"module\"><a href=\"worker\">worker</a></code>, <code class=\"module\"><a href=\"mpm_winnt\">mpm_winnt</a></code>, <code class=\"module\"><a href=\"mpm_netware\">mpm_netware</a></code>, <code class=\"module\"><a href=\"mpmt_os2\">mpmt_os2</a></code>\n</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.1 and later</td>\n</tr> </table> <p>The <code class=\"directive\">ThreadStackSize</code> directive sets the size of the stack (for autodata) of threads which handle client connections and call modules to help process those connections. In most cases the operating system default for stack size is reasonable, but there are some conditions where it may need to be adjusted:</p> <ul> <li>On platforms with a relatively small default thread stack size (e.g., HP-UX), Apache httpd may crash when using some third-party modules which use a relatively large amount of autodata storage. Those same modules may have worked fine on other platforms where the default thread stack size is larger. This type of crash is resolved by setting <code class=\"directive\">ThreadStackSize</code> to a value higher than the operating system default. This type of adjustment is necessary only if the provider of the third-party module specifies that it is required, or if diagnosis of an Apache httpd crash indicates that the thread stack size was too small.</li> <li>On platforms where the default thread stack size is significantly larger than necessary for the web server configuration, a higher number of threads per child process will be achievable if <code class=\"directive\">ThreadStackSize</code> is set to a value lower than the operating system default. This type of adjustment should only be made in a test environment which allows the full set of web server processing can be exercised, as there may be infrequent requests which require more stack to process. The minimum required stack size strongly depends on the modules used, but any change in the web server configuration can invalidate the current <code class=\"directive\">ThreadStackSize</code> setting.</li> <li>On Linux, this directive can only be used to increase the default stack size, as the underlying system call uses the value as a <em>minimum</em> stack size. The (often large) soft limit for <code>ulimit -s</code> (8MB if unlimited) is used as the default stack size.</li> </ul> <div class=\"note\">It is recommended to not reduce <code class=\"directive\">ThreadStackSize</code> unless a high number of threads per child process is needed. On some platforms (including Linux), a setting of 128000 is already too low and causes crashes with some common modules.</div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mpm_common.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mpm_common.html</a>\n  </p>\n</div>\n","mod/mod_cgi":"<h1>Apache Module mod_cgi</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Execution of CGI scripts</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>cgi_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_cgi.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>Any file that has the handler <code>cgi-script</code> will be treated as a CGI script, and run by the server, with its output being returned to the client. Files acquire this handler either by having a name containing an extension defined by the <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code> directive, or by being in a <code class=\"directive\"><a href=\"mod_alias#scriptalias\">ScriptAlias</a></code> directory.</p> <p>For an introduction to using CGI scripts with Apache, see our tutorial on <a href=\"../howto/cgi\">Dynamic Content With CGI</a>.</p> <p>When using a multi-threaded MPM under unix, the module <code class=\"module\"><a href=\"mod_cgid\">mod_cgid</a></code> should be used in place of this module. At the user level, the two modules are essentially identical.</p> <p>For backward-compatibility, the cgi-script handler will also be activated for any file with the mime-type <code>application/x-httpd-cgi</code>. The use of the magic mime-type is deprecated.</p>     <h2 id=\"env\">CGI Environment variables</h2> <p>The server will set the CGI environment variables as described in the <a href=\"http://www.ietf.org/rfc/rfc3875\">CGI specification</a>, with the following provisions:</p> <dl> <dt>PATH_INFO</dt> <dd>This will not be available if the <code class=\"directive\"><a href=\"core#acceptpathinfo\">AcceptPathInfo</a></code> directive is explicitly set to <code>off</code>. The default behavior, if <code class=\"directive\">AcceptPathInfo</code> is not given, is that <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> will accept path info (trailing <code>/more/path/info</code> following the script filename in the URI), while the core server will return a 404 NOT FOUND error for requests with additional path info. Omitting the <code class=\"directive\">AcceptPathInfo</code> directive has the same effect as setting it <code>On</code> for <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> requests.</dd> <dt>REMOTE_HOST</dt> <dd>This will only be set if <code class=\"directive\"><a href=\"core#hostnamelookups\">HostnameLookups</a></code> is set to <code>on</code> (it is off by default), and if a reverse DNS lookup of the accessing host's address indeed finds a host name.</dd> <dt>REMOTE_IDENT</dt> <dd>This will only be set if <code class=\"directive\"><a href=\"mod_ident#identitycheck\">IdentityCheck</a></code> is set to <code>on</code> and the accessing host supports the ident protocol. Note that the contents of this variable cannot be relied upon because it can easily be faked, and if there is a proxy between the client and the server, it is usually totally useless.</dd> <dt>REMOTE_USER</dt> <dd>This will only be set if the CGI script is subject to authentication.</dd> </dl> <p>This module also leverages the core functions <a href=\"https://ci.apache.org/projects/httpd/trunk/doxygen/group__APACHE__CORE__SCRIPT.html#ga0e81f9571a8a73f5da0e89e1f46d34b1\">ap_add_common_vars</a> and <a href=\"https://ci.apache.org/projects/httpd/trunk/doxygen/group__APACHE__CORE__SCRIPT.html#ga6b975cd7ff27a338cb8752381a4cc14f\">ap_add_cgi_vars</a> to add environment variables like:</p> <dl> <dt>DOCUMENT_ROOT</dt> <dd>Set with the content of the related <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code> directive.</dd> <dt>SERVER_NAME</dt> <dd>The fully qualified domain name related to the request.</dd> <dt>SERVER_ADDR</dt> <dd>The IP address of the Virtual Host serving the request.</dd> <dt>SERVER_ADMIN</dt> <dd>Set with the content of the related <code class=\"directive\"><a href=\"core#serveradmin\">ServerAdmin</a></code> directive.</dd> </dl> <p>For an exhaustive list it is suggested to write a basic CGI script that dumps all the environment variables passed by Apache in a convenient format. </p>   <h2 id=\"cgi-debug\">CGI Debugging</h2> <p>Debugging CGI scripts has traditionally been difficult, mainly because it has not been possible to study the output (standard output and error) for scripts which are failing to run properly. These directives provide more detailed logging of errors when they occur.</p> <h3>CGI Logfile Format</h3> <p>When configured, the CGI error log logs any CGI which does not execute properly. Each CGI script which fails to operate causes several lines of information to be logged. The first two lines are always of the format:</p> <div class=\"example\"><pre>%% [time] request-line\n%% HTTP-status CGI-script-filename</pre></div> <p>If the error is that CGI script cannot be run, the log file will contain an extra two lines:</p> <div class=\"example\"><pre>%%error\nerror-message</pre></div> <p>Alternatively, if the error is the result of the script returning incorrect header information (often due to a bug in the script), the following information is logged:</p> <div class=\"example\"><pre>%request\nAll HTTP request headers received\nPOST or PUT entity (if any)\n%response\nAll headers output by the CGI script\n%stdout\nCGI standard output\n%stderr\nCGI standard error</pre></div> <p>(The %stdout and %stderr parts may be missing if the script did not output anything on standard output or standard error).</p>   <div class=\"directive-section\">\n<h2 id=\"scriptlog\">ScriptLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Location of the CGI script error logfile</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScriptLog file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, <code class=\"module\"><a href=\"mod_cgid\">mod_cgid</a></code>\n</td>\n</tr> </table> <p>The <code class=\"directive\">ScriptLog</code> directive sets the CGI script error logfile. If no <code class=\"directive\">ScriptLog</code> is given, no error log is created. If given, any CGI errors are logged into the filename given as argument. If this is a relative file or path it is taken relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ScriptLog logs/cgi_log</pre> </div> <p>This log will be opened as the user the child processes run as, <em>i.e.</em> the user specified in the main <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> directive. This means that either the directory the script log is in needs to be writable by that user or the file needs to be manually created and set to be writable by that user. If you place the script log in your main logs directory, do <strong>NOT</strong> change the directory permissions to make it writable by the user the child processes run as.</p> <p>Note that script logging is meant to be a debugging feature when writing CGI scripts, and is not meant to be activated continuously on running servers. It is not optimized for speed or efficiency, and may have security problems if used in a manner other than that for which it was designed.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"scriptlogbuffer\">ScriptLogBuffer Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum amount of PUT or POST requests that will be recorded in the scriptlog</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScriptLogBuffer bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ScriptLogBuffer 1024</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, <code class=\"module\"><a href=\"mod_cgid\">mod_cgid</a></code>\n</td>\n</tr> </table> <p>The size of any PUT or POST entity body that is logged to the file is limited, to prevent the log file growing too big too quickly if large bodies are being received. By default, up to 1024 bytes are logged, but this can be changed with this directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"scriptloglength\">ScriptLogLength Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Size limit of the CGI script logfile</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScriptLogLength bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ScriptLogLength 10385760</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>\n<code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, <code class=\"module\"><a href=\"mod_cgid\">mod_cgid</a></code>\n</td>\n</tr> </table> <p><code class=\"directive\">ScriptLogLength</code> can be used to limit the size of the CGI script logfile. Since the logfile logs a lot of information per CGI error (all request headers, all script output) it can grow to be a big file. To prevent problems due to unbounded growth, this directive can be used to set an maximum file-size for the CGI logfile. If the file exceeds this size, no more information will be written to it.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_cgi.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_cgi.html</a>\n  </p>\n</div>\n","mod/mod_imagemap":"<h1>Apache Module mod_imagemap</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Server-side imagemap processing</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>imagemap_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_imagemap.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module processes <code>.map</code> files, thereby replacing the functionality of the <code>imagemap</code> CGI program. Any directory or document type configured to use the handler <code>imap-file</code> (using either <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code> or <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code>) will be processed by this module.</p> <p>The following directive will activate files ending with <code>.map</code> as imagemap files:</p> <pre class=\"prettyprint lang-config\">AddHandler imap-file map</pre> <p>Note that the following is still supported:</p> <pre class=\"prettyprint lang-config\">AddType application/x-httpd-imap map</pre> <p>However, we are trying to phase out \"magic MIME types\" so we are deprecating this method.</p>     <h2 id=\"features\">New Features</h2> <p>The imagemap module adds some new features that were not possible with previously distributed imagemap programs.</p> <ul> <li>URL references relative to the Referer: information.</li> <li>Default <code>&lt;base&gt;</code> assignment through a new map directive <code>base</code>.</li> <li>No need for <code>imagemap.conf</code> file.</li> <li>Point references.</li> <li>Configurable generation of imagemap menus.</li> </ul>   <h2 id=\"imapfile\">Imagemap File</h2> <p>The lines in the imagemap files can have one of several formats:</p> <div class=\"example\"><pre>directive value [x,y ...]\ndirective value \"Menu text\" [x,y ...]\ndirective value x,y ... \"Menu text\"</pre></div> <p>The directive is one of <code>base</code>, <code>default</code>, <code>poly</code>, <code>circle</code>, <code>rect</code>, or <code>point</code>. The value is an absolute or relative URL, or one of the special values listed below. The coordinates are <code>x,y</code> pairs separated by whitespace. The quoted text is used as the text of the link if a imagemap menu is generated. Lines beginning with '#' are comments.</p> <h3><a name=\"imapfile.directives\" id=\"imapfile.directives\">Imagemap File Directives</a></h3> <p>There are six directives allowed in the imagemap file. The directives can come in any order, but are processed in the order they are found in the imagemap file.</p> <dl> <dt>\n<code>base</code> Directive</dt> <dd>\n<p>Has the effect of <code>&lt;base href=\"value\"&gt;</code>. The non-absolute URLs of the map-file are taken relative to this value. The <code>base</code> directive overrides <code class=\"directive\"><a href=\"#imapbase\">ImapBase</a></code> as set in a <code>.htaccess</code> file or in the server configuration files. In the absence of an <code class=\"directive\">ImapBase</code> configuration directive, <code>base</code> defaults to <code>http://server_name/</code>.</p> <p><code>base_uri</code> is synonymous with <code>base</code>. Note that a trailing slash on the URL is significant.</p>\n</dd> <dt>\n<code>default</code> Directive</dt> <dd>The action taken if the coordinates given do not fit any of the <code>poly</code>, <code>circle</code> or <code>rect</code> directives, and there are no <code>point</code> directives. Defaults to <code>nocontent</code> in the absence of an <code class=\"directive\"><a href=\"#imapdefault\">ImapDefault</a></code> configuration setting, causing a status code of <code>204 No Content</code> to be returned. The client should keep the same page displayed.</dd> <dt>\n<code>poly</code> Directive</dt> <dd>Takes three to one-hundred points, and is obeyed if the user selected coordinates fall within the polygon defined by these points.</dd> <dt><code>circle</code></dt> <dd>Takes the center coordinates of a circle and a point on the circle. Is obeyed if the user selected point is with the circle.</dd> <dt>\n<code>rect</code> Directive</dt> <dd>Takes the coordinates of two opposing corners of a rectangle. Obeyed if the point selected is within this rectangle.</dd> <dt>\n<code>point</code> Directive</dt> <dd>Takes a single point. The point directive closest to the user selected point is obeyed if no other directives are satisfied. Note that <code>default</code> will not be followed if a <code>point</code> directive is present and valid coordinates are given.</dd> </dl> <h3><a name=\"imapfile.values\" id=\"imapfile.values\">Values</a></h3> <p>The values for each of the directives can be any of the following:</p> <dl> <dt>a URL</dt> <dd>\n<p>The URL can be relative or absolute URL. Relative URLs can contain '..' syntax and will be resolved relative to the <code>base</code> value.</p> <p><code>base</code> itself will not be resolved according to the current value. A statement <code>base mailto:</code> will work properly, though.</p>\n</dd> <dt><code>map</code></dt> <dd>Equivalent to the URL of the imagemap file itself. No coordinates are sent with this, so a menu will be generated unless <code class=\"directive\"><a href=\"#imapmenu\">ImapMenu</a></code> is set to <code>none</code>.</dd> <dt><code>menu</code></dt> <dd>Synonymous with <code>map</code>.</dd> <dt><code>referer</code></dt> <dd>Equivalent to the URL of the referring document. Defaults to <code>http://servername/</code> if no <code>Referer:</code> header was present.</dd> <dt><code>nocontent</code></dt> <dd>Sends a status code of <code>204 No Content</code>, telling the client to keep the same page displayed. Valid for all but <code>base</code>.</dd> <dt><code>error</code></dt> <dd>Fails with a <code>500 Server Error</code>. Valid for all but <code>base</code>, but sort of silly for anything but <code>default</code>.</dd> </dl> <h3><a name=\"imapfile.coords\" id=\"imapfile.coords\">Coordinates</a></h3> <dl> <dt><code>0,0 200,200</code></dt> <dd>A coordinate consists of an <var>x</var> and a <var>y</var> value separated by a comma. The coordinates are separated from each other by whitespace. To accommodate the way Lynx handles imagemaps, should a user select the coordinate <code>0,0</code>, it is as if no coordinate had been selected.</dd> </dl> <h3><a name=\"imapfile.quotedtext\" id=\"imapfile.quotedtext\">Quoted Text</a></h3> <dl> <dt><code>\"Menu Text\"</code></dt> <dd>\n<p>After the value or after the coordinates, the line optionally may contain text within double quotes. This string is used as the text for the link if a menu is generated:</p> <div class=\"example\"><pre>&lt;a href=\"http://example.com/\"&gt;Menu text&lt;/a&gt;</pre></div> <p>If no quoted text is present, the name of the link will be used as the text:</p> <div class=\"example\"><pre>&lt;a href=\"http://example.com/\"&gt;http://example.com&lt;/a&gt;</pre></div> <p>If you want to use double quotes within this text, you have to write them as <code>&amp;quot;</code>.</p>\n</dd> </dl>   <h2 id=\"example\">Example Mapfile</h2> <div class=\"example\"><pre>#Comments are printed in a 'formatted' or 'semiformatted' menu.\n#And can contain html tags. &lt;hr&gt;\nbase referer\npoly map \"Could I have a menu, please?\" 0,0 0,10 10,10 10,0\nrect .. 0,0 77,27 \"the directory of the referer\"\ncircle http://www.inetnebr.example.com/lincoln/feedback/ 195,0 305,27\nrect another_file \"in same directory as referer\" 306,0 419,27\npoint http://www.zyzzyva.example.com/ 100,100\npoint http://www.tripod.example.com/ 200,200\nrect mailto:nate@tripod.example.com 100,150 200,0 \"Bugs?\"</pre></div>   <h2 id=\"referencing\">Referencing your mapfile</h2> <div class=\"example\">\n<h3>HTML example</h3>\n<pre>&lt;a href=\"/maps/imagemap1.map\"&gt;\n &lt;img ismap src=\"/images/imagemap1.gif\"&gt;\n &lt;/a&gt;</pre>\n</div> <div class=\"example\">\n<h3>XHTML example</h3>\n<pre>&lt;a href=\"/maps/imagemap1.map\"&gt;\n &lt;img ismap=\"ismap\" src=\"/images/imagemap1.gif\" /&gt;\n &lt;/a&gt;</pre>\n</div>   <div class=\"directive-section\">\n<h2 id=\"imapbase\">ImapBase Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Default <code>base</code> for imagemap files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ImapBase map|referer|URL</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ImapBase http://servername/</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_imagemap</td>\n</tr> </table> <p>The <code class=\"directive\">ImapBase</code> directive sets the default <code>base</code> used in the imagemap files. Its value is overridden by a <code>base</code> directive within the imagemap file. If not present, the <code>base</code> defaults to <code>http://servername/</code>.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"core#usecanonicalname\">UseCanonicalName</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"imapdefault\">ImapDefault Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Default action when an imagemap is called with coordinates that are not explicitly mapped</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ImapDefault error|nocontent|map|referer|URL</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ImapDefault nocontent</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_imagemap</td>\n</tr> </table> <p>The <code class=\"directive\">ImapDefault</code> directive sets the default <code>default</code> used in the imagemap files. Its value is overridden by a <code>default</code> directive within the imagemap file. If not present, the <code>default</code> action is <code>nocontent</code>, which means that a <code>204 No Content</code> is sent to the client. In this case, the client should continue to display the original page.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"imapmenu\">ImapMenu Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Action if no coordinates are given when calling an imagemap</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ImapMenu none|formatted|semiformatted|unformatted</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ImapMenu formatted</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_imagemap</td>\n</tr> </table> <p>The <code class=\"directive\">ImapMenu</code> directive determines the action taken if an imagemap file is called without valid coordinates.</p> <dl> <dt><code>none</code></dt> <dd>If ImapMenu is <code>none</code>, no menu is generated, and the <code>default</code> action is performed.</dd> <dt><code>formatted</code></dt> <dd>A <code>formatted</code> menu is the simplest menu. Comments in the imagemap file are ignored. A level one header is printed, then an hrule, then the links each on a separate line. The menu has a consistent, plain look close to that of a directory listing.</dd> <dt><code>semiformatted</code></dt> <dd>In the <code>semiformatted</code> menu, comments are printed where they occur in the imagemap file. Blank lines are turned into HTML breaks. No header or hrule is printed, but otherwise the menu is the same as a <code>formatted</code> menu.</dd> <dt><code>unformatted</code></dt> <dd>Comments are printed, blank lines are ignored. Nothing is printed that does not appear in the imagemap file. All breaks and headers must be included as comments in the imagemap file. This gives you the most flexibility over the appearance of your menus, but requires you to treat your map files as HTML instead of plaintext.</dd> </dl> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_imagemap.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_imagemap.html</a>\n  </p>\n</div>\n","mod/mod_status":"<h1>Apache Module mod_status</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides information on server activity and performance</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>status_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_status.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The Status module allows a server administrator to find out how well their server is performing. A HTML page is presented that gives the current server statistics in an easily readable form. If required this page can be made to automatically refresh (given a compatible browser). Another page gives a simple machine-readable list of the current server state.</p> <p>The details given are:</p> <ul> <li>The number of worker serving requests</li> <li>The number of idle worker</li> <li>The status of each worker, the number of requests that worker has performed and the total number of bytes served by the worker (*)</li> <li>A total number of accesses and byte count served (*)</li> <li>The time the server was started/restarted and the time it has been running for</li> <li>Averages giving the number of requests per second, the number of bytes served per second and the average number of bytes per request (*)</li> <li>The current percentage CPU used by each worker and in total by all workers combined (*)</li> <li>The current hosts and requests being processed (*)</li> </ul> <p>The lines marked \"(*)\" are only available if <code class=\"directive\"><a href=\"core#extendedstatus\">ExtendedStatus</a></code> is <code>On</code>. In version 2.3.6, loading mod_status will toggle <code class=\"directive\"><a href=\"core#extendedstatus\">ExtendedStatus</a></code> On by default.</p>     <h2 id=\"enable\">Enabling Status Support</h2> <p>To enable status reports only for browsers from the example.com domain add this code to your <code>httpd.conf</code> configuration file</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/server-status\"&gt;\n    SetHandler server-status\n    Require host example.com\n&lt;/Location&gt;</pre> <p>You can now access server statistics by using a Web browser to access the page <code>http://your.server.name/server-status</code></p>   <h2 id=\"autoupdate\">Automatic Updates</h2> <p>You can get the status page to update itself automatically if you have a browser that supports \"refresh\". Access the page <code>http://your.server.name/server-status?refresh=N</code> to refresh the page every N seconds.</p>   <h2 id=\"machinereadable\">Machine Readable Status File</h2> <p>A machine-readable version of the status file is available by accessing the page <code>http://your.server.name/server-status?auto</code>. This is useful when automatically run, see the Perl program <code>log_server_status</code>, which you will find in the <code>/support</code> directory of your Apache HTTP Server installation.</p> <div class=\"note\"> <strong>It should be noted that if <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> is loaded into the server, its handler capability is available in <em>all</em> configuration files, including <em>per</em>-directory files (<em>e.g.</em>, <code>.htaccess</code>). This may have security-related ramifications for your site.</strong> </div>   <h2 id=\"troubleshoot\">Using server-status to troubleshoot</h2> <p>The <code>server-status</code> page may be used as a starting place for troubleshooting a situation where your server is consuming all available resources (CPU or memory), and you wish to identify which requests or clients are causing the problem.</p> <p>First, ensure that you have <code class=\"directive\"><a href=\"core#extendedstatus\">ExtendedStatus</a></code> set on, so that you can see the full request and client information for each child or thread.</p> <p>Now look in your process list (using <code>top</code>, or similar process viewing utility) to identify the specific processes that are the main culprits. Order the output of <code>top</code> by CPU usage, or memory usage, depending on what problem you're trying to address.</p> <p>Reload the <code>server-status</code> page, and look for those process ids, and you'll be able to see what request is being served by that process, for what client. Requests are transient, so you may need to try several times before you catch it in the act, so to speak.</p> <p>This process <em>should</em> give you some idea what client, or what type of requests, are primarily responsible for your load problems. Often you will identify a particular web application that is misbehaving, or a particular client that is attacking your site.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_status.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_status.html</a>\n  </p>\n</div>\n","mod/mod_reqtimeout":"<h1>Apache Module mod_reqtimeout</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Set timeout and minimum data rate for receiving requests </td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>reqtimeout_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_reqtimeout.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTPD 2.2.15 and later</td>\n</tr>\n</table>     <h2 id=\"examples\">Examples</h2> <ol> <li> Allow 10 seconds to receive the request including the headers and 30 seconds for receiving the request body: <pre class=\"prettyprint lang-config\">RequestReadTimeout header=10 body=30</pre> </li> <li> Allow at least 10 seconds to receive the request body. If the client sends data, increase the timeout by 1 second for every 1000 bytes received, with no upper limit for the timeout (except for the limit given indirectly by <code class=\"directive\"><a href=\"core#limitrequestbody\">LimitRequestBody</a></code>): <pre class=\"prettyprint lang-config\">RequestReadTimeout body=10,MinRate=1000</pre> </li> <li> Allow at least 10 seconds to receive the request including the headers. If the client sends data, increase the timeout by 1 second for every 500 bytes received. But do not allow more than 30 seconds for the request including the headers: <pre class=\"prettyprint lang-config\">RequestReadTimeout header=10-30,MinRate=500</pre> </li> <li> Usually, a server should have both header and body timeouts configured. If a common configuration is used for http and https virtual hosts, the timeouts should not be set too low: <pre class=\"prettyprint lang-config\">RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500</pre> </li> </ol>   <div class=\"directive-section\">\n<h2 id=\"requestreadtimeout\">RequestReadTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set timeout values for receiving request headers and body from client. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RequestReadTimeout [header=timeout[-maxtimeout][,MinRate=rate] [body=timeout[-maxtimeout][,MinRate=rate]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>header=20-40,MinRate=500 body=20,MinRate=500</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_reqtimeout</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.2.15 and later; defaulted to disabled in version 2.3.14 and earlier.</td>\n</tr> </table> <p>This directive can set various timeouts for receiving the request headers and the request body from the client. If the client fails to send headers or body within the configured time, a <code>408 REQUEST TIME OUT</code> error is sent.</p> <p>For SSL virtual hosts, the header timeout values include the time needed to do the initial SSL handshake. If the user's browser is configured to query certificate revocation lists and the CRL server is not reachable, the initial SSL handshake may take a significant time until the browser gives up waiting for the CRL. Therefore the header timeout values should not be set to very low values for SSL virtual hosts. The body timeout values include the time needed for SSL renegotiation (if necessary).</p> <p>When an <code class=\"directive\"><a href=\"core#acceptfilter\">AcceptFilter</a></code> is in use (usually the case on Linux and FreeBSD), the socket is not sent to the server process before at least one byte (or the whole request for <code>httpready</code>) is received. The header timeout configured with <code>RequestReadTimeout</code> is only effective after the server process has received the socket.</p> <p>For each of the two timeout types (header or body), there are three ways to specify the timeout: </p> <ul> <li>\n<strong>Fixed timeout value</strong>:<br> <div class=\"example\"><code>type=timeout</code></div> <p>The time in seconds allowed for reading all of the request headers or body, respectively. A value of 0 means no limit.</p> </li> <li>\n<strong>Disable module for a vhost:</strong>:<br> <div class=\"example\"><pre>header=0 body=0</pre></div> <p>This disables <code class=\"module\"><a href=\"mod_reqtimeout\">mod_reqtimeout</a></code> completely.</p> </li> <li>\n<strong>Timeout value that is increased when data is received</strong>:<br> <div class=\"example\"><code>type=timeout,MinRate=data_rate</code></div> <p>Same as above, but whenever data is received, the timeout value is increased according to the specified minimum data rate (in bytes per second).</p> </li> <li>\n<strong>Timeout value that is increased when data is received, with an upper bound</strong>:<br> <div class=\"example\"><code>type=timeout-maxtimeout,MinRate=data_rate</code></div> <p>Same as above, but the timeout will not be increased above the second value of the specified timeout range.</p> </li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_reqtimeout.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_reqtimeout.html</a>\n  </p>\n</div>\n","mod/mod_unixd":"<h1>Apache Module mod_unixd</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Basic (required) security for Unix-family platforms.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>unixd_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_unixd.c</td>\n</tr>\n</table>    <div class=\"directive-section\">\n<h2 id=\"chrootdir\">ChrootDir Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory for apache to run chroot(8) after startup.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ChrootDir /path/to/directory</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td><code class=\"module\">mod_unixd</code></td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.2.10 and later</td>\n</tr> </table> <p>This directive tells the server to <var>chroot(8)</var> to the specified directory after startup, but before accepting requests over the 'net.</p> <p>Note that running the server under chroot is not simple, and requires additional setup, particularly if you are running scripts such as CGI or PHP. Please make sure you are properly familiar with the operation of chroot before attempting to use this feature.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"group\">Group Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Group under which the server will answer requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Group unix-group</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Group #-1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_unixd</td>\n</tr> </table> <p>The <code class=\"directive\">Group</code> directive sets the group under which the server will answer requests. In order to use this directive, the server must be run initially as <code>root</code>. If you start the server as a non-root user, it will fail to change to the specified group, and will instead continue to run as the group of the original user. <var>Unix-group</var> is one of:</p> <dl> <dt>A group name</dt> <dd>Refers to the given group by name.</dd> <dt>\n<code>#</code> followed by a group number.</dt> <dd>Refers to a group by its number.</dd> </dl> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">Group www-group</pre> </div> <p>It is recommended that you set up a new group specifically for running the server. Some admins use user <code>nobody</code>, but this is not always possible or desirable.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>Don't set <code class=\"directive\">Group</code> (or <code class=\"directive\"><a href=\"#user\">User</a></code>) to <code>root</code> unless you know exactly what you are doing, and what the dangers are.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_privileges#vhostgroup\">VHostGroup</a></code></li> <li><code class=\"directive\"><a href=\"mod_suexec#suexecusergroup\">SuexecUserGroup</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"suexec\">Suexec Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable or disable the suEXEC feature</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Suexec On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>On if suexec binary exists with proper owner and mode, Off otherwise</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_unixd</td>\n</tr> </table> <p>When On, startup will fail if the suexec binary doesn't exist or has an invalid owner or file mode.</p> <p>When Off, suEXEC will be disabled even if the suexec binary exists and has a valid owner and file mode.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"user\">User Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The userid under which the server will answer requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>User unix-userid</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>User #-1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_unixd</td>\n</tr> </table> <p>The <code class=\"directive\">User</code> directive sets the user ID as which the server will answer requests. In order to use this directive, the server must be run initially as <code>root</code>. If you start the server as a non-root user, it will fail to change to the lesser privileged user, and will instead continue to run as that original user. If you do start the server as <code>root</code>, then it is normal for the parent process to remain running as root. <var>Unix-userid</var> is one of:</p> <dl> <dt>A username</dt> <dd>Refers to the given user by name.</dd> <dt># followed by a user number.</dt> <dd>Refers to a user by its number.</dd> </dl> <p>The user should have no privileges that result in it being able to access files that are not intended to be visible to the outside world, and similarly, the user should not be able to execute code that is not meant for HTTP requests. It is recommended that you set up a new user and group specifically for running the server. Some admins use user <code>nobody</code>, but this is not always desirable, since the <code>nobody</code> user can have other uses on the system.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>Don't set <code class=\"directive\">User</code> (or <code class=\"directive\"><a href=\"#group\">Group</a></code>) to <code>root</code> unless you know exactly what you are doing, and what the dangers are.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_privileges#vhostuser\">VHostUser</a></code></li> <li><code class=\"directive\"><a href=\"mod_suexec#suexecusergroup\">SuexecUserGroup</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_unixd.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_unixd.html</a>\n  </p>\n</div>\n","mod/mod_lua":"<h1>Apache Module mod_lua</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides Lua hooks into various portions of the httpd request processing</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>lua_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_lua.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module allows the server to be extended with scripts written in the Lua programming language. The extension points (hooks) available with <code class=\"module\"><a href=\"mod_lua\">mod_lua</a></code> include many of the hooks available to natively compiled Apache HTTP Server modules, such as mapping requests to files, generating dynamic responses, access control, authentication, and authorization</p> <p>More information on the Lua programming language can be found at the <a href=\"http://www.lua.org/\">the Lua website</a>.</p> <div class=\"note\">\n<code>mod_lua</code> is still in experimental state. Until it is declared stable, usage and behavior may change at any time, even between stable releases of the 2.4.x series. Be sure to check the CHANGES file before upgrading.</div> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>This module holds a great deal of power over httpd, which is both a strength and a potential security risk. It is <strong>not</strong> recommended that you use this module on a server that is shared with users you do not trust, as it can be abused to change the internal workings of httpd.</p> </div>     <h2 id=\"basicconf\">Basic Configuration</h2> <p>The basic module loading directive is</p> <pre class=\"prettyprint lang-config\">LoadModule lua_module modules/mod_lua.so</pre> <p> <code>mod_lua</code> provides a handler named <code>lua-script</code>, which can be used with a <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code> or <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code> directive:</p> <pre class=\"prettyprint lang-config\">&lt;Files \"*.lua\"&gt;\n    SetHandler lua-script\n&lt;/Files&gt;</pre> <p> This will cause <code>mod_lua</code> to handle requests for files ending in <code>.lua</code> by invoking that file's <code>handle</code> function. </p> <p>For more flexibility, see <code class=\"directive\">LuaMapHandler</code>. </p>   <h2 id=\"writinghandlers\">Writing Handlers</h2> <p> In the Apache HTTP Server API, the handler is a specific kind of hook responsible for generating the response. Examples of modules that include a handler are <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>, <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, and <code class=\"module\"><a href=\"mod_status\">mod_status</a></code>.</p> <p><code>mod_lua</code> always looks to invoke a Lua function for the handler, rather than just evaluating a script body CGI style. A handler function looks something like this:</p> <pre class=\"prettyprint lang-lua\">\n<strong>example.lua</strong><br>\n-- example handler\n\nrequire \"string\"\n\n--[[\n     This is the default method name for Lua handlers, see the optional\n     function-name in the LuaMapHandler directive to choose a different\n     entry point.\n--]]\nfunction handle(r)\n    r.content_type = \"text/plain\"\n\n    if r.method == 'GET' then\n        r:puts(\"Hello Lua World!\\n\")\n        for k, v in pairs( r:parseargs() ) do\n            r:puts( string.format(\"%s: %s\\n\", k, v) )\n        end\n    elseif r.method == 'POST' then\n        r:puts(\"Hello Lua World!\\n\")\n        for k, v in pairs( r:parsebody() ) do\n            r:puts( string.format(\"%s: %s\\n\", k, v) )\n        end\n    elseif r.method == 'PUT' then\n-- use our own Error contents\n        r:puts(\"Unsupported HTTP method \" .. r.method)\n        r.status = 405\n        return apache2.OK\n    else\n-- use the ErrorDocument\n        return 501\n    end\n    return apache2.OK\nend</pre> <p> This handler function just prints out the uri or form encoded arguments to a plaintext page. </p> <p> This means (and in fact encourages) that you can have multiple handlers (or hooks, or filters) in the same script. </p>   <h2 id=\"writingauthzproviders\">Writing Authorization Providers</h2> <p><code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code> provides a high-level interface to authorization that is much easier to use than using into the relevant hooks directly. The first argument to the <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive gives the name of the responsible authorization provider. For any <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> line, <code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code> will call the authorization provider of the given name, passing the rest of the line as parameters. The provider will then check authorization and pass the result as return value.</p> <p>The authz provider is normally called before authentication. If it needs to know the authenticated user name (or if the user will be authenticated at all), the provider must return <code>apache2.AUTHZ_DENIED_NO_USER</code>. This will cause authentication to proceed and the authz provider to be called a second time.</p> <p>The following authz provider function takes two arguments, one ip address and one user name. It will allow access from the given ip address without authentication, or if the authenticated user matches the second argument:</p> <pre class=\"prettyprint lang-lua\">\n<strong>authz_provider.lua</strong><br>\n\nrequire 'apache2'\n\nfunction authz_check_foo(r, ip, user)\n    if r.useragent_ip == ip then\n        return apache2.AUTHZ_GRANTED\n    elseif r.user == nil then\n        return apache2.AUTHZ_DENIED_NO_USER\n    elseif r.user == user then\n        return apache2.AUTHZ_GRANTED\n    else\n        return apache2.AUTHZ_DENIED\n    end\nend</pre> <p>The following configuration registers this function as provider <code>foo</code> and configures it for URL <code>/</code>:</p> <pre class=\"prettyprint lang-config\">LuaAuthzProvider foo authz_provider.lua authz_check_foo\n&lt;Location \"/\"&gt;\n  Require foo 10.1.2.3 john_doe\n&lt;/Location&gt;</pre>   <h2 id=\"writinghooks\">Writing Hooks</h2> <p>Hook functions are how modules (and Lua scripts) participate in the processing of requests. Each type of hook exposed by the server exists for a specific purpose, such as mapping requests to the file system, performing access control, or setting mime types:</p> <table class=\"bordered\">\n<tr class=\"header\"> <th>Hook phase</th> <th>mod_lua directive</th> <th>Description</th> </tr> <tr> <td>Quick handler</td> <td><code class=\"directive\">LuaQuickHandler</code></td> <td>This is the first hook that will be called after a request has been mapped to a host or virtual host</td> </tr> <tr class=\"odd\"> <td>Translate name</td> <td><code class=\"directive\">LuaHookTranslateName</code></td> <td>This phase translates the requested URI into a filename on the system. Modules such as <code class=\"module\"><a href=\"mod_alias\">mod_alias</a></code> and <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> operate in this phase.</td> </tr> <tr> <td>Map to storage</td> <td><code class=\"directive\">LuaHookMapToStorage</code></td> <td>This phase maps files to their physical, cached or external/proxied storage. It can be used by proxy or caching modules</td> </tr> <tr class=\"odd\"> <td>Check Access</td> <td><code class=\"directive\">LuaHookAccessChecker</code></td> <td>This phase checks whether a client has access to a resource. This phase is run before the user is authenticated, so beware. </td> </tr> <tr> <td>Check User ID</td> <td><code class=\"directive\">LuaHookCheckUserID</code></td> <td>This phase it used to check the negotiated user ID</td> </tr> <tr class=\"odd\"> <td>Check Authorization</td> <td>\n<code class=\"directive\"><a href=\"#luahookauthchecker\">LuaHookAuthChecker</a></code> or <code class=\"directive\"><a href=\"#luaauthzprovider\">LuaAuthzProvider</a></code>\n</td> <td>This phase authorizes a user based on the negotiated credentials, such as user ID, client certificate etc. </td> </tr> <tr> <td>Check Type</td> <td><code class=\"directive\">LuaHookTypeChecker</code></td> <td>This phase checks the requested file and assigns a content type and a handler to it</td> </tr> <tr class=\"odd\"> <td>Fixups</td> <td><code class=\"directive\">LuaHookFixups</code></td> <td>This is the final \"fix anything\" phase before the content handlers are run. Any last-minute changes to the request should be made here.</td> </tr> <tr> <td>Content handler</td> <td>fx. <code>.lua</code> files or through <code class=\"directive\"><a href=\"#luamaphandler\">LuaMapHandler</a></code>\n</td> <td>This is where the content is handled. Files are read, parsed, some are run, and the result is sent to the client</td> </tr> <tr class=\"odd\"> <td>Logging</td> <td><code class=\"directive\">LuaHookLog</code></td> <td>Once a request has been handled, it enters several logging phases, which logs the request in either the error or access log. Mod_lua is able to hook into the start of this and control logging output.</td> </tr> </table> <p>Hook functions are passed the request object as their only argument (except for LuaAuthzProvider, which also gets passed the arguments from the Require directive). They can return any value, depending on the hook, but most commonly they'll return OK, DONE, or DECLINED, which you can write in Lua as <code>apache2.OK</code>, <code>apache2.DONE</code>, or <code>apache2.DECLINED</code>, or else an HTTP status code.</p> <pre class=\"prettyprint lang-lua\">\n<strong>translate_name.lua</strong><br>\n-- example hook that rewrites the URI to a filesystem path.\n\nrequire 'apache2'\n\nfunction translate_name(r)\n    if r.uri == \"/translate-name\" then\n        r.filename = r.document_root .. \"/find_me.txt\"\n        return apache2.OK\n    end\n    -- we don't care about this URL, give another module a chance\n    return apache2.DECLINED\nend</pre> <pre class=\"prettyprint lang-lua\">\n<strong>translate_name2.lua</strong><br>\n--[[ example hook that rewrites one URI to another URI. It returns a\n     apache2.DECLINED to give other URL mappers a chance to work on the\n     substitution, including the core translate_name hook which maps based\n     on the DocumentRoot.\n\n     Note: Use the early/late flags in the directive to make it run before\n           or after mod_alias.\n--]]\n\nrequire 'apache2'\n\nfunction translate_name(r)\n    if r.uri == \"/translate-name\" then\n        r.uri = \"/find_me.txt\"\n        return apache2.DECLINED\n    end\n    return apache2.DECLINED\nend</pre>   <h2 id=\"datastructures\">Data Structures</h2> <dl> <dt>request_rec</dt> <dd> <p>The request_rec is mapped in as a userdata. It has a metatable which lets you do useful things with it. For the most part it has the same fields as the request_rec struct, many of which are writable as well as readable. (The table fields' content can be changed, but the fields themselves cannot be set to different tables.)</p> <table class=\"bordered\">\n<tr class=\"header\"> <th><strong>Name</strong></th> <th><strong>Lua type</strong></th> <th><strong>Writable</strong></th> <th><strong>Description</strong></th> </tr> <tr> <td><code>allowoverrides</code></td> <td>string</td> <td>no</td> <td>The AllowOverride options applied to the current request.</td> </tr> <tr class=\"odd\"> <td><code>ap_auth_type</code></td> <td>string</td> <td>no</td> <td>If an authentication check was made, this is set to the type of authentication (f.x. <code>basic</code>)</td> </tr> <tr> <td><code>args</code></td> <td>string</td> <td>yes</td> <td>The query string arguments extracted from the request (f.x. <code>foo=bar&amp;name=johnsmith</code>)</td> </tr> <tr class=\"odd\"> <td><code>assbackwards</code></td> <td>boolean</td> <td>no</td> <td>Set to true if this is an HTTP/0.9 style request (e.g. <code>GET /foo</code> (with no headers) )</td> </tr> <tr> <td><code>auth_name</code></td> <td>string</td> <td>no</td> <td>The realm name used for authorization (if applicable).</td> </tr> <tr class=\"odd\"> <td><code>banner</code></td> <td>string</td> <td>no</td> <td>The server banner, f.x. <code>Apache HTTP Server/2.4.3 openssl/0.9.8c</code>\n</td> </tr> <tr> <td><code>basic_auth_pw</code></td> <td>string</td> <td>no</td> <td>The basic auth password sent with this request, if any</td> </tr> <tr class=\"odd\"> <td><code>canonical_filename</code></td> <td>string</td> <td>no</td> <td>The canonical filename of the request</td> </tr> <tr> <td><code>content_encoding</code></td> <td>string</td> <td>no</td> <td>The content encoding of the current request</td> </tr> <tr class=\"odd\"> <td><code>content_type</code></td> <td>string</td> <td>yes</td> <td>The content type of the current request, as determined in the type_check phase (f.x. <code>image/gif</code> or <code>text/html</code>)</td> </tr> <tr> <td><code>context_prefix</code></td> <td>string</td> <td>no</td> <td></td> </tr> <tr class=\"odd\"> <td><code>context_document_root</code></td> <td>string</td> <td>no</td> <td></td> </tr> <tr> <td><code>document_root</code></td> <td>string</td> <td>no</td> <td>The document root of the host</td> </tr> <tr class=\"odd\"> <td><code>err_headers_out</code></td> <td>table</td> <td>no</td> <td>MIME header environment for the response, printed even on errors and persist across internal redirects</td> </tr> <tr> <td><code>filename</code></td> <td>string</td> <td>yes</td> <td>The file name that the request maps to, f.x. /www/example.com/foo.txt. This can be changed in the translate-name or map-to-storage phases of a request to allow the default handler (or script handlers) to serve a different file than what was requested.</td> </tr> <tr class=\"odd\"> <td><code>handler</code></td> <td>string</td> <td>yes</td> <td>The name of the <a href=\"../handler\">handler</a> that should serve this request, f.x. <code>lua-script</code> if it is to be served by mod_lua. This is typically set by the <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code> or <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code> directives, but could also be set via mod_lua to allow another handler to serve up a specific request that would otherwise not be served by it. </td> </tr> <tr> <td><code>headers_in</code></td> <td>table</td> <td>yes</td> <td>MIME header environment from the request. This contains headers such as <code>Host, User-Agent, Referer</code> and so on.</td> </tr> <tr class=\"odd\"> <td><code>headers_out</code></td> <td>table</td> <td>yes</td> <td>MIME header environment for the response.</td> </tr> <tr> <td><code>hostname</code></td> <td>string</td> <td>no</td> <td>The host name, as set by the <code>Host:</code> header or by a full URI.</td> </tr> <tr class=\"odd\"> <td><code>is_https</code></td> <td>boolean</td> <td>no</td> <td>Whether or not this request is done via HTTPS</td> </tr> <tr> <td><code>is_initial_req</code></td> <td>boolean</td> <td>no</td> <td>Whether this request is the initial request or a sub-request</td> </tr> <tr class=\"odd\"> <td><code>limit_req_body</code></td> <td>number</td> <td>no</td> <td>The size limit of the request body for this request, or 0 if no limit.</td> </tr> <tr> <td><code>log_id</code></td> <td>string</td> <td>no</td> <td>The ID to identify request in access and error log.</td> </tr> <tr class=\"odd\"> <td><code>method</code></td> <td>string</td> <td>no</td> <td>The request method, f.x. <code>GET</code> or <code>POST</code>.</td> </tr> <tr> <td><code>notes</code></td> <td>table</td> <td>yes</td> <td>A list of notes that can be passed on from one module to another.</td> </tr> <tr class=\"odd\"> <td><code>options</code></td> <td>string</td> <td>no</td> <td>The Options directive applied to the current request.</td> </tr> <tr> <td><code>path_info</code></td> <td>string</td> <td>no</td> <td>The PATH_INFO extracted from this request.</td> </tr> <tr class=\"odd\"> <td><code>port</code></td> <td>number</td> <td>no</td> <td>The server port used by the request.</td> </tr> <tr> <td><code>protocol</code></td> <td>string</td> <td>no</td> <td>The protocol used, f.x. <code>HTTP/1.1</code>\n</td> </tr> <tr class=\"odd\"> <td><code>proxyreq</code></td> <td>string</td> <td>yes</td> <td>Denotes whether this is a proxy request or not. This value is generally set in the post_read_request/translate_name phase of a request.</td> </tr> <tr> <td><code>range</code></td> <td>string</td> <td>no</td> <td>The contents of the <code>Range:</code> header.</td> </tr> <tr class=\"odd\"> <td><code>remaining</code></td> <td>number</td> <td>no</td> <td>The number of bytes remaining to be read from the request body.</td> </tr> <tr> <td><code>server_built</code></td> <td>string</td> <td>no</td> <td>The time the server executable was built.</td> </tr> <tr class=\"odd\"> <td><code>server_name</code></td> <td>string</td> <td>no</td> <td>The server name for this request.</td> </tr> <tr> <td><code>some_auth_required</code></td> <td>boolean</td> <td>no</td> <td>Whether some authorization is/was required for this request.</td> </tr> <tr class=\"odd\"> <td><code>subprocess_env</code></td> <td>table</td> <td>yes</td> <td>The environment variables set for this request.</td> </tr> <tr> <td><code>started</code></td> <td>number</td> <td>no</td> <td>The time the server was (re)started, in seconds since the epoch (Jan 1st, 1970)</td> </tr> <tr class=\"odd\"> <td><code>status</code></td> <td>number</td> <td>yes</td> <td>The (current) HTTP return code for this request, f.x. <code>200</code> or <code>404</code>.</td> </tr> <tr> <td><code>the_request</code></td> <td>string</td> <td>no</td> <td>The request string as sent by the client, f.x. <code>GET /foo/bar HTTP/1.1</code>.</td> </tr> <tr class=\"odd\"> <td><code>unparsed_uri</code></td> <td>string</td> <td>no</td> <td>The unparsed URI of the request</td> </tr> <tr> <td><code>uri</code></td> <td>string</td> <td>yes</td> <td>The URI after it has been parsed by httpd</td> </tr> <tr class=\"odd\"> <td><code>user</code></td> <td>string</td> <td>yes</td> <td>If an authentication check has been made, this is set to the name of the authenticated user.</td> </tr> <tr> <td><code>useragent_ip</code></td> <td>string</td> <td>no</td> <td>The IP of the user agent making the request</td> </tr> </table> </dd> </dl>   <h2 id=\"functions\">Built in functions</h2> <p>The request_rec object has (at least) the following methods:</p> <pre class=\"prettyprint lang-lua\">r:flush()   -- flushes the output buffer.\n            -- Returns true if the flush was successful, false otherwise.\n\nwhile we_have_stuff_to_send do\n    r:puts(\"Bla bla bla\\n\") -- print something to client\n    r:flush() -- flush the buffer (send to client)\n    r.usleep(500000) -- fake processing time for 0.5 sec. and repeat\nend</pre> <pre class=\"prettyprint lang-lua\">r:addoutputfilter(name|function) -- add an output filter:\n\nr:addoutputfilter(\"fooFilter\") -- add the fooFilter to the output stream</pre> <pre class=\"prettyprint lang-lua\">r:sendfile(filename) -- sends an entire file to the client, using sendfile if supported by the current platform:\n\nif use_sendfile_thing then\n    r:sendfile(\"/var/www/large_file.img\")\nend</pre> <pre class=\"prettyprint lang-lua\">r:parseargs() -- returns two tables; one standard key/value table for regular GET data, \n              -- and one for multi-value data (fx. foo=1&amp;foo=2&amp;foo=3):\n\nlocal GET, GETMULTI = r:parseargs()\nr:puts(\"Your name is: \" .. GET['name'] or \"Unknown\")</pre> <pre class=\"prettyprint lang-lua\">r:parsebody([sizeLimit]) -- parse the request body as a POST and return two lua tables,\n                         -- just like r:parseargs().\n                         -- An optional number may be passed to specify the maximum number \n                         -- of bytes to parse. Default is 8192 bytes:\n                 \nlocal POST, POSTMULTI = r:parsebody(1024*1024)\nr:puts(\"Your name is: \" .. POST['name'] or \"Unknown\")</pre> <pre class=\"prettyprint lang-lua\">r:puts(\"hello\", \" world\", \"!\") -- print to response body, self explanatory</pre> <pre class=\"prettyprint lang-lua\">r:write(\"a single string\") -- print to response body, self explanatory</pre> <pre class=\"prettyprint lang-lua\">r:escape_html(\"&lt;html&gt;test&lt;/html&gt;\") -- Escapes HTML code and returns the escaped result</pre> <pre class=\"prettyprint lang-lua\">r:base64_encode(string) -- Encodes a string using the Base64 encoding standard:\n\nlocal encoded = r:base64_encode(\"This is a test\") -- returns VGhpcyBpcyBhIHRlc3Q=</pre> <pre class=\"prettyprint lang-lua\">r:base64_decode(string) -- Decodes a Base64-encoded string:\n\nlocal decoded = r:base64_decode(\"VGhpcyBpcyBhIHRlc3Q=\") -- returns 'This is a test'</pre> <pre class=\"prettyprint lang-lua\">r:md5(string) -- Calculates and returns the MD5 digest of a string (binary safe):\n\nlocal hash = r:md5(\"This is a test\") -- returns ce114e4501d2f4e2dcea3e17b546f339</pre> <pre class=\"prettyprint lang-lua\">r:sha1(string) -- Calculates and returns the SHA1 digest of a string (binary safe):\n\nlocal hash = r:sha1(\"This is a test\") -- returns a54d88e06612d820bc3be72877c74f257b561b19</pre> <pre class=\"prettyprint lang-lua\">r:escape(string) -- URL-Escapes a string:\n\nlocal url = \"http://foo.bar/1 2 3 &amp; 4 + 5\"\nlocal escaped = r:escape(url) -- returns 'http%3a%2f%2ffoo.bar%2f1+2+3+%26+4+%2b+5'</pre> <pre class=\"prettyprint lang-lua\">r:unescape(string) -- Unescapes an URL-escaped string:\n\nlocal url = \"http%3a%2f%2ffoo.bar%2f1+2+3+%26+4+%2b+5\"\nlocal unescaped = r:unescape(url) -- returns 'http://foo.bar/1 2 3 &amp; 4 + 5'</pre> <pre class=\"prettyprint lang-lua\">r:construct_url(string) -- Constructs an URL from an URI\n\nlocal url = r:construct_url(r.uri)</pre> <pre class=\"prettyprint lang-lua\">r.mpm_query(number) -- Queries the server for MPM information using ap_mpm_query:\n\nlocal mpm = r.mpm_query(14)\nif mpm == 1 then\n    r:puts(\"This server uses the Event MPM\")\nend</pre> <pre class=\"prettyprint lang-lua\">r:expr(string) -- Evaluates an <a href=\"../expr\">expr</a> string.\n\nif r:expr(\"%{HTTP_HOST} =~ /^www/\") then\n    r:puts(\"This host name starts with www\")\nend</pre> <pre class=\"prettyprint lang-lua\">r:scoreboard_process(a) -- Queries the server for information about the process at position <code>a</code>:\n\nlocal process = r:scoreboard_process(1)\nr:puts(\"Server 1 has PID \" .. process.pid)</pre> <pre class=\"prettyprint lang-lua\">r:scoreboard_worker(a, b) -- Queries for information about the worker thread, <code>b</code>, in process <code>a</code>:\n\nlocal thread = r:scoreboard_worker(1, 1)\nr:puts(\"Server 1's thread 1 has thread ID \" .. thread.tid .. \" and is in \" .. thread.status .. \" status\")</pre> <pre class=\"prettyprint lang-lua\">r:clock() -- Returns the current time with microsecond precision</pre> <pre class=\"prettyprint lang-lua\">r:requestbody(filename) -- Reads and returns the request body of a request.\n                -- If 'filename' is specified, it instead saves the\n                -- contents to that file:\n                \nlocal input = r:requestbody()\nr:puts(\"You sent the following request body to me:\\n\")\nr:puts(input)</pre> <pre class=\"prettyprint lang-lua\">r:add_input_filter(filter_name) -- Adds 'filter_name' as an input filter</pre> <pre class=\"prettyprint lang-lua\">r.module_info(module_name) -- Queries the server for information about a module\n\nlocal mod = r.module_info(\"mod_lua.c\")\nif mod then\n    for k, v in pairs(mod.commands) do\n       r:puts( (\"%s: %s\\n\"):format(k,v)) -- print out all directives accepted by this module\n    end\nend</pre> <pre class=\"prettyprint lang-lua\">r:loaded_modules() -- Returns a list of modules loaded by httpd:\n\nfor k, module in pairs(r:loaded_modules()) do\n    r:puts(\"I have loaded module \" .. module .. \"\\n\")\nend</pre> <pre class=\"prettyprint lang-lua\">r:runtime_dir_relative(filename) -- Compute the name of a run-time file (e.g., shared memory \"file\") \n                         -- relative to the appropriate run-time directory.</pre> <pre class=\"prettyprint lang-lua\">r:server_info() -- Returns a table containing server information, such as \n                -- the name of the httpd executable file, mpm used etc.</pre> <pre class=\"prettyprint lang-lua\">r:set_document_root(file_path) -- Sets the document root for the request to file_path</pre> <pre class=\"prettyprint lang-lua\">r:set_context_info(prefix, docroot) -- Sets the context prefix and context document root for a request</pre> <pre class=\"prettyprint lang-lua\">r:os_escape_path(file_path) -- Converts an OS path to a URL in an OS dependent way</pre> <pre class=\"prettyprint lang-lua\">r:escape_logitem(string) -- Escapes a string for logging</pre> <pre class=\"prettyprint lang-lua\">r.strcmp_match(string, pattern) -- Checks if 'string' matches 'pattern' using strcmp_match (globs).\n                        -- fx. whether 'www.example.com' matches '*.example.com':\n                        \nlocal match = r.strcmp_match(\"foobar.com\", \"foo*.com\")\nif match then \n    r:puts(\"foobar.com matches foo*.com\")\nend</pre> <pre class=\"prettyprint lang-lua\">r:set_keepalive() -- Sets the keepalive status for a request. Returns true if possible, false otherwise.</pre> <pre class=\"prettyprint lang-lua\">r:make_etag() -- Constructs and returns the etag for the current request.</pre> <pre class=\"prettyprint lang-lua\">r:send_interim_response(clear) -- Sends an interim (1xx) response to the client.\n                       -- if 'clear' is true, available headers will be sent and cleared.</pre> <pre class=\"prettyprint lang-lua\">r:custom_response(status_code, string) -- Construct and set a custom response for a given status code.\n                               -- This works much like the ErrorDocument directive:\n                               \nr:custom_response(404, \"Baleted!\")</pre> <pre class=\"prettyprint lang-lua\">r.exists_config_define(string) -- Checks whether a configuration definition exists or not:\n\nif r.exists_config_define(\"FOO\") then\n    r:puts(\"httpd was probably run with -DFOO, or it was defined in the configuration\")\nend</pre> <pre class=\"prettyprint lang-lua\">r:state_query(string) -- Queries the server for state information</pre> <pre class=\"prettyprint lang-lua\">r:stat(filename [,wanted]) -- Runs stat() on a file, and returns a table with file information:\n\nlocal info = r:stat(\"/var/www/foo.txt\")\nif info then\n    r:puts(\"This file exists and was last modified at: \" .. info.modified)\nend</pre> <pre class=\"prettyprint lang-lua\">r:regex(string, pattern [,flags]) -- Runs a regular expression match on a string, returning captures if matched:\n\nlocal matches = r:regex(\"foo bar baz\", [[foo (\\w+) (\\S*)]])\nif matches then\n    r:puts(\"The regex matched, and the last word captured ($2) was: \" .. matches[2])\nend\n\n-- Example ignoring case sensitivity:\nlocal matches = r:regex(\"FOO bar BAz\", [[(foo) bar]], 1)\n\n-- Flags can be a bitwise combination of:\n-- 0x01: Ignore case\n-- 0x02: Multiline search</pre> <pre class=\"prettyprint lang-lua\">r.usleep(number_of_microseconds) -- Puts the script to sleep for a given number of microseconds.</pre> <pre class=\"prettyprint lang-lua\">r:dbacquire(dbType[, dbParams]) -- Acquires a connection to a database and returns a database class.\n                        -- See '<a href=\"#databases\">Database connectivity</a>' for details.</pre> <pre class=\"prettyprint lang-lua\">r:ivm_set(\"key\", value) -- Set an Inter-VM variable to hold a specific value.\n                        -- These values persist even though the VM is gone or not being used,\n                        -- and so should only be used if MaxConnectionsPerChild is &gt; 0\n                        -- Values can be numbers, strings and booleans, and are stored on a \n                        -- per process basis (so they won't do much good with a prefork mpm)\n                        \nr:ivm_get(\"key\")        -- Fetches a variable set by ivm_set. Returns the contents of the variable\n                        -- if it exists or nil if no such variable exists.\n                        \n-- An example getter/setter that saves a global variable outside the VM:\nfunction handle(r)\n    -- First VM to call this will get no value, and will have to create it\n    local foo = r:ivm_get(\"cached_data\")\n    if not foo then\n        foo = do_some_calcs() -- fake some return value\n        r:ivm_set(\"cached_data\", foo) -- set it globally\n    end\n    r:puts(\"Cached data is: \", foo)\nend</pre> <pre class=\"prettyprint lang-lua\">r:htpassword(string [,algorithm [,cost]]) -- Creates a password hash from a string.\n                                          -- algorithm: 0 = APMD5 (default), 1 = SHA, 2 = BCRYPT, 3 = CRYPT.\n                                          -- cost: only valid with BCRYPT algorithm (default = 5).</pre> <pre class=\"prettyprint lang-lua\">r:mkdir(dir [,mode]) -- Creates a directory and sets mode to optional mode paramter.</pre> <pre class=\"prettyprint lang-lua\">r:mkrdir(dir [,mode]) -- Creates directories recursive and sets mode to optional mode paramter.</pre> <pre class=\"prettyprint lang-lua\">r:rmdir(dir) -- Removes a directory.</pre> <pre class=\"prettyprint lang-lua\">r:touch(file [,mtime]) -- Sets the file modification time to current time or to optional mtime msec value.</pre> <pre class=\"prettyprint lang-lua\">r:get_direntries(dir) -- Returns a table with all directory entries.\n\nfunction handle(r)\n  local dir = r.context_document_root\n  for _, f in ipairs(r:get_direntries(dir)) do\n    local info = r:stat(dir .. \"/\" .. f)\n    if info then\n      local mtime = os.date(fmt, info.mtime / 1000000)\n      local ftype = (info.filetype == 2) and \"[dir] \" or \"[file]\"\n      r:puts( (\"%s %s %10i %s\\n\"):format(ftype, mtime, info.size, f) )\n    end\n  end\nend</pre> <pre class=\"prettyprint lang-lua\">r.date_parse_rfc(string) -- Parses a date/time string and returns seconds since epoche.</pre> <pre class=\"prettyprint lang-lua\">r:getcookie(key) -- Gets a HTTP cookie</pre> <pre class=\"prettyprint lang-lua\">r:setcookie{\n  key = [key],\n  value = [value],\n  expires = [expiry],\n  secure = [boolean],\n  httponly = [boolean],\n  path = [path],\n  domain = [domain]\n} -- Sets a HTTP cookie, for instance:\n\nr:setcookie{\n  key = \"cookie1\",\n  value = \"HDHfa9eyffh396rt\",\n  expires = os.time() + 86400,\n  secure = true\n}</pre> <pre class=\"prettyprint lang-lua\">r:wsupgrade() -- Upgrades a connection to WebSockets if possible (and requested):\nif r:wsupgrade() then -- if we can upgrade:\n    r:wswrite(\"Welcome to websockets!\") -- write something to the client\n    r:wsclose()  -- goodbye!\nend</pre> <pre class=\"prettyprint lang-lua\">r:wsread() -- Reads a WebSocket frame from a WebSocket upgraded connection (see above):\n\nlocal line, isFinal = r:wsread() -- isFinal denotes whether this is the final frame.\n                                 -- If it isn't, then more frames can be read\nr:wswrite(\"You wrote: \" .. line)</pre> <pre class=\"prettyprint lang-lua\">r:wswrite(line) -- Writes a frame to a WebSocket client:\nr:wswrite(\"Hello, world!\")</pre> <pre class=\"prettyprint lang-lua\">r:wsclose() -- Closes a WebSocket request and terminates it for httpd:\n\nif r:wsupgrade() then\n    r:wswrite(\"Write something: \")\n    local line = r:wsread() or \"nothing\"\n    r:wswrite(\"You wrote: \" .. line);\n    r:wswrite(\"Goodbye!\")\n    r:wsclose()\nend</pre>   <h2 id=\"logging\">Logging Functions</h2> <pre class=\"prettyprint lang-lua\">-- examples of logging messages\nr:trace1(\"This is a trace log message\") -- trace1 through trace8 can be used\nr:debug(\"This is a debug log message\")\nr:info(\"This is an info log message\")\nr:notice(\"This is a notice log message\")\nr:warn(\"This is a warn log message\")\nr:err(\"This is an err log message\")\nr:alert(\"This is an alert log message\")\nr:crit(\"This is a crit log message\")\nr:emerg(\"This is an emerg log message\")</pre>   <h2 id=\"apache2\">apache2 Package</h2> <p>A package named <code>apache2</code> is available with (at least) the following contents.</p> <dl> <dt>apache2.OK</dt> <dd>internal constant OK. Handlers should return this if they've handled the request.</dd> <dt>apache2.DECLINED</dt> <dd>internal constant DECLINED. Handlers should return this if they are not going to handle the request.</dd> <dt>apache2.DONE</dt> <dd>internal constant DONE.</dd> <dt>apache2.version</dt> <dd>Apache HTTP server version string</dd> <dt>apache2.HTTP_MOVED_TEMPORARILY</dt> <dd>HTTP status code</dd> <dt>apache2.PROXYREQ_NONE, apache2.PROXYREQ_PROXY, apache2.PROXYREQ_REVERSE, apache2.PROXYREQ_RESPONSE</dt> <dd>internal constants used by <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dd> <dt>apache2.AUTHZ_DENIED, apache2.AUTHZ_GRANTED, apache2.AUTHZ_NEUTRAL, apache2.AUTHZ_GENERAL_ERROR, apache2.AUTHZ_DENIED_NO_USER</dt> <dd>internal constants used by <code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code>\n</dd> </dl> <p>(Other HTTP status codes are not yet implemented.)</p>   <h2 id=\"modifying_buckets\">Modifying contents with Lua filters</h2> <p> Filter functions implemented via <code class=\"directive\"><a href=\"#luainputfilter\">LuaInputFilter</a></code> or <code class=\"directive\"><a href=\"#luaoutputfilter\">LuaOutputFilter</a></code> are designed as three-stage non-blocking functions using coroutines to suspend and resume a function as buckets are sent down the filter chain. The core structure of such a function is: </p> <pre class=\"prettyprint lang-lua\">function filter(r)\n    -- Our first yield is to signal that we are ready to receive buckets.\n    -- Before this yield, we can set up our environment, check for conditions,\n    -- and, if we deem it necessary, decline filtering a request alltogether:\n    if something_bad then\n        return -- This would skip this filter.\n    end\n    -- Regardless of whether we have data to prepend, a yield MUST be called here.\n    -- Note that only output filters can prepend data. Input filters must use the \n    -- final stage to append data to the content.\n    coroutine.yield([optional header to be prepended to the content])\n    \n    -- After we have yielded, buckets will be sent to us, one by one, and we can \n    -- do whatever we want with them and then pass on the result.\n    -- Buckets are stored in the global variable 'bucket', so we create a loop\n    -- that checks if 'bucket' is not nil:\n    while bucket ~= nil do\n        local output = mangle(bucket) -- Do some stuff to the content\n        coroutine.yield(output) -- Return our new content to the filter chain\n    end\n\n    -- Once the buckets are gone, 'bucket' is set to nil, which will exit the \n    -- loop and land us here. Anything extra we want to append to the content\n    -- can be done by doing a final yield here. Both input and output filters \n    -- can append data to the content in this phase.\n    coroutine.yield([optional footer to be appended to the content])\nend</pre>   <h2 id=\"databases\">Database connectivity</h2> <p> Mod_lua implements a simple database feature for querying and running commands on the most popular database engines (mySQL, PostgreSQL, FreeTDS, ODBC, SQLite, Oracle) as well as mod_dbd. </p> <p>The example below shows how to acquire a database handle and return information from a table:</p> <pre class=\"prettyprint lang-lua\">function handle(r)\n    -- Acquire a database handle\n    local database, err = r:dbacquire(\"mysql\", \"server=localhost,user=someuser,pass=somepass,dbname=mydb\")\n    if not err then\n        -- Select some information from it\n        local results, err = database:select(r, \"SELECT `name`, `age` FROM `people` WHERE 1\")\n        if not err then\n            local rows = results(0) -- fetch all rows synchronously\n            for k, row in pairs(rows) do\n                r:puts( string.format(\"Name: %s, Age: %s&lt;br/&gt;\", row[1], row[2]) )\n            end\n        else\n            r:puts(\"Database query error: \" .. err)\n        end\n        database:close()\n    else\n        r:puts(\"Could not connect to the database: \" .. err)\n    end\nend</pre> <p> To utilize <code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code>, specify <code>mod_dbd</code> as the database type, or leave the field blank: </p> <pre class=\"prettyprint lang-lua\">local database = r:dbacquire(\"mod_dbd\")</pre> <h3><a name=\"database_object\" id=\"database_object\">Database object and contained functions</a></h3> <p>The database object returned by <code>dbacquire</code> has the following methods:</p> <p><strong>Normal select and query from a database:</strong></p> <pre class=\"prettyprint lang-lua\">-- Run a statement and return the number of rows affected:\nlocal affected, errmsg = database:query(r, \"DELETE FROM `tbl` WHERE 1\")\n\n-- Run a statement and return a result set that can be used synchronously or async:\nlocal result, errmsg = database:select(r, \"SELECT * FROM `people` WHERE 1\")</pre> <p><strong>Using prepared statements (recommended):</strong></p> <pre class=\"prettyprint lang-lua\">-- Create and run a prepared statement:\nlocal statement, errmsg = database:prepare(r, \"DELETE FROM `tbl` WHERE `age` &gt; %u\")\nif not errmsg then\n    local result, errmsg = statement:query(20) -- run the statement with age &gt; 20\nend\n\n-- Fetch a prepared statement from a DBDPrepareSQL directive:\nlocal statement, errmsg = database:prepared(r, \"someTag\")\nif not errmsg then\n    local result, errmsg = statement:select(\"John Doe\", 123) -- inject the values \"John Doe\" and 123 into the statement\nend</pre> <p><strong>Escaping values, closing databases etc:</strong></p> <pre class=\"prettyprint lang-lua\">-- Escape a value for use in a statement:\nlocal escaped = database:escape(r, [[\"'|blabla]])\n\n-- Close a database connection and free up handles:\ndatabase:close()\n\n-- Check whether a database connection is up and running:\nlocal connected = database:active()</pre> <h3><a name=\"result_sets\" id=\"result_sets\">Working with result sets</a></h3> <p>The result set returned by <code>db:select</code> or by the prepared statement functions created through <code>db:prepare</code> can be used to fetch rows synchronously or asynchronously, depending on the row number specified:<br> <code>result(0)</code> fetches all rows in a synchronous manner, returning a table of rows.<br> <code>result(-1)</code> fetches the next available row in the set, asynchronously.<br> <code>result(N)</code> fetches row number <code>N</code>, asynchronously: </p> <pre class=\"prettyprint lang-lua\">-- fetch a result set using a regular query:\nlocal result, err = db:select(r, \"SELECT * FROM `tbl` WHERE 1\")\n\nlocal rows = result(0) -- Fetch ALL rows synchronously\nlocal row = result(-1) -- Fetch the next available row, asynchronously\nlocal row = result(1234) -- Fetch row number 1234, asynchronously\nlocal row = result(-1, true) -- Fetch the next available row, using row names as key indexes.</pre> <p>One can construct a function that returns an iterative function to iterate over all rows in a synchronous or asynchronous way, depending on the async argument: </p> <pre class=\"prettyprint lang-lua\">function rows(resultset, async)\n    local a = 0\n    local function getnext()\n        a = a + 1\n        local row = resultset(-1)\n        return row and a or nil, row\n    end\n    if not async then\n        return pairs(resultset(0))\n    else\n        return getnext, self\n    end\nend\n\nlocal statement, err = db:prepare(r, \"SELECT * FROM `tbl` WHERE `age` &gt; %u\")\nif not err then\n     -- fetch rows asynchronously:\n    local result, err = statement:select(20)\n    if not err then\n        for index, row in rows(result, true) do\n            ....\n        end\n    end\n\n     -- fetch rows synchronously:\n    local result, err = statement:select(20)\n    if not err then\n        for index, row in rows(result, false) do\n            ....\n        end\n    end\nend</pre> <h3><a name=\"closing_databases\" id=\"closing_databases\">Closing a database connection</a></h3> <p>Database handles should be closed using <code>database:close()</code> when they are no longer needed. If you do not close them manually, they will eventually be garbage collected and closed by mod_lua, but you may end up having too many unused connections to the database if you leave the closing up to mod_lua. Essentially, the following two measures are the same: </p> <pre class=\"prettyprint lang-lua\">-- Method 1: Manually close a handle\nlocal database = r:dbacquire(\"mod_dbd\")\ndatabase:close() -- All done\n\n-- Method 2: Letting the garbage collector close it\nlocal database = r:dbacquire(\"mod_dbd\")\ndatabase = nil -- throw away the reference\ncollectgarbage() -- close the handle via GC</pre> <h3><a name=\"database_caveat\" id=\"database_caveat\">Precautions when working with databases</a></h3> <p>Although the standard <code>query</code> and <code>run</code> functions are freely available, it is recommended that you use prepared statements whenever possible, to both optimize performance (if your db handle lives on for a long time) and to minimize the risk of SQL injection attacks. <code>run</code> and <code>query</code> should only be used when there are no variables inserted into a statement (a static statement). When using dynamic statements, use <code>db:prepare</code> or <code>db:prepared</code>. </p>   <div class=\"directive-section\">\n<h2 id=\"luaauthzprovider\">LuaAuthzProvider Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Plug an authorization provider function into <code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code> </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaAuthzProvider provider_name /path/to/lua/script.lua function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.3 and later</td>\n</tr> </table> <p>After a lua function has been registered as authorization provider, it can be used with the <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive:</p> <pre class=\"prettyprint lang-config\">LuaRoot \"/usr/local/apache2/lua\"\nLuaAuthzProvider foo authz.lua authz_check_foo\n&lt;Location \"/\"&gt;\n  Require foo johndoe\n&lt;/Location&gt;</pre> <pre class=\"prettyprint lang-lua\">require \"apache2\"\nfunction authz_check_foo(r, who)\n    if r.user ~= who then return apache2.AUTHZ_DENIED\n    return apache2.AUTHZ_GRANTED\nend</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"luacodecache\">LuaCodeCache Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure the compiled code cache.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaCodeCache stat|forever|never</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LuaCodeCache stat</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table>\n<p> Specify the behavior of the in-memory code cache. The default is stat, which stats the top level script (not any included ones) each time that file is needed, and reloads it if the modified time indicates it is newer than the one it has already loaded. The other values cause it to keep the file cached forever (don't stat and replace) or to never cache the file.</p> <p>In general stat or forever is good for production, and stat or never for development.</p> <div class=\"example\">\n<h3>Examples:</h3>\n<pre class=\"prettyprint lang-config\">LuaCodeCache stat\nLuaCodeCache forever\nLuaCodeCache never</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"luahookaccesschecker\">LuaHookAccessChecker Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the access_checker phase of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookAccessChecker /path/to/lua/script.lua hook_function_name [early|late]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The optional third argument is supported in 2.3.15 and later</td>\n</tr> </table> <p>Add your hook to the access_checker phase. An access checker hook function usually returns OK, DECLINED, or HTTP_FORBIDDEN.</p> <div class=\"note\">\n<p><strong>Ordering</strong></p>\n<p>The optional arguments \"early\" or \"late\" control when this script runs relative to other modules.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"luahookauthchecker\">LuaHookAuthChecker Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the auth_checker phase of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookAuthChecker /path/to/lua/script.lua hook_function_name [early|late]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The optional third argument is supported in 2.3.15 and later</td>\n</tr> </table> <p>Invoke a lua function in the auth_checker phase of processing a request. This can be used to implement arbitrary authentication and authorization checking. A very simple example: </p> <pre class=\"prettyprint lang-lua\">require 'apache2'\n\n-- fake authcheck hook\n-- If request has no auth info, set the response header and\n-- return a 401 to ask the browser for basic auth info.\n-- If request has auth info, don't actually look at it, just\n-- pretend we got userid 'foo' and validated it.\n-- Then check if the userid is 'foo' and accept the request.\nfunction authcheck_hook(r)\n\n   -- look for auth info\n   auth = r.headers_in['Authorization']\n   if auth ~= nil then\n     -- fake the user\n     r.user = 'foo'\n   end\n\n   if r.user == nil then\n      r:debug(\"authcheck: user is nil, returning 401\")\n      r.err_headers_out['WWW-Authenticate'] = 'Basic realm=\"WallyWorld\"'\n      return 401\n   elseif r.user == \"foo\" then\n      r:debug('user foo: OK')\n   else\n      r:debug(\"authcheck: user='\" .. r.user .. \"'\")\n      r.err_headers_out['WWW-Authenticate'] = 'Basic realm=\"WallyWorld\"'\n      return 401\n   end\n   return apache2.OK\nend</pre> <div class=\"note\">\n<p><strong>Ordering</strong></p>\n<p>The optional arguments \"early\" or \"late\" control when this script runs relative to other modules.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"luahookcheckuserid\">LuaHookCheckUserID Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the check_user_id phase of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookCheckUserID /path/to/lua/script.lua hook_function_name [early|late]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The optional third argument is supported in 2.3.15 and later</td>\n</tr> </table>\n<p>...</p> <div class=\"note\">\n<p><strong>Ordering</strong></p>\n<p>The optional arguments \"early\" or \"late\" control when this script runs relative to other modules.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"luahookfixups\">LuaHookFixups Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the fixups phase of a request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookFixups /path/to/lua/script.lua hook_function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p> Just like LuaHookTranslateName, but executed at the fixups phase </p> </div>  <div class=\"directive-section\">\n<h2 id=\"luahookinsertfilter\">LuaHookInsertFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the insert_filter phase of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookInsertFilter /path/to/lua/script.lua hook_function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table>\n<p>Not Yet Implemented</p> </div>  <div class=\"directive-section\">\n<h2 id=\"luahooklog\">LuaHookLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the access log phase of a request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookLog /path/to/lua/script.lua log_function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p> This simple logging hook allows you to run a function when httpd enters the logging phase of a request. With it, you can append data to your own logs, manipulate data before the regular log is written, or prevent a log entry from being created. To prevent the usual logging from happening, simply return <code>apache2.DONE</code> in your logging handler, otherwise return <code>apache2.OK</code> to tell httpd to log as normal. </p> <p>Example:</p> <pre class=\"prettyprint lang-config\">LuaHookLog \"/path/to/script.lua\" logger</pre> <pre class=\"prettyprint lang-lua\">-- /path/to/script.lua --\nfunction logger(r)\n    -- flip a coin:\n    -- If 1, then we write to our own Lua log and tell httpd not to log\n    -- in the main log.\n    -- If 2, then we just sanitize the output a bit and tell httpd to \n    -- log the sanitized bits.\n\n    if math.random(1,2) == 1 then\n        -- Log stuff ourselves and don't log in the regular log\n        local f = io.open(\"/foo/secret.log\", \"a\")\n        if f then\n            f:write(\"Something secret happened at \" .. r.uri .. \"\\n\")\n            f:close()\n        end\n        return apache2.DONE -- Tell httpd not to use the regular logging functions\n    else\n        r.uri = r.uri:gsub(\"somesecretstuff\", \"\") -- sanitize the URI\n        return apache2.OK -- tell httpd to log it.\n    end\nend</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"luahookmaptostorage\">LuaHookMapToStorage Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the map_to_storage phase of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookMapToStorage /path/to/lua/script.lua hook_function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p>Like <code class=\"directive\">LuaHookTranslateName</code> but executed at the map-to-storage phase of a request. Modules like mod_cache run at this phase, which makes for an interesting example on what to do here:</p> <pre class=\"prettyprint lang-config\">LuaHookMapToStorage \"/path/to/lua/script.lua\" check_cache</pre> <pre class=\"prettyprint lang-lua\">require\"apache2\"\ncached_files = {}\n\nfunction read_file(filename) \n    local input = io.open(filename, \"r\")\n    if input then\n        local data = input:read(\"*a\")\n        cached_files[filename] = data\n        file = cached_files[filename]\n        input:close()\n    end\n    return cached_files[filename]\nend\n\nfunction check_cache(r)\n    if r.filename:match(\"%.png$\") then -- Only match PNG files\n        local file = cached_files[r.filename] -- Check cache entries\n        if not file then\n            file = read_file(r.filename)  -- Read file into cache\n        end\n        if file then -- If file exists, write it out\n            r.status = 200\n            r:write(file)\n            r:info((\"Sent %s to client from cache\"):format(r.filename))\n            return apache2.DONE -- skip default handler for PNG files\n        end\n    end\n    return apache2.DECLINED -- If we had nothing to do, let others serve this.\nend</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"luahooktranslatename\">LuaHookTranslateName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the translate name phase of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookTranslateName /path/to/lua/script.lua hook_function_name [early|late]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The optional third argument is supported in 2.3.15 and later</td>\n</tr> </table>\n<p> Add a hook (at APR_HOOK_MIDDLE) to the translate name phase of request processing. The hook function receives a single argument, the request_rec, and should return a status code, which is either an HTTP error code, or the constants defined in the apache2 module: apache2.OK, apache2.DECLINED, or apache2.DONE. </p> <p>For those new to hooks, basically each hook will be invoked until one of them returns apache2.OK. If your hook doesn't want to do the translation it should just return apache2.DECLINED. If the request should stop processing, then return apache2.DONE.</p> <p>Example:</p> <pre class=\"prettyprint lang-config\"># httpd.conf\nLuaHookTranslateName \"/scripts/conf/hooks.lua\" silly_mapper</pre> <pre class=\"prettyprint lang-lua\">-- /scripts/conf/hooks.lua --\nrequire \"apache2\"\nfunction silly_mapper(r)\n    if r.uri == \"/\" then\n        r.filename = \"/var/www/home.lua\"\n        return apache2.OK\n    else\n        return apache2.DECLINED\n    end\nend</pre> <div class=\"note\">\n<p><strong>Context</strong></p>\n<p>This directive is not valid in <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code>, or htaccess context.</p>\n</div> <div class=\"note\">\n<p><strong>Ordering</strong></p>\n<p>The optional arguments \"early\" or \"late\" control when this script runs relative to other modules.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"luahooktypechecker\">LuaHookTypeChecker Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the type_checker phase of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaHookTypeChecker /path/to/lua/script.lua hook_function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table>\n<p> This directive provides a hook for the type_checker phase of the request processing. This phase is where requests are assigned a content type and a handler, and thus can be used to modify the type and handler based on input: </p> <pre class=\"prettyprint lang-config\">LuaHookTypeChecker \"/path/to/lua/script.lua\" type_checker</pre> <pre class=\"prettyprint lang-lua\">    function type_checker(r)\n        if r.uri:match(\"%.to_gif$\") then -- match foo.png.to_gif\n            r.content_type = \"image/gif\" -- assign it the image/gif type\n            r.handler = \"gifWizard\"      -- tell the gifWizard module to handle this\n            r.filename = r.uri:gsub(\"%.to_gif$\", \"\") -- fix the filename requested\n            return apache2.OK\n        end\n\n        return apache2.DECLINED\n    end</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"luainherit\">LuaInherit Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls how parent configuration sections are merged into children</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaInherit none|parent-first|parent-last</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LuaInherit parent-first</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.0 and later</td>\n</tr> </table>\n<p>By default, if LuaHook* directives are used in overlapping Directory or Location configuration sections, the scripts defined in the more specific section are run <em>after</em> those defined in the more generic section (LuaInherit parent-first). You can reverse this order, or make the parent context not apply at all.</p> <p> In previous 2.3.x releases, the default was effectively to ignore LuaHook* directives from parent configuration sections.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"luainputfilter\">LuaInputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a Lua function for content input filtering</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaInputFilter filter_name /path/to/lua/script.lua function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.5 and later</td>\n</tr> </table> <p>Provides a means of adding a Lua function as an input filter. As with output filters, input filters work as coroutines, first yielding before buffers are sent, then yielding whenever a bucket needs to be passed down the chain, and finally (optionally) yielding anything that needs to be appended to the input data. The global variable <code>bucket</code> holds the buckets as they are passed onto the Lua script: </p> <pre class=\"prettyprint lang-config\">LuaInputFilter myInputFilter \"/www/filter.lua\" input_filter\n&lt;Files \"*.lua\"&gt;\n  SetInputFilter myInputFilter\n&lt;/Files&gt;</pre> <pre class=\"prettyprint lang-lua\">--[[\n    Example input filter that converts all POST data to uppercase.\n]]--\nfunction input_filter(r)\n    print(\"luaInputFilter called\") -- debug print\n    coroutine.yield() -- Yield and wait for buckets\n    while bucket do -- For each bucket, do...\n        local output = string.upper(bucket) -- Convert all POST data to uppercase\n        coroutine.yield(output) -- Send converted data down the chain\n    end\n    -- No more buckets available.\n    coroutine.yield(\"&amp;filterSignature=1234\") -- Append signature at the end\nend</pre> <p> The input filter supports denying/skipping a filter if it is deemed unwanted: </p> <pre class=\"prettyprint lang-lua\">function input_filter(r)\n    if not good then\n        return -- Simply deny filtering, passing on the original content instead\n    end\n    coroutine.yield() -- wait for buckets\n    ... -- insert filter stuff here\nend</pre> <p> See \"<a href=\"#modifying_buckets\">Modifying contents with Lua filters</a>\" for more information. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"luamaphandler\">LuaMapHandler Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Map a path to a lua handler</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaMapHandler uri-pattern /path/to/lua/script.lua [function-name]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p>This directive matches a uri pattern to invoke a specific handler function in a specific file. It uses PCRE regular expressions to match the uri, and supports interpolating match groups into both the file path and the function name. Be careful writing your regular expressions to avoid security issues.</p> <div class=\"example\">\n<h3>Examples:</h3>\n<pre class=\"prettyprint lang-config\">LuaMapHandler \"/(\\w+)/(\\w+)\" \"/scripts/$1.lua\" \"handle_$2\"</pre> </div> <p>This would match uri's such as /photos/show?id=9 to the file /scripts/photos.lua and invoke the handler function handle_show on the lua vm after loading that file.</p> <pre class=\"prettyprint lang-config\">LuaMapHandler \"/bingo\" \"/scripts/wombat.lua\"</pre> <p>This would invoke the \"handle\" function, which is the default if no specific function name is provided.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"luaoutputfilter\">LuaOutputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a Lua function for content output filtering</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaOutputFilter filter_name /path/to/lua/script.lua function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.5 and later</td>\n</tr> </table> <p>Provides a means of adding a Lua function as an output filter. As with input filters, output filters work as coroutines, first yielding before buffers are sent, then yielding whenever a bucket needs to be passed down the chain, and finally (optionally) yielding anything that needs to be appended to the input data. The global variable <code>bucket</code> holds the buckets as they are passed onto the Lua script: </p> <pre class=\"prettyprint lang-config\">LuaOutputFilter myOutputFilter \"/www/filter.lua\" output_filter\n&lt;Files \"*.lua\"&gt;\n  SetOutputFilter myOutputFilter\n&lt;/Files&gt;</pre> <pre class=\"prettyprint lang-lua\">--[[\n    Example output filter that escapes all HTML entities in the output\n]]--\nfunction output_filter(r)\n    coroutine.yield(\"(Handled by myOutputFilter)&lt;br/&gt;\\n\") -- Prepend some data to the output,\n                                                          -- yield and wait for buckets.\n    while bucket do -- For each bucket, do...\n        local output = r:escape_html(bucket) -- Escape all output\n        coroutine.yield(output) -- Send converted data down the chain\n    end\n    -- No more buckets available.\nend</pre> <p> As with the input filter, the output filter supports denying/skipping a filter if it is deemed unwanted: </p> <pre class=\"prettyprint lang-lua\">function output_filter(r)\n    if not r.content_type:match(\"text/html\") then\n        return -- Simply deny filtering, passing on the original content instead\n    end\n    coroutine.yield() -- wait for buckets\n    ... -- insert filter stuff here\nend</pre> <div class=\"note\">\n<p><strong>Lua filters with <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code></strong></p> <p> When a Lua filter is used as the underlying provider via the <code class=\"directive\"><a href=\"mod_filter#filterprovider\">FilterProvider</a></code> directive, filtering will only work when the <var>filter-name</var> is identical to the <var>provider-name</var>. </p> </div> <p> See \"<a href=\"#modifying_buckets\">Modifying contents with Lua filters</a>\" for more information. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"luapackagecpath\">LuaPackageCPath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Add a directory to lua's package.cpath</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaPackageCPath /path/to/include/?.soa</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p>Add a path to lua's shared library search path. Follows the same conventions as lua. This just munges the package.cpath in the lua vms.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"luapackagepath\">LuaPackagePath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Add a directory to lua's package.path</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaPackagePath /path/to/include/?.lua</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table>\n<p>Add a path to lua's module search path. Follows the same conventions as lua. This just munges the package.path in the lua vms.</p> <div class=\"example\">\n<h3>Examples:</h3>\n<pre class=\"prettyprint lang-config\">LuaPackagePath \"/scripts/lib/?.lua\"\nLuaPackagePath \"/scripts/lib/?/init.lua\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"luaquickhandler\">LuaQuickHandler Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Provide a hook for the quick handler of request processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaQuickHandler /path/to/script.lua hook_function_name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p> This phase is run immediately after the request has been mapped to a virtal host, and can be used to either do some request processing before the other phases kick in, or to serve a request without the need to translate, map to storage et cetera. As this phase is run before anything else, directives such as <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> are void in this phase, just as URIs have not been properly parsed yet. </p> <div class=\"note\">\n<p><strong>Context</strong></p>\n<p>This directive is not valid in <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code>, or htaccess context.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"luaroot\">LuaRoot Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify the base path for resolving relative paths for mod_lua directives</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaRoot /path/to/a/directory</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p>Specify the base path which will be used to evaluate all relative paths within mod_lua. If not specified they will be resolved relative to the current working directory, which may not always work well for a server.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"luascope\">LuaScope Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>One of once, request, conn, thread -- default is once</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LuaScope once|request|conn|thread|server [min] [max]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LuaScope once</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lua</td>\n</tr> </table> <p>Specify the life cycle scope of the Lua interpreter which will be used by handlers in this \"Directory.\" The default is \"once\"</p> <dl> <dt>once:</dt> <dd>use the interpreter once and throw it away.</dd> <dt>request:</dt> <dd>use the interpreter to handle anything based on the same file within this request, which is also request scoped.</dd> <dt>conn:</dt> <dd>Same as request but attached to the connection_rec</dd> <dt>thread:</dt> <dd>Use the interpreter for the lifetime of the thread handling the request (only available with threaded MPMs).</dd> <dt>server:</dt> <dd>This one is different than others because the server scope is quite long lived, and multiple threads will have the same server_rec. To accommodate this, server scoped Lua states are stored in an apr resource list. The <code>min</code> and <code>max</code> arguments specify the minimum and maximum number of Lua states to keep in the pool.</dd> </dl> <p> Generally speaking, the <code>thread</code> and <code>server</code> scopes execute roughly 2-3 times faster than the rest, because they don't have to spawn new Lua states on every request (especially with the event MPM, as even keepalive requests will use a new thread for each request). If you are satisfied that your scripts will not have problems reusing a state, then the <code>thread</code> or <code>server</code> scopes should be used for maximum performance. While the <code>thread</code> scope will provide the fastest responses, the <code>server</code> scope will use less memory, as states are pooled, allowing f.x. 1000 threads to share only 100 Lua states, thus using only 10% of the memory required by the <code>thread</code> scope. </p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_lua.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_lua.html</a>\n  </p>\n</div>\n","mod/mod_negotiation":"<h1>Apache Module mod_negotiation</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides for <a href=\"../content-negotiation\">content negotiation</a>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>negotiation_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_negotiation.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>Content negotiation, or more accurately content selection, is the selection of the document that best matches the clients capabilities, from one of several available documents. There are two implementations of this.</p> <ul> <li>A type map (a file with the handler <code>type-map</code>) which explicitly lists the files containing the variants.</li> <li>A Multiviews search (enabled by the <code>Multiviews</code> <code class=\"directive\"><a href=\"core#options\">Options</a></code>), where the server does an implicit filename pattern match, and choose from amongst the results.</li> </ul>     <h2 id=\"typemaps\">Type maps</h2> <p>A type map has a format similar to RFC822 mail headers. It contains document descriptions separated by blank lines, with lines beginning with a hash character ('#') treated as comments. A document description consists of several header records; records may be continued on multiple lines if the continuation lines start with spaces. The leading space will be deleted and the lines concatenated. A header record consists of a keyword name, which always ends in a colon, followed by a value. Whitespace is allowed between the header name and value, and between the tokens of value. The headers allowed are: </p> <dl> <dt><code>Content-Encoding:</code></dt> <dd>The encoding of the file. Apache only recognizes encodings that are defined by an <code class=\"directive\"><a href=\"mod_mime#addencoding\">AddEncoding</a></code> directive. This normally includes the encodings <code>x-compress</code> for compress'd files, and <code>x-gzip</code> for gzip'd files. The <code>x-</code> prefix is ignored for encoding comparisons.</dd> <dt><code>Content-Language:</code></dt> <dd>The language(s) of the variant, as an Internet standard language tag (<a href=\"http://www.ietf.org/rfc/rfc1766.txt\">RFC 1766</a>). An example is <code>en</code>, meaning English. If the variant contains more than one language, they are separated by a comma.</dd> <dt><code>Content-Length:</code></dt> <dd>The length of the file, in bytes. If this header is not present, then the actual length of the file is used.</dd> <dt><code>Content-Type:</code></dt> <dd> The <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME media type</a> of the document, with optional parameters. Parameters are separated from the media type and from one another by a semi-colon, with a syntax of <code>name=value</code>. Common parameters include: <dl> <dt><code>level</code></dt> <dd>an integer specifying the version of the media type. For <code>text/html</code> this defaults to 2, otherwise 0.</dd> <dt><code>qs</code></dt> <dd>a floating-point number with a value in the range 0[.000] to 1[.000], indicating the relative 'quality' of this variant compared to the other available variants, independent of the client's capabilities. For example, a jpeg file is usually of higher source quality than an ascii file if it is attempting to represent a photograph. However, if the resource being represented is ascii art, then an ascii file would have a higher source quality than a jpeg file. All <code>qs</code> values are therefore specific to a given resource.</dd> </dl> <div class=\"example\">\n<h3>Example</h3>\n<pre>Content-Type: image/jpeg; qs=0.8</pre>\n</div> </dd> <dt><code>URI:</code></dt> <dd>uri of the file containing the variant (of the given media type, encoded with the given content encoding). These are interpreted as URLs relative to the map file; they must be on the same server, and they must refer to files to which the client would be granted access if they were to be requested directly.</dd> <dt><code>Body:</code></dt> <dd>The actual content of the resource may be included in the type-map file using the Body header. This header must contain a string that designates a delimiter for the body content. Then all following lines in the type map file will be considered part of the resource body until the delimiter string is found. <div class=\"example\">\n<h3>Example:</h3>\n<pre>Body:----xyz----\n&lt;html&gt;\n&lt;body&gt;\n&lt;p&gt;Content of the page.&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n----xyz----</pre>\n</div> </dd> </dl> <p>Consider, for example, a resource called <code>document.html</code> which is available in English, French, and German. The files for each of these are called <code>document.html.en</code>, <code>document.html.fr</code>, and <code>document.html.de</code>, respectively. The type map file will be called <code>document.html.var</code>, and will contain the following:</p> <div class=\"example\"><pre>URI: document.html\n\nContent-language: en\nContent-type: text/html\nURI: document.html.en\n\nContent-language: fr\nContent-type: text/html\nURI: document.html.fr\n\nContent-language: de\nContent-type: text/html\nURI: document.html.de</pre></div> <p>All four of these files should be placed in the same directory, and the <code>.var</code> file should be associated with the <code>type-map</code> handler with an <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code> directive:</p> <pre class=\"prettyprint lang-config\">AddHandler type-map .var</pre> <p>A request for <code>document.html.var</code> in this directory will result in choosing the variant which most closely matches the language preference specified in the user's <code>Accept-Language</code> request header.</p> <p>If <code>Multiviews</code> is enabled, and <code class=\"directive\"><a href=\"mod_mime#multiviewsmatch\">MultiviewsMatch</a></code> is set to \"handlers\" or \"any\", a request to <code>document.html</code> will discover <code>document.html.var</code> and continue negotiating with the explicit type map.</p> <p>Other configuration directives, such as <code class=\"directive\"><a href=\"mod_alias#alias\">Alias</a></code> can be used to map <code>document.html</code> to <code>document.html.var</code>.</p>   <h2 id=\"multiviews\">Multiviews</h2> <p>A Multiviews search is enabled by the <code>Multiviews</code> <code class=\"directive\"><a href=\"core#options\">Options</a></code>. If the server receives a request for <code>/some/dir/foo</code> and <code>/some/dir/foo</code> does <em>not</em> exist, then the server reads the directory looking for all files named <code>foo.*</code>, and effectively fakes up a type map which names all those files, assigning them the same media types and content-encodings it would have if the client had asked for one of them by name. It then chooses the best match to the client's requirements, and returns that document.</p> <p>The <code class=\"directive\"><a href=\"mod_mime#multiviewsmatch\">MultiviewsMatch</a></code> directive configures whether Apache will consider files that do not have content negotiation meta-information assigned to them when choosing files.</p>   <div class=\"directive-section\">\n<h2 id=\"cachenegotiateddocs\">CacheNegotiatedDocs Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Allows content-negotiated documents to be cached by proxy servers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheNegotiatedDocs On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheNegotiatedDocs Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_negotiation</td>\n</tr> </table> <p>If set, this directive allows content-negotiated documents to be cached by proxy servers. This could mean that clients behind those proxys could retrieve versions of the documents that are not the best match for their abilities, but it will make caching more efficient.</p> <p>This directive only applies to requests which come from HTTP/1.0 browsers. HTTP/1.1 provides much better control over the caching of negotiated documents, and this directive has no effect in responses to HTTP/1.1 requests.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"forcelanguagepriority\">ForceLanguagePriority Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Action to take if a single acceptable document is not found</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ForceLanguagePriority None|Prefer|Fallback [Prefer|Fallback]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ForceLanguagePriority Prefer</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_negotiation</td>\n</tr> </table> <p>The <code class=\"directive\">ForceLanguagePriority</code> directive uses the given <code class=\"directive\"><a href=\"#languagepriority\">LanguagePriority</a></code> to satisfy negotiation where the server could otherwise not return a single matching document.</p> <p><code>ForceLanguagePriority Prefer</code> uses <code>LanguagePriority</code> to serve a one valid result, rather than returning an HTTP result 300 (MULTIPLE CHOICES) when there are several equally valid choices. If the directives below were given, and the user's <code>Accept-Language</code> header assigned <code>en</code> and <code>de</code> each as quality <code>.500</code> (equally acceptable) then the first matching variant, <code>en</code>, will be served.</p> <pre class=\"prettyprint lang-config\">LanguagePriority en fr de\nForceLanguagePriority Prefer</pre> <p><code>ForceLanguagePriority Fallback</code> uses <code class=\"directive\"><a href=\"#languagepriority\">LanguagePriority</a></code> to serve a valid result, rather than returning an HTTP result 406 (NOT ACCEPTABLE). If the directives below were given, and the user's <code>Accept-Language</code> only permitted an <code>es</code> language response, but such a variant isn't found, then the first variant from the <code class=\"directive\"><a href=\"#languagepriority\">LanguagePriority</a></code> list below will be served.</p> <pre class=\"prettyprint lang-config\">LanguagePriority en fr de\nForceLanguagePriority Fallback</pre> <p>Both options, <code>Prefer</code> and <code>Fallback</code>, may be specified, so either the first matching variant from <code class=\"directive\"><a href=\"#languagepriority\">LanguagePriority</a></code> will be served if more than one variant is acceptable, or first available document will be served if none of the variants matched the client's acceptable list of languages.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_mime#addlanguage\">AddLanguage</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"languagepriority\">LanguagePriority Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The precedence of language variants for cases where the client does not express a preference</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LanguagePriority MIME-lang [MIME-lang] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_negotiation</td>\n</tr> </table> <p>The <code class=\"directive\">LanguagePriority</code> sets the precedence of language variants for the case where the client does not express a preference, when handling a Multiviews request. The list of <var>MIME-lang</var> are in order of decreasing preference.</p> <pre class=\"prettyprint lang-config\">LanguagePriority en fr de</pre> <p>For a request for <code>foo.html</code>, where <code>foo.html.fr</code> and <code>foo.html.de</code> both existed, but the browser did not express a language preference, then <code>foo.html.fr</code> would be returned.</p> <p>Note that this directive only has an effect if a 'best' language cannot be determined by any other means or the <code class=\"directive\"><a href=\"#forcelanguagepriority\">ForceLanguagePriority</a></code> directive is not <code>None</code>. In general, the client determines the language preference, not the server.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_mime#addlanguage\">AddLanguage</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_negotiation.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_negotiation.html</a>\n  </p>\n</div>\n","mod/mod_userdir":"<h1>Apache Module mod_userdir</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>User-specific directories</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>userdir_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_userdir.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module allows user-specific directories to be accessed using the <code>http://example.com/~user/</code> syntax.</p>    <div class=\"directive-section\">\n<h2 id=\"userdir\">UserDir Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Location of the user-specific directories</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>UserDir directory-filename [directory-filename] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_userdir</td>\n</tr> </table> <p>The <code class=\"directive\">UserDir</code> directive sets the real directory in a user's home directory to use when a request for a document for a user is received. <em>Directory-filename</em> is one of the following:</p> <ul> <li>The name of a directory or a pattern such as those shown below.</li> <li>The keyword <code>disabled</code>. This turns off <em>all</em> username-to-directory translations except those explicitly named with the <code>enabled</code> keyword (see below).</li> <li>The keyword <code>disabled</code> followed by a space-delimited list of usernames. Usernames that appear in such a list will <em>never</em> have directory translation performed, even if they appear in an <code>enabled</code> clause.</li> <li>The keyword <code>enabled</code> followed by a space-delimited list of usernames. These usernames will have directory translation performed even if a global disable is in effect, but not if they also appear in a <code>disabled</code> clause.</li> </ul> <p>If neither the <code>enabled</code> nor the <code>disabled</code> keywords appear in the <code class=\"directive\">Userdir</code> directive, the argument is treated as a filename pattern, and is used to turn the name into a directory specification. A request for <code>http://www.example.com/~bob/one/two.html</code> will be translated to:</p> <table> <tr>\n<th>UserDir directive used</th> <th>Translated path</th>\n</tr> <tr>\n<td>UserDir public_html</td> <td>~bob/public_html/one/two.html</td>\n</tr> <tr>\n<td>UserDir /usr/web</td> <td>/usr/web/bob/one/two.html</td>\n</tr> <tr>\n<td>UserDir /home/*/www</td> <td>/home/bob/www/one/two.html</td>\n</tr> </table> <p>The following directives will send redirects to the client:</p> <table> <tr>\n<th>UserDir directive used</th> <th>Translated path</th>\n</tr> <tr>\n<td>UserDir http://www.example.com/users</td> <td>http://www.example.com/users/bob/one/two.html</td>\n</tr> <tr>\n<td>UserDir http://www.example.com/*/usr</td> <td>http://www.example.com/bob/usr/one/two.html</td>\n</tr> <tr>\n<td>UserDir http://www.example.com/~*/</td> <td>http://www.example.com/~bob/one/two.html</td>\n</tr> </table> <div class=\"note\"> <strong>Be careful when using this directive; for instance, <code>\"UserDir ./\"</code> would map <code>\"/~root\"</code> to <code>\"/\"</code> - which is probably undesirable. It is strongly recommended that your configuration include a \"<code>UserDir disabled root</code>\" declaration. See also the <code class=\"directive\"><a href=\"core#directory\">Directory</a></code> directive and the <a href=\"../misc/security_tips\">Security Tips</a> page for more information.</strong> </div> <p>Additional examples:</p> <p>To allow a few users to have <code>UserDir</code> directories, but not anyone else, use the following:</p> <pre class=\"prettyprint lang-config\">UserDir disabled\nUserDir enabled user1 user2 user3</pre> <p>To allow most users to have <code>UserDir</code> directories, but deny this to a few, use the following:</p> <pre class=\"prettyprint lang-config\">UserDir disabled user4 user5 user6</pre> <p>It is also possible to specify alternative user directories. If you use a command like:</p> <pre class=\"prettyprint lang-config\">UserDir \"public_html\" \"/usr/web\" \"http://www.example.com/\"</pre> <p>With a request for <code>http://www.example.com/~bob/one/two.html</code>, will try to find the page at <code>~bob/public_html/one/two.html</code> first, then <code>/usr/web/bob/one/two.html</code>, and finally it will send a redirect to <code>http://www.example.com/bob/one/two.html</code>.</p> <p>If you add a redirect, it must be the last alternative in the list. Apache httpd cannot determine if the redirect succeeded or not, so if you have the redirect earlier in the list, that will always be the alternative that is used.</p> <p>User directory substitution is not active by default in versions 2.1.4 and later. In earlier versions, <code>UserDir public_html</code> was assumed if no <code class=\"directive\">UserDir</code> directive was present.</p> <div class=\"note\">\n<p><strong>Merging details</strong></p> <p> Lists of specific enabled and disabled users are replaced, not merged, from global to virtual host scope</p>\n</div> <h3>See also</h3> <ul> <li> <a href=\"../howto/public_html\">Per-user web directories tutorial</a> </li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_userdir.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_userdir.html</a>\n  </p>\n</div>\n","mod/mod_allowmethods":"<h1>Apache Module mod_allowmethods</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Easily restrict what HTTP methods can be used on the server</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>allowmethods_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_allowmethods.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module makes it easy to restrict what HTTP methods can be used on a server. The most common configuration would be:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\n   AllowMethods GET POST OPTIONS\n&lt;/Location&gt;</pre>    <div class=\"directive-section\">\n<h2 id=\"allowmethods\">AllowMethods Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Restrict access to the listed HTTP methods</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AllowMethods reset|HTTP-method [HTTP-method]...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AllowMethods reset</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_allowmethods</td>\n</tr> </table> <p>The HTTP-methods are case sensitive and are generally, as per RFC, given in upper case. The GET and HEAD methods are treated as equivalent. The <code>reset</code> keyword can be used to turn off <code class=\"module\"><a href=\"mod_allowmethods\">mod_allowmethods</a></code> in a deeper nested context:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/svn\"&gt;\n   AllowMethods reset\n&lt;/Location&gt;</pre> <div class=\"note\">\n<p><strong>Caution</strong></p> <p>The TRACE method cannot be denied by this module; use <code class=\"directive\"><a href=\"core#traceenable\">TraceEnable</a></code> instead.</p> </div> <p><code class=\"module\"><a href=\"mod_allowmethods\">mod_allowmethods</a></code> was written to replace the rather kludgy implementation of <code class=\"directive\"><a href=\"core#limit\">Limit</a></code> and <code class=\"directive\"><a href=\"core#limitexcept\">LimitExcept</a></code>.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_allowmethods.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_allowmethods.html</a>\n  </p>\n</div>\n","mod/mod_access_compat":"<h1>Apache Module mod_access_compat</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Group authorizations based on host (name or IP address)</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>access_compat_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_access_compat.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3 as a compatibility module with previous versions of Apache httpd 2.x. The directives provided by this module have been deprecated by the new authz refactoring. Please see <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code>\n</td>\n</tr>\n</table> <h3>Summary</h3> <p>The directives provided by <code class=\"module\"><a href=\"mod_access_compat\">mod_access_compat</a></code> are used in <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code>, and <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> sections as well as <code><a href=\"core#accessfilename\">.htaccess</a></code> files to control access to particular parts of the server. Access can be controlled based on the client hostname, IP address, or other characteristics of the client request, as captured in <a href=\"../env\">environment variables</a>. The <code class=\"directive\"><a href=\"#allow\">Allow</a></code> and <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives are used to specify which clients are or are not allowed access to the server, while the <code class=\"directive\"><a href=\"#order\">Order</a></code> directive sets the default access state, and configures how the <code class=\"directive\"><a href=\"#allow\">Allow</a></code> and <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives interact with each other.</p> <p>Both host-based access restrictions and password-based authentication may be implemented simultaneously. In that case, the <code class=\"directive\"><a href=\"#satisfy\">Satisfy</a></code> directive is used to determine how the two sets of restrictions interact.</p> <div class=\"warning\">\n<p><strong>Note</strong></p> <p>The directives provided by <code class=\"module\"><a href=\"mod_access_compat\">mod_access_compat</a></code> have been deprecated by <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code>. Mixing old directives like <code class=\"directive\"><a href=\"#order\">Order</a></code>, <code class=\"directive\"><a href=\"#allow\">Allow</a></code> or <code class=\"directive\"><a href=\"#deny\">Deny</a></code> with new ones like <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> is technically possible but discouraged. This module was created to support configurations containing only old directives to facilitate the 2.4 upgrade. Please check the <a href=\"https://httpd.apache.org/docs/2.4/en/upgrading.html\">upgrading</a> guide for more information. </p> </div> <p>In general, access restriction directives apply to all access methods (<code>GET</code>, <code>PUT</code>, <code>POST</code>, etc). This is the desired behavior in most cases. However, it is possible to restrict some methods, while leaving other methods unrestricted, by enclosing the directives in a <code class=\"directive\"><a href=\"core#limit\">&lt;Limit&gt;</a></code> section.</p> <div class=\"note\"> <p><strong>Merging of configuration sections</strong></p> <p>When any directive provided by this module is used in a new configuration section, no directives provided by this module are inherited from previous configuration sections.</p> </div>    <div class=\"directive-section\">\n<h2 id=\"allow\">Allow Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls which hosts can access an area of the server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Allow from all|host|env=[!]env-variable [host|env=[!]env-variable] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Limit</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_access_compat</td>\n</tr> </table> <p>The <code class=\"directive\">Allow</code> directive affects which hosts can access an area of the server. Access can be controlled by hostname, IP address, IP address range, or by other characteristics of the client request captured in environment variables.</p> <p>The first argument to this directive is always <code>from</code>. The subsequent arguments can take three different forms. If <code>Allow from all</code> is specified, then all hosts are allowed access, subject to the configuration of the <code class=\"directive\"><a href=\"#deny\">Deny</a></code> and <code class=\"directive\"><a href=\"#order\">Order</a></code> directives as discussed below. To allow only particular hosts or groups of hosts to access the server, the <em>host</em> can be specified in any of the following formats:</p> <dl> <dt>A (partial) domain-name</dt> <dd> <pre class=\"prettyprint lang-config\">Allow from example.org\nAllow from .net example.edu</pre> <p>Hosts whose names match, or end in, this string are allowed access. Only complete components are matched, so the above example will match <code>foo.example.org</code> but it will not match <code>fooexample.org</code>. This configuration will cause Apache httpd to perform a double DNS lookup on the client IP address, regardless of the setting of the <code class=\"directive\"><a href=\"core#hostnamelookups\">HostnameLookups</a></code> directive. It will do a reverse DNS lookup on the IP address to find the associated hostname, and then do a forward lookup on the hostname to assure that it matches the original IP address. Only if the forward and reverse DNS are consistent and the hostname matches will access be allowed.</p>\n</dd> <dt>A full IP address</dt> <dd> <pre class=\"prettyprint lang-config\">Allow from 10.1.2.3\nAllow from 192.168.1.104 192.168.1.205</pre> <p>An IP address of a host allowed access</p>\n</dd> <dt>A partial IP address</dt> <dd> <pre class=\"prettyprint lang-config\">Allow from 10.1\nAllow from 10 172.20 192.168.2</pre> <p>The first 1 to 3 bytes of an IP address, for subnet restriction.</p>\n</dd> <dt>A network/netmask pair</dt> <dd> <pre class=\"prettyprint lang-config\">Allow from 10.1.0.0/255.255.0.0</pre> <p>A network a.b.c.d, and a netmask w.x.y.z. For more fine-grained subnet restriction.</p>\n</dd> <dt>A network/nnn CIDR specification</dt> <dd> <pre class=\"prettyprint lang-config\">Allow from 10.1.0.0/16</pre> <p>Similar to the previous case, except the netmask consists of nnn high-order 1 bits.</p>\n</dd> </dl> <p>Note that the last three examples above match exactly the same set of hosts.</p> <p>IPv6 addresses and IPv6 subnets can be specified as shown below:</p> <pre class=\"prettyprint lang-config\">Allow from 2001:db8::a00:20ff:fea7:ccea\nAllow from 2001:db8::a00:20ff:fea7:ccea/10</pre> <p>The third format of the arguments to the <code class=\"directive\">Allow</code> directive allows access to the server to be controlled based on the existence of an <a href=\"../env\">environment variable</a>. When <code>Allow from env=env-variable</code> is specified, then the request is allowed access if the environment variable <var>env-variable</var> exists. When <code>Allow from env=!env-variable</code> is specified, then the request is allowed access if the environment variable <var>env-variable</var> doesn't exist. The server provides the ability to set environment variables in a flexible way based on characteristics of the client request using the directives provided by <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code>. Therefore, this directive can be used to allow access based on such factors as the clients <code>User-Agent</code> (browser type), <code>Referer</code>, or other HTTP request header fields.</p> <pre class=\"prettyprint lang-config\">SetEnvIf User-Agent ^KnockKnock/2\\.0 let_me_in\n&lt;Directory \"/docroot\"&gt;\n    Order Deny,Allow\n    Deny from all\n    Allow from env=let_me_in\n&lt;/Directory&gt;</pre> <p>In this case, browsers with a user-agent string beginning with <code>KnockKnock/2.0</code> will be allowed access, and all others will be denied.</p> <div class=\"note\"> <p><strong>Merging of configuration sections</strong></p> <p>When any directive provided by this module is used in a new configuration section, no directives provided by this module are inherited from previous configuration sections.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"deny\">Deny Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls which hosts are denied access to the server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Deny from all|host|env=[!]env-variable [host|env=[!]env-variable] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Limit</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_access_compat</td>\n</tr> </table> <p>This directive allows access to the server to be restricted based on hostname, IP address, or environment variables. The arguments for the <code class=\"directive\">Deny</code> directive are identical to the arguments for the <code class=\"directive\"><a href=\"#allow\">Allow</a></code> directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"order\">Order Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls the default access state and the order in which <code class=\"directive\">Allow</code> and <code class=\"directive\">Deny</code> are evaluated.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Order ordering</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Order Deny,Allow</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Limit</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_access_compat</td>\n</tr> </table> <p>The <code class=\"directive\">Order</code> directive, along with the <code class=\"directive\"><a href=\"#allow\">Allow</a></code> and <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives, controls a three-pass access control system. The first pass processes either all <code class=\"directive\"><a href=\"#allow\">Allow</a></code> or all <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives, as specified by the <code class=\"directive\"><a href=\"#order\">Order</a></code> directive. The second pass parses the rest of the directives (<code class=\"directive\"><a href=\"#deny\">Deny</a></code> or <code class=\"directive\"><a href=\"#allow\">Allow</a></code>). The third pass applies to all requests which do not match either of the first two.</p> <p>Note that all <code class=\"directive\"><a href=\"#allow\">Allow</a></code> and <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives are processed, unlike a typical firewall, where only the first match is used. The last match is effective (also unlike a typical firewall). Additionally, the order in which lines appear in the configuration files is not significant -- all <code class=\"directive\"><a href=\"#allow\">Allow</a></code> lines are processed as one group, all <code class=\"directive\"><a href=\"#deny\">Deny</a></code> lines are considered as another, and the default state is considered by itself.</p> <p><em>Ordering</em> is one of:</p> <dl> <dt><code>Allow,Deny</code></dt> <dd>First, all <code class=\"directive\"><a href=\"#allow\">Allow</a></code> directives are evaluated; at least one must match, or the request is rejected. Next, all <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives are evaluated. If any matches, the request is rejected. Last, any requests which do not match an <code class=\"directive\"><a href=\"#allow\">Allow</a></code> or a <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directive are denied by default.</dd> <dt><code>Deny,Allow</code></dt> <dd>First, all <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives are evaluated; if any match, the request is denied <strong>unless</strong> it also matches an <code class=\"directive\"><a href=\"#allow\">Allow</a></code> directive. Any requests which do not match any <code class=\"directive\"><a href=\"#allow\">Allow</a></code> or <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives are permitted.</dd> <dt><code>Mutual-failure</code></dt> <dd>This order has the same effect as <code>Order Allow,Deny</code> and is deprecated in its favor.</dd> </dl> <p>Keywords may only be separated by a comma; <em>no whitespace</em> is allowed between them.</p> <table class=\"bordered\"> <tr> <th>Match</th> <th>Allow,Deny result</th> <th>Deny,Allow result</th> </tr>\n<tr> <th>Match Allow only</th> <td>Request allowed</td> <td>Request allowed</td> </tr>\n<tr> <th>Match Deny only</th> <td>Request denied</td> <td>Request denied</td> </tr>\n<tr> <th>No match</th> <td>Default to second directive: Denied</td> <td>Default to second directive: Allowed</td> </tr>\n<tr> <th>Match both Allow &amp; Deny</th> <td>Final match controls: Denied</td> <td>Final match controls: Allowed</td> </tr> </table> <p>In the following example, all hosts in the example.org domain are allowed access; all other hosts are denied access.</p> <pre class=\"prettyprint lang-config\">Order Deny,Allow\nDeny from all\nAllow from example.org</pre> <p>In the next example, all hosts in the example.org domain are allowed access, except for the hosts which are in the foo.example.org subdomain, who are denied access. All hosts not in the example.org domain are denied access because the default state is to <code class=\"directive\"><a href=\"#deny\">Deny</a></code> access to the server.</p> <pre class=\"prettyprint lang-config\">Order Allow,Deny\nAllow from example.org\nDeny from foo.example.org</pre> <p>On the other hand, if the <code class=\"directive\">Order</code> in the last example is changed to <code>Deny,Allow</code>, all hosts will be allowed access. This happens because, regardless of the actual ordering of the directives in the configuration file, the <code>Allow from example.org</code> will be evaluated last and will override the <code>Deny from foo.example.org</code>. All hosts not in the <code>example.org</code> domain will also be allowed access because the default state is <code class=\"directive\"><a href=\"#allow\">Allow</a></code>.</p> <p>The presence of an <code class=\"directive\">Order</code> directive can affect access to a part of the server even in the absence of accompanying <code class=\"directive\"><a href=\"#allow\">Allow</a></code> and <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directives because of its effect on the default access state. For example,</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www\"&gt;\n    Order Allow,Deny\n&lt;/Directory&gt;</pre> <p>will Deny all access to the <code>/www</code> directory because the default access state is set to <code class=\"directive\"><a href=\"#deny\">Deny</a></code>.</p> <p>The <code class=\"directive\">Order</code> directive controls the order of access directive processing only within each phase of the server's configuration processing. This implies, for example, that an <code class=\"directive\"><a href=\"#allow\">Allow</a></code> or <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directive occurring in a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> section will always be evaluated after an <code class=\"directive\"><a href=\"#allow\">Allow</a></code> or <code class=\"directive\"><a href=\"#deny\">Deny</a></code> directive occurring in a <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> section or <code>.htaccess</code> file, regardless of the setting of the <code class=\"directive\">Order</code> directive. For details on the merging of configuration sections, see the documentation on <a href=\"../sections\">How Directory, Location and Files sections work</a>.</p> <div class=\"note\"> <p><strong>Merging of configuration sections</strong></p> <p>When any directive provided by this module is used in a new configuration section, no directives provided by this module are inherited from previous configuration sections.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"satisfy\">Satisfy Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Interaction between host-level access control and user authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Satisfy Any|All</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Satisfy All</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_access_compat</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Influenced by <code class=\"directive\"><a href=\"core#limit\">&lt;Limit&gt;</a></code> and <code class=\"directive\"><a href=\"core#limitexcept\">&lt;LimitExcept&gt;</a></code> in version 2.0.51 and later</td>\n</tr> </table> <p>Access policy if both <code class=\"directive\"><a href=\"#allow\">Allow</a></code> and <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> used. The parameter can be either <code>All</code> or <code>Any</code>. This directive is only useful if access to a particular area is being restricted by both username/password <em>and</em> client host address. In this case the default behavior (<code>All</code>) is to require that the client passes the address access restriction <em>and</em> enters a valid username and password. With the <code>Any</code> option the client will be granted access if they either pass the host restriction or enter a valid username and password. This can be used to password restrict an area, but to let clients from particular addresses in without prompting for a password.</p> <p>For example, if you wanted to let people on your network have unrestricted access to a portion of your website, but require that people outside of your network provide a password, you could use a configuration similar to the following:</p> <pre class=\"prettyprint lang-config\">Require valid-user\nAllow from 192.168.1\nSatisfy Any</pre> <p> Another frequent use of the <code class=\"directive\">Satisfy</code> directive is to relax access restrictions for a subdirectory: </p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/var/www/private\"&gt;\n    Require valid-user\n&lt;/Directory&gt;\n\n&lt;Directory \"/var/www/private/public\"&gt;\n    Allow from all\n    Satisfy Any\n&lt;/Directory&gt;</pre> <p>In the above example, authentication will be required for the <code>/var/www/private</code> directory, but will not be required for the <code>/var/www/private/public</code> directory.</p> <p>Since version 2.0.51 <code class=\"directive\">Satisfy</code> directives can be restricted to particular methods by <code class=\"directive\"><a href=\"core#limit\">&lt;Limit&gt;</a></code> and <code class=\"directive\"><a href=\"core#limitexcept\">&lt;LimitExcept&gt;</a></code> sections.</p> <div class=\"note\"> <p><strong>Merging of configuration sections</strong></p> <p>When any directive provided by this module is used in a new configuration section, no directives provided by this module are inherited from previous configuration sections.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#allow\">Allow</a></code></li> <li><code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_access_compat.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_access_compat.html</a>\n  </p>\n</div>\n","mod/mod_authn_core":"<h1>Apache Module mod_authn_core</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Core Authentication</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authn_core_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authn_core.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides core authentication capabilities to allow or deny access to portions of the web site. <code class=\"module\"><a href=\"mod_authn_core\">mod_authn_core</a></code> provides directives that are common to all authentication providers.</p>     <h2 id=\"authnalias\">Creating Authentication Provider Aliases</h2> <p>Extended authentication providers can be created within the configuration file and assigned an alias name. The alias providers can then be referenced through the directives <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> or <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> in the same way as a base authentication provider. Besides the ability to create and alias an extended provider, it also allows the same extended authentication provider to be reference by multiple locations.</p> <h3><a name=\"example\" id=\"example\">Examples</a></h3> <p>This example checks for passwords in two different text files.</p> <div class=\"example\">\n<h3>Checking multiple text password files</h3>\n<pre class=\"prettyprint lang-config\"># Check here first\n&lt;AuthnProviderAlias file file1&gt;\n    AuthUserFile \"/www/conf/passwords1\"\n&lt;/AuthnProviderAlias&gt;\n\n# Then check here\n&lt;AuthnProviderAlias file file2&gt;   \n    AuthUserFile \"/www/conf/passwords2\"\n&lt;/AuthnProviderAlias&gt;\n\n&lt;Directory \"/var/web/pages/secure\"&gt;\n    AuthBasicProvider file1 file2\n    \n    AuthType Basic\n    AuthName \"Protected Area\"\n    Require valid-user\n&lt;/Directory&gt;</pre> </div> <p>The example below creates two different ldap authentication provider aliases based on the ldap provider. This allows a single authenticated location to be serviced by multiple ldap hosts:</p> <div class=\"example\">\n<h3>Checking multiple LDAP servers</h3>\n<pre class=\"prettyprint lang-config\">&lt;AuthnProviderAlias ldap ldap-alias1&gt;\n    AuthLDAPBindDN cn=youruser,o=ctx\n    AuthLDAPBindPassword yourpassword\n    AuthLDAPURL ldap://ldap.host/o=ctx\n&lt;/AuthnProviderAlias&gt;\n&lt;AuthnProviderAlias ldap ldap-other-alias&gt;\n    AuthLDAPBindDN cn=yourotheruser,o=dev\n    AuthLDAPBindPassword yourotherpassword\n    AuthLDAPURL ldap://other.ldap.host/o=dev?cn\n&lt;/AuthnProviderAlias&gt;\n\nAlias \"/secure\" \"/webpages/secure\"\n&lt;Directory \"/webpages/secure\"&gt;\n    AuthBasicProvider ldap-other-alias  ldap-alias1\n    \n    AuthType Basic\n    AuthName \"LDAP Protected Place\"\n    Require valid-user\n    # Note that Require ldap-* would not work here, since the \n    # AuthnProviderAlias does not provide the config to authorization providers\n    # that are implemented in the same module as the authentication provider.\n&lt;/Directory&gt;</pre> </div>   <div class=\"directive-section\">\n<h2 id=\"authname\">AuthName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Authorization realm for use in HTTP authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthName auth-domain</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_core</td>\n</tr> </table> <p>This directive sets the name of the authorization realm for a directory. This realm is given to the client so that the user knows which username and password to send. <code class=\"directive\">AuthName</code> takes a single argument; if the realm name contains spaces, it must be enclosed in quotation marks. It must be accompanied by <code class=\"directive\"><a href=\"#authtype\">AuthType</a></code> and <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives, and directives such as <code class=\"directive\"><a href=\"mod_authn_file#authuserfile\">AuthUserFile</a></code> and <code class=\"directive\"><a href=\"mod_authz_groupfile#authgroupfile\">AuthGroupFile</a></code> to work.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">AuthName \"Top Secret\"</pre> <p>The string provided for the <code>AuthName</code> is what will appear in the password dialog provided by most browsers.</p> <h3>See also</h3> <ul> <li><a href=\"../howto/auth\">Authentication, Authorization, and Access Control</a></li> <li><code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"authnprovideralias\">&lt;AuthnProviderAlias&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enclose a group of directives that represent an extension of a base authentication provider and referenced by the specified alias</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;AuthnProviderAlias baseProvider Alias&gt; ... &lt;/AuthnProviderAlias&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_core</td>\n</tr> </table> <p><code>&lt;AuthnProviderAlias&gt;</code> and <code>&lt;/AuthnProviderAlias&gt;</code> are used to enclose a group of authentication directives that can be referenced by the alias name using one of the directives <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\"> AuthBasicProvider</a></code> or <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\"> AuthDigestProvider</a></code>.</p> <div class=\"note\">This directive has no affect on authorization, even for modules that provide both authentication and authorization.</div> </div>  <div class=\"directive-section\">\n<h2 id=\"authtype\">AuthType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Type of user authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthType None|Basic|Digest|Form</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_core</td>\n</tr> </table> <p>This directive selects the type of user authentication for a directory. The authentication types available are <code>None</code>, <code>Basic</code> (implemented by <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code>), <code>Digest</code> (implemented by <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>), and <code>Form</code> (implemented by <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code>).</p> <p>To implement authentication, you must also use the <code class=\"directive\"><a href=\"#authname\">AuthName</a></code> and <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives. In addition, the server must have an authentication-provider module such as <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> and an authorization module such as <code class=\"module\"><a href=\"mod_authz_user\">mod_authz_user</a></code>.</p> <p>The authentication type <code>None</code> disables authentication. When authentication is enabled, it is normally inherited by each subsequent <a href=\"../sections#mergin\">configuration section</a>, unless a different authentication type is specified. If no authentication is desired for a subsection of an authenticated section, the authentication type <code>None</code> may be used; in the following example, clients may access the <code>/www/docs/public</code> directory without authenticating:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/docs\"&gt;\n    AuthType Basic\n    AuthName Documents\n    AuthBasicProvider file\n    AuthUserFile \"/usr/local/apache/passwd/passwords\"\n    Require valid-user\n&lt;/Directory&gt;\n\n&lt;Directory \"/www/docs/public\"&gt;\n    AuthType None\n    Require all granted\n&lt;/Directory&gt;</pre> <div class=\"note\">When disabling authentication, note that clients which have already authenticated against another portion of the server's document tree will typically continue to send authentication HTTP headers or cookies with each request, regardless of whether the server actually requires authentication for every resource.</div> <h3>See also</h3> <ul> <li><a href=\"../howto/auth\">Authentication, Authorization, and Access Control</a></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authn_core.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authn_core.html</a>\n  </p>\n</div>\n","mod/mod_mime":"<h1>Apache Module mod_mime</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Associates the requested filename's extensions with the file's behavior (handlers and filters) and content (mime-type, language, character set and encoding)</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mime_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_mime.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module is used to assign content metadata to the content selected for an HTTP response by mapping patterns in the URI or filenames to the metadata values. For example, the filename extensions of content files often define the content's Internet media type, language, character set, and content-encoding. This information is sent in HTTP messages containing that content and used in content negotiation when selecting alternatives, such that the user's preferences are respected when choosing one of several possible contents to serve. See <code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code> for more information about <a href=\"../content-negotiation\">content negotiation</a>.</p> <p>The directives <code class=\"directive\"><a href=\"#addcharset\">AddCharset</a></code>, <code class=\"directive\"><a href=\"#addencoding\">AddEncoding</a></code>, <code class=\"directive\"><a href=\"#addlanguage\">AddLanguage</a></code> and <code class=\"directive\"><a href=\"#addtype\">AddType</a></code> are all used to map file extensions onto the metadata for that file. Respectively they set the character set, content-encoding, content-language, and <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media-type</a> (content-type) of documents. The directive <code class=\"directive\"><a href=\"#typesconfig\">TypesConfig</a></code> is used to specify a file which also maps extensions onto media types. </p> <p>In addition, <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> may define the <a href=\"../handler\">handler</a> and <a href=\"../filter\">filters</a> that originate and process content. The directives <code class=\"directive\"><a href=\"#addhandler\">AddHandler</a></code>, <code class=\"directive\"><a href=\"#addoutputfilter\">AddOutputFilter</a></code>, and <code class=\"directive\"><a href=\"#addinputfilter\">AddInputFilter</a></code> control the modules or scripts that serve the document. The <code class=\"directive\"><a href=\"#multiviewsmatch\">MultiviewsMatch</a></code> directive allows <code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code> to consider these file extensions to be included when testing Multiviews matches.</p> <p>While <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> associates metadata with filename extensions, the <code class=\"module\"><a href=\"core\">core</a></code> server provides directives that are used to associate all the files in a given container (<em>e.g.</em>, <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code>, <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code>, or <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code>) with particular metadata. These directives include <code class=\"directive\"><a href=\"core#forcetype\">ForceType</a></code>, <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code>, <code class=\"directive\"><a href=\"core#setinputfilter\">SetInputFilter</a></code>, and <code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code>. The core directives override any filename extension mappings defined in <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code>.</p> <p>Note that changing the metadata for a file does not change the value of the <code>Last-Modified</code> header. Thus, previously cached copies may still be used by a client or proxy, with the previous headers. If you change the metadata (language, content type, character set or encoding) you may need to 'touch' affected files (updating their last modified date) to ensure that all visitors are receive the corrected content headers.</p>     <h2 id=\"multipleext\">Files with Multiple Extensions</h2> <p>Files can have more than one extension; the order of the extensions is <em>normally</em> irrelevant. For example, if the file <code>welcome.html.fr</code> maps onto content type <code>text/html</code> and language French then the file <code>welcome.fr.html</code> will map onto exactly the same information. If more than one extension is given that maps onto the same type of metadata, then the one to the right will be used, except for languages and content encodings. For example, if <code>.gif</code> maps to the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media-type</a> <code>image/gif</code> and <code>.html</code> maps to the media-type <code>text/html</code>, then the file <code>welcome.gif.html</code> will be associated with the media-type <code>text/html</code>.</p> <p><a href=\"#charset-lang\">Languages</a> and <a href=\"#contentencoding\">content encodings</a> are treated accumulative, because one can assign more than one language or encoding to a particular resource. For example, the file <code>welcome.html.en.de</code> will be delivered with <code>Content-Language: en, de</code> and <code>Content-Type: text/html</code>.</p> <p>Care should be taken when a file with multiple extensions gets associated with both a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media-type</a> and a handler. This will usually result in the request being handled by the module associated with the handler. For example, if the <code>.imap</code> extension is mapped to the handler <code>imap-file</code> (from <code class=\"module\"><a href=\"mod_imagemap\">mod_imagemap</a></code>) and the <code>.html</code> extension is mapped to the media-type <code>text/html</code>, then the file <code>world.imap.html</code> will be associated with both the <code>imap-file</code> handler and <code>text/html</code> media-type. When it is processed, the <code>imap-file</code> handler will be used, and so it will be treated as a <code class=\"module\"><a href=\"mod_imagemap\">mod_imagemap</a></code> imagemap file.</p> <p>If you would prefer only the last dot-separated part of the filename to be mapped to a particular piece of meta-data, then do not use the <code>Add*</code> directives. For example, if you wish to have the file <code>foo.html.cgi</code> processed as a CGI script, but not the file <code>bar.cgi.html</code>, then instead of using <code>AddHandler cgi-script .cgi</code>, use</p> <div class=\"example\">\n<h3>Configure handler based on final extension only</h3>\n<pre class=\"prettyprint lang-config\">&lt;FilesMatch \"[^.]+\\.cgi$\"&gt;\n  SetHandler cgi-script\n&lt;/FilesMatch&gt;</pre> </div>   <h2 id=\"contentencoding\">Content encoding</h2> <p>A file of a particular <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media-type</a> can additionally be encoded a particular way to simplify transmission over the Internet. While this usually will refer to compression, such as <code>gzip</code>, it can also refer to encryption, such a <code>pgp</code> or to an encoding such as UUencoding, which is designed for transmitting a binary file in an ASCII (text) format.</p> <p>The <a href=\"http://www.ietf.org/rfc/rfc2616.txt\">HTTP/1.1 RFC</a>, section 14.11 puts it this way:</p> <blockquote cite=\"http://www.ietf.org/rfc/rfc2616.txt\"> <p>The Content-Encoding entity-header field is used as a modifier to the media-type. When present, its value indicates what additional content codings have been applied to the entity-body, and thus what decoding mechanisms must be applied in order to obtain the media-type referenced by the Content-Type header field. Content-Encoding is primarily used to allow a document to be compressed without losing the identity of its underlying media type.</p> </blockquote> <p>By using more than one file extension (see <a href=\"#multipleext\">section above about multiple file extensions</a>), you can indicate that a file is of a particular <em>type</em>, and also has a particular <em>encoding</em>. </p> <p>For example, you may have a file which is a Microsoft Word document, which is pkzipped to reduce its size. If the <code>.doc</code> extension is associated with the Microsoft Word file type, and the <code>.zip</code> extension is associated with the pkzip file encoding, then the file <code>Resume.doc.zip</code> would be known to be a pkzip'ed Word document.</p> <p>Apache sends a <code>Content-encoding</code> header with the resource, in order to tell the client browser about the encoding method.</p> <pre class=\"prettyprint lang-config\">Content-encoding: pkzip</pre>   <h2 id=\"charset-lang\">Character sets and languages</h2> <p>In addition to file type and the file encoding, another important piece of information is what language a particular document is in, and in what character set the file should be displayed. For example, the document might be written in the Vietnamese alphabet, or in Cyrillic, and should be displayed as such. This information, also, is transmitted in HTTP headers.</p> <p>The character set, language, encoding and mime type are all used in the process of content negotiation (See <code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code>) to determine which document to give to the client, when there are alternative documents in more than one character set, language, encoding or mime type. All filename extensions associations created with <code class=\"directive\"><a href=\"#addcharset\">AddCharset</a></code>, <code class=\"directive\"><a href=\"#addencoding\">AddEncoding</a></code>, <code class=\"directive\"><a href=\"#addlanguage\">AddLanguage</a></code> and <code class=\"directive\"><a href=\"#addtype\">AddType</a></code> directives (and extensions listed in the <code class=\"directive\"><a href=\"mod_mime_magic#mimemagicfile\">MimeMagicFile</a></code>) participate in this select process. Filename extensions that are only associated using the <code class=\"directive\"><a href=\"#addhandler\">AddHandler</a></code>, <code class=\"directive\"><a href=\"#addinputfilter\">AddInputFilter</a></code> or <code class=\"directive\"><a href=\"#addoutputfilter\">AddOutputFilter</a></code> directives may be included or excluded from matching by using the <code class=\"directive\"><a href=\"#multiviewsmatch\">MultiviewsMatch</a></code> directive.</p> <h3><a name=\"charset\" id=\"charset\">Charset</a></h3> <p>To convey this further information, Apache optionally sends a <code>Content-Language</code> header, to specify the language that the document is in, and can append additional information onto the <code>Content-Type</code> header to indicate the particular character set that should be used to correctly render the information.</p> <div class=\"example\"><pre>Content-Language: en, fr Content-Type: text/plain; charset=ISO-8859-1</pre></div> <p>The language specification is the two-letter abbreviation for the language. The <code>charset</code> is the name of the particular character set which should be used.</p>   <div class=\"directive-section\">\n<h2 id=\"addcharset\">AddCharset Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps the given filename extensions to the specified content charset</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddCharset charset extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">AddCharset</code> directive maps the given filename extensions to the specified content charset (the Internet registered name for a given character encoding). <var>charset</var> is the <a href=\"http://www.iana.org/assignments/character-sets\">media type's charset parameter</a> for resources with filenames containing <var>extension</var>. This mapping is added to any already in force, overriding any mappings that already exist for the same <var>extension</var>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">AddLanguage ja .ja\nAddCharset EUC-JP .euc\nAddCharset ISO-2022-JP .jis\nAddCharset SHIFT_JIS .sjis</pre> </div> <p>Then the document <code>xxxx.ja.jis</code> will be treated as being a Japanese document whose charset is <code>ISO-2022-JP</code> (as will the document <code>xxxx.jis.ja</code>). The <code class=\"directive\">AddCharset</code> directive is useful for both to inform the client about the character encoding of the document so that the document can be interpreted and displayed appropriately, and for <a href=\"../content-negotiation\">content negotiation</a>, where the server returns one from several documents based on the client's charset preference.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot. Filenames may have <a href=\"#multipleext\">multiple extensions</a> and the <var>extension</var> argument will be compared against each of them.</p> <h3>See also</h3> <ul> <li><code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code></li> <li><code class=\"directive\"><a href=\"core#adddefaultcharset\">AddDefaultCharset</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"addencoding\">AddEncoding Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps the given filename extensions to the specified encoding type</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddEncoding encoding extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">AddEncoding</code> directive maps the given filename extensions to the specified HTTP content-encoding. <var>encoding</var> is the HTTP content coding to append to the value of the Content-Encoding header field for documents named with the <var>extension</var>. This mapping is added to any already in force, overriding any mappings that already exist for the same <var>extension</var>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">AddEncoding x-gzip .gz\nAddEncoding x-compress .Z</pre> </div> <p>This will cause filenames containing the <code>.gz</code> extension to be marked as encoded using the <code>x-gzip</code> encoding, and filenames containing the <code>.Z</code> extension to be marked as encoded with <code>x-compress</code>.</p> <p>Old clients expect <code>x-gzip</code> and <code>x-compress</code>, however the standard dictates that they're equivalent to <code>gzip</code> and <code>compress</code> respectively. Apache does content encoding comparisons by ignoring any leading <code>x-</code>. When responding with an encoding Apache will use whatever form (<em>i.e.</em>, <code>x-foo</code> or <code>foo</code>) the client requested. If the client didn't specifically request a particular form Apache will use the form given by the <code>AddEncoding</code> directive. To make this long story short, you should always use <code>x-gzip</code> and <code>x-compress</code> for these two specific encodings. More recent encodings, such as <code>deflate</code>, should be specified without the <code>x-</code>.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot. Filenames may have <a href=\"#multipleext\">multiple extensions</a> and the <var>extension</var> argument will be compared against each of them.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"addhandler\">AddHandler Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps the filename extensions to the specified handler</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddHandler handler-name extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>Files having the name <var>extension</var> will be served by the specified <var><a href=\"../handler\">handler-name</a></var>. This mapping is added to any already in force, overriding any mappings that already exist for the same <var>extension</var>. For example, to activate CGI scripts with the file extension <code>.cgi</code>, you might use:</p> <pre class=\"prettyprint lang-config\">AddHandler cgi-script .cgi</pre> <p>Once that has been put into your httpd.conf file, any file containing the <code>.cgi</code> extension will be treated as a CGI program.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot. Filenames may have <a href=\"#multipleext\">multiple extensions</a> and the <var>extension</var> argument will be compared against each of them.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"addinputfilter\">AddInputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps filename extensions to the filters that will process client requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddInputFilter filter[;filter...] extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p><code class=\"directive\">AddInputFilter</code> maps the filename extension <var>extension</var> to the <a href=\"../filter\">filters</a> which will process client requests and POST input when they are received by the server. This is in addition to any filters defined elsewhere, including the <code class=\"directive\"><a href=\"core#setinputfilter\">SetInputFilter</a></code> directive. This mapping is merged over any already in force, overriding any mappings that already exist for the same <var>extension</var>.</p> <p>If more than one <var>filter</var> is specified, they must be separated by semicolons in the order in which they should process the content. The <var>filter</var> is case-insensitive.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot. Filenames may have <a href=\"#multipleext\">multiple extensions</a> and the <var>extension</var> argument will be compared against each of them.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#removeinputfilter\">RemoveInputFilter</a></code></li> <li><code class=\"directive\"><a href=\"core#setinputfilter\">SetInputFilter</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"addlanguage\">AddLanguage Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps the given filename extension to the specified content language</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddLanguage language-tag extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">AddLanguage</code> directive maps the given filename extension to the specified content language. Files with the filename <var>extension</var> are assigned an HTTP Content-Language value of <var>language-tag</var> corresponding to the language identifiers defined by RFC 3066. This directive overrides any mappings that already exist for the same <var>extension</var>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">AddEncoding x-compress .Z\nAddLanguage en .en\nAddLanguage fr .fr</pre> </div> <p>Then the document <code>xxxx.en.Z</code> will be treated as being a compressed English document (as will the document <code>xxxx.Z.en</code>). Although the content language is reported to the client, the browser is unlikely to use this information. The <code class=\"directive\">AddLanguage</code> directive is more useful for <a href=\"../content-negotiation\">content negotiation</a>, where the server returns one from several documents based on the client's language preference.</p> <p>If multiple language assignments are made for the same extension, the last one encountered is the one that is used. That is, for the case of:</p> <pre class=\"prettyprint lang-config\">AddLanguage en .en\nAddLanguage en-gb .en\nAddLanguage en-us .en</pre> <p>documents with the extension <code>.en</code> would be treated as being <code>en-us</code>.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot. Filenames may have <a href=\"#multipleext\">multiple extensions</a> and the <var>extension</var> argument will be compared against each of them.</p> <h3>See also</h3> <ul> <li><code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"addoutputfilter\">AddOutputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps filename extensions to the filters that will process responses from the server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddOutputFilter filter[;filter...] extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">AddOutputFilter</code> directive maps the filename extension <var>extension</var> to the <a href=\"../filter\">filters</a> which will process responses from the server before they are sent to the client. This is in addition to any filters defined elsewhere, including <code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code> and <code class=\"directive\"><a href=\"mod_filter#addoutputfilterbytype\">AddOutputFilterByType</a></code> directive. This mapping is merged over any already in force, overriding any mappings that already exist for the same <var>extension</var>.</p> <p>For example, the following configuration will process all <code>.shtml</code> files for server-side includes and will then compress the output using <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code>.</p> <pre class=\"prettyprint lang-config\">AddOutputFilter INCLUDES;DEFLATE shtml</pre> <p>If more than one filter is specified, they must be separated by semicolons in the order in which they should process the content. The <var>filter</var> argument is case-insensitive.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot. Filenames may have <a href=\"#multipleext\">multiple extensions</a> and the <var>extension</var> argument will be compared against each of them.</p> <p>Note that when defining a set of filters using the <code class=\"directive\"><a href=\"#addoutputfilter\">AddOutputFilter</a></code> directive, any definition made will replace any previous definition made by the <code class=\"directive\"><a href=\"#addoutputfilter\">AddOutputFilter</a></code> directive.</p> <pre class=\"prettyprint lang-config\"># Effective filter \"DEFLATE\"\nAddOutputFilter DEFLATE shtml\n&lt;Location \"/foo\"&gt;\n  # Effective filter \"INCLUDES\", replacing \"DEFLATE\"\n  AddOutputFilter INCLUDES shtml\n&lt;/Location&gt;\n&lt;Location \"/bar\"&gt;\n  # Effective filter \"INCLUDES;DEFLATE\", replacing \"DEFLATE\"\n  AddOutputFilter INCLUDES;DEFLATE shtml\n&lt;/Location&gt;\n&lt;Location \"/bar/baz\"&gt;\n  # Effective filter \"BUFFER\", replacing \"INCLUDES;DEFLATE\"\n  AddOutputFilter BUFFER shtml\n&lt;/Location&gt;\n&lt;Location \"/bar/baz/buz\"&gt;\n  # No effective filter, replacing \"BUFFER\"\n  RemoveOutputFilter shtml\n&lt;/Location&gt;</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#removeoutputfilter\">RemoveOutputFilter</a></code></li> <li><code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"addtype\">AddType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps the given filename extensions onto the specified content type</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddType media-type extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">AddType</code> directive maps the given filename extensions onto the specified content type. <var>media-type</var> is the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media type</a> to use for filenames containing <var>extension</var>. This mapping is added to any already in force, overriding any mappings that already exist for the same <var>extension</var>.</p> <div class=\"note\"> It is recommended that new media types be added using the <code class=\"directive\">AddType</code> directive rather than changing the <code class=\"directive\"><a href=\"#typesconfig\">TypesConfig</a></code> file. </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">AddType image/gif .gif</pre> </div> <p>Or, to specify multiple file extensions in one directive:</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">AddType image/jpeg jpeg jpg jpe</pre> </div> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot. Filenames may have <a href=\"#multipleext\">multiple extensions</a> and the <var>extension</var> argument will be compared against each of them.</p> <p>A simmilar effect to <code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code>'s <code class=\"directive\"><a href=\"mod_negotiation#languagepriority\">LanguagePriority</a></code> can be achieved by qualifying a <var>media-type</var> with <code>qs</code>:</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">AddType application/rss+xml;qs=0.8 .xml</pre> </div> <p>This is useful in situations, <em>e.g.</em> when a client requesting <code>Accept: */*</code> can not actually processes the content returned by the server.</p> <p>This directive primarily configures the content types generated for static files served out of the filesystem. For resources other than static files, where the generator of the response typically specifies a Content-Type, this directive has no effect.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>If no handler is explicitly set for a request, the specified content type will also be used as the handler name. </p> <p>When explicit directives such as <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code> or <code class=\"directive\"><a href=\"#addhandler\">AddHandler</a></code> do not apply to the current request, the internal handler name normally set by those directives is instead set to the content type specified by this directive. </p> <p> This is a historical behavior that may be used by some third-party modules (such as mod_php) for taking responsibility for the matching request. </p> <p>Configurations that rely on such \"synthetic\" types should be avoided. Additionally, configurations that restrict access to <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code> or <code class=\"directive\"><a href=\"#addhandler\">AddHandler</a></code> should restrict access to this directive as well.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"core#forcetype\">ForceType</a></code></li> <li><code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"defaultlanguage\">DefaultLanguage Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Defines a default language-tag to be sent in the Content-Language header field for all resources in the current context that have not been assigned a language-tag by some other means.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DefaultLanguage language-tag</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">DefaultLanguage</code> directive tells Apache that all resources in the directive's scope (<em>e.g.</em>, all resources covered by the current <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> container) that don't have an explicit language extension (such as <code>.fr</code> or <code>.de</code> as configured by <code class=\"directive\"><a href=\"#addlanguage\">AddLanguage</a></code>) should be assigned a Content-Language of <var>language-tag</var>. This allows entire directory trees to be marked as containing Dutch content, for instance, without having to rename each file. Note that unlike using extensions to specify languages, <code class=\"directive\">DefaultLanguage</code> can only specify a single language.</p> <p>If no <code class=\"directive\">DefaultLanguage</code> directive is in force and a file does not have any language extensions as configured by <code class=\"directive\"><a href=\"#addlanguage\">AddLanguage</a></code>, then no Content-Language header field will be generated.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">DefaultLanguage en</pre> </div> <h3>See also</h3> <ul> <li><code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"modmimeusepathinfo\">ModMimeUsePathInfo Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Tells <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> to treat <code>path_info</code> components as part of the filename</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ModMimeUsePathInfo On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ModMimeUsePathInfo Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">ModMimeUsePathInfo</code> directive is used to combine the filename with the <code>path_info</code> URL component to apply <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code>'s directives to the request. The default value is <code>Off</code> - therefore, the <code>path_info</code> component is ignored.</p> <p>This directive is recommended when you have a virtual filesystem.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ModMimeUsePathInfo On</pre> </div> <p>If you have a request for <code>/index.php/foo.shtml</code> <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> will now treat the incoming request as <code>/index.php/foo.shtml</code> and directives like <code>AddOutputFilter INCLUDES .shtml</code> will add the <code>INCLUDES</code> filter to the request. If <code class=\"directive\">ModMimeUsePathInfo</code> is not set, the <code>INCLUDES</code> filter will not be added. This will work analogously for virtual paths, such as those defined by <code class=\"directive\">&lt;Location&gt;</code></p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"core#acceptpathinfo\">AcceptPathInfo</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"multiviewsmatch\">MultiviewsMatch Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The types of files that will be included when searching for a matching file with MultiViews</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MultiviewsMatch Any|NegotiatedOnly|Filters|Handlers [Handlers|Filters]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MultiviewsMatch NegotiatedOnly</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p><code class=\"directive\">MultiviewsMatch</code> permits three different behaviors for <a href=\"mod_negotiation\">mod_negotiation</a>'s Multiviews feature. Multiviews allows a request for a file, <em>e.g.</em> <code>index.html</code>, to match any negotiated extensions following the base request, <em>e.g.</em> <code>index.html.en</code>, <code>index.html.fr</code>, or <code>index.html.gz</code>.</p> <p>The <code>NegotiatedOnly</code> option provides that every extension following the base name must correlate to a recognized <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> extension for content negotiation, <em>e.g.</em> Charset, Content-Type, Language, or Encoding. This is the strictest implementation with the fewest unexpected side effects, and is the default behavior.</p> <p>To include extensions associated with Handlers and/or Filters, set the <code class=\"directive\">MultiviewsMatch</code> directive to either <code>Handlers</code>, <code>Filters</code>, or both option keywords. If all other factors are equal, the smallest file will be served, <em>e.g.</em> in deciding between <code>index.html.cgi</code> of 500 bytes and <code>index.html.pl</code> of 1000 bytes, the <code>.cgi</code> file would win in this example. Users of <code>.asis</code> files might prefer to use the Handler option, if <code>.asis</code> files are associated with the <code>asis-handler</code>.</p> <p>You may finally allow <code>Any</code> extensions to match, even if <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> doesn't recognize the extension. This can cause unpredictable results, such as serving .old or .bak files the webmaster never expected to be served.</p> <p>For example, the following configuration will allow handlers and filters to participate in Multviews, but will exclude unknown files:</p> <pre class=\"prettyprint lang-config\">MultiviewsMatch Handlers Filters</pre> <p><code class=\"directive\">MultiviewsMatch</code> is not allowed in a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"core#options\">Options</a></code></li> <li><code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"removecharset\">RemoveCharset Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes any character set associations for a set of file extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoveCharset extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">RemoveCharset</code> directive removes any character set associations for files with the given extensions. This allows <code>.htaccess</code> files in subdirectories to undo any associations inherited from parent directories or the server config files.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">RemoveCharset .html .shtml</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"removeencoding\">RemoveEncoding Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes any content encoding associations for a set of file extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoveEncoding extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">RemoveEncoding</code> directive removes any encoding associations for files with the given extensions. This allows <code>.htaccess</code> files in subdirectories to undo any associations inherited from parent directories or the server config files. An example of its use might be:</p> <div class=\"example\">\n<h3>/foo/.htaccess:</h3>\n<pre class=\"prettyprint lang-config\">AddEncoding x-gzip .gz\nAddType text/plain .asc\n&lt;Files \"*.gz.asc\"&gt;\n    RemoveEncoding .gz\n&lt;/Files&gt;</pre> </div> <p>This will cause <code>foo.gz</code> to be marked as being encoded with the gzip method, but <code>foo.gz.asc</code> as an unencoded plaintext file.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p><code class=\"directive\">RemoveEncoding</code> directives are processed <em>after</em> any <code class=\"directive\"><a href=\"#addencoding\">AddEncoding</a></code> directives, so it is possible they may undo the effects of the latter if both occur within the same directory configuration.</p> </div> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"removehandler\">RemoveHandler Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes any handler associations for a set of file extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoveHandler extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">RemoveHandler</code> directive removes any handler associations for files with the given extensions. This allows <code>.htaccess</code> files in subdirectories to undo any associations inherited from parent directories or the server config files. An example of its use might be:</p> <div class=\"example\">\n<h3>/foo/.htaccess:</h3>\n<pre class=\"prettyprint lang-config\">AddHandler server-parsed .html</pre> </div> <div class=\"example\">\n<h3>/foo/bar/.htaccess:</h3>\n<pre class=\"prettyprint lang-config\">RemoveHandler .html</pre> </div> <p>This has the effect of returning <code>.html</code> files in the <code>/foo/bar</code> directory to being treated as normal files, rather than as candidates for parsing (see the <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> module).</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"removeinputfilter\">RemoveInputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes any input filter associations for a set of file extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoveInputFilter extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">RemoveInputFilter</code> directive removes any input <a href=\"../filter\">filter</a> associations for files with the given extensions. This allows <code>.htaccess</code> files in subdirectories to undo any associations inherited from parent directories or the server config files.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#addinputfilter\">AddInputFilter</a></code></li> <li><code class=\"directive\"><a href=\"core#setinputfilter\">SetInputFilter</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"removelanguage\">RemoveLanguage Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes any language associations for a set of file extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoveLanguage extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">RemoveLanguage</code> directive removes any language associations for files with the given extensions. This allows <code>.htaccess</code> files in subdirectories to undo any associations inherited from parent directories or the server config files.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"removeoutputfilter\">RemoveOutputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes any output filter associations for a set of file extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoveOutputFilter extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">RemoveOutputFilter</code> directive removes any output <a href=\"../filter\">filter</a> associations for files with the given extensions. This allows <code>.htaccess</code> files in subdirectories to undo any associations inherited from parent directories or the server config files.</p> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">RemoveOutputFilter shtml</pre> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#addoutputfilter\">AddOutputFilter</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"removetype\">RemoveType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes any content type associations for a set of file extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoveType extension [extension] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">RemoveType</code> directive removes any <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media type</a> associations for files with the given extensions. This allows <code>.htaccess</code> files in subdirectories to undo any associations inherited from parent directories or the server config files. An example of its use might be:</p> <div class=\"example\">\n<h3>/foo/.htaccess:</h3>\n<pre class=\"prettyprint lang-config\">RemoveType .cgi</pre> </div> <p>This will remove any special handling of <code>.cgi</code> files in the <code>/foo/</code> directory and any beneath it, causing responses containing those files to omit the HTTP Content-Type header field.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p><code class=\"directive\">RemoveType</code> directives are processed <em>after</em> any <code class=\"directive\"><a href=\"#addtype\">AddType</a></code> directives, so it is possible they may undo the effects of the latter if both occur within the same directory configuration.</p> </div> <p>The <var>extension</var> argument is case-insensitive and can be specified with or without a leading dot.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"typesconfig\">TypesConfig Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The location of the <code>mime.types</code> file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>TypesConfig file-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>TypesConfig conf/mime.types</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime</td>\n</tr> </table> <p>The <code class=\"directive\">TypesConfig</code> directive sets the location of the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media types</a> configuration file. <var>File-path</var> is relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>. This file sets the default list of mappings from filename extensions to content types. Most administrators use the <code>mime.types</code> file provided by their OS, which associates common filename extensions with the official list of IANA registered media types maintained at <a href=\"http://www.iana.org/assignments/media-types/index.html\">http://www.iana.org/assignments/media-types/index.html</a> as well as a large number of unofficial types. This simplifies the <code>httpd.conf</code> file by providing the majority of media-type definitions, and may be overridden by <code class=\"directive\"><a href=\"#addtype\">AddType</a></code> directives as needed. You should not edit the <code>mime.types</code> file, because it may be replaced when you upgrade your server.</p> <p>The file contains lines in the format of the arguments to an <code class=\"directive\"><a href=\"#addtype\">AddType</a></code> directive:</p> <div class=\"example\"><pre>media-type [extension] ...</pre></div> <p>The case of the extension does not matter. Blank lines, and lines beginning with a hash character (<code>#</code>) are ignored. Empty lines are there for completeness (of the mime.types file). Apache httpd can still determine these types with <code class=\"module\"><a href=\"mod_mime_magic\">mod_mime_magic</a></code>. </p> <div class=\"note\"> Please do <strong>not</strong> send requests to the Apache HTTP Server Project to add any new entries in the distributed <code>mime.types</code> file unless (1) they are already registered with IANA, and (2) they use widely accepted, non-conflicting filename extensions across platforms. <code>category/x-subtype</code> requests will be automatically rejected, as will any new two-letter extensions as they will likely conflict later with the already crowded language and character set namespace. </div> <h3>See also</h3> <ul> <li><code class=\"module\"><a href=\"mod_mime_magic\">mod_mime_magic</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_mime.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_mime.html</a>\n  </p>\n</div>\n","mod/mod_alias":"<h1>Apache Module mod_alias</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides for mapping different parts of the host filesystem in the document tree and for URL redirection</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>alias_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_alias.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The directives contained in this module allow for manipulation and control of URLs as requests arrive at the server. The <code class=\"directive\"><a href=\"#alias\">Alias</a></code> and <code class=\"directive\"><a href=\"#scriptalias\">ScriptAlias</a></code> directives are used to map between URLs and filesystem paths. This allows for content which is not directly under the <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code> served as part of the web document tree. The <code class=\"directive\"><a href=\"#scriptalias\">ScriptAlias</a></code> directive has the additional effect of marking the target directory as containing only CGI scripts.</p> <p>The <code class=\"directive\"><a href=\"#redirect\">Redirect</a></code> directives are used to instruct clients to make a new request with a different URL. They are often used when a resource has moved to a new location.</p> <p>When the <code class=\"directive\"><a href=\"#alias\">Alias</a></code>, <code class=\"directive\"><a href=\"#scriptalias\">ScriptAlias</a></code> and <code class=\"directive\"><a href=\"#redirect\">Redirect</a></code> directives are used within a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section, <a href=\"../expr\">expression syntax</a> can be used to manipulate the destination path or URL. </p> <p><code class=\"module\"><a href=\"mod_alias\">mod_alias</a></code> is designed to handle simple URL manipulation tasks. For more complicated tasks such as manipulating the query string, use the tools provided by <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>.</p>     <h2 id=\"order\">Order of Processing</h2> <p>Aliases and Redirects occurring in different contexts are processed like other directives according to standard <a href=\"../sections#mergin\">merging rules</a>. But when multiple Aliases or Redirects occur in the same context (for example, in the same <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> section) they are processed in a particular order.</p> <p>First, all Redirects are processed before Aliases are processed, and therefore a request that matches a <code class=\"directive\"><a href=\"#redirect\">Redirect</a></code> or <code class=\"directive\"><a href=\"#redirectmatch\">RedirectMatch</a></code> will never have Aliases applied. Second, the Aliases and Redirects are processed in the order they appear in the configuration files, with the first match taking precedence.</p> <p>For this reason, when two or more of these directives apply to the same sub-path, you must list the most specific path first in order for all the directives to have an effect. For example, the following configuration will work as expected:</p> <pre class=\"prettyprint lang-config\">Alias \"/foo/bar\" \"/baz\"\nAlias \"/foo\" \"/gaq\"</pre> <p>But if the above two directives were reversed in order, the <code>/foo</code> <code class=\"directive\"><a href=\"#alias\">Alias</a></code> would always match before the <code>/foo/bar</code> <code class=\"directive\"><a href=\"#alias\">Alias</a></code>, so the latter directive would be ignored.</p> <p>When the <code class=\"directive\"><a href=\"#alias\">Alias</a></code>, <code class=\"directive\"><a href=\"#scriptalias\">ScriptAlias</a></code> and <code class=\"directive\"><a href=\"#redirect\">Redirect</a></code> directives are used within a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section, these directives will take precedence over any globally defined <code class=\"directive\"><a href=\"#alias\">Alias</a></code>, <code class=\"directive\"><a href=\"#scriptalias\">ScriptAlias</a></code> and <code class=\"directive\"><a href=\"#redirect\">Redirect</a></code> directives.</p>   <div class=\"directive-section\">\n<h2 id=\"alias\">Alias Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps URLs to filesystem locations</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Alias [URL-path] file-path|directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>The <code class=\"directive\">Alias</code> directive allows documents to be stored in the local filesystem other than under the <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code>. URLs with a (%-decoded) path beginning with <var>URL-path</var> will be mapped to local files beginning with <var>directory-path</var>. The <var>URL-path</var> is case-sensitive, even on case-insensitive file systems.</p> <pre class=\"prettyprint lang-config\">Alias \"/image\" \"/ftp/pub/image\"</pre> <p>A request for <code>http://example.com/image/foo.gif</code> would cause the server to return the file <code>/ftp/pub/image/foo.gif</code>. Only complete path segments are matched, so the above alias would not match a request for <code>http://example.com/imagefoo.gif</code>. For more complex matching using regular expressions, see the <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> directive.</p> <p>Note that if you include a trailing / on the <var>URL-path</var> then the server will require a trailing / in order to expand the alias. That is, if you use</p> <pre class=\"prettyprint lang-config\">Alias \"/icons/\" \"/usr/local/apache/icons/\"</pre> <p>then the URL <code>/icons</code> will not be aliased, as it lacks that trailing /. Likewise, if you omit the slash on the <var>URL-path</var> then you must also omit it from the <var>file-path</var>.</p> <p>Note that you may need to specify additional <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> sections which cover the <em>destination</em> of aliases. Aliasing occurs before <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> sections are checked, so only the destination of aliases are affected. (Note however <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> sections are run through once before aliases are performed, so they will apply.)</p> <p>In particular, if you are creating an <code>Alias</code> to a directory outside of your <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code>, you may need to explicitly permit access to the target directory.</p> <pre class=\"prettyprint lang-config\">Alias \"/image\" \"/ftp/pub/image\"\n&lt;Directory \"/ftp/pub/image\"&gt;\n    Require all granted\n&lt;/Directory&gt;</pre> <p>Any number slashes in the <var>URL-path</var> parameter matches any number of slashes in the requested URL-path.</p> <p>If the <code class=\"directive\">Alias</code> directive is used within a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section the URL-path is omitted, and the file-path is interpreted using <a href=\"../expr\">expression syntax</a>.<br> This syntax is available in Apache 2.4.19 and later.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/image\"&gt;\n    Alias \"/ftp/pub/image\"\n&lt;/Location&gt;\n&lt;LocationMatch \"/error/(?&lt;NUMBER&gt;[0-9]+)\"&gt;\n    Alias \"/usr/local/apache/errors/%{env:MATCH_NUMBER}.html\"\n&lt;/LocationMatch&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"aliasmatch\">AliasMatch Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps URLs to filesystem locations using regular expressions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AliasMatch regex file-path|directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>This directive is equivalent to <code class=\"directive\"><a href=\"#alias\">Alias</a></code>, but makes use of <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expressions</a>, instead of simple prefix matching. The supplied regular expression is matched against the URL-path, and if it matches, the server will substitute any parenthesized matches into the given string and use it as a filename. For example, to activate the <code>/icons</code> directory, one might use:</p> <pre class=\"prettyprint lang-config\">AliasMatch \"^/icons(/|$)(.*)\" \"/usr/local/apache/icons$1$2\"</pre> <p>The full range of <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> power is available. For example, it is possible to construct an alias with case-insensitive matching of the URL-path:</p> <pre class=\"prettyprint lang-config\">AliasMatch \"(?i)^/image(.*)\" \"/ftp/pub/image$1\"</pre> <p>One subtle difference between <code class=\"directive\"><a href=\"#alias\">Alias</a></code> and <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> is that <code class=\"directive\"><a href=\"#alias\">Alias</a></code> will automatically copy any additional part of the URI, past the part that matched, onto the end of the file path on the right side, while <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> will not. This means that in almost all cases, you will want the regular expression to match the entire request URI from beginning to end, and to use substitution on the right side.</p> <p>In other words, just changing <code class=\"directive\"><a href=\"#alias\">Alias</a></code> to <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> will not have the same effect. At a minimum, you need to add <code>^</code> to the beginning of the regular expression and add <code>(.*)$</code> to the end, and add <code>$1</code> to the end of the replacement.</p> <p>For example, suppose you want to replace this with AliasMatch:</p> <pre class=\"prettyprint lang-config\">Alias \"/image/\" \"/ftp/pub/image/\"</pre> <p>This is NOT equivalent - don't do this! This will send all requests that have /image/ anywhere in them to /ftp/pub/image/:</p> <pre class=\"prettyprint lang-config\">AliasMatch \"/image/\" \"/ftp/pub/image/\"</pre> <p>This is what you need to get the same effect:</p> <pre class=\"prettyprint lang-config\">AliasMatch \"^/image/(.*)$\" \"/ftp/pub/image/$1\"</pre> <p>Of course, there's no point in using <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> where <code class=\"directive\"><a href=\"#alias\">Alias</a></code> would work. <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> lets you do more complicated things. For example, you could serve different kinds of files from different directories:</p> <pre class=\"prettyprint lang-config\">AliasMatch \"^/image/(.*)\\.jpg$\" \"/files/jpg.images/$1.jpg\"\nAliasMatch \"^/image/(.*)\\.gif$\" \"/files/gif.images/$1.gif\"</pre> <p>Multiple leading slashes in the requested URL are discarded by the server before directives from this module compares against the requested URL-path. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"redirect\">Redirect Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sends an external redirect asking the client to fetch a different URL</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Redirect [status] [URL-path] URL</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>The Redirect directive maps an old URL into a new one by asking the client to refetch the resource at the new location.</p> <p>The old <em>URL-path</em> is a case-sensitive (%-decoded) path beginning with a slash. A relative path is not allowed.</p> <p>The new <em>URL</em> may be either an absolute URL beginning with a scheme and hostname, or a URL-path beginning with a slash. In this latter case the scheme and hostname of the current server will be added.</p> <p>Then any request beginning with <em>URL-Path</em> will return a redirect request to the client at the location of the target <em>URL</em>. Additional path information beyond the matched <em>URL-Path</em> will be appended to the target URL.</p> <pre class=\"prettyprint lang-config\"># Redirect to a URL on a different host\nRedirect \"/service\" \"http://foo2.example.com/service\"\n\n# Redirect to a URL on the same host\nRedirect \"/one\" \"/two\"</pre> <p>If the client requests <code>http://example.com/service/foo.txt</code>, it will be told to access <code>http://foo2.example.com/service/foo.txt</code> instead. This includes requests with <code>GET</code> parameters, such as <code>http://example.com/service/foo.pl?q=23&amp;a=42</code>, it will be redirected to <code>http://foo2.example.com/service/foo.pl?q=23&amp;a=42</code>. Note that <code>POST</code>s will be discarded.<br> Only complete path segments are matched, so the above example would not match a request for <code>http://example.com/servicefoo.txt</code>. For more complex matching using the <a href=\"../expr\">expression syntax</a>, omit the URL-path argument as described below. Alternatively, for matching using regular expressions, see the <code class=\"directive\"><a href=\"#redirectmatch\">RedirectMatch</a></code> directive.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Redirect directives take precedence over Alias and ScriptAlias directives, irrespective of their ordering in the configuration file. Redirect directives inside a Location take precedence over Redirect and Alias directives with an URL-path.</p>\n</div> <p>If no <var>status</var> argument is given, the redirect will be \"temporary\" (HTTP status 302). This indicates to the client that the resource has moved temporarily. The <var>status</var> argument can be used to return other HTTP status codes:</p> <dl> <dt>permanent</dt> <dd>Returns a permanent redirect status (301) indicating that the resource has moved permanently.</dd> <dt>temp</dt> <dd>Returns a temporary redirect status (302). This is the default.</dd> <dt>seeother</dt> <dd>Returns a \"See Other\" status (303) indicating that the resource has been replaced.</dd> <dt>gone</dt> <dd>Returns a \"Gone\" status (410) indicating that the resource has been permanently removed. When this status is used the <var>URL</var> argument should be omitted.</dd> </dl> <p>Other status codes can be returned by giving the numeric status code as the value of <var>status</var>. If the status is between 300 and 399, the <var>URL</var> argument must be present. If the status is <em>not</em> between 300 and 399, the <var>URL</var> argument must be omitted. The status must be a valid HTTP status code, known to the Apache HTTP Server (see the function <code>send_error_response</code> in http_protocol.c).</p> <pre class=\"prettyprint lang-config\">Redirect permanent \"/one\" \"http://example.com/two\"\nRedirect 303 \"/three\" \"http://example.com/other\"</pre> <p>If the <code class=\"directive\">Redirect</code> directive is used within a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section with the URL-path omitted, then the URL parameter will be interpreted using <a href=\"../expr\">expression syntax</a>.<br> This syntax is available in Apache 2.4.19 and later.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/one\"&gt;\n    Redirect permanent \"http://example.com/two\"\n&lt;/Location&gt;\n&lt;Location \"/three\"&gt;\n    Redirect 303 \"http://example.com/other\"\n&lt;/Location&gt;\n&lt;LocationMatch \"/error/(?&lt;NUMBER&gt;[0-9]+)\"&gt;\n    Redirect permanent \"http://example.com/errors/%{env:MATCH_NUMBER}.html\"\n&lt;/LocationMatch&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"redirectmatch\">RedirectMatch Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sends an external redirect based on a regular expression match of the current URL</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RedirectMatch [status] regex URL</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>This directive is equivalent to <code class=\"directive\"><a href=\"#redirect\">Redirect</a></code>, but makes use of <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expressions</a>, instead of simple prefix matching. The supplied regular expression is matched against the URL-path, and if it matches, the server will substitute any parenthesized matches into the given string and use it as a filename. For example, to redirect all GIF files to like-named JPEG files on another server, one might use:</p> <pre class=\"prettyprint lang-config\">RedirectMatch \"(.*)\\.gif$\" \"http://other.example.com$1.jpg\"</pre> <p>The considerations related to the difference between <code class=\"directive\"><a href=\"#alias\">Alias</a></code> and <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> also apply to the difference between <code class=\"directive\"><a href=\"#redirect\">Redirect</a></code> and <code class=\"directive\"><a href=\"#redirectmatch\">RedirectMatch</a></code>. See <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> for details.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"redirectpermanent\">RedirectPermanent Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sends an external permanent redirect asking the client to fetch a different URL</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RedirectPermanent URL-path URL</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>This directive makes the client know that the Redirect is permanent (status 301). Exactly equivalent to <code>Redirect permanent</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"redirecttemp\">RedirectTemp Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sends an external temporary redirect asking the client to fetch a different URL</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RedirectTemp URL-path URL</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>This directive makes the client know that the Redirect is only temporary (status 302). Exactly equivalent to <code>Redirect temp</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"scriptalias\">ScriptAlias Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps a URL to a filesystem location and designates the target as a CGI script</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScriptAlias [URL-path] file-path|directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>The <code class=\"directive\">ScriptAlias</code> directive has the same behavior as the <code class=\"directive\"><a href=\"#alias\">Alias</a></code> directive, except that in addition it marks the target directory as containing CGI scripts that will be processed by <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>'s cgi-script handler. URLs with a case-sensitive (%-decoded) path beginning with <var>URL-path</var> will be mapped to scripts beginning with the second argument, which is a full pathname in the local filesystem.</p> <pre class=\"prettyprint lang-config\">ScriptAlias \"/cgi-bin/\" \"/web/cgi-bin/\"</pre> <p>A request for <code>http://example.com/cgi-bin/foo</code> would cause the server to run the script <code>/web/cgi-bin/foo</code>. This configuration is essentially equivalent to:</p> <pre class=\"prettyprint lang-config\">Alias \"/cgi-bin/\" \"/web/cgi-bin/\"\n&lt;Location \"/cgi-bin\"&gt;\n    SetHandler cgi-script\n    Options +ExecCGI\n&lt;/Location&gt;</pre> <p><code class=\"directive\">ScriptAlias</code> can also be used in conjunction with a script or handler you have. For example:</p> <pre class=\"prettyprint lang-config\">ScriptAlias \"/cgi-bin/\" \"/web/cgi-handler.pl\"</pre> <p>In this scenario all files requested in <code>/cgi-bin/</code> will be handled by the file you have configured, this allows you to use your own custom handler. You may want to use this as a wrapper for CGI so that you can add content, or some other bespoke action.</p> <div class=\"warning\">It is safer to avoid placing CGI scripts under the <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code> in order to avoid accidentally revealing their source code if the configuration is ever changed. The <code class=\"directive\">ScriptAlias</code> makes this easy by mapping a URL and designating CGI scripts at the same time. If you do choose to place your CGI scripts in a directory already accessible from the web, do not use <code class=\"directive\">ScriptAlias</code>. Instead, use <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code>, and <code class=\"directive\"><a href=\"core#options\">Options</a></code> as in: <pre class=\"prettyprint lang-config\">&lt;Directory \"/usr/local/apache2/htdocs/cgi-bin\"&gt;\n    SetHandler cgi-script\n    Options ExecCGI\n&lt;/Directory&gt;</pre> This is necessary since multiple <var>URL-paths</var> can map to the same filesystem location, potentially bypassing the <code class=\"directive\">ScriptAlias</code> and revealing the source code of the CGI scripts if they are not restricted by a <code class=\"directive\"><a href=\"core#directory\">Directory</a></code> section.</div> <p>If the <code class=\"directive\">ScriptAlias</code> directive is used within a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section with the URL-path omitted, then the URL parameter will be interpreted using <a href=\"../expr\">expression syntax</a>.<br> This syntax is available in Apache 2.4.19 and later.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/cgi-bin\"&gt;\n    ScriptAlias \"/web/cgi-bin/\"\n&lt;/Location&gt;\n&lt;LocationMatch \"/cgi-bin/errors/(?&lt;NUMBER&gt;[0-9]+)\"&gt;\n    ScriptAlias \"/web/cgi-bin/errors/%{env:MATCH_NUMBER}.cgi\"\n&lt;/LocationMatch&gt;</pre> <h3>See also</h3> <ul> <li><a href=\"../howto/cgi\">CGI Tutorial</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"scriptaliasmatch\">ScriptAliasMatch Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps a URL to a filesystem location using a regular expression and designates the target as a CGI script</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScriptAliasMatch regex file-path|directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_alias</td>\n</tr> </table> <p>This directive is equivalent to <code class=\"directive\"><a href=\"#scriptalias\">ScriptAlias</a></code>, but makes use of <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expressions</a>, instead of simple prefix matching. The supplied regular expression is matched against the URL-path, and if it matches, the server will substitute any parenthesized matches into the given string and use it as a filename. For example, to activate the standard <code>/cgi-bin</code>, one might use:</p> <pre class=\"prettyprint lang-config\">ScriptAliasMatch \"^/cgi-bin(.*)\" \"/usr/local/apache/cgi-bin$1\"</pre> <p>As for AliasMatch, the full range of <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#rexex\" title=\"see glossary\">regular expression</a> power is available. For example, it is possible to construct an alias with case-insensitive matching of the URL-path:</p> <pre class=\"prettyprint lang-config\">ScriptAliasMatch \"(?i)^/cgi-bin(.*)\" \"/usr/local/apache/cgi-bin$1\"</pre> <p>The considerations related to the difference between <code class=\"directive\"><a href=\"#alias\">Alias</a></code> and <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> also apply to the difference between <code class=\"directive\"><a href=\"#scriptalias\">ScriptAlias</a></code> and <code class=\"directive\"><a href=\"#scriptaliasmatch\">ScriptAliasMatch</a></code>. See <code class=\"directive\"><a href=\"#aliasmatch\">AliasMatch</a></code> for details.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_alias.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_alias.html</a>\n  </p>\n</div>\n","mod/mod_auth_basic":"<h1>Apache Module mod_auth_basic</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Basic HTTP authentication</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>auth_basic_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_auth_basic.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module allows the use of HTTP Basic Authentication to restrict access by looking up users in the given providers. HTTP Digest Authentication is provided by <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>. This module should usually be combined with at least one authentication module such as <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> and one authorization module such as <code class=\"module\"><a href=\"mod_authz_user\">mod_authz_user</a></code>.</p>    <div class=\"directive-section\">\n<h2 id=\"authbasicauthoritative\">AuthBasicAuthoritative Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets whether authorization and authentication are passed to lower level modules</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthBasicAuthoritative On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthBasicAuthoritative On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_basic</td>\n</tr> </table> <p>Normally, each authorization module listed in <code class=\"directive\"><a href=\"#authbasicprovider\">AuthBasicProvider</a></code> will attempt to verify the user, and if the user is not found in any provider, access will be denied. Setting the <code class=\"directive\">AuthBasicAuthoritative</code> directive explicitly to <code>Off</code> allows for both authentication and authorization to be passed on to other non-provider-based modules if there is <strong>no userID</strong> or <strong>rule</strong> matching the supplied userID. This should only be necessary when combining <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> with third-party modules that are not configured with the <code class=\"directive\"><a href=\"#authbasicprovider\">AuthBasicProvider</a></code> directive. When using such modules, the order of processing is determined in the modules' source code and is not configurable.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authbasicfake\">AuthBasicFake Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Fake basic authentication using the given expressions for username and password</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthBasicFake off|username [password]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_basic</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Apache HTTP Server 2.4.5 and later</td>\n</tr> </table> <p>The username and password specified are combined into an Authorization header, which is passed to the server or service behind the webserver. Both the username and password fields are interpreted using the <a href=\"../expr\">expression parser</a>, which allows both the username and password to be set based on request parameters.</p> <p>If the password is not specified, the default value \"password\" will be used. To disable fake basic authentication for an URL space, specify \"AuthBasicFake off\".</p> <p>In this example, we pass a fixed username and password to a backend server.</p> <div class=\"example\">\n<h3>Fixed Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/demo\"&gt;\n    AuthBasicFake demo demopass\n&lt;/Location&gt;</pre> </div> <p>In this example, we pass the email address extracted from a client certificate, extending the functionality of the FakeBasicAuth option within the <code class=\"directive\"><a href=\"mod_ssl#ssloptions\">SSLOptions</a></code> directive. Like the FakeBasicAuth option, the password is set to the fixed string \"password\".</p> <div class=\"example\">\n<h3>Certificate Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/secure\"&gt;\n    AuthBasicFake \"%{SSL_CLIENT_S_DN_Email}\"\n&lt;/Location&gt;</pre> </div> <p>Extending the above example, we generate a password by hashing the email address with a fixed passphrase, and passing the hash to the backend server. This can be used to gate into legacy systems that do not support client certificates.</p> <div class=\"example\">\n<h3>Password Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/secure\"&gt;\n    AuthBasicFake \"%{SSL_CLIENT_S_DN_Email}\" \"%{sha1:passphrase-%{SSL_CLIENT_S_DN_Email}}\"\n&lt;/Location&gt;</pre> </div> <div class=\"example\">\n<h3>Exclusion Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/public\"&gt;\n    AuthBasicFake off\n&lt;/Location&gt;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"authbasicprovider\">AuthBasicProvider Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the authentication provider(s) for this location</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthBasicProvider provider-name [provider-name] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthBasicProvider file</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_basic</td>\n</tr> </table> <p>The <code class=\"directive\">AuthBasicProvider</code> directive sets which provider is used to authenticate the users for this location. The default <code>file</code> provider is implemented by the <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> module. Make sure that the chosen provider module is present in the server.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/secure\"&gt;\n    AuthType basic\n    AuthName \"private area\"\n    AuthBasicProvider  dbm\n    AuthDBMType        SDBM\n    AuthDBMUserFile    \"/www/etc/dbmpasswd\"\n    Require            valid-user\n&lt;/Location&gt;</pre> </div> <p> Providers are queried in order until a provider finds a match for the requested username, at which point this sole provider will attempt to check the password. A failure to verify the password does not result in control being passed on to subsequent providers.</p> <p>Providers are implemented by <code class=\"module\"><a href=\"mod_authn_dbm\">mod_authn_dbm</a></code>, <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code>, <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code>, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> and <code class=\"module\"><a href=\"mod_authn_socache\">mod_authn_socache</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authbasicusedigestalgorithm\">AuthBasicUseDigestAlgorithm Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Check passwords against the authentication providers as if Digest Authentication was in force instead of Basic Authentication. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthBasicUseDigestAlgorithm MD5|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthBasicUseDigestAlgorithm Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_basic</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Apache HTTP Server 2.4.7 and later</td>\n</tr> </table> <p>Normally, when using Basic Authentication, the providers listed in <code class=\"directive\"><a href=\"#authbasicprovider\">AuthBasicProvider</a></code> attempt to verify a user by checking their data stores for a matching username and associated password. The stored passwords are usually encrypted, but not necessarily so; each provider may choose its own storage scheme for passwords.</p> <p>When using <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> and Digest Authentication, providers perform a similar check to find a matching username in their data stores. However, unlike in the Basic Authentication case, the value associated with each stored username must be an encrypted string composed from the username, realm name, and password. (See <a href=\"http://tools.ietf.org/html/rfc2617#section-3.2.2.2\"> RFC 2617, Section 3.2.2.2</a> for more details on the format used for this encrypted string.)</p> <p>As a consequence of the difference in the stored values between Basic and Digest Authentication, converting from Digest Authentication to Basic Authentication generally requires that all users be assigned new passwords, as their existing passwords cannot be recovered from the password storage scheme imposed on those providers which support Digest Authentication.</p> <p>Setting the <code class=\"directive\"><a href=\"#authbasicusedigestalgorithm\">AuthBasicUseDigestAlgorithm</a></code> directive to <code>MD5</code> will cause the user's Basic Authentication password to be checked using the same encrypted format as for Digest Authentication. First a string composed from the username, realm name, and password is hashed with MD5; then the username and this encrypted string are passed to the providers listed in <code class=\"directive\"><a href=\"#authbasicprovider\">AuthBasicProvider</a></code> as if <code class=\"directive\"><a href=\"mod_authn_core#authtype\">AuthType</a></code> was set to <code>Digest</code> and Digest Authentication was in force. </p> <p>Through the use of <code class=\"directive\"><a href=\"#authbasicusedigestalgorithm\">AuthBasicUseDigestAlgorithm</a></code> a site may switch from Digest to Basic Authentication without requiring users to be assigned new passwords.</p> <div class=\"note\"> The inverse process of switching from Basic to Digest Authentication without assigning new passwords is generally not possible. Only if the Basic Authentication passwords have been stored in plain text or with a reversable encryption scheme will it be possible to recover them and generate a new data store following the Digest Authentication password storage scheme. </div> <div class=\"note\"> Only providers which support Digest Authentication will be able to authenticate users when <code class=\"directive\"><a href=\"#authbasicusedigestalgorithm\">AuthBasicUseDigestAlgorithm</a></code> is set to <code>MD5</code>. Use of other providers will result in an error response and the client will be denied access. </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_auth_basic.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_auth_basic.html</a>\n  </p>\n</div>\n","mod/mod_auth_digest":"<h1>Apache Module mod_auth_digest</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>User authentication using MD5 Digest Authentication</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>auth_digest_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_auth_digest.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module implements HTTP Digest Authentication (<a href=\"http://www.faqs.org/rfcs/rfc2617.html\">RFC2617</a>), and provides an alternative to <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> where the password is not transmitted as cleartext. However, this does <strong>not</strong> lead to a significant security advantage over basic authentication. On the other hand, the password storage on the server is much less secure with digest authentication than with basic authentication. Therefore, using basic auth and encrypting the whole connection using <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is a much better alternative.</p>     <h2 id=\"using\">Using Digest Authentication</h2> <p>To use MD5 Digest authentication, configure the location to be protected as shown in the below example:</p> <div class=\"example\">\n<h3>Example:</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/private/\"&gt;\n    AuthType Digest\n    AuthName \"private area\"\n    AuthDigestDomain \"/private/\" \"http://mirror.my.dom/private2/\"\n    \n    AuthDigestProvider file\n    AuthUserFile \"/web/auth/.digest_pw\"\n    Require valid-user\n&lt;/Location&gt;</pre> </div> <p><code class=\"directive\"><a href=\"#authdigestdomain\">AuthDigestDomain</a></code> should list the locations that will be protected by this configuration.</p> <p>The pasword file referenced in the <code class=\"directive\"><a href=\"#authuserfile\">AuthUserFile</a></code> directive may be created and managed using the <code class=\"program\"><a href=\"../programs/htdigest\">htdigest</a></code> tool.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Digest authentication was intended to be more secure than basic authentication, but no longer fulfills that design goal. A man-in-the-middle attacker can trivially force the browser to downgrade to basic authentication. And even a passive eavesdropper can brute-force the password using today's graphics hardware, because the hashing algorithm used by digest authentication is too fast. Another problem is that the storage of the passwords on the server is insecure. The contents of a stolen htdigest file can be used directly for digest authentication. Therefore using <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> to encrypt the whole connection is strongly recommended.</p> <p><code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code> only works properly on platforms where APR supports shared memory.</p> </div>   <div class=\"directive-section\">\n<h2 id=\"authdigestalgorithm\">AuthDigestAlgorithm Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Selects the algorithm used to calculate the challenge and response hashes in digest authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDigestAlgorithm MD5|MD5-sess</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthDigestAlgorithm MD5</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_digest</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDigestAlgorithm</code> directive selects the algorithm used to calculate the challenge and response hashes.</p> <div class=\"note\"> <code>MD5-sess</code> is not correctly implemented yet. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"authdigestdomain\">AuthDigestDomain Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>URIs that are in the same protection space for digest authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDigestDomain URI [URI] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_digest</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDigestDomain</code> directive allows you to specify one or more URIs which are in the same protection space (<em>i.e.</em> use the same realm and username/password info). The specified URIs are prefixes; the client will assume that all URIs \"below\" these are also protected by the same username/password. The URIs may be either absolute URIs (<em>i.e.</em> including a scheme, host, port, etc.) or relative URIs.</p> <p>This directive <em>should</em> always be specified and contain at least the (set of) root URI(s) for this space. Omitting to do so will cause the client to send the Authorization header for <em>every request</em> sent to this server.</p> <p>The URIs specified can also point to different servers, in which case clients (which understand this) will then share username/password info across multiple servers without prompting the user each time. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"authdigestnoncelifetime\">AuthDigestNonceLifetime Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>How long the server nonce is valid</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDigestNonceLifetime seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthDigestNonceLifetime 300</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_digest</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDigestNonceLifetime</code> directive controls how long the server nonce is valid. When the client contacts the server using an expired nonce the server will send back a 401 with <code>stale=true</code>. If <var>seconds</var> is greater than 0 then it specifies the amount of time for which the nonce is valid; this should probably never be set to less than 10 seconds. If <var>seconds</var> is less than 0 then the nonce never expires. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"authdigestprovider\">AuthDigestProvider Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the authentication provider(s) for this location</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDigestProvider provider-name [provider-name] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthDigestProvider file</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_digest</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDigestProvider</code> directive sets which provider is used to authenticate the users for this location. The default <code>file</code> provider is implemented by the <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> module. Make sure that the chosen provider module is present in the server.</p> <p>See <code class=\"module\"><a href=\"mod_authn_dbm\">mod_authn_dbm</a></code>, <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code>, <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code> and <code class=\"module\"><a href=\"mod_authn_socache\">mod_authn_socache</a></code> for providers.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authdigestqop\">AuthDigestQop Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines the quality-of-protection to use in digest authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDigestQop none|auth|auth-int [auth|auth-int]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthDigestQop auth</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_digest</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDigestQop</code> directive determines the <dfn>quality-of-protection</dfn> to use. <code>auth</code> will only do authentication (username/password); <code>auth-int</code> is authentication plus integrity checking (an MD5 hash of the entity is also computed and checked); <code>none</code> will cause the module to use the old RFC-2069 digest algorithm (which does not include integrity checking). Both <code>auth</code> and <code>auth-int</code> may be specified, in which the case the browser will choose which of these to use. <code>none</code> should only be used if the browser for some reason does not like the challenge it receives otherwise.</p> <div class=\"note\"> <code>auth-int</code> is not implemented yet. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"authdigestshmemsize\">AuthDigestShmemSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The amount of shared memory to allocate for keeping track of clients</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDigestShmemSize size</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthDigestShmemSize 1000</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_digest</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDigestShmemSize</code> directive defines the amount of shared memory, that will be allocated at the server startup for keeping track of clients. Note that the shared memory segment cannot be set less than the space that is necessary for tracking at least <em>one</em> client. This value is dependent on your system. If you want to find out the exact value, you may simply set <code class=\"directive\">AuthDigestShmemSize</code> to the value of <code>0</code> and read the error message after trying to start the server.</p> <p>The <var>size</var> is normally expressed in Bytes, but you may follow the number with a <code>K</code> or an <code>M</code> to express your value as KBytes or MBytes. For example, the following directives are all equivalent:</p> <pre class=\"prettyprint lang-config\">AuthDigestShmemSize 1048576\nAuthDigestShmemSize 1024K\nAuthDigestShmemSize 1M</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_auth_digest.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_auth_digest.html</a>\n  </p>\n</div>\n","mod/mod_authn_anon":"<h1>Apache Module mod_authn_anon</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Allows \"anonymous\" user access to authenticated areas</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authn_anon_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authn_anon.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authentication front-ends such as <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> to authenticate users similar to anonymous-ftp sites, <em>i.e.</em> have a 'magic' user id 'anonymous' and the email address as a password. These email addresses can be logged.</p> <p>Combined with other (database) access control methods, this allows for effective user tracking and customization according to a user profile while still keeping the site open for 'unregistered' users. One advantage of using Auth-based user tracking is that, unlike magic-cookies and funny URL pre/postfixes, it is completely browser independent and it allows users to share URLs.</p> <p>When using <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code>, this module is invoked via the <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> directive with the <code>anon</code> value.</p>     <h2 id=\"example\">Example</h2> <p>The example below is combined with \"normal\" htpasswd-file based authentication and allows users in additionally as 'guests' with the following properties:</p> <ul> <li>It insists that the user enters a userID. (<code class=\"directive\"><a href=\"#anonymous_nouserid\">Anonymous_NoUserID</a></code>)</li> <li>It insists that the user enters a password. (<code class=\"directive\"><a href=\"#anonymous_mustgiveemail\">Anonymous_MustGiveEmail</a></code>)</li> <li>The password entered must be a valid email address, <em>i.e.</em> contain at least one '@' and a '.'. (<code class=\"directive\"><a href=\"#anonymous_verifyemail\">Anonymous_VerifyEmail</a></code>)</li> <li>The userID must be one of <code>anonymous guest www test welcome</code> and comparison is <strong>not</strong> case sensitive. (<code class=\"directive\"><a href=\"#anonymous\">Anonymous</a></code>)</li> <li>And the Email addresses entered in the passwd field are logged to the error log file. (<code class=\"directive\"><a href=\"#anonymous_logemail\">Anonymous_LogEmail</a></code>)</li> </ul> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Directory \"/var/www/html/private\"&gt;\n    AuthName \"Use 'anonymous' &amp; Email address for guest entry\"\n    AuthType Basic\n    AuthBasicProvider file anon\n    AuthUserFile \"/path/to/your/.htpasswd\"\n    \n    Anonymous_NoUserID off\n    Anonymous_MustGiveEmail on\n    Anonymous_VerifyEmail on\n    Anonymous_LogEmail on\n    Anonymous anonymous guest www test welcome\n    \n    Require valid-user\n&lt;/Directory&gt;</pre> </div>   <div class=\"directive-section\">\n<h2 id=\"anonymous\">Anonymous Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies userIDs that are allowed access without password verification</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Anonymous user [user] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_anon</td>\n</tr> </table> <p>A list of one or more 'magic' userIDs which are allowed access without password verification. The userIDs are space separated. It is possible to use the ' and \" quotes to allow a space in a userID as well as the \\ escape character.</p> <p>Please note that the comparison is <strong>case-IN-sensitive</strong>.<br> It's strongly recommended that the magic username '<code>anonymous</code>' is always one of the allowed userIDs.</p> <div class=\"example\">\n<h3>Example:</h3>\n<pre class=\"prettyprint lang-config\">Anonymous anonymous \"Not Registered\" \"I don't know\"</pre> </div> <p>This would allow the user to enter without password verification by using the userIDs \"anonymous\", \"AnonyMous\", \"Not Registered\" and \"I Don't Know\".</p> <p>As of Apache 2.1 it is possible to specify the userID as \"<code>*</code>\". That allows <em>any</em> supplied userID to be accepted.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"anonymous_logemail\">Anonymous_LogEmail Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets whether the password entered will be logged in the error log</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Anonymous_LogEmail On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Anonymous_LogEmail On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_anon</td>\n</tr> </table> <p>When set <code>On</code>, the default, the 'password' entered (which hopefully contains a sensible email address) is logged in the error log.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"anonymous_mustgiveemail\">Anonymous_MustGiveEmail Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies whether blank passwords are allowed</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Anonymous_MustGiveEmail On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Anonymous_MustGiveEmail On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_anon</td>\n</tr> </table> <p>Specifies whether the user must specify an email address as the password. This prohibits blank passwords.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"anonymous_nouserid\">Anonymous_NoUserID Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets whether the userID field may be empty</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Anonymous_NoUserID On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Anonymous_NoUserID Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_anon</td>\n</tr> </table> <p>When set <code>On</code>, users can leave the userID (and perhaps the password field) empty. This can be very convenient for MS-Explorer users who can just hit return or click directly on the OK button; which seems a natural reaction.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"anonymous_verifyemail\">Anonymous_VerifyEmail Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets whether to check the password field for a correctly formatted email address</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Anonymous_VerifyEmail On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Anonymous_VerifyEmail Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_anon</td>\n</tr> </table> <p>When set <code>On</code> the 'password' entered is checked for at least one '@' and a '.' to encourage users to enter valid email addresses (see the above <code class=\"directive\"><a href=\"#anonymous_logemail\">Anonymous_LogEmail</a></code>).</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authn_anon.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authn_anon.html</a>\n  </p>\n</div>\n","mod/mod_authn_dbd":"<h1>Apache Module mod_authn_dbd</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>User authentication using an SQL database</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authn_dbd_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authn_dbd.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authentication front-ends such as <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code> and <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> to authenticate users by looking up users in SQL tables. Similar functionality is provided by, for example, <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code>.</p> <p>This module relies on <code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> to specify the backend database driver and connection parameters, and manage the database connections.</p> <p>When using <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>, this module is invoked via the <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> or <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> with the <code>dbd</code> value.</p>     <h2 id=\"socache\">Performance and Cacheing</h2> <p>Some users of DBD authentication in HTTPD 2.2/2.4 have reported that it imposes a problematic load on the database. This is most likely where an HTML page contains hundreds of objects (e.g. images, scripts, etc) each of which requires authentication. Users affected (or concerned) by this kind of problem should use <code class=\"module\"><a href=\"mod_authn_socache\">mod_authn_socache</a></code> to cache credentials and take most of the load off the database.</p>   <h2 id=\"example\">Configuration Example</h2> <p>This simple example shows use of this module in the context of the Authentication and DBD frameworks.</p> <pre class=\"prettyprint lang-config\"># mod_dbd configuration\n# UPDATED to include authentication cacheing\nDBDriver pgsql\nDBDParams \"dbname=apacheauth user=apache password=xxxxxx\"\n\nDBDMin  4\nDBDKeep 8\nDBDMax  20\nDBDExptime 300\n\n&lt;Directory \"/usr/www/myhost/private\"&gt;\n  # mod_authn_core and mod_auth_basic configuration\n  # for mod_authn_dbd\n  AuthType Basic\n  AuthName \"My Server\"\n\n  # To cache credentials, put socache ahead of dbd here\n  AuthBasicProvider socache dbd\n\n  # Also required for caching: tell the cache to cache dbd lookups!\n  AuthnCacheProvideFor dbd\n  AuthnCacheContext my-server\n\n  # mod_authz_core configuration\n  Require valid-user\n\n  # mod_authn_dbd SQL query to authenticate a user\n  AuthDBDUserPWQuery \"SELECT password FROM authn WHERE user = %s\"\n&lt;/Directory&gt;</pre>   <h2 id=\"exposed\">Exposing Login Information</h2> <p> If httpd was built against <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> version 1.3.0 or higher, then whenever a query is made to the database server, all column values in the first row returned by the query are placed in the environment, using environment variables with the prefix \"AUTHENTICATE_\". </p> <p>If a database query for example returned the username, full name and telephone number of a user, a CGI program will have access to this information without the need to make a second independent database query to gather this additional information.</p> <p>This has the potential to dramatically simplify the coding and configuration required in some web applications. </p>   <div class=\"directive-section\">\n<h2 id=\"authdbduserpwquery\">AuthDBDUserPWQuery Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>SQL query to look up a password for a user</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDBDUserPWQuery query</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDBDUserPWQuery</code> specifies an SQL query to look up a password for a specified user. The user's ID will be passed as a single string parameter when the SQL query is executed. It may be referenced within the query statement using a <code>%s</code> format specifier.</p> <pre class=\"prettyprint lang-config\">AuthDBDUserPWQuery \"SELECT password FROM authn WHERE user = %s\"</pre> <p>The first column value of the first row returned by the query statement should be a string containing the encrypted password. Subsequent rows will be ignored. If no rows are returned, the user will not be authenticated through <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code>.</p> <p>If httpd was built against <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> version 1.3.0 or higher, any additional column values in the first row returned by the query statement will be stored as environment variables with names of the form <code>AUTHENTICATE_COLUMN</code>. </p> <p>The encrypted password format depends on which authentication frontend (e.g. <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>) is being used. See <a href=\"../misc/password_encryptions\">Password Formats</a> for more information.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authdbduserrealmquery\">AuthDBDUserRealmQuery Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>SQL query to look up a password hash for a user and realm. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDBDUserRealmQuery query</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDBDUserRealmQuery</code> specifies an SQL query to look up a password for a specified user and realm in a digest authentication process. The user's ID and the realm, in that order, will be passed as string parameters when the SQL query is executed. They may be referenced within the query statement using <code>%s</code> format specifiers.</p> <pre class=\"prettyprint lang-config\">AuthDBDUserRealmQuery \"SELECT password FROM authn WHERE user = %s AND realm = %s\"</pre> <p>The first column value of the first row returned by the query statement should be a string containing the encrypted password. Subsequent rows will be ignored. If no rows are returned, the user will not be authenticated through <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code>.</p> <p>If httpd was built against <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> version 1.3.0 or higher, any additional column values in the first row returned by the query statement will be stored as environment variables with names of the form <code>AUTHENTICATE_COLUMN</code>. </p> <p>The encrypted password format depends on which authentication frontend (e.g. <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>) is being used. See <a href=\"../misc/password_encryptions\">Password Formats</a> for more information.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authn_dbd.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authn_dbd.html</a>\n  </p>\n</div>\n","mod/mod_authn_dbm":"<h1>Apache Module mod_authn_dbm</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>User authentication using DBM files</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authn_dbm_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authn_dbm.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authentication front-ends such as <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code> and <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> to authenticate users by looking up users in <dfn>dbm</dfn> password files. Similar functionality is provided by <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code>.</p> <p>When using <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>, this module is invoked via the <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> or <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> with the <code>dbm</code> value.</p>    <div class=\"directive-section\">\n<h2 id=\"authdbmtype\">AuthDBMType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the type of database file that is used to store passwords</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDBMType default|SDBM|GDBM|NDBM|DB</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthDBMType default</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_dbm</td>\n</tr> </table> <p>Sets the type of database file that is used to store the passwords. The default database type is determined at compile time. The availability of other types of database files also depends on <a href=\"../programs/configure#options\">compile-time settings</a>.</p> <p>For example, in order to enable the support for Berkeley DB (correspondent to the <code>db</code> type) the <code>--with-berkeley-db</code> option needs to be added to httpd's configure to generate the necessary DSO.</p> <p>It is crucial that whatever program you use to create your password files is configured to use the same type of database.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authdbmuserfile\">AuthDBMUserFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the name of a database file containing the list of users and passwords for authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDBMUserFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_dbm</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDBMUserFile</code> directive sets the name of a DBM file containing the list of users and passwords for user authentication. <var>File-path</var> is the absolute path to the user file.</p> <p>The user file is keyed on the username. The value for a user is the encrypted password, optionally followed by a colon and arbitrary data. The colon and the data following it will be ignored by the server.</p> <div class=\"warning\">\n<p><strong>Security:</strong></p> <p>Make sure that the <code class=\"directive\">AuthDBMUserFile</code> is stored outside the document tree of the web-server; do <em>not</em> put it in the directory that it protects. Otherwise, clients will be able to download the <code class=\"directive\">AuthDBMUserFile</code>.</p> </div> <p>The encrypted password format depends on which authentication frontend (e.g. <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>) is being used. See <a href=\"../misc/password_encryptions\">Password Formats</a> for more information.</p> <p>Important compatibility note: The implementation of <code>dbmopen</code> in the Apache modules reads the string length of the hashed values from the DBM data structures, rather than relying upon the string being NULL-appended. Some applications, such as the Netscape web server, rely upon the string being NULL-appended, so if you are having trouble using DBM files interchangeably between applications this may be a part of the problem.</p> <p>A perl script called <code class=\"program\"><a href=\"../programs/dbmmanage\">dbmmanage</a></code> is included with Apache. This program can be used to create and update DBM format password files for use with this module. Another tool for maintaining the DBM files is the included program <code class=\"program\"><a href=\"../programs/htdbm\">htdbm</a></code>.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authn_dbm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authn_dbm.html</a>\n  </p>\n</div>\n","mod/mod_authn_file":"<h1>Apache Module mod_authn_file</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>User authentication using text files</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authn_file_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authn_file.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authentication front-ends such as <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code> and <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> to authenticate users by looking up users in plain text password files. Similar functionality is provided by <code class=\"module\"><a href=\"mod_authn_dbm\">mod_authn_dbm</a></code>.</p> <p>When using <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>, this module is invoked via the <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> or <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> with the <code>file</code> value.</p>    <div class=\"directive-section\">\n<h2 id=\"authuserfile\">AuthUserFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the name of a text file containing the list of users and passwords for authentication</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthUserFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_file</td>\n</tr> </table> <p>The <code class=\"directive\">AuthUserFile</code> directive sets the name of a textual file containing the list of users and passwords for user authentication. <var>File-path</var> is the path to the user file. If it is not absolute, it is treated as relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>.</p> <p>Each line of the user file contains a username followed by a colon, followed by the encrypted password. If the same user ID is defined multiple times, <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> will use the first occurrence to verify the password.</p> <p>The encrypted password format depends on which authentication frontend (e.g. <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>) is being used. See <a href=\"../misc/password_encryptions\">Password Formats</a> for more information.</p> <p>For <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code>, use the utility <code class=\"program\"><a href=\"../programs/htpasswd\">htpasswd</a></code> which is installed as part of the binary distribution, or which can be found in <code>src/support</code>. See the <a href=\"../programs/htpasswd\">man page</a> for more details. In short:</p> <p>Create a password file <code>Filename</code> with <code>username</code> as the initial ID. It will prompt for the password:</p> <div class=\"example\"><pre>htpasswd -c Filename username</pre></div> <p>Add or modify <code>username2</code> in the password file <code>Filename</code>:</p> <div class=\"example\"><pre>htpasswd Filename username2</pre></div> <p>Note that searching large text files is <em>very</em> inefficient; <code class=\"directive\"><a href=\"mod_authn_dbm#authdbmuserfile\">AuthDBMUserFile</a></code> should be used instead.</p> <p>For <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>, use <code class=\"program\"><a href=\"../programs/htdigest\">htdigest</a></code> instead. Note that you cannot mix user data for Digest Authentication and Basic Authentication within the same file.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>Make sure that the <code class=\"directive\">AuthUserFile</code> is stored outside the document tree of the web-server. Do <strong>not</strong> put it in the directory that it protects. Otherwise, clients may be able to download the <code class=\"directive\">AuthUserFile</code>.</p> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authn_file.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authn_file.html</a>\n  </p>\n</div>\n","mod/mod_authn_socache":"<h1>Apache Module mod_authn_socache</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Manages a cache of authentication credentials to relieve the load on backends</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authn_socache_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authn_socache.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>Maintains a cache of authentication credentials, so that a new backend lookup is not required for every authenticated request.</p>     <h2 id=\"intro\">Authentication Cacheing</h2> <p>Some users of more heavyweight authentication such as SQL database lookups (<code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code>) have reported it putting an unacceptable load on their authentication provider. A typical case in point is where an HTML page contains hundreds of objects (images, scripts, stylesheets, media, etc), and a request to the page generates hundreds of effectively-immediate requests for authenticated additional contents.</p> <p>mod_authn_socache provides a solution to this problem by maintaining a cache of authentication credentials.</p>   <h2 id=\"usage\">Usage</h2> <p>The authentication cache should be used where authentication lookups impose a significant load on the server, or a backend or network. Authentication by file (<code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code>) or dbm (<code class=\"module\"><a href=\"mod_authn_dbm\">mod_authn_dbm</a></code>) are unlikely to benefit, as these are fast and lightweight in their own right (though in some cases, such as a network-mounted file, cacheing may be worthwhile). Other providers such as SQL or LDAP based authentication are more likely to benefit, particularly where there is an observed performance issue. Amongst the standard modules, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> manages its own cache, so only <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code> will usually benefit from this cache.</p> <p>The basic rules to cache for a provider are:</p> <ol>\n<li>Include the provider you're cacheing for in an <code class=\"directive\">AuthnCacheProvideFor</code> directive.</li> <li>List <var>socache</var> ahead of the provider you're cacheing for in your <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> or <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> directive.</li> </ol> <p>A simple usage example to accelerate <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code> using dbm as a cache engine:</p> <pre class=\"prettyprint lang-config\">#AuthnCacheSOCache is optional.  If specified, it is server-wide\nAuthnCacheSOCache dbm\n&lt;Directory \"/usr/www/myhost/private\"&gt;\n    AuthType Basic\n    AuthName \"Cached Authentication Example\"\n    AuthBasicProvider socache dbd\n    AuthDBDUserPWQuery \"SELECT password FROM authn WHERE user = %s\"\n    AuthnCacheProvideFor dbd\n    Require valid-user\n    #Optional\n    AuthnCacheContext dbd-authn-example\n&lt;/Directory&gt;</pre>   <h2 id=\"dev\">Cacheing with custom modules</h2> <p>Module developers should note that their modules must be enabled for cacheing with mod_authn_socache. A single optional API function <var>ap_authn_cache_store</var> is provided to cache credentials a provider has just looked up or generated. Usage examples are available in <a href=\"http://svn.eu.apache.org/viewvc?view=revision&amp;revision=957072\">r957072</a>, in which three authn providers are enabled for cacheing.</p>   <div class=\"directive-section\">\n<h2 id=\"authncachecontext\">AuthnCacheContext Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify a context string for use in the cache key</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthnCacheContext directory|server|custom-string</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>directory</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_socache</td>\n</tr> </table> <p>This directive specifies a string to be used along with the supplied username (and realm in the case of Digest Authentication) in constructing a cache key. This serves to disambiguate identical usernames serving different authentication areas on the server.</p> <p>Two special values for this are <var>directory</var>, which uses the directory context of the request as a string, and <var>server</var> which uses the virtual host name.</p> <p>The default is <var>directory</var>, which is also the most conservative setting. This is likely to be less than optimal, as it (for example) causes <var>$app-base</var>, <var>$app-base/images</var>, <var>$app-base/scripts</var> and <var>$app-base/media</var> each to have its own separate cache key. A better policy is to name the <code class=\"directive\">AuthnCacheContext</code> for the password provider: for example a <var>htpasswd</var> file or database table.</p> <p>Contexts can be shared across different areas of a server, where credentials are shared. However, this has potential to become a vector for cross-site or cross-application security breaches, so this directive is not permitted in <var>.htaccess</var> contexts.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authncacheenable\">AuthnCacheEnable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable Authn caching configured anywhere</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><code>AuthnCacheEnable</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Override:</th>\n<td>None</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_socache</td>\n</tr> </table> <p>This directive is not normally necessary: it is implied if authentication cacheing is enabled anywhere in <var>httpd.conf</var>. However, if it is not enabled anywhere in <var>httpd.conf</var> it will by default not be initialised, and is therefore not available in a <var>.htaccess</var> context. This directive ensures it is initialised so it can be used in <var>.htaccess</var>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authncacheprovidefor\">AuthnCacheProvideFor Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify which authn provider(s) to cache for</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthnCacheProvideFor authn-provider [...]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>None</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_socache</td>\n</tr> </table> <p>This directive specifies an authentication provider or providers to cache for. Credentials found by a provider not listed in an AuthnCacheProvideFor directive will not be cached.</p> <p>For example, to cache credentials found by <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code> or by a custom provider <var>myprovider</var>, but leave those looked up by lightweight providers like file or dbm lookup alone:</p> <pre class=\"prettyprint lang-config\">AuthnCacheProvideFor dbd myprovider</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"authncachesocache\">AuthnCacheSOCache Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Select socache backend provider to use</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthnCacheSOCache provider-name[:provider-args]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Override:</th>\n<td>None</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_socache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Optional provider arguments are available in Apache HTTP Server 2.4.7 and later</td>\n</tr> </table> <p>This is a server-wide setting to select a provider for the <a href=\"../socache\">shared object cache</a>, followed by optional arguments for that provider. Some possible values for <var>provider-name</var> are \"dbm\", \"dc\", \"memcache\", or \"shmcb\", each subject to the appropriate module being loaded. If not set, your platform's default will be used.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authncachetimeout\">AuthnCacheTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set a timeout for cache entries</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthnCacheTimeout timeout (seconds)</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>300 (5 minutes)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authn_socache</td>\n</tr> </table> <p>Cacheing authentication data can be a security issue, though short-term cacheing is unlikely to be a problem. Typically a good solution is to cache credentials for as long as it takes to relieve the load on a backend, but no longer, though if changes to your users and passwords are infrequent then a longer timeout may suit you. The default 300 seconds (5 minutes) is both cautious and ample to keep the load on a backend such as dbd (SQL database queries) down.</p> <p>This should not be confused with session timeout, which is an entirely separate issue. However, you may wish to check your session-management software for whether cached credentials can \"accidentally\" extend a session, and bear it in mind when setting your timeout.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authn_socache.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authn_socache.html</a>\n  </p>\n</div>\n","mod/mod_authnz_fcgi":"<h1>Apache Module mod_authnz_fcgi</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Allows a FastCGI authorizer application to handle Apache httpd authentication and authorization</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authnz_fcgi_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authnz_fcgi.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.10 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module allows FastCGI authorizer applications to authenticate users and authorize access to resources. It supports generic FastCGI authorizers which participate in a single phase for authentication and authorization as well as Apache httpd-specific authenticators and authorizors which participate in one or both phases.</p> <p>FastCGI authorizers can authenticate using user id and password, such as for Basic authentication, or can authenticate using arbitrary mechanisms.</p>     <h2 id=\"invocations\">Invocation modes</h2> <p>The invocation modes for FastCGI authorizers supported by this module are distinguished by two characteristics, <em>type</em> and auth <em>mechanism</em>.</p> <p><em>Type</em> is simply <code>authn</code> for authentication, <code>authz</code> for authorization, or <code>authnz</code> for combined authentication and authorization.</p> <p>Auth <em>mechanism</em> refers to the Apache httpd configuration mechanisms and processing phases, and can be <code>AuthBasicProvider</code>, <code>Require</code>, or <code>check_user_id</code>. The first two of these correspond to the directives used to enable participation in the appropriate processing phase.</p> <p>Descriptions of each mode:</p> <dl> <dt>\n<em>Type</em> <code>authn</code>, <em>mechanism</em> <code>AuthBasicProvider</code>\n</dt> <dd>In this mode, <code>FCGI_ROLE</code> is set to <code>AUTHORIZER</code> and <code>FCGI_APACHE_ROLE</code> is set to <code>AUTHENTICATOR</code>. The application must be defined as provider type <em>authn</em> using <code class=\"directive\"><a href=\"#authnzfcgidefineprovider\"> AuthnzFcgiDefineProvider</a></code> and enabled with <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code>. When invoked, the application is expected to authenticate the client using the provided user id and password. Example application: <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl\nuse FCGI;\nmy $request = FCGI::Request();\nwhile ($request-&gt;Accept() &gt;= 0) {\n    die if $ENV{'FCGI_APACHE_ROLE'} ne \"AUTHENTICATOR\";\n    die if $ENV{'FCGI_ROLE'}        ne \"AUTHORIZER\";\n    die if !$ENV{'REMOTE_PASSWD'};\n    die if !$ENV{'REMOTE_USER'};\n\n    print STDERR \"This text is written to the web server error log.\\n\";\n\n    if ( ($ENV{'REMOTE_USER' } eq \"foo\" || $ENV{'REMOTE_USER'} eq \"foo1\") &amp;&amp;\n        $ENV{'REMOTE_PASSWD'} eq \"bar\" ) {\n        print \"Status: 200\\n\";\n        print \"Variable-AUTHN_1: authn_01\\n\";\n        print \"Variable-AUTHN_2: authn_02\\n\";\n        print \"\\n\";\n    }\n    else {\n        print \"Status: 401\\n\\n\";\n    }\n}</pre> Example configuration: <pre class=\"prettyprint lang-config\">AuthnzFcgiDefineProvider authn FooAuthn fcgi://localhost:10102/\n&lt;Location \"/protected/\"&gt;\n  AuthType Basic\n  AuthName \"Restricted\"\n  AuthBasicProvider FooAuthn\n  Require ...\n&lt;/Location&gt;</pre> </dd> <dt>\n<em>Type</em> <code>authz</code>, <em>mechanism</em> <code>Require</code>\n</dt> <dd>In this mode, <code>FCGI_ROLE</code> is set to <code>AUTHORIZER</code> and <code>FCGI_APACHE_ROLE</code> is set to <code>AUTHORIZER</code>. The application must be defined as provider type <em>authz</em> using <code class=\"directive\"><a href=\"#authnzfcgidefineprovider\"> AuthnzFcgiDefineProvider</a></code>. When invoked, the application is expected to authorize the client using the provided user id and other request data. Example application: <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl\nuse FCGI;\nmy $request = FCGI::Request();\nwhile ($request-&gt;Accept() &gt;= 0) {\n    die if $ENV{'FCGI_APACHE_ROLE'} ne \"AUTHORIZER\";\n    die if $ENV{'FCGI_ROLE'}        ne \"AUTHORIZER\";\n    die if $ENV{'REMOTE_PASSWD'};\n\n    print STDERR \"This text is written to the web server error log.\\n\";\n\n    if ($ENV{'REMOTE_USER'} eq \"foo1\") {\n        print \"Status: 200\\n\";\n        print \"Variable-AUTHZ_1: authz_01\\n\";\n        print \"Variable-AUTHZ_2: authz_02\\n\";\n        print \"\\n\";\n    }\n    else {\n        print \"Status: 403\\n\\n\";\n    }\n}</pre> Example configuration: <pre class=\"prettyprint lang-config\">AuthnzFcgiDefineProvider authz FooAuthz fcgi://localhost:10103/\n&lt;Location \"/protected/\"&gt;\n  AuthType ...\n  AuthName ...\n  AuthBasicProvider ...\n  Require FooAuthz\n&lt;/Location&gt;</pre> </dd> <dt>\n<em>Type</em> <code>authnz</code>, <em>mechanism</em> <code>AuthBasicProvider</code> <em>+</em> <code>Require</code>\n</dt> <dd>In this mode, which supports the web server-agnostic FastCGI <code>AUTHORIZER</code> protocol, <code>FCGI_ROLE</code> is set to <code>AUTHORIZER</code> and <code>FCGI_APACHE_ROLE</code> is not set. The application must be defined as provider type <em>authnz</em> using <code class=\"directive\"><a href=\"#authnzfcgidefineprovider\"> AuthnzFcgiDefineProvider</a></code>. The application is expected to handle both authentication and authorization in the same invocation using the user id, password, and other request data. The invocation occurs during the Apache httpd API authentication phase. If the application returns 200 and the same provider is invoked during the authorization phase (via <code class=\"directive\">Require</code>), mod_authnz_fcgi will return success for the authorization phase without invoking the application. Example application: <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl\nuse FCGI;\nmy $request = FCGI::Request();\nwhile ($request-&gt;Accept() &gt;= 0) {\n    die if $ENV{'FCGI_APACHE_ROLE'};\n    die if $ENV{'FCGI_ROLE'} ne \"AUTHORIZER\";\n    die if !$ENV{'REMOTE_PASSWD'};\n    die if !$ENV{'REMOTE_USER'};\n\n    print STDERR \"This text is written to the web server error log.\\n\";\n\n    if ( ($ENV{'REMOTE_USER' } eq \"foo\" || $ENV{'REMOTE_USER'} eq \"foo1\") &amp;&amp;\n        $ENV{'REMOTE_PASSWD'} eq \"bar\" &amp;&amp;\n        $ENV{'REQUEST_URI'} =~ m%/bar/.*%) {\n        print \"Status: 200\\n\";\n        print \"Variable-AUTHNZ_1: authnz_01\\n\";\n        print \"Variable-AUTHNZ_2: authnz_02\\n\";\n        print \"\\n\";\n    }\n    else {\n        print \"Status: 401\\n\\n\";\n    }\n}</pre> Example configuration: <pre class=\"prettyprint lang-config\">AuthnzFcgiDefineProvider authnz FooAuthnz fcgi://localhost:10103/\n&lt;Location \"/protected/\"&gt;\n  AuthType Basic\n  AuthName \"Restricted\"\n  AuthBasicProvider FooAuthnz\n  Require FooAuthnz\n&lt;/Location&gt;</pre> </dd> <dt>\n<em>Type</em> <code>authn</code>, <em>mechanism</em> <code>check_user_id</code>\n</dt> <dd>In this mode, <code>FCGI_ROLE</code> is set to <code>AUTHORIZER</code> and <code>FCGI_APACHE_ROLE</code> is set to <code>AUTHENTICATOR</code>. The application must be defined as provider type <em>authn</em> using <code class=\"directive\"><a href=\"#authnzfcgidefineprovider\"> AuthnzFcgiDefineProvider</a></code>. <code class=\"directive\"><a href=\"#authnzfcgicheckauthnprovider\">AuthnzFcgiCheckAuthnProvider</a></code> specifies when it is called. Example application: <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl\nuse FCGI;\nmy $request = FCGI::Request();\nwhile ($request-&gt;Accept() &gt;= 0) {\n    die if $ENV{'FCGI_APACHE_ROLE'} ne \"AUTHENTICATOR\";\n    die if $ENV{'FCGI_ROLE'} ne \"AUTHORIZER\";\n\n    # This authorizer assumes that the RequireBasicAuth option of \n    # AuthnzFcgiCheckAuthnProvider is On:\n    die if !$ENV{'REMOTE_PASSWD'};\n    die if !$ENV{'REMOTE_USER'};\n\n    print STDERR \"This text is written to the web server error log.\\n\";\n\n    if ( ($ENV{'REMOTE_USER' } eq \"foo\" || $ENV{'REMOTE_USER'} eq \"foo1\") &amp;&amp;\n        $ENV{'REMOTE_PASSWD'} eq \"bar\" ) {\n        print \"Status: 200\\n\";\n        print \"Variable-AUTHNZ_1: authnz_01\\n\";\n        print \"Variable-AUTHNZ_2: authnz_02\\n\";\n        print \"\\n\";\n    }\n    else {\n        print \"Status: 401\\n\\n\";\n        # If a response body is written here, it will be returned to\n        # the client.\n    }\n}</pre> Example configuration: <pre class=\"prettyprint lang-config\">AuthnzFcgiDefineProvider authn FooAuthn fcgi://localhost:10103/\n&lt;Location \"/protected/\"&gt;\n  AuthType ...\n  AuthName ...\n  AuthnzFcgiCheckAuthnProvider FooAuthn \\\n                               Authoritative On \\\n                               RequireBasicAuth Off \\\n                               UserExpr \"%{reqenv:REMOTE_USER}\"\n  Require ...\n&lt;/Location&gt;</pre> </dd> </dl>   <h2 id=\"examples\">Additional examples</h2> <ol> <li>If your application supports the separate authentication and authorization roles (<code>AUTHENTICATOR</code> and <code>AUTHORIZER</code>), define separate providers as follows, even if they map to the same application: <pre class=\"prettyprint lang-config\">AuthnzFcgiDefineProvider authn  FooAuthn  fcgi://localhost:10102/\nAuthnzFcgiDefineProvider authz  FooAuthz  fcgi://localhost:10102/</pre> Specify the authn provider on <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> and the authz provider on <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code>: <pre class=\"prettyprint lang-config\">AuthType Basic\nAuthName \"Restricted\"\nAuthBasicProvider FooAuthn\nRequire FooAuthz</pre> </li> <li>If your application supports the generic <code>AUTHORIZER</code> role (authentication and authorizer in one invocation), define a single provider as follows: <pre class=\"prettyprint lang-config\">AuthnzFcgiDefineProvider authnz FooAuthnz fcgi://localhost:10103/</pre> Specify the authnz provider on both <code class=\"directive\">AuthBasicProvider</code> and <code class=\"directive\">Require</code>: <pre class=\"prettyprint lang-config\">AuthType Basic\nAuthName \"Restricted\"\nAuthBasicProvider FooAuthnz\nRequire FooAuthnz</pre> </li> </ol>   <h2 id=\"limitations\">Limitations</h2> <p>The following are potential features which are not currently implemented:</p> <dl> <dt>Apache httpd access checker</dt> <dd>The Apache httpd API <em>access check</em> phase is a separate phase from authentication and authorization. Some other FastCGI implementations implement this phase, which is denoted by the setting of <code>FCGI_APACHE_ROLE</code> to <code>ACCESS_CHECKER</code>.</dd> <dt>Local (Unix) sockets or pipes</dt> <dd>Only TCP sockets are currently supported.</dd> <dt>Support for mod_authn_socache</dt> <dd>mod_authn_socache interaction should be implemented for applications which participate in Apache httpd-style authentication.</dd> <dt>Support for digest authentication using AuthDigestProvider</dt> <dd>This is expected to be a permanent limitation as there is no authorizer flow for retrieving a hash.</dd> <dt>Application process management</dt> <dd>This is expected to be permanently out of scope for this module. Application processes must be controlled by other means. For example, <code class=\"program\"><a href=\"../programs/fcgistarter\">fcgistarter</a></code> can be used to start them.</dd> <dt>AP_AUTH_INTERNAL_PER_URI</dt> <dd>All providers are currently registered as AP_AUTH_INTERNAL_PER_CONF, which means that checks are not performed again for internal subrequests with the same access control configuration as the initial request.</dd> <dt>Protocol data charset conversion</dt> <dd>If mod_authnz_fcgi runs in an EBCDIC compilation environment, all FastCGI protocol data is written in EBCDIC and expected to be received in EBCDIC.</dd> <dt>Multiple requests per connection</dt> <dd>Currently the connection to the FastCGI authorizer is closed after every phase of processing. For example, if the authorizer handles separate <em>authn</em> and <em>authz</em> phases then two connections will be used.</dd> <dt>URI Mapping</dt> <dd>URIs from clients can't be mapped, such as with the <code class=\"directive\">ProxyPass</code> used with FastCGI responders.</dd> </dl>   <h2 id=\"logging\">Logging</h2> <ol> <li>Processing errors are logged at log level <code>error</code> and higher.</li> <li>Messages written by the application are logged at log level <code>warn</code>.</li> <li>General messages for debugging are logged at log level <code>debug</code>.</li> <li>Environment variables passed to the application are logged at log level <code>trace2</code>. The value of the <code>REMOTE_PASSWD</code> variable will be obscured, but <strong>any other sensitive data will be visible in the log</strong>.</li> <li>All I/O between the module and the FastCGI application, including all environment variables, will be logged in printable and hex format at log level <code>trace5</code>. <strong>All sensitive data will be visible in the log.</strong>\n</li> </ol> <p><code class=\"directive\"><a href=\"core#loglevel\">LogLevel</a></code> can be used to configure a log level specific to mod_authnz_fcgi. For example:</p> <pre class=\"prettyprint lang-config\">LogLevel info authnz_fcgi:trace8</pre>   <div class=\"directive-section\">\n<h2 id=\"authnzfcgicheckauthnprovider\">AuthnzFcgiCheckAuthnProvider Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables a FastCGI application to handle the check_authn authentication hook.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthnzFcgiCheckAuthnProvider provider-name|None option ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_fcgi</td>\n</tr> </table> <p>This directive is used to enable a FastCGI authorizer to handle a specific processing phase of authentication or authorization.</p> <p>Some capabilities of FastCGI authorizers require enablement using this directive instead of <code class=\"directive\">AuthBasicProvider</code>:</p> <ul> <li>Non-Basic authentication; generally, determining the user id of the client and returning it from the authorizer; see the <code>UserExpr</code> option below</li> <li>Selecting a custom response code; for a non-200 response from the authorizer, the code from the authorizer will be the status of the response</li> <li>Setting the body of a non-200 response; if the authorizer provides a response body with a non-200 response, that body will be returned to the client; up to 8192 bytes of text are supported</li> </ul> <dl> <dt><em>provider-name</em></dt> <dd>This is the name of a provider defined with <code class=\"directive\">AuthnzFcgiDefineProvider</code>.</dd> <dt><code>None</code></dt> <dd>Specify <code>None</code> to disable a provider enabled with this directive in an outer scope, such as in a parent directory.</dd> <dt><em>option</em></dt> <dd>The following options are supported: <dl> <dt>Authoritative On|Off (default On)</dt> <dd>This controls whether or not other modules are allowed to run when this module has a FastCGI authorizer configured and it fails the request.</dd> <dt>DefaultUser <em>userid</em>\n</dt> <dd>When the authorizer returns success and <code>UserExpr</code> is configured and evaluates to an empty string (e.g., authorizer didn't return a variable), this value will be used as the user id. This is typically used when the authorizer has a concept of guest, or unauthenticated, users and guest users are mapped to some specific user id for logging and other purposes.</dd> <dt>RequireBasicAuth On|Off (default Off)</dt> <dd>This controls whether or not Basic auth is required before passing the request to the authorizer. If required, the authorizer won't be invoked without a user id and password; 401 will be returned for a request without that.</dd> <dt>UserExpr <em>expr</em> (no default)</dt> <dd>When Basic authentication isn't provided by the client and the authorizer determines the user, this expression, evaluated after calling the authorizer, determines the user. The expression follows <a href=\"../expr\"> ap_expr syntax</a> and must resolve to a string. A typical use is to reference a <code>Variable-<em>XXX</em></code> setting returned by the authorizer using an option like <code>UserExpr \"%{reqenv:<em>XXX</em>}\"</code>. If this option is specified and the user id can't be retrieved using the expression after a successful authentication, the request will be rejected with a 500 error.</dd> </dl> </dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"authnzfcgidefineprovider\">AuthnzFcgiDefineProvider Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Defines a FastCGI application as a provider for authentication and/or authorization</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthnzFcgiDefineProvider type provider-name backend-address</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_fcgi</td>\n</tr> </table> <p>This directive is used to define a FastCGI application as a provider for a particular phase of authentication or authorization.</p> <dl> <dt><em>type</em></dt> <dd>This must be set to <em>authn</em> for authentication, <em>authz</em> for authorization, or <em>authnz</em> for a generic FastCGI authorizer which performs both checks.</dd> <dt><em>provider-name</em></dt> <dd>This is used to assign a name to the provider which is used in other directives such as <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> and <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code>.</dd> <dt><em>backend-address</em></dt> <dd>This specifies the address of the application, in the form <em>fcgi://hostname:port/</em>. The application process(es) must be managed independently, such as with <code class=\"program\"><a href=\"../programs/fcgistarter\">fcgistarter</a></code>.</dd> </dl> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authnz_fcgi.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authnz_fcgi.html</a>\n  </p>\n</div>\n","mod/mod_authz_dbm":"<h1>Apache Module mod_authz_dbm</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Group authorization using DBM files</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authz_dbm_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authz_dbm.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authorization capabilities so that authenticated users can be allowed or denied access to portions of the web site by group membership. Similar functionality is provided by <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code>.</p>     <h2 id=\"requiredirectives\">The Require Directives</h2> <p>Apache's <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives are used during the authorization phase to ensure that a user is allowed to access a resource. mod_authz_dbm extends the authorization types with <code>dbm-group</code>.</p> <p>Since v2.4.8, <a href=\"../expr\">expressions</a> are supported within the DBM require directives.</p> <h3><a name=\"reqgroup\" id=\"reqgroup\">Require dbm-group</a></h3> <p>This directive specifies group membership that is required for the user to gain access.</p> <pre class=\"prettyprint lang-config\">Require dbm-group admin</pre> <h3><a name=\"reqfilegroup\" id=\"reqfilegroup\">Require dbm-file-group</a></h3> <p>When this directive is specified, the user must be a member of the group assigned to the file being accessed.</p> <pre class=\"prettyprint lang-config\">Require dbm-file-group</pre>   <h2 id=\"examples\">Example usage</h2> <p><em>Note that using mod_authz_dbm requires you to require <code>dbm-group</code> instead of <code>group</code>:</em> </p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/foo/bar\"&gt;\n  AuthType Basic\n  AuthName \"Secure Area\"\n  AuthBasicProvider dbm\n  AuthDBMUserFile \"site/data/users\"\n  AuthDBMGroupFile \"site/data/users\"\n  Require dbm-group admin\n&lt;/Directory&gt;</pre>   <div class=\"directive-section\">\n<h2 id=\"authdbmgroupfile\">AuthDBMGroupFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the name of the database file containing the list of user groups for authorization</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthDBMGroupFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_dbm</td>\n</tr> </table> <p>The <code class=\"directive\">AuthDBMGroupFile</code> directive sets the name of a DBM file containing the list of user groups for user authorization. <var>File-path</var> is the absolute path to the group file.</p> <p>The group file is keyed on the username. The value for a user is a comma-separated list of the groups to which the users belongs. There must be no whitespace within the value, and it must never contain any colons.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>Make sure that the <code class=\"directive\">AuthDBMGroupFile</code> is stored outside the document tree of the web-server. Do <strong>not</strong> put it in the directory that it protects. Otherwise, clients will be able to download the <code class=\"directive\">AuthDBMGroupFile</code> unless otherwise protected.</p> </div> <p>Combining Group and Password DBM files: In some cases it is easier to manage a single database which contains both the password and group details for each user. This simplifies any support programs that need to be written: they now only have to deal with writing to and locking a single DBM file. This can be accomplished by first setting the group and password files to point to the same DBM:</p> <pre class=\"prettyprint lang-config\">AuthDBMGroupFile \"/www/userbase\"\nAuthDBMUserFile \"/www/userbase\"</pre> <p>The key for the single DBM is the username. The value consists of</p> <div class=\"example\"><pre>Encrypted Password : List of Groups [ : (ignored) ]</pre></div> <p>The password section contains the encrypted password as before. This is followed by a colon and the comma separated list of groups. Other data may optionally be left in the DBM file after another colon; it is ignored by the authorization module. This is what www.telescope.org uses for its combined password and group database.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authzdbmtype\">AuthzDBMType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the type of database file that is used to store list of user groups</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthzDBMType default|SDBM|GDBM|NDBM|DB</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthzDBMType default</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_dbm</td>\n</tr> </table> <p>Sets the type of database file that is used to store the list of user groups. The default database type is determined at compile time. The availability of other types of database files also depends on <a href=\"../install#dbm\">compile-time settings</a>.</p> <p>It is crucial that whatever program you use to create your group files is configured to use the same type of database.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authz_dbm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authz_dbm.html</a>\n  </p>\n</div>\n","mod/mod_authz_groupfile":"<h1>Apache Module mod_authz_groupfile</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Group authorization using plaintext files</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authz_groupfile_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authz_groupfile.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authorization capabilities so that authenticated users can be allowed or denied access to portions of the web site by group membership. Similar functionality is provided by <code class=\"module\"><a href=\"mod_authz_dbm\">mod_authz_dbm</a></code>.</p>     <h2 id=\"requiredirectives\">The Require Directives</h2> <p>Apache's <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives are used during the authorization phase to ensure that a user is allowed to access a resource. mod_authz_groupfile extends the authorization types with <code>group</code> and <code>group-file</code>. </p> <p>Since v2.4.8, <a href=\"../expr\">expressions</a> are supported within the groupfile require directives.</p> <h3><a name=\"reqgroup\" id=\"reqgroup\">Require group</a></h3> <p>This directive specifies group membership that is required for the user to gain access.</p> <pre class=\"prettyprint lang-config\">Require group admin</pre> <h3><a name=\"reqfilegroup\" id=\"reqfilegroup\">Require file-group</a></h3> <p>When this directive is specified, the filesystem permissions on the file being accessed are consulted. The user must be a member of a group with the same name as the group that owns the file. See <code class=\"module\"><a href=\"mod_authz_owner\">mod_authz_owner</a></code> for more details.</p> <pre class=\"prettyprint lang-config\">Require file-group</pre>   <div class=\"directive-section\">\n<h2 id=\"authgroupfile\">AuthGroupFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the name of a text file containing the list of user groups for authorization</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthGroupFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_groupfile</td>\n</tr> </table> <p>The <code class=\"directive\">AuthGroupFile</code> directive sets the name of a textual file containing the list of user groups for user authorization. <var>File-path</var> is the path to the group file. If it is not absolute, it is treated as relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>.</p> <p>Each line of the group file contains a groupname followed by a colon, followed by the member usernames separated by spaces.</p> <div class=\"example\">\n<h3>Example:</h3>\n<pre>mygroup: bob joe anne</pre>\n</div> <p>Note that searching large text files is <em>very</em> inefficient; <code class=\"directive\"><a href=\"mod_authz_dbm#authdbmgroupfile\">AuthDBMGroupFile</a></code> provides a much better performance.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>Make sure that the <code class=\"directive\">AuthGroupFile</code> is stored outside the document tree of the web-server; do <em>not</em> put it in the directory that it protects. Otherwise, clients may be able to download the <code class=\"directive\">AuthGroupFile</code>.</p> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authz_groupfile.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authz_groupfile.html</a>\n  </p>\n</div>\n","mod/mod_auth_form":"<h1>Apache Module mod_auth_form</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Form authentication</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>auth_form_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_auth_form.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Form authentication depends on the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> modules, and these modules make use of HTTP cookies, and as such can fall victim to Cross Site Scripting attacks, or expose potentially private information to clients. Please ensure that the relevant risks have been taken into account before enabling the session functionality on your server.</p> </div> <p>This module allows the use of an HTML login form to restrict access by looking up users in the given providers. HTML forms require significantly more configuration than the alternatives, however an HTML login form can provide a much friendlier experience for end users. </p> <p>HTTP basic authentication is provided by <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code>, and HTTP digest authentication is provided by <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>. This module should be combined with at least one authentication module such as <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> and one authorization module such as <code class=\"module\"><a href=\"mod_authz_user\">mod_authz_user</a></code>.</p> <p>Once the user has been successfully authenticated, the user's login details will be stored in a session provided by <code class=\"module\"><a href=\"mod_session\">mod_session</a></code>. </p>     <h2 id=\"basicconfig\">Basic Configuration</h2> <p>To protect a particular URL with <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code>, you need to decide where you will store your <var>session</var>, and you will need to decide what method you will use to authenticate. In this simple example, the login details will be stored in a session based on <code class=\"module\"><a href=\"mod_session_cookie\">mod_session_cookie</a></code>, and authentication will be attempted against a file using <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code>. If authentication is unsuccessful, the user will be redirected to the form login page.</p> <div class=\"example\">\n<h3>Basic example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/admin\"&gt;\n    AuthFormProvider file\n    AuthUserFile \"conf/passwd\"\n    AuthType form\n    AuthName \"/admin\"\n    AuthFormLoginRequiredLocation \"http://example.com/login.html\"\n\n    Session On\n    SessionCookieName session path=/\n\n    Require valid-user\n&lt;/Location&gt;</pre> </div> <p>The directive <code class=\"directive\"><a href=\"mod_authn_core#authtype\">AuthType</a></code> will enable the <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> authentication when set to the value <var>form</var>. The directives <code class=\"directive\"><a href=\"#authformprovider\">AuthFormProvider</a></code> and <code class=\"directive\"><a href=\"mod_authn_file#authuserfile\">AuthUserFile</a></code> specify that usernames and passwords should be checked against the chosen file.</p> <p>The directives <code class=\"directive\"><a href=\"mod_session#session\">Session</a></code> and <code class=\"directive\"><a href=\"mod_session_cookie#sessioncookiename\">SessionCookieName</a></code> session stored within an HTTP cookie on the browser. For more information on the different options for configuring a session, read the documentation for <code class=\"module\"><a href=\"mod_session\">mod_session</a></code>.</p> <p>You can optionally add a <code class=\"directive\"><a href=\"mod_session_crypto#sessioncryptopassphrase\">SessionCryptoPassphrase</a></code> to create an encrypted session cookie. This required the additional module <code class=\"module\"><a href=\"mod_session_crypto\">mod_session_crypto</a></code> be loaded.</p> <p>In the simple example above, a URL has been protected by <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code>, but the user has yet to be given an opportunity to enter their username and password. Options for doing so include providing a dedicated standalone login page for this purpose, or for providing the login page inline.</p>   <h2 id=\"standalone\">Standalone Login</h2> <p>The login form can be hosted as a standalone page, or can be provided inline on the same page.</p> <p>When configuring the login as a standalone page, unsuccessful authentication attempts should be redirected to a login form created by the website for this purpose, using the <code class=\"directive\"><a href=\"#authformloginrequiredlocation\">AuthFormLoginRequiredLocation</a></code> directive. Typically this login page will contain an HTML form, asking the user to provide their usename and password.</p> <div class=\"example\">\n<h3>Example login form</h3>\n<pre class=\"prettyprint lang-html\">&lt;form method=\"POST\" action=\"/dologin.html\"&gt;\n  Username: &lt;input type=\"text\" name=\"httpd_username\" value=\"\" /&gt;\n  Password: &lt;input type=\"password\" name=\"httpd_password\" value=\"\" /&gt;\n  &lt;input type=\"submit\" name=\"login\" value=\"Login\" /&gt;\n&lt;/form&gt;</pre> </div> <p>The part that does the actual login is handled by the <var>form-login-handler</var>. The action of the form should point at this handler, which is configured within Apache httpd as follows:</p> <div class=\"example\">\n<h3>Form login handler example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/dologin.html\"&gt;\n    SetHandler form-login-handler\n    AuthFormLoginRequiredLocation \"http://example.com/login.html\"\n    AuthFormLoginSuccessLocation \"http://example.com/admin/index.html\"\n    AuthFormProvider file\n    AuthUserFile \"conf/passwd\"\n    AuthType form\n    AuthName /admin\n    Session On\n    SessionCookieName session path=/\n&lt;/Location&gt;</pre> </div> <p>The URLs specified by the <code class=\"directive\"><a href=\"#authformloginrequiredlocation\">AuthFormLoginRequiredLocation</a></code> directive will typically point to a page explaining to the user that their login attempt was unsuccessful, and they should try again. The <code class=\"directive\"><a href=\"#authformloginsuccesslocation\">AuthFormLoginSuccessLocation</a></code> directive specifies the URL the user should be redirected to upon successful login.</p> <p>Alternatively, the URL to redirect the user to on success can be embedded within the login form, as in the example below. As a result, the same <var>form-login-handler</var> can be reused for different areas of a website.</p> <div class=\"example\">\n<h3>Example login form with location</h3>\n<pre class=\"prettyprint lang-html\">&lt;form method=\"POST\" action=\"/dologin.html\"&gt;\n  Username: &lt;input type=\"text\" name=\"httpd_username\" value=\"\" /&gt;\n  Password: &lt;input type=\"password\" name=\"httpd_password\" value=\"\" /&gt;\n  &lt;input type=\"submit\" name=\"login\" value=\"Login\" /&gt;\n  &lt;input type=\"hidden\" name=\"httpd_location\" value=\"http://example.com/success.html\" /&gt;\n&lt;/form&gt;</pre> </div>   <h2 id=\"inline\">Inline Login</h2> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>A risk exists that under certain circumstances, the login form configured using inline login may be submitted more than once, revealing login credentials to the application running underneath. The administrator must ensure that the underlying application is properly secured to prevent abuse. If in doubt, use the standalone login configuration.</p> </div> <p>As an alternative to having a dedicated login page for a website, it is possible to configure <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> to authenticate users inline, without being redirected to another page. This allows the state of the current page to be preserved during the login attempt. This can be useful in a situation where a time limited session is in force, and the session times out in the middle of the user request. The user can be re-authenticated in place, and they can continue where they left off.</p> <p>If a non-authenticated user attempts to access a page protected by <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> that isn't configured with a <code class=\"directive\"><a href=\"#authformloginrequiredlocation\">AuthFormLoginRequiredLocation</a></code> directive, a <var>HTTP_UNAUTHORIZED</var> status code is returned to the browser indicating to the user that they are not authorized to view the page.</p> <p>To configure inline authentication, the administrator overrides the error document returned by the <var>HTTP_UNAUTHORIZED</var> status code with a custom error document containing the login form, as follows:</p> <div class=\"example\">\n<h3>Basic inline example</h3>\n<pre class=\"prettyprint lang-config\">AuthFormProvider file\nErrorDocument 401 \"/login.shtml\"\nAuthUserFile \"conf/passwd\"\nAuthType form\nAuthName realm\nAuthFormLoginRequiredLocation \"http://example.com/login.html\"\nSession On\nSessionCookieName session path=/</pre> </div> <p>The error document page should contain a login form with an empty action property, as per the example below. This has the effect of submitting the form to the original protected URL, without the page having to know what that URL is.</p> <div class=\"example\">\n<h3>Example inline login form</h3>\n<pre class=\"prettyprint lang-html\">&lt;form method=\"POST\" <strong>action=\"\"</strong>&gt;\n  Username: &lt;input type=\"text\" name=\"httpd_username\" value=\"\" /&gt;\n  Password: &lt;input type=\"password\" name=\"httpd_password\" value=\"\" /&gt;\n  &lt;input type=\"submit\" name=\"login\" value=\"Login\" /&gt;\n&lt;/form&gt;</pre> </div> <p>When the end user has filled in their login details, the form will make an HTTP POST request to the original password protected URL. <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> will intercept this POST request, and if HTML fields are found present for the username and password, the user will be logged in, and the original password protected URL will be returned to the user as a GET request.</p>   <h2 id=\"inlinepreservebody\">Inline Login with Body Preservation</h2> <p>A limitation of the inline login technique described above is that should an HTML form POST have resulted in the request to authenticate or reauthenticate, the contents of the original form posted by the browser will be lost. Depending on the function of the website, this could present significant inconvenience for the end user.</p> <p><code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> addresses this by allowing the method and body of the original request to be embedded in the login form. If authentication is successful, the original method and body will be retried by Apache httpd, preserving the state of the original request.</p> <p>To enable body preservation, add three additional fields to the login form as per the example below.</p> <div class=\"example\">\n<h3>Example with body preservation</h3>\n<pre class=\"prettyprint lang-html\">&lt;form method=\"POST\" action=\"\"&gt;\n  Username: &lt;input type=\"text\" name=\"httpd_username\" value=\"\" /&gt;\n  Password: &lt;input type=\"password\" name=\"httpd_password\" value=\"\" /&gt;\n  &lt;input type=\"submit\" name=\"login\" value=\"Login\" /&gt;\n  <br>  <strong>&lt;input type=\"hidden\" name=\"httpd_method\" value=\"POST\" /&gt;\n  &lt;input type=\"hidden\" name=\"httpd_mimetype\" value=\"application/x-www-form-urlencoded\" /&gt;\n  &lt;input type=\"hidden\" name=\"httpd_body\" value=\"name1=value1&amp;name2=value2\" /&gt;</strong><br>\n&lt;/form&gt;</pre> </div> <p>How the method, mimetype and body of the original request are embedded within the login form will depend on the platform and technology being used within the website. </p> <p>One option is to use the <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> module along with the <code class=\"directive\"><a href=\"mod_request#keptbodysize\">KeptBodySize</a></code> directive, along with a suitable CGI script to embed the variables in the form.</p> <p>Another option is to render the login form using a CGI script or other dynamic technology.</p> <div class=\"example\">\n<h3>CGI example</h3>\n<pre class=\"prettyprint lang-config\">        AuthFormProvider file\n        ErrorDocument 401 \"/cgi-bin/login.cgi\"\n        ...</pre> </div>   <h2 id=\"loggingout\">Logging Out</h2> <p>To enable a user to log out of a particular session, configure a page to be handled by the <var>form-logout-handler</var>. Any attempt to access this URL will cause the username and password to be removed from the current session, effectively logging the user out.</p> <p>By setting the <code class=\"directive\"><a href=\"#authformlogoutlocation\">AuthFormLogoutLocation</a></code> directive, a URL can be specified that the browser will be redirected to on successful logout. This URL might explain to the user that they have been logged out, and give the user the option to log in again.</p> <div class=\"example\">\n<h3>Basic logout example</h3>\n<pre class=\"prettyprint lang-config\">SetHandler form-logout-handler\nAuthName realm\nAuthFormLogoutLocation \"http://example.com/loggedout.html\"\nSession On\nSessionCookieName session path=/</pre> </div> <p>Note that logging a user out does not delete the session; it merely removes the username and password from the session. If this results in an empty session, the net effect will be the removal of that session, but this is not guaranteed. If you want to guarantee the removal of a session, set the <code class=\"directive\"><a href=\"mod_session#sessionmaxage\">SessionMaxAge</a></code> directive to a small value, like 1 (setting the directive to zero would mean no session age limit). </p> <div class=\"example\">\n<h3>Basic session expiry example</h3>\n<pre class=\"prettyprint lang-config\">SetHandler form-logout-handler\nAuthFormLogoutLocation \"http://example.com/loggedout.html\"\nSession On\nSessionMaxAge 1\nSessionCookieName session path=/</pre> </div>   <h2 id=\"urlencoding\">Usernames and Passwords</h2> <p>Note that form submission involves URLEncoding the form data: in this case the username and password. You should therefore pick usernames and passwords that avoid characters that are URLencoded in form submission, or you may get unexpected results.</p>   <div class=\"directive-section\">\n<h2 id=\"authformauthoritative\">AuthFormAuthoritative Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets whether authorization and authentication are passed to lower level modules</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormAuthoritative On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthFormAuthoritative On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> </table> <p>Normally, each authorization module listed in <code class=\"directive\"><a href=\"#authformprovider\">AuthFormProvider</a></code> will attempt to verify the user, and if the user is not found in any provider, access will be denied. Setting the <code class=\"directive\">AuthFormAuthoritative</code> directive explicitly to <code>Off</code> allows for both authentication and authorization to be passed on to other non-provider-based modules if there is <strong>no userID</strong> or <strong>rule</strong> matching the supplied userID. This should only be necessary when combining <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> with third-party modules that are not configured with the <code class=\"directive\"><a href=\"#authformprovider\">AuthFormProvider</a></code> directive. When using such modules, the order of processing is determined in the modules' source code and is not configurable.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformbody\">AuthFormBody Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The name of a form field carrying the body of the request to attempt on successful login</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormBody fieldname</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>httpd_body</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformmethod\">AuthFormMethod</a></code> directive specifies the name of an HTML field which, if present, will contain the method of the request to to submit should login be successful.</p> <p>By populating the form with fields described by <code class=\"directive\"><a href=\"#authformmethod\">AuthFormMethod</a></code>, <code class=\"directive\"><a href=\"#authformmimetype\">AuthFormMimetype</a></code> and <code class=\"directive\"><a href=\"#authformbody\">AuthFormBody</a></code>, a website can retry a request that may have been interrupted by the login screen, or by a session timeout.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformdisablenostore\">AuthFormDisableNoStore Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Disable the CacheControl no-store header on the login page</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormDisableNoStore On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthFormDisableNoStore Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformdisablenostore\">AuthFormDisableNoStore</a></code> flag disables the sending of a <code>Cache-Control no-store</code> header with the error 401 page returned when the user is not yet logged in. The purpose of the header is to make it difficult for an <code>ecmascript</code> application to attempt to resubmit the login form, and reveal the username and password to the backend application. Disable at your own risk.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformfakebasicauth\">AuthFormFakeBasicAuth Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Fake a Basic Authentication header</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormFakeBasicAuth On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthFormFakeBasicAuth Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformfakebasicauth\">AuthFormFakeBasicAuth</a></code> flag determines whether a <code>Basic Authentication</code> header will be added to the request headers. This can be used to expose the username and password to an underlying application, without the underlying application having to be aware of how the login was achieved.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformlocation\">AuthFormLocation Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The name of a form field carrying a URL to redirect to on successful login</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormLocation fieldname</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>httpd_location</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformlocation\">AuthFormLocation</a></code> directive specifies the name of an HTML field which, if present, will contain a URL to redirect the browser to should login be successful.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformloginrequiredlocation\">AuthFormLoginRequiredLocation Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The URL of the page to be redirected to should login be required</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormLoginRequiredLocation url</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later. The use of the expression parser has been added in 2.4.4.</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformloginrequiredlocation\">AuthFormLoginRequiredLocation</a></code> directive specifies the URL to redirect to should the user not be authorised to view a page. The value is parsed using the <a href=\"../expr\">ap_expr</a> parser before being sent to the client. By default, if a user is not authorised to view a page, the HTTP response code <code>HTTP_UNAUTHORIZED</code> will be returned with the page specified by the <code class=\"directive\"><a href=\"core#errordocument\">ErrorDocument</a></code> directive. This directive overrides this default.</p> <p>Use this directive if you have a dedicated login page to redirect users to.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformloginsuccesslocation\">AuthFormLoginSuccessLocation Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The URL of the page to be redirected to should login be successful</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormLoginSuccessLocation url</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later. The use of the expression parser has been added in 2.4.4.</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformloginsuccesslocation\">AuthFormLoginSuccessLocation</a></code> directive specifies the URL to redirect to should the user have logged in successfully. The value is parsed using the <a href=\"../expr\">ap_expr</a> parser before being sent to the client. This directive can be overridden if a form field has been defined containing another URL using the <code class=\"directive\"><a href=\"#authformlocation\">AuthFormLocation</a></code> directive.</p> <p>Use this directive if you have a dedicated login URL, and you have not embedded the destination page in the login form.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformlogoutlocation\">AuthFormLogoutLocation Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The URL to redirect to after a user has logged out</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormLogoutLocation uri</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later. The use of the expression parser has been added in 2.4.4.</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformlogoutlocation\">AuthFormLogoutLocation</a></code> directive specifies the URL of a page on the server to redirect to should the user attempt to log out. The value is parsed using the <a href=\"../expr\">ap_expr</a> parser before being sent to the client.</p> <p>When a URI is accessed that is served by the handler <code>form-logout-handler</code>, the page specified by this directive will be shown to the end user. For example:</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/logout\"&gt;\n    SetHandler form-logout-handler\n    AuthFormLogoutLocation \"http://example.com/loggedout.html\"\n    Session on\n    #...\n&lt;/Location&gt;</pre> </div> <p>An attempt to access the URI <var>/logout/</var> will result in the user being logged out, and the page <var>/loggedout.html</var> will be displayed. Make sure that the page <var>loggedout.html</var> is not password protected, otherwise the page will not be displayed.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformmethod\">AuthFormMethod Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The name of a form field carrying the method of the request to attempt on successful login</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormMethod fieldname</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>httpd_method</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformmethod\">AuthFormMethod</a></code> directive specifies the name of an HTML field which, if present, will contain the method of the request to to submit should login be successful.</p> <p>By populating the form with fields described by <code class=\"directive\"><a href=\"#authformmethod\">AuthFormMethod</a></code>, <code class=\"directive\"><a href=\"#authformmimetype\">AuthFormMimetype</a></code> and <code class=\"directive\"><a href=\"#authformbody\">AuthFormBody</a></code>, a website can retry a request that may have been interrupted by the login screen, or by a session timeout.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformmimetype\">AuthFormMimetype Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The name of a form field carrying the mimetype of the body of the request to attempt on successful login</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormMimetype fieldname</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>httpd_mimetype</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformmethod\">AuthFormMethod</a></code> directive specifies the name of an HTML field which, if present, will contain the mimetype of the request to submit should login be successful.</p> <p>By populating the form with fields described by <code class=\"directive\"><a href=\"#authformmethod\">AuthFormMethod</a></code>, <code class=\"directive\"><a href=\"#authformmimetype\">AuthFormMimetype</a></code> and <code class=\"directive\"><a href=\"#authformbody\">AuthFormBody</a></code>, a website can retry a request that may have been interrupted by the login screen, or by a session timeout.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformpassword\">AuthFormPassword Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The name of a form field carrying the login password</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormPassword fieldname</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>httpd_password</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformpassword\">AuthFormPassword</a></code> directive specifies the name of an HTML field which, if present, will contain the password to be used to log in.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformprovider\">AuthFormProvider Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the authentication provider(s) for this location</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormProvider provider-name [provider-name] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthFormProvider file</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> </table> <p>The <code class=\"directive\">AuthFormProvider</code> directive sets which provider is used to authenticate the users for this location. The default <code>file</code> provider is implemented by the <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> module. Make sure that the chosen provider module is present in the server.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/secure\"&gt;\n    AuthType form\n    AuthName \"private area\"\n    AuthFormProvider  dbm\n    AuthDBMType        SDBM\n    AuthDBMUserFile    \"/www/etc/dbmpasswd\"\n    Require            valid-user\n    #...\n&lt;/Location&gt;</pre> </div> <p>Providers are implemented by <code class=\"module\"><a href=\"mod_authn_dbm\">mod_authn_dbm</a></code>, <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code>, <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code>, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> and <code class=\"module\"><a href=\"mod_authn_socache\">mod_authn_socache</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformsitepassphrase\">AuthFormSitePassphrase Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Bypass authentication checks for high traffic sites</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormSitePassphrase secret</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformsitepassphrase\">AuthFormSitePassphrase</a></code> directive specifies a passphrase which, if present in the user session, causes Apache httpd to bypass authentication checks for the given URL. It can be used on high traffic websites to reduce the load induced on authentication infrastructure.</p> <p>The passphrase can be inserted into a user session by adding this directive to the configuration for the <var>form-login-handler</var>. The <var>form-login-handler</var> itself will always run the authentication checks, regardless of whether a passphrase is specified or not.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>If the session is exposed to the user through the use of <code class=\"module\"><a href=\"mod_session_cookie\">mod_session_cookie</a></code>, and the session is not protected with <code class=\"module\"><a href=\"mod_session_crypto\">mod_session_crypto</a></code>, the passphrase is open to potential exposure through a dictionary attack. Regardless of how the session is configured, ensure that this directive is not used within URL spaces where private user data could be exposed, or sensitive transactions can be conducted. Use at own risk.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"authformsize\">AuthFormSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The largest size of the form in bytes that will be parsed for the login details</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormSize size</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>8192</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformsize\">AuthFormSize</a></code> directive specifies the maximum size of the body of the request that will be parsed to find the login form.</p> <p>If a login request arrives that exceeds this size, the whole request will be aborted with the HTTP response code <code>HTTP_REQUEST_TOO_LARGE</code>.</p> <p>If you have populated the form with fields described by <code class=\"directive\"><a href=\"#authformmethod\">AuthFormMethod</a></code>, <code class=\"directive\"><a href=\"#authformmimetype\">AuthFormMimetype</a></code> and <code class=\"directive\"><a href=\"#authformbody\">AuthFormBody</a></code>, you probably want to set this field to a similar size as the <code class=\"directive\"><a href=\"mod_request#keptbodysize\">KeptBodySize</a></code> directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authformusername\">AuthFormUsername Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The name of a form field carrying the login username</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthFormUsername fieldname</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>httpd_username</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_auth_form</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#authformusername\">AuthFormUsername</a></code> directive specifies the name of an HTML field which, if present, will contain the username to be used to log in.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_auth_form.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_auth_form.html</a>\n  </p>\n</div>\n","mod/mod_authz_dbd":"<h1>Apache Module mod_authz_dbd</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Group Authorization and Login using SQL</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authz_dbd_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authz_dbd.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authorization capabilities so that authenticated users can be allowed or denied access to portions of the web site by group membership. Similar functionality is provided by <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> and <code class=\"module\"><a href=\"mod_authz_dbm\">mod_authz_dbm</a></code>, with the exception that this module queries a SQL database to determine whether a user is a member of a group.</p> <p>This module can also provide database-backed user login/logout capabilities. These are likely to be of most value when used in conjunction with <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code>.</p> <p>This module relies on <code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> to specify the backend database driver and connection parameters, and manage the database connections.</p>     <h2 id=\"requiredirectives\">The Require Directives</h2> <p>Apache's <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives are used during the authorization phase to ensure that a user is allowed to access a resource. mod_authz_dbd extends the authorization types with <code>dbd-group</code>, <code>dbd-login</code> and <code>dbd-logout</code>.</p> <p>Since v2.4.8, <a href=\"../expr\">expressions</a> are supported within the DBD require directives.</p> <h3><a name=\"reqgroup\" id=\"reqgroup\">Require dbd-group</a></h3> <p>This directive specifies group membership that is required for the user to gain access.</p> <pre class=\"prettyprint lang-config\">      Require dbd-group team\n      AuthzDBDQuery \"SELECT group FROM authz WHERE user = %s\"</pre> <h3><a name=\"reqlogin\" id=\"reqlogin\">Require dbd-login</a></h3> <p>This directive specifies a query to be run indicating the user has logged in.</p> <pre class=\"prettyprint lang-config\">      Require dbd-login\n      AuthzDBDQuery \"UPDATE authn SET login = 'true' WHERE user = %s\"</pre> <h3><a name=\"reqlogout\" id=\"reqlogout\">Require dbd-logout</a></h3> <p>This directive specifies a query to be run indicating the user has logged out.</p> <pre class=\"prettyprint lang-config\">      Require dbd-logout\n      AuthzDBDQuery \"UPDATE authn SET login = 'false' WHERE user = %s\"</pre>   <h2 id=\"login\">Database Login</h2> <p> In addition to the standard authorization function of checking group membership, this module can also provide server-side user session management via database-backed login/logout capabilities. Specifically, it can update a user's session status in the database whenever the user visits designated URLs (subject of course to users supplying the necessary credentials).</p> <p>This works by defining two special <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> types: <code>Require dbd-login</code> and <code>Require dbd-logout</code>. For usage details, see the configuration example below.</p>   <h2 id=\"client\">Client Login integration</h2> <p>Some administrators may wish to implement client-side session management that works in concert with the server-side login/logout capabilities offered by this module, for example, by setting or unsetting an HTTP cookie or other such token when a user logs in or out.</p> <p>To support such integration, <code class=\"module\"><a href=\"mod_authz_dbd\">mod_authz_dbd</a></code> exports an optional hook that will be run whenever a user's status is updated in the database. Other session management modules can then use the hook to implement functions that start and end client-side sessions.</p>   <h2 id=\"example\">Configuration example</h2> <pre class=\"prettyprint lang-config\"># mod_dbd configuration\nDBDriver pgsql\nDBDParams \"dbname=apacheauth user=apache pass=xxxxxx\"\n\nDBDMin  4\nDBDKeep 8\nDBDMax  20\nDBDExptime 300\n\n&lt;Directory \"/usr/www/my.site/team-private/\"&gt;\n  # mod_authn_core and mod_auth_basic configuration\n  # for mod_authn_dbd\n  AuthType Basic\n  AuthName Team\n  AuthBasicProvider dbd\n\n  # mod_authn_dbd SQL query to authenticate a logged-in user\n  AuthDBDUserPWQuery \\\n    \"SELECT password FROM authn WHERE user = %s AND login = 'true'\"\n\n  # mod_authz_core configuration for mod_authz_dbd\n  Require dbd-group team\n\n  # mod_authz_dbd configuration\n  AuthzDBDQuery \"SELECT group FROM authz WHERE user = %s\"\n\n  # when a user fails to be authenticated or authorized,\n  # invite them to login; this page should provide a link\n  # to /team-private/login.html\n  ErrorDocument 401 \"/login-info.html\"\n\n  &lt;Files \"login.html\"&gt;\n    # don't require user to already be logged in!\n    AuthDBDUserPWQuery \"SELECT password FROM authn WHERE user = %s\"\n\n    # dbd-login action executes a statement to log user in\n    Require dbd-login\n    AuthzDBDQuery \"UPDATE authn SET login = 'true' WHERE user = %s\"\n\n    # return user to referring page (if any) after\n    # successful login\n    AuthzDBDLoginToReferer On\n  &lt;/Files&gt;\n\n  &lt;Files \"logout.html\"&gt;\n    # dbd-logout action executes a statement to log user out\n    Require dbd-logout\n    AuthzDBDQuery \"UPDATE authn SET login = 'false' WHERE user = %s\"\n  &lt;/Files&gt;\n&lt;/Directory&gt;</pre>   <div class=\"directive-section\">\n<h2 id=\"authzdbdlogintoreferer\">AuthzDBDLoginToReferer Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether to redirect the Client to the Referring page on successful login or logout if a <code>Referer</code> request header is present</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthzDBDLoginToReferer On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthzDBDLoginToReferer Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_dbd</td>\n</tr> </table> <p>In conjunction with <code>Require dbd-login</code> or <code>Require dbd-logout</code>, this provides the option to redirect the client back to the Referring page (the URL in the <code>Referer</code> HTTP request header, if present). When there is no <code>Referer</code> header, <code>AuthzDBDLoginToReferer On</code> will be ignored.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authzdbdquery\">AuthzDBDQuery Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify the SQL Query for the required operation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthzDBDQuery query</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">AuthzDBDQuery</code> specifies an SQL query to run. The purpose of the query depends on the <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive in effect.</p> <ul> <li>When used with a <code>Require dbd-group</code> directive, it specifies a query to look up groups for the current user. This is the standard functionality of other authorization modules such as <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> and <code class=\"module\"><a href=\"mod_authz_dbm\">mod_authz_dbm</a></code>. The first column value of each row returned by the query statement should be a string containing a group name. Zero, one, or more rows may be returned. <pre class=\"prettyprint lang-config\">Require dbd-group\nAuthzDBDQuery \"SELECT group FROM groups WHERE user = %s\"</pre> </li> <li>When used with a <code>Require dbd-login</code> or <code>Require dbd-logout</code> directive, it will never deny access, but will instead execute a SQL statement designed to log the user in or out. The user must already be authenticated with <code class=\"module\"><a href=\"mod_authn_dbd\">mod_authn_dbd</a></code>. <pre class=\"prettyprint lang-config\">Require dbd-login\nAuthzDBDQuery \"UPDATE authn SET login = 'true' WHERE user = %s\"</pre> </li> </ul> <p>In all cases, the user's ID will be passed as a single string parameter when the SQL query is executed. It may be referenced within the query statement using a <code>%s</code> format specifier.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authzdbdredirectquery\">AuthzDBDRedirectQuery Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify a query to look up a login page for the user</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthzDBDRedirectQuery query</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_dbd</td>\n</tr> </table> <p>Specifies an optional SQL query to use after successful login (or logout) to redirect the user to a URL, which may be specific to the user. The user's ID will be passed as a single string parameter when the SQL query is executed. It may be referenced within the query statement using a <code>%s</code> format specifier.</p> <pre class=\"prettyprint lang-config\">AuthzDBDRedirectQuery \"SELECT userpage FROM userpages WHERE user = %s\"</pre> <p>The first column value of the first row returned by the query statement should be a string containing a URL to which to redirect the client. Subsequent rows will be ignored. If no rows are returned, the client will not be redirected.</p> <p>Note that <code class=\"directive\">AuthzDBDLoginToReferer</code> takes precedence if both are set.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authz_dbd.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authz_dbd.html</a>\n  </p>\n</div>\n","mod/mod_authz_host":"<h1>Apache Module mod_authz_host</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Group authorizations based on host (name or IP address)</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authz_host_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authz_host.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The <code>forward-dns</code> provider was addded in 2.4.19</td>\n</tr>\n</table> <h3>Summary</h3> <p>The authorization providers implemented by <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code> are registered using the <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive. The directive can be referenced within a <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code>, <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code>, or <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> section as well as <code><a href=\"core#accessfilename\">.htaccess</a></code> files to control access to particular parts of the server. Access can be controlled based on the client hostname or IP address.</p> <p>In general, access restriction directives apply to all access methods (<code>GET</code>, <code>PUT</code>, <code>POST</code>, etc). This is the desired behavior in most cases. However, it is possible to restrict some methods, while leaving other methods unrestricted, by enclosing the directives in a <code class=\"directive\"><a href=\"core#limit\">&lt;Limit&gt;</a></code> section.</p>     <h2 id=\"requiredirectives\">The Require Directives</h2> <p>Apache's <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive is used during the authorization phase to ensure that a user is allowed or denied access to a resource. mod_authz_host extends the authorization types with <code>ip</code>, <code>host</code>, <code>forward-dns</code> and <code>local</code>. Other authorization types may also be used but may require that additional authorization modules be loaded.</p> <p>These authorization providers affect which hosts can access an area of the server. Access can be controlled by hostname, IP Address, or IP Address range.</p> <p>Since v2.4.8, <a href=\"../expr\">expressions</a> are supported within the host require directives.</p> <h3><a name=\"reqip\" id=\"reqip\">Require ip</a></h3> <p>The <code>ip</code> provider allows access to the server to be controlled based on the IP address of the remote client. When <code>Require ip ip-address</code> is specified, then the request is allowed access if the IP address matches.</p> <p>A full IP address:</p> <pre class=\"prettyprint lang-config\">Require ip 10.1.2.3\nRequire ip 192.168.1.104 192.168.1.205</pre> <p>An IP address of a host allowed access</p> <p>A partial IP address:</p> <pre class=\"prettyprint lang-config\">Require ip 10.1\nRequire ip 10 172.20 192.168.2</pre> <p>The first 1 to 3 bytes of an IP address, for subnet restriction.</p> <p>A network/netmask pair:</p> <pre class=\"prettyprint lang-config\">Require ip 10.1.0.0/255.255.0.0</pre> <p>A network a.b.c.d, and a netmask w.x.y.z. For more fine-grained subnet restriction.</p> <p>A network/nnn CIDR specification:</p> <pre class=\"prettyprint lang-config\">Require ip 10.1.0.0/16</pre> <p>Similar to the previous case, except the netmask consists of nnn high-order 1 bits.</p> <p>Note that the last three examples above match exactly the same set of hosts.</p> <p>IPv6 addresses and IPv6 subnets can be specified as shown below:</p> <pre class=\"prettyprint lang-config\">Require ip 2001:db8::a00:20ff:fea7:ccea\nRequire ip 2001:db8:1:1::a\nRequire ip 2001:db8:2:1::/64\nRequire ip 2001:db8:3::/48</pre> <p>Note: As the IP addresses are parsed on startup, expressions are not evaluated at request time.</p> <h3><a name=\"reqhost\" id=\"reqhost\">Require host</a></h3> <p>The <code>host</code> provider allows access to the server to be controlled based on the host name of the remote client. When <code>Require host host-name</code> is specified, then the request is allowed access if the host name matches.</p> <p>A (partial) domain-name</p> <pre class=\"prettyprint lang-config\">Require host example.org\nRequire host .net example.edu</pre> <p>Hosts whose names match, or end in, this string are allowed access. Only complete components are matched, so the above example will match <code>foo.example.org</code> but it will not match <code>fooexample.org</code>. This configuration will cause Apache to perform a double reverse DNS lookup on the client IP address, regardless of the setting of the <code class=\"directive\"><a href=\"core#hostnamelookups\">HostnameLookups</a></code> directive. It will do a reverse DNS lookup on the IP address to find the associated hostname, and then do a forward lookup on the hostname to assure that it matches the original IP address. Only if the forward and reverse DNS are consistent and the hostname matches will access be allowed.</p> <h3><a name=\"reqfwddns\" id=\"reqfwddns\">Require forward-dns</a></h3> <p>The <code>forward-dns</code> provider allows access to the server to be controlled based on simple host names. When <code>Require forward-dns host-name</code> is specified, all IP addresses corresponding to <code>host-name</code> are allowed access.</p> <p>In contrast to the <code>host</code> provider, this provider does not rely on reverse DNS lookups: it simply queries the DNS for the host name and allows a client if its IP matches. As a consequence, it will only work with host names, not domain names. However, as the reverse DNS is not used, it will work with clients which use a dynamic DNS service.</p> <pre class=\"prettyprint lang-config\">Require forward-dns bla.example.org</pre> <p>A client the IP of which is resolved from the name <code>bla.example.org</code> will be granted access.</p> <p>The <code>forward-dns</code> provider was added in 2.4.19.</p> <h3><a name=\"reqlocal\" id=\"reqlocal\">Require local</a></h3> <p>The <code>local</code> provider allows access to the server if any of the following conditions is true:</p> <ul> <li>the client address matches 127.0.0.0/8</li> <li>the client address is ::1</li> <li>both the client and the server address of the connection are the same</li> </ul> <p>This allows a convenient way to match connections that originate from the local host:</p> <pre class=\"prettyprint lang-config\">Require local</pre> <h3><a name=\"proxy\" id=\"proxy\">Security Note</a></h3> <p>If you are proxying content to your server, you need to be aware that the client address will be the address of your proxy server, not the address of the client, and so using the <code>Require</code> directive in this context may not do what you mean. See <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> for one possible solution to this problem.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authz_host.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authz_host.html</a>\n  </p>\n</div>\n","mod/mod_authz_owner":"<h1>Apache Module mod_authz_owner</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Authorization based on file ownership</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authz_owner_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authz_owner.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module authorizes access to files by comparing the userid used for HTTP authentication (the web userid) with the file-system owner or group of the requested file. The supplied username and password must be already properly verified by an authentication module, such as <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code>. <code class=\"module\"><a href=\"mod_authz_owner\">mod_authz_owner</a></code> recognizes two arguments for the <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive, <code>file-owner</code> and <code>file-group</code>, as follows:</p> <dl> <dt><code>file-owner</code></dt> <dd>The supplied web-username must match the system's name for the owner of the file being requested. That is, if the operating system says the requested file is owned by <code>jones</code>, then the username used to access it through the web must be <code>jones</code> as well.</dd> <dt><code>file-group</code></dt> <dd>The name of the system group that owns the file must be present in a group database, which is provided, for example, by <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> or <code class=\"module\"><a href=\"mod_authz_dbm\">mod_authz_dbm</a></code>, and the web-username must be a member of that group. For example, if the operating system says the requested file is owned by (system) group <code>accounts</code>, the group <code>accounts</code> must appear in the group database and the web-username used in the request must be a member of that group.</dd> </dl> <div class=\"note\">\n<p><strong>Note</strong></p> <p>If <code class=\"module\"><a href=\"mod_authz_owner\">mod_authz_owner</a></code> is used in order to authorize a resource that is not actually present in the filesystem (<em>i.e.</em> a virtual resource), it will deny the access.</p> <p>Particularly it will never authorize <a href=\"../content-negotiation#multiviews\">content negotiated \"MultiViews\"</a> resources.</p> </div>     <h2 id=\"examples\">Configuration Examples</h2> <h3><a name=\"examples.file-owner\" id=\"examples.file-owner\">Require file-owner</a></h3> <p>Consider a multi-user system running the Apache Web server, with each user having his or her own files in <code>~/public_html/private</code>. Assuming that there is a single <code class=\"directive\"><a href=\"mod_authn_dbm#authdbmuserfile\">AuthDBMUserFile</a></code> database that lists all of their web-usernames, and that these usernames match the system's usernames that actually own the files on the server, then the following stanza would allow only the user himself access to his own files. User <code>jones</code> would not be allowed to access files in <code>/home/smith/public_html/private</code> unless they were owned by <code>jones</code> instead of <code>smith</code>.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/home/*/public_html/private\"&gt;\n    AuthType Basic\n    AuthName MyPrivateFiles\n    AuthBasicProvider dbm\n    AuthDBMUserFile \"/usr/local/apache2/etc/.htdbm-all\"\n    Require file-owner\n&lt;/Directory&gt;</pre> <h3><a name=\"examples.file-group\" id=\"examples.file-group\">Require file-group</a></h3> <p>Consider a system similar to the one described above, but with some users that share their project files in <code>~/public_html/project-foo</code>. The files are owned by the system group <code>foo</code> and there is a single <code class=\"directive\"><a href=\"mod_authz_dbm#authdbmgroupfile\">AuthDBMGroupFile</a></code> database that contains all of the web-usernames and their group membership, <em>i.e.</em> they must be at least member of a group named <code>foo</code>. So if <code>jones</code> and <code>smith</code> are both member of the group <code>foo</code>, then both will be authorized to access the <code>project-foo</code> directories of each other.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/home/*/public_html/project-foo\"&gt;\n    AuthType Basic\n    AuthName \"Project Foo Files\"\n    AuthBasicProvider dbm\n    \n    # combined user/group database\n    AuthDBMUserFile  \"/usr/local/apache2/etc/.htdbm-all\"\n    AuthDBMGroupFile \"/usr/local/apache2/etc/.htdbm-all\"\n    \n    Satisfy All\n    Require file-group\n&lt;/Directory&gt;</pre><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authz_owner.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authz_owner.html</a>\n  </p>\n</div>\n","mod/mod_authz_core":"<h1>Apache Module mod_authz_core</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Core Authorization</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authz_core_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authz_core.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTPD 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides core authorization capabilities so that authenticated users can be allowed or denied access to portions of the web site. <code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code> provides the functionality to register various authorization providers. It is usually used in conjunction with an authentication provider module such as <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> and an authorization module such as <code class=\"module\"><a href=\"mod_authz_user\">mod_authz_user</a></code>. It also allows for advanced logic to be applied to the authorization processing.</p>     <h2 id=\"authzalias\">Creating Authorization Provider Aliases</h2> <p>Extended authorization providers can be created within the configuration file and assigned an alias name. The alias providers can then be referenced through the <code class=\"directive\"><a href=\"#require\">Require</a></code> directive in the same way as a base authorization provider. Besides the ability to create and alias an extended provider, it also allows the same extended authorization provider to be referenced by multiple locations. </p> <h3><a name=\"example\" id=\"example\">Example</a></h3> <p>The example below creates two different ldap authorization provider aliases based on the ldap-group authorization provider. This example allows a single authorization location to check group membership within multiple ldap hosts: </p> <pre class=\"prettyprint lang-config\">&lt;AuthzProviderAlias ldap-group ldap-group-alias1 cn=my-group,o=ctx&gt;\n    AuthLDAPBindDN cn=youruser,o=ctx\n    AuthLDAPBindPassword yourpassword\n    AuthLDAPURL ldap://ldap.host/o=ctx\n&lt;/AuthzProviderAlias&gt;\n\n&lt;AuthzProviderAlias ldap-group ldap-group-alias2 cn=my-other-group,o=dev&gt;\n    AuthLDAPBindDN cn=yourotheruser,o=dev\n    AuthLDAPBindPassword yourotherpassword\n    AuthLDAPURL ldap://other.ldap.host/o=dev?cn\n&lt;/AuthzProviderAlias&gt;\n\nAlias \"/secure\" \"/webpages/secure\"\n&lt;Directory \"/webpages/secure\"&gt;\n    Require all granted\n    \n    AuthBasicProvider file\n    \n    AuthType Basic\n    AuthName LDAP_Protected_Place\n    \n    #implied OR operation\n    Require ldap-group-alias1\n    Require ldap-group-alias2\n&lt;/Directory&gt;</pre>   <h2 id=\"logic\">Authorization Containers</h2> <p>The authorization container directives <code class=\"directive\"><a href=\"#requireall\">&lt;RequireAll&gt;</a></code>, <code class=\"directive\"><a href=\"#requireany\">&lt;RequireAny&gt;</a></code> and <code class=\"directive\"><a href=\"#requirenone\">&lt;RequireNone&gt;</a></code> may be combined with each other and with the <code class=\"directive\"><a href=\"#require\">Require</a></code> directive to express complex authorization logic.</p> <p>The example below expresses the following authorization logic. In order to access the resource, the user must either be the <code>superadmin</code> user, or belong to both the <code>admins</code> group and the <code>Administrators</code> LDAP group and either belong to the <code>sales</code> group or have the LDAP <code>dept</code> attribute <code>sales</code>. Furthermore, in order to access the resource, the user must not belong to either the <code>temps</code> group or the LDAP group <code>Temporary Employees</code>.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/mydocs\"&gt;\n    &lt;RequireAll&gt;\n        &lt;RequireAny&gt;\n            Require user superadmin\n            &lt;RequireAll&gt;\n                Require group admins\n                Require ldap-group cn=Administrators,o=Airius\n                &lt;RequireAny&gt;\n                    Require group sales\n                    Require ldap-attribute dept=\"sales\"\n                &lt;/RequireAny&gt;\n            &lt;/RequireAll&gt;\n        &lt;/RequireAny&gt;\n        &lt;RequireNone&gt;\n            Require group temps\n            Require ldap-group cn=Temporary Employees,o=Airius\n        &lt;/RequireNone&gt;\n    &lt;/RequireAll&gt;\n&lt;/Directory&gt;</pre>   <h2 id=\"requiredirectives\">The Require Directives</h2> <p><code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code> provides some generic authorization providers which can be used with the <code class=\"directive\"><a href=\"#require\">Require</a></code> directive.</p> <h3><a name=\"reqenv\" id=\"reqenv\">Require env</a></h3> <p>The <code>env</code> provider allows access to the server to be controlled based on the existence of an <a href=\"../env\">environment variable</a>. When <code>Require env env-variable</code> is specified, then the request is allowed access if the environment variable <var>env-variable</var> exists. The server provides the ability to set environment variables in a flexible way based on characteristics of the client request using the directives provided by <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code>. Therefore, this directive can be used to allow access based on such factors as the clients <code>User-Agent</code> (browser type), <code>Referer</code>, or other HTTP request header fields.</p> <pre class=\"prettyprint lang-config\">SetEnvIf User-Agent ^KnockKnock/2\\.0 let_me_in\n&lt;Directory \"/docroot\"&gt;\n    Require env let_me_in\n&lt;/Directory&gt;</pre> <p>In this case, browsers with a user-agent string beginning with <code>KnockKnock/2.0</code> will be allowed access, and all others will be denied.</p> <p>When the server looks up a path via an internal <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#subrequest\" title=\"see glossary\">subrequest</a> such as looking for a <code class=\"directive\"><a href=\"mod_dir#directoryindex\">DirectoryIndex</a></code> or generating a directory listing with <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code>, per-request environment variables are <em>not</em> inherited in the subrequest. Additionally, <code class=\"directive\"><a href=\"mod_setenvif#setenvif\">SetEnvIf</a></code> directives are not separately evaluated in the subrequest due to the API phases <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code> takes action in.</p> <h3><a name=\"reqall\" id=\"reqall\">Require all</a></h3> <p>The <code>all</code> provider mimics the functionality that was previously provided by the 'Allow from all' and 'Deny from all' directives. This provider can take one of two arguments which are 'granted' or 'denied'. The following examples will grant or deny access to all requests.</p> <pre class=\"prettyprint lang-config\">Require all granted</pre> <pre class=\"prettyprint lang-config\">Require all denied</pre> <h3><a name=\"reqmethod\" id=\"reqmethod\">Require method</a></h3> <p>The <code>method</code> provider allows using the HTTP method in authorization decisions. The GET and HEAD methods are treated as equivalent. The TRACE method is not available to this provider, use <code class=\"directive\"><a href=\"core#traceenable\">TraceEnable</a></code> instead.</p> <p>The following example will only allow GET, HEAD, POST, and OPTIONS requests:</p> <pre class=\"prettyprint lang-config\">Require method GET POST OPTIONS</pre> <p>The following example will allow GET, HEAD, POST, and OPTIONS requests without authentication, and require a valid user for all other methods:</p> <pre class=\"prettyprint lang-config\">&lt;RequireAny&gt;\n    Require method GET POST OPTIONS\n    Require valid-user\n&lt;/RequireAny&gt;</pre> <h3><a name=\"reqexpr\" id=\"reqexpr\">Require expr</a></h3> <p>The <code>expr</code> provider allows basing authorization decisions on arbitrary expressions.</p> <pre class=\"prettyprint lang-config\">Require expr \"%{TIME_HOUR} -ge 9 &amp;&amp; %{TIME_HOUR} -le 17\"</pre> <pre class=\"prettyprint lang-config\">&lt;RequireAll&gt;\n    Require expr \"!(%{QUERY_STRING} =~ /secret/)\"\n    Require expr \"%{REQUEST_URI} in { '/example.cgi', '/other.cgi' }\" \n&lt;/RequireAll&gt;</pre> <pre class=\"prettyprint lang-config\">Require expr \"!(%{QUERY_STRING} =~ /secret/) &amp;&amp; %{REQUEST_URI} in { '/example.cgi', '/other.cgi' }\"</pre> <p>The syntax is described in the <a href=\"../expr\">ap_expr</a> documentation.</p> <p>Normally, the expression is evaluated before authentication. However, if the expression returns false and references the variable <code>%{REMOTE_USER}</code>, authentication will be performed and the expression will be re-evaluated.</p>   <div class=\"directive-section\">\n<h2 id=\"authmerging\">AuthMerging Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls the manner in which each configuration section's authorization logic is combined with that of preceding configuration sections.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthMerging Off | And | Or</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthMerging Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_core</td>\n</tr> </table> <p>When authorization is enabled, it is normally inherited by each subsequent <a href=\"../sections#merging\">configuration section</a>, unless a different set of authorization directives is specified. This is the default action, which corresponds to an explicit setting of <code>AuthMerging Off</code>.</p> <p>However, there may be circumstances in which it is desirable for a configuration section's authorization to be combined with that of its predecessor while configuration sections are being merged. Two options are available for this case, <code>And</code> and <code>Or</code>.</p> <p>When a configuration section contains <code>AuthMerging And</code> or <code>AuthMerging Or</code>, its authorization logic is combined with that of the nearest predecessor (according to the overall order of configuration sections) which also contains authorization logic as if the two sections were jointly contained within a <code class=\"directive\"><a href=\"#requireall\">&lt;RequireAll&gt;</a></code> or <code class=\"directive\"><a href=\"#requireany\">&lt;RequireAny&gt;</a></code> directive, respectively.</p> <div class=\"note\">The setting of <code class=\"directive\">AuthMerging</code> is not inherited outside of the configuration section in which it appears. In the following example, only users belonging to group <code>alpha</code> may access <code>/www/docs</code>. Users belonging to either groups <code>alpha</code> or <code>beta</code> may access <code>/www/docs/ab</code>. However, the default <code>Off</code> setting of <code class=\"directive\">AuthMerging</code> applies to the <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> configuration section for <code>/www/docs/ab/gamma</code>, so that section's authorization directives override those of the preceding sections. Thus only users belong to the group <code>gamma</code> may access <code>/www/docs/ab/gamma</code>.</div> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/docs\"&gt;\n    AuthType Basic\n    AuthName Documents\n    AuthBasicProvider file\n    AuthUserFile \"/usr/local/apache/passwd/passwords\"\n    Require group alpha\n&lt;/Directory&gt;\n\n&lt;Directory \"/www/docs/ab\"&gt;\n    AuthMerging Or\n    Require group beta\n&lt;/Directory&gt;\n\n&lt;Directory \"/www/docs/ab/gamma\"&gt;\n    Require group gamma\n&lt;/Directory&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"authzprovideralias\">&lt;AuthzProviderAlias&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enclose a group of directives that represent an extension of a base authorization provider and referenced by the specified alias</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;AuthzProviderAlias baseProvider Alias Require-Parameters&gt; ... &lt;/AuthzProviderAlias&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_core</td>\n</tr> </table> <p><code class=\"directive\">&lt;AuthzProviderAlias&gt;</code> and <code>&lt;/AuthzProviderAlias&gt;</code> are used to enclose a group of authorization directives that can be referenced by the alias name using the directive <code class=\"directive\"><a href=\"#require\">Require</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authzsendforbiddenonfailure\">AuthzSendForbiddenOnFailure Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Send '403 FORBIDDEN' instead of '401 UNAUTHORIZED' if authentication succeeds but authorization fails </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthzSendForbiddenOnFailure On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthzSendForbiddenOnFailure Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTPD 2.3.11 and later</td>\n</tr> </table> <p>If authentication succeeds but authorization fails, Apache HTTPD will respond with an HTTP response code of '401 UNAUTHORIZED' by default. This usually causes browsers to display the password dialogue to the user again, which is not wanted in all situations. <code class=\"directive\">AuthzSendForbiddenOnFailure</code> allows to change the response code to '403 FORBIDDEN'.</p> <div class=\"warning\">\n<p><strong>Security Warning</strong></p> <p>Modifying the response in case of missing authorization weakens the security of the password, because it reveals to a possible attacker, that his guessed password was right.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"require\">Require Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Tests whether an authenticated user is authorized by an authorization provider.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Require [not] entity-name [entity-name] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_core</td>\n</tr> </table> <p>This directive tests whether an authenticated user is authorized according to a particular authorization provider and the specified restrictions. <code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code> provides the following generic authorization providers:</p> <dl> <dt><code>Require all granted</code></dt> <dd>Access is allowed unconditionally.</dd> <dt><code>Require all denied</code></dt> <dd>Access is denied unconditionally.</dd> <dt><code>Require env env-var [env-var] ...</code></dt> <dd>Access is allowed only if one of the given environment variables is set.</dd> <dt><code>Require method http-method [http-method] ...</code></dt> <dd>Access is allowed only for the given HTTP methods.</dd> <dt><code>Require expr expression</code></dt> <dd>Access is allowed if <var>expression</var> evaluates to true.</dd> </dl> <p>Some of the allowed syntaxes provided by <code class=\"module\"><a href=\"mod_authz_user\">mod_authz_user</a></code>, <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code>, and <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> are:</p> <dl> <dt><code>Require user userid [userid] ...</code></dt> <dd>Only the named users can access the resource.</dd> <dt><code>Require group group-name [group-name] ...</code></dt> <dd>Only users in the named groups can access the resource.</dd> <dt><code>Require valid-user</code></dt> <dd>All valid users can access the resource.</dd> <dt><code>Require ip 10 172.20 192.168.2</code></dt> <dd>Clients in the specified IP address ranges can access the resource.</dd> </dl> <p>Other authorization modules that implement require options include <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code>, <code class=\"module\"><a href=\"mod_authz_dbm\">mod_authz_dbm</a></code>, <code class=\"module\"><a href=\"mod_authz_dbd\">mod_authz_dbd</a></code>, <code class=\"module\"><a href=\"mod_authz_owner\">mod_authz_owner</a></code> and <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code>.</p> <p>In most cases, for a complete authentication and authorization configuration, <code class=\"directive\">Require</code> must be accompanied by <code class=\"directive\"><a href=\"mod_authn_core#authname\">AuthName</a></code>, <code class=\"directive\"><a href=\"mod_authn_core#authtype\">AuthType</a></code> and <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> or <code class=\"directive\"><a href=\"mod_auth_digest#authdigestprovider\">AuthDigestProvider</a></code> directives, and directives such as <code class=\"directive\"><a href=\"mod_authn_file#authuserfile\">AuthUserFile</a></code> and <code class=\"directive\"><a href=\"mod_authz_groupfile#authgroupfile\">AuthGroupFile</a></code> (to define users and groups) in order to work correctly. Example:</p> <pre class=\"prettyprint lang-config\">AuthType Basic\nAuthName \"Restricted Resource\"\nAuthBasicProvider file\nAuthUserFile \"/web/users\"\nAuthGroupFile \"/web/groups\"\nRequire group admin</pre> <p>Access controls which are applied in this way are effective for <strong>all</strong> methods. <strong>This is what is normally desired.</strong> If you wish to apply access controls only to specific methods, while leaving other methods unprotected, then place the <code class=\"directive\">Require</code> statement into a <code class=\"directive\"><a href=\"core#limit\">&lt;Limit&gt;</a></code> section.</p> <p>The result of the <code class=\"directive\">Require</code> directive may be negated through the use of the <code>not</code> option. As with the other negated authorization directive <code class=\"directive\">&lt;RequireNone&gt;</code>, when the <code class=\"directive\">Require</code> directive is negated it can only fail or return a neutral result, and therefore may never independently authorize a request.</p> <p>In the following example, all users in the <code>alpha</code> and <code>beta</code> groups are authorized, except for those who are also in the <code>reject</code> group.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/docs\"&gt;\n    &lt;RequireAll&gt;\n        Require group alpha beta\n        Require not group reject\n    &lt;/RequireAll&gt;\n&lt;/Directory&gt;</pre> <p>When multiple <code class=\"directive\">Require</code> directives are used in a single <a href=\"../sections#merging\">configuration section</a> and are not contained in another authorization directive like <code class=\"directive\"><a href=\"#requireall\">&lt;RequireAll&gt;</a></code>, they are implicitly contained within a <code class=\"directive\"><a href=\"#requireany\">&lt;RequireAny&gt;</a></code> directive. Thus the first one to authorize a user authorizes the entire request, and subsequent <code class=\"directive\">Require</code> directives are ignored.</p> <div class=\"warning\">\n<p><strong>Security Warning</strong></p> <p>Exercise caution when setting authorization directives in <code class=\"directive\"><a href=\"core#location\">Location</a></code> sections that overlap with content served out of the filesystem. By default, these <a href=\"../sections#merging\">configuration sections</a> overwrite authorization configuration in <code class=\"directive\"><a href=\"core#directory\">Directory</a></code>, and <code class=\"directive\"><a href=\"core#files\">Files</a></code> sections.</p> <p>The <code class=\"directive\"><a href=\"#authmerging\">AuthMerging</a></code> directive can be used to control how authorization configuration sections are merged.</p> </div> <h3>See also</h3> <ul> <li><a href=\"../howto/access\">Access control howto</a></li> <li><a href=\"#logic\">Authorization Containers</a></li> <li><code class=\"module\"><a href=\"mod_authn_core\">mod_authn_core</a></code></li> <li><code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"requireall\">&lt;RequireAll&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enclose a group of authorization directives of which none must fail and at least one must succeed for the enclosing directive to succeed.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;RequireAll&gt; ... &lt;/RequireAll&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_core</td>\n</tr> </table> <p><code class=\"directive\">&lt;RequireAll&gt;</code> and <code>&lt;/RequireAll&gt;</code> are used to enclose a group of authorization directives of which none must fail and at least one must succeed in order for the <code class=\"directive\">&lt;RequireAll&gt;</code> directive to succeed.</p> <p>If none of the directives contained within the <code class=\"directive\">&lt;RequireAll&gt;</code> directive fails, and at least one succeeds, then the <code class=\"directive\">&lt;RequireAll&gt;</code> directive succeeds. If none succeed and none fail, then it returns a neutral result. In all other cases, it fails.</p> <h3>See also</h3> <ul> <li><a href=\"#logic\">Authorization Containers</a></li> <li><a href=\"../howto/auth\">Authentication, Authorization, and Access Control</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"requireany\">&lt;RequireAny&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enclose a group of authorization directives of which one must succeed for the enclosing directive to succeed.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;RequireAny&gt; ... &lt;/RequireAny&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_core</td>\n</tr> </table> <p><code class=\"directive\">&lt;RequireAny&gt;</code> and <code>&lt;/RequireAny&gt;</code> are used to enclose a group of authorization directives of which one must succeed in order for the <code class=\"directive\">&lt;RequireAny&gt;</code> directive to succeed.</p> <p>If one or more of the directives contained within the <code class=\"directive\">&lt;RequireAny&gt;</code> directive succeed, then the <code class=\"directive\">&lt;RequireAny&gt;</code> directive succeeds. If none succeed and none fail, then it returns a neutral result. In all other cases, it fails.</p> <div class=\"note\">Because negated authorization directives are unable to return a successful result, they can not significantly influence the result of a <code class=\"directive\">&lt;RequireAny&gt;</code> directive. (At most they could cause the directive to fail in the case where they failed and all other directives returned a neutral value.) Therefore negated authorization directives are not permitted within a <code class=\"directive\">&lt;RequireAny&gt;</code> directive.</div> <h3>See also</h3> <ul> <li><a href=\"#logic\">Authorization Containers</a></li> <li><a href=\"../howto/auth\">Authentication, Authorization, and Access Control</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"requirenone\">&lt;RequireNone&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enclose a group of authorization directives of which none must succeed for the enclosing directive to not fail.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;RequireNone&gt; ... &lt;/RequireNone&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authz_core</td>\n</tr> </table> <p><code class=\"directive\">&lt;RequireNone&gt;</code> and <code>&lt;/RequireNone&gt;</code> are used to enclose a group of authorization directives of which none must succeed in order for the <code class=\"directive\">&lt;RequireNone&gt;</code> directive to not fail.</p> <p>If one or more of the directives contained within the <code class=\"directive\">&lt;RequireNone&gt;</code> directive succeed, then the <code class=\"directive\">&lt;RequireNone&gt;</code> directive fails. In all other cases, it returns a neutral result. Thus as with the other negated authorization directive <code>Require not</code>, it can never independently authorize a request because it can never return a successful result. It can be used, however, to restrict the set of users who are authorized to access a resource.</p> <div class=\"note\">Because negated authorization directives are unable to return a successful result, they can not significantly influence the result of a <code class=\"directive\">&lt;RequireNone&gt;</code> directive. Therefore negated authorization directives are not permitted within a <code class=\"directive\">&lt;RequireNone&gt;</code> directive.</div> <h3>See also</h3> <ul> <li><a href=\"#logic\">Authorization Containers</a></li> <li><a href=\"../howto/auth\">Authentication, Authorization, and Access Control</a></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authz_core.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authz_core.html</a>\n  </p>\n</div>\n","mod/mod_authz_user":"<h1>Apache Module mod_authz_user</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>User Authorization</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authz_user_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authz_user.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides authorization capabilities so that authenticated users can be allowed or denied access to portions of the web site. <code class=\"module\"><a href=\"mod_authz_user\">mod_authz_user</a></code> grants access if the authenticated user is listed in a <code>Require user</code> directive. Alternatively <code>Require valid-user</code> can be used to grant access to all successfully authenticated users.</p>     <h2 id=\"requiredirectives\">The Require Directives</h2> <p>Apache's <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives are used during the authorization phase to ensure that a user is allowed to access a resource. mod_authz_user extends the authorization types with <code>user</code> and <code>valid-user</code>. </p> <p>Since v2.4.8, <a href=\"../expr\">expressions</a> are supported within the user require directives.</p> <h3><a name=\"requser\" id=\"requser\">Require user</a></h3> <p>This directive specifies a list of users that are allowed to gain access.</p> <pre class=\"prettyprint lang-config\">Require user john paul george ringo</pre> <h3><a name=\"reqvaliduser\" id=\"reqvaliduser\">Require valid-user</a></h3> <p>When this directive is specified, any successfully authenticated user will be allowed to gain access.</p> <pre class=\"prettyprint lang-config\">Require valid-user</pre><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authz_user.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authz_user.html</a>\n  </p>\n</div>\n","mod/mod_buffer":"<h1>Apache Module mod_buffer</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Support for request buffering</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>buffer_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_buffer.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides the ability to buffer the input and output filter stacks.</p> <p>Under certain circumstances, content generators might create content in small chunks. In order to promote memory reuse, in memory chunks are always 8k in size, regardless of the size of the chunk itself. When many small chunks are generated by a request, this can create a large memory footprint while the request is being processed, and an unnecessarily large amount of data on the wire. The addition of a buffer collapses the response into the fewest chunks possible.</p> <p>When httpd is used in front of an expensive content generator, buffering the response may allow the backend to complete processing and release resources sooner, depending on how the backend is designed.</p> <p>The buffer filter may be added to either the input or the output filter stacks, as appropriate, using the <code class=\"directive\"><a href=\"core#setinputfilter\">SetInputFilter</a></code>, <code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code>, <code class=\"directive\"><a href=\"mod_mime#addoutputfilter\">AddOutputFilter</a></code> or <code class=\"directive\"><a href=\"mod_filter#addoutputfilterbytype\">AddOutputFilterByType</a></code> directives.</p> <div class=\"example\">\n<h3>Using buffer with mod_include</h3>\n<pre class=\"prettyprint lang-config\">AddOutputFilterByType INCLUDES;BUFFER text/html</pre> </div> <div class=\"warning\">The buffer filters read the request/response into RAM and then repack the request/response into the fewest memory buckets possible, at the cost of CPU time. When the request/response is already efficiently packed, buffering the request/response could cause the request/response to be slower than not using a buffer at all. These filters should be used with care, and only where necessary.</div>    <div class=\"directive-section\">\n<h2 id=\"buffersize\">BufferSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum size in bytes to buffer by the buffer filter</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BufferSize integer</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>BufferSize 131072</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_buffer</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#buffersize\">BufferSize</a></code> directive specifies the amount of data in bytes that will be buffered before being read from or written to each request. The default is 128 kilobytes.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_buffer.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_buffer.html</a>\n  </p>\n</div>\n","mod/mod_cern_meta":"<h1>Apache Module mod_cern_meta</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>CERN httpd metafile semantics</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>cern_meta_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_cern_meta.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>Emulate the CERN HTTPD Meta file semantics. Meta files are HTTP headers that can be output in addition to the normal range of headers for each file accessed. They appear rather like the Apache .asis files, and are able to provide a crude way of influencing the Expires: header, as well as providing other curiosities. There are many ways to manage meta information, this one was chosen because there is already a large number of CERN users who can exploit this module.</p> <p>More information on the <a href=\"http://www.w3.org/pub/WWW/Daemon/User/Config/General.html#MetaDir\">CERN metafile semantics</a> is available.</p>    <div class=\"directive-section\">\n<h2 id=\"metadir\">MetaDir Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name of the directory to find CERN-style meta information files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MetaDir directory</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MetaDir .web</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cern_meta</td>\n</tr> </table> <p>Specifies the name of the directory in which Apache can find meta information files. The directory is usually a 'hidden' subdirectory of the directory that contains the file being accessed. Set to \"<code>.</code>\" to look in the same directory as the file:</p> <pre class=\"prettyprint lang-config\">MetaDir .</pre> <p>Or, to set it to a subdirectory of the directory containing the files:</p> <pre class=\"prettyprint lang-config\">MetaDir .meta</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"metafiles\">MetaFiles Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Activates CERN meta-file processing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MetaFiles on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MetaFiles off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cern_meta</td>\n</tr> </table> <p>Turns on/off Meta file processing on a per-directory basis.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"metasuffix\">MetaSuffix Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File name suffix for the file containing CERN-style meta information</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MetaSuffix suffix</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MetaSuffix .meta</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cern_meta</td>\n</tr> </table> <p>Specifies the file name suffix for the file containing the meta information. For example, the default values for the two directives will cause a request to <code>DOCUMENT_ROOT/somedir/index.html</code> to look in <code>DOCUMENT_ROOT/somedir/.web/index.html.meta</code> and will use its contents to generate additional MIME header information.</p> <div class=\"example\">\n<h3>Example:</h3>\n<pre class=\"prettyprint lang-config\">MetaSuffix .meta</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_cern_meta.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_cern_meta.html</a>\n  </p>\n</div>\n","mod/mod_cgid":"<h1>Apache Module mod_cgid</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Execution of CGI scripts using an external CGI daemon</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>cgid_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_cgid.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Unix threaded MPMs only</td>\n</tr>\n</table> <h3>Summary</h3> <p>Except for the optimizations and the additional <code class=\"directive\"><a href=\"#scriptsock\">ScriptSock</a></code> directive noted below, <code class=\"module\"><a href=\"mod_cgid\">mod_cgid</a></code> behaves similarly to <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>. <strong>See the <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> summary for additional details about Apache and CGI.</strong></p> <p>On certain unix operating systems, forking a process from a multi-threaded server is a very expensive operation because the new process will replicate all the threads of the parent process. In order to avoid incurring this expense on each CGI invocation, <code class=\"module\"><a href=\"mod_cgid\">mod_cgid</a></code> creates an external daemon that is responsible for forking child processes to run CGI scripts. The main server communicates with this daemon using a unix domain socket.</p> <p>This module is used by default instead of <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> whenever a multi-threaded MPM is selected during the compilation process. At the user level, this module is identical in configuration and operation to <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>. The only exception is the additional directive <code>ScriptSock</code> which gives the name of the socket to use for communication with the cgi daemon.</p>    <div class=\"directive-section\">\n<h2 id=\"cgidscripttimeout\">CGIDScriptTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The length of time to wait for more output from the CGI program</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CGIDScriptTimeout time[s|ms]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>value of Timeout directive when unset</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cgid</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>CGIDScriptTimeout defaults to zero in releases 2.4 and earlier </td>\n</tr> </table> <p>This directive limits the length of time to wait for more output from the CGI program. If the time is exceeded, the request and CGI are terminated.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">CGIDScriptTimeout 20</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"scriptsock\">ScriptSock Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The filename prefix of the socket to use for communication with the cgi daemon</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScriptSock file-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ScriptSock cgisock</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cgid</td>\n</tr> </table> <p>This directive sets the filename prefix of the socket to use for communication with the CGI daemon, an extension corresponding to the process ID of the server will be appended. The socket will be opened using the permissions of the user who starts Apache (usually root). To maintain the security of communications with CGI scripts, it is important that no other user has permission to write in the directory where the socket is located.</p> <p>If <var>file-path</var> is not an absolute path, the location specified will be relative to the value of <code class=\"directive\"><a href=\"core#defaultruntimedir\">DefaultRuntimeDir</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ScriptSock /var/run/cgid.sock</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_cgid.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_cgid.html</a>\n  </p>\n</div>\n","mod/mod_cache_disk":"<h1>Apache Module mod_cache_disk</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Disk based storage module for the HTTP caching filter.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>cache_disk_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_cache_disk.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code> implements a disk based storage manager for <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code>.</p> <p>The headers and bodies of cached responses are stored separately on disk, in a directory structure derived from the md5 hash of the cached URL.</p> <p>Multiple content negotiated responses can be stored concurrently, however the caching of partial content is not yet supported by this module.</p> <p>Atomic cache updates to both header and body files are achieved without the need for locking by storing the device and inode numbers of the body file within the header file. This has the side effect that cache entries manually moved into the cache will be ignored.</p> <p>The <code class=\"program\"><a href=\"../programs/htcacheclean\">htcacheclean</a></code> tool is provided to list cached URLs, remove cached URLs, or to maintain the size of the disk cache within size and/or inode limits. The tool can be run on demand, or can be daemonized to offer continuous monitoring of directory sizes.</p> <div class=\"note\">\n<p><strong>Note:</strong></p> <p><code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code> requires the services of <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code>, which must be loaded before mod_cache_disk.</p> </div> <div class=\"note\">\n<p><strong>Note:</strong></p> <p><code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code> uses the sendfile feature to serve files from the cache when supported by the platform, and when enabled with <code class=\"directive\"><a href=\"core#enablesendfile\">EnableSendfile</a></code>. However, per-directory and .htaccess configuration of <code class=\"directive\"><a href=\"core#enablesendfile\">EnableSendfile</a></code> are ignored by <code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code> as the corresponding settings are not available to the module when a request is being served from the cache.</p> </div>    <div class=\"directive-section\">\n<h2 id=\"cachedirlength\">CacheDirLength Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The number of characters in subdirectory names</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheDirLength length</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheDirLength 2</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_disk</td>\n</tr> </table> <p>The <code class=\"directive\">CacheDirLength</code> directive sets the number of characters for each subdirectory name in the cache hierarchy. It can be used in conjunction with <code class=\"directive\">CacheDirLevels</code> to determine the approximate structure of your cache hierarchy.</p> <p>A high value for <code class=\"directive\">CacheDirLength</code> combined with a low value for <code class=\"directive\">CacheDirLevels</code> will result in a relatively flat hierarchy, with a large number of subdirectories at each level.</p> <div class=\"note\"> <p>The result of <code class=\"directive\"><a href=\"#cachedirlevels\">CacheDirLevels</a></code>* <code class=\"directive\">CacheDirLength</code> must not be higher than 20.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"cachedirlevels\">CacheDirLevels Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The number of levels of subdirectories in the cache.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheDirLevels levels</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheDirLevels 2</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_disk</td>\n</tr> </table> <p>The <code class=\"directive\">CacheDirLevels</code> directive sets the number of subdirectory levels in the cache. Cached data will be saved this many directory levels below the <code class=\"directive\"><a href=\"#cacheroot\">CacheRoot</a></code> directory.</p> <p>A high value for <code class=\"directive\">CacheDirLevels</code> combined with a low value for <code class=\"directive\">CacheDirLength</code> will result in a relatively deep hierarchy, with a small number of subdirectories at each level.</p> <div class=\"note\"> <p>The result of <code class=\"directive\">CacheDirLevels</code>* <code class=\"directive\"><a href=\"#cachedirlength\">CacheDirLength</a></code> must not be higher than 20.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"cachemaxfilesize\">CacheMaxFileSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The maximum size (in bytes) of a document to be placed in the cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheMaxFileSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheMaxFileSize 1000000</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_disk</td>\n</tr> </table> <p>The <code class=\"directive\">CacheMaxFileSize</code> directive sets the maximum size, in bytes, for a document to be considered for storage in the cache.</p> <pre class=\"prettyprint lang-config\">CacheMaxFileSize 64000</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheminfilesize\">CacheMinFileSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The minimum size (in bytes) of a document to be placed in the cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheMinFileSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheMinFileSize 1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_disk</td>\n</tr> </table> <p>The <code class=\"directive\">CacheMinFileSize</code> directive sets the minimum size, in bytes, for a document to be considered for storage in the cache.</p> <pre class=\"prettyprint lang-config\">CacheMinFileSize 64</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachereadsize\">CacheReadSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The minimum size (in bytes) of the document to read and be cached before sending the data downstream</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheReadSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheReadSize 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_disk</td>\n</tr> </table> <p>The <code class=\"directive\">CacheReadSize</code> directive sets the minimum amount of data, in bytes, to be read from the backend before the data is sent to the client. The default of zero causes all data read of any size to be passed downstream to the client immediately as it arrives. Setting this to a higher value causes the disk cache to buffer at least this amount before sending the result to the client. This can improve performance when caching content from a reverse proxy.</p> <p>This directive only takes effect when the data is being saved to the cache, as opposed to data being served from the cache.</p> <pre class=\"prettyprint lang-config\">CacheReadSize 102400</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachereadtime\">CacheReadTime Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The minimum time (in milliseconds) that should elapse while reading before data is sent downstream</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheReadTime milliseconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheReadTime 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_disk</td>\n</tr> </table> <p>The <code class=\"directive\">CacheReadTime</code> directive sets the minimum amount of elapsed time that should pass before making an attempt to send data downstream to the client. During the time period, data will be buffered before sending the result to the client. This can improve performance when caching content from a reverse proxy.</p> <p>The default of zero disables this option.</p> <p>This directive only takes effect when the data is being saved to the cache, as opposed to data being served from the cache. It is recommended that this option be used alongside the <code class=\"directive\"><a href=\"#cachereadsize\">CacheReadSize</a></code> directive to ensure that the server does not buffer excessively should data arrive faster than expected.</p> <pre class=\"prettyprint lang-config\">CacheReadTime 1000</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheroot\">CacheRoot Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The directory root under which cache files are stored</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheRoot directory</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_disk</td>\n</tr> </table> <p>The <code class=\"directive\">CacheRoot</code> directive defines the name of the directory on the disk to contain cache files. If the <code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code> module has been loaded or compiled in to the Apache server, this directive <em>must</em> be defined. Failing to provide a value for <code class=\"directive\">CacheRoot</code> will result in a configuration file processing error. The <code class=\"directive\"><a href=\"#cachedirlevels\">CacheDirLevels</a></code> and <code class=\"directive\"><a href=\"#cachedirlength\">CacheDirLength</a></code> directives define the structure of the directories under the specified root directory.</p> <pre class=\"prettyprint lang-config\">CacheRoot c:/cacheroot</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_cache_disk.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_cache_disk.html</a>\n  </p>\n</div>\n","mod/mod_cache_socache":"<h1>Apache Module mod_cache_socache</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Shared object cache (socache) based storage module for the HTTP caching filter.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>cache_socache_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_cache_socache.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_cache_socache\">mod_cache_socache</a></code> implements a shared object cache (socache) based storage manager for <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code>.</p> <p>The headers and bodies of cached responses are combined, and stored underneath a single key in the shared object cache. A <a href=\"../socache\">number of implementations</a> of shared object caches are available to choose from.</p> <p>Multiple content negotiated responses can be stored concurrently, however the caching of partial content is not yet supported by this module.</p> <pre class=\"prettyprint lang-config\"># Turn on caching\nCacheSocache shmcb\nCacheSocacheMaxSize 102400\n&lt;Location /foo&gt;\n    CacheEnable socache\n&lt;/Location&gt;\n\n# Fall back to the disk cache\nCacheSocache shmcb\nCacheSocacheMaxSize 102400\n&lt;Location /foo&gt;\n    CacheEnable socache\n    CacheEnable disk\n&lt;/Location&gt;</pre> <div class=\"note\">\n<p><strong>Note:</strong></p> <p><code class=\"module\"><a href=\"mod_cache_socache\">mod_cache_socache</a></code> requires the services of <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code>, which must be loaded before mod_cache_socache.</p> </div>    <div class=\"directive-section\">\n<h2 id=\"cachesocache\">CacheSocache Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The shared object cache implementation to use</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheSocache type[:args]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_socache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.5 and later</td>\n</tr> </table> <p>The <code class=\"directive\">CacheSocache</code> directive defines the name of the shared object cache implementation to use, followed by optional arguments for that implementation. A <a href=\"../socache\">number of implementations</a> of shared object caches are available to choose from.</p> <pre class=\"prettyprint lang-config\">CacheSocache shmcb</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachesocachemaxsize\">CacheSocacheMaxSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The maximum size (in bytes) of an entry to be placed in the cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheSocacheMaxSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheSocacheMaxSize 102400</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_socache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.5 and later</td>\n</tr> </table> <p>The <code class=\"directive\">CacheSocacheMaxSize</code> directive sets the maximum size, in bytes, for the combined headers and body of a document to be considered for storage in the cache. The larger the headers that are stored alongside the body, the smaller the body may be.</p> <p>The <code class=\"module\"><a href=\"mod_cache_socache\">mod_cache_socache</a></code> module will only attempt to cache responses that have an explicit content length, or that are small enough to be written in one pass. This is done to allow the <code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code> module to have an opportunity to cache responses larger than those cacheable within <code class=\"module\"><a href=\"mod_cache_socache\">mod_cache_socache</a></code>.</p> <pre class=\"prettyprint lang-config\">CacheSocacheMaxSize 102400</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachesocachemaxtime\">CacheSocacheMaxTime Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The maximum time (in seconds) for a document to be placed in the cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheSocacheMaxTime seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheSocacheMaxTime 86400</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_socache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.5 and later</td>\n</tr> </table> <p>The <code class=\"directive\">CacheSocacheMaxTime</code> directive sets the maximum freshness lifetime, in seconds, for a document to be stored in the cache. This value overrides the freshness lifetime defined for the document by the HTTP protocol.</p> <pre class=\"prettyprint lang-config\">CacheSocacheMaxTime 86400</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachesocachemintime\">CacheSocacheMinTime Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The minimum time (in seconds) for a document to be placed in the cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheSocacheMinTime seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheSocacheMinTime 600</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_socache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.5 and later</td>\n</tr> </table> <p>The <code class=\"directive\">CacheSocacheMinTime</code> directive sets the amount of seconds beyond the freshness lifetime of the response that the response should be cached for in the shared object cache. If a response is only stored for its freshness lifetime, there will be no opportunity to revalidate the response to make it fresh again.</p> <pre class=\"prettyprint lang-config\">CacheSocacheMinTime 600</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachesocachereadsize\">CacheSocacheReadSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The minimum size (in bytes) of the document to read and be cached before sending the data downstream</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheSocacheReadSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheSocacheReadSize 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_socache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.5 and later</td>\n</tr> </table> <p>The <code class=\"directive\">CacheSocacheReadSize</code> directive sets the minimum amount of data, in bytes, to be read from the backend before the data is sent to the client. The default of zero causes all data read of any size to be passed downstream to the client immediately as it arrives. Setting this to a higher value causes the disk cache to buffer at least this amount before sending the result to the client. This can improve performance when caching content from a slow reverse proxy.</p> <p>This directive only takes effect when the data is being saved to the cache, as opposed to data being served from the cache.</p> <pre class=\"prettyprint lang-config\">CacheReadSize 102400</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachesocachereadtime\">CacheSocacheReadTime Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The minimum time (in milliseconds) that should elapse while reading before data is sent downstream</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheSocacheReadTime milliseconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheSocacheReadTime 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache_socache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.5 and later</td>\n</tr> </table> <p>The <code class=\"directive\">CacheSocacheReadTime</code> directive sets the minimum amount of elapsed time that should pass before making an attempt to send data downstream to the client. During the time period, data will be buffered before sending the result to the client. This can improve performance when caching content from a reverse proxy.</p> <p>The default of zero disables this option.</p> <p>This directive only takes effect when the data is being saved to the cache, as opposed to data being served from the cache. It is recommended that this option be used alongside the <code class=\"directive\"><a href=\"#cachesocachereadsize\">CacheSocacheReadSize</a></code> directive to ensure that the server does not buffer excessively should data arrive faster than expected.</p> <pre class=\"prettyprint lang-config\">CacheSocacheReadTime 1000</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_cache_socache.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_cache_socache.html</a>\n  </p>\n</div>\n","mod/mod_charset_lite":"<h1>Apache Module mod_charset_lite</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Specify character set translation or recoding</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>charset_lite_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_charset_lite.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code> allows the server to change the character set of responses before sending them to the client. In an EBCDIC environment, Apache always translates HTTP protocol content (e.g. response headers) from the code page of the Apache process locale to ISO-8859-1, but not the body of responses. In any environment, <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code> can be used to specify that response bodies should be translated. For example, if files are stored in EBCDIC, then <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code> can translate them to ISO-8859-1 before sending them to the client.</p> <p>This module provides a small subset of configuration mechanisms implemented by Russian Apache and its associated <code>mod_charset</code>.</p>     <h2 id=\"problems\">Common Problems</h2> <h3>Invalid character set names</h3> <p>The character set name parameters of <code class=\"directive\"><a href=\"#charsetsourceenc\">CharsetSourceEnc</a></code> and <code class=\"directive\"><a href=\"#charsetdefault\">CharsetDefault</a></code> must be acceptable to the translation mechanism used by <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> on the system where <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code> is deployed. These character set names are not standardized and are usually not the same as the corresponding values used in http headers. Currently, APR can only use iconv(3), so you can easily test your character set names using the iconv(1) program, as follows:</p> <div class=\"example\"><pre>iconv -f charsetsourceenc-value -t charsetdefault-value</pre></div> <h3>Mismatch between character set of content and translation rules</h3> <p>If the translation rules don't make sense for the content, translation can fail in various ways, including:</p> <ul> <li>The translation mechanism may return a bad return code, and the connection will be aborted.</li> <li>The translation mechanism may silently place special characters (e.g., question marks) in the output buffer when it cannot translate the input buffer.</li> </ul>   <div class=\"directive-section\">\n<h2 id=\"charsetdefault\">CharsetDefault Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Charset to translate into</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CharsetDefault charset</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_charset_lite</td>\n</tr> </table> <p>The <code class=\"directive\">CharsetDefault</code> directive specifies the charset that content in the associated container should be translated to.</p> <p>The value of the <var>charset</var> argument must be accepted as a valid character set name by the character set support in <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a>. Generally, this means that it must be supported by iconv.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Directory \"/export/home/trawick/apacheinst/htdocs/convert\"&gt;\n    CharsetSourceEnc  UTF-16BE\n    CharsetDefault    ISO-8859-1\n&lt;/Directory&gt;</pre> </div> <div class=\"note\"> Specifying the same charset for both <code class=\"directive\"><a href=\"#charsetsourceenc\">CharsetSourceEnc</a></code> and <code class=\"directive\"><a href=\"#charsetdefault\">CharsetDefault</a></code> disables translation. The charset need not match the charset of the response, but it must be a valid charset on the system. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"charsetoptions\">CharsetOptions Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures charset translation behavior</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CharsetOptions option [option] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CharsetOptions ImplicitAdd</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_charset_lite</td>\n</tr> </table> <p>The <code class=\"directive\">CharsetOptions</code> directive configures certain behaviors of <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code>. <var>Option</var> can be one of</p> <dl> <dt><code>ImplicitAdd | NoImplicitAdd</code></dt> <dd>The <code>ImplicitAdd</code> keyword specifies that <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code> should implicitly insert its filter when the configuration specifies that the character set of content should be translated. If the filter chain is explicitly configured using the <code class=\"directive\"><a href=\"mod_mime#addoutputfilter\">AddOutputFilter</a></code> directive, <code>NoImplicitAdd</code> should be specified so that <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code> doesn't add its filter.</dd> <dt><code>TranslateAllMimeTypes | NoTranslateAllMimeTypes</code></dt> <dd>Normally, <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code> will only perform translation on a small subset of possible mimetypes. When the <code>TranslateAllMimeTypes</code> keyword is specified for a given configuration section, translation is performed without regard for mimetype.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"charsetsourceenc\">CharsetSourceEnc Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Source charset of files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CharsetSourceEnc charset</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_charset_lite</td>\n</tr> </table> <p>The <code class=\"directive\">CharsetSourceEnc</code> directive specifies the source charset of files in the associated container.</p> <p>The value of the <var>charset</var> argument must be accepted as a valid character set name by the character set support in <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a>. Generally, this means that it must be supported by iconv.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Directory \"/export/home/trawick/apacheinst/htdocs/convert\"&gt;\n    CharsetSourceEnc  UTF-16BE\n    CharsetDefault    ISO-8859-1\n&lt;/Directory&gt;</pre> </div> <p>The character set names in this example work with the iconv translation support in Solaris 8.</p> <div class=\"note\"> Specifying the same charset for both <code class=\"directive\"><a href=\"#charsetsourceenc\">CharsetSourceEnc</a></code> and <code class=\"directive\"><a href=\"#charsetdefault\">CharsetDefault</a></code> disables translation. The charset need not match the charset of the response, but it must be a valid charset on the system. </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_charset_lite.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_charset_lite.html</a>\n  </p>\n</div>\n","mod/mod_data":"<h1>Apache Module mod_data</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Convert response body into an RFC2397 data URL</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>data_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_data.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides the ability to convert a response into an <a href=\"http://tools.ietf.org/html/rfc2397\">RFC2397 data URL</a>. </p> <p>Data URLs can be embedded inline within web pages using something like the <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> module, to remove the need for clients to make separate connections to fetch what may potentially be many small images. Data URLs may also be included into pages generated by scripting languages such as PHP.</p> <div class=\"example\">\n<h3>An example of a data URL</h3>\n<pre>data:image/gif;base64,R0lGODdhMAAwAPAAAAAAAP///ywAAAAAMAAw\nAAAC8IyPqcvt3wCcDkiLc7C0qwyGHhSWpjQu5yqmCYsapyuvUUlvONmOZtfzgFz\nByTB10QgxOR0TqBQejhRNzOfkVJ+5YiUqrXF5Y5lKh/DeuNcP5yLWGsEbtLiOSp\na/TPg7JpJHxyendzWTBfX0cxOnKPjgBzi4diinWGdkF8kjdfnycQZXZeYGejmJl\nZeGl9i2icVqaNVailT6F5iJ90m6mvuTS4OK05M0vDk0Q4XUtwvKOzrcd3iq9uis\nF81M1OIcR7lEewwcLp7tuNNkM3uNna3F2JQFo97Vriy/Xl4/f1cf5VWzXyym7PH\nhhx4dbgYKAAA7</pre>\n</div> <p>The filter takes no parameters, and can be added to the filter stack using the <code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code> directive, or any of the directives supported by the <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> module.</p> <div class=\"example\">\n<h3>Configuring the filter</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/data/images\"&gt;\n    SetOutputFilter DATA\n&lt;/Location&gt;</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_data.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_data.html</a>\n  </p>\n</div>\n","mod/mod_dav_fs":"<h1>Apache Module mod_dav_fs</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Filesystem provider for <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>dav_fs_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_dav_fs.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>. It acts as a support module for <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code> and provides access to resources located in the server's file system. The formal name of this provider is <code>filesystem</code>. <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code> backend providers will be invoked by using the <code class=\"directive\"><a href=\"mod_dav#dav\">Dav</a></code> directive:</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">Dav filesystem</pre> </div> <p>Since <code>filesystem</code> is the default provider for <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>, you may simply use the value <code>On</code> instead.</p>    <div class=\"directive-section\">\n<h2 id=\"davlockdb\">DavLockDB Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Location of the DAV lock database</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DavLockDB file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dav_fs</td>\n</tr> </table> <p>Use the <code class=\"directive\">DavLockDB</code> directive to specify the full path to the lock database, excluding an extension. If the path is not absolute, it will be taken relative to <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>. The implementation of <code class=\"module\"><a href=\"mod_dav_fs\">mod_dav_fs</a></code> uses a SDBM database to track user locks.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">DavLockDB \"var/DavLock\"</pre> </div> <p>The directory containing the lock database file must be writable by the <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> and <code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code> under which Apache is running. For security reasons, you should create a directory for this purpose rather than changing the permissions on an existing directory. In the above example, Apache will create files in the <code>var/</code> directory under the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code> with the base filename <code>DavLock</code> and extension name chosen by the server.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_dav_fs.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_dav_fs.html</a>\n  </p>\n</div>\n","mod/mod_authnz_ldap":"<h1>Apache Module mod_authnz_ldap</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Allows an LDAP directory to be used to store the database for HTTP Basic authentication.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>authnz_ldap_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_authnz_ldap.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module allows authentication front-ends such as <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> to authenticate users through an ldap directory.</p> <p><code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> supports the following features:</p> <ul> <li>Known to support the <a href=\"http://www.openldap.org/\">OpenLDAP SDK</a> (both 1.x and 2.x), <a href=\"http://developer.novell.com/ndk/cldap.htm\"> Novell LDAP SDK</a> and the <a href=\"http://www.iplanet.com/downloads/developer/\">iPlanet (Netscape)</a> SDK.</li> <li>Complex authorization policies can be implemented by representing the policy with LDAP filters.</li> <li>Uses extensive caching of LDAP operations via <a href=\"mod_ldap\">mod_ldap</a>.</li> <li>Support for LDAP over SSL (requires the Netscape SDK) or TLS (requires the OpenLDAP 2.x SDK or Novell LDAP SDK).</li> </ul> <p>When using <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code>, this module is invoked via the <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> directive with the <code>ldap</code> value.</p>     <h2 id=\"contents\">Contents</h2> <ul> <li> <a href=\"#gcaveats\">General caveats</a> </li> <li> <a href=\"#operation\">Operation</a> <ul> <li><a href=\"#authenphase\">The Authentication Phase</a></li> <li><a href=\"#authorphase\">The Authorization Phase</a></li> </ul> </li> <li> <a href=\"#requiredirectives\">The Require Directives</a> <ul> <li><a href=\"#requser\">Require ldap-user</a></li> <li><a href=\"#reqgroup\">Require ldap-group</a></li> <li><a href=\"#reqdn\">Require ldap-dn</a></li> <li><a href=\"#reqattribute\">Require ldap-attribute</a></li> <li><a href=\"#reqfilter\">Require ldap-filter</a></li> </ul> </li> <li><a href=\"#examples\">Examples</a></li> <li><a href=\"#usingtls\">Using TLS</a></li> <li><a href=\"#usingssl\">Using SSL</a></li> <li><a href=\"#exposed\">Exposing Login Information</a></li> <li><a href=\"#activedirectory\">Using Active Directory</a></li> <li> <a href=\"#frontpage\">Using Microsoft FrontPage with <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code></a> <ul> <li><a href=\"#howitworks\">How It Works</a></li> <li><a href=\"#fpcaveats\">Caveats</a></li> </ul> </li> </ul>   <h2 id=\"gcaveats\">General caveats</h2> <p> This module caches authentication and authorization results based on the configuration of <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code>. Changes made to the backing LDAP server will not be immediately reflected on the HTTP Server, including but not limited to user lockouts/revocations, password changes, or changes to group memberships. Consult the directives in <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> for details of the cache tunables. </p>   <h2 id=\"operation\">Operation</h2> <p>There are two phases in granting access to a user. The first phase is authentication, in which the <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> authentication provider verifies that the user's credentials are valid. This is also called the <em>search/bind</em> phase. The second phase is authorization, in which <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> determines if the authenticated user is allowed access to the resource in question. This is also known as the <em>compare</em> phase.</p> <p><code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> registers both an authn_ldap authentication provider and an authz_ldap authorization handler. The authn_ldap authentication provider can be enabled through the <code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code> directive using the <code>ldap</code> value. The authz_ldap handler extends the <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive's authorization types by adding <code>ldap-user</code>, <code>ldap-dn</code> and <code>ldap-group</code> values.</p> <h3><a name=\"authenphase\" id=\"authenphase\">The Authentication Phase</a></h3> <p>During the authentication phase, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> searches for an entry in the directory that matches the username that the HTTP client passes. If a single unique match is found, then <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> attempts to bind to the directory server using the DN of the entry plus the password provided by the HTTP client. Because it does a search, then a bind, it is often referred to as the search/bind phase. Here are the steps taken during the search/bind phase.</p> <ol> <li>Generate a search filter by combining the attribute and filter provided in the <code class=\"directive\"><a href=\"#authldapurl\">AuthLDAPURL</a></code> directive with the username passed by the HTTP client.</li> <li>Search the directory using the generated filter. If the search does not return exactly one entry, deny or decline access.</li> <li>Fetch the distinguished name of the entry retrieved from the search and attempt to bind to the LDAP server using that DN and the password passed by the HTTP client. If the bind is unsuccessful, deny or decline access.</li> </ol> <p>The following directives are used during the search/bind phase</p> <table> <tr> <td><code class=\"directive\">AuthLDAPURL</code></td> <td>Specifies the LDAP server, the base DN, the attribute to use in the search, as well as the extra search filter to use.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPBindDN</code></td> <td>An optional DN to bind with during the search phase.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPBindPassword</code></td> <td>An optional password to bind with during the search phase.</td> </tr> </table> <h3><a name=\"authorphase\" id=\"authorphase\">The Authorization Phase</a></h3> <p>During the authorization phase, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> attempts to determine if the user is authorized to access the resource. Many of these checks require <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> to do a compare operation on the LDAP server. This is why this phase is often referred to as the compare phase. <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> accepts the following <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives to determine if the credentials are acceptable:</p> <ul> <li>Grant access if there is a <a href=\"#reqgroup\"><code>Require ldap-user</code></a> directive, and the username in the directive matches the username passed by the client.</li> <li>Grant access if there is a <a href=\"#reqdn\"><code>Require ldap-dn</code></a> directive, and the DN in the directive matches the DN fetched from the LDAP directory.</li> <li>Grant access if there is a <a href=\"#reqgroup\"><code>Require ldap-group</code></a> directive, and the DN fetched from the LDAP directory (or the username passed by the client) occurs in the LDAP group or, potentially, in one of its sub-groups.</li> <li>Grant access if there is a <a href=\"#reqattribute\"> <code>Require ldap-attribute</code></a> directive, and the attribute fetched from the LDAP directory matches the given value.</li> <li>Grant access if there is a <a href=\"#reqfilter\"> <code>Require ldap-filter</code></a> directive, and the search filter successfully finds a single user object that matches the dn of the authenticated user.</li> <li>otherwise, deny or decline access</li> </ul> <p>Other <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> values may also be used which may require loading additional authorization modules.</p> <ul> <li>Grant access to all successfully authenticated users if there is a <a href=\"#requser\"><code>Require valid-user</code></a> directive. (requires <code class=\"module\"><a href=\"mod_authz_user\">mod_authz_user</a></code>)</li> <li>Grant access if there is a <a href=\"#reqgroup\"><code>Require group</code></a> directive, and <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> has been loaded with the <code class=\"directive\"><a href=\"mod_authz_groupfile#authgroupfile\">AuthGroupFile</a></code> directive set.</li> <li>others...</li> </ul> <p><code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> uses the following directives during the compare phase:</p> <table> <tr> <td>\n<code class=\"directive\">AuthLDAPURL</code> </td> <td>The attribute specified in the URL is used in compare operations for the <code>Require ldap-user</code> operation.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPCompareDNOnServer</code></td> <td>Determines the behavior of the <code>Require ldap-dn</code> directive.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPGroupAttribute</code></td> <td>Determines the attribute to use for comparisons in the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPGroupAttributeIsDN</code></td> <td>Specifies whether to use the user DN or the username when doing comparisons for the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPMaxSubGroupDepth</code></td> <td>Determines the maximum depth of sub-groups that will be evaluated during comparisons in the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPSubGroupAttribute</code></td> <td>Determines the attribute to use when obtaining sub-group members of the current group during comparisons in the <code>Require ldap-group</code> directive.</td> </tr> <tr> <td><code class=\"directive\">AuthLDAPSubGroupClass</code></td> <td>Specifies the LDAP objectClass values used to identify if queried directory objects really are group objects (as opposed to user objects) during the <code>Require ldap-group</code> directive's sub-group processing.</td> </tr> </table>   <h2 id=\"requiredirectives\">The Require Directives</h2> <p>Apache's <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives are used during the authorization phase to ensure that a user is allowed to access a resource. mod_authnz_ldap extends the authorization types with <code>ldap-user</code>, <code>ldap-dn</code>, <code>ldap-group</code>, <code>ldap-attribute</code> and <code>ldap-filter</code>. Other authorization types may also be used but may require that additional authorization modules be loaded.</p> <p>Since v2.4.8, <a href=\"../expr\">expressions</a> are supported within the LDAP require directives.</p> <h3><a name=\"requser\" id=\"requser\">Require ldap-user</a></h3> <p>The <code>Require ldap-user</code> directive specifies what usernames can access the resource. Once <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> has retrieved a unique DN from the directory, it does an LDAP compare operation using the username specified in the <code>Require ldap-user</code> to see if that username is part of the just-fetched LDAP entry. Multiple users can be granted access by putting multiple usernames on the line, separated with spaces. If a username has a space in it, then it must be surrounded with double quotes. Multiple users can also be granted access by using multiple <code>Require ldap-user</code> directives, with one user per line. For example, with a <code class=\"directive\"><a href=\"#authldapurl\">AuthLDAPURL</a></code> of <code>ldap://ldap/o=Example?cn</code> (i.e., <code>cn</code> is used for searches), the following Require directives could be used to restrict access:</p> <pre class=\"prettyprint lang-config\">Require ldap-user \"Barbara Jenson\"\nRequire ldap-user \"Fred User\"\nRequire ldap-user \"Joe Manager\"</pre> <p>Because of the way that <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> handles this directive, Barbara Jenson could sign on as <em>Barbara Jenson</em>, <em>Babs Jenson</em> or any other <code>cn</code> that she has in her LDAP entry. Only the single <code>Require ldap-user</code> line is needed to support all values of the attribute in the user's entry.</p> <p>If the <code>uid</code> attribute was used instead of the <code>cn</code> attribute in the URL above, the above three lines could be condensed to</p> <pre class=\"prettyprint lang-config\">Require ldap-user bjenson fuser jmanager</pre> <h3><a name=\"reqgroup\" id=\"reqgroup\">Require ldap-group</a></h3> <p>This directive specifies an LDAP group whose members are allowed access. It takes the distinguished name of the LDAP group. Note: Do not surround the group name with quotes. For example, assume that the following entry existed in the LDAP directory:</p> <div class=\"example\"><pre>dn: cn=Administrators, o=Example\nobjectClass: groupOfUniqueNames\nuniqueMember: cn=Barbara Jenson, o=Example\nuniqueMember: cn=Fred User, o=Example</pre></div> <p>The following directive would grant access to both Fred and Barbara:</p> <pre class=\"prettyprint lang-config\">Require ldap-group cn=Administrators, o=Example</pre> <p>Members can also be found within sub-groups of a specified LDAP group if <code class=\"directive\"><a href=\"#authldapmaxsubgroupdepth\">AuthLDAPMaxSubGroupDepth</a></code> is set to a value greater than 0. For example, assume the following entries exist in the LDAP directory:</p> <div class=\"example\"><pre>dn: cn=Employees, o=Example\nobjectClass: groupOfUniqueNames\nuniqueMember: cn=Managers, o=Example\nuniqueMember: cn=Administrators, o=Example\nuniqueMember: cn=Users, o=Example\n\ndn: cn=Managers, o=Example\nobjectClass: groupOfUniqueNames\nuniqueMember: cn=Bob Ellis, o=Example\nuniqueMember: cn=Tom Jackson, o=Example\n\ndn: cn=Administrators, o=Example\nobjectClass: groupOfUniqueNames\nuniqueMember: cn=Barbara Jenson, o=Example\nuniqueMember: cn=Fred User, o=Example\n\ndn: cn=Users, o=Example\nobjectClass: groupOfUniqueNames\nuniqueMember: cn=Allan Jefferson, o=Example\nuniqueMember: cn=Paul Tilley, o=Example\nuniqueMember: cn=Temporary Employees, o=Example\n\ndn: cn=Temporary Employees, o=Example\nobjectClass: groupOfUniqueNames\nuniqueMember: cn=Jim Swenson, o=Example\nuniqueMember: cn=Elliot Rhodes, o=Example</pre></div> <p>The following directives would allow access for Bob Ellis, Tom Jackson, Barbara Jenson, Fred User, Allan Jefferson, and Paul Tilley but would not allow access for Jim Swenson, or Elliot Rhodes (since they are at a sub-group depth of 2):</p> <pre class=\"prettyprint lang-config\">Require ldap-group cn=Employees, o=Example\nAuthLDAPMaxSubGroupDepth 1</pre> <p>Behavior of this directive is modified by the <code class=\"directive\"><a href=\"#authldapgroupattribute\">AuthLDAPGroupAttribute</a></code>, <code class=\"directive\"><a href=\"#authldapgroupattributeisdn\">AuthLDAPGroupAttributeIsDN</a></code>, <code class=\"directive\"><a href=\"#authldapmaxsubgroupdepth\">AuthLDAPMaxSubGroupDepth</a></code>, <code class=\"directive\"><a href=\"#authldapsubgroupattribute\">AuthLDAPSubGroupAttribute</a></code>, and <code class=\"directive\"><a href=\"#authldapsubgroupclass\">AuthLDAPSubGroupClass</a></code> directives.</p> <h3><a name=\"reqdn\" id=\"reqdn\">Require ldap-dn</a></h3> <p>The <code>Require ldap-dn</code> directive allows the administrator to grant access based on distinguished names. It specifies a DN that must match for access to be granted. If the distinguished name that was retrieved from the directory server matches the distinguished name in the <code>Require ldap-dn</code>, then authorization is granted. Note: do not surround the distinguished name with quotes.</p> <p>The following directive would grant access to a specific DN:</p> <pre class=\"prettyprint lang-config\">Require ldap-dn cn=Barbara Jenson, o=Example</pre> <p>Behavior of this directive is modified by the <code class=\"directive\"><a href=\"#authldapcomparednonserver\">AuthLDAPCompareDNOnServer</a></code> directive.</p> <h3><a name=\"reqattribute\" id=\"reqattribute\">Require ldap-attribute</a></h3> <p>The <code>Require ldap-attribute</code> directive allows the administrator to grant access based on attributes of the authenticated user in the LDAP directory. If the attribute in the directory matches the value given in the configuration, access is granted.</p> <p>The following directive would grant access to anyone with the attribute employeeType = active</p> <pre class=\"prettyprint lang-config\">Require ldap-attribute \"employeeType=active\"</pre> <p>Multiple attribute/value pairs can be specified on the same line separated by spaces or they can be specified in multiple <code>Require ldap-attribute</code> directives. The effect of listing multiple attribute/values pairs is an OR operation. Access will be granted if any of the listed attribute values match the value of the corresponding attribute in the user object. If the value of the attribute contains a space, only the value must be within double quotes.</p> <p>The following directive would grant access to anyone with the city attribute equal to \"San Jose\" or status equal to \"Active\"</p> <pre class=\"prettyprint lang-config\">Require ldap-attribute city=\"San Jose\" \"status=active\"</pre> <h3><a name=\"reqfilter\" id=\"reqfilter\">Require ldap-filter</a></h3> <p>The <code>Require ldap-filter</code> directive allows the administrator to grant access based on a complex LDAP search filter. If the dn returned by the filter search matches the authenticated user dn, access is granted.</p> <p>The following directive would grant access to anyone having a cell phone and is in the marketing department</p> <pre class=\"prettyprint lang-config\">Require ldap-filter \"&amp;(cell=*)(department=marketing)\"</pre> <p>The difference between the <code>Require ldap-filter</code> directive and the <code>Require ldap-attribute</code> directive is that <code>ldap-filter</code> performs a search operation on the LDAP directory using the specified search filter rather than a simple attribute comparison. If a simple attribute comparison is all that is required, the comparison operation performed by <code>ldap-attribute</code> will be faster than the search operation used by <code>ldap-filter</code> especially within a large directory.</p>   <h2 id=\"examples\">Examples</h2> <ul> <li> Grant access to anyone who exists in the LDAP directory, using their UID for searches. <pre class=\"prettyprint lang-config\">AuthLDAPURL \"ldap://ldap1.example.com:389/ou=People, o=Example?uid?sub?(objectClass=*)\"\nRequire valid-user</pre> </li> <li> The next example is the same as above; but with the fields that have useful defaults omitted. Also, note the use of a redundant LDAP server. <pre class=\"prettyprint lang-config\">AuthLDAPURL \"ldap://ldap1.example.com ldap2.example.com/ou=People, o=Example\"\nRequire valid-user</pre> </li> <li> The next example is similar to the previous one, but it uses the common name instead of the UID. Note that this could be problematical if multiple people in the directory share the same <code>cn</code>, because a search on <code>cn</code> <strong>must</strong> return exactly one entry. That's why this approach is not recommended: it's a better idea to choose an attribute that is guaranteed unique in your directory, such as <code>uid</code>. <pre class=\"prettyprint lang-config\">AuthLDAPURL \"ldap://ldap.example.com/ou=People, o=Example?cn\"\nRequire valid-user</pre> </li> <li> Grant access to anybody in the Administrators group. The users must authenticate using their UID. <pre class=\"prettyprint lang-config\">AuthLDAPURL ldap://ldap.example.com/o=Example?uid\nRequire ldap-group cn=Administrators, o=Example</pre> </li> <li> Grant access to anybody in the group whose name matches the hostname of the virtual host. In this example an <a href=\"../expr\">expression</a> is used to build the filter. <pre class=\"prettyprint lang-config\">AuthLDAPURL ldap://ldap.example.com/o=Example?uid\nRequire ldap-group cn=%{SERVER_NAME}, o=Example</pre> </li> <li> The next example assumes that everyone at Example who carries an alphanumeric pager will have an LDAP attribute of <code>qpagePagerID</code>. The example will grant access only to people (authenticated via their UID) who have alphanumeric pagers: <pre class=\"prettyprint lang-config\">AuthLDAPURL ldap://ldap.example.com/o=Example?uid??(qpagePagerID=*)\nRequire valid-user</pre> </li> <li> <p>The next example demonstrates the power of using filters to accomplish complicated administrative requirements. Without filters, it would have been necessary to create a new LDAP group and ensure that the group's members remain synchronized with the pager users. This becomes trivial with filters. The goal is to grant access to anyone who has a pager, plus grant access to Joe Manager, who doesn't have a pager, but does need to access the same resource:</p> <pre class=\"prettyprint lang-config\">AuthLDAPURL ldap://ldap.example.com/o=Example?uid??(|(qpagePagerID=*)(uid=jmanager))\nRequire valid-user</pre> <p>This last may look confusing at first, so it helps to evaluate what the search filter will look like based on who connects, as shown below. If Fred User connects as <code>fuser</code>, the filter would look like</p> <div class=\"example\"><code>(&amp;(|(qpagePagerID=*)(uid=jmanager))(uid=fuser))</code></div> <p>The above search will only succeed if <em>fuser</em> has a pager. When Joe Manager connects as <em>jmanager</em>, the filter looks like</p> <div class=\"example\"><code>(&amp;(|(qpagePagerID=*)(uid=jmanager))(uid=jmanager))</code></div> <p>The above search will succeed whether <em>jmanager</em> has a pager or not.</p> </li> </ul>   <h2 id=\"usingtls\">Using TLS</h2> <p>To use TLS, see the <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> directives <code class=\"directive\"><a href=\"mod_ldap#ldaptrustedclientcert\">LDAPTrustedClientCert</a></code>, <code class=\"directive\"><a href=\"mod_ldap#ldaptrustedglobalcert\">LDAPTrustedGlobalCert</a></code> and <code class=\"directive\"><a href=\"mod_ldap#ldaptrustedmode\">LDAPTrustedMode</a></code>.</p> <p>An optional second parameter can be added to the <code class=\"directive\"><a href=\"#authldapurl\">AuthLDAPURL</a></code> to override the default connection type set by <code class=\"directive\"><a href=\"mod_ldap#ldaptrustedmode\">LDAPTrustedMode</a></code>. This will allow the connection established by an <em>ldap://</em> Url to be upgraded to a secure connection on the same port.</p>   <h2 id=\"usingssl\">Using SSL</h2> <p>To use SSL, see the <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> directives <code class=\"directive\"><a href=\"mod_ldap#ldaptrustedclientcert\">LDAPTrustedClientCert</a></code>, <code class=\"directive\"><a href=\"mod_ldap#ldaptrustedglobalcert\">LDAPTrustedGlobalCert</a></code> and <code class=\"directive\"><a href=\"mod_ldap#ldaptrustedmode\">LDAPTrustedMode</a></code>.</p> <p>To specify a secure LDAP server, use <em>ldaps://</em> in the <code class=\"directive\"><a href=\"#authldapurl\">AuthLDAPURL</a></code> directive, instead of <em>ldap://</em>.</p>   <h2 id=\"exposed\">Exposing Login Information</h2> <p>when this module performs <em>authentication</em>, ldap attributes specified in the <code class=\"directive\"><a href=\"#authldapurl\">authldapurl</a></code> directive are placed in environment variables with the prefix \"AUTHENTICATE_\".</p> <p>when this module performs <em>authorization</em>, ldap attributes specified in the <code class=\"directive\"><a href=\"#authldapurl\">authldapurl</a></code> directive are placed in environment variables with the prefix \"AUTHORIZE_\".</p> <p>If the attribute field contains the username, common name and telephone number of a user, a CGI program will have access to this information without the need to make a second independent LDAP query to gather this additional information.</p> <p>This has the potential to dramatically simplify the coding and configuration required in some web applications.</p>   <h2 id=\"activedirectory\">Using Active Directory</h2> <p>An Active Directory installation may support multiple domains at the same time. To distinguish users between domains, an identifier called a User Principle Name (UPN) can be added to a user's entry in the directory. This UPN usually takes the form of the user's account name, followed by the domain components of the particular domain, for example <em>somebody@nz.example.com</em>.</p> <p>You may wish to configure the <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> module to authenticate users present in any of the domains making up the Active Directory forest. In this way both <em>somebody@nz.example.com</em> and <em>someone@au.example.com</em> can be authenticated using the same query at the same time.</p> <p>To make this practical, Active Directory supports the concept of a Global Catalog. This Global Catalog is a read only copy of selected attributes of all the Active Directory servers within the Active Directory forest. Querying the Global Catalog allows all the domains to be queried in a single query, without the query spanning servers over potentially slow links.</p> <p>If enabled, the Global Catalog is an independent directory server that runs on port 3268 (3269 for SSL). To search for a user, do a subtree search for the attribute <em>userPrincipalName</em>, with an empty search root, like so:</p> <pre class=\"prettyprint lang-config\">AuthLDAPBindDN apache@example.com\nAuthLDAPBindPassword password\nAuthLDAPURL ldap://10.0.0.1:3268/?userPrincipalName?sub</pre> <p>Users will need to enter their User Principal Name as a login, in the form <em>somebody@nz.example.com</em>.</p>   <h2 id=\"frontpage\">Using Microsoft FrontPage with mod_authnz_ldap</h2> <p>Normally, FrontPage uses FrontPage-web-specific user/group files (i.e., the <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> and <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> modules) to handle all authentication. Unfortunately, it is not possible to just change to LDAP authentication by adding the proper directives, because it will break the <em>Permissions</em> forms in the FrontPage client, which attempt to modify the standard text-based authorization files.</p> <p>Once a FrontPage web has been created, adding LDAP authentication to it is a matter of adding the following directives to <em>every</em> <code>.htaccess</code> file that gets created in the web</p> <pre class=\"prettyprint lang-config\">AuthLDAPURL       \"the url\"\nAuthGroupFile     \"mygroupfile\"\nRequire group     \"mygroupfile\"</pre> <h3><a name=\"howitworks\" id=\"howitworks\">How It Works</a></h3> <p>FrontPage restricts access to a web by adding the <code>Require valid-user</code> directive to the <code>.htaccess</code> files. The <code>Require valid-user</code> directive will succeed for any user who is valid <em>as far as LDAP is concerned</em>. This means that anybody who has an entry in the LDAP directory is considered a valid user, whereas FrontPage considers only those people in the local user file to be valid. By substituting the ldap-group with group file authorization, Apache is allowed to consult the local user file (which is managed by FrontPage) - instead of LDAP - when handling authorizing the user.</p> <p>Once directives have been added as specified above, FrontPage users will be able to perform all management operations from the FrontPage client.</p> <h3><a name=\"fpcaveats\" id=\"fpcaveats\">Caveats</a></h3> <ul> <li>When choosing the LDAP URL, the attribute to use for authentication should be something that will also be valid for putting into a <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> user file. The user ID is ideal for this.</li> <li>When adding users via FrontPage, FrontPage administrators should choose usernames that already exist in the LDAP directory (for obvious reasons). Also, the password that the administrator enters into the form is ignored, since Apache will actually be authenticating against the password in the LDAP database, and not against the password in the local user file. This could cause confusion for web administrators.</li> <li>Apache must be compiled with <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code>, <code class=\"module\"><a href=\"mod_authn_file\">mod_authn_file</a></code> and <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> in order to use FrontPage support. This is because Apache will still use the <code class=\"module\"><a href=\"mod_authz_groupfile\">mod_authz_groupfile</a></code> group file for determine the extent of a user's access to the FrontPage web.</li> <li>The directives must be put in the <code>.htaccess</code> files. Attempting to put them inside <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> directives won't work. This is because <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> has to be able to grab the <code class=\"directive\"><a href=\"mod_authz_groupfile#authgroupfile\">AuthGroupFile</a></code> directive that is found in FrontPage <code>.htaccess</code> files so that it knows where to look for the valid user list. If the <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> directives aren't in the same <code>.htaccess</code> file as the FrontPage directives, then the hack won't work, because <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will never get a chance to process the <code>.htaccess</code> file, and won't be able to find the FrontPage-managed user file.</li> </ul>   <div class=\"directive-section\">\n<h2 id=\"authldapauthorizeprefix\">AuthLDAPAuthorizePrefix Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the prefix for environment variables set during authorization</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPAuthorizePrefix prefix</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPAuthorizePrefix AUTHORIZE_</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.6 and later</td>\n</tr> </table> <p>This directive allows you to override the prefix used for environment variables set during LDAP authorization. If <em>AUTHENTICATE_</em> is specified, consumers of these environment variables see the same information whether LDAP has performed authentication, authorization, or both.</p> <div class=\"note\">\n<p><strong>Note</strong></p> No authorization variables are set when a user is authorized on the basis of <code>Require valid-user</code>. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapbindauthoritative\">AuthLDAPBindAuthoritative Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines if other authentication providers are used when a user can be mapped to a DN but the server cannot successfully bind with the user's credentials.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPBindAuthoritative off|on</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPBindAuthoritative on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>By default, subsequent authentication providers are only queried if a user cannot be mapped to a DN, but not if the user can be mapped to a DN and their password cannot be verified with an LDAP bind. If <code class=\"directive\">AuthLDAPBindAuthoritative</code> is set to <em>off</em>, other configured authentication modules will have a chance to validate the user if the LDAP bind (with the current user's credentials) fails for any reason.</p> <p> This allows users present in both LDAP and <code class=\"directive\"><a href=\"mod_authn_file#authuserfile\">AuthUserFile</a></code> to authenticate when the LDAP server is available but the user's account is locked or password is otherwise unusable.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_authn_file#authuserfile\">AuthUserFile</a></code></li> <li><code class=\"directive\"><a href=\"mod_auth_basic#authbasicprovider\">AuthBasicProvider</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapbinddn\">AuthLDAPBindDN Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Optional DN to use in binding to the LDAP server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPBindDN distinguished-name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>An optional DN used to bind to the server when searching for entries. If not provided, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will use an anonymous bind.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapbindpassword\">AuthLDAPBindPassword Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Password used in conjuction with the bind DN</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPBindPassword password</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>\n<em>exec:</em> was added in 2.4.5.</td>\n</tr> </table> <p>A bind password to use in conjunction with the bind DN. Note that the bind password is probably sensitive data, and should be properly protected. You should only use the <code class=\"directive\"><a href=\"#authldapbinddn\">AuthLDAPBindDN</a></code> and <code class=\"directive\">AuthLDAPBindPassword</code> if you absolutely need them to search the directory.</p> <p>If the value begins with exec: the resulting command will be executed and the first line returned to standard output by the program will be used as the password.</p> <pre class=\"prettyprint lang-config\">#Password used as-is\nAuthLDAPBindPassword secret\n\n#Run /path/to/program to get my password\nAuthLDAPBindPassword exec:/path/to/program\n\n#Run /path/to/otherProgram and provide arguments\nAuthLDAPBindPassword \"exec:/path/to/otherProgram argument1\"</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapcharsetconfig\">AuthLDAPCharsetConfig Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Language to charset conversion configuration file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPCharsetConfig file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>The <code class=\"directive\">AuthLDAPCharsetConfig</code> directive sets the location of the language to charset conversion configuration file. <var>File-path</var> is relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>. This file specifies the list of language extensions to character sets. Most administrators use the provided <code>charset.conv</code> file, which associates common language extensions to character sets.</p> <p>The file contains lines in the following format:</p> <div class=\"example\"><pre>Language-Extension charset [Language-String] ...</pre></div> <p>The case of the extension does not matter. Blank lines, and lines beginning with a hash character (<code>#</code>) are ignored.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapcompareasuser\">AuthLDAPCompareAsUser Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use the authenticated user's credentials to perform authorization comparisons</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPCompareAsUser on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPCompareAsUser off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.6 and later</td>\n</tr> </table> <p>When set, and <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> has authenticated the user, LDAP comparisons for authorization use the queried distinguished name (DN) and HTTP basic authentication password of the authenticated user instead of the servers configured credentials.</p> <p> The <em>ldap-attribute</em>, <em>ldap-user</em>, and <em>ldap-group</em> (single-level only) authorization checks use comparisons.</p> <p>This directive only has effect on the comparisons performed during nested group processing when <code class=\"directive\"><a href=\"#authldapsearchasuser\"> AuthLDAPSearchAsUser</a></code> is also enabled.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous comparisons and you cannot use a dedicated <code class=\"directive\"><a href=\"#authldapbinddn\">AuthLDAPBindDN</a></code>. </p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#authldapinitialbindasuser\">AuthLDAPInitialBindAsUser</a></code></li> <li><code class=\"directive\"><a href=\"#authldapsearchasuser\">AuthLDAPSearchAsUser</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapcomparednonserver\">AuthLDAPCompareDNOnServer Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use the LDAP server to compare the DNs</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPCompareDNOnServer on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPCompareDNOnServer on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>When set, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will use the LDAP server to compare the DNs. This is the only foolproof way to compare DNs. <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will search the directory for the DN specified with the <a href=\"#reqdn\"><code>Require dn</code></a> directive, then, retrieve the DN and compare it with the DN retrieved from the user entry. If this directive is not set, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> simply does a string comparison. It is possible to get false negatives with this approach, but it is much faster. Note the <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code> cache can speed up DN comparison in most situations.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapdereferencealiases\">AuthLDAPDereferenceAliases Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>When will the module de-reference aliases</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPDereferenceAliases never|searching|finding|always</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPDereferenceAliases always</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>This directive specifies when <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will de-reference aliases during LDAP operations. The default is <code>always</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapgroupattribute\">AuthLDAPGroupAttribute Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>LDAP attributes used to identify the user members of groups.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPGroupAttribute attribute</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPGroupAttribute member uniquemember</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>This directive specifies which LDAP attributes are used to check for user members within groups. Multiple attributes can be used by specifying this directive multiple times. If not specified, then <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> uses the <code>member</code> and <code>uniquemember</code> attributes.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapgroupattributeisdn\">AuthLDAPGroupAttributeIsDN Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use the DN of the client username when checking for group membership</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPGroupAttributeIsDN on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPGroupAttributeIsDN on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>When set <code>on</code>, this directive says to use the distinguished name of the client username when checking for group membership. Otherwise, the username will be used. For example, assume that the client sent the username <code>bjenson</code>, which corresponds to the LDAP DN <code>cn=Babs Jenson, o=Example</code>. If this directive is set, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will check if the group has <code>cn=Babs Jenson, o=Example</code> as a member. If this directive is not set, then <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will check if the group has <code>bjenson</code> as a member.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapinitialbindasuser\">AuthLDAPInitialBindAsUser Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines if the server does the initial DN lookup using the basic authentication users' own username, instead of anonymously or with hard-coded credentials for the server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPInitialBindAsUser off|on</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPInitialBindAsUser off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.6 and later</td>\n</tr> </table> <p>By default, the server either anonymously, or with a dedicated user and password, converts the basic authentication username into an LDAP distinguished name (DN). This directive forces the server to use the verbatim username and password provided by the incoming user to perform the initial DN search.</p> <p> If the verbatim username can't directly bind, but needs some cosmetic transformation, see <code class=\"directive\"><a href=\"#authldapinitialbindpattern\"> AuthLDAPInitialBindPattern</a></code>.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous searches and you cannot use a dedicated <code class=\"directive\"><a href=\"#authldapbinddn\">AuthLDAPBindDN</a></code>. </p> <div class=\"note\">\n<p><strong>Not available with authorization-only</strong></p> This directive can only be used if this module authenticates the user, and has no effect when this module is used exclusively for authorization. </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#authldapinitialbindpattern\">AuthLDAPInitialBindPattern</a></code></li> <li><code class=\"directive\"><a href=\"#authldapbinddn\">AuthLDAPBindDN</a></code></li> <li><code class=\"directive\"><a href=\"#authldapcompareasuser\">AuthLDAPCompareAsUser</a></code></li> <li><code class=\"directive\"><a href=\"#authldapsearchasuser\">AuthLDAPSearchAsUser</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapinitialbindpattern\">AuthLDAPInitialBindPattern Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the transformation of the basic authentication username to be used when binding to the LDAP server to perform a DN lookup</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPInitialBindPattern regex substitution</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPInitialBindPattern (.*) $1 (remote username used verbatim)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.6 and later</td>\n</tr> </table> <p>If <code class=\"directive\"><a href=\"#authldapinitialbindasuser\">AuthLDAPInitialBindAsUser</a></code> is set to <em>ON</em>, the basic authentication username will be transformed according to the regular expression and substitution arguments.</p> <p> The regular expression argument is compared against the current basic authentication username. The substitution argument may contain backreferences, but has no other variable interpolation.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous searches and you cannot use a dedicated <code class=\"directive\"><a href=\"#authldapbinddn\">AuthLDAPBindDN</a></code>. </p> <pre class=\"prettyprint lang-config\">AuthLDAPInitialBindPattern (.+) $1@example.com</pre> <pre class=\"prettyprint lang-config\">AuthLDAPInitialBindPattern (.+) cn=$1,dc=example,dc=com</pre> <div class=\"note\">\n<p><strong>Not available with authorization-only</strong></p> This directive can only be used if this module authenticates the user, and has no effect when this module is used exclusively for authorization. </div> <div class=\"note\">\n<p><strong>debugging</strong></p> The substituted DN is recorded in the environment variable <em>LDAP_BINDASUSER</em>. If the regular expression does not match the input, the verbatim username is used. </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#authldapinitialbindasuser\">AuthLDAPInitialBindAsUser</a></code></li> <li><code class=\"directive\"><a href=\"#authldapbinddn\">AuthLDAPBindDN</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapmaxsubgroupdepth\">AuthLDAPMaxSubGroupDepth Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the maximum sub-group nesting depth that will be evaluated before the user search is discontinued.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPMaxSubGroupDepth Number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPMaxSubGroupDepth 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.0 and later</td>\n</tr> </table> <p>When this directive is set to a non-zero value <code>X</code> combined with use of the <code>Require ldap-group someGroupDN</code> directive, the provided user credentials will be searched for as a member of the <code>someGroupDN</code> directory object or of any group member of the current group up to the maximum nesting level <code>X</code> specified by this directive.</p> <p>See the <a href=\"#reqgroup\"><code>Require ldap-group</code></a> section for a more detailed example.</p> <div class=\"note\">\n<p><strong>Nested groups performance</strong></p> <p> When <code class=\"directive\">AuthLDAPSubGroupAttribute</code> overlaps with <code class=\"directive\">AuthLDAPGroupAttribute</code> (as it does by default and as required by common LDAP schemas), uncached searching for subgroups in large groups can be very slow. If you use large, non-nested groups, set <code class=\"directive\">AuthLDAPMaxSubGroupDepth</code> to zero.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapremoteuserattribute\">AuthLDAPRemoteUserAttribute Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use the value of the attribute returned during the user query to set the REMOTE_USER environment variable</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPRemoteUserAttribute uid</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>If this directive is set, the value of the <code>REMOTE_USER</code> environment variable will be set to the value of the attribute specified. Make sure that this attribute is included in the list of attributes in the AuthLDAPUrl definition, otherwise this directive will have no effect. This directive, if present, takes precedence over <code class=\"directive\"><a href=\"#authldapremoteuserisdn\">AuthLDAPRemoteUserIsDN</a></code>. This directive is useful should you want people to log into a website using an email address, but a backend application expects the username as a userid.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapremoteuserisdn\">AuthLDAPRemoteUserIsDN Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use the DN of the client username to set the REMOTE_USER environment variable</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPRemoteUserIsDN on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPRemoteUserIsDN off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>If this directive is set to on, the value of the <code>REMOTE_USER</code> environment variable will be set to the full distinguished name of the authenticated user, rather than just the username that was passed by the client. It is turned off by default.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapsearchasuser\">AuthLDAPSearchAsUser Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use the authenticated user's credentials to perform authorization searches</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPSearchAsUser on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPSearchAsUser off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.6 and later</td>\n</tr> </table> <p>When set, and <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> has authenticated the user, LDAP searches for authorization use the queried distinguished name (DN) and HTTP basic authentication password of the authenticated user instead of the servers configured credentials.</p> <p> The <em>ldap-filter</em> and <em>ldap-dn</em> authorization checks use searches.</p> <p>This directive only has effect on the comparisons performed during nested group processing when <code class=\"directive\"><a href=\"#authldapcompareasuser\"> AuthLDAPCompareAsUser</a></code> is also enabled.</p> <p> This directive should only be used when your LDAP server doesn't accept anonymous searches and you cannot use a dedicated <code class=\"directive\"><a href=\"#authldapbinddn\">AuthLDAPBindDN</a></code>. </p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#authldapinitialbindasuser\">AuthLDAPInitialBindAsUser</a></code></li> <li><code class=\"directive\"><a href=\"#authldapcompareasuser\">AuthLDAPCompareAsUser</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapsubgroupattribute\">AuthLDAPSubGroupAttribute Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the attribute labels, one value per directive line, used to distinguish the members of the current group that are groups.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPSubGroupAttribute attribute</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPSubgroupAttribute member uniquemember</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.0 and later</td>\n</tr> </table> <p>An LDAP group object may contain members that are users and members that are groups (called nested or sub groups). The <code class=\"directive\">AuthLDAPSubGroupAttribute</code> directive identifies the labels of group members and the <code class=\"directive\"><a href=\"#authldapgroupattribute\">AuthLDAPGroupAttribute</a></code> directive identifies the labels of the user members. Multiple attributes can be used by specifying this directive multiple times. If not specified, then <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> uses the <code>member</code> and <code>uniqueMember</code> attributes.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapsubgroupclass\">AuthLDAPSubGroupClass Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies which LDAP objectClass values identify directory objects that are groups during sub-group processing.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPSubGroupClass LdapObjectClass</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AuthLDAPSubGroupClass groupOfNames groupOfUniqueNames</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.0 and later</td>\n</tr> </table> <p>An LDAP group object may contain members that are users and members that are groups (called nested or sub groups). The <code class=\"directive\"><a href=\"#authldapsubgroupattribute\">AuthLDAPSubGroupAttribute</a></code> directive identifies the labels of members that may be sub-groups of the current group (as opposed to user members). The <code class=\"directive\">AuthLDAPSubGroupClass</code> directive specifies the LDAP objectClass values used in verifying that these potential sub-groups are in fact group objects. Verified sub-groups can then be searched for more user or sub-group members. Multiple attributes can be used by specifying this directive multiple times. If not specified, then <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> uses the <code>groupOfNames</code> and <code>groupOfUniqueNames</code> values.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"authldapurl\">AuthLDAPUrl Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>URL specifying the LDAP search parameters</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AuthLDAPUrl url [NONE|SSL|TLS|STARTTLS]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_authnz_ldap</td>\n</tr> </table> <p>An RFC 2255 URL which specifies the LDAP search parameters to use. The syntax of the URL is</p> <div class=\"example\"><code>ldap://host:port/basedn?attribute?scope?filter</code></div> <p>If you want to specify more than one LDAP URL that Apache should try in turn, the syntax is:</p> <pre class=\"prettyprint lang-config\">AuthLDAPUrl \"ldap://ldap1.example.com ldap2.example.com/dc=...\"</pre> <p><em><strong>Caveat: </strong>If you specify multiple servers, you need to enclose the entire URL string in quotes; otherwise you will get an error: \"AuthLDAPURL takes one argument, URL to define LDAP connection..\" </em> You can of course use search parameters on each of these.</p> <dl> <dt>ldap</dt> <dd>For regular ldap, use the string <code>ldap</code>. For secure LDAP, use <code>ldaps</code> instead. Secure LDAP is only available if Apache was linked to an LDAP library with SSL support.</dd> <dt>host:port</dt> <dd> <p>The name/port of the ldap server (defaults to <code>localhost:389</code> for <code>ldap</code>, and <code>localhost:636</code> for <code>ldaps</code>). To specify multiple, redundant LDAP servers, just list all servers, separated by spaces. <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will try connecting to each server in turn, until it makes a successful connection. If multiple ldap servers are specified, then entire LDAP URL must be encapsulated in double quotes.</p> <p>Once a connection has been made to a server, that connection remains active for the life of the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> process, or until the LDAP server goes down.</p> <p>If the LDAP server goes down and breaks an existing connection, <code class=\"module\"><a href=\"mod_authnz_ldap\">mod_authnz_ldap</a></code> will attempt to re-connect, starting with the primary server, and trying each redundant server in turn. Note that this is different than a true round-robin search.</p> </dd> <dt>basedn</dt> <dd>The DN of the branch of the directory where all searches should start from. At the very least, this must be the top of your directory tree, but could also specify a subtree in the directory.</dd> <dt>attribute</dt> <dd>The attribute to search for. Although RFC 2255 allows a comma-separated list of attributes, only the first attribute will be used, no matter how many are provided. If no attributes are provided, the default is to use <code>uid</code>. It's a good idea to choose an attribute that will be unique across all entries in the subtree you will be using. All attributes listed will be put into the environment with an AUTHENTICATE_ prefix for use by other modules.</dd> <dt>scope</dt> <dd>The scope of the search. Can be either <code>one</code> or <code>sub</code>. Note that a scope of <code>base</code> is also supported by RFC 2255, but is not supported by this module. If the scope is not provided, or if <code>base</code> scope is specified, the default is to use a scope of <code>sub</code>.</dd> <dt>filter</dt> <dd>A valid LDAP search filter. If not provided, defaults to <code>(objectClass=*)</code>, which will search for all objects in the tree. Filters are limited to approximately 8000 characters (the definition of <code>MAX_STRING_LEN</code> in the Apache source code). This should be more than sufficient for any application. In 2.4.10 and later, the keyword <code>none</code> disables the use of a filter; this is required by some primitive LDAP servers.</dd> </dl> <p>When doing searches, the attribute, filter and username passed by the HTTP client are combined to create a search filter that looks like <code>(&amp;(<em>filter</em>)(<em>attribute</em>=<em>username</em>))</code>.</p> <p>For example, consider an URL of <code>ldap://ldap.example.com/o=Example?cn?sub?(posixid=*)</code>. When a client attempts to connect using a username of <code>Babs Jenson</code>, the resulting search filter will be <code>(&amp;(posixid=*)(cn=Babs Jenson))</code>.</p> <p>An optional parameter can be added to allow the LDAP Url to override the connection type. This parameter can be one of the following:</p> <dl> <dt>NONE</dt> <dd>Establish an unsecure connection on the default LDAP port. This is the same as <code>ldap://</code> on port 389.</dd> <dt>SSL</dt> <dd>Establish a secure connection on the default secure LDAP port. This is the same as <code>ldaps://</code>\n</dd> <dt>TLS | STARTTLS</dt> <dd>Establish an upgraded secure connection on the default LDAP port. This connection will be initiated on port 389 by default and then upgraded to a secure connection on the same port.</dd> </dl> <p>See above for examples of <code class=\"directive\"><a href=\"#authldapurl\">AuthLDAPUrl</a></code> URLs.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_authnz_ldap.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_authnz_ldap.html</a>\n  </p>\n</div>\n","mod/mod_dav":"<h1>Apache Module mod_dav</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Distributed Authoring and Versioning (<a href=\"http://www.webdav.org/\">WebDAV</a>) functionality</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>dav_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_dav.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides class 1 and class 2 <a href=\"http://www.webdav.org\">WebDAV</a> ('Web-based Distributed Authoring and Versioning') functionality for Apache. This extension to the HTTP protocol allows creating, moving, copying, and deleting resources and collections on a remote web server.</p>     <h2 id=\"example\">Enabling WebDAV</h2> <p>To enable <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>, add the following to a container in your <code>httpd.conf</code> file:</p> <pre class=\"prettyprint lang-config\">Dav On</pre> <p>This enables the DAV file system provider, which is implemented by the <code class=\"module\"><a href=\"mod_dav_fs\">mod_dav_fs</a></code> module. Therefore, that module must be compiled into the server or loaded at runtime using the <code class=\"directive\"><a href=\"mod_so#loadmodule\">LoadModule</a></code> directive.</p> <p>In addition, a location for the DAV lock database must be specified in the global section of your <code>httpd.conf</code> file using the <code class=\"directive\"><a href=\"mod_dav_fs#davlockdb\">DavLockDB</a></code> directive:</p> <pre class=\"prettyprint lang-config\">DavLockDB /usr/local/apache2/var/DavLock</pre> <p>The directory containing the lock database file must be writable by the <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> and <code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code> under which Apache is running.</p> <p>You may wish to add a <code class=\"directive\"><a href=\"core#limit\">&lt;Limit&gt;</a></code> clause inside the <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> directive to limit access to DAV-enabled locations. If you want to set the maximum amount of bytes that a DAV client can send at one request, you have to use the <code class=\"directive\"><a href=\"core#limitxmlrequestbody\">LimitXMLRequestBody</a></code> directive. The \"normal\" <code class=\"directive\"><a href=\"core#limitrequestbody\">LimitRequestBody</a></code> directive has no effect on DAV requests.</p> <div class=\"example\">\n<h3>Full Example</h3>\n<pre class=\"prettyprint lang-config\">DavLockDB \"/usr/local/apache2/var/DavLock\"\n\n&lt;Directory \"/usr/local/apache2/htdocs/foo\"&gt;\n    Require all granted\n    Dav On\n\n    AuthType Basic\n    AuthName DAV\n    AuthUserFile \"user.passwd\"\n\n    &lt;LimitExcept GET POST OPTIONS&gt;\n        Require user admin\n    &lt;/LimitExcept&gt;\n&lt;/Directory&gt;</pre> </div>   <h2 id=\"security\">Security Issues</h2> <p>Since DAV access methods allow remote clients to manipulate files on the server, you must take particular care to assure that your server is secure before enabling <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>.</p> <p>Any location on the server where DAV is enabled should be protected by authentication. The use of HTTP Basic Authentication is not recommended. You should use at least HTTP Digest Authentication, which is provided by the <code class=\"module\"><a href=\"mod_auth_digest\">mod_auth_digest</a></code> module. Nearly all WebDAV clients support this authentication method. An alternative is Basic Authentication over an <a href=\"../ssl/index\">SSL</a> enabled connection.</p> <p>In order for <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code> to manage files, it must be able to write to the directories and files under its control using the <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> and <code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code> under which Apache is running. New files created will also be owned by this <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> and <code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code>. For this reason, it is important to control access to this account. The DAV repository is considered private to Apache; modifying files outside of Apache (for example using FTP or filesystem-level tools) should not be allowed.</p> <p><code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code> may be subject to various kinds of denial-of-service attacks. The <code class=\"directive\"><a href=\"core#limitxmlrequestbody\">LimitXMLRequestBody</a></code> directive can be used to limit the amount of memory consumed in parsing large DAV requests. The <code class=\"directive\"><a href=\"#davdepthinfinity\">DavDepthInfinity</a></code> directive can be used to prevent <code>PROPFIND</code> requests on a very large repository from consuming large amounts of memory. Another possible denial-of-service attack involves a client simply filling up all available disk space with many large files. There is no direct way to prevent this in Apache, so you should avoid giving DAV access to untrusted users.</p>   <h2 id=\"complex\">Complex Configurations</h2> <p>One common request is to use <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code> to manipulate dynamic files (PHP scripts, CGI scripts, etc). This is difficult because a <code>GET</code> request will always run the script, rather than downloading its contents. One way to avoid this is to map two different URLs to the content, one of which will run the script, and one of which will allow it to be downloaded and manipulated with DAV.</p> <pre class=\"prettyprint lang-config\">Alias \"/phparea\" \"/home/gstein/php_files\"\nAlias \"/php-source\" \"/home/gstein/php_files\"\n&lt;Location \"/php-source\"&gt;\n    Dav On\n    ForceType text/plain\n&lt;/Location&gt;</pre> <p>With this setup, <code>http://example.com/phparea</code> can be used to access the output of the PHP scripts, and <code>http://example.com/php-source</code> can be used with a DAV client to manipulate them.</p>   <div class=\"directive-section\">\n<h2 id=\"dav\">Dav Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable WebDAV HTTP methods</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Dav On|Off|provider-name</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Dav Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dav</td>\n</tr> </table> <p>Use the <code class=\"directive\">Dav</code> directive to enable the WebDAV HTTP methods for the given container:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/foo\"&gt;\n    Dav On\n&lt;/Location&gt;</pre> <p>The value <code>On</code> is actually an alias for the default provider <code>filesystem</code> which is served by the <code class=\"module\"><a href=\"mod_dav_fs\">mod_dav_fs</a></code> module. Note, that once you have DAV enabled for some location, it <em>cannot</em> be disabled for sublocations. For a complete configuration example have a look at the <a href=\"#example\">section above</a>.</p> <div class=\"warning\"> Do not enable WebDAV until you have secured your server. Otherwise everyone will be able to distribute files on your system. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"davdepthinfinity\">DavDepthInfinity Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Allow PROPFIND, Depth: Infinity requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DavDepthInfinity on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DavDepthInfinity off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dav</td>\n</tr> </table> <p>Use the <code class=\"directive\">DavDepthInfinity</code> directive to allow the processing of <code>PROPFIND</code> requests containing the header 'Depth: Infinity'. Because this type of request could constitute a denial-of-service attack, by default it is not allowed.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"davmintimeout\">DavMinTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Minimum amount of time the server holds a lock on a DAV resource</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DavMinTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DavMinTimeout 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dav</td>\n</tr> </table> <p>When a client requests a DAV resource lock, it can also specify a time when the lock will be automatically removed by the server. This value is only a request, and the server can ignore it or inform the client of an arbitrary value.</p> <p>Use the <code class=\"directive\">DavMinTimeout</code> directive to specify, in seconds, the minimum lock timeout to return to a client. Microsoft Web Folders defaults to a timeout of 120 seconds; the <code class=\"directive\">DavMinTimeout</code> can override this to a higher value (like 600 seconds) to reduce the chance of the client losing the lock due to network latency.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/MSWord\"&gt;\n    DavMinTimeout 600\n&lt;/Location&gt;</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_dav.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_dav.html</a>\n  </p>\n</div>\n","mod/mod_dav_lock":"<h1>Apache Module mod_dav_lock</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Generic locking module for <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>dav_lock_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_dav_lock.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module implements a generic locking API which can be used by any backend provider of <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>. It <em>requires</em> at least the service of <code class=\"module\"><a href=\"mod_dav\">mod_dav</a></code>. But without a backend provider which makes use of it, it's useless and should not be loaded into the server. A sample backend module which actually utilizes <code class=\"module\"><a href=\"mod_dav_lock\">mod_dav_lock</a></code> is <a href=\"http://subversion.apache.org/\">mod_dav_svn</a>, the subversion provider module.</p> <p>Note that <code class=\"module\"><a href=\"mod_dav_fs\">mod_dav_fs</a></code> does <em>not</em> need this generic locking module, because it uses its own more specialized version.</p> <p>In order to make <code class=\"module\"><a href=\"mod_dav_lock\">mod_dav_lock</a></code> functional, you just have to specify the location of the lock database using the <code class=\"directive\"><a href=\"#davgenericlockdb\">DavGenericLockDB</a></code> directive described below.</p> <div class=\"note\">\n<p><strong>Developer's Note</strong></p> <p>In order to retrieve the pointer to the locking provider function, you have to use the <code>ap_lookup_provider</code> API with the arguments <code>dav-lock</code>, <code>generic</code>, and <code>0</code>.</p> </div>    <div class=\"directive-section\">\n<h2 id=\"davgenericlockdb\">DavGenericLockDB Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Location of the DAV lock database</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DavGenericLockDB file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dav_lock</td>\n</tr> </table> <p>Use the <code class=\"directive\">DavGenericLockDB</code> directive to specify the full path to the lock database, excluding an extension. If the path is not absolute, it will be interpreted relative to <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>. The implementation of <code class=\"module\"><a href=\"mod_dav_lock\">mod_dav_lock</a></code> uses a SDBM database to track user locks.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">DavGenericLockDB var/DavLock</pre> </div> <p>The directory containing the lock database file must be writable by the <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> and <code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code> under which Apache is running. For security reasons, you should create a directory for this purpose rather than changing the permissions on an existing directory. In the above example, Apache will create files in the <code>var/</code> directory under the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code> with the base filename <code>DavLock</code> and an extension added by the server.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_dav_lock.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_dav_lock.html</a>\n  </p>\n</div>\n","mod/mod_dialup":"<h1>Apache Module mod_dialup</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Send static content at a bandwidth rate limit, defined by the various old modem standards</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>dialup_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_dialup.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>It is a module that sends static content at a bandwidth rate limit, defined by the various old modem standards. So, you can browse your site with a 56k V.92 modem, by adding something like this:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/mysite\"&gt;\n    ModemStandard \"V.92\"\n&lt;/Location&gt;</pre> <p>Previously to do bandwidth rate limiting modules would have to block an entire thread, for each client, and insert sleeps to slow the bandwidth down. Using the new suspend feature, a handler can get callback N milliseconds in the future, and it will be invoked by the Event MPM on a different thread, once the timer hits. From there the handler can continue to send data to the client.</p>    <div class=\"directive-section\">\n<h2 id=\"modemstandard\">ModemStandard Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Modem standard to simulate</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ModemStandard V.21|V.26bis|V.32|V.34|V.92</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dialup</td>\n</tr> </table> <p>Specify what modem standard you wish to simulate.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/mysite\"&gt;\n    ModemStandard \"V.26bis\"\n&lt;/Location&gt;</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_dialup.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_dialup.html</a>\n  </p>\n</div>\n","mod/mod_autoindex":"<h1>Apache Module mod_autoindex</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Generates directory indexes, automatically, similar to the Unix <code>ls</code> command or the Win32 <code>dir</code> shell command</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>autoindex_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_autoindex.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The index of a directory can come from one of two sources:</p> <ul> <li>A file located in that directory, typically called <code>index.html</code>. The <code class=\"directive\"><a href=\"mod_dir#directoryindex\">DirectoryIndex</a></code> directive sets the name of the file or files to be used. This is controlled by <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code>.</li> <li>Otherwise, a listing generated by the server. The other directives control the format of this listing. The <code class=\"directive\"><a href=\"#addicon\">AddIcon</a></code>, <code class=\"directive\"><a href=\"#addiconbyencoding\">AddIconByEncoding</a></code> and <code class=\"directive\"><a href=\"#addiconbytype\">AddIconByType</a></code> are used to set a list of icons to display for various file types; for each file listed, the first icon listed that matches the file is displayed. These are controlled by <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code>.</li> </ul> <p>The two functions are separated so that you can completely remove (or replace) automatic index generation should you want to.</p> <p>Automatic index generation is enabled with using <code>Options +Indexes</code>. See the <code class=\"directive\"><a href=\"core#options\">Options</a></code> directive for more details.</p> <p>If the <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code> option is given with the <code class=\"directive\"><a href=\"#indexoptions\">IndexOptions</a></code> directive, the column headers are links that control the order of the display. If you select a header link, the listing will be regenerated, sorted by the values in that column. Selecting the same header repeatedly toggles between ascending and descending order. These column header links are suppressed with the <code class=\"directive\"><a href=\"#indexoptions\">IndexOptions</a></code> directive's <code><a href=\"#indexoptions.suppresscolumnsorting\">SuppressColumnSorting</a></code> option.</p> <p>Note that when the display is sorted by \"Size\", it's the <em>actual</em> size of the files that's used, not the displayed value - so a 1010-byte file will always be displayed before a 1011-byte file (if in ascending order) even though they both are shown as \"1K\".</p>     <h2 id=\"query\">Autoindex Request Query Arguments</h2> <p>Various query string arguments are available to give the client some control over the ordering of the directory listing, as well as what files are listed. If you do not wish to give the client this control, the <code><a href=\"#indexoptions.ignoreclient\">IndexOptions IgnoreClient</a></code> option disables that functionality.</p> <p>The column sorting headers themselves are self-referencing hyperlinks that add the sort query options shown below. Any option below may be added to any request for the directory resource.</p> <ul> <li>\n<code>C=N</code> sorts the directory by file name</li> <li>\n<code>C=M</code> sorts the directory by last-modified date, then file name</li> <li>\n<code>C=S</code> sorts the directory by size, then file name</li> <li class=\"separate\">\n<code>C=D</code> sorts the directory by description, then file name</li> <li>\n<code>O=A</code> sorts the listing in Ascending Order</li> <li class=\"separate\">\n<code>O=D</code> sorts the listing in Descending Order</li> <li>\n<code>F=0</code> formats the listing as a simple list (not FancyIndexed)</li> <li>\n<code>F=1</code> formats the listing as a FancyIndexed list</li> <li class=\"separate\">\n<code>F=2</code> formats the listing as an HTMLTable FancyIndexed list</li> <li>\n<code>V=0</code> disables version sorting</li> <li class=\"separate\">\n<code>V=1</code> enables version sorting</li> <li>\n<code>P=pattern</code> lists only files matching the given <var>pattern</var>\n</li> </ul> <p>Note that the 'P'attern query argument is tested <em>after</em> the usual <code class=\"directive\"><a href=\"#indexignore\">IndexIgnore</a></code> directives are processed, and all file names are still subjected to the same criteria as any other autoindex listing. The Query Arguments parser in <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> will stop abruptly when an unrecognized option is encountered. The Query Arguments must be well formed, according to the table above.</p> <p>The simple example below, which can be clipped and saved in a header.html file, illustrates these query options. Note that the unknown \"X\" argument, for the submit button, is listed last to assure the arguments are all parsed before mod_autoindex encounters the X=Go input.</p> <div class=\"example\"><pre>&lt;form action=\"\" method=\"get\"&gt;\n Show me a &lt;select name=\"F\"&gt;\n &lt;option value=\"0\"&gt; Plain list&lt;/option&gt;\n&lt;option value=\"1\" selected=\"selected\"&gt; Fancy list&lt;/option&gt;\n&lt;option value=\"2\"&gt; Table list&lt;/option&gt;\n &lt;/select&gt;\nSorted by &lt;select name=\"C\"&gt;\n &lt;option value=\"N\" selected=\"selected\"&gt; Name&lt;/option&gt;\n&lt;option value=\"M\"&gt; Date Modified&lt;/option&gt;\n&lt;option value=\"S\"&gt; Size&lt;/option&gt;\n&lt;option value=\"D\"&gt; Description&lt;/option&gt;\n &lt;/select&gt;\n&lt;select name=\"O\"&gt;\n &lt;option value=\"A\" selected=\"selected\"&gt; Ascending&lt;/option&gt;\n&lt;option value=\"D\"&gt; Descending&lt;/option&gt;\n &lt;/select&gt;\n&lt;select name=\"V\"&gt;\n &lt;option value=\"0\" selected=\"selected\"&gt; in Normal order&lt;/option&gt;\n&lt;option value=\"1\"&gt; in Version order&lt;/option&gt;\n &lt;/select&gt;\nMatching &lt;input type=\"text\" name=\"P\" value=\"*\" /&gt;\n&lt;input type=\"submit\" name=\"X\" value=\"Go\" /&gt;\n &lt;/form&gt;</pre></div>   <div class=\"directive-section\">\n<h2 id=\"addalt\">AddAlt Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Alternate text to display for a file, instead of an icon selected by filename</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddAlt string file [file] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p><code class=\"directive\">AddAlt</code> provides the alternate text to display for a file, instead of an icon, for <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>File</var> is a file extension, partial filename, wild-card expression or full filename for files to describe. If <var>String</var> contains any whitespace, you have to enclose it in quotes (<code>\"</code> or <code>'</code>). This alternate text is displayed if the client is image-incapable, has image loading disabled, or fails to retrieve the icon.</p> <pre class=\"prettyprint lang-config\">AddAlt \"PDF file\" *.pdf\nAddAlt Compressed *.gz *.zip *.Z</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"addaltbyencoding\">AddAltByEncoding Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Alternate text to display for a file instead of an icon selected by MIME-encoding</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddAltByEncoding string MIME-encoding [MIME-encoding] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p><code class=\"directive\">AddAltByEncoding</code> provides the alternate text to display for a file, instead of an icon, for <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>MIME-encoding</var> is a valid content-encoding, such as <code>x-compress</code>. If <var>String</var> contains any whitespace, you have to enclose it in quotes (<code>\"</code> or <code>'</code>). This alternate text is displayed if the client is image-incapable, has image loading disabled, or fails to retrieve the icon.</p> <pre class=\"prettyprint lang-config\">AddAltByEncoding gzip x-gzip</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"addaltbytype\">AddAltByType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Alternate text to display for a file, instead of an icon selected by MIME content-type</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddAltByType string MIME-type [MIME-type] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p><code class=\"directive\">AddAltByType</code> sets the alternate text to display for a file, instead of an icon, for <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>MIME-type</var> is a valid content-type, such as <code>text/html</code>. If <var>String</var> contains any whitespace, you have to enclose it in quotes (<code>\"</code> or <code>'</code>). This alternate text is displayed if the client is image-incapable, has image loading disabled, or fails to retrieve the icon.</p> <pre class=\"prettyprint lang-config\">AddAltByType 'plain text' text/plain</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"adddescription\">AddDescription Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Description to display for a file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddDescription string file [file] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>This sets the description to display for a file, for <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>File</var> is a file extension, partial filename, wild-card expression or full filename for files to describe. <var>String</var> is enclosed in double quotes (<code>\"</code>).</p> <pre class=\"prettyprint lang-config\">AddDescription \"The planet Mars\" mars.gif\nAddDescription \"My friend Marshall\" friends/mars.gif</pre> <p>The typical, default description field is 23 bytes wide. 6 more bytes are added by the <code><a href=\"#indexoptions.suppressicon\">IndexOptions SuppressIcon</a></code> option, 7 bytes are added by the <code><a href=\"#indexoptions.suppresssize\">IndexOptions SuppressSize</a></code> option, and 19 bytes are added by the <code><a href=\"#indexoptions.suppresslastmodified\">IndexOptions SuppressLastModified</a></code> option. Therefore, the widest default the description column is ever assigned is 55 bytes.</p> <p>Since the <var>File</var> argument may be a partial file name, please remember that a too-short partial filename may match unintended files. For example, <code>le.html</code> will match the file <code>le.html</code> but will also match the file <code>example.html</code>. In the event that there may be ambiguity, use as complete a filename as you can, but keep in mind that the first match encountered will be used, and order your list of <code>AddDescription</code> directives accordingly.</p> <p>See the <a href=\"#indexoptions.descriptionwidth\">DescriptionWidth</a> <code class=\"directive\"><a href=\"#indexoptions\">IndexOptions</a></code> keyword for details on overriding the size of this column, or allowing descriptions of unlimited length.</p> <div class=\"note\">\n<p><strong>Caution</strong></p> <p>Descriptive text defined with <code class=\"directive\">AddDescription</code> may contain HTML markup, such as tags and character entities. If the width of the description column should happen to truncate a tagged element (such as cutting off the end of a bolded phrase), the results may affect the rest of the directory listing.</p> </div> <div class=\"note\">\n<p><strong>Arguments with path information</strong></p> <p>Absolute paths are not currently supported and do not match anything at runtime. Arguments with relative path information, which would normally only be used in htaccess context, are implicitly prefixed with '*/' to avoid matching partial directory names.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"addicon\">AddIcon Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Icon to display for a file selected by name</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddIcon icon name [name] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>This sets the icon to display next to a file ending in <var>name</var> for <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>Icon</var> is either a (%-escaped) relative URL to the icon, a fully qualified remote URL, or of the format <code>(alttext,url)</code> where <var>alttext</var> is the text tag given for an icon for non-graphical browsers.</p> <p><var>Name</var> is either <code>^^DIRECTORY^^</code> for directories, <code>^^BLANKICON^^</code> for blank lines (to format the list correctly), a file extension, a wildcard expression, a partial filename or a complete filename.</p> <p><code>^^BLANKICON^^</code> is only used for formatting, and so is unnecessary if you're using <code>IndexOptions HTMLTable</code>.</p> <pre class=\"prettyprint lang-config\">#Examples\nAddIcon (IMG,/icons/image.png) .gif .jpg .png\nAddIcon /icons/dir.png ^^DIRECTORY^^\nAddIcon /icons/backup.png *~</pre> <p><code class=\"directive\"><a href=\"#addiconbytype\">AddIconByType</a></code> should be used in preference to <code class=\"directive\">AddIcon</code>, when possible.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"addiconbyencoding\">AddIconByEncoding Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Icon to display next to files selected by MIME content-encoding</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddIconByEncoding icon MIME-encoding [MIME-encoding] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>This sets the icon to display next to files with <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>Icon</var> is either a (%-escaped) relative URL to the icon, a fully qualified remote URL, or of the format <code>(alttext,url)</code> where <var>alttext</var> is the text tag given for an icon for non-graphical browsers.</p> <p><var>MIME-encoding</var> is a valid content-encoding, such as <code>x-compress</code>.</p> <pre class=\"prettyprint lang-config\">AddIconByEncoding /icons/compress.png x-compress</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"addiconbytype\">AddIconByType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Icon to display next to files selected by MIME content-type</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddIconByType icon MIME-type [MIME-type] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>This sets the icon to display next to files of type <var>MIME-type</var> for <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>Icon</var> is either a (%-escaped) relative URL to the icon, a fully qualified remote URL, or of the format <code>(alttext,url)</code> where <var>alttext</var> is the text tag given for an icon for non-graphical browsers.</p> <p><var>MIME-type</var> is a wildcard expression matching required the mime types.</p> <pre class=\"prettyprint lang-config\">AddIconByType (IMG,/icons/image.png) image/*</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"defaulticon\">DefaultIcon Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Icon to display for files when no specific icon is configured</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DefaultIcon url-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">DefaultIcon</code> directive sets the icon to display for files when no specific icon is known, for <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code>. <var>Url-path</var> is a (%-escaped) relative URL to the icon, or a fully qualified remote URL.</p> <pre class=\"prettyprint lang-config\">DefaultIcon /icon/unknown.png</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"headername\">HeaderName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name of the file that will be inserted at the top of the index listing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>HeaderName filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">HeaderName</code> directive sets the name of the file that will be inserted at the top of the index listing. <var>Filename</var> is the name of the file to include.</p> <pre class=\"prettyprint lang-config\">HeaderName HEADER.html</pre> <div class=\"note\"> <p>Both HeaderName and <code class=\"directive\"><a href=\"#readmename\">ReadmeName</a></code> now treat <var>Filename</var> as a URI path relative to the one used to access the directory being indexed. If <var>Filename</var> begins with a slash, it will be taken to be relative to the <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code>.</p> <pre class=\"prettyprint lang-config\">HeaderName /include/HEADER.html</pre> <p><var>Filename</var> must resolve to a document with a major content type of <code>text/*</code> (<em>e.g.</em>, <code>text/html</code>, <code>text/plain</code>, etc.). This means that <var>filename</var> may refer to a CGI script if the script's actual file type (as opposed to its output) is marked as <code>text/html</code> such as with a directive like:</p> <pre class=\"prettyprint lang-config\">AddType text/html .cgi</pre> <p><a href=\"../content-negotiation\">Content negotiation</a> will be performed if <code class=\"directive\"><a href=\"core#options\">Options</a></code> <code>MultiViews</code> is in effect. If <var>filename</var> resolves to a static <code>text/html</code> document (not a CGI script) and either one of the <code class=\"directive\"><a href=\"core#options\">options</a></code> <code>Includes</code> or <code>IncludesNOEXEC</code> is enabled, the file will be processed for server-side includes (see the <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> documentation).</p> </div> <p>If the file specified by <code class=\"directive\">HeaderName</code> contains the beginnings of an HTML document (&lt;html&gt;, &lt;head&gt;, etc.) then you will probably want to set <a href=\"#indexoptions.suppresshtmlpreamble\"><code>IndexOptions +SuppressHTMLPreamble</code></a>, so that these tags are not repeated.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#readmename\">ReadmeName</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"indexheadinsert\">IndexHeadInsert Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Inserts text in the HEAD section of an index page.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IndexHeadInsert \"markup ...\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">IndexHeadInsert</code> directive specifies a string to insert in the <var>&lt;head&gt;</var> section of the HTML generated for the index page.</p> <pre class=\"prettyprint lang-config\">IndexHeadInsert \"&lt;link rel=\\\"sitemap\\\" href=\\\"/sitemap.html\\\"&gt;\"</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"indexignore\">IndexIgnore Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Adds to the list of files to hide when listing a directory</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IndexIgnore file [file] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>IndexIgnore \".\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">IndexIgnore</code> directive adds to the list of files to hide when listing a directory. <var>File</var> is a shell-style wildcard expression or full filename. Multiple IndexIgnore directives add to the list, rather than replacing the list of ignored files. By default, the list contains <code>.</code> (the current directory).</p> <pre class=\"prettyprint lang-config\">IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t</pre> <div class=\"note\">\n<p><strong>Regular Expressions</strong></p> <p>This directive does not currently work in configuration sections that have regular expression arguments, such as <code class=\"directive\"><a href=\"core#directorymatch\">&lt;DirectoryMatch&gt;</a></code> </p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"indexignorereset\">IndexIgnoreReset Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Empties the list of files to hide when listing a directory</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IndexIgnoreReset ON|OFF</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.3.10 and later</td>\n</tr> </table> <p>The <code class=\"directive\">IndexIgnoreReset</code> directive removes any files ignored by <code class=\"directive\">IndexIgnore</code> otherwise inherited from other configuration sections. </p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/var/www\"&gt;\n    IndexIgnore *.bak .??* *~ *# HEADER* README* RCS CVS *,v *,t\n&lt;/Directory&gt;\n&lt;Directory \"/var/www/backups\"&gt;\n    IndexIgnoreReset ON\n    IndexIgnore .??* *# HEADER* README* RCS CVS *,v *,t\n&lt;/Directory&gt;</pre> <div class=\"warning\"><p> Review the default configuration for a list of patterns that you might want to explicitly ignore after using this directive.</p></div> </div>  <div class=\"directive-section\">\n<h2 id=\"indexoptions\">IndexOptions Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Various configuration settings for directory indexing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IndexOptions [+|-]option [[+|-]option] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>By default, no options are enabled.</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">IndexOptions</code> directive specifies the behavior of the directory indexing. <var>Option</var> can be one of</p> <dl> <dt><a name=\"indexoptions.addaltclass\" id=\"indexoptions.addaltclass\">AddAltClass</a></dt> <dd>Adds an additional CSS class declaration to each row of the directory listing table when <code>IndexOptions HTMLTable</code> is in effect and an <code>IndexStyleSheet</code> is defined. Rather than the standard <code>even</code> and <code>odd</code> classes that would otherwise be applied to each row of the table, a class of <code>even-<em>ALT</em></code> or <code>odd-<em>ALT</em></code> where <em>ALT</em> is either the standard alt text associated with the file style (eg. <em>snd</em>, <em>txt</em>, <em>img</em>, etc) or the alt text defined by one of the various <code>AddAlt*</code> directives. </dd> <dt>\n<a name=\"indexoptions.charset\" id=\"indexoptions.charset\">Charset=<var>character-set</var></a> (<em>Apache HTTP Server 2.0.61 and later</em>)</dt> <dd>The <code>Charset</code> keyword allows you to specify the character set of the generated page. The default is <code>UTF-8</code> on Windows and Mac OS X, and <code>ISO-8859-1</code> elsewhere. (It depends on whether the underlying file system uses Unicode filenames or not.) <pre class=\"prettyprint lang-config\">IndexOptions Charset=UTF-8</pre> </dd> <dt><a name=\"indexoptions.descriptionwidth\" id=\"indexoptions.descriptionwidth\">DescriptionWidth=[<var>n</var> | *]</a></dt> <dd>The <code>DescriptionWidth</code> keyword allows you to specify the width of the description column in characters.</dd> <dt>\n<code>-DescriptionWidth</code> (or unset) allows <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> to calculate the best width.</dt> <dd>\n<code>DescriptionWidth=n</code> fixes the column width to <var>n</var> bytes wide.</dd> <dd>\n<code>DescriptionWidth=*</code> grows the column to the width necessary to accommodate the longest description string. <strong>See the section on <code class=\"directive\"><a href=\"#adddescription\">AddDescription</a></code> for dangers inherent in truncating descriptions.</strong>\n</dd> <dt><a name=\"indexoptions.fancyindexing\" id=\"indexoptions.fancyindexing\">FancyIndexing</a></dt> <dd>This turns on fancy indexing of directories.</dd> <dt><a name=\"indexoptions.foldersfirst\" id=\"indexoptions.foldersfirst\">FoldersFirst</a></dt> <dd>If this option is enabled, subdirectory listings will <em>always</em> appear first, followed by normal files in the directory. The listing is basically broken into two components, the files and the subdirectories, and each is sorted separately and then displayed subdirectories-first. For instance, if the sort order is descending by name, and <code>FoldersFirst</code> is enabled, subdirectory <code>Zed</code> will be listed before subdirectory <code>Beta</code>, which will be listed before normal files <code>Gamma</code> and <code>Alpha</code>. <strong>This option only has an effect if <a href=\"#indexoptions.fancyindexing\"><code>FancyIndexing</code></a> is also enabled.</strong> </dd> <dt><a name=\"indexoptions.htmltable\" id=\"indexoptions.htmltable\">HTMLTable</a></dt> <dd>This option with <code>FancyIndexing</code> constructs a simple table for the fancy directory listing. It is necessary for utf-8 enabled platforms or if file names or description text will alternate between left-to-right and right-to-left reading order.</dd> <dt><a name=\"indexoptions.iconsarelinks\" id=\"indexoptions.iconsarelinks\">IconsAreLinks</a></dt> <dd>This makes the icons part of the anchor for the filename, for fancy indexing.</dd> <dt><a name=\"indexoptions.iconheight\" id=\"indexoptions.iconheight\">IconHeight[=<var>pixels</var>]</a></dt> <dd>Presence of this option, when used with <code>IconWidth</code>, will cause the server to include <code>height</code> and <code>width</code> attributes in the <code>img</code> tag for the file icon. This allows browser to precalculate the page layout without having to wait until all the images have been loaded. If no value is given for the option, it defaults to the standard height of the icons supplied with the Apache httpd software. <strong>This option only has an effect if <a href=\"#indexoptions.fancyindexing\"><code>FancyIndexing</code></a> is also enabled.</strong> </dd> <dt><a name=\"indexoptions.iconwidth\" id=\"indexoptions.iconwidth\">IconWidth[=<var>pixels</var>]</a></dt> <dd>Presence of this option, when used with <code>IconHeight</code>, will cause the server to include <code>height</code> and <code>width</code> attributes in the <code>img</code> tag for the file icon. This allows browser to precalculate the page layout without having to wait until all the images have been loaded. If no value is given for the option, it defaults to the standard width of the icons supplied with the Apache httpd software.</dd> <dt><a name=\"indexoptions.ignorecase\" id=\"indexoptions.ignorecase\">IgnoreCase</a></dt> <dd>If this option is enabled, names are sorted in a case-insensitive manner. For instance, if the sort order is ascending by name, and <code>IgnoreCase</code> is enabled, file Zeta will be listed after file alfa (Note: file GAMMA will always be listed before file gamma). </dd> <dt><a name=\"indexoptions.ignoreclient\" id=\"indexoptions.ignoreclient\">IgnoreClient</a></dt> <dd>This option causes <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> to ignore all query variables from the client, including sort order (implies <code><a href=\"#indexoptions.suppresscolumnsorting\">SuppressColumnSorting</a></code>.)</dd> <dt><a name=\"indexoptions.namewidth\" id=\"indexoptions.namewidth\">NameWidth=[<var>n</var> | *]</a></dt> <dd>The <code>NameWidth</code> keyword allows you to specify the width of the filename column in bytes.</dd> <dd>\n<code>-NameWidth</code> (or unset) allows <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> to calculate the best width, but only up to 20 bytes wide.</dd> <dd>\n<code>NameWidth=n</code> fixes the column width to <var>n</var> bytes wide.</dd> <dd>\n<code>NameWidth=*</code> grows the column to the necessary width.</dd> <dt><a name=\"indexoptions.scanhtmltitles\" id=\"indexoptions.scanhtmltitles\">ScanHTMLTitles</a></dt> <dd>This enables the extraction of the title from HTML documents for fancy indexing. If the file does not have a description given by <code class=\"directive\"><a href=\"#adddescription\">AddDescription</a></code> then httpd will read the document for the value of the <code>title</code> element. This is CPU and disk intensive.</dd> <dt><a name=\"indexoptions.showforbidden\" id=\"indexoptions.showforbidden\">ShowForbidden</a></dt> <dd>If specified, Apache httpd will show files normally hidden because the subrequest returned <code>HTTP_UNAUTHORIZED</code> or <code>HTTP_FORBIDDEN</code>\n</dd> <dt><a name=\"indexoptions.suppresscolumnsorting\" id=\"indexoptions.suppresscolumnsorting\">SuppressColumnSorting</a></dt> <dd>If specified, Apache httpd will not make the column headings in a FancyIndexed directory listing into links for sorting. The default behavior is for them to be links; selecting the column heading will sort the directory listing by the values in that column. However, query string arguments which are appended to the URL will still be honored. That behavior is controlled by <a href=\"#indexoptions.ignoreclient\"><code>IndexOptions IgnoreClient</code></a>.</dd> <dt><a name=\"indexoptions.suppressdescription\" id=\"indexoptions.suppressdescription\">SuppressDescription</a></dt> <dd>This will suppress the file description in fancy indexing listings. By default, no file descriptions are defined, and so the use of this option will regain 23 characters of screen space to use for something else. See <code class=\"directive\"><a href=\"#adddescription\">AddDescription</a></code> for information about setting the file description. See also the <code><a href=\"#indexoptions.descriptionwidth\">DescriptionWidth</a></code> index option to limit the size of the description column. <strong>This option only has an effect if <a href=\"#indexoptions.fancyindexing\"><code>FancyIndexing</code></a> is also enabled.</strong> </dd> <dt><a name=\"indexoptions.suppresshtmlpreamble\" id=\"indexoptions.suppresshtmlpreamble\">SuppressHTMLPreamble</a></dt> <dd>If the directory actually contains a file specified by the <code class=\"directive\"><a href=\"#headername\">HeaderName</a></code> directive, the module usually includes the contents of the file after a standard HTML preamble (<code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, <em>et cetera</em>). The <code>SuppressHTMLPreamble</code> option disables this behaviour, causing the module to start the display with the header file contents. The header file must contain appropriate HTML instructions in this case. If there is no header file, the preamble is generated as usual. If you also specify a <code class=\"directive\"><a href=\"#readmename\">ReadmeName</a></code>, and if that file exists, The closing &lt;/body&gt;&lt;/html&gt; tags are also ommitted from the output, under the assumption that you'll likely put those closing tags in that file.</dd> <dt><a name=\"indexoptions.suppressicon\" id=\"indexoptions.suppressicon\">SuppressIcon</a></dt> <dd>This will suppress the icon in fancy indexing listings. Combining both <code>SuppressIcon</code> and <code>SuppressRules</code> yields proper HTML 3.2 output, which by the final specification prohibits <code>img</code> and <code>hr</code> elements from the <code>pre</code> block (used to format FancyIndexed listings.)</dd> <dt><a name=\"indexoptions.suppresslastmodified\" id=\"indexoptions.suppresslastmodified\">SuppressLastModified</a></dt> <dd>This will suppress the display of the last modification date, in fancy indexing listings. <strong>This option only has an effect if <a href=\"#indexoptions.fancyindexing\"><code>FancyIndexing</code></a> is also enabled.</strong> </dd> <dt>\n<a name=\"indexoptions.suppressrules\" id=\"indexoptions.suppressrules\">SuppressRules</a> </dt> <dd>This will suppress the horizontal rule lines (<code>hr</code> elements) in directory listings. Combining both <code>SuppressIcon</code> and <code>SuppressRules</code> yields proper HTML 3.2 output, which by the final specification prohibits <code>img</code> and <code>hr</code> elements from the <code>pre</code> block (used to format FancyIndexed listings.) <strong>This option only has an effect if <a href=\"#indexoptions.fancyindexing\"><code>FancyIndexing</code></a> is also enabled.</strong> </dd> <dt><a name=\"indexoptions.suppresssize\" id=\"indexoptions.suppresssize\">SuppressSize</a></dt> <dd>This will suppress the file size in fancy indexing listings. <strong>This option only has an effect if <a href=\"#indexoptions.fancyindexing\"><code>FancyIndexing</code></a> is also enabled.</strong> </dd> <dt><a name=\"indexoptions.trackmodified\" id=\"indexoptions.trackmodified\">TrackModified</a></dt> <dd>This returns the <code>Last-Modified</code> and <code>ETag</code> values for the listed directory in the HTTP header. It is only valid if the operating system and file system return appropriate stat() results. Some Unix systems do so, as do OS2's JFS and Win32's NTFS volumes. OS2 and Win32 FAT volumes, for example, do not. Once this feature is enabled, the client or proxy can track changes to the list of files when they perform a <code>HEAD</code> request. Note some operating systems correctly track new and removed files, but do not track changes for sizes or dates of the files within the directory. <strong>Changes to the size or date stamp of an existing file will not update the <code>Last-Modified</code> header on all Unix platforms.</strong> If this is a concern, leave this option disabled.</dd> <dt>\n<a name=\"indexoptions.type\" id=\"indexoptions.type\">Type=<var>MIME content-type</var></a> (<em>Apache HTTP Server 2.0.61 and later</em>)</dt> <dd>The <code>Type</code> keyword allows you to specify the MIME content-type of the generated page. The default is <var>text/html</var>. <pre class=\"prettyprint lang-config\">IndexOptions Type=text/plain</pre> </dd> <dt>\n<a name=\"indexoptions.versionsort\" id=\"indexoptions.versionsort\">VersionSort</a> (<em>Apache HTTP Server 2.0a3 and later</em>)</dt> <dd>The <code>VersionSort</code> keyword causes files containing version numbers to sort in a natural way. Strings are sorted as usual, except that substrings of digits in the name and description are compared according to their numeric value. <div class=\"example\">\n<h3>Example:</h3>\n<pre>foo-1.7\nfoo-1.7.2\nfoo-1.7.12\nfoo-1.8.2\nfoo-1.8.2a\nfoo-1.12</pre>\n</div> <p>If the number starts with a zero, then it is considered to be a fraction:</p> <div class=\"example\"><pre>foo-1.001\nfoo-1.002\nfoo-1.030\nfoo-1.04</pre></div> </dd> <dt>\n<a name=\"indexoptions.xhtml\" id=\"indexoptions.xhtml\">XHTML</a> (<em>Apache HTTP Server 2.0.49 and later</em>)</dt> <dd>The <code>XHTML</code> keyword forces <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> to emit XHTML 1.0 code instead of HTML 3.2. <strong>This option only has an effect if <a href=\"#indexoptions.fancyindexing\"><code>FancyIndexing</code></a> is also enabled.</strong> </dd> </dl> <dl>\n<dt>Incremental IndexOptions</dt> <dd> <p>Be aware of how multiple <code class=\"directive\">IndexOptions</code> are handled.</p> <ul> <li>Multiple <code class=\"directive\">IndexOptions</code> directives for a single directory are now merged together. The result of: <pre class=\"prettyprint lang-config\">&lt;Directory \"/foo\"&gt;\n    IndexOptions HTMLTable\n    IndexOptions SuppressColumnsorting\n&lt;/Directory&gt;</pre> <p>will be the equivalent of</p> <pre class=\"prettyprint lang-config\">IndexOptions HTMLTable SuppressColumnsorting</pre> </li> <li>The addition of the incremental syntax (<em>i.e.</em>, prefixing keywords with <code>+</code> or <code>-</code>).</li> </ul> <p>Whenever a '+' or '-' prefixed keyword is encountered, it is applied to the current <code class=\"directive\">IndexOptions</code> settings (which may have been inherited from an upper-level directory). However, whenever an unprefixed keyword is processed, it clears all inherited options and any incremental settings encountered so far. Consider the following example:</p> <pre class=\"prettyprint lang-config\">IndexOptions +ScanHTMLTitles -IconsAreLinks FancyIndexing\nIndexOptions +SuppressSize</pre> <p>The net effect is equivalent to <code>IndexOptions FancyIndexing +SuppressSize</code>, because the unprefixed <code>FancyIndexing</code> discarded the incremental keywords before it, but allowed them to start accumulating again afterward.</p> <p>To unconditionally set the <code class=\"directive\">IndexOptions</code> for a particular directory, clearing the inherited settings, specify keywords without any <code>+</code> or <code>-</code> prefixes.</p> </dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"indexorderdefault\">IndexOrderDefault Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the default ordering of the directory index</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IndexOrderDefault Ascending|Descending Name|Date|Size|Description</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>IndexOrderDefault Ascending Name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">IndexOrderDefault</code> directive is used in combination with the <code><a href=\"#indexoptions.fancyindexing\">FancyIndexing</a></code> index option. By default, fancyindexed directory listings are displayed in ascending order by filename; the <code class=\"directive\">IndexOrderDefault</code> allows you to change this initial display order.</p> <p><code class=\"directive\">IndexOrderDefault</code> takes two arguments. The first must be either <code>Ascending</code> or <code>Descending</code>, indicating the direction of the sort. The second argument must be one of the keywords <code>Name</code>, <code>Date</code>, <code>Size</code>, or <code>Description</code>, and identifies the primary key. The secondary key is <em>always</em> the ascending filename.</p> <p>You can, if desired, prevent the client from reordering the list by also adding the <code><a href=\"#indexoptions.suppresscolumnsorting\">SuppressColumnSorting</a></code> index option to remove the sort link from the top of the column, along with the <code><a href=\"#indexoptions.ignoreclient\">IgnoreClient</a></code> index option to prevent them from manually adding sort options to the query string in order to override your ordering preferences.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"indexstylesheet\">IndexStyleSheet Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Adds a CSS stylesheet to the directory index</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IndexStyleSheet url-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">IndexStyleSheet</code> directive sets the name of the file that will be used as the CSS for the index listing. </p> <pre class=\"prettyprint lang-config\">IndexStyleSheet \"/css/style.css\"</pre> <p>Using this directive in conjunction with <code>IndexOptions HTMLTable</code> adds a number of CSS classes to the resulting HTML. The entire table is given a CSS id of <code>indexlist</code> and the following classes are associated with the various parts of the listing:</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Class</th>\n<th>Definition</th>\n</tr> <tr>\n<td>tr.indexhead</td>\n<td>Header row of listing</td>\n</tr> <tr class=\"odd\">\n<td>th.indexcolicon and td.indexcolicon</td> <td>Icon column</td>\n</tr> <tr>\n<td>th.indexcolname and td.indexcolname</td> <td>File name column</td>\n</tr> <tr class=\"odd\">\n<td>th.indexcollastmod and td.indexcollastmod</td> <td>Last modified column</td>\n</tr> <tr>\n<td>th.indexcolsize and td.indexcolsize</td> <td>File size column</td>\n</tr> <tr class=\"odd\">\n<td>th.indexcoldesc and td.indexcoldesc</td> <td>Description column</td>\n</tr> <tr>\n<td>tr.breakrow</td> <td>Horizontal rule at the bottom of the table</td>\n</tr> <tr class=\"odd\">\n<td>tr.odd and tr.even</td> <td>Alternating even and odd rows</td>\n</tr> </table> </div>  <div class=\"directive-section\">\n<h2 id=\"readmename\">ReadmeName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name of the file that will be inserted at the end of the index listing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ReadmeName filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_autoindex</td>\n</tr> </table> <p>The <code class=\"directive\">ReadmeName</code> directive sets the name of the file that will be appended to the end of the index listing. <var>Filename</var> is the name of the file to include, and is taken to be relative to the location being indexed. If <var>Filename</var> begins with a slash, as in example 2, it will be taken to be relative to the <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code>. </p> <pre class=\"prettyprint lang-config\"># Example 1\nReadmeName FOOTER.html</pre> <pre class=\"prettyprint lang-config\"># Example 2\nReadmeName /include/FOOTER.html</pre> <p>See also <code class=\"directive\"><a href=\"#headername\">HeaderName</a></code>, where this behavior is described in greater detail.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_autoindex.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_autoindex.html</a>\n  </p>\n</div>\n","mod/mod_dbd":"<h1>Apache Module mod_dbd</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Manages SQL database connections</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>dbd_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_dbd.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> manages SQL database connections using <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a>. It provides database connections on request to modules requiring SQL database functions, and takes care of managing databases with optimal efficiency and scalability for both threaded and non-threaded MPMs. For details, see the <a href=\"http://apr.apache.org/\">APR</a> website and this overview of the <a href=\"http://people.apache.org/~niq/dbd.html\">Apache DBD Framework</a> by its original developer. </p>     <h2 id=\"pooling\">Connection Pooling</h2> <p>This module manages database connections, in a manner optimised for the platform. On non-threaded platforms, it provides a persistent connection in the manner of classic LAMP (Linux, Apache, Mysql, Perl/PHP/Python). On threaded platform, it provides an altogether more scalable and efficient <em>connection pool</em>, as described in <a href=\"http://www.apachetutor.org/dev/reslist\">this article at ApacheTutor</a>. Note that <code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> supersedes the modules presented in that article.</p>   <h2 id=\"API\">Apache DBD API</h2> <p><code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> exports five functions for other modules to use. The API is as follows:</p> <pre class=\"prettyprint lang-c\">typedef struct {\n    apr_dbd_t *handle;\n    apr_dbd_driver_t *driver;\n    apr_hash_t *prepared;\n} ap_dbd_t;\n\n/* Export functions to access the database */\n\n/* acquire a connection that MUST be explicitly closed.\n * Returns NULL on error\n */\nAP_DECLARE(ap_dbd_t*) ap_dbd_open(apr_pool_t*, server_rec*);\n\n/* release a connection acquired with ap_dbd_open */\nAP_DECLARE(void) ap_dbd_close(server_rec*, ap_dbd_t*);\n\n/* acquire a connection that will have the lifetime of a request\n * and MUST NOT be explicitly closed.  Return NULL on error.\n * This is the preferred function for most applications.\n */\nAP_DECLARE(ap_dbd_t*) ap_dbd_acquire(request_rec*);\n\n/* acquire a connection that will have the lifetime of a connection\n * and MUST NOT be explicitly closed.  Return NULL on error.\n */\nAP_DECLARE(ap_dbd_t*) ap_dbd_cacquire(conn_rec*);\n\n/* Prepare a statement for use by a client module */\nAP_DECLARE(void) ap_dbd_prepare(server_rec*, const char*, const char*);\n\n/* Also export them as optional functions for modules that prefer it */\nAPR_DECLARE_OPTIONAL_FN(ap_dbd_t*, ap_dbd_open, (apr_pool_t*, server_rec*));\nAPR_DECLARE_OPTIONAL_FN(void, ap_dbd_close, (server_rec*, ap_dbd_t*));\nAPR_DECLARE_OPTIONAL_FN(ap_dbd_t*, ap_dbd_acquire, (request_rec*));\nAPR_DECLARE_OPTIONAL_FN(ap_dbd_t*, ap_dbd_cacquire, (conn_rec*));\nAPR_DECLARE_OPTIONAL_FN(void, ap_dbd_prepare, (server_rec*, const char*, const char*));</pre>   <h2 id=\"prepared\">SQL Prepared Statements</h2> <p><code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> supports SQL prepared statements on behalf of modules that may wish to use them. Each prepared statement must be assigned a name (label), and they are stored in a hash: the <code>prepared</code> field of an <code>ap_dbd_t</code>. Hash entries are of type <code>apr_dbd_prepared_t</code> and can be used in any of the apr_dbd prepared statement SQL query or select commands.</p> <p>It is up to dbd user modules to use the prepared statements and document what statements can be specified in httpd.conf, or to provide their own directives and use <code>ap_dbd_prepare</code>.</p> <div class=\"warning\">\n<p><strong>Caveat</strong></p> When using prepared statements with a MySQL database, it is preferred to set <code>reconnect</code> to 0 in the connection string as to avoid errors that arise from the MySQL client reconnecting without properly resetting the prepared statements. If set to 1, any broken connections will be attempted fixed, but as mod_dbd is not informed, the prepared statements will be invalidated. </div>   <h2 id=\"security\">SECURITY WARNING</h2> <p>Any web/database application needs to secure itself against SQL injection attacks. In most cases, Apache DBD is safe, because applications use prepared statements, and untrusted inputs are only ever used as data. Of course, if you use it via third-party modules, you should ascertain what precautions they may require.</p> <p>However, the <var>FreeTDS</var> driver is inherently <strong>unsafe</strong>. The underlying library doesn't support prepared statements, so the driver emulates them, and the untrusted input is merged into the SQL statement.</p> <p>It can be made safe by <em>untainting</em> all inputs: a process inspired by Perl's taint checking. Each input is matched against a regexp, and only the match is used, according to the Perl idiom:</p> <div class=\"example\"><pre><code>$untrusted =~ /([a-z]+)/; $trusted = $1;</code></pre></div> <p>To use this, the untainting regexps must be included in the prepared statements configured. The regexp follows immediately after the % in the prepared statement, and is enclosed in curly brackets {}. For example, if your application expects alphanumeric input, you can use:</p> <div class=\"example\"><pre>\"SELECT foo FROM bar WHERE input = %s\"</pre></div> <p>with other drivers, and suffer nothing worse than a failed query. But with FreeTDS you'd need:</p> <div class=\"example\"><pre>\"SELECT foo FROM bar WHERE input = %{([A-Za-z0-9]+)}s\"</pre></div> <p>Now anything that doesn't match the regexp's $1 match is discarded, so the statement is safe.</p> <p>An alternative to this may be the third-party ODBC driver, which offers the security of genuine prepared statements.</p>   <div class=\"directive-section\">\n<h2 id=\"dbdexptime\">DBDExptime Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Keepalive time for idle connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDExptime time-in-seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DBDExptime 300</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>Set the time to keep idle connections alive when the number of connections specified in DBDKeep has been exceeded (threaded platforms only).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdinitsql\">DBDInitSQL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Execute an SQL statement after connecting to a database</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDInitSQL \"SQL statement\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>Modules, that wish it, can have one or more SQL statements executed when a connection to a database is created. Example usage could be initializing certain values or adding a log entry when a new connection is made to the database.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdkeep\">DBDKeep Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum sustained number of connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDKeep number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DBDKeep 2</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>Set the maximum number of connections per process to be sustained, other than for handling peak demand (threaded platforms only).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdmax\">DBDMax Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDMax number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DBDMax 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>Set the hard maximum number of connections per process (threaded platforms only).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdmin\">DBDMin Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Minimum number of connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDMin number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DBDMin 1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>Set the minimum number of connections per process (threaded platforms only).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdparams\">DBDParams Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Parameters for database connection</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDParams param1=value1[,param2=value2]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>As required by the underlying driver. Typically this will be used to pass whatever cannot be defaulted amongst username, password, database name, hostname and port number for connection.</p> <p>Connection string parameters for current drivers include:</p> <dl> <dt>FreeTDS (for MSSQL and SyBase)</dt> <dd>username, password, appname, dbname, host, charset, lang, server</dd> <dt>MySQL</dt> <dd>host, port, user, pass, dbname, sock, flags, fldsz, group, reconnect</dd> <dt>Oracle</dt> <dd>user, pass, dbname, server</dd> <dt>PostgreSQL</dt> <dd>The connection string is passed straight through to <code>PQconnectdb</code>\n</dd> <dt>SQLite2</dt> <dd>The connection string is split on a colon, and <code>part1:part2</code> is used as <code>sqlite_open(part1, atoi(part2), NULL)</code>\n</dd> <dt>SQLite3</dt> <dd>The connection string is passed straight through to <code>sqlite3_open</code>\n</dd> <dt>ODBC</dt> <dd>datasource, user, password, connect, ctimeout, stimeout, access, txmode, bufsize</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdpersist\">DBDPersist Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Whether to use persistent connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDPersist On|Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>If set to Off, persistent and pooled connections are disabled. A new database connection is opened when requested by a client, and closed immediately on release. This option is for debugging and low-usage servers.</p> <p>The default is to enable a pool of persistent connections (or a single LAMP-style persistent connection in the case of a non-threaded server), and should almost always be used in operation.</p> <p>Prior to version 2.2.2, this directive accepted only the values <code>0</code> and <code>1</code> instead of <code>Off</code> and <code>On</code>, respectively.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdpreparesql\">DBDPrepareSQL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define an SQL prepared statement</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDPrepareSQL \"SQL statement\" label</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>For modules such as authentication that repeatedly use a single SQL statement, optimum performance is achieved by preparing the statement at startup rather than every time it is used. This directive prepares an SQL statement and assigns it a label.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"dbdriver\">DBDriver Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify an SQL driver</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DBDriver name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dbd</td>\n</tr> </table> <p>Selects an apr_dbd driver by name. The driver must be installed on your system (on most systems, it will be a shared object or dll). For example, <code>DBDriver mysql</code> will select the MySQL driver in apr_dbd_mysql.so.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_dbd.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_dbd.html</a>\n  </p>\n</div>\n","mod/mod_deflate":"<h1>Apache Module mod_deflate</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Compress content before it is delivered to the client</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>deflate_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_deflate.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code> module provides the <code>DEFLATE</code> output filter that allows output from your server to be compressed before being sent to the client over the network.</p>     <h2 id=\"supportedencodings\">Supported Encodings</h2> <p>The <code>gzip</code> encoding is the only one supported to ensure complete compatibility with old browser implementations. The <code>deflate</code> encoding is not supported, please check the <a href=\"http://www.gzip.org/zlib/zlib_faq.html#faq38\">zlib's documentation</a> for a complete explanation. </p>   <h2 id=\"recommended\">Sample Configurations</h2> <div class=\"warning\">\n<p><strong>Compression and TLS</strong></p> <p>Some web applications are vulnerable to an information disclosure attack when a TLS connection carries deflate compressed data. For more information, review the details of the \"BREACH\" family of attacks.</p> </div> <p>This is a simple configuration that compresses common text-based content types.</p> <div class=\"example\">\n<h3>Compress only a few types</h3>\n<pre class=\"prettyprint lang-config\">AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript</pre> </div>   <h2 id=\"enable\">Enabling Compression</h2> <div class=\"warning\">\n<p><strong>Compression and TLS</strong></p> <p>Some web applications are vulnerable to an information disclosure attack when a TLS connection carries deflate compressed data. For more information, review the details of the \"BREACH\" family of attacks.</p> </div> <h3><a name=\"output\" id=\"output\">Output Compression</a></h3> <p>Compression is implemented by the <code>DEFLATE</code> <a href=\"../filter\">filter</a>. The following directive will enable compression for documents in the container where it is placed:</p> <pre class=\"prettyprint lang-config\">SetOutputFilter DEFLATE\nSetEnvIfNoCase Request_URI \"\\.(?:gif|jpe?g|png)$\" no-gzip</pre> <p>If you want to restrict the compression to particular MIME types in general, you may use the <code class=\"directive\"><a href=\"mod_filter#addoutputfilterbytype\">AddOutputFilterByType</a></code> directive. Here is an example of enabling compression only for the html files of the Apache documentation:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/your-server-root/manual\"&gt;\n    AddOutputFilterByType DEFLATE text/html\n&lt;/Directory&gt;</pre> <div class=\"note\">\n<p><strong>Note</strong></p> The <code>DEFLATE</code> filter is always inserted after RESOURCE filters like PHP or SSI. It never touches internal subrequests. </div> <div class=\"note\">\n<p><strong>Note</strong></p> There is an environment variable <code>force-gzip</code>, set via <code class=\"directive\"><a href=\"mod_env#setenv\">SetEnv</a></code>, which will ignore the accept-encoding setting of your browser and will send compressed output. </div> <h3><a name=\"inflate\" id=\"inflate\">Output Decompression</a></h3> <p>The <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code> module also provides a filter for inflating/uncompressing a gzip compressed response body. In order to activate this feature you have to insert the <code>INFLATE</code> filter into the output filter chain using <code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code> or <code class=\"directive\"><a href=\"mod_mime#addoutputfilter\">AddOutputFilter</a></code>, for example:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/dav-area\"&gt;\n    ProxyPass \"http://example.com/\"\n    SetOutputFilter INFLATE\n&lt;/Location&gt;</pre> <p>This Example will uncompress gzip'ed output from example.com, so other filters can do further processing with it. </p> <h3><a name=\"input\" id=\"input\">Input Decompression</a></h3> <p>The <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code> module also provides a filter for decompressing a gzip compressed request body . In order to activate this feature you have to insert the <code>DEFLATE</code> filter into the input filter chain using <code class=\"directive\"><a href=\"core#setinputfilter\">SetInputFilter</a></code> or <code class=\"directive\"><a href=\"mod_mime#addinputfilter\">AddInputFilter</a></code>, for example:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/dav-area\"&gt;\n    SetInputFilter DEFLATE\n&lt;/Location&gt;</pre> <p>Now if a request contains a <code>Content-Encoding: gzip</code> header, the body will be automatically decompressed. Few browsers have the ability to gzip request bodies. However, some special applications actually do support request compression, for instance some <a href=\"http://www.webdav.org\">WebDAV</a> clients.</p> <div class=\"warning\">\n<p><strong>Note on Content-Length</strong></p> <p>If you evaluate the request body yourself, <em>don't trust the <code>Content-Length</code> header!</em> The Content-Length header reflects the length of the incoming data from the client and <em>not</em> the byte count of the decompressed data stream.</p> </div>   <h2 id=\"proxies\">Dealing with proxy servers</h2> <p>The <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code> module sends a <code>Vary: Accept-Encoding</code> HTTP response header to alert proxies that a cached response should be sent only to clients that send the appropriate <code>Accept-Encoding</code> request header. This prevents compressed content from being sent to a client that will not understand it.</p> <p>If you use some special exclusions dependent on, for example, the <code>User-Agent</code> header, you must manually configure an addition to the <code>Vary</code> header to alert proxies of the additional restrictions. For example, in a typical configuration where the addition of the <code>DEFLATE</code> filter depends on the <code>User-Agent</code>, you should add:</p> <pre class=\"prettyprint lang-config\">Header append Vary User-Agent</pre> <p>If your decision about compression depends on other information than request headers (<em>e.g.</em> HTTP version), you have to set the <code>Vary</code> header to the value <code>*</code>. This prevents compliant proxies from caching entirely.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">Header set Vary *</pre> </div>   <h2 id=\"precompressed\">Serving pre-compressed content</h2> <p>Since <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code> re-compresses content each time a request is made, some performance benefit can be derived by pre-compressing the content and telling mod_deflate to serve them without re-compressing them. This may be accomplished using a configuration like the following:</p> <pre class=\"prettyprint lang-config\">&lt;IfModule mod_headers.c&gt;\n    # Serve gzip compressed CSS files if they exist \n    # and the client accepts gzip.\n    RewriteCond \"%{HTTP:Accept-encoding}\" \"gzip\"\n    RewriteCond \"%{REQUEST_FILENAME}\\.gz\" -s\n    RewriteRule \"^(.*)\\.css\" \"$1\\.css\\.gz\" [QSA]\n\n    # Serve gzip compressed JS files if they exist \n    # and the client accepts gzip.\n    RewriteCond \"%{HTTP:Accept-encoding}\" \"gzip\"\n    RewriteCond \"%{REQUEST_FILENAME}\\.gz\" -s\n    RewriteRule \"^(.*)\\.js\" \"$1\\.js\\.gz\" [QSA]\n\n\n    # Serve correct content types, and prevent mod_deflate double gzip.\n    RewriteRule \"\\.css\\.gz$\" \"-\" [T=text/css,E=no-gzip:1]\n    RewriteRule \"\\.js\\.gz$\" \"-\" [T=text/javascript,E=no-gzip:1]\n\n\n    &lt;FilesMatch \"(\\.js\\.gz|\\.css\\.gz)$\"&gt;\n      # Serve correct encoding type.\n      Header append Content-Encoding gzip\n\n      # Force proxies to cache gzipped &amp; \n      # non-gzipped css/js files separately.\n      Header append Vary Accept-Encoding\n    &lt;/FilesMatch&gt;\n&lt;/IfModule&gt;</pre>   <div class=\"directive-section\">\n<h2 id=\"deflatebuffersize\">DeflateBufferSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Fragment size to be compressed at one time by zlib</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DeflateBufferSize value</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DeflateBufferSize 8096</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateBufferSize</code> directive specifies the size in bytes of the fragments that zlib should compress at one time. If the compressed response size is bigger than the one specified by this directive then httpd will switch to chunked encoding (HTTP header <code>Transfer-Encoding</code> set to <code>Chunked</code>), with the side effect of not setting any <code>Content-Length</code> HTTP header. This is particularly important when httpd works behind reverse caching proxies or when httpd is configured with <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> and <code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code> because HTTP responses without any <code>Content-Length</code> header might not be cached. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"deflatecompressionlevel\">DeflateCompressionLevel Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>How much compression do we apply to the output</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DeflateCompressionLevel value</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Zlib's default</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateCompressionLevel</code> directive specifies what level of compression should be used, the higher the value, the better the compression, but the more CPU time is required to achieve this.</p> <p>The value must between 1 (less compression) and 9 (more compression).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"deflatefilternote\">DeflateFilterNote Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Places the compression ratio in a note for logging</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DeflateFilterNote [type] notename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateFilterNote</code> directive specifies that a note about compression ratios should be attached to the request. The name of the note is the value specified for the directive. You can use that note for statistical purposes by adding the value to your <a href=\"../logs#accesslog\">access log</a>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">      DeflateFilterNote ratio\n    \n      LogFormat '\"%r\" %b (%{ratio}n) \"%{User-agent}i\"' deflate\n      CustomLog \"logs/deflate_log\" deflate</pre> </div> <p>If you want to extract more accurate values from your logs, you can use the <var>type</var> argument to specify the type of data left as a note for logging. <var>type</var> can be one of:</p> <dl> <dt><code>Input</code></dt> <dd>Store the byte count of the filter's input stream in the note.</dd> <dt><code>Output</code></dt> <dd>Store the byte count of the filter's output stream in the note.</dd> <dt><code>Ratio</code></dt> <dd>Store the compression ratio (<code>output/input * 100</code>) in the note. This is the default, if the <var>type</var> argument is omitted.</dd> </dl> <p>Thus you may log it this way:</p> <div class=\"example\">\n<h3>Accurate Logging</h3>\n<pre class=\"prettyprint lang-config\">DeflateFilterNote Input instream\nDeflateFilterNote Output outstream\nDeflateFilterNote Ratio ratio\n\nLogFormat '\"%r\" %{outstream}n/%{instream}n (%{ratio}n%%)' deflate\nCustomLog \"logs/deflate_log\" deflate</pre> </div> <h3>See also</h3> <ul> <li><code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"deflateinflatelimitrequestbody\">DeflateInflateLimitRequestBody Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum size of inflated request bodies</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><code>DeflateInflateLimitRequestBodyvalue</code></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>None, but LimitRequestBody applies after deflation</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.10 and later</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateInflateLimitRequestBody</code> directive specifies the maximum size of an inflated request body. If it is unset, <code class=\"directive\"><a href=\"core#limitrequestbody\">LimitRequestBody</a></code> is applied to the inflated body.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"deflateinflateratioburst\">DeflateInflateRatioBurst Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of times the inflation ratio for request bodies can be crossed</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DeflateInflateRatioBurst value</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>3</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.10 and later</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateInflateRatioBurst</code> directive specifies the maximum number of times the <code class=\"directive\">DeflateInflateRatioLimit</code> can be crossed before terminating the request.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"deflateinflateratiolimit\">DeflateInflateRatioLimit Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum inflation ratio for request bodies</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DeflateInflateRatioLimit value</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>200</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.10 and later</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateInflateRatioLimit</code> directive specifies the maximum ratio of deflated to inflated size of an inflated request body. This ratio is checked as the body is streamed in, and if crossed more than <code class=\"directive\">DeflateInflateRatioBurst</code> times, the request will be terminated.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"deflatememlevel\">DeflateMemLevel Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>How much memory should be used by zlib for compression</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DeflateMemLevel value</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DeflateMemLevel 9</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateMemLevel</code> directive specifies how much memory should be used by zlib for compression (a value between 1 and 9).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"deflatewindowsize\">DeflateWindowSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Zlib compression window size</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DeflateWindowSize value</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DeflateWindowSize 15</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_deflate</td>\n</tr> </table> <p>The <code class=\"directive\">DeflateWindowSize</code> directive specifies the zlib compression window size (a value between 1 and 15). Generally, the higher the window size, the higher can the compression ratio be expected.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_deflate.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_deflate.html</a>\n  </p>\n</div>\n","mod/mod_dumpio":"<h1>Apache Module mod_dumpio</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Dumps all I/O to error log as desired.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>dumpio_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_dumpio.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code>mod_dumpio</code> allows for the logging of all input received by Apache and/or all output sent by Apache to be logged (dumped) to the error.log file. </p> <p>The data logging is done right after SSL decoding (for input) and right before SSL encoding (for output). As can be expected, this can produce extreme volumes of data, and should only be used when debugging problems.</p>     <h2 id=\"enable\">Enabling dumpio Support</h2> <p>To enable the module, it should be compiled and loaded in to your running Apache configuration. Logging can then be enabled or disabled separately for input and output via the below directives. Additionally, <code class=\"module\"><a href=\"mod_dumpio\">mod_dumpio</a></code> needs to be configured to <code class=\"directive\"><a href=\"core#loglevel\">LogLevel</a></code> <code>trace7</code>: </p> <pre class=\"prettyprint lang-config\">LogLevel dumpio:trace7</pre>   <div class=\"directive-section\">\n<h2 id=\"dumpioinput\">DumpIOInput Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Dump all input data to the error log</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DumpIOInput On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DumpIOInput Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dumpio</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>DumpIOInput is only available in Apache 2.1.3 and later.</td>\n</tr> </table> <p>Enable dumping of all input.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">DumpIOInput On</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"dumpiooutput\">DumpIOOutput Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Dump all output data to the error log</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DumpIOOutput On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DumpIOOutput Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dumpio</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>DumpIOOutput is only available in Apache 2.1.3 and later.</td>\n</tr> </table> <p>Enable dumping of all output.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">DumpIOOutput On</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_dumpio.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_dumpio.html</a>\n  </p>\n</div>\n","mod/mod_echo":"<h1>Apache Module mod_echo</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>A simple echo server to illustrate protocol modules</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>echo_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_echo.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides an example protocol module to illustrate the concept. It provides a simple echo server. Telnet to it and type stuff, and it will echo it.</p>    <div class=\"directive-section\">\n<h2 id=\"protocolecho\">ProtocolEcho Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Turn the echo server on or off</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProtocolEcho On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProtocolEcho Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_echo</td>\n</tr> </table> <p>The <code class=\"directive\">ProtocolEcho</code> directive enables or disables the echo server.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProtocolEcho On</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_echo.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_echo.html</a>\n  </p>\n</div>\n","mod/mod_env":"<h1>Apache Module mod_env</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Modifies the environment which is passed to CGI scripts and SSI pages</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>env_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_env.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module allows for control of internal environment variables that are used by various Apache HTTP Server modules. These variables are also provided to CGI scripts as native system environment variables, and available for use in SSI pages. Environment variables may be passed from the shell which invoked the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> process. Alternatively, environment variables may be set or unset within the configuration process.</p>    <div class=\"directive-section\">\n<h2 id=\"passenv\">PassEnv Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Passes environment variables from the shell</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>PassEnv env-variable [env-variable] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_env</td>\n</tr> </table> <p>Specifies one or more native system environment variables to make available as internal environment variables, which are available to Apache HTTP Server modules as well as propagated to CGI scripts and SSI pages. Values come from the native OS environment of the shell which invoked the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> process.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">PassEnv LD_LIBRARY_PATH</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"setenv\">SetEnv Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets environment variables</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SetEnv env-variable [value]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_env</td>\n</tr> </table> <p>Sets an internal environment variable, which is then available to Apache HTTP Server modules, and passed on to CGI scripts and SSI pages.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SetEnv SPECIAL_PATH /foo/bin</pre> </div> <p> If you omit the <var>value</var> argument, the variable is set to an empty string.</p> <div class=\"note\">\n<p>The internal environment variables set by this directive are set <em>after</em> most early request processing directives are run, such as access control and URI-to-filename mapping. If the environment variable you're setting is meant as input into this early phase of processing such as the <code class=\"directive\"><a href=\"mod_rewrite#rewriterule\">RewriteRule</a></code> directive, you should instead set the environment variable with <code class=\"directive\"><a href=\"mod_setenvif#setenvif\">SetEnvIf</a></code>.</p> </div> <h3>See also</h3> <ul> <li><a href=\"../env\">Environment Variables</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"unsetenv\">UnsetEnv Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Removes variables from the environment</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>UnsetEnv env-variable [env-variable] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_env</td>\n</tr> </table> <p>Removes one or more internal environment variables from those passed on to CGI scripts and SSI pages.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">UnsetEnv LD_LIBRARY_PATH</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_env.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_env.html</a>\n  </p>\n</div>\n","mod/mod_example_hooks":"<h1>Apache Module mod_example_hooks</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Illustrates the Apache module API</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>example_hooks_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_example_hooks.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The files in the <code>modules/examples</code> directory under the Apache distribution directory tree are provided as an example to those that wish to write modules that use the Apache API.</p> <p>The main file is <code>mod_example_hooks.c</code>, which illustrates all the different callback mechanisms and call syntaxes. By no means does an add-on module need to include routines for all of the callbacks - quite the contrary!</p> <p>The example module is an actual working module. If you link it into your server, enable the \"example-hooks-handler\" handler for a location, and then browse to that location, you will see a display of some of the tracing the example module did as the various callbacks were made.</p>     <h2 id=\"compiling\">Compiling the example_hooks module</h2> <p>To include the example_hooks module in your server, follow the steps below:</p> <ol> <li> Run <code class=\"program\"><a href=\"../programs/configure\">configure</a></code> with <code>--enable-example-hooks</code> option.</li> <li>Make the server (run \"<code>make</code>\").</li> </ol> <p>To add another module of your own:</p> <ol class=\"up-A\"> <li><code>cp modules/examples/mod_example_hooks.c modules/new_module/<em>mod_myexample.c</em></code></li> <li>Modify the file.</li> <li>Create <code>modules/new_module/config.m4</code>. <ol> <li>Add <code>APACHE_MODPATH_INIT(new_module)</code>.</li> <li>Copy APACHE_MODULE line with \"example_hooks\" from <code>modules/examples/config.m4</code>.</li> <li>Replace the first argument \"example_hooks\" with <em>myexample</em>.</li> <li>Replace the second argument with brief description of your module. It will be used in <code>configure --help</code>.</li> <li>If your module needs additional C compiler flags, linker flags or libraries, add them to CFLAGS, LDFLAGS and LIBS accordingly. See other <code>config.m4</code> files in modules directory for examples.</li> <li>Add <code>APACHE_MODPATH_FINISH</code>.</li> </ol> </li> <li>Create <code>module/new_module/Makefile.in</code>. If your module doesn't need special build instructions, all you need to have in that file is <code>include $(top_srcdir)/build/special.mk</code>.</li> <li>Run ./buildconf from the top-level directory.</li> <li>Build the server with --enable-myexample</li> </ol>   <h2 id=\"using\">Using the <code>mod_example_hooks</code> Module</h2> <p>To activate the example_hooks module, include a block similar to the following in your <code>httpd.conf</code> file:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/example-hooks-info\"&gt;\n   SetHandler example-hooks-handler\n&lt;/Location&gt;</pre> <p>As an alternative, you can put the following into a <a href=\"core#accessfilename\"><code>.htaccess</code></a> file and then request the file \"test.example\" from that location:</p> <pre class=\"prettyprint lang-config\">AddHandler example-hooks-handler \".example\"</pre> <p>After reloading/restarting your server, you should be able to browse to this location and see the brief display mentioned earlier.</p>   <div class=\"directive-section\">\n<h2 id=\"example\">Example Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Demonstration directive to illustrate the Apache module API</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><code>Example</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_example_hooks</td>\n</tr> </table> <p>The <code class=\"directive\">Example</code> directive just sets a demonstration flag which the example module's content handler displays. It takes no arguments. If you browse to an URL to which the example-hooks content-handler applies, you will get a display of the routines within the module and how and in what order they were called to service the document request. The effect of this directive one can observe under the point \"<code>Example directive declared here: YES/NO</code>\".</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_example_hooks.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_example_hooks.html</a>\n  </p>\n</div>\n","mod/mod_cache":"<h1>Apache Module mod_cache</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>RFC 2616 compliant HTTP caching filter.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>cache_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_cache.c</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\">This module should be used with care, as when the <code class=\"directive\"><a href=\"#cachequickhandler\">CacheQuickHandler</a></code> directive is in its default value of <strong>on</strong>, the <code class=\"directive\"><a href=\"mod_access_compat#allow\">Allow</a></code> and <code class=\"directive\"><a href=\"mod_access_compat#deny\">Deny</a></code> directives will be circumvented. You should not enable quick handler caching for any content to which you wish to limit access by client host name, address or environment variable.</div> <p><code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> implements an <a href=\"http://www.ietf.org/rfc/rfc2616.txt\">RFC 2616</a> compliant <strong>HTTP content caching filter</strong>, with support for the caching of content negotiated responses containing the Vary header.</p> <p>RFC 2616 compliant caching provides a mechanism to verify whether stale or expired content is still fresh, and can represent a significant performance boost when the origin server supports <strong>conditional requests</strong> by honouring the <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.26\">If-None-Match</a> HTTP request header. Content is only regenerated from scratch when the content has changed, and not when the cached entry expires.</p> <p>As a filter, <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> can be placed in front of content originating from any handler, including <strong>flat files</strong> (served from a slow disk cached on a fast disk), the output of a <strong>CGI script</strong> or <strong>dynamic content generator</strong>, or content <strong>proxied from another server</strong>.</p> <p>In the default configuration, <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> inserts the caching filter as far forward as possible within the filter stack, utilising the <strong>quick handler</strong> to bypass all per request processing when returning content to the client. In this mode of operation, <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> may be thought of as a caching proxy server bolted to the front of the webserver, while running within the webserver itself.</p> <p>When the quick handler is switched off using the <code class=\"directive\"><a href=\"#cachequickhandler\">CacheQuickHandler</a></code> directive, it becomes possible to insert the <strong>CACHE</strong> filter at a point in the filter stack chosen by the administrator. This provides the opportunity to cache content before that content is personalised by the <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> filter, or optionally compressed by the <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code> filter.</p> <p>Under normal operation, <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> will respond to and can be controlled by the <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9\">Cache-Control</a> and <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.32\">Pragma</a> headers sent from a client in a request, or from a server within a response. Under exceptional circumstances, <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> can be configured to override these headers and force site specific behaviour, however such behaviour will be limited to this cache only, and will not affect the operation of other caches that may exist between the client and server, and as a result is not recommended unless strictly necessary.</p> <p>RFC 2616 allows for the cache to return stale data while the existing stale entry is refreshed from the origin server, and this is supported by <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> when the <code class=\"directive\"><a href=\"#cachelock\">CacheLock</a></code> directive is suitably configured. Such responses will contain a <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.46\">Warning</a> HTTP header with a 110 response code. RFC 2616 also allows a cache to return stale data when the attempt made to refresh the stale data returns an error 500 or above, and this behaviour is supported by default by <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code>. Such responses will contain a <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.46\">Warning</a> HTTP header with a 111 response code.</p> <p><code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> requires the services of one or more storage management modules. The following storage management modules are included in the base Apache distribution:</p> <dl> <dt><code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code></dt> <dd>Implements a disk based storage manager. Headers and bodies are stored separately on disk, in a directory structure derived from the md5 hash of the cached URL. Multiple content negotiated responses can be stored concurrently, however the caching of partial content is not supported by this module. The <code class=\"program\"><a href=\"../programs/htcacheclean\">htcacheclean</a></code> tool is provided to list cached URLs, remove cached URLs, or to maintain the size of the disk cache within size and inode limits.</dd> <dt><code class=\"module\"><a href=\"mod_cache_socache\">mod_cache_socache</a></code></dt> <dd>Implements a shared object cache based storage manager. Headers and bodies are stored together beneath a single key based on the URL of the response being cached. Multiple content negotiated responses can be stored concurrently, however the caching of partial content is not supported by this module.</dd> </dl> <p>Further details, discussion, and examples, are provided in the <a href=\"../caching\">Caching Guide</a>.</p>     <h2 id=\"related\">Related Modules and Directives</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul>\n<li><code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code></li>\n<li><code class=\"module\"><a href=\"mod_cache_socache\">mod_cache_socache</a></code></li>\n</ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"mod_cache_disk#cacheroot\">CacheRoot</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_disk#cachedirlevels\">CacheDirLevels</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_disk#cachedirlength\">CacheDirLength</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_disk#cacheminfilesize\">CacheMinFileSize</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_disk#cachemaxfilesize\">CacheMaxFileSize</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_socache#cachesocache\">CacheSocache</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_socache#cachesocachemaxtime\">CacheSocacheMaxTime</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_socache#cachesocachemintime\">CacheSocacheMinTime</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_socache#cachesocachemaxsize\">CacheSocacheMaxSize</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_socache#cachesocachereadsize\">CacheSocacheReadSize</a></code></li>\n<li><code class=\"directive\"><a href=\"mod_cache_socache#cachesocachereadtime\">CacheSocacheReadTime</a></code></li>\n</ul></td>\n</tr>\n</table>   <h2 id=\"sampleconf\">Sample Configuration</h2> <div class=\"example\">\n<h3>Sample httpd.conf</h3>\n<pre class=\"prettyprint lang-config\">#\n# Sample Cache Configuration\n#\nLoadModule cache_module modules/mod_cache.so\n&lt;IfModule mod_cache.c&gt;\n    LoadModule cache_disk_module modules/mod_cache_disk.so\n    &lt;IfModule mod_cache_disk.c&gt;\n        CacheRoot \"c:/cacheroot\"\n        CacheEnable disk  \"/\"\n        CacheDirLevels 5\n        CacheDirLength 3\n    &lt;/IfModule&gt;\n\n    # When acting as a proxy, don't cache the list of security updates\n    CacheDisable \"http://security.update.server/update-list/\"\n&lt;/IfModule&gt;</pre> </div>   <h2 id=\"thunderingherd\">Avoiding the Thundering Herd</h2> <p>When a cached entry becomes stale, <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> will submit a conditional request to the backend, which is expected to confirm whether the cached entry is still fresh, and send an updated entity if not.</p> <p>A small but finite amount of time exists between the time the cached entity becomes stale, and the time the stale entity is fully refreshed. On a busy server, a significant number of requests might arrive during this time, and cause a <strong>thundering herd</strong> of requests to strike the backend suddenly and unpredictably.</p> <p>To keep the thundering herd at bay, the <code class=\"directive\">CacheLock</code> directive can be used to define a directory in which locks are created for URLs <strong>in flight</strong>. The lock is used as a <strong>hint</strong> by other requests to either suppress an attempt to cache (someone else has gone to fetch the entity), or to indicate that a stale entry is being refreshed (stale content will be returned in the mean time). </p> <h3>Initial caching of an entry</h3> <p>When an entity is cached for the first time, a lock will be created for the entity until the response has been fully cached. During the lifetime of the lock, the cache will suppress the second and subsequent attempt to cache the same entity. While this doesn't hold back the thundering herd, it does stop the cache attempting to cache the same entity multiple times simultaneously. </p> <h3>Refreshment of a stale entry</h3> <p>When an entity reaches its freshness lifetime and becomes stale, a lock will be created for the entity until the response has either been confirmed as still fresh, or replaced by the backend. During the lifetime of the lock, the second and subsequent incoming request will cause stale data to be returned, and the thundering herd is kept at bay.</p> <h3>Locks and Cache-Control: no-cache</h3> <p>Locks are used as a <strong>hint only</strong> to enable the cache to be more gentle on backend servers, however the lock can be overridden if necessary. If the client sends a request with a Cache-Control header forcing a reload, any lock that may be present will be ignored, and the client's request will be honored immediately and the cached entry refreshed.</p> <p>As a further safety mechanism, locks have a configurable maximum age. Once this age has been reached, the lock is removed, and a new request is given the opportunity to create a new lock. This maximum age can be set using the <code class=\"directive\">CacheLockMaxAge</code> directive, and defaults to 5 seconds. </p> <h3>Example configuration</h3> <div class=\"example\">\n<h3>Enabling the cache lock</h3>\n<pre class=\"prettyprint lang-config\">#\n# Enable the cache lock\n#\n&lt;IfModule mod_cache.c&gt;\n    CacheLock on\n    CacheLockPath \"/tmp/mod_cache-lock\"\n    CacheLockMaxAge 5\n&lt;/IfModule&gt;</pre> </div>   <h2 id=\"finecontrol\">Fine Control with the CACHE Filter</h2> <p>Under the default mode of cache operation, the cache runs as a quick handler, short circuiting the majority of server processing and offering the highest cache performance available.</p> <p>In this mode, the cache <strong>bolts onto</strong> the front of the server, acting as if a free standing RFC 2616 caching proxy had been placed in front of the server.</p> <p>While this mode offers the best performance, the administrator may find that under certain circumstances they may want to perform further processing on the request after the request is cached, such as to inject personalisation into the cached page, or to apply authorisation restrictions to the content. Under these circumstances, an administrator is often forced to place independent reverse proxy servers either behind or in front of the caching server to achieve this.</p> <p>To solve this problem the <code class=\"directive\"><a href=\"#cachequickhandler\">CacheQuickHandler </a></code> directive can be set to <strong>off</strong>, and the server will process all phases normally handled by a non-cached request, including the <strong>authentication and authorisation</strong> phases.</p> <p>In addition, the administrator may optionally specify the <strong>precise point within the filter chain</strong> where caching is to take place by adding the <strong>CACHE</strong> filter to the output filter chain.</p> <p>For example, to cache content before applying compression to the response, place the <strong>CACHE</strong> filter before the <strong>DEFLATE</strong> filter as in the example below:</p> <pre class=\"prettyprint lang-config\"># Cache content before optional compression\nCacheQuickHandler off\nAddOutputFilterByType CACHE;DEFLATE text/plain</pre> <p>Another option is to have content cached before personalisation is applied by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> (or another content processing filter). In this example templates containing tags understood by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> are cached before being parsed:</p> <pre class=\"prettyprint lang-config\"># Cache content before mod_include and mod_deflate\nCacheQuickHandler off\nAddOutputFilterByType CACHE;INCLUDES;DEFLATE text/html</pre> <p>You may place the <strong>CACHE</strong> filter anywhere you wish within the filter chain. In this example, content is cached after being parsed by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code>, but before being processed by <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code>:</p> <pre class=\"prettyprint lang-config\"># Cache content between mod_include and mod_deflate\nCacheQuickHandler off\nAddOutputFilterByType INCLUDES;CACHE;DEFLATE text/html</pre> <div class=\"warning\">\n<p><strong>Warning:</strong></p>If the location of the <strong>CACHE</strong> filter in the filter chain is changed for any reason, you may need to <strong>flush your cache</strong> to ensure that your data served remains consistent. <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> is not in a position to enforce this for you.</div>   <h2 id=\"status\">Cache Status and Logging</h2> <p>Once <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> has made a decision as to whether or not an entity is to be served from cache, the detailed reason for the decision is written to the subprocess environment within the request under the <strong>cache-status</strong> key. This reason can be logged by the <code class=\"directive\"><a href=\"mod_log_config#logformat\">LogFormat</a></code> directive as follows:</p> <pre class=\"prettyprint lang-config\">LogFormat \"%{cache-status}e ...\"</pre> <p>Based on the caching decision made, the reason is also written to the subprocess environment under one the following four keys, as appropriate:</p> <dl> <dt>cache-hit</dt>\n<dd>The response was served from cache.</dd> <dt>cache-revalidate</dt>\n<dd>The response was stale and was successfully revalidated, then served from cache.</dd> <dt>cache-miss</dt>\n<dd>The response was served from the upstream server.</dd> <dt>cache-invalidate</dt>\n<dd>The cached entity was invalidated by a request method other than GET or HEAD.</dd> </dl> <p>This makes it possible to support conditional logging of cached requests as per the following example:</p> <pre class=\"prettyprint lang-config\">CustomLog \"cached-requests.log\" common env=cache-hit\nCustomLog \"uncached-requests.log\" common env=cache-miss\nCustomLog \"revalidated-requests.log\" common env=cache-revalidate\nCustomLog \"invalidated-requests.log\" common env=cache-invalidate</pre> <p>For module authors, a hook called <var>cache_status</var> is available, allowing modules to respond to the caching outcomes above in customised ways.</p>   <div class=\"directive-section\">\n<h2 id=\"cachedefaultexpire\">CacheDefaultExpire Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The default duration to cache a document when no expiry date is specified.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheDefaultExpire seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheDefaultExpire 3600 (one hour)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>The <code class=\"directive\">CacheDefaultExpire</code> directive specifies a default time, in seconds, to cache a document if neither an expiry date nor last-modified date are provided with the document. The value specified with the <code class=\"directive\">CacheMaxExpire</code> directive does <em>not</em> override this setting.</p> <pre class=\"prettyprint lang-config\">CacheDefaultExpire 86400</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachedetailheader\">CacheDetailHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Add an X-Cache-Detail header to the response.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheDetailHeader on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheDetailHeader off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.9 and later</td>\n</tr> </table> <p>When the <code class=\"directive\"><a href=\"#cachedetailheader\">CacheDetailHeader</a></code> directive is switched on, an <strong>X-Cache-Detail</strong> header will be added to the response containing the detailed reason for a particular caching decision.</p> <p>It can be useful during development of cached RESTful services to have additional information about the caching decision written to the response headers, so as to confirm whether <code>Cache-Control</code> and other headers have been correctly used by the service and client.</p> <p>If the normal handler is used, this directive may appear within a <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> or <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> directive. If the quick handler is used, this directive must appear within a server or virtual host context, otherwise the setting will be ignored.</p> <pre class=\"prettyprint lang-config\"># Enable the X-Cache-Detail header\nCacheDetailHeader on</pre> <div class=\"example\"><pre>X-Cache-Detail: \"conditional cache hit: entity refreshed\" from localhost</pre></div> </div>  <div class=\"directive-section\">\n<h2 id=\"cachedisable\">CacheDisable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Disable caching of specified URLs</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheDisable url-string | on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>The <code class=\"directive\">CacheDisable</code> directive instructs <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> to <em>not</em> cache urls at or below <var>url-string</var>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">CacheDisable \"/local_files\"</pre> </div> <p>If used in a <code class=\"directive\">&lt;Location&gt;</code> directive, the path needs to be specified below the Location, or if the word \"on\" is used, caching for the whole location will be disabled.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/foo\"&gt;\n    CacheDisable on\n&lt;/Location&gt;</pre> </div> <p>The <code>no-cache</code> environment variable can be set to disable caching on a finer grained set of resources in versions 2.2.12 and later.</p> <h3>See also</h3> <ul> <li><a href=\"../env\">Environment Variables in Apache</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheenable\">CacheEnable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable caching of specified URLs using a specified storage manager</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheEnable cache_type [url-string]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>A url-string of '/' applied to forward proxy content in 2.2 and earlier.</td>\n</tr> </table> <p>The <code class=\"directive\">CacheEnable</code> directive instructs <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> to cache urls at or below <var>url-string</var>. The cache storage manager is specified with the <var>cache_type</var> argument. The <code class=\"directive\">CacheEnable</code> directive can alternatively be placed inside either <code class=\"directive\">&lt;Location&gt;</code> or <code class=\"directive\">&lt;LocationMatch&gt;</code> sections to indicate the content is cacheable. <var>cache_type</var> <code>disk</code> instructs <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> to use the disk based storage manager implemented by <code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code>. <var>cache_type</var> <code>socache</code> instructs <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> to use the shared object cache based storage manager implemented by <code class=\"module\"><a href=\"mod_cache_socache\">mod_cache_socache</a></code>.</p> <p>In the event that the URL space overlaps between different <code class=\"directive\">CacheEnable</code> directives (as in the example below), each possible storage manager will be run until the first one that actually processes the request. The order in which the storage managers are run is determined by the order of the <code class=\"directive\">CacheEnable</code> directives in the configuration file. <code class=\"directive\">CacheEnable</code> directives within <code class=\"directive\">&lt;Location&gt;</code> or <code class=\"directive\">&lt;LocationMatch&gt;</code> sections are processed before globally defined <code class=\"directive\">CacheEnable</code> directives.</p> <p>When acting as a forward proxy server, <var>url-string</var> must minimally begin with a protocol for which caching should be enabled.</p> <pre class=\"prettyprint lang-config\"># Cache content (normal handler only)\nCacheQuickHandler off\n&lt;Location \"/foo\"&gt;\n    CacheEnable disk\n&lt;/Location&gt;\n\n# Cache regex (normal handler only)\nCacheQuickHandler off\n&lt;LocationMatch \"foo$\"&gt;\n    CacheEnable disk\n&lt;/LocationMatch&gt;\n\n# Cache all but forward proxy url's (normal or quick handler)\nCacheEnable  disk  /\n\n# Cache FTP-proxied url's (normal or quick handler)\nCacheEnable  disk  ftp://\n\n# Cache forward proxy content from www.example.org (normal or quick handler)\nCacheEnable  disk  http://www.example.org/</pre> <p>A hostname starting with a <strong>\"*\"</strong> matches all hostnames with that suffix. A hostname starting with <strong>\".\"</strong> matches all hostnames containing the domain components that follow.</p> <pre class=\"prettyprint lang-config\"># Match www.example.org, and fooexample.org\nCacheEnable  disk  \"http://*example.org/\"\n# Match www.example.org, but not fooexample.org\nCacheEnable  disk  \"http://.example.org/\"</pre> <p> The <code>no-cache</code> environment variable can be set to disable caching on a finer grained set of resources in versions 2.2.12 and later.</p> <h3>See also</h3> <ul> <li><a href=\"../env\">Environment Variables in Apache</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheheader\">CacheHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Add an X-Cache header to the response.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheHeader on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheHeader off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.9 and later</td>\n</tr> </table> <p>When the <code class=\"directive\"><a href=\"#cacheheader\">CacheHeader</a></code> directive is switched on, an <strong>X-Cache</strong> header will be added to the response with the cache status of this response. If the normal handler is used, this directive may appear within a <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> or <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> directive. If the quick handler is used, this directive must appear within a server or virtual host context, otherwise the setting will be ignored.</p> <dl> <dt><strong>HIT</strong></dt>\n<dd>The entity was fresh, and was served from cache.</dd> <dt><strong>REVALIDATE</strong></dt>\n<dd>The entity was stale, was successfully revalidated and was served from cache.</dd> <dt><strong>MISS</strong></dt>\n<dd>The entity was fetched from the upstream server and was not served from cache.</dd> </dl> <pre class=\"prettyprint lang-config\"># Enable the X-Cache header\nCacheHeader on</pre> <pre class=\"prettyprint lang-config\">X-Cache: HIT from localhost</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheignorecachecontrol\">CacheIgnoreCacheControl Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Ignore request to not serve cached content to client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheIgnoreCacheControl On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheIgnoreCacheControl Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>Ordinarily, requests containing a Cache-Control: no-cache or Pragma: no-cache header value will not be served from the cache. The <code class=\"directive\">CacheIgnoreCacheControl</code> directive allows this behavior to be overridden. <code class=\"directive\">CacheIgnoreCacheControl On</code> tells the server to attempt to serve the resource from the cache even if the request contains no-cache header values. Resources requiring authorization will <em>never</em> be cached.</p> <pre class=\"prettyprint lang-config\">CacheIgnoreCacheControl On</pre> <div class=\"warning\">\n<p><strong>Warning:</strong></p> This directive will allow serving from the cache even if the client has requested that the document not be served from the cache. This might result in stale content being served. </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#cachestoreprivate\">CacheStorePrivate</a></code></li> <li><code class=\"directive\"><a href=\"#cachestorenostore\">CacheStoreNoStore</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheignoreheaders\">CacheIgnoreHeaders Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Do not store the given HTTP header(s) in the cache. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheIgnoreHeaders header-string [header-string] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheIgnoreHeaders None</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>According to RFC 2616, hop-by-hop HTTP headers are not stored in the cache. The following HTTP headers are hop-by-hop headers and thus do not get stored in the cache in <em>any</em> case regardless of the setting of <code class=\"directive\">CacheIgnoreHeaders</code>:</p> <ul> <li><code>Connection</code></li> <li><code>Keep-Alive</code></li> <li><code>Proxy-Authenticate</code></li> <li><code>Proxy-Authorization</code></li> <li><code>TE</code></li> <li><code>Trailers</code></li> <li><code>Transfer-Encoding</code></li> <li><code>Upgrade</code></li> </ul> <p><code class=\"directive\">CacheIgnoreHeaders</code> specifies additional HTTP headers that should not to be stored in the cache. For example, it makes sense in some cases to prevent cookies from being stored in the cache.</p> <p><code class=\"directive\">CacheIgnoreHeaders</code> takes a space separated list of HTTP headers that should not be stored in the cache. If only hop-by-hop headers not should be stored in the cache (the RFC 2616 compliant behaviour), <code class=\"directive\">CacheIgnoreHeaders</code> can be set to <code>None</code>.</p> <div class=\"example\">\n<h3>Example 1</h3>\n<pre class=\"prettyprint lang-config\">CacheIgnoreHeaders Set-Cookie</pre> </div> <div class=\"example\">\n<h3>Example 2</h3>\n<pre class=\"prettyprint lang-config\">CacheIgnoreHeaders None</pre> </div> <div class=\"warning\">\n<p><strong>Warning:</strong></p> If headers like <code>Expires</code> which are needed for proper cache management are not stored due to a <code class=\"directive\">CacheIgnoreHeaders</code> setting, the behaviour of mod_cache is undefined. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheignorenolastmod\">CacheIgnoreNoLastMod Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Ignore the fact that a response has no Last Modified header.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheIgnoreNoLastMod On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheIgnoreNoLastMod Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>Ordinarily, documents without a last-modified date are not cached. Under some circumstances the last-modified date is removed (during <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> processing for example) or not provided at all. The <code class=\"directive\">CacheIgnoreNoLastMod</code> directive provides a way to specify that documents without last-modified dates should be considered for caching, even without a last-modified date. If neither a last-modified date nor an expiry date are provided with the document then the value specified by the <code class=\"directive\">CacheDefaultExpire</code> directive will be used to generate an expiration date.</p> <pre class=\"prettyprint lang-config\">CacheIgnoreNoLastMod On</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheignorequerystring\">CacheIgnoreQueryString Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Ignore query string when caching</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheIgnoreQueryString On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheIgnoreQueryString Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>Ordinarily, requests with query string parameters are cached separately for each unique query string. This is according to RFC 2616/13.9 done only if an expiration time is specified. The <code class=\"directive\">CacheIgnoreQueryString</code> directive tells the cache to cache requests even if no expiration time is specified, and to reply with a cached reply even if the query string differs. From a caching point of view the request is treated as if having no query string when this directive is enabled.</p> <pre class=\"prettyprint lang-config\">CacheIgnoreQueryString On</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheignoreurlsessionidentifiers\">CacheIgnoreURLSessionIdentifiers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Ignore defined session identifiers encoded in the URL when caching </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheIgnoreURLSessionIdentifiers identifier [identifier] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheIgnoreURLSessionIdentifiers None</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>Sometimes applications encode the session identifier into the URL like in the following Examples: </p> <ul> <li><code>/someapplication/image.gif;jsessionid=123456789</code></li> <li><code>/someapplication/image.gif?PHPSESSIONID=12345678</code></li> </ul> <p>This causes cachable resources to be stored separately for each session, which is often not desired. <code class=\"directive\">CacheIgnoreURLSessionIdentifiers</code> lets define a list of identifiers that are removed from the key that is used to identify an entity in the cache, such that cachable resources are not stored separately for each session. </p> <p><code>CacheIgnoreURLSessionIdentifiers None</code> clears the list of ignored identifiers. Otherwise, each identifier is added to the list.</p> <div class=\"example\">\n<h3>Example 1</h3>\n<pre class=\"prettyprint lang-config\">CacheIgnoreURLSessionIdentifiers jsessionid</pre> </div> <div class=\"example\">\n<h3>Example 2</h3>\n<pre class=\"prettyprint lang-config\">CacheIgnoreURLSessionIdentifiers None</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"cachekeybaseurl\">CacheKeyBaseURL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Override the base URL of reverse proxied cache keys.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheKeyBaseURL URL</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheKeyBaseURL http://example.com</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.9 and later</td>\n</tr> </table> <p>When the <code class=\"directive\"><a href=\"#cachekeybaseurl\">CacheKeyBaseURL</a></code> directive is specified, the URL provided will be used as the base URL to calculate the URL of the cache keys in the reverse proxy configuration. When not specified, the scheme, hostname and port of the current virtual host is used to construct the cache key. When a cluster of machines is present, and all cached entries should be cached beneath the same cache key, a new base URL can be specified with this directive.</p> <pre class=\"prettyprint lang-config\"># Override the base URL of the cache key.\nCacheKeyBaseURL \"http://www.example.com/\"</pre> <div class=\"warning\">Take care when setting this directive. If two separate virtual hosts are accidentally given the same base URL, entries from one virtual host will be served to the other.</div> </div>  <div class=\"directive-section\">\n<h2 id=\"cachelastmodifiedfactor\">CacheLastModifiedFactor Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The factor used to compute an expiry date based on the LastModified date.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheLastModifiedFactor float</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheLastModifiedFactor 0.1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>In the event that a document does not provide an expiry date but does provide a last-modified date, an expiry date can be calculated based on the time since the document was last modified. The <code class=\"directive\">CacheLastModifiedFactor</code> directive specifies a <var>factor</var> to be used in the generation of this expiry date according to the following formula: <code>expiry-period = time-since-last-modified-date * factor expiry-date = current-date + expiry-period</code> For example, if the document was last modified 10 hours ago, and <var>factor</var> is 0.1 then the expiry-period will be set to 10*0.1 = 1 hour. If the current time was 3:00pm then the computed expiry-date would be 3:00pm + 1hour = 4:00pm. If the expiry-period would be longer than that set by <code class=\"directive\">CacheMaxExpire</code>, then the latter takes precedence.</p> <pre class=\"prettyprint lang-config\">CacheLastModifiedFactor 0.5</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachelock\">CacheLock Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable the thundering herd lock.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheLock on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheLock off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.2.15 and later</td>\n</tr> </table> <p>The <code class=\"directive\">CacheLock</code> directive enables the thundering herd lock for the given URL space.</p> <p>In a minimal configuration the following directive is all that is needed to enable the thundering herd lock in the default system temp directory.</p> <pre class=\"prettyprint lang-config\"># Enable cache lock\nCacheLock on</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachelockmaxage\">CacheLockMaxAge Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set the maximum possible age of a cache lock.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheLockMaxAge integer</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheLockMaxAge 5</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>The <code class=\"directive\">CacheLockMaxAge</code> directive specifies the maximum age of any cache lock.</p> <p>A lock older than this value in seconds will be ignored, and the next incoming request will be given the opportunity to re-establish the lock. This mechanism prevents a slow client taking an excessively long time to refresh an entity.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"cachelockpath\">CacheLockPath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set the lock path directory.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheLockPath directory</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheLockPath /tmp/mod_cache-lock</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>The <code class=\"directive\">CacheLockPath</code> directive allows you to specify the directory in which the locks are created. By default, the system's temporary folder is used. Locks consist of empty files that only exist for stale URLs in flight, so is significantly less resource intensive than the traditional disk cache.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"cachemaxexpire\">CacheMaxExpire Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The maximum time in seconds to cache a document</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheMaxExpire seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheMaxExpire 86400 (one day)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>The <code class=\"directive\">CacheMaxExpire</code> directive specifies the maximum number of seconds for which cachable HTTP documents will be retained without checking the origin server. Thus, documents will be out of date at most this number of seconds. This maximum value is enforced even if an expiry date was supplied with the document.</p> <pre class=\"prettyprint lang-config\">CacheMaxExpire 604800</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cacheminexpire\">CacheMinExpire Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The minimum time in seconds to cache a document</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheMinExpire seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheMinExpire 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>The <code class=\"directive\">CacheMinExpire</code> directive specifies the minimum number of seconds for which cachable HTTP documents will be retained without checking the origin server. This is only used if no valid expire time was supplied with the document.</p> <pre class=\"prettyprint lang-config\">CacheMinExpire 3600</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachequickhandler\">CacheQuickHandler Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Run the cache from the quick handler.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheQuickHandler on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheQuickHandler on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Apache HTTP Server 2.3.3 and later</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#cachequickhandler\">CacheQuickHandler</a></code> directive controls the phase in which the cache is handled.</p> <p>In the default enabled configuration, the cache operates within the quick handler phase. This phase short circuits the majority of server processing, and represents the most performant mode of operation for a typical server. The cache <strong>bolts onto</strong> the front of the server, and the majority of server processing is avoided.</p> <p>When disabled, the cache operates as a normal handler, and is subject to the full set of phases when handling a server request. While this mode is slower than the default, it allows the cache to be used in cases where full processing is required, such as when content is subject to authorisation.</p> <pre class=\"prettyprint lang-config\"># Run cache as a normal handler\nCacheQuickHandler off</pre> <p>It is also possible, when the quick handler is disabled, for the administrator to choose the precise location within the filter chain where caching is to be performed, by adding the <strong>CACHE</strong> filter to the chain.</p> <pre class=\"prettyprint lang-config\"># Cache content before mod_include and mod_deflate\nCacheQuickHandler off\nAddOutputFilterByType CACHE;INCLUDES;DEFLATE text/html</pre> <p>If the CACHE filter is specified more than once, the last instance will apply.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"cachestaleonerror\">CacheStaleOnError Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Serve stale content in place of 5xx responses.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheStaleOnError on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheStaleOnError on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.9 and later</td>\n</tr> </table> <p>When the <code class=\"directive\"><a href=\"#cachestaleonerror\">CacheStaleOnError</a></code> directive is switched on, and when stale data is available in the cache, the cache will respond to 5xx responses from the backend by returning the stale data instead of the 5xx response. While the Cache-Control headers sent by clients will be respected, and the raw 5xx responses returned to the client on request, the 5xx response so returned to the client will not invalidate the content in the cache.</p> <pre class=\"prettyprint lang-config\"># Serve stale data on error.\nCacheStaleOnError on</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachestoreexpired\">CacheStoreExpired Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Attempt to cache responses that the server reports as expired</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheStoreExpired On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheStoreExpired Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>Since httpd 2.2.4, responses which have already expired are not stored in the cache. The <code class=\"directive\">CacheStoreExpired</code> directive allows this behavior to be overridden. <code class=\"directive\">CacheStoreExpired</code> On tells the server to attempt to cache the resource if it is stale. Subsequent requests would trigger an If-Modified-Since request of the origin server, and the response may be fulfilled from cache if the backend resource has not changed.</p> <pre class=\"prettyprint lang-config\">CacheStoreExpired On</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cachestorenostore\">CacheStoreNoStore Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Attempt to cache requests or responses that have been marked as no-store.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheStoreNoStore On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheStoreNoStore Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>Ordinarily, requests or responses with Cache-Control: no-store header values will not be stored in the cache. The <code class=\"directive\">CacheStoreNoStore</code> directive allows this behavior to be overridden. <code class=\"directive\">CacheStoreNoStore</code> On tells the server to attempt to cache the resource even if it contains no-store header values. Resources requiring authorization will <em>never</em> be cached.</p> <pre class=\"prettyprint lang-config\">CacheStoreNoStore On</pre> <div class=\"warning\">\n<p><strong>Warning:</strong></p> As described in RFC 2616, the no-store directive is intended to \"prevent the inadvertent release or retention of sensitive information (for example, on backup tapes).\" Enabling this option could store sensitive information in the cache. You are hereby warned. </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#cacheignorecachecontrol\">CacheIgnoreCacheControl</a></code></li> <li><code class=\"directive\"><a href=\"#cachestoreprivate\">CacheStorePrivate</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"cachestoreprivate\">CacheStorePrivate Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Attempt to cache responses that the server has marked as private</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheStorePrivate On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CacheStorePrivate Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_cache</td>\n</tr> </table> <p>Ordinarily, responses with Cache-Control: private header values will not be stored in the cache. The <code class=\"directive\">CacheStorePrivate</code> directive allows this behavior to be overridden. <code class=\"directive\">CacheStorePrivate</code> On tells the server to attempt to cache the resource even if it contains private header values. Resources requiring authorization will <em>never</em> be cached.</p> <pre class=\"prettyprint lang-config\">CacheStorePrivate On</pre> <div class=\"warning\">\n<p><strong>Warning:</strong></p> This directive will allow caching even if the upstream server has requested that the resource not be cached. This directive is only ideal for a 'private' cache. </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#cacheignorecachecontrol\">CacheIgnoreCacheControl</a></code></li> <li><code class=\"directive\"><a href=\"#cachestorenostore\">CacheStoreNoStore</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_cache.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_cache.html</a>\n  </p>\n</div>\n","mod/mod_dir":"<h1>Apache Module mod_dir</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides for \"trailing slash\" redirects and serving directory index files</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>dir_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_dir.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The index of a directory can come from one of two sources:</p> <ul> <li>A file written by the user, typically called <code>index.html</code>. The <code class=\"directive\"><a href=\"#directoryindex\">DirectoryIndex</a></code> directive sets the name of this file. This is controlled by <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code>.</li> <li>Otherwise, a listing generated by the server. This is provided by <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code>.</li> </ul> <p>The two functions are separated so that you can completely remove (or replace) automatic index generation should you want to.</p> <p>A \"trailing slash\" redirect is issued when the server receives a request for a URL <code>http://servername/foo/dirname</code> where <code>dirname</code> is a directory. Directories require a trailing slash, so <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> issues a redirect to <code>http://servername/foo/dirname/</code>.</p>    <div class=\"directive-section\">\n<h2 id=\"directorycheckhandler\">DirectoryCheckHandler Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Toggle how this module responds when another handler is configured</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DirectoryCheckHandler On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DirectoryCheckHandler Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dir</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in 2.4.8 and later. Releases prior to 2.4 implicitly act as if \"DirectoryCheckHandler ON\" was specified.</td>\n</tr> </table> <p>The <code class=\"directive\">DirectoryCheckHandler</code> directive determines whether <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> should check for directory indexes or add trailing slashes when some other handler has been configured for the current URL. Handlers can be set by directives such as <code class=\"directive\"><a href=\"core#sethandler\">SetHandler</a></code> or by other modules, such as <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> during per-directory substitutions. </p> <p> In releases prior to 2.4, this module did not take any action if any other handler was configured for a URL. This allows directory indexes to be served even when a <code class=\"directive\">SetHandler</code> directive is specified for an entire directory, but it can also result in some conflicts with modules such as <code class=\"directive\">mod_rewrite</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"directoryindex\">DirectoryIndex Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>List of resources to look for when the client requests a directory</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DirectoryIndex disabled | local-url [local-url] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DirectoryIndex index.html</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dir</td>\n</tr> </table> <p>The <code class=\"directive\">DirectoryIndex</code> directive sets the list of resources to look for, when the client requests an index of the directory by specifying a / at the end of the directory name. <var>Local-url</var> is the (%-encoded) URL of a document on the server relative to the requested directory; it is usually the name of a file in the directory. Several URLs may be given, in which case the server will return the first one that it finds. If none of the resources exist and the <code>Indexes</code> option is set, the server will generate its own listing of the directory.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">DirectoryIndex index.html</pre> </div> <p>then a request for <code>http://example.com/docs/</code> would return <code>http://example.com/docs/index.html</code> if it exists, or would list the directory if it did not.</p> <p>Note that the documents do not need to be relative to the directory;</p> <pre class=\"prettyprint lang-config\">DirectoryIndex index.html index.txt  /cgi-bin/index.pl</pre> <p>would cause the CGI script <code>/cgi-bin/index.pl</code> to be executed if neither <code>index.html</code> or <code>index.txt</code> existed in a directory.</p> <p>A single argument of \"disabled\" prevents <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> from searching for an index. An argument of \"disabled\" will be interpreted literally if it has any arguments before or after it, even if they are \"disabled\" as well.</p> <p><strong>Note:</strong> Multiple <code class=\"directive\">DirectoryIndex</code> directives within the <a href=\"../sections\"><em>same context</em></a> will add to the list of resources to look for rather than replace: </p> <pre class=\"prettyprint lang-config\"># Example A: Set index.html as an index page, then add index.php to that list as well.\n&lt;Directory \"/foo\"&gt;\n    DirectoryIndex index.html\n    DirectoryIndex index.php\n&lt;/Directory&gt;\n\n# Example B: This is identical to example A, except it's done with a single directive.\n&lt;Directory \"/foo\"&gt;\n    DirectoryIndex index.html index.php\n&lt;/Directory&gt;\n\n# Example C: To replace the list, you must explicitly reset it first:\n# In this example, only index.php will remain as an index resource.\n&lt;Directory \"/foo\"&gt;\n    DirectoryIndex index.html\n    DirectoryIndex disabled\n    DirectoryIndex index.php\n&lt;/Directory&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"directoryindexredirect\">DirectoryIndexRedirect Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures an external redirect for directory indexes. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DirectoryIndexRedirect on | off | permanent | temp | seeother | 3xx-code</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DirectoryIndexRedirect off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dir</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.14 and later</td>\n</tr> </table> <p>By default, the <code class=\"directive\">DirectoryIndex</code> is selected and returned transparently to the client. <code class=\"directive\">DirectoryIndexRedirect</code> causes an external redirect to instead be issued.</p> <p>The argument can be:</p> <ul> <li>\n<code>on</code>: issues a 302 redirection to the index resource.</li> <li>\n<code>off</code>: does not issue a redirection. This is the legacy behaviour of mod_dir.</li> <li>\n<code>permanent</code>: issues a 301 (permanent) redirection to the index resource.</li> <li>\n<code>temp</code>: this has the same effect as <code>on</code>\n</li> <li>\n<code>seeother</code>: issues a 303 redirection (also known as \"See Other\") to the index resource.</li> <li>\n<var>3xx-code</var>: issues a redirection marked by the chosen 3xx code.</li> </ul> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">DirectoryIndexRedirect on</pre> </div> <p>A request for <code>http://example.com/docs/</code> would return a temporary redirect to <code>http://example.com/docs/index.html</code> if it exists.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"directoryslash\">DirectorySlash Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Toggle trailing slash redirects on or off</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DirectorySlash On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DirectorySlash On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dir</td>\n</tr> </table> <p>The <code class=\"directive\">DirectorySlash</code> directive determines whether <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> should fixup URLs pointing to a directory or not.</p> <p>Typically if a user requests a resource without a trailing slash, which points to a directory, <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> redirects him to the same resource, but <em>with</em> trailing slash for some good reasons:</p> <ul> <li>The user is finally requesting the canonical URL of the resource</li> <li>\n<code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> works correctly. Since it doesn't emit the path in the link, it would point to the wrong path.</li> <li>\n<code class=\"directive\"><a href=\"#directoryindex\">DirectoryIndex</a></code> will be evaluated <em>only</em> for directories requested with trailing slash.</li> <li>Relative URL references inside html pages will work correctly.</li> </ul> <p>If you don't want this effect <em>and</em> the reasons above don't apply to you, you can turn off the redirect as shown below. However, be aware that there are possible security implications to doing this.</p> <pre class=\"prettyprint lang-config\"># see security warning below!\n&lt;Location \"/some/path\"&gt;\n    DirectorySlash Off\n    SetHandler some-handler\n&lt;/Location&gt;</pre> <div class=\"warning\">\n<p><strong>Security Warning</strong></p> <p>Turning off the trailing slash redirect may result in an information disclosure. Consider a situation where <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> is active (<code>Options +Indexes</code>) and <code class=\"directive\"><a href=\"#directoryindex\">DirectoryIndex</a></code> is set to a valid resource (say, <code>index.html</code>) and there's no other special handler defined for that URL. In this case a request with a trailing slash would show the <code>index.html</code> file. <strong>But a request without trailing slash would list the directory contents</strong>.</p> </div> <p>Also note that some browsers may erroneously change POST requests into GET (thus discarding POST data) when a redirect is issued.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"fallbackresource\">FallbackResource Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define a default URL for requests that don't map to a file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>FallbackResource disabled | local-url</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>disabled - httpd will return 404 (Not Found)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_dir</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The <code>disabled</code> argument is available in version 2.4.4 and later</td>\n</tr> </table> <p>Use this to set a handler for any URL that doesn't map to anything in your filesystem, and would otherwise return HTTP 404 (Not Found). For example</p> <pre class=\"prettyprint lang-config\">FallbackResource /not-404.php</pre> <p>will cause requests for non-existent files to be handled by <code>not-404.php</code>, while requests for files that exist are unaffected.</p> <p>It is frequently desirable to have a single file or resource handle all requests to a particular directory, except those requests that correspond to an existing file or script. This is often referred to as a 'front controller.'</p> <p>In earlier versions of httpd, this effect typically required <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>, and the use of the <code>-f</code> and <code>-d</code> tests for file and directory existence. This now requires only one line of configuration.</p> <pre class=\"prettyprint lang-config\">FallbackResource /index.php</pre> <p>Existing files, such as images, css files, and so on, will be served normally.</p> <p>Use the <code>disabled</code> argument to disable that feature if inheritance from a parent directory is not desired.</p> <p>In a sub-URI, such as <em>http://example.com/blog/</em> this <em>sub-URI</em> has to be supplied as <var>local-url</var>:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/web/example.com/htdocs/blog\"&gt;\n    FallbackResource /blog/index.php\n&lt;/Directory&gt;\n&lt;Directory \"/web/example.com/htdocs/blog/images\"&gt;\n    FallbackResource disabled\n&lt;/Directory&gt;</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_dir.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_dir.html</a>\n  </p>\n</div>\n","mod/mod_file_cache":"<h1>Apache Module mod_file_cache</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Caches a static list of files in memory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>file_cache_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_file_cache.c</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\"> This module should be used with care. You can easily create a broken site using <code class=\"module\"><a href=\"mod_file_cache\">mod_file_cache</a></code>, so read this document carefully. </div> <p><em>Caching</em> frequently requested files that change very infrequently is a technique for reducing server load. <code class=\"module\"><a href=\"mod_file_cache\">mod_file_cache</a></code> provides two techniques for caching frequently requested <em>static</em> files. Through configuration directives, you can direct <code class=\"module\"><a href=\"mod_file_cache\">mod_file_cache</a></code> to either open then <code>mmap()</code> a file, or to pre-open a file and save the file's open <em>file handle</em>. Both techniques reduce server load when processing requests for these files by doing part of the work (specifically, the file I/O) for serving the file when the server is started rather than during each request.</p> <p>Notice: You cannot use this for speeding up CGI programs or other files which are served by special content handlers. It can only be used for regular files which are usually served by the Apache core content handler.</p> <p>This module is an extension of and borrows heavily from the <code>mod_mmap_static</code> module in Apache 1.3.</p>     <h2 id=\"using\">Using mod_file_cache</h2> <p><code class=\"module\"><a href=\"mod_file_cache\">mod_file_cache</a></code> caches a list of statically configured files via <code class=\"directive\"><a href=\"#mmapfile\">MMapFile</a></code> or <code class=\"directive\"><a href=\"#cachefile\">CacheFile</a></code> directives in the main server configuration.</p> <p>Not all platforms support both directives. You will receive an error message in the server error log if you attempt to use an unsupported directive. If given an unsupported directive, the server will start but the file will not be cached. On platforms that support both directives, you should experiment with both to see which works best for you.</p> <h3>MMapFile Directive</h3> <p>The <code class=\"directive\"><a href=\"#mmapfile\">MMapFile</a></code> directive of <code class=\"module\"><a href=\"mod_file_cache\">mod_file_cache</a></code> maps a list of statically configured files into memory through the system call <code>mmap()</code>. This system call is available on most modern Unix derivatives, but not on all. There are sometimes system-specific limits on the size and number of files that can be <code>mmap()</code>ed, experimentation is probably the easiest way to find out.</p> <p>This <code>mmap()</code>ing is done once at server start or restart, only. So whenever one of the mapped files changes on the filesystem you <em>have</em> to restart the server (see the <a href=\"../stopping\">Stopping and Restarting</a> documentation). To reiterate that point: if the files are modified <em>in place</em> without restarting the server you may end up serving requests that are completely bogus. You should update files by unlinking the old copy and putting a new copy in place. Most tools such as <code>rdist</code> and <code>mv</code> do this. The reason why this modules doesn't take care of changes to the files is that this check would need an extra <code>stat()</code> every time which is a waste and against the intent of I/O reduction.</p> <h3>CacheFile Directive</h3> <p>The <code class=\"directive\"><a href=\"#cachefile\">CacheFile</a></code> directive of <code class=\"module\"><a href=\"mod_file_cache\">mod_file_cache</a></code> opens an active <em>handle</em> or <em>file descriptor</em> to the file (or files) listed in the configuration directive and places these open file handles in the cache. When the file is requested, the server retrieves the handle from the cache and passes it to the <code>sendfile()</code> (or <code>TransmitFile()</code> on Windows), socket API.</p> <p>This file handle caching is done once at server start or restart, only. So whenever one of the cached files changes on the filesystem you <em>have</em> to restart the server (see the <a href=\"../stopping\">Stopping and Restarting</a> documentation). To reiterate that point: if the files are modified <em>in place</em> without restarting the server you may end up serving requests that are completely bogus. You should update files by unlinking the old copy and putting a new copy in place. Most tools such as <code>rdist</code> and <code>mv</code> do this.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Don't bother asking for a directive which recursively caches all the files in a directory. Try this instead... See the <code class=\"directive\"><a href=\"core#include\">Include</a></code> directive, and consider this command:</p> <div class=\"example\"><pre>find /www/htdocs -type f -print \\\n| sed -e 's/.*/mmapfile &amp;/' &gt; /www/conf/mmap.conf</pre></div> </div>   <div class=\"directive-section\">\n<h2 id=\"cachefile\">CacheFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Cache a list of file handles at startup time</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CacheFile file-path [file-path] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_file_cache</td>\n</tr> </table> <p>The <code class=\"directive\">CacheFile</code> directive opens handles to one or more files (given as whitespace separated arguments) and places these handles into the cache at server startup time. Handles to cached files are automatically closed on a server shutdown. When the files have changed on the filesystem, the server should be restarted to re-cache them.</p> <p>Be careful with the <var>file-path</var> arguments: They have to literally match the filesystem path Apache's URL-to-filename translation handlers create. We cannot compare inodes or other stuff to match paths through symbolic links <em>etc.</em> because that again would cost extra <code>stat()</code> system calls which is not acceptable. This module may or may not work with filenames rewritten by <code class=\"module\"><a href=\"mod_alias\">mod_alias</a></code> or <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">CacheFile /usr/local/apache/htdocs/index.html</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"mmapfile\">MMapFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Map a list of files into memory at startup time</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MMapFile file-path [file-path] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_file_cache</td>\n</tr> </table> <p>The <code class=\"directive\">MMapFile</code> directive maps one or more files (given as whitespace separated arguments) into memory at server startup time. They are automatically unmapped on a server shutdown. When the files have changed on the filesystem at least a <code>HUP</code> or <code>USR1</code> signal should be send to the server to re-<code>mmap()</code> them.</p> <p>Be careful with the <var>file-path</var> arguments: They have to literally match the filesystem path Apache's URL-to-filename translation handlers create. We cannot compare inodes or other stuff to match paths through symbolic links <em>etc.</em> because that again would cost extra <code>stat()</code> system calls which is not acceptable. This module may or may not work with filenames rewritten by <code class=\"module\"><a href=\"mod_alias\">mod_alias</a></code> or <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">MMapFile /usr/local/apache/htdocs/index.html</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_file_cache.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_file_cache.html</a>\n  </p>\n</div>\n","mod/mod_ssl":"<h1>Apache Module mod_ssl</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Strong cryptography using the Secure Sockets Layer (SSL) and Transport Layer Security (TLS) protocols</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>ssl_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_ssl.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides SSL v3 and TLS v1.x support for the Apache HTTP Server. SSL v2 is no longer supported.</p> <p>This module relies on <a href=\"http://www.openssl.org/\">OpenSSL</a> to provide the cryptography engine.</p> <p>Further details, discussion, and examples are provided in the <a href=\"../ssl/index\">SSL documentation</a>.</p>     <h2 id=\"envvars\">Environment Variables</h2> <p>This module can be configured to provide several items of SSL information as additional environment variables to the SSI and CGI namespace. This information is not provided by default for performance reasons. (See <code class=\"directive\">SSLOptions</code> StdEnvVars, below.) The generated variables are listed in the table below. For backward compatibility the information can be made available under different names, too. Look in the <a href=\"../ssl/ssl_compat\">Compatibility</a> chapter for details on the compatibility variables.</p> <table class=\"bordered\"> <tr> <th><a name=\"table3\">Variable Name:</a></th> <th>Value Type:</th> <th>Description:</th> </tr> <tr>\n<td><code>HTTPS</code></td> <td>flag</td> <td>HTTPS is being used.</td>\n</tr> <tr>\n<td><code>SSL_PROTOCOL</code></td> <td>string</td> <td>The SSL protocol version (SSLv3, TLSv1, TLSv1.1, TLSv1.2)</td>\n</tr> <tr>\n<td><code>SSL_SESSION_ID</code></td> <td>string</td> <td>The hex-encoded SSL session id</td>\n</tr> <tr>\n<td><code>SSL_SESSION_RESUMED</code></td> <td>string</td> <td>Initial or Resumed SSL Session. Note: multiple requests may be served over the same (Initial or Resumed) SSL session if HTTP KeepAlive is in use</td>\n</tr> <tr>\n<td><code>SSL_SECURE_RENEG</code></td> <td>string</td> <td>\n<code>true</code> if secure renegotiation is supported, else <code>false</code>\n</td>\n</tr> <tr>\n<td><code>SSL_CIPHER</code></td> <td>string</td> <td>The cipher specification name</td>\n</tr> <tr>\n<td><code>SSL_CIPHER_EXPORT</code></td> <td>string</td> <td>\n<code>true</code> if cipher is an export cipher</td>\n</tr> <tr>\n<td><code>SSL_CIPHER_USEKEYSIZE</code></td> <td>number</td> <td>Number of cipher bits (actually used)</td>\n</tr> <tr>\n<td><code>SSL_CIPHER_ALGKEYSIZE</code></td> <td>number</td> <td>Number of cipher bits (possible)</td>\n</tr> <tr>\n<td><code>SSL_COMPRESS_METHOD</code></td> <td>string</td> <td>SSL compression method negotiated</td>\n</tr> <tr>\n<td><code>SSL_VERSION_INTERFACE</code></td> <td>string</td> <td>The mod_ssl program version</td>\n</tr> <tr>\n<td><code>SSL_VERSION_LIBRARY</code></td> <td>string</td> <td>The OpenSSL program version</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_M_VERSION</code></td> <td>string</td> <td>The version of the client certificate</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_M_SERIAL</code></td> <td>string</td> <td>The serial of the client certificate</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_S_DN</code></td> <td>string</td> <td>Subject DN in client's certificate</td>\n</tr> <tr>\n<td>\n<code>SSL_CLIENT_S_DN_</code><em>x509</em>\n</td> <td>string</td> <td>Component of client's Subject DN</td>\n</tr> <tr>\n<td>\n<code>SSL_CLIENT_SAN_Email_</code><em>n</em>\n</td> <td>string</td> <td>Client certificate's subjectAltName extension entries of type rfc822Name</td>\n</tr> <tr>\n<td>\n<code>SSL_CLIENT_SAN_DNS_</code><em>n</em>\n</td> <td>string</td> <td>Client certificate's subjectAltName extension entries of type dNSName</td>\n</tr> <tr>\n<td>\n<code>SSL_CLIENT_SAN_OTHER_msUPN_</code><em>n</em>\n</td> <td>string</td> <td>Client certificate's subjectAltName extension entries of type otherName, Microsoft User Principal Name form (OID 1.3.6.1.4.1.311.20.2.3)</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_I_DN</code></td> <td>string</td> <td>Issuer DN of client's certificate</td>\n</tr> <tr>\n<td>\n<code>SSL_CLIENT_I_DN_</code><em>x509</em>\n</td> <td>string</td> <td>Component of client's Issuer DN</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_V_START</code></td> <td>string</td> <td>Validity of client's certificate (start time)</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_V_END</code></td> <td>string</td> <td>Validity of client's certificate (end time)</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_V_REMAIN</code></td> <td>string</td> <td>Number of days until client's certificate expires</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_A_SIG</code></td> <td>string</td> <td>Algorithm used for the signature of client's certificate</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_A_KEY</code></td> <td>string</td> <td>Algorithm used for the public key of client's certificate</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_CERT</code></td> <td>string</td> <td>PEM-encoded client certificate</td>\n</tr> <tr>\n<td>\n<code>SSL_CLIENT_CERT_CHAIN_</code><em>n</em>\n</td> <td>string</td> <td>PEM-encoded certificates in client certificate chain</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_CERT_RFC4523_CEA</code></td> <td>string</td> <td>Serial number and issuer of the certificate. The format matches that of the CertificateExactAssertion in RFC4523</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_VERIFY</code></td> <td>string</td> <td>\n<code>NONE</code>, <code>SUCCESS</code>, <code>GENEROUS</code> or <code>FAILED:</code><em>reason</em>\n</td>\n</tr> <tr>\n<td><code>SSL_SERVER_M_VERSION</code></td> <td>string</td> <td>The version of the server certificate</td>\n</tr> <tr>\n<td><code>SSL_SERVER_M_SERIAL</code></td> <td>string</td> <td>The serial of the server certificate</td>\n</tr> <tr>\n<td><code>SSL_SERVER_S_DN</code></td> <td>string</td> <td>Subject DN in server's certificate</td>\n</tr> <tr>\n<td>\n<code>SSL_SERVER_SAN_Email_</code><em>n</em>\n</td> <td>string</td> <td>Server certificate's subjectAltName extension entries of type rfc822Name</td>\n</tr> <tr>\n<td>\n<code>SSL_SERVER_SAN_DNS_</code><em>n</em>\n</td> <td>string</td> <td>Server certificate's subjectAltName extension entries of type dNSName</td>\n</tr> <tr>\n<td>\n<code>SSL_SERVER_SAN_OTHER_dnsSRV_</code><em>n</em>\n</td> <td>string</td> <td>Server certificate's subjectAltName extension entries of type otherName, SRVName form (OID 1.3.6.1.5.5.7.8.7, RFC 4985)</td>\n</tr> <tr>\n<td>\n<code>SSL_SERVER_S_DN_</code><em>x509</em>\n</td> <td>string</td> <td>Component of server's Subject DN</td>\n</tr> <tr>\n<td><code>SSL_SERVER_I_DN</code></td> <td>string</td> <td>Issuer DN of server's certificate</td>\n</tr> <tr>\n<td>\n<code>SSL_SERVER_I_DN_</code><em>x509</em>\n</td> <td>string</td> <td>Component of server's Issuer DN</td>\n</tr> <tr>\n<td><code>SSL_SERVER_V_START</code></td> <td>string</td> <td>Validity of server's certificate (start time)</td>\n</tr> <tr>\n<td><code>SSL_SERVER_V_END</code></td> <td>string</td> <td>Validity of server's certificate (end time)</td>\n</tr> <tr>\n<td><code>SSL_SERVER_A_SIG</code></td> <td>string</td> <td>Algorithm used for the signature of server's certificate</td>\n</tr> <tr>\n<td><code>SSL_SERVER_A_KEY</code></td> <td>string</td> <td>Algorithm used for the public key of server's certificate</td>\n</tr> <tr>\n<td><code>SSL_SERVER_CERT</code></td> <td>string</td> <td>PEM-encoded server certificate</td>\n</tr> <tr>\n<td><code>SSL_SRP_USER</code></td> <td>string</td> <td>SRP username</td>\n</tr> <tr>\n<td><code>SSL_SRP_USERINFO</code></td> <td>string</td> <td>SRP user info</td>\n</tr> <tr>\n<td><code>SSL_TLS_SNI</code></td> <td>string</td> <td>Contents of the SNI TLS extension (if supplied with ClientHello)</td>\n</tr> </table> <p><em>x509</em> specifies a component of an X.509 DN; one of <code>C,ST,L,O,OU,CN,T,I,G,S,D,UID,Email</code>. In Apache 2.1 and later, <em>x509</em> may also include a numeric <code>_n</code> suffix. If the DN in question contains multiple attributes of the same name, this suffix is used as a zero-based index to select a particular attribute. For example, where the server certificate subject DN included two OU attributes, <code>SSL_SERVER_S_DN_OU_0</code> and <code>SSL_SERVER_S_DN_OU_1</code> could be used to reference each. A variable name without a <code>_n</code> suffix is equivalent to that name with a <code>_0</code> suffix; the first (or only) attribute. When the environment table is populated using the <code>StdEnvVars</code> option of the <code class=\"directive\"><a href=\"#ssloptions\">SSLOptions</a></code> directive, the first (or only) attribute of any DN is added only under a non-suffixed name; i.e. no <code>_0</code> suffixed entries are added.</p> <p>The format of the <em>*_DN</em> variables has changed in Apache HTTPD 2.3.11. See the <code>LegacyDNStringFormat</code> option for <code class=\"directive\"><a href=\"#ssloptions\">SSLOptions</a></code> for details.</p> <p><code>SSL_CLIENT_V_REMAIN</code> is only available in version 2.1 and later.</p> <p>A number of additional environment variables can also be used in <code class=\"directive\">SSLRequire</code> expressions, or in custom log formats:</p> <div class=\"note\"><pre>HTTP_USER_AGENT        PATH_INFO             AUTH_TYPE\nHTTP_REFERER           QUERY_STRING          SERVER_SOFTWARE\nHTTP_COOKIE            REMOTE_HOST           API_VERSION\nHTTP_FORWARDED         REMOTE_IDENT          TIME_YEAR\nHTTP_HOST              IS_SUBREQ             TIME_MON\nHTTP_PROXY_CONNECTION  DOCUMENT_ROOT         TIME_DAY\nHTTP_ACCEPT            SERVER_ADMIN          TIME_HOUR\nTHE_REQUEST            SERVER_NAME           TIME_MIN\nREQUEST_FILENAME       SERVER_PORT           TIME_SEC\nREQUEST_METHOD         SERVER_PROTOCOL       TIME_WDAY\nREQUEST_SCHEME         REMOTE_ADDR           TIME\nREQUEST_URI            REMOTE_USER</pre></div> <p>In these contexts, two special formats can also be used:</p> <dl> <dt><code>ENV:<em>variablename</em></code></dt> <dd>This will expand to the standard environment variable <em>variablename</em>.</dd> <dt><code>HTTP:<em>headername</em></code></dt> <dd>This will expand to the value of the request header with name <em>headername</em>.</dd> </dl>   <h2 id=\"logformats\">Custom Log Formats</h2> <p>When <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is built into Apache or at least loaded (under DSO situation) additional functions exist for the <a href=\"mod_log_config#formats\">Custom Log Format</a> of <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code>. First there is an additional ``<code>%{</code><em>varname</em><code>}x</code>'' eXtension format function which can be used to expand any variables provided by any module, especially those provided by mod_ssl which can you find in the above table.</p> <p> For backward compatibility there is additionally a special ``<code>%{</code><em>name</em><code>}c</code>'' cryptography format function provided. Information about this function is provided in the <a href=\"../ssl/ssl_compat\">Compatibility</a> chapter.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">CustomLog \"logs/ssl_request_log\" \"%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \\\"%r\\\" %b\"</pre> </div> <p>These formats even work without setting the <code>StdEnvVars</code> option of the <code class=\"directive\"><a href=\"#ssloptions\">SSLOptions</a></code> directive.</p>   <h2 id=\"notes\">Request Notes</h2> <p><code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> sets \"notes\" for the request which can be used in logging with the <code>%{<em>name</em>}n</code> format string in <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code>.</p> <p>The notes supported are as follows:</p> <dl> <dt><code>ssl-access-forbidden</code></dt> <dd>This note is set to the value <code>1</code> if access was denied due to an <code class=\"directive\">SSLRequire</code> or <code class=\"directive\">SSLRequireSSL</code> directive.</dd> <dt><code>ssl-secure-reneg</code></dt> <dd>If <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is built against a version of OpenSSL which supports the secure renegotiation extension, this note is set to the value <code>1</code> if SSL is in used for the current connection, and the client also supports the secure renegotiation extension. If the client does not support the secure renegotiation extension, the note is set to the value <code>0</code>. If <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is not built against a version of OpenSSL which supports secure renegotiation, or if SSL is not in use for the current connection, the note is not set.</dd> </dl>   <h2 id=\"expressionparser\">Expression Parser Extension</h2> <p>When <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is built into Apache or at least loaded (under DSO situation) any <a name=\"envvars\">variables</a> provided by <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> can be used in expressions for the <a href=\"../expr\">ap_expr Expression Parser</a>. The variables can be referenced using the syntax ``<code>%{</code><em>varname</em><code>}</code>''. Starting with version 2.4.18 one can also use the <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> style syntax ``<code>%{SSL:</code><em>varname</em><code>}</code>'' or the function style syntax ``<code>ssl(</code><em>varname</em><code>)</code>''.</p> <div class=\"example\">\n<h3>Example (using <code class=\"module\"><a href=\"mod_headers\">mod_headers</a></code>)</h3>\n<pre class=\"prettyprint lang-config\">Header set X-SSL-PROTOCOL \"expr=%{SSL_PROTOCOL}\"\nHeader set X-SSL-CIPHER \"expr=%{SSL:SSL_CIPHER}\"</pre> </div> <p>This feature even works without setting the <code>StdEnvVars</code> option of the <code class=\"directive\"><a href=\"#ssloptions\">SSLOptions</a></code> directive.</p>   <h2 id=\"authzproviders\">Authorization providers for use with Require</h2> <p><code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> provides a few authentication providers for use with <code class=\"module\"><a href=\"mod_authz_core\">mod_authz_core</a></code>'s <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive.</p> <h3><a name=\"reqssl\" id=\"reqssl\">Require ssl</a></h3> <p>The <code>ssl</code> provider denies access if a connection is not encrypted with SSL. This is similar to the <code class=\"directive\">SSLRequireSSL</code> directive.</p> <pre class=\"prettyprint lang-config\">Require ssl</pre> <h3><a name=\"reqverifyclient\" id=\"reqverifyclient\">Require ssl-verify-client</a></h3> <p>The <code>ssl</code> provider allows access if the user is authenticated with a valid client certificate. This is only useful if <code>SSLVerifyClient optional</code> is in effect.</p> <p>The following example grants access if the user is authenticated either with a client certificate or by username and password.</p> <pre class=\"prettyprint lang-config\">Require ssl-verify-client\nRequire valid-user</pre>   <div class=\"directive-section\">\n<h2 id=\"sslcacertificatefile\">SSLCACertificateFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of concatenated PEM-encoded CA Certificates for Client Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCACertificateFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the <em>all-in-one</em> file where you can assemble the Certificates of Certification Authorities (CA) whose <em>clients</em> you deal with. These are used for Client Authentication. Such a file is simply the concatenation of the various PEM-encoded Certificate files, in order of preference. This can be used alternatively and/or additionally to <code class=\"directive\"><a href=\"#sslcacertificatepath\">SSLCACertificatePath</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCACertificateFile \"/usr/local/apache2/conf/ssl.crt/ca-bundle-client.crt\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcacertificatepath\">SSLCACertificatePath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory of PEM-encoded CA Certificates for Client Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCACertificatePath directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the directory where you keep the Certificates of Certification Authorities (CAs) whose clients you deal with. These are used to verify the client certificate on Client Authentication.</p> <p> The files in this directory have to be PEM-encoded and are accessed through hash filenames. So usually you can't just place the Certificate files there: you also have to create symbolic links named <em>hash-value</em><code>.N</code>. And you should always make sure this directory contains the appropriate symbolic links.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCACertificatePath \"/usr/local/apache2/conf/ssl.crt/\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcadnrequestfile\">SSLCADNRequestFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of concatenated PEM-encoded CA Certificates for defining acceptable CA names</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCADNRequestFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>When a client certificate is requested by mod_ssl, a list of <em>acceptable Certificate Authority names</em> is sent to the client in the SSL handshake. These CA names can be used by the client to select an appropriate client certificate out of those it has available.</p> <p>If neither of the directives <code class=\"directive\"><a href=\"#sslcadnrequestpath\">SSLCADNRequestPath</a></code> or <code class=\"directive\"><a href=\"#sslcadnrequestfile\">SSLCADNRequestFile</a></code> are given, then the set of acceptable CA names sent to the client is the names of all the CA certificates given by the <code class=\"directive\"><a href=\"#sslcacertificatefile\">SSLCACertificateFile</a></code> and <code class=\"directive\"><a href=\"#sslcacertificatepath\">SSLCACertificatePath</a></code> directives; in other words, the names of the CAs which will actually be used to verify the client certificate.</p> <p>In some circumstances, it is useful to be able to send a set of acceptable CA names which differs from the actual CAs used to verify the client certificate - for example, if the client certificates are signed by intermediate CAs. In such cases, <code class=\"directive\"><a href=\"#sslcadnrequestpath\">SSLCADNRequestPath</a></code> and/or <code class=\"directive\"><a href=\"#sslcadnrequestfile\">SSLCADNRequestFile</a></code> can be used; the acceptable CA names are then taken from the complete set of certificates in the directory and/or file specified by this pair of directives.</p> <p><code class=\"directive\"><a href=\"#sslcadnrequestfile\">SSLCADNRequestFile</a></code> must specify an <em>all-in-one</em> file containing a concatenation of PEM-encoded CA certificates.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCADNRequestFile \"/usr/local/apache2/conf/ca-names.crt\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcadnrequestpath\">SSLCADNRequestPath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory of PEM-encoded CA Certificates for defining acceptable CA names</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCADNRequestPath directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>This optional directive can be used to specify the set of <em>acceptable CA names</em> which will be sent to the client when a client certificate is requested. See the <code class=\"directive\"><a href=\"#sslcadnrequestfile\">SSLCADNRequestFile</a></code> directive for more details.</p> <p>The files in this directory have to be PEM-encoded and are accessed through hash filenames. So usually you can't just place the Certificate files there: you also have to create symbolic links named <em>hash-value</em><code>.N</code>. And you should always make sure this directory contains the appropriate symbolic links.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCADNRequestPath \"/usr/local/apache2/conf/ca-names.crt/\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcarevocationcheck\">SSLCARevocationCheck Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable CRL-based revocation checking</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCARevocationCheck chain|leaf|none flags</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLCARevocationCheck none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Optional <em>flag</em>s available in httpd 2.5-dev or later</td>\n</tr> </table> <p> Enables certificate revocation list (CRL) checking. At least one of <code class=\"directive\"><a href=\"#sslcarevocationfile\">SSLCARevocationFile</a></code> or <code class=\"directive\"><a href=\"#sslcarevocationpath\">SSLCARevocationPath</a></code> must be configured. When set to <code>chain</code> (recommended setting), CRL checks are applied to all certificates in the chain, while setting it to <code>leaf</code> limits the checks to the end-entity cert. </p> <p>The available <em>flag</em>s are:</p> <ul> <li>\n<code>no_crl_for_cert_ok</code> <p> Prior to version 2.3.15, CRL checking in mod_ssl also succeeded when no CRL(s) for the checked certificate(s) were found in any of the locations configured with <code class=\"directive\"><a href=\"#sslcarevocationfile\">SSLCARevocationFile</a></code> or <code class=\"directive\"><a href=\"#sslcarevocationpath\">SSLCARevocationPath</a></code>. </p> <p> With the introduction of <code class=\"directive\">SSLCARevocationFile</code>, the behavior has been changed: by default with <code>chain</code> or <code>leaf</code>, CRLs <strong>must</strong> be present for the validation to succeed - otherwise it will fail with an <code>\"unable to get certificate CRL\"</code> error. </p> <p> The <em>flag</em> <code>no_crl_for_cert_ok</code> allows to restore previous behaviour. </p> </li> </ul> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCARevocationCheck chain</pre> </div> <div class=\"example\">\n<h3>Compatibility with versions 2.2</h3>\n<pre class=\"prettyprint lang-config\">SSLCARevocationCheck chain no_crl_for_cert_ok</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcarevocationfile\">SSLCARevocationFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of concatenated PEM-encoded CA CRLs for Client Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCARevocationFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the <em>all-in-one</em> file where you can assemble the Certificate Revocation Lists (CRL) of Certification Authorities (CA) whose <em>clients</em> you deal with. These are used for Client Authentication. Such a file is simply the concatenation of the various PEM-encoded CRL files, in order of preference. This can be used alternatively and/or additionally to <code class=\"directive\"><a href=\"#sslcarevocationpath\">SSLCARevocationPath</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCARevocationFile \"/usr/local/apache2/conf/ssl.crl/ca-bundle-client.crl\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcarevocationpath\">SSLCARevocationPath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory of PEM-encoded CA CRLs for Client Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCARevocationPath directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the directory where you keep the Certificate Revocation Lists (CRL) of Certification Authorities (CAs) whose clients you deal with. These are used to revoke the client certificate on Client Authentication.</p> <p> The files in this directory have to be PEM-encoded and are accessed through hash filenames. So usually you have not only to place the CRL files there. Additionally you have to create symbolic links named <em>hash-value</em><code>.rN</code>. And you should always make sure this directory contains the appropriate symbolic links.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCARevocationPath \"/usr/local/apache2/conf/ssl.crl/\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcertificatechainfile\">SSLCertificateChainFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of PEM-encoded Server CA Certificates</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCertificateChainFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <div class=\"note\">\n<p><strong>SSLCertificateChainFile is deprecated</strong></p> <p><code>SSLCertificateChainFile</code> became obsolete with version 2.4.8, when <code class=\"directive\"><a href=\"#sslcertificatefile\">SSLCertificateFile</a></code> was extended to also load intermediate CA certificates from the server certificate file.</p> </div> <p> This directive sets the optional <em>all-in-one</em> file where you can assemble the certificates of Certification Authorities (CA) which form the certificate chain of the server certificate. This starts with the issuing CA certificate of the server certificate and can range up to the root CA certificate. Such a file is simply the concatenation of the various PEM-encoded CA Certificate files, usually in certificate chain order.</p> <p> This should be used alternatively and/or additionally to <code class=\"directive\"><a href=\"#sslcacertificatepath\">SSLCACertificatePath</a></code> for explicitly constructing the server certificate chain which is sent to the browser in addition to the server certificate. It is especially useful to avoid conflicts with CA certificates when using client authentication. Because although placing a CA certificate of the server certificate chain into <code class=\"directive\"><a href=\"#sslcacertificatepath\">SSLCACertificatePath</a></code> has the same effect for the certificate chain construction, it has the side-effect that client certificates issued by this same CA certificate are also accepted on client authentication.</p> <p> But be careful: Providing the certificate chain works only if you are using a <em>single</em> RSA <em>or</em> DSA based server certificate. If you are using a coupled RSA+DSA certificate pair, this will work only if actually both certificates use the <em>same</em> certificate chain. Else the browsers will be confused in this situation.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCertificateChainFile \"/usr/local/apache2/conf/ssl.crt/ca.crt\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcertificatefile\">SSLCertificateFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Server PEM-encoded X.509 certificate data file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCertificateFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive points to a file with certificate data in PEM format. At a minimum, the file must include an end-entity (leaf) certificate. The directive can be used multiple times (referencing different filenames) to support multiple algorithms for server authentication - typically RSA, DSA, and ECC. The number of supported algorithms depends on the OpenSSL version being used for mod_ssl: with version 1.0.0 or later, <code>openssl list-public-key-algorithms</code> will output a list of supported algorithms, see also the note below about limitations of OpenSSL versions prior to 1.0.2 and the ways to work around them. </p> <p> The files may also include intermediate CA certificates, sorted from leaf to root. This is supported with version 2.4.8 and later, and obsoletes <code class=\"directive\"><a href=\"#sslcertificatechainfile\">SSLCertificateChainFile</a></code>. When running with OpenSSL 1.0.2 or later, this allows to configure the intermediate CA chain on a per-certificate basis. </p> <p> Custom DH parameters and an EC curve name for ephemeral keys, can also be added to end of the first file configured using <code class=\"directive\"><a href=\"#sslcertificatefile\">SSLCertificateFile</a></code>. This is supported in version 2.4.7 or later. Such parameters can be generated using the commands <code>openssl dhparam</code> and <code>openssl ecparam</code>. The parameters can be added as-is to the end of the first certificate file. Only the first file can be used for custom parameters, as they are applied independently of the authentication algorithm type. </p> <p> Finally the end-entity certificate's private key can also be added to the certificate file instead of using a separate <code class=\"directive\"><a href=\"#sslcertificatekeyfile\">SSLCertificateKeyFile</a></code> directive. This practice is highly discouraged. If it is used, the certificate files using such an embedded key must be configured after the certificates using a separate key file. If the private key is encrypted, the pass phrase dialog is forced at startup time. </p> <div class=\"note\"> <p><strong>DH parameter interoperability with primes &gt; 1024 bit</strong></p> <p> Beginning with version 2.4.7, mod_ssl makes use of standardized DH parameters with prime lengths of 2048, 3072 and 4096 bits and with additional prime lengths of 6144 and 8192 bits beginning with version 2.4.10 (from <a href=\"http://www.ietf.org/rfc/rfc3526.txt\">RFC 3526</a>), and hands them out to clients based on the length of the certificate's RSA/DSA key. With Java-based clients in particular (Java 7 or earlier), this may lead to handshake failures - see this <a href=\"../ssl/ssl_faq#javadh\">FAQ answer</a> for working around such issues. </p> </div> <div class=\"note\"> <p><strong>Default DH parameters when using multiple certificates and OpenSSL versions prior to 1.0.2</strong></p> <p> When using multiple certificates to support different authentication algorithms (like RSA, DSA, but mainly ECC) and OpenSSL prior to 1.0.2, it is recommended to either use custom DH parameters (preferably) by adding them to the first certificate file (as described above), or to order the <code class=\"directive\">SSLCertificateFile</code> directives such that RSA/DSA certificates are placed <strong>after</strong> the ECC one. </p> <p> This is due to a limitation in older versions of OpenSSL which don't let the Apache HTTP Server determine the currently selected certificate at handshake time (when the DH parameters must be sent to the peer) but instead always provide the last configured certificate. Consequently, the server may select default DH parameters based on the length of the wrong certificate's key (ECC keys are much smaller than RSA/DSA ones and their length is not relevant for selecting DH primes). </p> <p> Since custom DH parameters always take precedence over the default ones, this issue can be avoided by creating and configuring them (as described above), thus using a custom/suitable length. </p> </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCertificateFile \"/usr/local/apache2/conf/ssl.crt/server.crt\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcertificatekeyfile\">SSLCertificateKeyFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Server PEM-encoded private key file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCertificateKeyFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive points to the PEM-encoded private key file for the server. If the contained private key is encrypted, the pass phrase dialog is forced at startup time.</p> <p> The directive can be used multiple times (referencing different filenames) to support multiple algorithms for server authentication. For each <code class=\"directive\"><a href=\"#sslcertificatekeyfile\">SSLCertificateKeyFile</a></code> directive, there must be a matching <code class=\"directive\">SSLCertificateFile</code> directive.</p> <p> The private key may also be combined with the certificate in the file given by <code class=\"directive\"><a href=\"#sslcertificatefile\">SSLCertificateFile</a></code>, but this practice is highly discouraged. If it is used, the certificate files using such an embedded key must be configured after the certificates using a separate key file.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCertificateKeyFile \"/usr/local/apache2/conf/ssl.key/server.key\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslciphersuite\">SSLCipherSuite Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Cipher Suite available for negotiation in SSL handshake</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCipherSuite cipher-spec</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLCipherSuite DEFAULT (depends on OpenSSL version)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This complex directive uses a colon-separated <em>cipher-spec</em> string consisting of OpenSSL cipher specifications to configure the Cipher Suite the client is permitted to negotiate in the SSL handshake phase. Notice that this directive can be used both in per-server and per-directory context. In per-server context it applies to the standard SSL handshake when a connection is established. In per-directory context it forces a SSL renegotiation with the reconfigured Cipher Suite after the HTTP request was read but before the HTTP response is sent.</p> <p> An SSL cipher specification in <em>cipher-spec</em> is composed of 4 major attributes plus a few extra minor ones:</p> <ul> <li>\n<em>Key Exchange Algorithm</em>:<br> RSA, Diffie-Hellman, Elliptic Curve Diffie-Hellman, Secure Remote Password </li> <li>\n<em>Authentication Algorithm</em>:<br> RSA, Diffie-Hellman, DSS, ECDSA, or none. </li> <li>\n<em>Cipher/Encryption Algorithm</em>:<br> AES, DES, Triple-DES, RC4, RC2, IDEA, etc. </li> <li>\n<em>MAC Digest Algorithm</em>:<br> MD5, SHA or SHA1, SHA256, SHA384. </li> </ul> <p>An SSL cipher can also be an export cipher. SSLv2 ciphers are no longer supported. To specify which ciphers to use, one can either specify all the Ciphers, one at a time, or use aliases to specify the preference and order for the ciphers (see <a href=\"#table1\">Table 1</a>). The actually available ciphers and aliases depends on the used openssl version. Newer openssl versions may include additional ciphers.</p> <table class=\"bordered\"> <tr>\n<th><a name=\"table1\">Tag</a></th> <th>Description</th>\n</tr> <tr><td colspan=\"2\"><em>Key Exchange Algorithm:</em></td></tr> <tr>\n<td><code>kRSA</code></td> <td>RSA key exchange</td>\n</tr> <tr>\n<td><code>kDHr</code></td> <td>Diffie-Hellman key exchange with RSA key</td>\n</tr> <tr>\n<td><code>kDHd</code></td> <td>Diffie-Hellman key exchange with DSA key</td>\n</tr> <tr>\n<td><code>kEDH</code></td> <td>Ephemeral (temp.key) Diffie-Hellman key exchange (no cert)</td> </tr> <tr>\n<td><code>kSRP</code></td> <td>Secure Remote Password (SRP) key exchange</td>\n</tr> <tr><td colspan=\"2\"><em>Authentication Algorithm:</em></td></tr> <tr>\n<td><code>aNULL</code></td> <td>No authentication</td>\n</tr> <tr>\n<td><code>aRSA</code></td> <td>RSA authentication</td>\n</tr> <tr>\n<td><code>aDSS</code></td> <td>DSS authentication</td> </tr> <tr>\n<td><code>aDH</code></td> <td>Diffie-Hellman authentication</td>\n</tr> <tr><td colspan=\"2\"><em>Cipher Encoding Algorithm:</em></td></tr> <tr>\n<td><code>eNULL</code></td> <td>No encryption</td> </tr> <tr>\n<td><code>NULL</code></td> <td>alias for eNULL</td> </tr> <tr>\n<td><code>AES</code></td> <td>AES encryption</td> </tr> <tr>\n<td><code>DES</code></td> <td>DES encryption</td> </tr> <tr>\n<td><code>3DES</code></td> <td>Triple-DES encryption</td> </tr> <tr>\n<td><code>RC4</code></td> <td>RC4 encryption</td> </tr> <tr>\n<td><code>RC2</code></td> <td>RC2 encryption</td> </tr> <tr>\n<td><code>IDEA</code></td> <td>IDEA encryption</td> </tr> <tr><td colspan=\"2\">\n<em>MAC Digest Algorithm</em>:</td></tr> <tr>\n<td><code>MD5</code></td> <td>MD5 hash function</td>\n</tr> <tr>\n<td><code>SHA1</code></td> <td>SHA1 hash function</td>\n</tr> <tr>\n<td><code>SHA</code></td> <td>alias for SHA1</td> </tr> <tr>\n<td><code>SHA256</code></td> <td>SHA256 hash function</td> </tr> <tr>\n<td><code>SHA384</code></td> <td>SHA384 hash function</td> </tr> <tr><td colspan=\"2\"><em>Aliases:</em></td></tr> <tr>\n<td><code>SSLv3</code></td> <td>all SSL version 3.0 ciphers</td> </tr> <tr>\n<td><code>TLSv1</code></td> <td>all TLS version 1.0 ciphers</td> </tr> <tr>\n<td><code>EXP</code></td> <td>all export ciphers</td> </tr> <tr>\n<td><code>EXPORT40</code></td> <td>all 40-bit export ciphers only</td> </tr> <tr>\n<td><code>EXPORT56</code></td> <td>all 56-bit export ciphers only</td> </tr> <tr>\n<td><code>LOW</code></td> <td>all low strength ciphers (no export, single DES)</td>\n</tr> <tr>\n<td><code>MEDIUM</code></td> <td>all ciphers with 128 bit encryption</td> </tr> <tr>\n<td><code>HIGH</code></td> <td>all ciphers using Triple-DES</td> </tr> <tr>\n<td><code>RSA</code></td> <td>all ciphers using RSA key exchange</td> </tr> <tr>\n<td><code>DH</code></td> <td>all ciphers using Diffie-Hellman key exchange</td> </tr> <tr>\n<td><code>EDH</code></td> <td>all ciphers using Ephemeral Diffie-Hellman key exchange</td> </tr> <tr>\n<td><code>ECDH</code></td> <td>Elliptic Curve Diffie-Hellman key exchange</td> </tr> <tr>\n<td><code>ADH</code></td> <td>all ciphers using Anonymous Diffie-Hellman key exchange</td> </tr> <tr>\n<td><code>AECDH</code></td> <td>all ciphers using Anonymous Elliptic Curve Diffie-Hellman key exchange</td> </tr> <tr>\n<td><code>SRP</code></td> <td>all ciphers using Secure Remote Password (SRP) key exchange</td> </tr> <tr>\n<td><code>DSS</code></td> <td>all ciphers using DSS authentication</td> </tr> <tr>\n<td><code>ECDSA</code></td> <td>all ciphers using ECDSA authentication</td> </tr> <tr>\n<td><code>aNULL</code></td> <td>all ciphers using no authentication</td> </tr> </table> <p> Now where this becomes interesting is that these can be put together to specify the order and ciphers you wish to use. To speed this up there are also aliases (<code>SSLv3, TLSv1, EXP, LOW, MEDIUM, HIGH</code>) for certain groups of ciphers. These tags can be joined together with prefixes to form the <em>cipher-spec</em>. Available prefixes are:</p> <ul> <li>none: add cipher to list</li> <li>\n<code>+</code>: move matching ciphers to the current location in list</li> <li>\n<code>-</code>: remove cipher from list (can be added later again)</li> <li>\n<code>!</code>: kill cipher from list completely (can <strong>not</strong> be added later again)</li> </ul> <div class=\"note\"> <p><strong><code>aNULL</code>, <code>eNULL</code> and <code>EXP</code> ciphers are always disabled</strong></p> <p>Beginning with version 2.4.7, null and export-grade ciphers are always disabled, as mod_ssl unconditionally adds <code>!aNULL:!eNULL:!EXP</code> to any cipher string at initialization.</p> </div> <p>A simpler way to look at all of this is to use the ``<code>openssl ciphers -v</code>'' command which provides a nice way to successively create the correct <em>cipher-spec</em> string. The default <em>cipher-spec</em> string depends on the version of the OpenSSL libraries used. Let's suppose it is ``<code>RC4-SHA:AES128-SHA:HIGH:MEDIUM:!aNULL:!MD5</code>'' which means the following: Put <code>RC4-SHA</code> and <code>AES128-SHA</code> at the beginning. We do this, because these ciphers offer a good compromise between speed and security. Next, include high and medium security ciphers. Finally, remove all ciphers which do not authenticate, i.e. for SSL the Anonymous Diffie-Hellman ciphers, as well as all ciphers which use <code>MD5</code> as hash algorithm, because it has been proven insufficient.</p> <div class=\"example\"><pre>$ openssl ciphers -v 'RC4-SHA:AES128-SHA:HIGH:MEDIUM:!aNULL:!MD5'\nRC4-SHA                 SSLv3 Kx=RSA      Au=RSA  Enc=RC4(128)  Mac=SHA1\nAES128-SHA              SSLv3 Kx=RSA      Au=RSA  Enc=AES(128)  Mac=SHA1\nDHE-RSA-AES256-SHA      SSLv3 Kx=DH       Au=RSA  Enc=AES(256)  Mac=SHA1\n...                     ...               ...     ...           ...\nSEED-SHA                SSLv3 Kx=RSA      Au=RSA  Enc=SEED(128) Mac=SHA1\nPSK-RC4-SHA             SSLv3 Kx=PSK      Au=PSK  Enc=RC4(128)  Mac=SHA1\nKRB5-RC4-SHA            SSLv3 Kx=KRB5     Au=KRB5 Enc=RC4(128)  Mac=SHA1</pre></div> <p>The complete list of particular RSA &amp; DH ciphers for SSL is given in <a href=\"#table2\">Table 2</a>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLCipherSuite RSA:!EXP:!NULL:+HIGH:+MEDIUM:-LOW</pre> </div> <table class=\"bordered\"> <tr>\n<th><a name=\"table2\">Cipher-Tag</a></th> <th>Protocol</th> <th>Key Ex.</th> <th>Auth.</th> <th>Enc.</th> <th>MAC</th> <th>Type</th> </tr> <tr><td colspan=\"7\"><em>RSA Ciphers:</em></td></tr> <tr>\n<td><code>DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>3DES(168)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>IDEA-CBC-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>IDEA(128)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>RC4-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>RC4(128)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>RC4-MD5</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>RC4(128)</td> <td>MD5</td> <td></td> </tr> <tr>\n<td><code>DES-CBC-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>DES(56)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>EXP-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>RSA(512)</td> <td>RSA</td> <td>DES(40)</td> <td>SHA1</td> <td> export</td> </tr> <tr>\n<td><code>EXP-RC2-CBC-MD5</code></td> <td>SSLv3</td> <td>RSA(512)</td> <td>RSA</td> <td>RC2(40)</td> <td>MD5</td> <td> export</td> </tr> <tr>\n<td><code>EXP-RC4-MD5</code></td> <td>SSLv3</td> <td>RSA(512)</td> <td>RSA</td> <td>RC4(40)</td> <td>MD5</td> <td> export</td> </tr> <tr>\n<td><code>NULL-SHA</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>None</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>NULL-MD5</code></td> <td>SSLv3</td> <td>RSA</td> <td>RSA</td> <td>None</td> <td>MD5</td> <td></td> </tr> <tr><td colspan=\"7\"><em>Diffie-Hellman Ciphers:</em></td></tr> <tr>\n<td><code>ADH-DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>None</td> <td>3DES(168)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>ADH-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>None</td> <td>DES(56)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>ADH-RC4-MD5</code></td> <td>SSLv3</td> <td>DH</td> <td>None</td> <td>RC4(128)</td> <td>MD5</td> <td></td> </tr> <tr>\n<td><code>EDH-RSA-DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>RSA</td> <td>3DES(168)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>EDH-DSS-DES-CBC3-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>DSS</td> <td>3DES(168)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>EDH-RSA-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>RSA</td> <td>DES(56)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>EDH-DSS-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH</td> <td>DSS</td> <td>DES(56)</td> <td>SHA1</td> <td></td> </tr> <tr>\n<td><code>EXP-EDH-RSA-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH(512)</td> <td>RSA</td> <td>DES(40)</td> <td>SHA1</td> <td> export</td> </tr> <tr>\n<td><code>EXP-EDH-DSS-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH(512)</td> <td>DSS</td> <td>DES(40)</td> <td>SHA1</td> <td> export</td> </tr> <tr>\n<td><code>EXP-ADH-DES-CBC-SHA</code></td> <td>SSLv3</td> <td>DH(512)</td> <td>None</td> <td>DES(40)</td> <td>SHA1</td> <td> export</td> </tr> <tr>\n<td><code>EXP-ADH-RC4-MD5</code></td> <td>SSLv3</td> <td>DH(512)</td> <td>None</td> <td>RC4(40)</td> <td>MD5</td> <td> export</td> </tr> </table> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcompression\">SSLCompression Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable compression on the SSL level</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCompression on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLCompression off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.3 and later, if using OpenSSL 0.9.8 or later; virtual host scope available if using OpenSSL 1.0.0 or later. The default used to be <code>on</code> in version 2.4.3.</td>\n</tr> </table> <p>This directive allows to enable compression on the SSL level.</p> <div class=\"warning\"> <p>Enabling compression causes security issues in most setups (the so called CRIME attack).</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslcryptodevice\">SSLCryptoDevice Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable use of a cryptographic hardware accelerator</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLCryptoDevice engine</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLCryptoDevice builtin</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive enables use of a cryptographic hardware accelerator board to offload some of the SSL processing overhead. This directive can only be used if the SSL toolkit is built with \"engine\" support; OpenSSL 0.9.7 and later releases have \"engine\" support by default, the separate \"-engine\" releases of OpenSSL 0.9.6 must be used.</p> <p>To discover which engine names are supported, run the command \"<code>openssl engine</code>\".</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\"># For a Broadcom accelerator:\nSSLCryptoDevice ubsec</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslengine\">SSLEngine Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>SSL Engine Operation Switch</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLEngine on|off|optional</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLEngine off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive toggles the usage of the SSL/TLS Protocol Engine. This is should be used inside a <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> section to enable SSL/TLS for a that virtual host. By default the SSL/TLS Protocol Engine is disabled for both the main server and all configured virtual hosts.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;VirtualHost _default_:443&gt;\nSSLEngine on\n#...\n&lt;/VirtualHost&gt;</pre> </div> <p>In Apache 2.1 and later, <code class=\"directive\">SSLEngine</code> can be set to <code>optional</code>. This enables support for <a href=\"http://www.ietf.org/rfc/rfc2817.txt\">RFC 2817</a>, Upgrading to TLS Within HTTP/1.1. At this time no web browsers support RFC 2817.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslfips\">SSLFIPS Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>SSL FIPS mode Switch</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLFIPS on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLFIPS off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive toggles the usage of the SSL library FIPS_mode flag. It must be set in the global server context and cannot be configured with conflicting settings (SSLFIPS on followed by SSLFIPS off or similar). The mode applies to all SSL library operations. </p> <p> If httpd was compiled against an SSL library which did not support the FIPS_mode flag, <code>SSLFIPS on</code> will fail. Refer to the FIPS 140-2 Security Policy document of the SSL provider library for specific requirements to use mod_ssl in a FIPS 140-2 approved mode of operation; note that mod_ssl itself is not validated, but may be described as using FIPS 140-2 validated cryptographic module, when all components are assembled and operated under the guidelines imposed by the applicable Security Policy. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslhonorcipherorder\">SSLHonorCipherOrder Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Option to prefer the server's cipher preference order</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLHonorCipherOrder on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLHonorCipherOrder off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>When choosing a cipher during an SSLv3 or TLSv1 handshake, normally the client's preference is used. If this directive is enabled, the server's preference will be used instead.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLHonorCipherOrder on</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslinsecurerenegotiation\">SSLInsecureRenegotiation Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Option to enable support for insecure renegotiation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLInsecureRenegotiation on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLInsecureRenegotiation off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.2.15 and later, if using OpenSSL 0.9.8m or later</td>\n</tr> </table> <p>As originally specified, all versions of the SSL and TLS protocols (up to and including TLS/1.2) were vulnerable to a Man-in-the-Middle attack (<a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555\">CVE-2009-3555</a>) during a renegotiation. This vulnerability allowed an attacker to \"prefix\" a chosen plaintext to the HTTP request as seen by the web server. A protocol extension was developed which fixed this vulnerability if supported by both client and server.</p> <p>If <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is linked against OpenSSL version 0.9.8m or later, by default renegotiation is only supported with clients supporting the new protocol extension. If this directive is enabled, renegotiation will be allowed with old (unpatched) clients, albeit insecurely.</p> <div class=\"warning\">\n<p><strong>Security warning</strong></p> <p>If this directive is enabled, SSL connections will be vulnerable to the Man-in-the-Middle prefix attack as described in <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2009-3555\">CVE-2009-3555</a>.</p> </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLInsecureRenegotiation on</pre> </div> <p>The <code>SSL_SECURE_RENEG</code> environment variable can be used from an SSI or CGI script to determine whether secure renegotiation is supported for a given SSL connection.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocspdefaultresponder\">SSLOCSPDefaultResponder Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set the default responder URI for OCSP validation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSDefaultResponder uri</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>This option sets the default OCSP responder to use. If <code class=\"directive\"><a href=\"#sslocspoverrideresponder\">SSLOCSPOverrideResponder</a></code> is not enabled, the URI given will be used only if no responder URI is specified in the certificate being verified.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocspenable\">SSLOCSPEnable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable OCSP validation of the client certificate chain</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSPEnable on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLOCSPEnable off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>This option enables OCSP validation of the client certificate chain. If this option is enabled, certificates in the client's certificate chain will be validated against an OCSP responder after normal verification (including CRL checks) have taken place.</p> <p>The OCSP responder used is either extracted from the certificate itself, or derived by configuration; see the <code class=\"directive\"><a href=\"#sslocspdefaultresponder\">SSLOCSPDefaultResponder</a></code> and <code class=\"directive\"><a href=\"#sslocspoverrideresponder\">SSLOCSPOverrideResponder</a></code> directives.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLVerifyClient on\nSSLOCSPEnable on\nSSLOCSPDefaultResponder \"http://responder.example.com:8888/responder\"\nSSLOCSPOverrideResponder on</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocspoverrideresponder\">SSLOCSPOverrideResponder Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Force use of the default responder URI for OCSP validation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSPOverrideResponder on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLOCSPOverrideResponder off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>This option forces the configured default OCSP responder to be used during OCSP certificate validation, regardless of whether the certificate being validated references an OCSP responder.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocspproxyurl\">SSLOCSPProxyURL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Proxy URL to use for OCSP requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSPProxyURL url</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.19 and later</td>\n</tr> </table> <p>This option allows to set the URL of a HTTP proxy that should be used for all queries to OCSP responders.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocsprespondertimeout\">SSLOCSPResponderTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Timeout for OCSP queries</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSPResponderTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLOCSPResponderTimeout 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>This option sets the timeout for queries to OCSP responders, when <code class=\"directive\"><a href=\"#sslocspenable\">SSLOCSPEnable</a></code> is turned on.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocspresponsemaxage\">SSLOCSPResponseMaxAge Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum allowable age for OCSP responses</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSPResponseMaxAge seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLOCSPResponseMaxAge -1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>This option sets the maximum allowable age (\"freshness\") for OCSP responses. The default value (<code>-1</code>) does not enforce a maximum age, which means that OCSP responses are considered valid as long as their <code>nextUpdate</code> field is in the future.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocspresponsetimeskew\">SSLOCSPResponseTimeSkew Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum allowable time skew for OCSP response validation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSPResponseTimeSkew seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLOCSPResponseTimeSkew 300</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>This option sets the maximum allowable time skew for OCSP responses (when checking their <code>thisUpdate</code> and <code>nextUpdate</code> fields).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslocspuserequestnonce\">SSLOCSPUseRequestNonce Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use a nonce within OCSP queries</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOCSPUseRequestNonce on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLOCSPUseRequestNonce on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.10 and later</td>\n</tr> </table> <p>This option determines whether queries to OCSP responders should contain a nonce or not. By default, a query nonce is always used and checked against the response's one. When the responder does not use nonces (e.g. Microsoft OCSP Responder), this option should be turned <code>off</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslopensslconfcmd\">SSLOpenSSLConfCmd Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure OpenSSL parameters through its <em>SSL_CONF</em> API</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOpenSSLConfCmd command-name command-value</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.8 and later, if using OpenSSL 1.0.2 or later</td>\n</tr> </table> <p>This directive exposes OpenSSL's <em>SSL_CONF</em> API to mod_ssl, allowing a flexible configuration of OpenSSL parameters without the need of implementing additional <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> directives when new features are added to OpenSSL.</p> <p>The set of available <code class=\"directive\">SSLOpenSSLConfCmd</code> commands depends on the OpenSSL version being used for <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> (at least version 1.0.2 is required). For a list of supported command names, see the section <em>Supported configuration file commands</em> in the <a href=\"http://www.openssl.org/docs/man1.0.2/ssl/SSL_CONF_cmd.html#SUPPORTED-CONFIGURATION-FILE-COMMANDS\">SSL_CONF_cmd(3)</a> manual page for OpenSSL.</p> <p>Some of the <code class=\"directive\">SSLOpenSSLConfCmd</code> commands can be used as an alternative to existing directives (such as <code class=\"directive\"><a href=\"#sslciphersuite\">SSLCipherSuite</a></code> or <code class=\"directive\"><a href=\"#sslprotocol\">SSLProtocol</a></code>), though it should be noted that the syntax / allowable values for the parameters may sometimes differ.</p> <div class=\"example\">\n<h3>Examples</h3>\n<pre class=\"prettyprint lang-config\">SSLOpenSSLConfCmd Options -SessionTicket,ServerPreference\nSSLOpenSSLConfCmd ECDHParameters brainpoolP256r1\nSSLOpenSSLConfCmd ServerInfoFile \"/usr/local/apache2/conf/server-info.pem\"\nSSLOpenSSLConfCmd Protocol \"-ALL, TLSv1.2\"\nSSLOpenSSLConfCmd SignatureAlgorithms RSA+SHA384:ECDSA+SHA256</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"ssloptions\">SSLOptions Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure various SSL engine run-time options</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLOptions [+|-]option ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive can be used to control various run-time options on a per-directory basis. Normally, if multiple <code>SSLOptions</code> could apply to a directory, then the most specific one is taken completely; the options are not merged. However if <em>all</em> the options on the <code>SSLOptions</code> directive are preceded by a plus (<code>+</code>) or minus (<code>-</code>) symbol, the options are merged. Any options preceded by a <code>+</code> are added to the options currently in force, and any options preceded by a <code>-</code> are removed from the options currently in force.</p> <p> The available <em>option</em>s are:</p> <ul> <li>\n<code>StdEnvVars</code> <p> When this option is enabled, the standard set of SSL related CGI/SSI environment variables are created. This per default is disabled for performance reasons, because the information extraction step is a rather expensive operation. So one usually enables this option for CGI and SSI requests only.</p> </li> <li>\n<code>ExportCertData</code> <p> When this option is enabled, additional CGI/SSI environment variables are created: <code>SSL_SERVER_CERT</code>, <code>SSL_CLIENT_CERT</code> and <code>SSL_CLIENT_CERT_CHAIN_</code><em>n</em> (with <em>n</em> = 0,1,2,..). These contain the PEM-encoded X.509 Certificates of server and client for the current HTTPS connection and can be used by CGI scripts for deeper Certificate checking. Additionally all other certificates of the client certificate chain are provided, too. This bloats up the environment a little bit which is why you have to use this option to enable it on demand.</p> </li> <li>\n<code>FakeBasicAuth</code> <p> When this option is enabled, the Subject Distinguished Name (DN) of the Client X509 Certificate is translated into a HTTP Basic Authorization username. This means that the standard Apache authentication methods can be used for access control. The user name is just the Subject of the Client's X509 Certificate (can be determined by running OpenSSL's <code>openssl x509</code> command: <code>openssl x509 -noout -subject -in</code><em>certificate</em><code>.crt</code>). Note that no password is obtained from the user. Every entry in the user file needs this password: ``<code>xxj31ZMTZzkVA</code>'', which is the DES-encrypted version of the word `<code>password</code>''. Those who live under MD5-based encryption (for instance under FreeBSD or BSD/OS, etc.) should use the following MD5 hash of the same word: ``<code>$1$OXLyS...$Owx8s2/m9/gfkcRVXzgoE/</code>''.</p> <p>Note that the <code class=\"directive\"><a href=\"mod_auth_basic#authbasicfake\">AuthBasicFake</a></code> directive within <code class=\"module\"><a href=\"mod_auth_basic\">mod_auth_basic</a></code> can be used as a more general mechanism for faking basic authentication, giving control over the structure of both the username and password.</p> </li> <li>\n<code>StrictRequire</code> <p> This <em>forces</em> forbidden access when <code>SSLRequireSSL</code> or <code>SSLRequire</code> successfully decided that access should be forbidden. Usually the default is that in the case where a ``<code>Satisfy any</code>'' directive is used, and other access restrictions are passed, denial of access due to <code>SSLRequireSSL</code> or <code>SSLRequire</code> is overridden (because that's how the Apache <code>Satisfy</code> mechanism should work.) But for strict access restriction you can use <code>SSLRequireSSL</code> and/or <code>SSLRequire</code> in combination with an ``<code>SSLOptions +StrictRequire</code>''. Then an additional ``<code>Satisfy Any</code>'' has no chance once mod_ssl has decided to deny access.</p> </li> <li>\n<code>OptRenegotiate</code> <p> This enables optimized SSL connection renegotiation handling when SSL directives are used in per-directory context. By default a strict scheme is enabled where <em>every</em> per-directory reconfiguration of SSL parameters causes a <em>full</em> SSL renegotiation handshake. When this option is used mod_ssl tries to avoid unnecessary handshakes by doing more granular (but still safe) parameter checks. Nevertheless these granular checks sometimes may not be what the user expects, so enable this on a per-directory basis only, please.</p> </li> <li>\n<code>LegacyDNStringFormat</code> <p> This option influences how values of the <code>SSL_{CLIENT,SERVER}_{I,S}_DN</code> variables are formatted. Since version 2.3.11, Apache HTTPD uses a RFC 2253 compatible format by default. This uses commas as delimiters between the attributes, allows the use of non-ASCII characters (which are converted to UTF8), escapes various special characters with backslashes, and sorts the attributes with the \"C\" attribute last.</p> <p>If <code>LegacyDNStringFormat</code> is set, the old format will be used which sorts the \"C\" attribute first, uses slashes as separators, and does not handle non-ASCII and special characters in any consistent way. </p> </li> </ul> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLOptions +FakeBasicAuth -StrictRequire\n&lt;Files ~ \"\\.(cgi|shtml)$\"&gt;\n    SSLOptions +StdEnvVars -ExportCertData\n&lt;/Files&gt;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslpassphrasedialog\">SSLPassPhraseDialog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Type of pass phrase dialog for encrypted private keys</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLPassPhraseDialog type</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLPassPhraseDialog builtin</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> When Apache starts up it has to read the various Certificate (see <code class=\"directive\"><a href=\"#sslcertificatefile\">SSLCertificateFile</a></code>) and Private Key (see <code class=\"directive\"><a href=\"#sslcertificatekeyfile\">SSLCertificateKeyFile</a></code>) files of the SSL-enabled virtual servers. Because for security reasons the Private Key files are usually encrypted, mod_ssl needs to query the administrator for a Pass Phrase in order to decrypt those files. This query can be done in two ways which can be configured by <em>type</em>:</p> <ul> <li>\n<code>builtin</code> <p> This is the default where an interactive terminal dialog occurs at startup time just before Apache detaches from the terminal. Here the administrator has to manually enter the Pass Phrase for each encrypted Private Key file. Because a lot of SSL-enabled virtual hosts can be configured, the following reuse-scheme is used to minimize the dialog: When a Private Key file is encrypted, all known Pass Phrases (at the beginning there are none, of course) are tried. If one of those known Pass Phrases succeeds no dialog pops up for this particular Private Key file. If none succeeded, another Pass Phrase is queried on the terminal and remembered for the next round (where it perhaps can be reused).</p> <p> This scheme allows mod_ssl to be maximally flexible (because for N encrypted Private Key files you <em>can</em> use N different Pass Phrases - but then you have to enter all of them, of course) while minimizing the terminal dialog (i.e. when you use a single Pass Phrase for all N Private Key files this Pass Phrase is queried only once).</p>\n</li> <li>\n<code>|/path/to/program [args...]</code> <p>This mode allows an external program to be used which acts as a pipe to a particular input device; the program is sent the standard prompt text used for the <code>builtin</code> mode on <code>stdin</code>, and is expected to write password strings on <code>stdout</code>. If several passwords are needed (or an incorrect password is entered), additional prompt text will be written subsequent to the first password being returned, and more passwords must then be written back.</p>\n</li> <li>\n<code>exec:/path/to/program</code> <p> Here an external program is configured which is called at startup for each encrypted Private Key file. It is called with two arguments (the first is of the form ``<code>servername:portnumber</code>'', the second is either ``<code>RSA</code>'', ``<code>DSA</code>'', ``<code>ECC</code>'' or an integer index starting at 3 if more than three keys are configured), which indicate for which server and algorithm it has to print the corresponding Pass Phrase to <code>stdout</code>. In versions 2.4.8 (unreleased) and 2.4.9, it is called with one argument, a string of the form ``<code>servername:portnumber:index</code>'' (with <code>index</code> being a zero-based integer number), which indicate the server, TCP port and certificate number. The intent is that this external program first runs security checks to make sure that the system is not compromised by an attacker, and only when these checks were passed successfully it provides the Pass Phrase.</p> <p> Both these security checks, and the way the Pass Phrase is determined, can be as complex as you like. Mod_ssl just defines the interface: an executable program which provides the Pass Phrase on <code>stdout</code>. Nothing more or less! So, if you're really paranoid about security, here is your interface. Anything else has to be left as an exercise to the administrator, because local security requirements are so different.</p> <p> The reuse-algorithm above is used here, too. In other words: The external program is called only once per unique Pass Phrase.</p>\n</li> </ul> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLPassPhraseDialog \"exec:/usr/local/apache/sbin/pp-filter\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslprotocol\">SSLProtocol Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure usable SSL/TLS protocol versions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProtocol [+|-]protocol ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProtocol all -SSLv3 (up to 2.4.16: all)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive can be used to control which versions of the SSL/TLS protocol will be accepted in new connections.</p> <p> The available (case-insensitive) <em>protocol</em>s are:</p> <ul> <li>\n<code>SSLv3</code> <p> This is the Secure Sockets Layer (SSL) protocol, version 3.0, from the Netscape Corporation. It is the successor to SSLv2 and the predecessor to TLSv1, but is deprecated in <a href=\"http://www.ietf.org/rfc/rfc7568.txt\">RFC 7568</a>.</p>\n</li> <li>\n<code>TLSv1</code> <p> This is the Transport Layer Security (TLS) protocol, version 1.0. It is the successor to SSLv3 and is defined in <a href=\"http://www.ietf.org/rfc/rfc2246.txt\">RFC 2246</a>. It is supported by nearly every client.</p>\n</li> <li>\n<code>TLSv1.1</code> (when using OpenSSL 1.0.1 and later) <p> A revision of the TLS 1.0 protocol, as defined in <a href=\"http://www.ietf.org/rfc/rfc4346.txt\">RFC 4346</a>.</p>\n</li> <li>\n<code>TLSv1.2</code> (when using OpenSSL 1.0.1 and later) <p> A revision of the TLS 1.1 protocol, as defined in <a href=\"http://www.ietf.org/rfc/rfc5246.txt\">RFC 5246</a>.</p>\n</li> <li>\n<code>all</code> <p> This is a shortcut for ``<code>+SSLv3 +TLSv1</code>'' or - when using OpenSSL 1.0.1 and later - ``<code>+SSLv3 +TLSv1 +TLSv1.1 +TLSv1.2</code>'', respectively (except for OpenSSL versions compiled with the ``no-ssl3'' configuration option, where <code>all</code> does not include <code>+SSLv3</code>).</p>\n</li> </ul> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProtocol TLSv1</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycacertificatefile\">SSLProxyCACertificateFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of concatenated PEM-encoded CA Certificates for Remote Server Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCACertificateFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the <em>all-in-one</em> file where you can assemble the Certificates of Certification Authorities (CA) whose <em>remote servers</em> you deal with. These are used for Remote Server Authentication. Such a file is simply the concatenation of the various PEM-encoded Certificate files, in order of preference. This can be used alternatively and/or additionally to <code class=\"directive\"><a href=\"#sslproxycacertificatepath\">SSLProxyCACertificatePath</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyCACertificateFile \"/usr/local/apache2/conf/ssl.crt/ca-bundle-remote-server.crt\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycacertificatepath\">SSLProxyCACertificatePath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory of PEM-encoded CA Certificates for Remote Server Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCACertificatePath directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the directory where you keep the Certificates of Certification Authorities (CAs) whose remote servers you deal with. These are used to verify the remote server certificate on Remote Server Authentication.</p> <p> The files in this directory have to be PEM-encoded and are accessed through hash filenames. So usually you can't just place the Certificate files there: you also have to create symbolic links named <em>hash-value</em><code>.N</code>. And you should always make sure this directory contains the appropriate symbolic links.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyCACertificatePath \"/usr/local/apache2/conf/ssl.crt/\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycarevocationcheck\">SSLProxyCARevocationCheck Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable CRL-based revocation checking for Remote Server Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCARevocationCheck chain|leaf|none</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyCARevocationCheck none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> Enables certificate revocation list (CRL) checking for the <em>remote servers</em> you deal with. At least one of <code class=\"directive\"><a href=\"#sslproxycarevocationfile\">SSLProxyCARevocationFile</a></code> or <code class=\"directive\"><a href=\"#sslproxycarevocationpath\">SSLProxyCARevocationPath</a></code> must be configured. When set to <code>chain</code> (recommended setting), CRL checks are applied to all certificates in the chain, while setting it to <code>leaf</code> limits the checks to the end-entity cert. </p> <div class=\"note\"> <p><strong>When set to <code>chain</code> or <code>leaf</code>, CRLs <em>must</em> be available for successful validation</strong></p> <p> Prior to version 2.3.15, CRL checking in mod_ssl also succeeded when no CRL(s) were found in any of the locations configured with <code class=\"directive\"><a href=\"#sslproxycarevocationfile\">SSLProxyCARevocationFile</a></code> or <code class=\"directive\"><a href=\"#sslproxycarevocationpath\">SSLProxyCARevocationPath</a></code>. With the introduction of this directive, the behavior has been changed: when checking is enabled, CRLs <em>must</em> be present for the validation to succeed - otherwise it will fail with an <code>\"unable to get certificate CRL\"</code> error. </p> </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyCARevocationCheck chain</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycarevocationfile\">SSLProxyCARevocationFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of concatenated PEM-encoded CA CRLs for Remote Server Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCARevocationFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the <em>all-in-one</em> file where you can assemble the Certificate Revocation Lists (CRL) of Certification Authorities (CA) whose <em>remote servers</em> you deal with. These are used for Remote Server Authentication. Such a file is simply the concatenation of the various PEM-encoded CRL files, in order of preference. This can be used alternatively and/or additionally to <code class=\"directive\"><a href=\"#sslproxycarevocationpath\">SSLProxyCARevocationPath</a></code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyCARevocationFile \"/usr/local/apache2/conf/ssl.crl/ca-bundle-remote-server.crl\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycarevocationpath\">SSLProxyCARevocationPath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory of PEM-encoded CA CRLs for Remote Server Auth</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCARevocationPath directory-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the directory where you keep the Certificate Revocation Lists (CRL) of Certification Authorities (CAs) whose remote servers you deal with. These are used to revoke the remote server certificate on Remote Server Authentication.</p> <p> The files in this directory have to be PEM-encoded and are accessed through hash filenames. So usually you have not only to place the CRL files there. Additionally you have to create symbolic links named <em>hash-value</em><code>.rN</code>. And you should always make sure this directory contains the appropriate symbolic links.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyCARevocationPath \"/usr/local/apache2/conf/ssl.crl/\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycheckpeercn\">SSLProxyCheckPeerCN Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Whether to check the remote server certificate's CN field </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCheckPeerCN on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyCheckPeerCN on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets whether the remote server certificate's CN field is compared against the hostname of the request URL. If both are not equal a 502 status code (Bad Gateway) is sent. <code>SSLProxyCheckPeerCN</code> is superseded by <code class=\"directive\"><a href=\"#sslproxycheckpeername\">SSLProxyCheckPeerName</a></code> in release 2.4.5 and later. </p> <p> In all releases 2.4.5 through 2.4.20, setting <code>SSLProxyCheckPeerName off</code> was sufficient to enable this behavior (as the <code>SSLProxyCheckPeerCN</code> default was <code>on</code>.) In these releases, both directives must be set to <code>off</code> to completely avoid remote server certificate name validation. Many users reported this to be very confusing. </p> <p> As of release 2.4.21, all configurations which enable either one of the <code>SSLProxyCheckPeerName</code> or <code>SSLProxyCheckPeerCN</code> options will use the new <code class=\"directive\"><a href=\"#sslproxycheckpeername\">SSLProxyCheckPeerName</a></code> behavior, and all configurations which disable either one of the <code>SSLProxyCheckPeerName</code> or <code>SSLProxyCheckPeerCN</code> options will supress all remote server certificate name validation. Only the following configuration will trigger the legacy certificate CN comparison in 2.4.21 and later releases; </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyCheckPeerCN on\nSSLProxyCheckPeerName off</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycheckpeerexpire\">SSLProxyCheckPeerExpire Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Whether to check if remote server certificate is expired </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCheckPeerExpire on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyCheckPeerExpire on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets whether it is checked if the remote server certificate is expired or not. If the check fails a 502 status code (Bad Gateway) is sent. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyCheckPeerExpire on</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxycheckpeername\">SSLProxyCheckPeerName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure host name checking for remote server certificates </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCheckPeerName on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyCheckPeerName on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Apache HTTP Server 2.4.5 and later</td>\n</tr> </table> <p> This directive configures host name checking for server certificates when mod_ssl is acting as an SSL client. The check will succeed if the host name from the request URI matches one of the CN attribute(s) of the certificate's subject, or matches the subjectAltName extension. If the check fails, the SSL request is aborted and a 502 status code (Bad Gateway) is returned. </p> <p> Wildcard matching is supported for specific cases: an subjectAltName entry of type dNSName, or CN attributes starting with <code>*.</code> will match with any host name of the same number of name elements and the same suffix. E.g. <code>*.example.org</code> will match <code>foo.example.org</code>, but will not match <code>foo.bar.example.org</code>, because the number of elements in the respective host names differs. </p> <p> This feature was introduced in 2.4.5 and superseded the behavior of the <code class=\"directive\"><a href=\"#sslproxycheckpeercn\">SSLProxyCheckPeerCN</a></code> directive, which only tested the exact value in the first CN attribute against the host name. However, many users were confused by the behavior of using these directives individually, so the mutual behavior of <code>SSLProxyCheckPeerName</code> and <code>SSLProxyCheckPeerCN</code> directives were improved in release 2.4.21. See the <code class=\"directive\"><a href=\"#sslproxycheckpeercn\">SSLProxyCheckPeerCN</a></code> directive description for the original behavior and details of these improvements. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxyciphersuite\">SSLProxyCipherSuite Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Cipher Suite available for negotiation in SSL proxy handshake</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyCipherSuite cipher-spec</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyCipherSuite ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:+LOW:+EXP</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>Equivalent to <code>SSLCipherSuite</code>, but for the proxy connection. Please refer to <code class=\"directive\"><a href=\"#sslciphersuite\">SSLCipherSuite</a></code> for additional information.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxyengine\">SSLProxyEngine Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>SSL Proxy Engine Operation Switch</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyEngine on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyEngine off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive toggles the usage of the SSL/TLS Protocol Engine for proxy. This is usually used inside a <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> section to enable SSL/TLS for proxy usage in a particular virtual host. By default the SSL/TLS Protocol Engine is disabled for proxy both for the main server and all configured virtual hosts.</p> <p>Note that the SSLProxyEngine directive should not, in general, be included in a virtual host that will be acting as a forward proxy (using &lt;Proxy&gt; or &lt;ProxyRequest&gt; directives. SSLProxyEngine is not required to enable a forward proxy server to proxy SSL/TLS requests.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;VirtualHost _default_:443&gt;\n    SSLProxyEngine on\n    #...\n&lt;/VirtualHost&gt;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxymachinecertificatechainfile\">SSLProxyMachineCertificateChainFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of concatenated PEM-encoded CA certificates to be used by the proxy for choosing a certificate</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyMachineCertificateChainFile filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Not applicable</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the all-in-one file where you keep the certificate chain for all of the client certs in use. This directive will be needed if the remote server presents a list of CA certificates that are not direct signers of one of the configured client certificates. </p> <p> This referenced file is simply the concatenation of the various PEM-encoded certificate files. Upon startup, each client certificate configured will be examined and a chain of trust will be constructed. </p> <div class=\"warning\">\n<p><strong>Security warning</strong></p> <p>If this directive is enabled, all of the certificates in the file will be trusted as if they were also in <code class=\"directive\"><a href=\"#sslproxycacertificatefile\"> SSLProxyCACertificateFile</a></code>.</p> </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyMachineCertificateChainFile \"/usr/local/apache2/conf/ssl.crt/proxyCA.pem\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxymachinecertificatefile\">SSLProxyMachineCertificateFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File of concatenated PEM-encoded client certificates and keys to be used by the proxy</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyMachineCertificateFile filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Not applicable</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the all-in-one file where you keep the certificates and keys used for authentication of the proxy server to remote servers. </p> <p> This referenced file is simply the concatenation of the various PEM-encoded certificate files, in order of preference. Use this directive alternatively or additionally to <code>SSLProxyMachineCertificatePath</code>. </p> <div class=\"warning\"> <p>Currently there is no support for encrypted private keys</p> </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyMachineCertificateFile \"/usr/local/apache2/conf/ssl.crt/proxy.pem\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxymachinecertificatepath\">SSLProxyMachineCertificatePath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory of PEM-encoded client certificates and keys to be used by the proxy</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyMachineCertificatePath directory</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Not applicable</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the directory where you keep the certificates and keys used for authentication of the proxy server to remote servers. </p> <p>The files in this directory must be PEM-encoded and are accessed through hash filenames. Additionally, you must create symbolic links named <code><em>hash-value</em>.N</code>. And you should always make sure this directory contains the appropriate symbolic links.</p> <div class=\"warning\"> <p>Currently there is no support for encrypted private keys</p> </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyMachineCertificatePath \"/usr/local/apache2/conf/proxy.crt/\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxyprotocol\">SSLProxyProtocol Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure usable SSL protocol flavors for proxy usage</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyProtocol [+|-]protocol ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyProtocol all -SSLv3 (up to 2.4.16: all)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive can be used to control the SSL protocol flavors mod_ssl should use when establishing its server environment for proxy . It will only connect to servers using one of the provided protocols.</p> <p>Please refer to <code class=\"directive\"><a href=\"#sslprotocol\">SSLProtocol</a></code> for additional information. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxyverify\">SSLProxyVerify Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Type of remote server Certificate verification</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyVerify level</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyVerify none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>When a proxy is configured to forward requests to a remote SSL server, this directive can be used to configure certificate verification of the remote server. </p> <p> The following levels are available for <em>level</em>:</p> <ul> <li>\n<strong>none</strong>: no remote server Certificate is required at all</li> <li>\n<strong>optional</strong>: the remote server <em>may</em> present a valid Certificate</li> <li>\n<strong>require</strong>: the remote server <em>has to</em> present a valid Certificate</li> <li>\n<strong>optional_no_ca</strong>: the remote server may present a valid Certificate<br> but it need not to be (successfully) verifiable.</li> </ul> <p>In practice only levels <strong>none</strong> and <strong>require</strong> are really interesting, because level <strong>optional</strong> doesn't work with all servers and level <strong>optional_no_ca</strong> is actually against the idea of authentication (but can be used to establish SSL test pages, etc.)</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyVerify require</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslproxyverifydepth\">SSLProxyVerifyDepth Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum depth of CA Certificates in Remote Server Certificate verification</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLProxyVerifyDepth number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLProxyVerifyDepth 1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets how deeply mod_ssl should verify before deciding that the remote server does not have a valid certificate. </p> <p> The depth actually is the maximum number of intermediate certificate issuers, i.e. the number of CA certificates which are max allowed to be followed while verifying the remote server certificate. A depth of 0 means that self-signed remote server certificates are accepted only, the default depth of 1 means the remote server certificate can be self-signed or has to be signed by a CA which is directly known to the server (i.e. the CA's certificate is under <code class=\"directive\"><a href=\"#sslproxycacertificatepath\">SSLProxyCACertificatePath</a></code>), etc.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLProxyVerifyDepth 10</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslrandomseed\">SSLRandomSeed Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Pseudo Random Number Generator (PRNG) seeding source</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLRandomSeed context source [bytes]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This configures one or more sources for seeding the Pseudo Random Number Generator (PRNG) in OpenSSL at startup time (<em>context</em> is <code>startup</code>) and/or just before a new SSL connection is established (<em>context</em> is <code>connect</code>). This directive can only be used in the global server context because the PRNG is a global facility.</p> <p> The following <em>source</em> variants are available:</p> <ul> <li>\n<code>builtin</code> <p> This is the always available builtin seeding source. Its usage consumes minimum CPU cycles under runtime and hence can be always used without drawbacks. The source used for seeding the PRNG contains of the current time, the current process id and (when applicable) a randomly chosen 1KB extract of the inter-process scoreboard structure of Apache. The drawback is that this is not really a strong source and at startup time (where the scoreboard is still not available) this source just produces a few bytes of entropy. So you should always, at least for the startup, use an additional seeding source.</p>\n</li> <li>\n<code>file:/path/to/source</code> <p> This variant uses an external file <code>/path/to/source</code> as the source for seeding the PRNG. When <em>bytes</em> is specified, only the first <em>bytes</em> number of bytes of the file form the entropy (and <em>bytes</em> is given to <code>/path/to/source</code> as the first argument). When <em>bytes</em> is not specified the whole file forms the entropy (and <code>0</code> is given to <code>/path/to/source</code> as the first argument). Use this especially at startup time, for instance with an available <code>/dev/random</code> and/or <code>/dev/urandom</code> devices (which usually exist on modern Unix derivatives like FreeBSD and Linux).</p> <p> <em>But be careful</em>: Usually <code>/dev/random</code> provides only as much entropy data as it actually has, i.e. when you request 512 bytes of entropy, but the device currently has only 100 bytes available two things can happen: On some platforms you receive only the 100 bytes while on other platforms the read blocks until enough bytes are available (which can take a long time). Here using an existing <code>/dev/urandom</code> is better, because it never blocks and actually gives the amount of requested data. The drawback is just that the quality of the received data may not be the best.</p>\n</li> <li>\n<code>exec:/path/to/program</code> <p> This variant uses an external executable <code>/path/to/program</code> as the source for seeding the PRNG. When <em>bytes</em> is specified, only the first <em>bytes</em> number of bytes of its <code>stdout</code> contents form the entropy. When <em>bytes</em> is not specified, the entirety of the data produced on <code>stdout</code> form the entropy. Use this only at startup time when you need a very strong seeding with the help of an external program (for instance as in the example above with the <code>truerand</code> utility you can find in the mod_ssl distribution which is based on the AT&amp;T <em>truerand</em> library). Using this in the connection context slows down the server too dramatically, of course. So usually you should avoid using external programs in that context.</p>\n</li> <li>\n<code>egd:/path/to/egd-socket</code> (Unix only) <p> This variant uses the Unix domain socket of the external Entropy Gathering Daemon (EGD) (see <a href=\"http://www.lothar.com/tech/crypto/\">http://www.lothar.com/tech /crypto/</a>) to seed the PRNG. Use this if no random device exists on your platform.</p>\n</li> </ul> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLRandomSeed startup builtin\nSSLRandomSeed startup \"file:/dev/random\"\nSSLRandomSeed startup \"file:/dev/urandom\" 1024\nSSLRandomSeed startup \"exec:/usr/local/bin/truerand\" 16\nSSLRandomSeed connect builtin\nSSLRandomSeed connect \"file:/dev/random\"\nSSLRandomSeed connect \"file:/dev/urandom\" 1024</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslrenegbuffersize\">SSLRenegBufferSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set the size for the SSL renegotiation buffer</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLRenegBufferSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLRenegBufferSize 131072</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p>If an SSL renegotiation is required in per-location context, for example, any use of <code class=\"directive\"><a href=\"#sslverifyclient\">SSLVerifyClient</a></code> in a Directory or Location block, then <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> must buffer any HTTP request body into memory until the new SSL handshake can be performed. This directive can be used to set the amount of memory that will be used for this buffer. </p> <div class=\"warning\"><p> Note that in many configurations, the client sending the request body will be untrusted so a denial of service attack by consumption of memory must be considered when changing this configuration setting. </p></div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLRenegBufferSize 262144</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslrequire\">SSLRequire Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Allow access only when an arbitrarily complex boolean expression is true</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLRequire expression</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <div class=\"note\">\n<p><strong>SSLRequire is deprecated</strong></p> <p><code>SSLRequire</code> is deprecated and should in general be replaced by <a href=\"mod_authz_core#reqexpr\">Require expr</a>. The so called <a href=\"../expr\">ap_expr</a> syntax of <code>Require expr</code> is a superset of the syntax of <code>SSLRequire</code>, with the following exception:</p> <p>In <code>SSLRequire</code>, the comparison operators <code>&lt;</code>, <code>&lt;=</code>, ... are completely equivalent to the operators <code>lt</code>, <code>le</code>, ... and work in a somewhat peculiar way that first compares the length of two strings and then the lexical order. On the other hand, <a href=\"../expr\">ap_expr</a> has two sets of comparison operators: The operators <code>&lt;</code>, <code>&lt;=</code>, ... do lexical string comparison, while the operators <code>-lt</code>, <code>-le</code>, ... do integer comparison. For the latter, there are also aliases without the leading dashes: <code>lt</code>, <code>le</code>, ... </p> </div> <p> This directive specifies a general access requirement which has to be fulfilled in order to allow access. It is a very powerful directive because the requirement specification is an arbitrarily complex boolean expression containing any number of access checks.</p> <p> The <em>expression</em> must match the following syntax (given as a BNF grammar notation):</p> <blockquote> <pre>expr     ::= \"<strong>true</strong>\" | \"<strong>false</strong>\"\n           | \"<strong>!</strong>\" expr\n           | expr \"<strong>&amp;&amp;</strong>\" expr\n           | expr \"<strong>||</strong>\" expr\n           | \"<strong>(</strong>\" expr \"<strong>)</strong>\"\n           | comp\n\ncomp     ::= word \"<strong>==</strong>\" word | word \"<strong>eq</strong>\" word\n           | word \"<strong>!=</strong>\" word | word \"<strong>ne</strong>\" word\n           | word \"<strong>&lt;</strong>\"  word | word \"<strong>lt</strong>\" word\n           | word \"<strong>&lt;=</strong>\" word | word \"<strong>le</strong>\" word\n           | word \"<strong>&gt;</strong>\"  word | word \"<strong>gt</strong>\" word\n           | word \"<strong>&gt;=</strong>\" word | word \"<strong>ge</strong>\" word\n           | word \"<strong>in</strong>\" \"<strong>{</strong>\" wordlist \"<strong>}</strong>\"\n           | word \"<strong>in</strong>\" \"<strong>PeerExtList(</strong>\" word \"<strong>)</strong>\"\n           | word \"<strong>=~</strong>\" regex\n           | word \"<strong>!~</strong>\" regex\n\nwordlist ::= word\n           | wordlist \"<strong>,</strong>\" word\n\nword     ::= digit\n           | cstring\n           | variable\n           | function\n\ndigit    ::= [0-9]+\ncstring  ::= \"...\"\nvariable ::= \"<strong>%{</strong>\" varname \"<strong>}</strong>\"\nfunction ::= funcname \"<strong>(</strong>\" funcargs \"<strong>)</strong>\"</pre> </blockquote> <p>For <code>varname</code> any of the variables described in <a href=\"#envvars\">Environment Variables</a> can be used. For <code>funcname</code> the available functions are listed in the <a href=\"../expr#functions\">ap_expr documentation</a>.</p> <p>The <em>expression</em> is parsed into an internal machine representation when the configuration is loaded, and then evaluated during request processing. In .htaccess context, the <em>expression</em> is both parsed and executed each time the .htaccess file is encountered during request processing.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLRequire (    %{SSL_CIPHER} !~ m/^(EXP|NULL)-/                   \\\n            and %{SSL_CLIENT_S_DN_O} eq \"Snake Oil, Ltd.\"          \\\n            and %{SSL_CLIENT_S_DN_OU} in {\"Staff\", \"CA\", \"Dev\"}    \\\n            and %{TIME_WDAY} -ge 1 and %{TIME_WDAY} -le 5          \\\n            and %{TIME_HOUR} -ge 8 and %{TIME_HOUR} -le 20       ) \\\n           or %{REMOTE_ADDR} =~ m/^192\\.76\\.162\\.[0-9]+$/</pre> </div> <p>The <code>PeerExtList(<em>object-ID</em>)</code> function expects to find zero or more instances of the X.509 certificate extension identified by the given <em>object ID</em> (OID) in the client certificate. The expression evaluates to true if the left-hand side string matches exactly against the value of an extension identified with this OID. (If multiple extensions with the same OID are present, at least one extension must match).</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLRequire \"foobar\" in PeerExtList(\"1.2.3.4.5.6\")</pre> </div> <div class=\"note\">\n<p><strong>Notes on the PeerExtList function</strong></p> <ul> <li><p>The object ID can be specified either as a descriptive name recognized by the SSL library, such as <code>\"nsComment\"</code>, or as a numeric OID, such as <code>\"1.2.3.4.5.6\"</code>.</p></li> <li><p>Expressions with types known to the SSL library are rendered to a string before comparison. For an extension with a type not recognized by the SSL library, mod_ssl will parse the value if it is one of the primitive ASN.1 types UTF8String, IA5String, VisibleString, or BMPString. For an extension of one of these types, the string value will be converted to UTF-8 if necessary, then compared against the left-hand-side expression.</p></li> </ul> </div> <h3>See also</h3> <ul> <li>\n<a href=\"../env\">Environment Variables in Apache HTTP Server</a>, for additional examples. </li> <li><a href=\"mod_authz_core#reqexpr\">Require expr</a></li> <li>\n<a href=\"../expr\">Generic expression syntax in Apache HTTP Server</a> </li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"sslrequiressl\">SSLRequireSSL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Deny access when SSL is not used for the HTTP request</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><code>SSLRequireSSL</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive forbids access unless HTTP over SSL (i.e. HTTPS) is enabled for the current connection. This is very handy inside the SSL-enabled virtual host or directories for defending against configuration errors that expose stuff that should be protected. When this directive is present all requests are denied which are not using SSL.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLRequireSSL</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslsessioncache\">SSLSessionCache Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Type of the global/inter-process SSL Session Cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLSessionCache type</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLSessionCache none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This configures the storage type of the global/inter-process SSL Session Cache. This cache is an optional facility which speeds up parallel request processing. For requests to the same server process (via HTTP keep-alive), OpenSSL already caches the SSL session information locally. But because modern clients request inlined images and other data via parallel requests (usually up to four parallel requests are common) those requests are served by <em>different</em> pre-forked server processes. Here an inter-process cache helps to avoid unnecessary session handshakes.</p> <p> The following five storage <em>type</em>s are currently supported:</p> <ul> <li>\n<code>none</code> <p>This disables the global/inter-process Session Cache. This will incur a noticeable speed penalty and may cause problems if using certain browsers, particularly if client certificates are enabled. This setting is not recommended.</p>\n</li> <li>\n<code>nonenotnull</code> <p>This disables any global/inter-process Session Cache. However it does force OpenSSL to send a non-null session ID to accommodate buggy clients that require one.</p>\n</li> <li>\n<code>dbm:/path/to/datafile</code> <p>This makes use of a DBM hashfile on the local disk to synchronize the local OpenSSL memory caches of the server processes. This session cache may suffer reliability issues under high load. To use this, ensure that <code class=\"module\"><a href=\"mod_socache_dbm\">mod_socache_dbm</a></code> is loaded.</p>\n</li> <li>\n<code>shmcb:/path/to/datafile</code>[<code>(</code><em>size</em><code>)</code>] <p>This makes use of a high-performance cyclic buffer (approx. <em>size</em> bytes in size) inside a shared memory segment in RAM (established via <code>/path/to/datafile</code>) to synchronize the local OpenSSL memory caches of the server processes. This is the recommended session cache. To use this, ensure that <code class=\"module\"><a href=\"mod_socache_shmcb\">mod_socache_shmcb</a></code> is loaded.</p>\n</li> <li>\n<code>dc:UNIX:/path/to/socket</code> <p>This makes use of the <a href=\"http://distcache.sourceforge.net/\">distcache</a> distributed session caching libraries. The argument should specify the location of the server or proxy to be used using the distcache address syntax; for example, <code>UNIX:/path/to/socket</code> specifies a UNIX domain socket (typically a local dc_client proxy); <code>IP:server.example.com:9001</code> specifies an IP address. To use this, ensure that <code class=\"module\"><a href=\"mod_socache_dc\">mod_socache_dc</a></code> is loaded.</p>\n</li> </ul> <div class=\"example\">\n<h3>Examples</h3>\n<pre class=\"prettyprint lang-config\">SSLSessionCache \"dbm:/usr/local/apache/logs/ssl_gcache_data\"\nSSLSessionCache \"shmcb:/usr/local/apache/logs/ssl_gcache_data(512000)\"</pre> </div> <p>The <code>ssl-cache</code> mutex is used to serialize access to the session cache to prevent corruption. This mutex can be configured using the <code class=\"directive\"><a href=\"core#mutex\">Mutex</a></code> directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslsessioncachetimeout\">SSLSessionCacheTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of seconds before an SSL session expires in the Session Cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLSessionCacheTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLSessionCacheTimeout 300</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Applies also to RFC 5077 TLS session resumption in Apache 2.4.10 and later</td>\n</tr> </table> <p> This directive sets the timeout in seconds for the information stored in the global/inter-process SSL Session Cache, the OpenSSL internal memory cache and for sessions resumed by TLS session resumption (RFC 5077). It can be set as low as 15 for testing, but should be set to higher values like 300 in real life.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLSessionCacheTimeout 600</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslsessionticketkeyfile\">SSLSessionTicketKeyFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Persistent encryption/decryption key for TLS session tickets</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLSessionTicketKeyFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.0 and later, if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>Optionally configures a secret key for encrypting and decrypting TLS session tickets, as defined in <a href=\"http://www.ietf.org/rfc/rfc5077.txt\">RFC 5077</a>. Primarily suitable for clustered environments where TLS sessions information should be shared between multiple nodes. For single-instance httpd setups, it is recommended to <em>not</em> configure a ticket key file, but to rely on (random) keys generated by mod_ssl at startup, instead.</p> <p>The ticket key file must contain 48 bytes of random data, preferrably created from a high-entropy source. On a Unix-based system, a ticket key file can be created as follows:</p> <div class=\"example\"><pre>dd if=/dev/random of=/path/to/file.tkey bs=1 count=48</pre></div> <p>Ticket keys should be rotated (replaced) on a frequent basis, as this is the only way to invalidate an existing session ticket - OpenSSL currently doesn't allow to specify a limit for ticket lifetimes. A new ticket key only gets used after restarting the web server. All existing session tickets become invalid after a restart.</p> <div class=\"warning\"> <p>The ticket key file contains sensitive keying material and should be protected with file permissions similar to those used for <code class=\"directive\"><a href=\"#sslcertificatekeyfile\">SSLCertificateKeyFile</a></code>.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslsessiontickets\">SSLSessionTickets Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable or disable use of TLS session tickets</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLSessionTickets on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLSessionTickets on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.11 and later, if using OpenSSL 0.9.8f or later.</td>\n</tr> </table> <p>This directive allows to enable or disable the use of TLS session tickets (RFC 5077).</p> <div class=\"warning\"> <p>TLS session tickets are enabled by default. Using them without restarting the web server with an appropriate frequency (e.g. daily) compromises perfect forward secrecy.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslsrpunknownuserseed\">SSLSRPUnknownUserSeed Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>SRP unknown user seed</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLSRPUnknownUserSeed secret-string</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.4 and later, if using OpenSSL 1.0.1 or later</td>\n</tr> </table> <p> This directive sets the seed used to fake SRP user parameters for unknown users, to avoid leaking whether a given user exists. Specify a secret string. If this directive is not used, then Apache will return the UNKNOWN_PSK_IDENTITY alert to clients who specify an unknown username. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre>SSLSRPUnknownUserSeed \"secret\"</pre>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslsrpverifierfile\">SSLSRPVerifierFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Path to SRP verifier file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLSRPVerifierFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.4 and later, if using OpenSSL 1.0.1 or later</td>\n</tr> </table> <p> This directive enables TLS-SRP and sets the path to the OpenSSL SRP (Secure Remote Password) verifier file containing TLS-SRP usernames, verifiers, salts, and group parameters.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre>SSLSRPVerifierFile \"/path/to/file.srpv\"</pre>\n</div> <p> The verifier file can be created with the <code>openssl</code> command line utility:</p> <div class=\"example\">\n<h3>Creating the SRP verifier file</h3>\n<pre>openssl srp -srpvfile passwd.srpv -userinfo \"some info\" -add username</pre>\n</div> <p> The value given with the optional <code>-userinfo</code> parameter is avalable in the <code>SSL_SRP_USERINFO</code> request environment variable.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingcache\">SSLStaplingCache Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures the OCSP stapling cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingCache type</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>Configures the cache used to store OCSP responses which get included in the TLS handshake if <code class=\"directive\"><a href=\"#sslusestapling\">SSLUseStapling</a></code> is enabled. Configuration of a cache is mandatory for OCSP stapling. With the exception of <code>none</code> and <code>nonenotnull</code>, the same storage types are supported as with <code class=\"directive\"><a href=\"#sslsessioncache\">SSLSessionCache</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingerrorcachetimeout\">SSLStaplingErrorCacheTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of seconds before expiring invalid responses in the OCSP stapling cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingErrorCacheTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStaplingErrorCacheTimeout 600</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>Sets the timeout in seconds before <em>invalid</em> responses in the OCSP stapling cache (configured through <code class=\"directive\"><a href=\"#sslstaplingcache\">SSLStaplingCache</a></code>) will expire. To set the cache timeout for valid responses, see <code class=\"directive\"><a href=\"#sslstaplingstandardcachetimeout\">SSLStaplingStandardCacheTimeout</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingfaketrylater\">SSLStaplingFakeTryLater Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Synthesize \"tryLater\" responses for failed OCSP stapling queries</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingFakeTryLater on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStaplingFakeTryLater on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>When enabled and a query to an OCSP responder for stapling purposes fails, mod_ssl will synthesize a \"tryLater\" response for the client. Only effective if <code class=\"directive\"><a href=\"#sslstaplingreturnrespondererrors\">SSLStaplingReturnResponderErrors</a></code> is also enabled.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingforceurl\">SSLStaplingForceURL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Override the OCSP responder URI specified in the certificate's AIA extension</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingForceURL uri</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>This directive overrides the URI of an OCSP responder as obtained from the authorityInfoAccess (AIA) extension of the certificate. One potential use is when a proxy is used for retrieving OCSP queries.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingrespondertimeout\">SSLStaplingResponderTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Timeout for OCSP stapling queries</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingResponderTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStaplingResponderTimeout 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>This option sets the timeout for queries to OCSP responders when <code class=\"directive\"><a href=\"#sslusestapling\">SSLUseStapling</a></code> is enabled and mod_ssl is querying a responder for OCSP stapling purposes.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingresponsemaxage\">SSLStaplingResponseMaxAge Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum allowable age for OCSP stapling responses</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingResponseMaxAge seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStaplingResponseMaxAge -1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>This option sets the maximum allowable age (\"freshness\") when considering OCSP responses for stapling purposes, i.e. when <code class=\"directive\"><a href=\"#sslusestapling\">SSLUseStapling</a></code> is turned on. The default value (<code>-1</code>) does not enforce a maximum age, which means that OCSP responses are considered valid as long as their <code>nextUpdate</code> field is in the future.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingresponsetimeskew\">SSLStaplingResponseTimeSkew Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum allowable time skew for OCSP stapling response validation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingResponseTimeSkew seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStaplingResponseTimeSkew 300</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>This option sets the maximum allowable time skew when mod_ssl checks the <code>thisUpdate</code> and <code>nextUpdate</code> fields of OCSP responses which get included in the TLS handshake (OCSP stapling). Only applicable if <code class=\"directive\"><a href=\"#sslusestapling\">SSLUseStapling</a></code> is turned on.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingreturnrespondererrors\">SSLStaplingReturnResponderErrors Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Pass stapling related OCSP errors on to client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingReturnResponderErrors on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStaplingReturnResponderErrors on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>When enabled, mod_ssl will pass responses from unsuccessful stapling related OCSP queries (such as responses with an overall status other than \"successful\", responses with a certificate status other than \"good\", expired responses etc.) on to the client. If set to <code>off</code>, only responses indicating a certificate status of \"good\" will be included in the TLS handshake.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstaplingstandardcachetimeout\">SSLStaplingStandardCacheTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of seconds before expiring responses in the OCSP stapling cache</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStaplingStandardCacheTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStaplingStandardCacheTimeout 3600</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>Sets the timeout in seconds before responses in the OCSP stapling cache (configured through <code class=\"directive\"><a href=\"#sslstaplingcache\">SSLStaplingCache</a></code>) will expire. This directive applies to <em>valid</em> responses, while <code class=\"directive\"><a href=\"#sslstaplingerrorcachetimeout\">SSLStaplingErrorCacheTimeout</a></code> is used for controlling the timeout for invalid/unavailable responses. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslstrictsnivhostcheck\">SSLStrictSNIVHostCheck Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Whether to allow non-SNI clients to access a name-based virtual host. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLStrictSNIVHostCheck on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLStrictSNIVHostCheck off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.2.12 and later</td>\n</tr> </table> <p> This directive sets whether a non-SNI client is allowed to access a name-based virtual host. If set to <code>on</code> in the default name-based virtual host, clients that are SNI unaware will not be allowed to access <em>any</em> virtual host, belonging to this particular IP / port combination. If set to <code>on</code> in any other virtual host, SNI unaware clients are not allowed to access this particular virtual host. </p> <div class=\"warning\"><p> This option is only available if httpd was compiled against an SNI capable version of OpenSSL. </p></div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLStrictSNIVHostCheck on</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslusername\">SSLUserName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Variable name to determine user name</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLUserName varname</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the \"user\" field in the Apache request object. This is used by lower modules to identify the user with a character string. In particular, this may cause the environment variable <code>REMOTE_USER</code> to be set. The <em>varname</em> can be any of the <a href=\"#envvars\">SSL environment variables</a>.</p> <p>Note that this directive has no effect if the <code>FakeBasicAuth</code> option is used (see <a href=\"#ssloptions\">SSLOptions</a>).</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLUserName SSL_CLIENT_S_DN_CN</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslusestapling\">SSLUseStapling Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable stapling of OCSP responses in the TLS handshake</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLUseStapling on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLUseStapling off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available if using OpenSSL 0.9.8h or later</td>\n</tr> </table> <p>This option enables OCSP stapling, as defined by the \"Certificate Status Request\" TLS extension specified in RFC 6066. If enabled (and requested by the client), mod_ssl will include an OCSP response for its own certificate in the TLS handshake. Configuring an <code class=\"directive\"><a href=\"#sslstaplingcache\">SSLStaplingCache</a></code> is a prerequisite for enabling OCSP stapling.</p> <p>OCSP stapling relieves the client of querying the OCSP responder on its own, but it should be noted that with the RFC 6066 specification, the server's <code>CertificateStatus</code> reply may only include an OCSP response for a single cert. For server certificates with intermediate CA certificates in their chain (the typical case nowadays), stapling in its current implementation therefore only partially achieves the stated goal of \"saving roundtrips and resources\" - see also <a href=\"http://www.ietf.org/rfc/rfc6961.txt\">RFC 6961</a> (TLS Multiple Certificate Status Extension). </p> <p>When OCSP stapling is enabled, the <code>ssl-stapling</code> mutex is used to control access to the OCSP stapling cache in order to prevent corruption, and the <code>sss-stapling-refresh</code> mutex is used to control refreshes of OCSP responses. These mutexes can be configured using the <code class=\"directive\"><a href=\"core#mutex\">Mutex</a></code> directive. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"sslverifyclient\">SSLVerifyClient Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Type of Client Certificate verification</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLVerifyClient level</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLVerifyClient none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets the Certificate verification level for the Client Authentication. Notice that this directive can be used both in per-server and per-directory context. In per-server context it applies to the client authentication process used in the standard SSL handshake when a connection is established. In per-directory context it forces a SSL renegotiation with the reconfigured client verification level after the HTTP request was read but before the HTTP response is sent.</p> <p> The following levels are available for <em>level</em>:</p> <ul> <li>\n<strong>none</strong>: no client Certificate is required at all</li> <li>\n<strong>optional</strong>: the client <em>may</em> present a valid Certificate</li> <li>\n<strong>require</strong>: the client <em>has to</em> present a valid Certificate</li> <li>\n<strong>optional_no_ca</strong>: the client may present a valid Certificate<br> but it need not to be (successfully) verifiable.</li> </ul> <p>In practice only levels <strong>none</strong> and <strong>require</strong> are really interesting, because level <strong>optional</strong> doesn't work with all browsers and level <strong>optional_no_ca</strong> is actually against the idea of authentication (but can be used to establish SSL test pages, etc.)</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLVerifyClient require</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sslverifydepth\">SSLVerifyDepth Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum depth of CA Certificates in Client Certificate verification</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSLVerifyDepth number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSLVerifyDepth 1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ssl</td>\n</tr> </table> <p> This directive sets how deeply mod_ssl should verify before deciding that the clients don't have a valid certificate. Notice that this directive can be used both in per-server and per-directory context. In per-server context it applies to the client authentication process used in the standard SSL handshake when a connection is established. In per-directory context it forces a SSL renegotiation with the reconfigured client verification depth after the HTTP request was read but before the HTTP response is sent.</p> <p> The depth actually is the maximum number of intermediate certificate issuers, i.e. the number of CA certificates which are max allowed to be followed while verifying the client certificate. A depth of 0 means that self-signed client certificates are accepted only, the default depth of 1 means the client certificate can be self-signed or has to be signed by a CA which is directly known to the server (i.e. the CA's certificate is under <code class=\"directive\"><a href=\"#sslcacertificatepath\">SSLCACertificatePath</a></code>), etc.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SSLVerifyDepth 10</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_ssl.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_ssl.html</a>\n  </p>\n</div>\n","mod/mod_expires":"<h1>Apache Module mod_expires</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Generation of <code>Expires</code> and <code>Cache-Control</code> HTTP headers according to user-specified criteria</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>expires_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_expires.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module controls the setting of the <code>Expires</code> HTTP header and the <code>max-age</code> directive of the <code>Cache-Control</code> HTTP header in server responses. The expiration date can set to be relative to either the time the source file was last modified, or to the time of the client access.</p> <p>These HTTP headers are an instruction to the client about the document's validity and persistence. If cached, the document may be fetched from the cache rather than from the source until this time has passed. After that, the cache copy is considered \"expired\" and invalid, and a new copy must be obtained from the source.</p> <p>To modify <code>Cache-Control</code> directives other than <code>max-age</code> (see <a href=\"http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9\">RFC 2616 section 14.9</a>), you can use the <code class=\"directive\"><a href=\"mod_headers#header\">Header</a></code> directive.</p> <p> When the <code>Expires</code> header is already part of the response generated by the server, for example when generated by a CGI script or proxied from an origin server, this module does not change or add an <code>Expires</code> or <code>Cache-Control</code> header.</p>     <h2 id=\"AltSyn\">Alternate Interval Syntax</h2> <p>The <code class=\"directive\"><a href=\"#expiresdefault\">ExpiresDefault</a></code> and <code class=\"directive\"><a href=\"#expiresbytype\">ExpiresByType</a></code> directives can also be defined in a more readable syntax of the form:</p> <pre class=\"prettyprint lang-config\">ExpiresDefault \"<var>base</var>  [plus <var>num</var> <var>type</var>] [<var>num</var> <var>type</var>] ...\"\nExpiresByType type/encoding \"<var>base</var>  [plus <var>num</var> <var>type</var>] [<var>num</var> <var>type</var>] ...\"</pre> <p>where <var>base</var> is one of:</p> <ul> <li><code>access</code></li> <li>\n<code>now</code> (equivalent to '<code>access</code>')</li> <li><code>modification</code></li> </ul> <p>The <code>plus</code> keyword is optional. <var>num</var> should be an integer value [acceptable to <code>atoi()</code>], and <var>type</var> is one of:</p> <ul> <li><code>years</code></li> <li><code>months</code></li> <li><code>weeks</code></li> <li><code>days</code></li> <li><code>hours</code></li> <li><code>minutes</code></li> <li><code>seconds</code></li> </ul> <p>For example, any of the following directives can be used to make documents expire 1 month after being accessed, by default:</p> <pre class=\"prettyprint lang-config\">ExpiresDefault \"access plus 1 month\"\nExpiresDefault \"access plus 4 weeks\"\nExpiresDefault \"access plus 30 days\"</pre> <p>The expiry time can be fine-tuned by adding several '<var>num</var> <var>type</var>' clauses:</p> <pre class=\"prettyprint lang-config\">ExpiresByType text/html \"access plus 1 month 15 days 2 hours\"\nExpiresByType image/gif \"modification plus 5 hours 3 minutes\"</pre> <p>Note that if you use a modification date based setting, the Expires header will <strong>not</strong> be added to content that does not come from a file on disk. This is due to the fact that there is no modification time for such content.</p>   <div class=\"directive-section\">\n<h2 id=\"expiresactive\">ExpiresActive Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables generation of <code>Expires</code> headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ExpiresActive On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ExpiresActive Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_expires</td>\n</tr> </table> <p>This directive enables or disables the generation of the <code>Expires</code> and <code>Cache-Control</code> headers for the document realm in question. (That is, if found in an <code>.htaccess</code> file, for instance, it applies only to documents generated from that directory.) If set to <code>Off</code>, the headers will not be generated for any document in the realm (unless overridden at a lower level, such as an <code>.htaccess</code> file overriding a server config file). If set to <code>On</code>, the headers will be added to served documents according to the criteria defined by the <code class=\"directive\"><a href=\"#expiresbytype\">ExpiresByType</a></code> and <code class=\"directive\"><a href=\"#expiresdefault\">ExpiresDefault</a></code> directives (<em>q.v.</em>).</p> <p>Note that this directive does not guarantee that an <code>Expires</code> or <code>Cache-Control</code> header will be generated. If the criteria aren't met, no header will be sent, and the effect will be as though this directive wasn't even specified.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"expiresbytype\">ExpiresByType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Value of the <code>Expires</code> header configured by MIME type</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ExpiresByType MIME-type &lt;code&gt;seconds</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_expires</td>\n</tr> </table> <p>This directive defines the value of the <code>Expires</code> header and the <code>max-age</code> directive of the <code>Cache-Control</code> header generated for documents of the specified type (<em>e.g.</em>, <code>text/html</code>). The second argument sets the number of seconds that will be added to a base time to construct the expiration date. The <code>Cache-Control: max-age</code> is calculated by subtracting the request time from the expiration date and expressing the result in seconds.</p> <p>The base time is either the last modification time of the file, or the time of the client's access to the document. Which should be used is specified by the <code>&lt;code&gt;</code> field; <code>M</code> means that the file's last modification time should be used as the base time, and <code>A</code> means the client's access time should be used.</p> <p>The difference in effect is subtle. If <code>M</code> is used, all current copies of the document in all caches will expire at the same time, which can be good for something like a weekly notice that's always found at the same URL. If <code>A</code> is used, the date of expiration is different for each client; this can be good for image files that don't change very often, particularly for a set of related documents that all refer to the same images (<em>i.e.</em>, the images will be accessed repeatedly within a relatively short timespan).</p> <div class=\"example\">\n<h3>Example:</h3>\n<pre class=\"prettyprint lang-config\"># enable expirations\nExpiresActive On\n# expire GIF images after a month in the client's cache\nExpiresByType image/gif A2592000\n# HTML documents are good for a week from the\n# time they were changed\nExpiresByType text/html M604800</pre> </div> <p>Note that this directive only has effect if <code>ExpiresActive On</code> has been specified. It overrides, for the specified MIME type <em>only</em>, any expiration date set by the <code class=\"directive\"><a href=\"#expiresdefault\">ExpiresDefault</a></code> directive.</p> <p>You can also specify the expiration time calculation using an <a href=\"#AltSyn\">alternate syntax</a>, described earlier in this document.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"expiresdefault\">ExpiresDefault Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Default algorithm for calculating expiration time</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ExpiresDefault &lt;code&gt;seconds</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Indexes</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_expires</td>\n</tr> </table> <p>This directive sets the default algorithm for calculating the expiration time for all documents in the affected realm. It can be overridden on a type-by-type basis by the <code class=\"directive\"><a href=\"#expiresbytype\">ExpiresByType</a></code> directive. See the description of that directive for details about the syntax of the argument, and the <a href=\"#AltSyn\">alternate syntax</a> description as well.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_expires.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_expires.html</a>\n  </p>\n</div>\n","mod/mod_ext_filter":"<h1>Apache Module mod_ext_filter</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Pass the response body through an external program before delivery to the client</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>ext_filter_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_ext_filter.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_ext_filter\">mod_ext_filter</a></code> presents a simple and familiar programming model for <a href=\"../filter\">filters</a>. With this module, a program which reads from stdin and writes to stdout (i.e., a Unix-style filter command) can be a filter for Apache. This filtering mechanism is much slower than using a filter which is specially written for the Apache API and runs inside of the Apache server process, but it does have the following benefits:</p> <ul> <li>the programming model is much simpler</li> <li>any programming/scripting language can be used, provided that it allows the program to read from standard input and write to standard output</li> <li>existing programs can be used unmodified as Apache filters</li> </ul> <p>Even when the performance characteristics are not suitable for production use, <code class=\"module\"><a href=\"mod_ext_filter\">mod_ext_filter</a></code> can be used as a prototype environment for filters.</p>     <h2 id=\"examples\">Examples</h2> <h3>Generating HTML from some other type of response</h3> <pre class=\"prettyprint lang-config\"># mod_ext_filter directive to define a filter\n# to HTML-ize text/c files using the external\n# program /usr/bin/enscript, with the type of\n# the result set to text/html\nExtFilterDefine c-to-html mode=output \\\n    intype=text/c outtype=text/html \\\n    cmd=\"/usr/bin/enscript --color -W html -Ec -o - -\"\n\n&lt;Directory \"/export/home/trawick/apacheinst/htdocs/c\"&gt;\n    # core directive to cause the new filter to\n    # be run on output\n    SetOutputFilter c-to-html\n    \n    # mod_mime directive to set the type of .c\n    # files to text/c\n    AddType text/c .c\n&lt;/Directory&gt;</pre> <h3>Implementing a content encoding filter</h3> <p>Note: this gzip example is just for the purposes of illustration. Please refer to <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code> for a practical implementation.</p> <pre class=\"prettyprint lang-config\"># mod_ext_filter directive to define the external filter\nExtFilterDefine gzip mode=output cmd=/bin/gzip\n\n&lt;Location \"/gzipped\"&gt;\n    \n    # core directive to cause the gzip filter to be\n    # run on output\n    SetOutputFilter gzip\n    \n    # mod_headers directive to add\n    # \"Content-Encoding: gzip\" header field\n    Header set Content-Encoding gzip\n&lt;/Location&gt;</pre> <h3>Slowing down the server</h3> <pre class=\"prettyprint lang-config\"># mod_ext_filter directive to define a filter\n# which runs everything through cat; cat doesn't\n# modify anything; it just introduces extra pathlength\n# and consumes more resources\nExtFilterDefine slowdown mode=output cmd=/bin/cat \\\n    preservescontentlength\n\n&lt;Location \"/\"&gt;\n    # core directive to cause the slowdown filter to\n    # be run several times on output\n    #\n    SetOutputFilter slowdown;slowdown;slowdown\n&lt;/Location&gt;</pre> <h3>Using sed to replace text in the response</h3> <pre class=\"prettyprint lang-config\"># mod_ext_filter directive to define a filter which\n# replaces text in the response\n#\nExtFilterDefine fixtext mode=output intype=text/html \\\n    cmd=\"/bin/sed s/verdana/arial/g\"\n\n&lt;Location \"/\"&gt;\n    # core directive to cause the fixtext filter to\n    # be run on output\n    SetOutputFilter fixtext\n&lt;/Location&gt;</pre> <div class=\"note\"> <p>You can do the same thing using <code class=\"module\"><a href=\"mod_substitute\">mod_substitute</a></code> without invoking an external process.</p> </div> <h3>Tracing another filter</h3> <pre class=\"prettyprint lang-config\"># Trace the data read and written by mod_deflate\n# for a particular client (IP 192.168.1.31)\n# experiencing compression problems.\n# This filter will trace what goes into mod_deflate.\nExtFilterDefine tracebefore \\\n    cmd=\"/bin/tracefilter.pl /tmp/tracebefore\" \\\n    EnableEnv=trace_this_client\n\n# This filter will trace what goes after mod_deflate.\n# Note that without the ftype parameter, the default\n# filter type of AP_FTYPE_RESOURCE would cause the\n# filter to be placed *before* mod_deflate in the filter\n# chain.  Giving it a numeric value slightly higher than\n# AP_FTYPE_CONTENT_SET will ensure that it is placed\n# after mod_deflate.\nExtFilterDefine traceafter \\\n    cmd=\"/bin/tracefilter.pl /tmp/traceafter\" \\\n    EnableEnv=trace_this_client ftype=21\n\n&lt;Directory \"/usr/local/docs\"&gt;\n    SetEnvIf Remote_Addr 192.168.1.31 trace_this_client\n    SetOutputFilter tracebefore;deflate;traceafter\n&lt;/Directory&gt;</pre> <div class=\"example\">\n<h3>Here is the filter which traces the data:</h3>\n<pre class=\"prettyprint lang-perl\">#!/usr/local/bin/perl -w\nuse strict;\n\nopen(SAVE, \"&gt;$ARGV[0]\")\n    or die \"can't open $ARGV[0]: $?\";\n\nwhile (&lt;STDIN&gt;) {\n    print SAVE $_;\n    print $_;\n}\n\nclose(SAVE);</pre> </div>   <div class=\"directive-section\">\n<h2 id=\"extfilterdefine\">ExtFilterDefine Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define an external filter</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ExtFilterDefine filtername parameters</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ext_filter</td>\n</tr> </table> <p>The <code class=\"directive\">ExtFilterDefine</code> directive defines the characteristics of an external filter, including the program to run and its arguments.</p> <p><var>filtername</var> specifies the name of the filter being defined. This name can then be used in <code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code> directives. It must be unique among all registered filters. <em>At the present time, no error is reported by the register-filter API, so a problem with duplicate names isn't reported to the user.</em></p> <p>Subsequent parameters can appear in any order and define the external command to run and certain other characteristics. The only required parameter is <code>cmd=</code>. These parameters are:</p> <dl> <dt><code>cmd=cmdline</code></dt> <dd>The <code>cmd=</code> keyword allows you to specify the external command to run. If there are arguments after the program name, the command line should be surrounded in quotation marks (<em>e.g.</em>, <code>cmd=\"/bin/mypgm arg1 arg2\"</code>.) Normal shell quoting is not necessary since the program is run directly, bypassing the shell. Program arguments are blank-delimited. A backslash can be used to escape blanks which should be part of a program argument. Any backslashes which are part of the argument must be escaped with backslash themselves. In addition to the standard CGI environment variables, DOCUMENT_URI, DOCUMENT_PATH_INFO, and QUERY_STRING_UNESCAPED will also be set for the program.</dd> <dt><code>mode=mode</code></dt> <dd>Use <code>mode=output</code> (the default) for filters which process the response. Use <code>mode=input</code> for filters which process the request. <code>mode=input</code> is available in Apache 2.1 and later.</dd> <dt><code>intype=imt</code></dt> <dd>This parameter specifies the internet media type (<em>i.e.</em>, MIME type) of documents which should be filtered. By default, all documents are filtered. If <code>intype=</code> is specified, the filter will be disabled for documents of other types.</dd> <dt><code>outtype=imt</code></dt> <dd>This parameter specifies the internet media type (<em>i.e.</em>, MIME type) of filtered documents. It is useful when the filter changes the internet media type as part of the filtering operation. By default, the internet media type is unchanged.</dd> <dt><code>PreservesContentLength</code></dt> <dd>The <code>PreservesContentLength</code> keyword specifies that the filter preserves the content length. This is not the default, as most filters change the content length. In the event that the filter doesn't modify the length, this keyword should be specified.</dd> <dt><code>ftype=filtertype</code></dt> <dd>This parameter specifies the numeric value for filter type that the filter should be registered as. The default value, AP_FTYPE_RESOURCE, is sufficient in most cases. If the filter needs to operate at a different point in the filter chain than resource filters, then this parameter will be necessary. See the AP_FTYPE_foo definitions in util_filter.h for appropriate values.</dd> <dt><code>disableenv=env</code></dt> <dd>This parameter specifies the name of an environment variable which, if set, will disable the filter.</dd> <dt><code>enableenv=env</code></dt> <dd>This parameter specifies the name of an environment variable which must be set, or the filter will be disabled.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"extfilteroptions\">ExtFilterOptions Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure <code class=\"module\"><a href=\"mod_ext_filter\">mod_ext_filter</a></code> options</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ExtFilterOptions option [option] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ExtFilterOptions NoLogStderr</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ext_filter</td>\n</tr> </table> <p>The <code class=\"directive\">ExtFilterOptions</code> directive specifies special processing options for <code class=\"module\"><a href=\"mod_ext_filter\">mod_ext_filter</a></code>. <var>Option</var> can be one of</p> <dl> <dt><code>LogStderr | NoLogStderr</code></dt> <dd>The <code>LogStderr</code> keyword specifies that messages written to standard error by the external filter program will be saved in the Apache error log. <code>NoLogStderr</code> disables this feature.</dd> <dt><code>Onfail=[abort|remove]</code></dt> <dd>Determines how to proceed if the external filter program cannot be started. With <code>abort</code> (the default value) the request will be aborted. With <code>remove</code>, the filter is removed and the request continues without it.</dd> </dl> <pre class=\"prettyprint lang-config\">ExtFilterOptions LogStderr</pre> <p>Messages written to the filter's standard error will be stored in the Apache error log.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_ext_filter.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_ext_filter.html</a>\n  </p>\n</div>\n","mod/mod_filter":"<h1>Apache Module mod_filter</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Context-sensitive smart filter configuration module</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>filter_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_filter.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module enables smart, context-sensitive configuration of output content filters. For example, apache can be configured to process different content-types through different filters, even when the content-type is not known in advance (e.g. in a proxy).</p> <p><code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> works by introducing indirection into the filter chain. Instead of inserting filters in the chain, we insert a filter harness which in turn dispatches conditionally to a filter provider. Any content filter may be used as a provider to <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code>; no change to existing filter modules is required (although it may be possible to simplify them).</p>     <h2 id=\"smart\">Smart Filtering</h2> <p>In the traditional filtering model, filters are inserted unconditionally using <code class=\"directive\"><a href=\"mod_mime#addoutputfilter\">AddOutputFilter</a></code> and family. Each filter then needs to determine whether to run, and there is little flexibility available for server admins to allow the chain to be configured dynamically.</p> <p><code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> by contrast gives server administrators a great deal of flexibility in configuring the filter chain. In fact, filters can be inserted based on complex boolean <a href=\"../expr\">expressions</a> This generalises the limited flexibility offered by <code class=\"directive\">AddOutputFilterByType</code>.</p>   <h2 id=\"terms\">Filter Declarations, Providers and Chains</h2> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/mod_filter_old.gif\" width=\"160\" height=\"310\" alt=\"[This image displays the traditional filter model]\"><br> <dfn>Figure 1:</dfn> The traditional filter model</p> <p>In the traditional model, output filters are a simple chain from the content generator (handler) to the client. This works well provided the filter chain can be correctly configured, but presents problems when the filters need to be configured dynamically based on the outcome of the handler.</p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/mod_filter_new.gif\" width=\"423\" height=\"331\" alt=\"[This image shows the mod_filter model]\"><br> <dfn>Figure 2:</dfn> The <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> model</p> <p><code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> works by introducing indirection into the filter chain. Instead of inserting filters in the chain, we insert a filter harness which in turn dispatches conditionally to a filter provider. Any content filter may be used as a provider to <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code>; no change to existing filter modules is required (although it may be possible to simplify them). There can be multiple providers for one filter, but no more than one provider will run for any single request.</p> <p>A filter chain comprises any number of instances of the filter harness, each of which may have any number of providers. A special case is that of a single provider with unconditional dispatch: this is equivalent to inserting the provider filter directly into the chain.</p>   <h2 id=\"config\">Configuring the Chain</h2> <p>There are three stages to configuring a filter chain with <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code>. For details of the directives, see below.</p> <dl> <dt>Declare Filters</dt> <dd>The <code class=\"directive\"><a href=\"#filterdeclare\">FilterDeclare</a></code> directive declares a filter, assigning it a name and filter type. Required only if the filter is not the default type AP_FTYPE_RESOURCE.</dd> <dt>Register Providers</dt> <dd>The <code class=\"directive\"><a href=\"#filterprovider\">FilterProvider</a></code> directive registers a provider with a filter. The filter may have been declared with <code class=\"directive\"><a href=\"#filterdeclare\">FilterDeclare</a></code>; if not, FilterProvider will implicitly declare it with the default type AP_FTYPE_RESOURCE. The provider must have been registered with <code>ap_register_output_filter</code> by some module. The final argument to <code class=\"directive\"><a href=\"#filterprovider\">FilterProvider</a></code> is an expression: the provider will be selected to run for a request if and only if the expression evaluates to true. The expression may evaluate HTTP request or response headers, environment variables, or the Handler used by this request. Unlike earlier versions, mod_filter now supports complex expressions involving multiple criteria with AND / OR logic (&amp;&amp; / ||) and brackets. The details of the expression syntax are described in the <a href=\"../expr\">ap_expr documentation</a>.</dd> <dt>Configure the Chain</dt> <dd>The above directives build components of a smart filter chain, but do not configure it to run. The <code class=\"directive\"><a href=\"#filterchain\">FilterChain</a></code> directive builds a filter chain from smart filters declared, offering the flexibility to insert filters at the beginning or end of the chain, remove a filter, or clear the chain.</dd> </dl>   <h2 id=\"errordocs\">Filtering and Response Status</h2> <p>mod_filter normally only runs filters on responses with HTTP status 200 (OK). If you want to filter documents with other response statuses, you can set the <var>filter-errordocs</var> environment variable, and it will work on all responses regardless of status. To refine this further, you can use expression conditions with <code class=\"directive\">FilterProvider</code>.</p>   <h2 id=\"upgrade\">Upgrading from Apache HTTP Server 2.2 Configuration</h2> <p>The <code class=\"directive\"><a href=\"#filterprovider\">FilterProvider</a></code> directive has changed from httpd 2.2: the <var>match</var> and <var>dispatch</var> arguments are replaced with a single but more versatile <var>expression</var>. In general, you can convert a match/dispatch pair to the two sides of an expression, using something like:</p> <div class=\"example\"><pre>\"dispatch = 'match'\"</pre></div> <p>The Request headers, Response headers and Environment variables are now interpreted from syntax <var>%{req:foo}</var>, <var>%{resp:foo}</var> and <var>%{env:foo}</var> respectively. The variables <var>%{HANDLER}</var> and <var>%{CONTENT_TYPE}</var> are also supported.</p> <p>Note that the match no longer support substring matches. They can be replaced by regular expression matches.</p>   <h2 id=\"examples\">Examples</h2> <dl> <dt>Server side Includes (SSI)</dt> <dd>A simple case of replacing <code class=\"directive\">AddOutputFilterByType</code> <pre class=\"prettyprint lang-config\">FilterDeclare SSI\nFilterProvider SSI INCLUDES \"%{CONTENT_TYPE} =~ m|^text/html|\"\nFilterChain SSI</pre> </dd> <dt>Server side Includes (SSI)</dt> <dd>The same as the above but dispatching on handler (classic SSI behaviour; .shtml files get processed). <pre class=\"prettyprint lang-config\">FilterProvider SSI INCLUDES \"%{HANDLER} = 'server-parsed'\"\nFilterChain SSI</pre> </dd> <dt>Emulating mod_gzip with mod_deflate</dt> <dd>Insert INFLATE filter only if \"gzip\" is NOT in the Accept-Encoding header. This filter runs with ftype CONTENT_SET. <pre class=\"prettyprint lang-config\">FilterDeclare gzip CONTENT_SET\nFilterProvider gzip inflate \"%{req:Accept-Encoding} !~ /gzip/\"\nFilterChain gzip</pre> </dd> <dt>Image Downsampling</dt> <dd>Suppose we want to downsample all web images, and have filters for GIF, JPEG and PNG. <pre class=\"prettyprint lang-config\">FilterProvider unpack jpeg_unpack \"%{CONTENT_TYPE} = 'image/jpeg'\"\nFilterProvider unpack gif_unpack \"%{CONTENT_TYPE} = 'image/gif'\"\nFilterProvider unpack png_unpack \"%{CONTENT_TYPE} = 'image/png'\"\n\nFilterProvider downsample downsample_filter \"%{CONTENT_TYPE} = m|^image/(jpeg|gif|png)|\"\nFilterProtocol downsample \"change=yes\"\n\nFilterProvider repack jpeg_pack \"%{CONTENT_TYPE} = 'image/jpeg'\"\nFilterProvider repack gif_pack \"%{CONTENT_TYPE} = 'image/gif'\"\nFilterProvider repack png_pack \"%{CONTENT_TYPE} = 'image/png'\"\n&lt;Location \"/image-filter\"&gt;\n    FilterChain unpack downsample repack\n&lt;/Location&gt;</pre> </dd> </dl>   <h2 id=\"protocol\">Protocol Handling</h2> <p>Historically, each filter is responsible for ensuring that whatever changes it makes are correctly represented in the HTTP response headers, and that it does not run when it would make an illegal change. This imposes a burden on filter authors to re-implement some common functionality in every filter:</p> <ul> <li>Many filters will change the content, invalidating existing content tags, checksums, hashes, and lengths.</li> <li>Filters that require an entire, unbroken response in input need to ensure they don't get byteranges from a backend.</li> <li>Filters that transform output in a filter need to ensure they don't violate a <code>Cache-Control: no-transform</code> header from the backend.</li> <li>Filters may make responses uncacheable.</li> </ul> <p><code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> aims to offer generic handling of these details of filter implementation, reducing the complexity required of content filter modules. This is work-in-progress; the <code class=\"directive\"><a href=\"#filterprotocol\">FilterProtocol</a></code> implements some of this functionality for back-compatibility with Apache 2.0 modules. For httpd 2.1 and later, the <code>ap_register_output_filter_protocol</code> and <code>ap_filter_protocol</code> API enables filter modules to declare their own behaviour.</p> <p>At the same time, <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> should not interfere with a filter that wants to handle all aspects of the protocol. By default (i.e. in the absence of any <code class=\"directive\"><a href=\"#filterprotocol\">FilterProtocol</a></code> directives), <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> will leave the headers untouched.</p> <p>At the time of writing, this feature is largely untested, as modules in common use are designed to work with 2.0. Modules using it should test it carefully.</p>   <div class=\"directive-section\">\n<h2 id=\"addoutputfilterbytype\">AddOutputFilterByType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>assigns an output filter to a particular media-type</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddOutputFilterByType filter[;filter...] media-type [media-type] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_filter</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Had severe limitations before being moved to <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> in version 2.3.7</td>\n</tr> </table> <p>This directive activates a particular output <a href=\"../filter\">filter</a> for a request depending on the response <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#media-type\" title=\"see glossary\">media-type</a>.</p> <p>The following example uses the <code>DEFLATE</code> filter, which is provided by <code class=\"module\"><a href=\"mod_deflate\">mod_deflate</a></code>. It will compress all output (either static or dynamic) which is labeled as <code>text/html</code> or <code>text/plain</code> before it is sent to the client.</p> <pre class=\"prettyprint lang-config\">AddOutputFilterByType DEFLATE text/html text/plain</pre> <p>If you want the content to be processed by more than one filter, their names have to be separated by semicolons. It's also possible to use one <code class=\"directive\">AddOutputFilterByType</code> directive for each of these filters.</p> <p>The configuration below causes all script output labeled as <code>text/html</code> to be processed at first by the <code>INCLUDES</code> filter and then by the <code>DEFLATE</code> filter.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/cgi-bin/\"&gt;\n    Options Includes\n    AddOutputFilterByType INCLUDES;DEFLATE text/html\n&lt;/Location&gt;</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_mime#addoutputfilter\">AddOutputFilter</a></code></li> <li><code class=\"directive\"><a href=\"core#setoutputfilter\">SetOutputFilter</a></code></li> <li><a href=\"../filter\">filters</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"filterchain\">FilterChain Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure the filter chain</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>FilterChain [+=-@!]filter-name ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_filter</td>\n</tr> </table> <p>This configures an actual filter chain, from declared filters. <code class=\"directive\">FilterChain</code> takes any number of arguments, each optionally preceded with a single-character control that determines what to do:</p> <dl> <dt><code>+filter-name</code></dt> <dd>Add <var>filter-name</var> to the end of the filter chain</dd> <dt><code>@filter-name</code></dt> <dd>Insert <var>filter-name</var> at the start of the filter chain</dd> <dt><code>-filter-name</code></dt> <dd>Remove <var>filter-name</var> from the filter chain</dd> <dt><code>=filter-name</code></dt> <dd>Empty the filter chain and insert <var>filter-name</var>\n</dd> <dt><code>!</code></dt> <dd>Empty the filter chain</dd> <dt><code>filter-name</code></dt> <dd>Equivalent to <code>+filter-name</code>\n</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"filterdeclare\">FilterDeclare Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Declare a smart filter</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>FilterDeclare filter-name [type]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_filter</td>\n</tr> </table> <p>This directive declares an output filter together with a header or environment variable that will determine runtime configuration. The first argument is a <var>filter-name</var> for use in <code class=\"directive\"><a href=\"#filterprovider\">FilterProvider</a></code>, <code class=\"directive\"><a href=\"#filterchain\">FilterChain</a></code> and <code class=\"directive\"><a href=\"#filterprotocol\">FilterProtocol</a></code> directives.</p> <p>The final (optional) argument is the type of filter, and takes values of <code>ap_filter_type</code> - namely <code>RESOURCE</code> (the default), <code>CONTENT_SET</code>, <code>PROTOCOL</code>, <code>TRANSCODE</code>, <code>CONNECTION</code> or <code>NETWORK</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"filterprotocol\">FilterProtocol Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Deal with correct HTTP protocol handling</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>FilterProtocol filter-name [provider-name] proto-flags</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_filter</td>\n</tr> </table> <p>This directs <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> to deal with ensuring the filter doesn't run when it shouldn't, and that the HTTP response headers are correctly set taking into account the effects of the filter.</p> <p>There are two forms of this directive. With three arguments, it applies specifically to a <var>filter-name</var> and a <var>provider-name</var> for that filter. With two arguments it applies to a <var>filter-name</var> whenever the filter runs <em>any</em> provider.</p> <p>Flags specified with this directive are merged with the flags that underlying providers may have registerd with <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code>. For example, a filter may internally specify the equivalent of <code>change=yes</code>, but a particular configuration of the module can override with <code>change=no</code>. </p> <p><var>proto-flags</var> is one or more of</p> <dl> <dt><code>change=yes|no</code></dt> <dd>Specifies whether the filter changes the content, including possibly the content length. The \"no\" argument is supported in 2.4.7 and later.</dd> <dt><code>change=1:1</code></dt> <dd>The filter changes the content, but will not change the content length</dd> <dt><code>byteranges=no</code></dt> <dd>The filter cannot work on byteranges and requires complete input</dd> <dt><code>proxy=no</code></dt> <dd>The filter should not run in a proxy context</dd> <dt><code>proxy=transform</code></dt> <dd>The filter transforms the response in a manner incompatible with the HTTP <code>Cache-Control: no-transform</code> header.</dd> <dt><code>cache=no</code></dt> <dd>The filter renders the output uncacheable (eg by introducing randomised content changes)</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"filterprovider\">FilterProvider Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Register a content filter</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>FilterProvider filter-name provider-name expression</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_filter</td>\n</tr> </table> <p>This directive registers a <em>provider</em> for the smart filter. The provider will be called if and only if the <var>expression</var> declared evaluates to true when the harness is first called.</p> <p> <var>provider-name</var> must have been registered by loading a module that registers the name with <code>ap_register_output_filter</code>. </p> <p><var>expression</var> is an <a href=\"../expr\">ap_expr</a>.</p> <h3>See also</h3> <ul> <li>\n<a href=\"../expr\">Expressions in Apache HTTP Server</a>, for a complete reference and examples.</li> <li><code class=\"module\"><a href=\"mod_include\">mod_include</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"filtertrace\">FilterTrace Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Get debug/diagnostic information from <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code>\n</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>FilterTrace filter-name level</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_filter</td>\n</tr> </table> <p>This directive generates debug information from <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code>. It is designed to help test and debug providers (filter modules), although it may also help with <code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> itself.</p> <p>The debug output depends on the <var>level</var> set:</p> <dl> <dt>\n<code>0</code> (default)</dt> <dd>No debug information is generated.</dd> <dt><code>1</code></dt> <dd>\n<code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code> will record buckets and brigades passing through the filter to the error log, before the provider has processed them. This is similar to the information generated by <a href=\"http://apache.webthing.com/mod_diagnostics/\">mod_diagnostics</a>. </dd> <dt>\n<code>2</code> (not yet implemented)</dt> <dd>Will dump the full data passing through to a tempfile before the provider. <strong>For single-user debug only</strong>; this will not support concurrent hits.</dd> </dl> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_filter.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_filter.html</a>\n  </p>\n</div>\n","mod/mod_headers":"<h1>Apache Module mod_headers</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Customization of HTTP request and response headers</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>headers_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_headers.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides directives to control and modify HTTP request and response headers. Headers can be merged, replaced or removed.</p>     <h2 id=\"order\">Order of Processing</h2> <p>The directives provided by <code class=\"module\"><a href=\"mod_headers\">mod_headers</a></code> can occur almost anywhere within the server configuration, and can be limited in scope by enclosing them in <a href=\"../sections\">configuration sections</a>.</p> <p>Order of processing is important and is affected both by the order in the configuration file and by placement in <a href=\"../sections#mergin\">configuration sections</a>. These two directives have a different effect if reversed:</p> <pre class=\"prettyprint lang-config\">RequestHeader append MirrorID \"mirror 12\"\nRequestHeader unset MirrorID</pre> <p>This way round, the <code>MirrorID</code> header is not set. If reversed, the MirrorID header is set to \"mirror 12\".</p>   <h2 id=\"early\">Early and Late Processing</h2> <p><code class=\"module\"><a href=\"mod_headers\">mod_headers</a></code> can be applied either early or late in the request. The normal mode is late, when <em>Request</em> Headers are set immediately before running the content generator and <em>Response</em> Headers just as the response is sent down the wire. Always use Late mode in an operational server.</p> <p>Early mode is designed as a test/debugging aid for developers. Directives defined using the <code>early</code> keyword are set right at the beginning of processing the request. This means they can be used to simulate different requests and set up test cases, but it also means that headers may be changed at any time by other modules before generating a Response.</p> <p>Because early directives are processed before the request path's configuration is traversed, early headers can only be set in a main server or virtual host context. Early directives cannot depend on a request path, so they will fail in contexts such as <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> or <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code>.</p>   <h2 id=\"examples\">Examples</h2> <ol> <li> Copy all request headers that begin with \"TS\" to the response headers: <pre class=\"prettyprint lang-config\">Header echo ^TS</pre> </li> <li> Add a header, <code>MyHeader</code>, to the response including a timestamp for when the request was received and how long it took to begin serving the request. This header can be used by the client to intuit load on the server or in isolating bottlenecks between the client and the server. <pre class=\"prettyprint lang-config\">Header set MyHeader \"%D %t\"</pre> <p>results in this header being added to the response:</p> <div class=\"example\"><pre>MyHeader: D=3775428 t=991424704447256</pre></div> </li> <li> Say hello to Joe <pre class=\"prettyprint lang-config\">Header set MyHeader \"Hello Joe. It took %D microseconds for Apache to serve this request.\"</pre> <p>results in this header being added to the response:</p> <div class=\"example\"><pre>MyHeader: Hello Joe. It took D=3775428 microseconds for Apache to serve this request.</pre></div> </li> <li> Conditionally send <code>MyHeader</code> on the response if and only if header <code>MyRequestHeader</code> is present on the request. This is useful for constructing headers in response to some client stimulus. Note that this example requires the services of the <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code> module. <pre class=\"prettyprint lang-config\">SetEnvIf MyRequestHeader myvalue HAVE_MyRequestHeader\nHeader set MyHeader \"%D %t mytext\" env=HAVE_MyRequestHeader</pre> <p>If the header <code>MyRequestHeader: myvalue</code> is present on the HTTP request, the response will contain the following header:</p> <div class=\"example\"><pre>MyHeader: D=3775428 t=991424704447256 mytext</pre></div> </li> <li> Enable DAV to work with Apache running HTTP through SSL hardware (<a href=\"http://svn.haxx.se/users/archive-2006-03/0549.shtml\">problem description</a>) by replacing <var>https:</var> with <var>http:</var> in the <var>Destination</var> header: <pre class=\"prettyprint lang-config\">RequestHeader edit Destination ^https: http: early</pre> </li> <li> Set the same header value under multiple nonexclusive conditions, but do not duplicate the value in the final header. If all of the following conditions applied to a request (i.e., if the <code>CGI</code>, <code>NO_CACHE</code> and <code>NO_STORE</code> environment variables all existed for the request): <pre class=\"prettyprint lang-config\">Header merge Cache-Control no-cache env=CGI\nHeader merge Cache-Control no-cache env=NO_CACHE\nHeader merge Cache-Control no-store env=NO_STORE</pre> <p>then the response would contain the following header:</p> <div class=\"example\"><pre>Cache-Control: no-cache, no-store</pre></div> <p>If <code>append</code> was used instead of <code>merge</code>, then the response would contain the following header:</p> <div class=\"example\"><pre>Cache-Control: no-cache, no-cache, no-store</pre></div> </li> <li> Set a test cookie if and only if the client didn't send us a cookie <pre class=\"prettyprint lang-config\">Header set Set-Cookie testcookie \"expr=-z %{req:Cookie}\"</pre> </li> <li> Append a Caching header for responses with a HTTP status code of 200 <pre class=\"prettyprint lang-config\">Header append Cache-Control s-maxage=600 \"expr=%{REQUEST_STATUS} == 200\"</pre> </li> </ol>   <div class=\"directive-section\">\n<h2 id=\"header\">Header Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure HTTP response headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Header [condition] add|append|echo|edit|edit*|merge|set|setifempty|unset|note header [[expr=]value [replacement] [early|env=[!]varname|expr=expression]]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_headers</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>SetIfEmpty available in 2.4.7 and later, expr=value available in 2.4.10 and later</td>\n</tr> </table> <p>This directive can replace, merge or remove HTTP response headers. The header is modified just after the content handler and output filters are run, allowing outgoing headers to be modified.</p> <p> The optional <var>condition</var> argument determines which internal table of responses headers this directive will operate against. Despite the name, the default value of <code>onsuccess</code> does <em>not</em> limit an <var>action</var> to responses with a 2xx status code. Headers set under this condition are still used when, for example, a request is <em>successfully</em> proxied or generated by CGI, even when they have generated a failing status code.</p> <p>When your action is a function of an existing header, you may need to specify a condition of <code>always</code>, depending on which internal table the original header was set in. The table that corresponds to <code>always</code> is used for locally generated error responses as well as successful responses. Note also that repeating this directive with both conditions makes sense in some scenarios because <code>always</code> is not a superset of <code>onsuccess</code> with respect to existing headers:</p> <ul> <li> You're adding a header to a locally generated non-success (non-2xx) response, such as a redirect, in which case only the table corresponding to <code>always</code> is used in the ultimate response.</li> <li> You're modifying or removing a header generated by a CGI script, in which case the CGI scripts are in the table corresponding to <code>always</code> and not in the default table.</li> <li> You're modifying or removing a header generated by some piece of the server but that header is not being found by the default <code>onsuccess</code> condition.</li> </ul> <p>Separately from the <var>condition</var> parameter described above, you can limit an action based on HTTP status codes for e.g. proxied or CGI requests. See the example that uses %{REQUEST_STATUS} in the section above.</p> <p>The action it performs is determined by the first argument (second argument if a <var>condition</var> is specified). This can be one of the following values:</p> <dl> <dt><code>add</code></dt> <dd>The response header is added to the existing set of headers, even if this header already exists. This can result in two (or more) headers having the same name. This can lead to unforeseen consequences, and in general <code>set</code>, <code>append</code> or <code>merge</code> should be used instead.</dd> <dt><code>append</code></dt> <dd>The response header is appended to any existing header of the same name. When a new value is merged onto an existing header it is separated from the existing header with a comma. This is the HTTP standard way of giving a header multiple values.</dd> <dt><code>echo</code></dt> <dd>Request headers with this name are echoed back in the response headers. <var>header</var> may be a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>. <var>value</var> must be omitted.</dd> <dt><code>edit</code></dt> <dt><code>edit*</code></dt> <dd>If this response header exists, its value is transformed according to a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> search-and-replace. The <var>value</var> argument is a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>, and the <var>replacement</var> is a replacement string, which may contain backreferences or format specifiers. The <code>edit</code> form will match and replace exactly once in a header value, whereas the <code>edit*</code> form will replace <em>every</em> instance of the search pattern if it appears more than once.</dd> <dt><code>merge</code></dt> <dd>The response header is appended to any existing header of the same name, unless the value to be appended already appears in the header's comma-delimited list of values. When a new value is merged onto an existing header it is separated from the existing header with a comma. This is the HTTP standard way of giving a header multiple values. Values are compared in a case sensitive manner, and after all format specifiers have been processed. Values in double quotes are considered different from otherwise identical unquoted values.</dd> <dt><code>set</code></dt> <dd>The response header is set, replacing any previous header with this name. The <var>value</var> may be a format string.</dd> <dt><code>setifempty</code></dt> <dd>The request header is set, but only if there is no previous header with this name.<br> Available in 2.4.7 and later.</dd> <dt><code>unset</code></dt> <dd>The response header of this name is removed, if it exists. If there are multiple headers of the same name, all will be removed. <var>value</var> must be omitted.</dd> <dt><code>note</code></dt> <dd>The value of the named response <var>header</var> is copied into an internal note whose name is given by <var>value</var>. This is useful if a header sent by a CGI or proxied resource is configured to be unset but should also be logged.<br> Available in 2.4.7 and later.</dd> </dl> <p>This argument is followed by a <var>header</var> name, which can include the final colon, but it is not required. Case is ignored for <code>set</code>, <code>append</code>, <code>merge</code>, <code>add</code>, <code>unset</code> and <code>edit</code>. The <var>header</var> name for <code>echo</code> is case sensitive and may be a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>.</p> <p>For <code>set</code>, <code>append</code>, <code>merge</code> and <code>add</code> a <var>value</var> is specified as the next argument. If <var>value</var> contains spaces, it should be surrounded by double quotes. <var>value</var> may be a character string, a string containing <code class=\"module\"><a href=\"mod_headers\">mod_headers</a></code> specific format specifiers (and character literals), or an <a href=\"../expr\">ap_expr</a> expression prefixed with <em>expr=</em></p> <p> The following format specifiers are supported in <var>value</var>:</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Format</th>\n<th>Description</th>\n</tr> <tr>\n<td><code>%%</code></td> <td>The percent sign</td>\n</tr> <tr class=\"odd\">\n<td><code>%t</code></td> <td>The time the request was received in Universal Coordinated Time since the epoch (Jan. 1, 1970) measured in microseconds. The value is preceded by <code>t=</code>.</td>\n</tr> <tr>\n<td><code>%D</code></td> <td>The time from when the request was received to the time the headers are sent on the wire. This is a measure of the duration of the request. The value is preceded by <code>D=</code>. The value is measured in microseconds.</td>\n</tr> <tr class=\"odd\">\n<td><code>%l</code></td> <td>The current load averages of the actual server itself. It is designed to expose the values obtained by <code>getloadavg()</code> and this represents the current load average, the 5 minute average, and the 15 minute average. The value is preceded by <code>l=</code> with each average separated by <code>/</code>.<br> Available in 2.4.4 and later. </td>\n</tr> <tr>\n<td><code>%i</code></td> <td>The current idle percentage of httpd (0 to 100) based on available processes and threads. The value is preceded by <code>i=</code>.<br> Available in 2.4.4 and later. </td>\n</tr> <tr class=\"odd\">\n<td><code>%b</code></td> <td>The current busy percentage of httpd (0 to 100) based on available processes and threads. The value is preceded by <code>b=</code>.<br> Available in 2.4.4 and later. </td>\n</tr> <tr>\n<td><code>%{VARNAME}e</code></td> <td>The contents of the <a href=\"../env\">environment variable</a> <code>VARNAME</code>.</td>\n</tr> <tr class=\"odd\">\n<td><code>%{VARNAME}s</code></td> <td>The contents of the <a href=\"mod_ssl#envvars\">SSL environment variable</a> <code>VARNAME</code>, if <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is enabled.</td>\n</tr> </table> <div class=\"note\">\n<p><strong>Note</strong></p> <p>The <code>%s</code> format specifier is only available in Apache 2.1 and later; it can be used instead of <code>%e</code> to avoid the overhead of enabling <code>SSLOptions +StdEnvVars</code>. If <code>SSLOptions +StdEnvVars</code> must be enabled anyway for some other reason, <code>%e</code> will be more efficient than <code>%s</code>.</p> </div> <div class=\"note\">\n<p><strong>Note on expression values</strong></p> <p> When the value parameter uses the <a href=\"../expr\">ap_expr</a> parser, some expression syntax will differ from examples that evaluate <em>boolean</em> expressions such as &lt;If&gt;:</p> <ul> <li>The starting point of the grammar is 'string' rather than 'expr'.</li> <li>Function calls use the %{funcname:arg} syntax rather than funcname(arg).</li> <li>Multi-argument functions are not currently accessible from this starting point</li> <li>Quote the entire parameter, such as <pre class=\"prettyprint lang-config\">Header set foo-checksum \"expr=%{md5:foo}\"</pre> </li> </ul> </div> <p>For <code>edit</code> there is both a <var>value</var> argument which is a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>, and an additional <var>replacement</var> string. As of version 2.4.7 the replacement string may also contain format specifiers.</p> <p>The <code class=\"directive\">Header</code> directive may be followed by an additional argument, which may be any of:</p> <dl> <dt><code>early</code></dt> <dd>Specifies <a href=\"#early\">early processing</a>.</dd> <dt><code>env=[!]varname</code></dt> <dd>The directive is applied if and only if the <a href=\"../env\">environment variable</a> <code>varname</code> exists. A <code>!</code> in front of <code>varname</code> reverses the test, so the directive applies only if <code>varname</code> is unset.</dd> <dt><code>expr=expression</code></dt> <dd>The directive is applied if and only if <var>expression</var> evaluates to true. Details of expression syntax and evaluation are documented in the <a href=\"../expr\">ap_expr</a> documentation. <pre class=\"prettyprint lang-config\"># This delays the evaluation of the condition clause compared to &lt;If&gt;\nHeader always set CustomHeader my-value \"expr=%{REQUEST_URI} =~ m#^/special_path.php$#\"</pre> </dd> </dl> <p>Except in <a href=\"#early\">early</a> mode, the <code class=\"directive\">Header</code> directives are processed just before the response is sent to the network. This means that it is possible to set and/or override most headers, except for some headers added by the HTTP header filter. Prior to 2.2.12, it was not possible to change the Content-Type header with this directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"requestheader\">RequestHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configure HTTP request headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RequestHeader add|append|edit|edit*|merge|set|setifempty|unset header [[expr=]value [replacement] [early|env=[!]varname|expr=expression]]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_headers</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>SetIfEmpty available in 2.4.7 and later, expr=value available in 2.4.10 and later</td>\n</tr> </table> <p>This directive can replace, merge, change or remove HTTP request headers. The header is modified just before the content handler is run, allowing incoming headers to be modified. The action it performs is determined by the first argument. This can be one of the following values:</p> <dl> <dt><code>add</code></dt> <dd>The request header is added to the existing set of headers, even if this header already exists. This can result in two (or more) headers having the same name. This can lead to unforeseen consequences, and in general <code>set</code>, <code>append</code> or <code>merge</code> should be used instead.</dd> <dt><code>append</code></dt> <dd>The request header is appended to any existing header of the same name. When a new value is merged onto an existing header it is separated from the existing header with a comma. This is the HTTP standard way of giving a header multiple values.</dd> <dt><code>edit</code></dt> <dt><code>edit*</code></dt> <dd>If this request header exists, its value is transformed according to a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> search-and-replace. The <var>value</var> argument is a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>, and the <var>replacement</var> is a replacement string, which may contain backreferences or format specifiers. The <code>edit</code> form will match and replace exactly once in a header value, whereas the <code>edit*</code> form will replace <em>every</em> instance of the search pattern if it appears more than once.</dd> <dt><code>merge</code></dt> <dd>The request header is appended to any existing header of the same name, unless the value to be appended already appears in the existing header's comma-delimited list of values. When a new value is merged onto an existing header it is separated from the existing header with a comma. This is the HTTP standard way of giving a header multiple values. Values are compared in a case sensitive manner, and after all format specifiers have been processed. Values in double quotes are considered different from otherwise identical unquoted values.</dd> <dt><code>set</code></dt> <dd>The request header is set, replacing any previous header with this name</dd> <dt><code>setifempty</code></dt> <dd>The request header is set, but only if there is no previous header with this name.<br> Available in 2.4.7 and later.</dd> <dt><code>unset</code></dt> <dd>The request header of this name is removed, if it exists. If there are multiple headers of the same name, all will be removed. <var>value</var> must be omitted.</dd> </dl> <p>This argument is followed by a header name, which can include the final colon, but it is not required. Case is ignored. For <code>set</code>, <code>append</code>, <code>merge</code> and <code>add</code> a <var>value</var> is given as the third argument. If a <var>value</var> contains spaces, it should be surrounded by double quotes. For <code>unset</code>, no <var>value</var> should be given. <var>value</var> may be a character string, a string containing format specifiers or a combination of both. The supported format specifiers are the same as for the <code class=\"directive\"><a href=\"#header\">Header</a></code>, please have a look there for details. For <code>edit</code> both a <var>value</var> and a <var>replacement</var> are required, and are a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> and a replacement string respectively.</p> <p>The <code class=\"directive\">RequestHeader</code> directive may be followed by an additional argument, which may be any of:</p> <dl> <dt><code>early</code></dt> <dd>Specifies <a href=\"#early\">early processing</a>.</dd> <dt><code>env=[!]varname</code></dt> <dd>The directive is applied if and only if the <a href=\"../env\">environment variable</a> <code>varname</code> exists. A <code>!</code> in front of <code>varname</code> reverses the test, so the directive applies only if <code>varname</code> is unset.</dd> <dt><code>expr=expression</code></dt> <dd>The directive is applied if and only if <var>expression</var> evaluates to true. Details of expression syntax and evaluation are documented in the <a href=\"../expr\">ap_expr</a> documentation.</dd> </dl> <p>Except in <a href=\"#early\">early</a> mode, the <code class=\"directive\">RequestHeader</code> directive is processed just before the request is run by its handler in the fixup phase. This should allow headers generated by the browser, or by Apache input filters to be overridden or modified.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_headers.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_headers.html</a>\n  </p>\n</div>\n","mod/mod_heartbeat":"<h1>Apache Module mod_heartbeat</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Sends messages with server status to frontend proxy</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>heartbeat_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_heartbeat</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p> <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code> sends multicast messages to a <code class=\"module\"><a href=\"mod_heartmonitor\">mod_heartmonitor</a></code> listener that advertises the servers current connection count. Usually, <code class=\"module\"><a href=\"mod_heartmonitor\">mod_heartmonitor</a></code> will be running on a proxy server with <code class=\"module\"><a href=\"mod_lbmethod_heartbeat\">mod_lbmethod_heartbeat</a></code> loaded, which allows <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> to use the \"heartbeat\" <em>lbmethod</em> inside of <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code>.</p> <p> <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code> itself is loaded on the origin server(s) that serve requests through the proxy server(s). </p> <div class=\"warning\"> To use <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code>, <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> and <code class=\"module\"><a href=\"mod_watchdog\">mod_watchdog</a></code> must be either a static modules or, if a dynamic module, must be loaded before <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code>. </div>     <h2 id=\"consuming\">Consuming mod_heartbeat Output</h2> <p> Every 1 second, this module generates a single multicast UDP packet, containing the number of busy and idle workers. The packet is a simple ASCII format, similar to GET query parameters in HTTP. </p> <div class=\"example\">\n<h3>An Example Packet</h3>\n<code>v=1&amp;ready=75&amp;busy=0</code>\n</div> <p> Consumers should handle new variables besides busy and ready, separated by '&amp;', being added in the future. </p>   <div class=\"directive-section\">\n<h2 id=\"heartbeataddress\">HeartbeatAddress Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Multicast address for heartbeat packets</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>HeartbeatAddress addr:port</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>disabled</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_heartbeat</td>\n</tr> </table> <p>The <code class=\"directive\">HeartbeatAddress</code> directive specifies the multicast address to which <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code> will send status information. This address will usually correspond to a configured <code class=\"directive\"><a href=\"mod_heartmonitor#heartbeatlisten\">HeartbeatListen</a></code> on a frontend proxy system.</p> <pre class=\"prettyprint lang-config\">HeartbeatAddress 239.0.0.1:27999</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_heartbeat.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_heartbeat.html</a>\n  </p>\n</div>\n","mod/mod_heartmonitor":"<h1>Apache Module mod_heartmonitor</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Centralized monitor for mod_heartbeat origin servers</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>heartmonitor_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_heartmonitor.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p> <code class=\"module\"><a href=\"mod_heartmonitor\">mod_heartmonitor</a></code> listens for server status messages generated by <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code> enabled origin servers and makes their status available to <code class=\"module\"><a href=\"mod_lbmethod_heartbeat\">mod_lbmethod_heartbeat</a></code>. This allows <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> to use the \"heartbeat\" <em>lbmethod</em> inside of <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code>. </p> <p>This module uses the services of <code class=\"module\"><a href=\"mod_slotmem_shm\">mod_slotmem_shm</a></code> when available instead of flat-file storage. No configuration is required to use <code class=\"module\"><a href=\"mod_slotmem_shm\">mod_slotmem_shm</a></code>.</p> <div class=\"warning\"> To use <code class=\"module\"><a href=\"mod_heartmonitor\">mod_heartmonitor</a></code>, <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> and <code class=\"module\"><a href=\"mod_watchdog\">mod_watchdog</a></code> must be either a static modules or, if a dynamic module, it must be loaded before <code class=\"module\"><a href=\"mod_heartmonitor\">mod_heartmonitor</a></code>. </div>    <div class=\"directive-section\">\n<h2 id=\"heartbeatlisten\">HeartbeatListen Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>multicast address to listen for incoming heartbeat requests </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><code>HeartbeatListenaddr:port</code></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>disabled</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_heartmonitor</td>\n</tr> </table> <p>The <code class=\"directive\">HeartbeatListen</code> directive specifies the multicast address on which the server will listen for status information from <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code>-enabled servers. This address will usually correspond to a configured <code class=\"directive\"><a href=\"mod_heartbeat#heartbeataddress\">HeartbeatAddress</a></code> on an origin server. </p> <pre class=\"prettyprint lang-config\">HeartbeatListen 239.0.0.1:27999</pre> <p> This module is inactive until this directive is used.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"heartbeatmaxservers\">HeartbeatMaxServers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specifies the maximum number of servers that will be sending heartbeat requests to this server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>HeartbeatMaxServers number-of-servers</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>HeartbeatMaxServers 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_heartmonitor</td>\n</tr> </table> <p>The <code class=\"directive\">HeartbeatMaxServers</code> directive specifies the maximum number of servers that will be sending requests to this monitor server. It is used to control the size of the shared memory allocated to store the heartbeat info when <code class=\"module\"><a href=\"mod_slotmem_shm\">mod_slotmem_shm</a></code> is in use.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"heartbeatstorage\">HeartbeatStorage Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Path to store heartbeat data</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>HeartbeatStorage file-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>HeartbeatStorage logs/hb.dat</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_heartmonitor</td>\n</tr> </table> <p>The <code class=\"directive\">HeartbeatStorage</code> directive specifies the path to store heartbeat data. This flat-file is used only when <code class=\"module\"><a href=\"mod_slotmem_shm\">mod_slotmem_shm</a></code> is not loaded.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_heartmonitor.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_heartmonitor.html</a>\n  </p>\n</div>\n","mod/mod_ident":"<h1>Apache Module mod_ident</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>RFC 1413 ident lookups</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>ident_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_ident.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module queries an <a href=\"http://www.ietf.org/rfc/rfc1413.txt\">RFC 1413</a> compatible daemon on a remote host to look up the owner of a connection.</p>    <div class=\"directive-section\">\n<h2 id=\"identitycheck\">IdentityCheck Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables logging of the RFC 1413 identity of the remote user</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IdentityCheck On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>IdentityCheck Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ident</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Moved out of core in Apache 2.1</td>\n</tr> </table> <p>This directive enables <a href=\"http://www.ietf.org/rfc/rfc1413.txt\">RFC 1413</a>-compliant logging of the remote user name for each connection, where the client machine runs identd or something similar. This information is logged in the access log using the <code>%...l</code> <a href=\"mod_log_config#formats\">format string</a>.</p> <div class=\"note\"> The information should not be trusted in any way except for rudimentary usage tracking. </div> <p>Note that this can cause serious latency problems accessing your server since every request requires one of these lookups to be performed. When firewalls or proxy servers are involved, each lookup might possibly fail and add a latency duration as defined by the <code class=\"directive\"><a href=\"#identitychecktimeout\">IdentityCheckTimeout</a></code> directive to each hit. So in general this is not very useful on public servers accessible from the Internet.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"identitychecktimeout\">IdentityCheckTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines the timeout duration for ident requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IdentityCheckTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>IdentityCheckTimeout 30</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_ident</td>\n</tr> </table> <p>This directive specifies the timeout duration of an ident request. The default value of 30 seconds is recommended by <a href=\"http://www.ietf.org/rfc/rfc1413.txt\">RFC 1413</a>, mainly because of possible network latency. However, you may want to adjust the timeout value according to your local network speed.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_ident.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_ident.html</a>\n  </p>\n</div>\n","mod/core":"<h1>Apache Core Features</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Core Apache HTTP Server features that are always available</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr>\n</table>    <div class=\"directive-section\">\n<h2 id=\"acceptfilter\">AcceptFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures optimizations for a Protocol's Listener Sockets</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AcceptFilter protocol accept_filter</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive enables operating system specific optimizations for a listening socket by the <code class=\"directive\">Protocol</code> type. The basic premise is for the kernel to not send a socket to the server process until either data is received or an entire HTTP Request is buffered. Only <a href=\"http://www.freebsd.org/cgi/man.cgi?query=accept_filter&amp;sektion=9\"> FreeBSD's Accept Filters</a>, Linux's more primitive <code>TCP_DEFER_ACCEPT</code>, and Windows' optimized AcceptEx() are currently supported.</p> <p>Using <code>none</code> for an argument will disable any accept filters for that protocol. This is useful for protocols that require a server send data first, such as <code>ftp:</code> or <code>nntp</code>:</p> <pre class=\"prettyprint lang-config\">AcceptFilter nntp none</pre> <p>The default protocol names are <code>https</code> for port 443 and <code>http</code> for all other ports. To specify that another protocol is being used with a listening port, add the <var>protocol</var> argument to the <code class=\"directive\"><a href=\"mpm_common#listen\">Listen</a></code> directive.</p> <p>The default values on FreeBSD are:</p> <pre class=\"prettyprint lang-config\">AcceptFilter http httpready\nAcceptFilter https dataready</pre> <p>The <code>httpready</code> accept filter buffers entire HTTP requests at the kernel level. Once an entire request is received, the kernel then sends it to the server. See the <a href=\"http://www.freebsd.org/cgi/man.cgi?query=accf_http&amp;sektion=9\"> accf_http(9)</a> man page for more details. Since HTTPS requests are encrypted, only the <a href=\"http://www.freebsd.org/cgi/man.cgi?query=accf_data&amp;sektion=9\"> accf_data(9)</a> filter is used.</p> <p>The default values on Linux are:</p> <pre class=\"prettyprint lang-config\">AcceptFilter http data\nAcceptFilter https data</pre> <p>Linux's <code>TCP_DEFER_ACCEPT</code> does not support buffering http requests. Any value besides <code>none</code> will enable <code>TCP_DEFER_ACCEPT</code> on that listener. For more details see the Linux <a href=\"http://homepages.cwi.nl/~aeb/linux/man2html/man7/tcp.7.html\"> tcp(7)</a> man page.</p> <p>The default values on Windows are:</p> <pre class=\"prettyprint lang-config\">AcceptFilter http data\nAcceptFilter https data</pre> <p>Window's mpm_winnt interprets the AcceptFilter to toggle the AcceptEx() API, and does not support http protocol buffering. There are two values which utilize the Windows AcceptEx() API and will recycle network sockets between connections. <code>data</code> waits until data has been transmitted as documented above, and the initial data buffer and network endpoint addresses are all retrieved from the single AcceptEx() invocation. <code>connect</code> will use the AcceptEx() API, also retrieve the network endpoint addresses, but like <code>none</code> the <code>connect</code> option does not wait for the initial data transmission.</p> <p>On Windows, <code>none</code> uses accept() rather than AcceptEx() and will not recycle sockets between connections. This is useful for network adapters with broken driver support, as well as some virtual network providers such as vpn drivers, or spam, virus or spyware filters.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#protocol\">Protocol</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"acceptpathinfo\">AcceptPathInfo Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Resources accept trailing pathname information</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AcceptPathInfo On|Off|Default</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AcceptPathInfo Default</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive controls whether requests that contain trailing pathname information that follows an actual filename (or non-existent file in an existing directory) will be accepted or rejected. The trailing pathname information can be made available to scripts in the <code>PATH_INFO</code> environment variable.</p> <p>For example, assume the location <code>/test/</code> points to a directory that contains only the single file <code>here.html</code>. Then requests for <code>/test/here.html/more</code> and <code>/test/nothere.html/more</code> both collect <code>/more</code> as <code>PATH_INFO</code>.</p> <p>The three possible arguments for the <code class=\"directive\">AcceptPathInfo</code> directive are:</p> <dl> <dt><code>Off</code></dt>\n<dd>A request will only be accepted if it maps to a literal path that exists. Therefore a request with trailing pathname information after the true filename such as <code>/test/here.html/more</code> in the above example will return a 404 NOT FOUND error.</dd> <dt><code>On</code></dt>\n<dd>A request will be accepted if a leading path component maps to a file that exists. The above example <code>/test/here.html/more</code> will be accepted if <code>/test/here.html</code> maps to a valid file.</dd> <dt><code>Default</code></dt>\n<dd>The treatment of requests with trailing pathname information is determined by the <a href=\"../handler\">handler</a> responsible for the request. The core handler for normal files defaults to rejecting <code>PATH_INFO</code> requests. Handlers that serve scripts, such as <a href=\"mod_cgi\">cgi-script</a> and <a href=\"mod_isapi\">isapi-handler</a>, generally accept <code>PATH_INFO</code> by default.</dd> </dl> <p>The primary purpose of the <code>AcceptPathInfo</code> directive is to allow you to override the handler's choice of accepting or rejecting <code>PATH_INFO</code>. This override is required, for example, when you use a <a href=\"../filter\">filter</a>, such as <a href=\"mod_include\">INCLUDES</a>, to generate content based on <code>PATH_INFO</code>. The core handler would usually reject the request, so you can use the following configuration to enable such a script:</p> <pre class=\"prettyprint lang-config\">&lt;Files \"mypaths.shtml\"&gt;\n  Options +Includes\n  SetOutputFilter INCLUDES\n  AcceptPathInfo On\n&lt;/Files&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"accessfilename\">AccessFileName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name of the distributed configuration file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AccessFileName filename [filename] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AccessFileName .htaccess</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>While processing a request, the server looks for the first existing configuration file from this list of names in every directory of the path to the document, if distributed configuration files are <a href=\"#allowoverride\">enabled for that directory</a>. For example:</p> <pre class=\"prettyprint lang-config\">AccessFileName .acl</pre> <p>Before returning the document <code>/usr/local/web/index.html</code>, the server will read <code>/.acl</code>, <code>/usr/.acl</code>, <code>/usr/local/.acl</code> and <code>/usr/local/web/.acl</code> for directives unless they have been disabled with:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/\"&gt;\n    AllowOverride None\n&lt;/Directory&gt;</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#allowoverride\">AllowOverride</a></code></li> <li><a href=\"../configuring\">Configuration Files</a></li> <li><a href=\"../howto/htaccess\">.htaccess Files</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"adddefaultcharset\">AddDefaultCharset Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Default charset parameter to be added when a response content-type is <code>text/plain</code> or <code>text/html</code>\n</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AddDefaultCharset On|Off|charset</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AddDefaultCharset Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive specifies a default value for the media type charset parameter (the name of a character encoding) to be added to a response if and only if the response's content-type is either <code>text/plain</code> or <code>text/html</code>. This should override any charset specified in the body of the response via a <code>META</code> element, though the exact behavior is often dependent on the user's client configuration. A setting of <code>AddDefaultCharset Off</code> disables this functionality. <code>AddDefaultCharset On</code> enables a default charset of <code>iso-8859-1</code>. Any other value is assumed to be the <var>charset</var> to be used, which should be one of the <a href=\"http://www.iana.org/assignments/character-sets\">IANA registered charset values</a> for use in Internet media types (MIME types). For example:</p> <pre class=\"prettyprint lang-config\">AddDefaultCharset utf-8</pre> <p><code class=\"directive\">AddDefaultCharset</code> should only be used when all of the text resources to which it applies are known to be in that character encoding and it is too inconvenient to label their charset individually. One such example is to add the charset parameter to resources containing generated content, such as legacy CGI scripts, that might be vulnerable to cross-site scripting attacks due to user-provided data being included in the output. Note, however, that a better solution is to just fix (or delete) those scripts, since setting a default charset does not protect users that have enabled the \"auto-detect character encoding\" feature on their browser.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_mime#addcharset\">AddCharset</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"allowencodedslashes\">AllowEncodedSlashes Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether encoded path separators in URLs are allowed to be passed through</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AllowEncodedSlashes On|Off|NoDecode</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AllowEncodedSlashes Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td> NoDecode option available in 2.3.12 and later.</td>\n</tr> </table> <p>The <code class=\"directive\">AllowEncodedSlashes</code> directive allows URLs which contain encoded path separators (<code>%2F</code> for <code>/</code> and additionally <code>%5C</code> for <code>\\</code> on accordant systems) to be used in the path info.</p> <p>With the default value, <code>Off</code>, such URLs are refused with a 404 (Not found) error.</p> <p>With the value <code>On</code>, such URLs are accepted, and encoded slashes are decoded like all other encoded characters.</p> <p>With the value <code>NoDecode</code>, such URLs are accepted, but encoded slashes are not decoded but left in their encoded state.</p> <p>Turning <code class=\"directive\">AllowEncodedSlashes</code> <code>On</code> is mostly useful when used in conjunction with <code>PATH_INFO</code>.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>If encoded slashes are needed in path info, use of <code>NoDecode</code> is strongly recommended as a security measure. Allowing slashes to be decoded could potentially allow unsafe paths.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#acceptpathinfo\">AcceptPathInfo</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"allowoverride\">AllowOverride Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Types of directives that are allowed in <code>.htaccess</code> files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AllowOverride All|None|directive-type [directive-type] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AllowOverride None (2.3.9 and later), AllowOverride All (2.3.8 and earlier)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>When the server finds an <code>.htaccess</code> file (as specified by <code class=\"directive\"><a href=\"#accessfilename\">AccessFileName</a></code>), it needs to know which directives declared in that file can override earlier configuration directives.</p> <div class=\"note\">\n<p><strong>Only available in &lt;Directory&gt; sections</strong></p> <code class=\"directive\">AllowOverride</code> is valid only in <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections specified without regular expressions, not in <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code>, <code class=\"directive\"><a href=\"#directorymatch\">&lt;DirectoryMatch&gt;</a></code> or <code class=\"directive\"><a href=\"#files\">&lt;Files&gt;</a></code> sections. </div> <p>When this directive is set to <code>None</code> and <code class=\"directive\"><a href=\"#allowoverridelist\">AllowOverrideList</a></code> is set to <code>None</code>, <a href=\"#accessfilename\">.htaccess</a> files are completely ignored. In this case, the server will not even attempt to read <code>.htaccess</code> files in the filesystem.</p> <p>When this directive is set to <code>All</code>, then any directive which has the .htaccess Context is allowed in <code>.htaccess</code> files.</p> <p>The <var>directive-type</var> can be one of the following groupings of directives.</p> <dl> <dt>AuthConfig</dt> <dd> Allow use of the authorization directives (<code class=\"directive\"><a href=\"mod_authz_dbm#authdbmgroupfile\">AuthDBMGroupFile</a></code>, <code class=\"directive\"><a href=\"mod_authn_dbm#authdbmuserfile\">AuthDBMUserFile</a></code>, <code class=\"directive\"><a href=\"mod_authz_groupfile#authgroupfile\">AuthGroupFile</a></code>, <code class=\"directive\"><a href=\"mod_authn_core#authname\">AuthName</a></code>, <code class=\"directive\"><a href=\"mod_authn_core#authtype\">AuthType</a></code>, <code class=\"directive\"><a href=\"mod_authn_file#authuserfile\">AuthUserFile</a></code>, <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code>, <em>etc.</em>).</dd> <dt>FileInfo</dt> <dd> Allow use of the directives controlling document types (<code class=\"directive\"><a href=\"#errordocument\">ErrorDocument</a></code>, <code class=\"directive\"><a href=\"#forcetype\">ForceType</a></code>, <code class=\"directive\"><a href=\"mod_negotiation#languagepriority\">LanguagePriority</a></code>, <code class=\"directive\"><a href=\"#sethandler\">SetHandler</a></code>, <code class=\"directive\"><a href=\"#setinputfilter\">SetInputFilter</a></code>, <code class=\"directive\"><a href=\"#setoutputfilter\">SetOutputFilter</a></code>, and <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> Add* and Remove* directives), document meta data (<code class=\"directive\"><a href=\"mod_headers#header\">Header</a></code>, <code class=\"directive\"><a href=\"mod_headers#requestheader\">RequestHeader</a></code>, <code class=\"directive\"><a href=\"mod_setenvif#setenvif\">SetEnvIf</a></code>, <code class=\"directive\"><a href=\"mod_setenvif#setenvifnocase\">SetEnvIfNoCase</a></code>, <code class=\"directive\"><a href=\"mod_setenvif#browsermatch\">BrowserMatch</a></code>, <code class=\"directive\"><a href=\"mod_usertrack#cookieexpires\">CookieExpires</a></code>, <code class=\"directive\"><a href=\"mod_usertrack#cookiedomain\">CookieDomain</a></code>, <code class=\"directive\"><a href=\"mod_usertrack#cookiestyle\">CookieStyle</a></code>, <code class=\"directive\"><a href=\"mod_usertrack#cookietracking\">CookieTracking</a></code>, <code class=\"directive\"><a href=\"mod_usertrack#cookiename\">CookieName</a></code>), <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> directives (<code class=\"directive\"><a href=\"mod_rewrite#rewriteengine\">RewriteEngine</a></code>, <code class=\"directive\"><a href=\"mod_rewrite#rewriteoptions\">RewriteOptions</a></code>, <code class=\"directive\"><a href=\"mod_rewrite#rewritebase\">RewriteBase</a></code>, <code class=\"directive\"><a href=\"mod_rewrite#rewritecond\">RewriteCond</a></code>, <code class=\"directive\"><a href=\"mod_rewrite#rewriterule\">RewriteRule</a></code>), <code class=\"module\"><a href=\"mod_alias\">mod_alias</a></code> directives (<code class=\"directive\"><a href=\"mod_alias#redirect\">Redirect</a></code>, <code class=\"directive\"><a href=\"mod_alias#redirecttemp\">RedirectTemp</a></code>, <code class=\"directive\"><a href=\"mod_alias#redirectpermanent\">RedirectPermanent</a></code>, <code class=\"directive\"><a href=\"mod_alias#redirectmatch\">RedirectMatch</a></code>), and <code class=\"directive\"><a href=\"mod_actions#action\">Action</a></code> from <code class=\"module\"><a href=\"mod_actions\">mod_actions</a></code>. </dd> <dt>Indexes</dt> <dd> Allow use of the directives controlling directory indexing (<code class=\"directive\"><a href=\"mod_autoindex#adddescription\">AddDescription</a></code>, <code class=\"directive\"><a href=\"mod_autoindex#addicon\">AddIcon</a></code>, <code class=\"directive\"><a href=\"mod_autoindex#addiconbyencoding\">AddIconByEncoding</a></code>, <code class=\"directive\"><a href=\"mod_autoindex#addiconbytype\">AddIconByType</a></code>, <code class=\"directive\"><a href=\"mod_autoindex#defaulticon\">DefaultIcon</a></code>, <code class=\"directive\"><a href=\"mod_dir#directoryindex\">DirectoryIndex</a></code>, <a href=\"mod_autoindex#indexoptions.fancyindexing\"><code>FancyIndexing</code></a>, <code class=\"directive\"><a href=\"mod_autoindex#headername\">HeaderName</a></code>, <code class=\"directive\"><a href=\"mod_autoindex#indexignore\">IndexIgnore</a></code>, <code class=\"directive\"><a href=\"mod_autoindex#indexoptions\">IndexOptions</a></code>, <code class=\"directive\"><a href=\"mod_autoindex#readmename\">ReadmeName</a></code>, <em>etc.</em>).</dd> <dt>Limit</dt> <dd> Allow use of the directives controlling host access (<code class=\"directive\"><a href=\"mod_access_compat#allow\">Allow</a></code>, <code class=\"directive\"><a href=\"mod_access_compat#deny\">Deny</a></code> and <code class=\"directive\"><a href=\"mod_access_compat#order\">Order</a></code>).</dd> <dt>Nonfatal=[Override|Unknown|All]</dt> <dd> Allow use of AllowOverride option to treat syntax errors in .htaccess as nonfatal. Instead of causing an Internal Server Error, disallowed or unrecognised directives will be ignored and a warning logged: <ul> <li>\n<strong>Nonfatal=Override</strong> treats directives forbidden by AllowOverride as nonfatal.</li> <li>\n<strong>Nonfatal=Unknown</strong> treats unknown directives as nonfatal. This covers typos and directives implemented by a module that's not present.</li> <li>\n<strong>Nonfatal=All</strong> treats both the above as nonfatal.</li> </ul> <p>Note that a syntax error in a valid directive will still cause an internal server error.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> Nonfatal errors may have security implications for .htaccess users. For example, if AllowOverride disallows AuthConfig, users' configuration designed to restrict access to a site will be disabled. </div> </dd> <dt>Options[=<var>Option</var>,...]</dt> <dd> Allow use of the directives controlling specific directory features (<code class=\"directive\"><a href=\"#options\">Options</a></code> and <code class=\"directive\"><a href=\"mod_include#xbithack\">XBitHack</a></code>). An equal sign may be given followed by a comma-separated list, without spaces, of options that may be set using the <code class=\"directive\"><a href=\"#options\">Options</a></code> command. <div class=\"note\">\n<p><strong>Implicit disabling of Options</strong></p> <p>Even though the list of options that may be used in .htaccess files can be limited with this directive, as long as any <code class=\"directive\"><a href=\"#options\">Options</a></code> directive is allowed any other inherited option can be disabled by using the non-relative syntax. In other words, this mechanism cannot force a specific option to remain <em>set</em> while allowing any others to be set. </p>\n</div> <div class=\"example\"><pre>AllowOverride Options=Indexes,MultiViews</pre></div> </dd> </dl> <p>Example:</p> <pre class=\"prettyprint lang-config\">AllowOverride AuthConfig Indexes</pre> <p>In the example above, all directives that are neither in the group <code>AuthConfig</code> nor <code>Indexes</code> cause an internal server error.</p> <div class=\"note\">\n<p>For security and performance reasons, do not set <code>AllowOverride</code> to anything other than <code>None</code> in your <code>&lt;Directory \"/\"&gt;</code> block. Instead, find (or create) the <code>&lt;Directory&gt;</code> block that refers to the directory where you're actually planning to place a <code>.htaccess</code> file.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#accessfilename\">AccessFileName</a></code></li> <li><code class=\"directive\"><a href=\"#allowoverridelist\">AllowOverrideList</a></code></li> <li><a href=\"../configuring\">Configuration Files</a></li> <li><a href=\"../howto/htaccess\">.htaccess Files</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"allowoverridelist\">AllowOverrideList Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Individual directives that are allowed in <code>.htaccess</code> files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AllowOverrideList None|directive [directive-type] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AllowOverrideList None</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>When the server finds an <code>.htaccess</code> file (as specified by <code class=\"directive\"><a href=\"#accessfilename\">AccessFileName</a></code>), it needs to know which directives declared in that file can override earlier configuration directives.</p> <div class=\"note\">\n<p><strong>Only available in &lt;Directory&gt; sections</strong></p> <code class=\"directive\">AllowOverrideList</code> is valid only in <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections specified without regular expressions, not in <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code>, <code class=\"directive\"><a href=\"#directorymatch\">&lt;DirectoryMatch&gt;</a></code> or <code class=\"directive\"><a href=\"#files\">&lt;Files&gt;</a></code> sections. </div> <p>When this directive is set to <code>None</code> and <code class=\"directive\"><a href=\"#allowoverride\">AllowOverride</a></code> is set to <code>None</code>, then <a href=\"#accessfilename\">.htaccess</a> files are completely ignored. In this case, the server will not even attempt to read <code>.htaccess</code> files in the filesystem.</p> <p>Example:</p> <pre class=\"prettyprint lang-config\">AllowOverride None\nAllowOverrideList Redirect RedirectMatch</pre> <p>In the example above, only the <code>Redirect</code> and <code>RedirectMatch</code> directives are allowed. All others will cause an internal server error.</p> <p>Example:</p> <pre class=\"prettyprint lang-config\">AllowOverride AuthConfig\nAllowOverrideList CookieTracking CookieName</pre> <p>In the example above, <code class=\"directive\"><a href=\"#allowoverride\">AllowOverride </a></code> grants permission to the <code>AuthConfig</code> directive grouping and <code class=\"directive\">AllowOverrideList</code> grants permission to only two directives from the <code>FileInfo</code> directive grouping. All others will cause an internal server error.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#accessfilename\">AccessFileName</a></code></li> <li><code class=\"directive\"><a href=\"#allowoverride\">AllowOverride</a></code></li> <li><a href=\"../configuring\">Configuration Files</a></li> <li><a href=\"../howto/htaccess\">.htaccess Files</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"cgimapextension\">CGIMapExtension Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Technique for locating the interpreter for CGI scripts</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CGIMapExtension cgi-path .extension</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>NetWare only</td>\n</tr> </table> <p>This directive is used to control how Apache httpd finds the interpreter used to run CGI scripts. For example, setting <code>CGIMapExtension sys:\\foo.nlm .foo</code> will cause all CGI script files with a <code>.foo</code> extension to be passed to the FOO interpreter.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"cgipassauth\">CGIPassAuth Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables passing HTTP authorization headers to scripts as CGI variables</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CGIPassAuth On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CGIPassAuth Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.4.13 and later</td>\n</tr> </table> <p><code class=\"directive\">CGIPassAuth</code> allows scripts access to HTTP authorization headers such as <code>Authorization</code>, which is required for scripts that implement HTTP Basic authentication. Normally these HTTP headers are hidden from scripts. This is to disallow scripts from seeing user ids and passwords used to access the server when HTTP Basic authentication is enabled in the web server. This directive should be used when scripts are allowed to implement HTTP Basic authentication.</p> <p>This directive can be used instead of the compile-time setting <code>SECURITY_HOLE_PASS_AUTHORIZATION</code> which has been available in previous versions of Apache HTTP Server.</p> <p>The setting is respected by any modules which use <code>ap_add_common_vars()</code>, such as <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, <code class=\"module\"><a href=\"mod_cgid\">mod_cgid</a></code>, <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code>, <code class=\"module\"><a href=\"mod_proxy_scgi\">mod_proxy_scgi</a></code>, and so on. Notably, it affects modules which don't handle the request in the usual sense but still use this API; examples of this are <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> and <code class=\"module\"><a href=\"mod_ext_filter\">mod_ext_filter</a></code>. Third-party modules that don't use <code>ap_add_common_vars()</code> may choose to respect the setting as well.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"cgivar\">CGIVar Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls how some CGI variables are set</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CGIVar variable rule</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.4.21 and later</td>\n</tr> </table> <p>This directive controls how some CGI variables are set.</p> <p><strong>REQUEST_URI</strong> rules:</p> <dl> <dt>\n<code>original-uri</code> (default)</dt> <dd>The value is taken from the original request line, and will not reflect internal redirects or subrequests which change the requested resource.</dd> <dt><code>current-uri</code></dt> <dd>The value reflects the resource currently being processed, which may be different than the original request from the client due to internal redirects or subrequests.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"contentdigest\">ContentDigest Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables the generation of <code>Content-MD5</code> HTTP Response headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ContentDigest On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ContentDigest Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive enables the generation of <code>Content-MD5</code> headers as defined in RFC1864 respectively RFC2616.</p> <p>MD5 is an algorithm for computing a \"message digest\" (sometimes called \"fingerprint\") of arbitrary-length data, with a high degree of confidence that any alterations in the data will be reflected in alterations in the message digest.</p> <p>The <code>Content-MD5</code> header provides an end-to-end message integrity check (MIC) of the entity-body. A proxy or client may check this header for detecting accidental modification of the entity-body in transit. Example header:</p> <div class=\"example\"><pre>Content-MD5: AuLb7Dp1rqtRtxz2m9kRpA==</pre></div> <p>Note that this can cause performance problems on your server since the message digest is computed on every request (the values are not cached).</p> <p><code>Content-MD5</code> is only sent for documents served by the <code class=\"module\"><a href=\"core\">core</a></code>, and not by any module. For example, SSI documents, output from CGI scripts, and byte range responses do not have this header.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"defaultruntimedir\">DefaultRuntimeDir Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Base directory for the server run-time files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DefaultRuntimeDir directory-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DefaultRuntimeDir DEFAULT_REL_RUNTIMEDIR (logs/)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.2 and later</td>\n</tr> </table> <p>The <code class=\"directive\">DefaultRuntimeDir</code> directive sets the directory in which the server will create various run-time files (shared memory, locks, etc.). If set as a relative path, the full path will be relative to <code class=\"directive\">ServerRoot</code>.</p> <p><strong>Example</strong></p> <pre class=\"prettyprint lang-config\">DefaultRuntimeDir scratch/</pre> <p>The default location of <code class=\"directive\">DefaultRuntimeDir</code> may be modified by changing the <code>DEFAULT_REL_RUNTIMEDIR</code> #define at build time.</p> <p>Note: <code class=\"directive\">ServerRoot</code> should be specified before this directive is used. Otherwise, the default value of <code class=\"directive\">ServerRoot</code> would be used to set the base directory.</p> <h3>See also</h3> <ul> <li>\n<a href=\"../misc/security_tips#serverroot\">the security tips</a> for information on how to properly set permissions on the <code class=\"directive\">ServerRoot</code>\n</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"defaulttype\">DefaultType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>This directive has no effect other than to emit warnings if the value is not <code>none</code>. In prior versions, DefaultType would specify a default media type to assign to response content for which no other media type configuration could be found. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DefaultType media-type|none</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DefaultType none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The argument <code>none</code> is available in Apache httpd 2.2.7 and later. All other choices are DISABLED for 2.3.x and later.</td>\n</tr> </table> <p>This directive has been disabled. For backwards compatibility of configuration files, it may be specified with the value <code>none</code>, meaning no default media type. For example:</p> <pre class=\"prettyprint lang-config\">DefaultType None</pre> <p><code>DefaultType None</code> is only available in httpd-2.2.7 and later.</p> <p>Use the mime.types configuration file and the <code class=\"directive\"><a href=\"mod_mime#addtype\">AddType</a></code> to configure media type assignments via file extensions, or the <code class=\"directive\"><a href=\"#forcetype\">ForceType</a></code> directive to configure the media type for specific resources. Otherwise, the server will send the response without a Content-Type header field and the recipient may attempt to guess the media type.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"define\">Define Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define a variable</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Define parameter-name [parameter-value]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>In its one parameter form, <code class=\"directive\">Define</code> is equivalent to passing the <code>-D</code> argument to <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code>. It can be used to toggle the use of <code class=\"directive\"><a href=\"#ifdefine\">&lt;IfDefine&gt;</a></code> sections without needing to alter <code>-D</code> arguments in any startup scripts.</p> <p>In addition to that, if the second parameter is given, a config variable is set to this value. The variable can be used in the configuration using the <code>${VAR}</code> syntax. The variable is always globally defined and not limited to the scope of the surrounding config section.</p> <pre class=\"prettyprint lang-config\">&lt;IfDefine TEST&gt;\n  Define servername test.example.com\n&lt;/IfDefine&gt;\n&lt;IfDefine !TEST&gt;\n  Define servername www.example.com\n  Define SSL\n&lt;/IfDefine&gt;\n\nDocumentRoot \"/var/www/${servername}/htdocs\"</pre> <p>Variable names may not contain colon \":\" characters, to avoid clashes with <code class=\"directive\"><a href=\"mod_rewrite#rewritemap\">RewriteMap</a></code>'s syntax.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"directory\">&lt;Directory&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enclose a group of directives that apply only to the named file-system directory, sub-directories, and their contents.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;Directory directory-path&gt; ... &lt;/Directory&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p><code class=\"directive\">&lt;Directory&gt;</code> and <code>&lt;/Directory&gt;</code> are used to enclose a group of directives that will apply only to the named directory, sub-directories of that directory, and the files within the respective directories. Any directive that is allowed in a directory context may be used. <var>Directory-path</var> is either the full path to a directory, or a wild-card string using Unix shell-style matching. In a wild-card string, <code>?</code> matches any single character, and <code>*</code> matches any sequences of characters. You may also use <code>[]</code> character ranges. None of the wildcards match a `/' character, so <code>&lt;Directory \"/*/public_html\"&gt;</code> will not match <code>/home/user/public_html</code>, but <code>&lt;Directory \"/home/*/public_html\"&gt;</code> will match. Example:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/usr/local/httpd/htdocs\"&gt;\n  Options Indexes FollowSymLinks\n&lt;/Directory&gt;</pre> <p>Directory paths <em>may</em> be quoted, if you like, however, it <em>must</em> be quoted if the path contains spaces. This is because a space would otherwise indicate the end of an argument.</p> <div class=\"note\"> <p>Be careful with the <var>directory-path</var> arguments: They have to literally match the filesystem path which Apache httpd uses to access the files. Directives applied to a particular <code>&lt;Directory&gt;</code> will not apply to files accessed from that same directory via a different path, such as via different symbolic links.</p> </div> <p><a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">Regular expressions</a> can also be used, with the addition of the <code>~</code> character. For example:</p> <pre class=\"prettyprint lang-config\">&lt;Directory ~ \"^/www/[0-9]{3}\"&gt;\n\n&lt;/Directory&gt;</pre> <p>would match directories in <code>/www/</code> that consisted of three numbers.</p> <p>If multiple (non-regular expression) <code class=\"directive\">&lt;Directory&gt;</code> sections match the directory (or one of its parents) containing a document, then the directives are applied in the order of shortest match first, interspersed with the directives from the <a href=\"#accessfilename\">.htaccess</a> files. For example, with</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/\"&gt;\n  AllowOverride None\n&lt;/Directory&gt;\n\n&lt;Directory \"/home\"&gt;\n  AllowOverride FileInfo\n&lt;/Directory&gt;</pre> <p>for access to the document <code>/home/web/dir/doc.html</code> the steps are:</p> <ul> <li>Apply directive <code>AllowOverride None</code> (disabling <code>.htaccess</code> files).</li> <li>Apply directive <code>AllowOverride FileInfo</code> (for directory <code>/home</code>).</li> <li>Apply any <code>FileInfo</code> directives in <code>/home/.htaccess</code>, <code>/home/web/.htaccess</code> and <code>/home/web/dir/.htaccess</code> in that order.</li> </ul> <p>Regular expressions are not considered until after all of the normal sections have been applied. Then all of the regular expressions are tested in the order they appeared in the configuration file. For example, with</p> <pre class=\"prettyprint lang-config\">&lt;Directory ~ \"abc$\"&gt;\n  # ... directives here ...\n&lt;/Directory&gt;</pre> <p>the regular expression section won't be considered until after all normal <code class=\"directive\">&lt;Directory&gt;</code>s and <code>.htaccess</code> files have been applied. Then the regular expression will match on <code>/home/abc/public_html/abc</code> and the corresponding <code class=\"directive\">&lt;Directory&gt;</code> will be applied.</p> <p><strong>Note that the default access for <code>&lt;Directory \"/\"&gt;</code> is to permit all access. This means that Apache httpd will serve any file mapped from an URL. It is recommended that you change this with a block such as</strong></p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/\"&gt;\n  Require all denied\n&lt;/Directory&gt;</pre> <p><strong>and then override this for directories you <em>want</em> accessible. See the <a href=\"../misc/security_tips\">Security Tips</a> page for more details.</strong></p> <p>The directory sections occur in the <code>httpd.conf</code> file. <code class=\"directive\">&lt;Directory&gt;</code> directives cannot nest, and cannot appear in a <code class=\"directive\"><a href=\"#limit\">&lt;Limit&gt;</a></code> or <code class=\"directive\"><a href=\"#limitexcept\">&lt;LimitExcept&gt;</a></code> section.</p> <h3>See also</h3> <ul> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt; and &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"directorymatch\">&lt;DirectoryMatch&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enclose directives that apply to the contents of file-system directories matching a regular expression.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;DirectoryMatch regex&gt; ... &lt;/DirectoryMatch&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p><code class=\"directive\">&lt;DirectoryMatch&gt;</code> and <code>&lt;/DirectoryMatch&gt;</code> are used to enclose a group of directives which will apply only to the named directory (and the files within), the same as <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code>. However, it takes as an argument a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>. For example:</p> <pre class=\"prettyprint lang-config\">&lt;DirectoryMatch \"^/www/(.+/)?[0-9]{3}/\"&gt;\n    # ...\n&lt;/DirectoryMatch&gt;</pre> <p>matches directories in <code>/www/</code> (or any subdirectory thereof) that consist of three numbers.</p> <div class=\"note\">\n<p><strong>Compatability</strong></p> Prior to 2.3.9, this directive implicitly applied to sub-directories (like <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code>) and could not match the end of line symbol ($). In 2.3.9 and later, only directories that match the expression are affected by the enclosed directives. </div> <div class=\"note\">\n<p><strong>Trailing Slash</strong></p> This directive applies to requests for directories that may or may not end in a trailing slash, so expressions that are anchored to the end of line ($) must be written with care. </div> <p>From 2.4.8 onwards, named groups and backreferences are captured and written to the environment with the corresponding name prefixed with \"MATCH_\" and in upper case. This allows elements of paths to be referenced from within <a href=\"../expr\">expressions</a> and modules like <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>. In order to prevent confusion, numbered (unnamed) backreferences are ignored. Use named groups instead.</p> <pre class=\"prettyprint lang-config\">&lt;DirectoryMatch \"^/var/www/combined/(?&lt;sitename&gt;[^/]+)\"&gt;\n    Require ldap-group cn=%{env:MATCH_SITENAME},ou=combined,o=Example\n&lt;/DirectoryMatch&gt;</pre> <h3>See also</h3> <ul> <li>\n<code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> for a description of how regular expressions are mixed in with normal <code class=\"directive\">&lt;Directory&gt;</code>s</li> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt; and &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"documentroot\">DocumentRoot Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory that forms the main document tree visible from the web</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DocumentRoot directory-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DocumentRoot \"/usr/local/apache/htdocs\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive sets the directory from which <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> will serve files. Unless matched by a directive like <code class=\"directive\"><a href=\"mod_alias#alias\">Alias</a></code>, the server appends the path from the requested URL to the document root to make the path to the document. Example:</p> <pre class=\"prettyprint lang-config\">DocumentRoot \"/usr/web\"</pre> <p>then an access to <code>http://my.example.com/index.html</code> refers to <code>/usr/web/index.html</code>. If the <var>directory-path</var> is not absolute then it is assumed to be relative to the <code class=\"directive\"><a href=\"#serverroot\">ServerRoot</a></code>.</p> <p>The <code class=\"directive\">DocumentRoot</code> should be specified without a trailing slash.</p> <h3>See also</h3> <ul> <li><a href=\"../urlmapping#documentroot\">Mapping URLs to Filesystem Locations</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"else\">&lt;Else&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Contains directives that apply only if the condition of a previous <code class=\"directive\"><a href=\"#if\">&lt;If&gt;</a></code> or <code class=\"directive\"><a href=\"#elseif\">&lt;ElseIf&gt;</a></code> section is not satisfied by a request at runtime</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;Else&gt; ... &lt;/Else&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;Else&gt;</code> applies the enclosed directives if and only if the most recent <code class=\"directive\">&lt;If&gt;</code> or <code class=\"directive\">&lt;ElseIf&gt;</code> section in the same scope has not been applied. For example: In </p> <pre class=\"prettyprint lang-config\">&lt;If \"-z req('Host')\"&gt;\n  # ...\n&lt;/If&gt;\n&lt;Else&gt;\n  # ...\n&lt;/Else&gt;</pre> <p> The <code class=\"directive\">&lt;If&gt;</code> would match HTTP/1.0 requests without a <var>Host:</var> header and the <code class=\"directive\">&lt;Else&gt;</code> would match requests with a <var>Host:</var> header.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#if\">&lt;If&gt;</a></code></li> <li><code class=\"directive\"><a href=\"#elseif\">&lt;ElseIf&gt;</a></code></li> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt;, &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received. <code class=\"directive\">&lt;If&gt;</code>, <code class=\"directive\">&lt;ElseIf&gt;</code>, and <code class=\"directive\">&lt;Else&gt;</code> are applied last.</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"elseif\">&lt;ElseIf&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Contains directives that apply only if a condition is satisfied by a request at runtime while the condition of a previous <code class=\"directive\"><a href=\"#if\">&lt;If&gt;</a></code> or <code class=\"directive\">&lt;ElseIf&gt;</code> section is not satisfied</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;ElseIf expression&gt; ... &lt;/ElseIf&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;ElseIf&gt;</code> applies the enclosed directives if and only if both the given condition evaluates to true and the most recent <code class=\"directive\">&lt;If&gt;</code> or <code class=\"directive\">&lt;ElseIf&gt;</code> section in the same scope has not been applied. For example: In </p> <pre class=\"prettyprint lang-config\">&lt;If \"-R '10.1.0.0/16'\"&gt;\n  #...\n&lt;/If&gt;\n&lt;ElseIf \"-R '10.0.0.0/8'\"&gt;\n  #...\n&lt;/ElseIf&gt;\n&lt;Else&gt;\n  #...\n&lt;/Else&gt;</pre> <p>The <code class=\"directive\">&lt;ElseIf&gt;</code> would match if the remote address of a request belongs to the subnet 10.0.0.0/8 but not to the subnet 10.1.0.0/16.</p> <h3>See also</h3> <ul> <li>\n<a href=\"../expr\">Expressions in Apache HTTP Server</a>, for a complete reference and more examples.</li> <li><code class=\"directive\"><a href=\"#if\">&lt;If&gt;</a></code></li> <li><code class=\"directive\"><a href=\"#else\">&lt;Else&gt;</a></code></li> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt;, &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received. <code class=\"directive\">&lt;If&gt;</code>, <code class=\"directive\">&lt;ElseIf&gt;</code>, and <code class=\"directive\">&lt;Else&gt;</code> are applied last.</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"enablemmap\">EnableMMAP Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use memory-mapping to read files during delivery</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>EnableMMAP On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>EnableMMAP On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive controls whether the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> may use memory-mapping if it needs to read the contents of a file during delivery. By default, when the handling of a request requires access to the data within a file -- for example, when delivering a server-parsed file using <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> -- Apache httpd memory-maps the file if the OS supports it.</p> <p>This memory-mapping sometimes yields a performance improvement. But in some environments, it is better to disable the memory-mapping to prevent operational problems:</p> <ul> <li>On some multiprocessor systems, memory-mapping can reduce the performance of the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code>.</li> <li>Deleting or truncating a file while <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> has it memory-mapped can cause <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> to crash with a segmentation fault. </li> </ul> <p>For server configurations that are vulnerable to these problems, you should disable memory-mapping of delivered files by specifying:</p> <pre class=\"prettyprint lang-config\">EnableMMAP Off</pre> <p>For NFS mounted files, this feature may be disabled explicitly for the offending files by specifying:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/path-to-nfs-files\"&gt;\n  EnableMMAP Off\n&lt;/Directory&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"enablesendfile\">EnableSendfile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use the kernel sendfile support to deliver files to the client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>EnableSendfile On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>EnableSendfile Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Default changed to Off in version 2.3.9.</td>\n</tr> </table> <p>This directive controls whether <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> may use the sendfile support from the kernel to transmit file contents to the client. By default, when the handling of a request requires no access to the data within a file -- for example, when delivering a static file -- Apache httpd uses sendfile to deliver the file contents without ever reading the file if the OS supports it.</p> <p>This sendfile mechanism avoids separate read and send operations, and buffer allocations. But on some platforms or within some filesystems, it is better to disable this feature to avoid operational problems:</p> <ul> <li>Some platforms may have broken sendfile support that the build system did not detect, especially if the binaries were built on another box and moved to such a machine with broken sendfile support.</li> <li>On Linux the use of sendfile triggers TCP-checksum offloading bugs on certain networking cards when using IPv6.</li> <li>On Linux on Itanium, <code>sendfile</code> may be unable to handle files over 2GB in size.</li> <li>With a network-mounted <code class=\"directive\"><a href=\"#documentroot\">DocumentRoot</a></code> (e.g., NFS, SMB, CIFS, FUSE), the kernel may be unable to serve the network file through its own cache.</li> </ul> <p>For server configurations that are not vulnerable to these problems, you may enable this feature by specifying:</p> <pre class=\"prettyprint lang-config\">EnableSendfile On</pre> <p>For network mounted files, this feature may be disabled explicitly for the offending files by specifying:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/path-to-nfs-files\"&gt;\n  EnableSendfile Off\n&lt;/Directory&gt;</pre> <p>Please note that the per-directory and .htaccess configuration of <code class=\"directive\">EnableSendfile</code> is not supported by <code class=\"module\"><a href=\"mod_cache_disk\">mod_cache_disk</a></code>. Only global definition of <code class=\"directive\">EnableSendfile</code> is taken into account by the module. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"error\">Error Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Abort configuration parsing with a custom error message</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Error message</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.3.9 and later</td>\n</tr> </table> <p>If an error can be detected within the configuration, this directive can be used to generate a custom error message, and halt configuration parsing. The typical use is for reporting required modules which are missing from the configuration.</p> <pre class=\"prettyprint lang-config\"># Example\n# ensure that mod_include is loaded\n&lt;IfModule !include_module&gt;\n  Error \"mod_include is required by mod_foo.  Load it with LoadModule.\"\n&lt;/IfModule&gt;\n\n# ensure that exactly one of SSL,NOSSL is defined\n&lt;IfDefine SSL&gt;\n&lt;IfDefine NOSSL&gt;\n  Error \"Both SSL and NOSSL are defined.  Define only one of them.\"\n&lt;/IfDefine&gt;\n&lt;/IfDefine&gt;\n&lt;IfDefine !SSL&gt;\n&lt;IfDefine !NOSSL&gt;\n  Error \"Either SSL or NOSSL must be defined.\"\n&lt;/IfDefine&gt;\n&lt;/IfDefine&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"errordocument\">ErrorDocument Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>What the server will return to the client in case of an error</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ErrorDocument error-code document</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>In the event of a problem or error, Apache httpd can be configured to do one of four things,</p> <ol> <li>output a simple hardcoded error message</li> <li>output a customized message</li> <li>internally redirect to a local <var>URL-path</var> to handle the problem/error</li> <li>redirect to an external <var>URL</var> to handle the problem/error</li> </ol> <p>The first option is the default, while options 2-4 are configured using the <code class=\"directive\">ErrorDocument</code> directive, which is followed by the HTTP response code and a URL or a message. Apache httpd will sometimes offer additional information regarding the problem/error.</p> <p>From 2.4.13, <a href=\"../expr\">expression syntax</a> can be used inside the directive to produce dynamic strings and URLs.</p> <p>URLs can begin with a slash (/) for local web-paths (relative to the <code class=\"directive\"><a href=\"#documentroot\">DocumentRoot</a></code>), or be a full URL which the client can resolve. Alternatively, a message can be provided to be displayed by the browser. Note that deciding whether the parameter is an URL, a path or a message is performed before any expression is parsed. Examples:</p> <pre class=\"prettyprint lang-config\">ErrorDocument 500 http://example.com/cgi-bin/server-error.cgi\nErrorDocument 404 /errors/bad_urls.php\nErrorDocument 401 /subscription_info.html\nErrorDocument 403 \"Sorry, can't allow you access today\"\nErrorDocument 403 Forbidden!\nErrorDocument 403 /errors/forbidden.py?referrer=%{escape:%{HTTP_REFERER}}</pre> <p>Additionally, the special value <code>default</code> can be used to specify Apache httpd's simple hardcoded message. While not required under normal circumstances, <code>default</code> will restore Apache httpd's simple hardcoded message for configurations that would otherwise inherit an existing <code class=\"directive\">ErrorDocument</code>.</p> <pre class=\"prettyprint lang-config\">ErrorDocument 404 /cgi-bin/bad_urls.pl\n\n&lt;Directory \"/web/docs\"&gt;\n  ErrorDocument 404 default\n&lt;/Directory&gt;</pre> <p>Note that when you specify an <code class=\"directive\">ErrorDocument</code> that points to a remote URL (ie. anything with a method such as <code>http</code> in front of it), Apache HTTP Server will send a redirect to the client to tell it where to find the document, even if the document ends up being on the same server. This has several implications, the most important being that the client will not receive the original error status code, but instead will receive a redirect status code. This in turn can confuse web robots and other clients which try to determine if a URL is valid using the status code. In addition, if you use a remote URL in an <code>ErrorDocument 401</code>, the client will not know to prompt the user for a password since it will not receive the 401 status code. Therefore, <strong>if you use an <code>ErrorDocument 401</code> directive, then it must refer to a local document.</strong></p> <p>Microsoft Internet Explorer (MSIE) will by default ignore server-generated error messages when they are \"too small\" and substitute its own \"friendly\" error messages. The size threshold varies depending on the type of error, but in general, if you make your error document greater than 512 bytes, then MSIE will show the server-generated error rather than masking it. More information is available in Microsoft Knowledge Base article <a href=\"http://support.microsoft.com/default.aspx?scid=kb;en-us;Q294807\">Q294807</a>.</p> <p>Although most error messages can be overridden, there are certain circumstances where the internal messages are used regardless of the setting of <code class=\"directive\"><a href=\"#errordocument\">ErrorDocument</a></code>. In particular, if a malformed request is detected, normal request processing will be immediately halted and the internal error message returned. This is necessary to guard against security problems caused by bad requests.</p> <p>If you are using mod_proxy, you may wish to enable <code class=\"directive\"><a href=\"mod_proxy#proxyerroroverride\">ProxyErrorOverride</a></code> so that you can provide custom error messages on behalf of your Origin servers. If you don't enable ProxyErrorOverride, Apache httpd will not generate custom error documents for proxied content.</p> <h3>See also</h3> <ul> <li><a href=\"../custom-error\">documentation of customizable responses</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"errorlog\">ErrorLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Location where the server will log errors</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ErrorLog file-path|syslog[:facility]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ErrorLog logs/error_log (Unix) ErrorLog logs/error.log (Windows and OS/2)</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">ErrorLog</code> directive sets the name of the file to which the server will log any errors it encounters. If the <var>file-path</var> is not absolute then it is assumed to be relative to the <code class=\"directive\"><a href=\"#serverroot\">ServerRoot</a></code>.</p> <pre class=\"prettyprint lang-config\">ErrorLog \"/var/log/httpd/error_log\"</pre> <p>If the <var>file-path</var> begins with a pipe character \"<code>|</code>\" then it is assumed to be a command to spawn to handle the error log.</p> <pre class=\"prettyprint lang-config\">ErrorLog \"|/usr/local/bin/httpd_errors\"</pre> <p>See the notes on <a href=\"../logs#piped\">piped logs</a> for more information.</p> <p>Using <code>syslog</code> instead of a filename enables logging via syslogd(8) if the system supports it. The default is to use syslog facility <code>local7</code>, but you can override this by using the <code>syslog:facility</code> syntax where <var>facility</var> can be one of the names usually documented in syslog(1). The facility is effectively global, and if it is changed in individual virtual hosts, the final facility specified affects the entire server.</p> <pre class=\"prettyprint lang-config\">ErrorLog syslog:user</pre> <p>Additional modules can provide their own ErrorLog providers. The syntax is similar to the <code>syslog</code> example above.</p> <p>SECURITY: See the <a href=\"../misc/security_tips#serverroot\">security tips</a> document for details on why your security could be compromised if the directory where log files are stored is writable by anyone other than the user that starts the server.</p> <div class=\"warning\">\n<p><strong>Note</strong></p> <p>When entering a file path on non-Unix platforms, care should be taken to make sure that only forward slashes are used even though the platform may allow the use of back slashes. In general it is a good idea to always use forward slashes throughout the configuration files.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#loglevel\">LogLevel</a></code></li> <li><a href=\"../logs\">Apache HTTP Server Log Files</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"errorlogformat\">ErrorLogFormat Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Format specification for error log entries</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ErrorLogFormat [connection|request] format</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p><code class=\"directive\">ErrorLogFormat</code> allows to specify what supplementary information is logged in the error log in addition to the actual log message.</p> <pre class=\"prettyprint lang-config\">#Simple example\nErrorLogFormat \"[%t] [%l] [pid %P] %F: %E: [client %a] %M\"</pre> <p>Specifying <code>connection</code> or <code>request</code> as first parameter allows to specify additional formats, causing additional information to be logged when the first message is logged for a specific connection or request, respectively. This additional information is only logged once per connection/request. If a connection or request is processed without causing any log message, the additional information is not logged either.</p> <p>It can happen that some format string items do not produce output. For example, the Referer header is only present if the log message is associated to a request and the log message happens at a time when the Referer header has already been read from the client. If no output is produced, the default behavior is to delete everything from the preceding space character to the next space character. This means the log line is implicitly divided into fields on non-whitespace to whitespace transitions. If a format string item does not produce output, the whole field is omitted. For example, if the remote address <code>%a</code> in the log format <code>[%t] [%l] [%a] %M</code> is not available, the surrounding brackets are not logged either. Space characters can be escaped with a backslash to prevent them from delimiting a field. The combination '% ' (percent space) is a zero-width field delimiter that does not produce any output.</p> <p>The above behavior can be changed by adding modifiers to the format string item. A <code>-</code> (minus) modifier causes a minus to be logged if the respective item does not produce any output. In once-per-connection/request formats, it is also possible to use the <code>+</code> (plus) modifier. If an item with the plus modifier does not produce any output, the whole line is omitted.</p> <p>A number as modifier can be used to assign a log severity level to a format item. The item will only be logged if the severity of the log message is not higher than the specified log severity level. The number can range from 1 (alert) over 4 (warn) and 7 (debug) to 15 (trace8).</p> <p>For example, here's what would happen if you added modifiers to the <code>%{Referer}i</code> token, which logs the <code>Referer</code> request header.</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Modified Token</th>\n<th>Meaning</th>\n</tr> <tr> <td><code>%-{Referer}i</code></td> <td>Logs a <code>-</code> if <code>Referer</code> is not set.</td> </tr> <tr class=\"odd\"> <td><code>%+{Referer}i</code></td> <td>Omits the entire line if <code>Referer</code> is not set.</td> </tr> <tr> <td><code>%4{Referer}i</code></td> <td>Logs the <code>Referer</code> only if the log message severity is higher than 4.</td> </tr> </table> <p>Some format string items accept additional parameters in braces.</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Format String</th> <th>Description</th>\n</tr> <tr>\n<td><code>%%</code></td> <td>The percent sign</td>\n</tr> <tr class=\"odd\">\n<td><code>%a</code></td> <td>Client IP address and port of the request</td>\n</tr> <tr>\n<td><code>%{c}a</code></td> <td>Underlying peer IP address and port of the connection (see the <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> module)</td>\n</tr> <tr class=\"odd\">\n<td><code>%A</code></td> <td>Local IP-address and port</td>\n</tr> <tr>\n<td><code>%{name}e</code></td> <td>Request environment variable <em>name</em>\n</td>\n</tr> <tr class=\"odd\">\n<td><code>%E</code></td> <td>APR/OS error status code and string</td>\n</tr> <tr>\n<td><code>%F</code></td> <td>Source file name and line number of the log call</td>\n</tr> <tr class=\"odd\">\n<td><code>%{name}i</code></td> <td>Request header <em>name</em>\n</td>\n</tr> <tr>\n<td><code>%k</code></td> <td>Number of keep-alive requests on this connection</td>\n</tr> <tr class=\"odd\">\n<td><code>%l</code></td> <td>Loglevel of the message</td>\n</tr> <tr>\n<td><code>%L</code></td> <td>Log ID of the request</td>\n</tr> <tr class=\"odd\">\n<td><code>%{c}L</code></td> <td>Log ID of the connection</td>\n</tr> <tr>\n<td><code>%{C}L</code></td> <td>Log ID of the connection if used in connection scope, empty otherwise</td>\n</tr> <tr class=\"odd\">\n<td><code>%m</code></td> <td>Name of the module logging the message</td>\n</tr> <tr>\n<td><code>%M</code></td> <td>The actual log message</td>\n</tr> <tr class=\"odd\">\n<td><code>%{name}n</code></td> <td>Request note <em>name</em>\n</td>\n</tr> <tr>\n<td><code>%P</code></td> <td>Process ID of current process</td>\n</tr> <tr class=\"odd\">\n<td><code>%T</code></td> <td>Thread ID of current thread</td>\n</tr> <tr>\n<td><code>%{g}T</code></td> <td>System unique thread ID of current thread (the same ID as displayed by e.g. <code>top</code>; currently Linux only)</td>\n</tr> <tr class=\"odd\">\n<td><code>%t</code></td> <td>The current time</td>\n</tr> <tr>\n<td><code>%{u}t</code></td> <td>The current time including micro-seconds</td>\n</tr> <tr class=\"odd\">\n<td><code>%{cu}t</code></td> <td>The current time in compact ISO 8601 format, including micro-seconds</td>\n</tr> <tr>\n<td><code>%v</code></td> <td>The canonical <code class=\"directive\"><a href=\"#servername\">ServerName</a></code> of the current server.</td>\n</tr> <tr class=\"odd\">\n<td><code>%V</code></td> <td>The server name of the server serving the request according to the <code class=\"directive\"><a href=\"#usecanonicalname\">UseCanonicalName</a></code> setting.</td>\n</tr> <tr>\n<td>\n<code>\\</code> (backslash space)</td> <td>Non-field delimiting space</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>%</code> (percent space)</td> <td>Field delimiter (no output)</td>\n</tr> </table> <p>The log ID format <code>%L</code> produces a unique id for a connection or request. This can be used to correlate which log lines belong to the same connection or request, which request happens on which connection. A <code>%L</code> format string is also available in <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code> to allow to correlate access log entries with error log lines. If <code class=\"module\"><a href=\"mod_unique_id\">mod_unique_id</a></code> is loaded, its unique id will be used as log ID for requests.</p> <pre class=\"prettyprint lang-config\">#Example (default format for threaded MPMs)\nErrorLogFormat \"[%{u}t] [%-m:%l] [pid %P:tid %T] %7F: %E: [client\\ %a] %M%,\\referer\\%{Referer}i\"</pre> <p>This would result in error messages such as:</p> <div class=\"example\"><pre>[Thu May 12 08:28:57.652118 2011] [core:error] [pid 8777:tid 4326490112] [client ::1:58619] File does not exist: /usr/local/apache2/htdocs/favicon.ico</pre></div> <p>Notice that, as discussed above, some fields are omitted entirely because they are not defined.</p> <pre class=\"prettyprint lang-config\">#Example (similar to the 2.2.x format)\nErrorLogFormat \"[%t] [%l] %7F: %E: [client\\ %a] %M%,\\referer\\%{Referer}i\"</pre> <pre class=\"prettyprint lang-config\">#Advanced example with request/connection log IDs\nErrorLogFormat \"[%{uc}t] [%-m:%-l] [R:%L] [C:%{C}L] %7F: %E: %M\"\nErrorLogFormat request \"[%{uc}t] [R:%L] Request %k on C:%{c}L pid:%P tid:%T\"\nErrorLogFormat request \"[%{uc}t] [R:%L] UA:'%+{User-Agent}i'\"\nErrorLogFormat request \"[%{uc}t] [R:%L] Referer:'%+{Referer}i'\"\nErrorLogFormat connection \"[%{uc}t] [C:%{c}L] local\\ %a remote\\ %A\"</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#errorlog\">ErrorLog</a></code></li> <li><code class=\"directive\"><a href=\"#loglevel\">LogLevel</a></code></li> <li><a href=\"../logs\">Apache HTTP Server Log Files</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"extendedstatus\">ExtendedStatus Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Keep track of extended status information for each request</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ExtendedStatus On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ExtendedStatus Off[*]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This option tracks additional data per worker about the currently executing request and creates a utilization summary. You can see these variables during runtime by configuring <code class=\"module\"><a href=\"mod_status\">mod_status</a></code>. Note that other modules may rely on this scoreboard.</p> <p>This setting applies to the entire server and cannot be enabled or disabled on a virtualhost-by-virtualhost basis. The collection of extended status information can slow down the server. Also note that this setting cannot be changed during a graceful restart.</p> <div class=\"note\"> <p>Note that loading <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> will change the default behavior to ExtendedStatus On, while other third party modules may do the same. Such modules rely on collecting detailed information about the state of all workers. The default is changed by <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> beginning with version 2.3.6. The previous default was always Off.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"fileetag\">FileETag Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File attributes used to create the ETag HTTP response header for static files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>FileETag component ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>FileETag MTime Size</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The default used to be \"INode MTime Size\" in 2.3.14 and earlier.</td>\n</tr> </table> <p> The <code class=\"directive\">FileETag</code> directive configures the file attributes that are used to create the <code>ETag</code> (entity tag) response header field when the document is based on a static file. (The <code>ETag</code> value is used in cache management to save network bandwidth.) The <code class=\"directive\">FileETag</code> directive allows you to choose which of these -- if any -- should be used. The recognized keywords are: </p> <dl> <dt><strong>INode</strong></dt> <dd>The file's i-node number will be included in the calculation</dd> <dt><strong>MTime</strong></dt> <dd>The date and time the file was last modified will be included</dd> <dt><strong>Size</strong></dt> <dd>The number of bytes in the file will be included</dd> <dt><strong>All</strong></dt> <dd>All available fields will be used. This is equivalent to: <pre class=\"prettyprint lang-config\">FileETag INode MTime Size</pre> </dd> <dt><strong>None</strong></dt> <dd>If a document is file-based, no <code>ETag</code> field will be included in the response</dd> </dl> <p>The <code>INode</code>, <code>MTime</code>, and <code>Size</code> keywords may be prefixed with either <code>+</code> or <code>-</code>, which allow changes to be made to the default setting inherited from a broader scope. Any keyword appearing without such a prefix immediately and completely cancels the inherited setting.</p> <p>If a directory's configuration includes <code>FileETag INode MTime Size</code>, and a subdirectory's includes <code>FileETag -INode</code>, the setting for that subdirectory (which will be inherited by any sub-subdirectories that don't override it) will be equivalent to <code>FileETag MTime Size</code>.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> Do not change the default for directories or locations that have WebDAV enabled and use <code class=\"module\"><a href=\"mod_dav_fs\">mod_dav_fs</a></code> as a storage provider. <code class=\"module\"><a href=\"mod_dav_fs\">mod_dav_fs</a></code> uses <code>MTime Size</code> as a fixed format for <code>ETag</code> comparisons on conditional requests. These conditional requests will break if the <code>ETag</code> format is changed via <code class=\"directive\">FileETag</code>. </div> <div class=\"note\">\n<p><strong>Server Side Includes</strong></p> An ETag is not generated for responses parsed by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> since the response entity can change without a change of the INode, MTime, or Size of the static file with embedded SSI directives. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"files\">&lt;Files&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Contains directives that apply to matched filenames</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;Files filename&gt; ... &lt;/Files&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;Files&gt;</code> directive limits the scope of the enclosed directives by filename. It is comparable to the <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> and <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code> directives. It should be matched with a <code>&lt;/Files&gt;</code> directive. The directives given within this section will be applied to any object with a basename (last component of filename) matching the specified filename. <code class=\"directive\">&lt;Files&gt;</code> sections are processed in the order they appear in the configuration file, after the <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections and <code>.htaccess</code> files are read, but before <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code> sections. Note that <code class=\"directive\">&lt;Files&gt;</code> can be nested inside <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections to restrict the portion of the filesystem they apply to.</p> <p>The <var>filename</var> argument should include a filename, or a wild-card string, where <code>?</code> matches any single character, and <code>*</code> matches any sequences of characters.</p> <pre class=\"prettyprint lang-config\">&lt;Files \"cat.html\"&gt;\n    # Insert stuff that applies to cat.html here\n&lt;/Files&gt;\n\n&lt;Files \"?at.*\"&gt;\n    # This would apply to cat.html, bat.html, hat.php and so on.\n&lt;/Files&gt;</pre> <p><a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">Regular expressions</a> can also be used, with the addition of the <code>~</code> character. For example:</p> <pre class=\"prettyprint lang-config\">&lt;Files ~ \"\\.(gif|jpe?g|png)$\"&gt;\n    #...\n&lt;/Files&gt;</pre> <p>would match most common Internet graphics formats. <code class=\"directive\"><a href=\"#filesmatch\">&lt;FilesMatch&gt;</a></code> is preferred, however.</p> <p>Note that unlike <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> and <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code> sections, <code class=\"directive\">&lt;Files&gt;</code> sections can be used inside <code>.htaccess</code> files. This allows users to control access to their own files, at a file-by-file level.</p> <h3>See also</h3> <ul> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt; and &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"filesmatch\">&lt;FilesMatch&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Contains directives that apply to regular-expression matched filenames</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;FilesMatch regex&gt; ... &lt;/FilesMatch&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;FilesMatch&gt;</code> directive limits the scope of the enclosed directives by filename, just as the <code class=\"directive\"><a href=\"#files\">&lt;Files&gt;</a></code> directive does. However, it accepts a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>. For example:</p> <pre class=\"prettyprint lang-config\">&lt;FilesMatch \".+\\.(gif|jpe?g|png)$\"&gt;\n    # ...\n&lt;/FilesMatch&gt;</pre> <p>would match most common Internet graphics formats.</p> <div class=\"note\">The <code>.+</code> at the start of the regex ensures that files named <code>.png</code>, or <code>.gif</code>, for example, are not matched.</div> <p>From 2.4.8 onwards, named groups and backreferences are captured and written to the environment with the corresponding name prefixed with \"MATCH_\" and in upper case. This allows elements of files to be referenced from within <a href=\"../expr\">expressions</a> and modules like <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>. In order to prevent confusion, numbered (unnamed) backreferences are ignored. Use named groups instead.</p> <pre class=\"prettyprint lang-config\">&lt;FilesMatch \"^(?&lt;sitename&gt;[^/]+)\"&gt;\n    require ldap-group cn=%{env:MATCH_SITENAME},ou=combined,o=Example\n&lt;/FilesMatch&gt;</pre> <h3>See also</h3> <ul> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt; and &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"forcetype\">ForceType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Forces all matching files to be served with the specified media type in the HTTP Content-Type header field</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ForceType media-type|None</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>When placed into an <code>.htaccess</code> file or a <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code>, or <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code> or <code class=\"directive\"><a href=\"#files\">&lt;Files&gt;</a></code> section, this directive forces all matching files to be served with the content type identification given by <var>media-type</var>. For example, if you had a directory full of GIF files, but did not want to label them all with <code>.gif</code>, you might want to use:</p> <pre class=\"prettyprint lang-config\">ForceType image/gif</pre> <p>Note that this directive overrides other indirect media type associations defined in mime.types or via the <code class=\"directive\"><a href=\"mod_mime#addtype\">AddType</a></code>.</p> <p>You can also override more general <code class=\"directive\">ForceType</code> settings by using the value of <code>None</code>:</p> <pre class=\"prettyprint lang-config\"># force all files to be image/gif:\n&lt;Location \"/images\"&gt;\n  ForceType image/gif\n&lt;/Location&gt;\n\n# but normal mime-type associations here:\n&lt;Location \"/images/mixed\"&gt;\n  ForceType None\n&lt;/Location&gt;</pre> <p>This directive primarily overrides the content types generated for static files served out of the filesystem. For resources other than static files, where the generator of the response typically specifies a Content-Type, this directive has no effect.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>When explicit directives such as <code class=\"directive\"><a href=\"#sethandler\">SetHandler</a></code> or <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code> do not apply to the current request, the internal handler name normally set by those directives is set to match the content type specified by this directive. This is a historical behavior that some third-party modules (such as mod_php) may use \"magic\" content types used only to signal the module to take responsibility for the matching request. Configurations that rely on such \"magic\" types should be avoided by the use of <code class=\"directive\"><a href=\"#sethandler\">SetHandler</a></code> or <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code>. </p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"gprofdir\">GprofDir Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Directory to write gmon.out profiling data to. </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>GprofDir /tmp/gprof/|/tmp/gprof/%</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>When the server has been compiled with gprof profiling support, <code class=\"directive\">GprofDir</code> causes <code>gmon.out</code> files to be written to the specified directory when the process exits. If the argument ends with a percent symbol ('%'), subdirectories are created for each process id.</p> <p>This directive currently only works with the <code class=\"module\"><a href=\"prefork\">prefork</a></code> MPM.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"hostnamelookups\">HostnameLookups Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables DNS lookups on client IP addresses</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>HostnameLookups On|Off|Double</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>HostnameLookups Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive enables DNS lookups so that host names can be logged (and passed to CGIs/SSIs in <code>REMOTE_HOST</code>). The value <code>Double</code> refers to doing double-reverse DNS lookup. That is, after a reverse lookup is performed, a forward lookup is then performed on that result. At least one of the IP addresses in the forward lookup must match the original address. (In \"tcpwrappers\" terminology this is called <code>PARANOID</code>.)</p> <p>Regardless of the setting, when <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code> is used for controlling access by hostname, a double reverse lookup will be performed. This is necessary for security. Note that the result of this double-reverse isn't generally available unless you set <code>HostnameLookups Double</code>. For example, if only <code>HostnameLookups On</code> and a request is made to an object that is protected by hostname restrictions, regardless of whether the double-reverse fails or not, CGIs will still be passed the single-reverse result in <code>REMOTE_HOST</code>.</p> <p>The default is <code>Off</code> in order to save the network traffic for those sites that don't truly need the reverse lookups done. It is also better for the end users because they don't have to suffer the extra latency that a lookup entails. Heavily loaded sites should leave this directive <code>Off</code>, since DNS lookups can take considerable amounts of time. The utility <code class=\"program\"><a href=\"../programs/logresolve\">logresolve</a></code>, compiled by default to the <code>bin</code> subdirectory of your installation directory, can be used to look up host names from logged IP addresses offline.</p> <p>Finally, if you have <a href=\"mod_authz_host#reqhost\">hostname-based Require directives</a>, a hostname lookup will be performed regardless of the setting of <code>HostnameLookups</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"if\">&lt;If&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Contains directives that apply only if a condition is satisfied by a request at runtime</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;If expression&gt; ... &lt;/If&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;If&gt;</code> directive evaluates an expression at runtime, and applies the enclosed directives if and only if the expression evaluates to true. For example:</p> <pre class=\"prettyprint lang-config\">&lt;If \"-z req('Host')\"&gt;</pre> <p>would match HTTP/1.0 requests without a <var>Host:</var> header. Expressions may contain various shell-like operators for string comparison (<code>==</code>, <code>!=</code>, <code>&lt;</code>, ...), integer comparison (<code>-eq</code>, <code>-ne</code>, ...), and others (<code>-n</code>, <code>-z</code>, <code>-f</code>, ...). It is also possible to use regular expressions, </p> <pre class=\"prettyprint lang-config\">&lt;If \"%{QUERY_STRING} =~ /(delete|commit)=.*?elem/\"&gt;</pre> <p>shell-like pattern matches and many other operations. These operations can be done on request headers (<code>req</code>), environment variables (<code>env</code>), and a large number of other properties. The full documentation is available in <a href=\"../expr\">Expressions in Apache HTTP Server</a>.</p> <p>Only directives that support the directory context can be used within this configuration section.</p> <div class=\"warning\"> Certain variables, such as <code>CONTENT_TYPE</code> and other response headers, are set after &lt;If&gt; conditions have already been evaluated, and so will not be available to use in this directive. </div> <h3>See also</h3> <ul> <li>\n<a href=\"../expr\">Expressions in Apache HTTP Server</a>, for a complete reference and more examples.</li> <li><code class=\"directive\"><a href=\"#elseif\">&lt;ElseIf&gt;</a></code></li> <li><code class=\"directive\"><a href=\"#else\">&lt;Else&gt;</a></code></li> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt;, &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received. <code class=\"directive\">&lt;If&gt;</code>, <code class=\"directive\">&lt;ElseIf&gt;</code>, and <code class=\"directive\">&lt;Else&gt;</code> are applied last.</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"ifdefine\">&lt;IfDefine&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Encloses directives that will be processed only if a test is true at startup</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;IfDefine [!]parameter-name&gt; ... &lt;/IfDefine&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code>&lt;IfDefine test&gt;...&lt;/IfDefine&gt;</code> section is used to mark directives that are conditional. The directives within an <code class=\"directive\">&lt;IfDefine&gt;</code> section are only processed if the <var>test</var> is true. If <var> test</var> is false, everything between the start and end markers is ignored.</p> <p>The <var>test</var> in the <code class=\"directive\">&lt;IfDefine&gt;</code> section directive can be one of two forms:</p> <ul> <li><var>parameter-name</var></li> <li>\n<code>!</code><var>parameter-name</var>\n</li> </ul> <p>In the former case, the directives between the start and end markers are only processed if the parameter named <var>parameter-name</var> is defined. The second format reverses the test, and only processes the directives if <var>parameter-name</var> is <strong>not</strong> defined.</p> <p>The <var>parameter-name</var> argument is a define as given on the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> command line via <code>-Dparameter</code> at the time the server was started or by the <code class=\"directive\"><a href=\"#define\">Define</a></code> directive.</p> <p><code class=\"directive\">&lt;IfDefine&gt;</code> sections are nest-able, which can be used to implement simple multiple-parameter tests. Example:</p> <div class=\"example\"><pre>httpd -DReverseProxy -DUseCache -DMemCache ...</pre></div> <pre class=\"prettyprint lang-config\">&lt;IfDefine ReverseProxy&gt;\n  LoadModule proxy_module   modules/mod_proxy.so\n  LoadModule proxy_http_module   modules/mod_proxy_http.so\n  &lt;IfDefine UseCache&gt;\n    LoadModule cache_module   modules/mod_cache.so\n    &lt;IfDefine MemCache&gt;\n      LoadModule mem_cache_module   modules/mod_mem_cache.so\n    &lt;/IfDefine&gt;\n    &lt;IfDefine !MemCache&gt;\n      LoadModule cache_disk_module   modules/mod_cache_disk.so\n    &lt;/IfDefine&gt;\n  &lt;/IfDefine&gt;\n&lt;/IfDefine&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"ifmodule\">&lt;IfModule&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Encloses directives that are processed conditional on the presence or absence of a specific module</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;IfModule [!]module-file|module-identifier&gt; ... &lt;/IfModule&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Module identifiers are available in version 2.1 and later.</td>\n</tr> </table> <p>The <code>&lt;IfModule test&gt;...&lt;/IfModule&gt;</code> section is used to mark directives that are conditional on the presence of a specific module. The directives within an <code class=\"directive\">&lt;IfModule&gt;</code> section are only processed if the <var>test</var> is true. If <var>test</var> is false, everything between the start and end markers is ignored.</p> <p>The <var>test</var> in the <code class=\"directive\">&lt;IfModule&gt;</code> section directive can be one of two forms:</p> <ul> <li><var>module</var></li> <li>!<var>module</var>\n</li> </ul> <p>In the former case, the directives between the start and end markers are only processed if the module named <var>module</var> is included in Apache httpd -- either compiled in or dynamically loaded using <code class=\"directive\"><a href=\"mod_so#loadmodule\">LoadModule</a></code>. The second format reverses the test, and only processes the directives if <var>module</var> is <strong>not</strong> included.</p> <p>The <var>module</var> argument can be either the module identifier or the file name of the module, at the time it was compiled. For example, <code>rewrite_module</code> is the identifier and <code>mod_rewrite.c</code> is the file name. If a module consists of several source files, use the name of the file containing the string <code>STANDARD20_MODULE_STUFF</code>.</p> <p><code class=\"directive\">&lt;IfModule&gt;</code> sections are nest-able, which can be used to implement simple multiple-module tests.</p> <div class=\"note\">This section should only be used if you need to have one configuration file that works whether or not a specific module is available. In normal operation, directives need not be placed in <code class=\"directive\">&lt;IfModule&gt;</code> sections.</div> </div>  <div class=\"directive-section\">\n<h2 id=\"include\">Include Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Includes other configuration files from within the server configuration files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Include file-path|directory-path|wildcard</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Directory wildcard matching available in 2.3.6 and later</td>\n</tr> </table> <p>This directive allows inclusion of other configuration files from within the server configuration files.</p> <p>Shell-style (<code>fnmatch()</code>) wildcard characters can be used in the filename or directory parts of the path to include several files at once, in alphabetical order. In addition, if <code class=\"directive\">Include</code> points to a directory, rather than a file, Apache httpd will read all files in that directory and any subdirectory. However, including entire directories is not recommended, because it is easy to accidentally leave temporary files in a directory that can cause <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> to fail. Instead, we encourage you to use the wildcard syntax shown below, to include files that match a particular pattern, such as *.conf, for example.</p> <p>The <code class=\"directive\"><a href=\"#include\">Include</a></code> directive will <strong>fail with an error</strong> if a wildcard expression does not match any file. The <code class=\"directive\"><a href=\"#includeoptional\">IncludeOptional</a></code> directive can be used if non-matching wildcards should be ignored.</p> <p>The file path specified may be an absolute path, or may be relative to the <code class=\"directive\"><a href=\"#serverroot\">ServerRoot</a></code> directory.</p> <p>Examples:</p> <pre class=\"prettyprint lang-config\">Include /usr/local/apache2/conf/ssl.conf\nInclude /usr/local/apache2/conf/vhosts/*.conf</pre> <p>Or, providing paths relative to your <code class=\"directive\"><a href=\"#serverroot\">ServerRoot</a></code> directory:</p> <pre class=\"prettyprint lang-config\">Include conf/ssl.conf\nInclude conf/vhosts/*.conf</pre> <p>Wildcards may be included in the directory or file portion of the path. This example will fail if there is no subdirectory in conf/vhosts that contains at least one *.conf file:</p> <pre class=\"prettyprint lang-config\">Include conf/vhosts/*/*.conf</pre> <p>Alternatively, the following command will just be ignored in case of missing files or directories:</p> <pre class=\"prettyprint lang-config\">IncludeOptional conf/vhosts/*/*.conf</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#includeoptional\">IncludeOptional</a></code></li> <li><code class=\"program\"><a href=\"../programs/apachectl\">apachectl</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"includeoptional\">IncludeOptional Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Includes other configuration files from within the server configuration files</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>IncludeOptional file-path|directory-path|wildcard</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in 2.3.6 and later</td>\n</tr> </table> <p>This directive allows inclusion of other configuration files from within the server configuration files. It works identically to the <code class=\"directive\"><a href=\"#include\">Include</a></code> directive, with the exception that if wildcards do not match any file or directory, the <code class=\"directive\"><a href=\"#includeoptional\">IncludeOptional</a></code> directive will be silently ignored instead of causing an error.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#include\">Include</a></code></li> <li><code class=\"program\"><a href=\"../programs/apachectl\">apachectl</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"keepalive\">KeepAlive Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables HTTP persistent connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>KeepAlive On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>KeepAlive On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The Keep-Alive extension to HTTP/1.0 and the persistent connection feature of HTTP/1.1 provide long-lived HTTP sessions which allow multiple requests to be sent over the same TCP connection. In some cases this has been shown to result in an almost 50% speedup in latency times for HTML documents with many images. To enable Keep-Alive connections, set <code>KeepAlive On</code>.</p> <p>For HTTP/1.0 clients, Keep-Alive connections will only be used if they are specifically requested by a client. In addition, a Keep-Alive connection with an HTTP/1.0 client can only be used when the length of the content is known in advance. This implies that dynamic content such as CGI output, SSI pages, and server-generated directory listings will generally not use Keep-Alive connections to HTTP/1.0 clients. For HTTP/1.1 clients, persistent connections are the default unless otherwise specified. If the client requests it, chunked encoding will be used in order to send content of unknown length over persistent connections.</p> <p>When a client uses a Keep-Alive connection, it will be counted as a single \"request\" for the <code class=\"directive\"><a href=\"mpm_common#maxconnectionsperchild\">MaxConnectionsPerChild</a></code> directive, regardless of how many requests are sent using the connection.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#maxkeepaliverequests\">MaxKeepAliveRequests</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"keepalivetimeout\">KeepAliveTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Amount of time the server will wait for subsequent requests on a persistent connection</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>KeepAliveTimeout num[ms]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>KeepAliveTimeout 5</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The number of seconds Apache httpd will wait for a subsequent request before closing the connection. By adding a postfix of ms the timeout can be also set in milliseconds. Once a request has been received, the timeout value specified by the <code class=\"directive\"><a href=\"#timeout\">Timeout</a></code> directive applies.</p> <p>Setting <code class=\"directive\">KeepAliveTimeout</code> to a high value may cause performance problems in heavily loaded servers. The higher the timeout, the more server processes will be kept occupied waiting on connections with idle clients.</p> <p>If <code class=\"directive\">KeepAliveTimeout</code> is <strong>not</strong> set for a name-based virtual host, the value of the first defined virtual host best matching the local IP and port will be used.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"limit\">&lt;Limit&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Restrict enclosed access controls to only certain HTTP methods</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;Limit method [method] ... &gt; ... &lt;/Limit&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig, Limit</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>Access controls are normally effective for <strong>all</strong> access methods, and this is the usual desired behavior. <strong>In the general case, access control directives should not be placed within a <code class=\"directive\">&lt;Limit&gt;</code> section.</strong></p> <p>The purpose of the <code class=\"directive\">&lt;Limit&gt;</code> directive is to restrict the effect of the access controls to the nominated HTTP methods. For all other methods, the access restrictions that are enclosed in the <code class=\"directive\">&lt;Limit&gt;</code> bracket <strong>will have no effect</strong>. The following example applies the access control only to the methods <code>POST</code>, <code>PUT</code>, and <code>DELETE</code>, leaving all other methods unprotected:</p> <pre class=\"prettyprint lang-config\">&lt;Limit POST PUT DELETE&gt;\n  Require valid-user\n&lt;/Limit&gt;</pre> <p>The method names listed can be one or more of: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, <code>CONNECT</code>, <code>OPTIONS</code>, <code>PATCH</code>, <code>PROPFIND</code>, <code>PROPPATCH</code>, <code>MKCOL</code>, <code>COPY</code>, <code>MOVE</code>, <code>LOCK</code>, and <code>UNLOCK</code>. <strong>The method name is case-sensitive.</strong> If <code>GET</code> is used, it will also restrict <code>HEAD</code> requests. The <code>TRACE</code> method cannot be limited (see <code class=\"directive\"><a href=\"#traceenable\">TraceEnable</a></code>).</p> <div class=\"warning\">A <code class=\"directive\"><a href=\"#limitexcept\">&lt;LimitExcept&gt;</a></code> section should always be used in preference to a <code class=\"directive\">&lt;Limit&gt;</code> section when restricting access, since a <code class=\"directive\"><a href=\"#limitexcept\">&lt;LimitExcept&gt;</a></code> section provides protection against arbitrary methods.</div> <p>The <code class=\"directive\">&lt;Limit&gt;</code> and <code class=\"directive\"><a href=\"#limitexcept\">&lt;LimitExcept&gt;</a></code> directives may be nested. In this case, each successive level of <code class=\"directive\">&lt;Limit&gt;</code> or <code class=\"directive\"><a href=\"#limitexcept\">&lt;LimitExcept&gt;</a></code> directives must further restrict the set of methods to which access controls apply.</p> <div class=\"warning\">When using <code class=\"directive\">&lt;Limit&gt;</code> or <code class=\"directive\">&lt;LimitExcept&gt;</code> directives with the <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directive, note that the first <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> to succeed authorizes the request, regardless of the presence of other <code class=\"directive\"><a href=\"mod_authz_core#require\">Require</a></code> directives.</div> <p>For example, given the following configuration, all users will be authorized for <code>POST</code> requests, and the <code>Require group editors</code> directive will be ignored in all cases:</p> <pre class=\"prettyprint lang-config\">&lt;LimitExcept GET&gt;\n  Require valid-user\n&lt;/LimitExcept&gt;\n&lt;Limit POST&gt;\n  Require group editors\n&lt;/Limit&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"limitexcept\">&lt;LimitExcept&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Restrict access controls to all HTTP methods except the named ones</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;LimitExcept method [method] ... &gt; ... &lt;/LimitExcept&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig, Limit</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p><code class=\"directive\">&lt;LimitExcept&gt;</code> and <code>&lt;/LimitExcept&gt;</code> are used to enclose a group of access control directives which will then apply to any HTTP access method <strong>not</strong> listed in the arguments; i.e., it is the opposite of a <code class=\"directive\"><a href=\"#limit\">&lt;Limit&gt;</a></code> section and can be used to control both standard and nonstandard/unrecognized methods. See the documentation for <code class=\"directive\"><a href=\"#limit\">&lt;Limit&gt;</a></code> for more details.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">&lt;LimitExcept POST GET&gt;\n  Require valid-user\n&lt;/LimitExcept&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"limitinternalrecursion\">LimitInternalRecursion Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determine maximum number of internal redirects and nested subrequests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LimitInternalRecursion number [number]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LimitInternalRecursion 10</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>An internal redirect happens, for example, when using the <code class=\"directive\"><a href=\"mod_actions#action\">Action</a></code> directive, which internally redirects the original request to a CGI script. A subrequest is Apache httpd's mechanism to find out what would happen for some URI if it were requested. For example, <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> uses subrequests to look for the files listed in the <code class=\"directive\"><a href=\"mod_dir#directoryindex\">DirectoryIndex</a></code> directive.</p> <p><code class=\"directive\">LimitInternalRecursion</code> prevents the server from crashing when entering an infinite loop of internal redirects or subrequests. Such loops are usually caused by misconfigurations.</p> <p>The directive stores two different limits, which are evaluated on per-request basis. The first <var>number</var> is the maximum number of internal redirects that may follow each other. The second <var>number</var> determines how deeply subrequests may be nested. If you specify only one <var>number</var>, it will be assigned to both limits.</p> <pre class=\"prettyprint lang-config\">LimitInternalRecursion 5</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"limitrequestbody\">LimitRequestBody Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Restricts the total size of the HTTP request body sent from the client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LimitRequestBody bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LimitRequestBody 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive specifies the number of <var>bytes</var> from 0 (meaning unlimited) to 2147483647 (2GB) that are allowed in a request body. See the note below for the limited applicability to proxy requests.</p> <p>The <code class=\"directive\">LimitRequestBody</code> directive allows the user to set a limit on the allowed size of an HTTP request message body within the context in which the directive is given (server, per-directory, per-file or per-location). If the client request exceeds that limit, the server will return an error response instead of servicing the request. The size of a normal request message body will vary greatly depending on the nature of the resource and the methods allowed on that resource. CGI scripts typically use the message body for retrieving form information. Implementations of the <code>PUT</code> method will require a value at least as large as any representation that the server wishes to accept for that resource.</p> <p>This directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks.</p> <p>If, for example, you are permitting file upload to a particular location and wish to limit the size of the uploaded file to 100K, you might use the following directive:</p> <pre class=\"prettyprint lang-config\">LimitRequestBody 102400</pre> <div class=\"note\">\n<p>For a full description of how this directive is interpreted by proxy requests, see the <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> documentation.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"limitrequestfields\">LimitRequestFields Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limits the number of HTTP request header fields that will be accepted from the client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LimitRequestFields number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LimitRequestFields 100</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p><var>Number</var> is an integer from 0 (meaning unlimited) to 32767. The default value is defined by the compile-time constant <code>DEFAULT_LIMIT_REQUEST_FIELDS</code> (100 as distributed).</p> <p>The <code class=\"directive\">LimitRequestFields</code> directive allows the server administrator to modify the limit on the number of request header fields allowed in an HTTP request. A server needs this value to be larger than the number of fields that a normal client request might include. The number of request header fields used by a client rarely exceeds 20, but this may vary among different client implementations, often depending upon the extent to which a user has configured their browser to support detailed content negotiation. Optional HTTP extensions are often expressed using request header fields.</p> <p>This directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks. The value should be increased if normal clients see an error response from the server that indicates too many fields were sent in the request.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">LimitRequestFields 50</pre> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p> When name-based virtual hosting is used, the value for this directive is taken from the default (first-listed) virtual host for the local IP and port combination.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"limitrequestfieldsize\">LimitRequestFieldSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limits the size of the HTTP request header allowed from the client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LimitRequestFieldSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LimitRequestFieldSize 8190</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive specifies the number of <var>bytes</var> that will be allowed in an HTTP request header.</p> <p>The <code class=\"directive\">LimitRequestFieldSize</code> directive allows the server administrator to set the limit on the allowed size of an HTTP request header field. A server needs this value to be large enough to hold any one header field from a normal client request. The size of a normal request header field will vary greatly among different client implementations, often depending upon the extent to which a user has configured their browser to support detailed content negotiation. SPNEGO authentication headers can be up to 12392 bytes.</p> <p>This directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">LimitRequestFieldSize 4094</pre> <div class=\"note\">Under normal conditions, the value should not be changed from the default.</div> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p> When name-based virtual hosting is used, the value for this directive is taken from the default (first-listed) virtual host best matching the current IP address and port combination.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"limitrequestline\">LimitRequestLine Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limit the size of the HTTP request line that will be accepted from the client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LimitRequestLine bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LimitRequestLine 8190</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive sets the number of <var>bytes</var> that will be allowed on the HTTP request-line.</p> <p>The <code class=\"directive\">LimitRequestLine</code> directive allows the server administrator to set the limit on the allowed size of a client's HTTP request-line. Since the request-line consists of the HTTP method, URI, and protocol version, the <code class=\"directive\">LimitRequestLine</code> directive places a restriction on the length of a request-URI allowed for a request on the server. A server needs this value to be large enough to hold any of its resource names, including any information that might be passed in the query part of a <code>GET</code> request.</p> <p>This directive gives the server administrator greater control over abnormal client request behavior, which may be useful for avoiding some forms of denial-of-service attacks.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">LimitRequestLine 4094</pre> <div class=\"note\">Under normal conditions, the value should not be changed from the default.</div> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p> When name-based virtual hosting is used, the value for this directive is taken from the default (first-listed) virtual host best matching the current IP address and port combination.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"limitxmlrequestbody\">LimitXMLRequestBody Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limits the size of an XML-based request body</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LimitXMLRequestBody bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LimitXMLRequestBody 1000000</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>Limit (in bytes) on maximum size of an XML-based request body. A value of <code>0</code> will disable any checking.</p> <p>Example:</p> <pre class=\"prettyprint lang-config\">LimitXMLRequestBody 0</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"location\">&lt;Location&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Applies the enclosed directives only to matching URLs</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;Location URL-path|URL&gt; ... &lt;/Location&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;Location&gt;</code> directive limits the scope of the enclosed directives by URL. It is similar to the <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> directive, and starts a subsection which is terminated with a <code>&lt;/Location&gt;</code> directive. <code class=\"directive\">&lt;Location&gt;</code> sections are processed in the order they appear in the configuration file, after the <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections and <code>.htaccess</code> files are read, and after the <code class=\"directive\"><a href=\"#files\">&lt;Files&gt;</a></code> sections.</p> <p><code class=\"directive\">&lt;Location&gt;</code> sections operate completely outside the filesystem. This has several consequences. Most importantly, <code class=\"directive\">&lt;Location&gt;</code> directives should not be used to control access to filesystem locations. Since several different URLs may map to the same filesystem location, such access controls may by circumvented.</p> <p>The enclosed directives will be applied to the request if the path component of the URL meets <em>any</em> of the following criteria: </p> <ul> <li>The specified location matches exactly the path component of the URL. </li> <li>The specified location, which ends in a forward slash, is a prefix of the path component of the URL (treated as a context root). </li> <li>The specified location, with the addition of a trailing slash, is a prefix of the path component of the URL (also treated as a context root). </li> </ul> <p> In the example below, where no trailing slash is used, requests to /private1, /private1/ and /private1/file.txt will have the enclosed directives applied, but /private1other would not. </p> <pre class=\"prettyprint lang-config\">&lt;Location \"/private1\"&gt;\n    #  ...\n&lt;/Location&gt;</pre> <p> In the example below, where a trailing slash is used, requests to /private2/ and /private2/file.txt will have the enclosed directives applied, but /private2 and /private2other would not. </p> <pre class=\"prettyprint lang-config\">&lt;Location \"/private2<em>/</em>\"&gt;\n    # ...\n&lt;/Location&gt;</pre> <div class=\"note\">\n<p><strong>When to use <code class=\"directive\">&lt;Location&gt;</code></strong></p> <p>Use <code class=\"directive\">&lt;Location&gt;</code> to apply directives to content that lives outside the filesystem. For content that lives in the filesystem, use <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> and <code class=\"directive\"><a href=\"#files\">&lt;Files&gt;</a></code>. An exception is <code>&lt;Location \"/\"&gt;</code>, which is an easy way to apply a configuration to the entire server.</p> </div> <p>For all origin (non-proxy) requests, the URL to be matched is a URL-path of the form <code>/path/</code>. <em>No scheme, hostname, port, or query string may be included.</em> For proxy requests, the URL to be matched is of the form <code>scheme://servername/path</code>, and you must include the prefix.</p> <p>The URL may use wildcards. In a wild-card string, <code>?</code> matches any single character, and <code>*</code> matches any sequences of characters. Neither wildcard character matches a / in the URL-path.</p> <p><a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">Regular expressions</a> can also be used, with the addition of the <code>~</code> character. For example:</p> <pre class=\"prettyprint lang-config\">&lt;Location ~ \"/(extra|special)/data\"&gt;\n    #...\n&lt;/Location&gt;</pre> <p>would match URLs that contained the substring <code>/extra/data</code> or <code>/special/data</code>. The directive <code class=\"directive\"><a href=\"#locationmatch\">&lt;LocationMatch&gt;</a></code> behaves identical to the regex version of <code class=\"directive\">&lt;Location&gt;</code>, and is preferred, for the simple reason that <code>~</code> is hard to distinguish from <code>-</code> in many fonts.</p> <p>The <code class=\"directive\">&lt;Location&gt;</code> functionality is especially useful when combined with the <code class=\"directive\"><a href=\"#sethandler\">SetHandler</a></code> directive. For example, to enable status requests but allow them only from browsers at <code>example.com</code>, you might use:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/status\"&gt;\n  SetHandler server-status\n  Require host example.com\n&lt;/Location&gt;</pre> <div class=\"note\">\n<p><strong>Note about / (slash)</strong></p> <p>The slash character has special meaning depending on where in a URL it appears. People may be used to its behavior in the filesystem where multiple adjacent slashes are frequently collapsed to a single slash (<em>i.e.</em>, <code>/home///foo</code> is the same as <code>/home/foo</code>). In URL-space this is not necessarily true. The <code class=\"directive\"><a href=\"#locationmatch\">&lt;LocationMatch&gt;</a></code> directive and the regex version of <code class=\"directive\">&lt;Location&gt;</code> require you to explicitly specify multiple slashes if that is your intention.</p> <p>For example, <code>&lt;LocationMatch \"^/abc\"&gt;</code> would match the request URL <code>/abc</code> but not the request URL <code>//abc</code>. The (non-regex) <code class=\"directive\">&lt;Location&gt;</code> directive behaves similarly when used for proxy requests. But when (non-regex) <code class=\"directive\">&lt;Location&gt;</code> is used for non-proxy requests it will implicitly match multiple slashes with a single slash. For example, if you specify <code>&lt;Location \"/abc/def\"&gt;</code> and the request is to <code>/abc//def</code> then it will match.</p> </div> <h3>See also</h3> <ul> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt; and &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received.</li> <li><code class=\"directive\"><a href=\"#locationmatch\">LocationMatch</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"locationmatch\">&lt;LocationMatch&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Applies the enclosed directives only to regular-expression matching URLs</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;LocationMatch regex&gt; ... &lt;/LocationMatch&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;LocationMatch&gt;</code> directive limits the scope of the enclosed directives by URL, in an identical manner to <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code>. However, it takes a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> as an argument instead of a simple string. For example:</p> <pre class=\"prettyprint lang-config\">&lt;LocationMatch \"/(extra|special)/data\"&gt;\n    # ...\n&lt;/LocationMatch&gt;</pre> <p>would match URLs that contained the substring <code>/extra/data</code> or <code>/special/data</code>.</p> <div class=\"note\">\n<p>If the intent is that a URL <strong>starts with</strong> <code>/extra/data</code>, rather than merely <strong>contains</strong> <code>/extra/data</code>, prefix the regular expression with a <code>^</code> to require this.</p> <pre class=\"prettyprint lang-config\">&lt;LocationMatch \"^/(extra|special)/data\"&gt;</pre> </div> <p>From 2.4.8 onwards, named groups and backreferences are captured and written to the environment with the corresponding name prefixed with \"MATCH_\" and in upper case. This allows elements of URLs to be referenced from within <a href=\"../expr\">expressions</a> and modules like <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>. In order to prevent confusion, numbered (unnamed) backreferences are ignored. Use named groups instead.</p> <pre class=\"prettyprint lang-config\">&lt;LocationMatch \"^/combined/(?&lt;sitename&gt;[^/]+)\"&gt;\n    require ldap-group cn=%{env:MATCH_SITENAME},ou=combined,o=Example\n&lt;/LocationMatch&gt;</pre> <h3>See also</h3> <ul> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt; and &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"loglevel\">LogLevel Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls the verbosity of the ErrorLog</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LogLevel [module:]level [module:level] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LogLevel warn</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Per-module and per-directory configuration is available in Apache HTTP Server 2.3.6 and later</td>\n</tr> </table> <p><code class=\"directive\">LogLevel</code> adjusts the verbosity of the messages recorded in the error logs (see <code class=\"directive\"><a href=\"#errorlog\">ErrorLog</a></code> directive). The following <var>level</var>s are available, in order of decreasing significance:</p> <table class=\"bordered\"> <tr> <th>\n<strong>Level</strong> </th> <th>\n<strong>Description</strong> </th> <th>\n<strong>Example</strong> </th> </tr> <tr> <td>\n<code>emerg</code> </td> <td>Emergencies - system is unusable.</td> <td>\"Child cannot open lock file. Exiting\"</td> </tr> <tr> <td>\n<code>alert</code> </td> <td>Action must be taken immediately.</td> <td>\"getpwuid: couldn't determine user name from uid\"</td> </tr> <tr> <td>\n<code>crit</code> </td> <td>Critical Conditions.</td> <td>\"socket: Failed to get a socket, exiting child\"</td> </tr> <tr> <td>\n<code>error</code> </td> <td>Error conditions.</td> <td>\"Premature end of script headers\"</td> </tr> <tr> <td>\n<code>warn</code> </td> <td>Warning conditions.</td> <td>\"child process 1234 did not exit, sending another SIGHUP\"</td> </tr> <tr> <td>\n<code>notice</code> </td> <td>Normal but significant condition.</td> <td>\"httpd: caught SIGBUS, attempting to dump core in ...\"</td> </tr> <tr> <td>\n<code>info</code> </td> <td>Informational.</td> <td>\"Server seems busy, (you may need to increase StartServers, or Min/MaxSpareServers)...\"</td> </tr> <tr> <td>\n<code>debug</code> </td> <td>Debug-level messages</td> <td>\"Opening config file ...\"</td> </tr> <tr> <td>\n<code>trace1</code> </td> <td>Trace messages</td> <td>\"proxy: FTP: control connection complete\"</td> </tr> <tr> <td>\n<code>trace2</code> </td> <td>Trace messages</td> <td>\"proxy: CONNECT: sending the CONNECT request to the remote proxy\"</td> </tr> <tr> <td>\n<code>trace3</code> </td> <td>Trace messages</td> <td>\"openssl: Handshake: start\"</td> </tr> <tr> <td>\n<code>trace4</code> </td> <td>Trace messages</td> <td>\"read from buffered SSL brigade, mode 0, 17 bytes\"</td> </tr> <tr> <td>\n<code>trace5</code> </td> <td>Trace messages</td> <td>\"map lookup FAILED: map=rewritemap key=keyname\"</td> </tr> <tr> <td>\n<code>trace6</code> </td> <td>Trace messages</td> <td>\"cache lookup FAILED, forcing new map lookup\"</td> </tr> <tr> <td>\n<code>trace7</code> </td> <td>Trace messages, dumping large amounts of data</td> <td>\"| 0000: 02 23 44 30 13 40 ac 34 df 3d bf 9a 19 49 39 15 |\"</td> </tr> <tr> <td>\n<code>trace8</code> </td> <td>Trace messages, dumping large amounts of data</td> <td>\"| 0000: 02 23 44 30 13 40 ac 34 df 3d bf 9a 19 49 39 15 |\"</td> </tr> </table> <p>When a particular level is specified, messages from all other levels of higher significance will be reported as well. <em>E.g.</em>, when <code>LogLevel info</code> is specified, then messages with log levels of <code>notice</code> and <code>warn</code> will also be posted.</p> <p>Using a level of at least <code>crit</code> is recommended.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">LogLevel notice</pre> <div class=\"note\">\n<p><strong>Note</strong></p> <p>When logging to a regular file, messages of the level <code>notice</code> cannot be suppressed and thus are always logged. However, this doesn't apply when logging is done using <code>syslog</code>.</p> </div> <p>Specifying a level without a module name will reset the level for all modules to that level. Specifying a level with a module name will set the level for that module only. It is possible to use the module source file name, the module identifier, or the module identifier with the trailing <code>_module</code> omitted as module specification. This means the following three specifications are equivalent:</p> <pre class=\"prettyprint lang-config\">LogLevel info ssl:warn\nLogLevel info mod_ssl.c:warn\nLogLevel info ssl_module:warn</pre> <p>It is also possible to change the level per directory:</p> <pre class=\"prettyprint lang-config\">LogLevel info\n&lt;Directory \"/usr/local/apache/htdocs/app\"&gt;\n  LogLevel debug\n&lt;/Directory&gt;</pre> <div class=\"note\"> Per directory loglevel configuration only affects messages that are logged after the request has been parsed and that are associated with the request. Log messages which are associated with the connection or the server are not affected. </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#errorlog\">ErrorLog</a></code></li> <li><code class=\"directive\"><a href=\"#errorlogformat\">ErrorLogFormat</a></code></li> <li><a href=\"../logs\">Apache HTTP Server Log Files</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"maxkeepaliverequests\">MaxKeepAliveRequests Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of requests allowed on a persistent connection</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxKeepAliveRequests number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxKeepAliveRequests 100</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">MaxKeepAliveRequests</code> directive limits the number of requests allowed per connection when <code class=\"directive\"><a href=\"#keepalive\">KeepAlive</a></code> is on. If it is set to <code>0</code>, unlimited requests will be allowed. We recommend that this setting be kept to a high value for maximum server performance.</p> <p>For example:</p> <pre class=\"prettyprint lang-config\">MaxKeepAliveRequests 500</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"maxrangeoverlaps\">MaxRangeOverlaps Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of overlapping ranges (eg: <code>100-200,150-300</code>) allowed before returning the complete resource </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxRangeOverlaps default | unlimited | none | number-of-ranges</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxRangeOverlaps 20</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.15 and later</td>\n</tr> </table> <p>The <code class=\"directive\">MaxRangeOverlaps</code> directive limits the number of overlapping HTTP ranges the server is willing to return to the client. If more overlapping ranges than permitted are requested, the complete resource is returned instead.</p> <dl> <dt><strong>default</strong></dt> <dd>Limits the number of overlapping ranges to a compile-time default of 20.</dd> <dt><strong>none</strong></dt> <dd>No overlapping Range headers are allowed.</dd> <dt><strong>unlimited</strong></dt> <dd>The server does not limit the number of overlapping ranges it is willing to satisfy.</dd> <dt><var>number-of-ranges</var></dt> <dd>A positive number representing the maximum number of overlapping ranges the server is willing to satisfy.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"maxrangereversals\">MaxRangeReversals Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of range reversals (eg: <code>100-200,50-70</code>) allowed before returning the complete resource </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxRangeReversals default | unlimited | none | number-of-ranges</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxRangeReversals 20</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.15 and later</td>\n</tr> </table> <p>The <code class=\"directive\">MaxRangeReversals</code> directive limits the number of HTTP Range reversals the server is willing to return to the client. If more ranges reversals than permitted are requested, the complete resource is returned instead.</p> <dl> <dt><strong>default</strong></dt> <dd>Limits the number of range reversals to a compile-time default of 20.</dd> <dt><strong>none</strong></dt> <dd>No Range reversals headers are allowed.</dd> <dt><strong>unlimited</strong></dt> <dd>The server does not limit the number of range reversals it is willing to satisfy.</dd> <dt><var>number-of-ranges</var></dt> <dd>A positive number representing the maximum number of range reversals the server is willing to satisfy.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"maxranges\">MaxRanges Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of ranges allowed before returning the complete resource </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MaxRanges default | unlimited | none | number-of-ranges</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MaxRanges 200</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.15 and later</td>\n</tr> </table> <p>The <code class=\"directive\">MaxRanges</code> directive limits the number of HTTP ranges the server is willing to return to the client. If more ranges than permitted are requested, the complete resource is returned instead.</p> <dl> <dt><strong>default</strong></dt> <dd>Limits the number of ranges to a compile-time default of 200.</dd> <dt><strong>none</strong></dt> <dd>Range headers are ignored.</dd> <dt><strong>unlimited</strong></dt> <dd>The server does not limit the number of ranges it is willing to satisfy.</dd> <dt><var>number-of-ranges</var></dt> <dd>A positive number representing the maximum number of ranges the server is willing to satisfy.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"mergetrailers\">MergeTrailers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether trailers are merged into headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MergeTrailers [on|off]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MergeTrailers off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>2.4.11 and later</td>\n</tr> </table> <p>This directive controls whether HTTP trailers are copied into the internal representation of HTTP headers. This merging occurs when the request body has been completely consumed, long after most header processing would have a chance to examine or modify request headers.</p> <p>This option is provided for compatibility with releases prior to 2.4.11, where trailers were always merged.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"mutex\">Mutex Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures mutex mechanism and lock file directory for all or specified mutexes</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Mutex mechanism [default|mutex-name] ... [OmitPID]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Mutex default</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.3.4 and later</td>\n</tr> </table> <p>The <code class=\"directive\">Mutex</code> directive sets the mechanism, and optionally the lock file location, that httpd and modules use to serialize access to resources. Specify <code>default</code> as the second argument to change the settings for all mutexes; specify a mutex name (see table below) as the second argument to override defaults only for that mutex.</p> <p>The <code class=\"directive\">Mutex</code> directive is typically used in the following exceptional situations:</p> <ul> <li>change the mutex mechanism when the default mechanism selected by <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> has a functional or performance problem</li> <li>change the directory used by file-based mutexes when the default directory does not support locking</li> </ul> <div class=\"note\">\n<p><strong>Supported modules</strong></p> <p>This directive only configures mutexes which have been registered with the core server using the <code>ap_mutex_register()</code> API. All modules bundled with httpd support the <code class=\"directive\">Mutex</code> directive, but third-party modules may not. Consult the documentation of the third-party module, which must indicate the mutex name(s) which can be configured if this directive is supported.</p> </div> <p>The following mutex <em>mechanisms</em> are available:</p> <ul> <li>\n<code>default | yes</code> <p>This selects the default locking implementation, as determined by <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a>. The default locking implementation can be displayed by running <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> with the <code>-V</code> option.</p>\n</li> <li>\n<code>none | no</code> <p>This effectively disables the mutex, and is only allowed for a mutex if the module indicates that it is a valid choice. Consult the module documentation for more information.</p>\n</li> <li>\n<code>posixsem</code> <p>This is a mutex variant based on a Posix semaphore.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>The semaphore ownership is not recovered if a thread in the process holding the mutex segfaults, resulting in a hang of the web server.</p> </div> </li> <li>\n<code>sysvsem</code> <p>This is a mutex variant based on a SystemV IPC semaphore.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>It is possible to \"leak\" SysV semaphores if processes crash before the semaphore is removed.</p> </div> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>The semaphore API allows for a denial of service attack by any CGIs running under the same uid as the webserver (<em>i.e.</em>, all CGIs, unless you use something like <code class=\"program\"><a href=\"../programs/suexec\">suexec</a></code> or <code>cgiwrapper</code>).</p> </div> </li> <li>\n<code>sem</code> <p>This selects the \"best\" available semaphore implementation, choosing between Posix and SystemV IPC semaphores, in that order.</p>\n</li> <li>\n<code>pthread</code> <p>This is a mutex variant based on cross-process Posix thread mutexes.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>On most systems, if a child process terminates abnormally while holding a mutex that uses this implementation, the server will deadlock and stop responding to requests. When this occurs, the server will require a manual restart to recover.</p> <p>Solaris and Linux are notable exceptions as they provide a mechanism which usually allows the mutex to be recovered after a child process terminates abnormally while holding a mutex.</p> <p>If your system is POSIX compliant or if it implements the <code>pthread_mutexattr_setrobust_np()</code> function, you may be able to use the <code>pthread</code> option safely.</p> </div> </li> <li>\n<code>fcntl:/path/to/mutex</code> <p>This is a mutex variant where a physical (lock-)file and the <code>fcntl()</code> function are used as the mutex.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>When multiple mutexes based on this mechanism are used within multi-threaded, multi-process environments, deadlock errors (EDEADLK) can be reported for valid mutex operations if <code>fcntl()</code> is not thread-aware, such as on Solaris.</p> </div> </li> <li>\n<code>flock:/path/to/mutex</code> <p>This is similar to the <code>fcntl:/path/to/mutex</code> method with the exception that the <code>flock()</code> function is used to provide file locking.</p>\n</li> <li>\n<code>file:/path/to/mutex</code> <p>This selects the \"best\" available file locking implementation, choosing between <code>fcntl</code> and <code>flock</code>, in that order.</p>\n</li> </ul> <p>Most mechanisms are only available on selected platforms, where the underlying platform and <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> support it. Mechanisms which aren't available on all platforms are <em>posixsem</em>, <em>sysvsem</em>, <em>sem</em>, <em>pthread</em>, <em>fcntl</em>, <em>flock</em>, and <em>file</em>.</p> <p>With the file-based mechanisms <em>fcntl</em> and <em>flock</em>, the path, if provided, is a directory where the lock file will be created. The default directory is httpd's run-time file directory relative to <code class=\"directive\"><a href=\"#serverroot\">ServerRoot</a></code>. Always use a local disk filesystem for <code>/path/to/mutex</code> and never a directory residing on a NFS- or AFS-filesystem. The basename of the file will be the mutex type, an optional instance string provided by the module, and unless the <code>OmitPID</code> keyword is specified, the process id of the httpd parent process will be appended to make the file name unique, avoiding conflicts when multiple httpd instances share a lock file directory. For example, if the mutex name is <code>mpm-accept</code> and the lock file directory is <code>/var/httpd/locks</code>, the lock file name for the httpd instance with parent process id 12345 would be <code>/var/httpd/locks/mpm-accept.12345</code>.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>It is best to <em>avoid</em> putting mutex files in a world-writable directory such as <code>/var/tmp</code> because someone could create a denial of service attack and prevent the server from starting by creating a lockfile with the same name as the one the server will try to create.</p> </div> <p>The following table documents the names of mutexes used by httpd and bundled modules.</p> <table class=\"bordered\">\n<tr class=\"header\"> <th>Mutex name</th> <th>Module(s)</th> <th>Protected resource</th> </tr> <tr> <td><code>mpm-accept</code></td> <td>\n<code class=\"module\"><a href=\"prefork\">prefork</a></code> and <code class=\"module\"><a href=\"worker\">worker</a></code> MPMs</td> <td>incoming connections, to avoid the thundering herd problem; for more information, refer to the <a href=\"../misc/perf-tuning\">performance tuning</a> documentation</td> </tr> <tr class=\"odd\"> <td><code>authdigest-client</code></td> <td><code class=\"module\">mod_auth_digest</code></td> <td>client list in shared memory</td> </tr> <tr> <td><code>authdigest-opaque</code></td> <td><code class=\"module\">mod_auth_digest</code></td> <td>counter in shared memory</td> </tr> <tr class=\"odd\"> <td><code>ldap-cache</code></td> <td><code class=\"module\">mod_ldap</code></td> <td>LDAP result cache</td> </tr> <tr> <td><code>rewrite-map</code></td> <td><code class=\"module\">mod_rewrite</code></td> <td>communication with external mapping programs, to avoid intermixed I/O from multiple requests</td> </tr> <tr class=\"odd\"> <td><code>ssl-cache</code></td> <td><code class=\"module\">mod_ssl</code></td> <td>SSL session cache</td> </tr> <tr> <td><code>ssl-stapling</code></td> <td><code class=\"module\">mod_ssl</code></td> <td>OCSP stapling response cache</td> </tr> <tr class=\"odd\"> <td><code>watchdog-callback</code></td> <td><code class=\"module\">mod_watchdog</code></td> <td>callback function of a particular client module</td> </tr> </table> <p>The <code>OmitPID</code> keyword suppresses the addition of the httpd parent process id from the lock file name.</p> <p>In the following example, the mutex mechanism for the MPM accept mutex will be changed from the compiled-in default to <code>fcntl</code>, with the associated lock file created in directory <code>/var/httpd/locks</code>. The mutex mechanism for all other mutexes will be changed from the compiled-in default to <code>sysvsem</code>.</p> <pre class=\"prettyprint lang-config\">Mutex sysvsem default\nMutex fcntl:/var/httpd/locks mpm-accept</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"namevirtualhost\">NameVirtualHost Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>DEPRECATED: Designates an IP address for name-virtual hosting</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>NameVirtualHost addr[:port]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>Prior to 2.3.11, <code class=\"directive\">NameVirtualHost</code> was required to instruct the server that a particular IP address and port combination was usable as a name-based virtual host. In 2.3.11 and later, any time an IP address and port combination is used in multiple virtual hosts, name-based virtual hosting is automatically enabled for that address.</p> <p>This directive currently has no effect.</p> <h3>See also</h3> <ul> <li><a href=\"../vhosts/index\">Virtual Hosts documentation</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"options\">Options Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures what features are available in a particular directory</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Options [+|-]option [[+|-]option] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Options FollowSymlinks</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The default was changed from All to FollowSymlinks in 2.3.11</td>\n</tr> </table> <p>The <code class=\"directive\">Options</code> directive controls which server features are available in a particular directory.</p> <p><var>option</var> can be set to <code>None</code>, in which case none of the extra features are enabled, or one or more of the following:</p> <dl> <dt><code>All</code></dt> <dd>All options except for <code>MultiViews</code>.</dd> <dt><code>ExecCGI</code></dt> <dd> Execution of CGI scripts using <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> is permitted.</dd> <dt><code>FollowSymLinks</code></dt> <dd> The server will follow symbolic links in this directory. This is the default setting. <div class=\"note\"> <p>Even though the server follows the symlink it does <em>not</em> change the pathname used to match against <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections.</p> <p>The <code>FollowSymLinks</code> and <code>SymLinksIfOwnerMatch</code> <code class=\"directive\"><a href=\"#options\">Options</a></code> work only in <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections or <code>.htaccess</code> files.</p> <p>Omitting this option should not be considered a security restriction, since symlink testing is subject to race conditions that make it circumventable.</p> </div>\n</dd> <dt><code>Includes</code></dt> <dd> Server-side includes provided by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> are permitted.</dd> <dt><code>IncludesNOEXEC</code></dt> <dd> Server-side includes are permitted, but the <code>#exec cmd</code> and <code>#exec cgi</code> are disabled. It is still possible to <code>#include virtual</code> CGI scripts from <code class=\"directive\"><a href=\"mod_alias#scriptalias\">ScriptAlias</a></code>ed directories.</dd> <dt><code>Indexes</code></dt> <dd> If a URL which maps to a directory is requested and there is no <code class=\"directive\"><a href=\"mod_dir#directoryindex\">DirectoryIndex</a></code> (<em>e.g.</em>, <code>index.html</code>) in that directory, then <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code> will return a formatted listing of the directory.</dd> <dt><code>MultiViews</code></dt> <dd> <a href=\"../content-negotiation\">Content negotiated</a> \"MultiViews\" are allowed using <code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code>. <div class=\"note\">\n<p><strong>Note</strong></p> <p>This option gets ignored if set anywhere other than <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code>, as <code class=\"module\"><a href=\"mod_negotiation\">mod_negotiation</a></code> needs real resources to compare against and evaluate from.</p>\n</div> </dd> <dt><code>SymLinksIfOwnerMatch</code></dt> <dd>The server will only follow symbolic links for which the target file or directory is owned by the same user id as the link. <div class=\"note\">\n<p><strong>Note</strong></p> <p>The <code>FollowSymLinks</code> and <code>SymLinksIfOwnerMatch</code> <code class=\"directive\"><a href=\"#options\">Options</a></code> work only in <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> sections or <code>.htaccess</code> files.</p> <p>This option should not be considered a security restriction, since symlink testing is subject to race conditions that make it circumventable.</p> </div> </dd> </dl> <p>Normally, if multiple <code class=\"directive\">Options</code> could apply to a directory, then the most specific one is used and others are ignored; the options are not merged. (See <a href=\"../sections#merging\">how sections are merged</a>.) However if <em>all</em> the options on the <code class=\"directive\">Options</code> directive are preceded by a <code>+</code> or <code>-</code> symbol, the options are merged. Any options preceded by a <code>+</code> are added to the options currently in force, and any options preceded by a <code>-</code> are removed from the options currently in force. </p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Mixing <code class=\"directive\">Options</code> with a <code>+</code> or <code>-</code> with those without is not valid syntax and will be rejected during server startup by the syntax check with an abort.</p> </div> <p>For example, without any <code>+</code> and <code>-</code> symbols:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/web/docs\"&gt;\n  Options Indexes FollowSymLinks\n&lt;/Directory&gt;\n\n&lt;Directory \"/web/docs/spec\"&gt;\n  Options Includes\n&lt;/Directory&gt;</pre> <p>then only <code>Includes</code> will be set for the <code>/web/docs/spec</code> directory. However if the second <code class=\"directive\">Options</code> directive uses the <code>+</code> and <code>-</code> symbols:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/web/docs\"&gt;\n  Options Indexes FollowSymLinks\n&lt;/Directory&gt;\n\n&lt;Directory \"/web/docs/spec\"&gt;\n  Options +Includes -Indexes\n&lt;/Directory&gt;</pre> <p>then the options <code>FollowSymLinks</code> and <code>Includes</code> are set for the <code>/web/docs/spec</code> directory.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Using <code>-IncludesNOEXEC</code> or <code>-Includes</code> disables server-side includes completely regardless of the previous setting.</p> </div> <p>The default in the absence of any other settings is <code>FollowSymlinks</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"protocol\">Protocol Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Protocol for a listening socket</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Protocol protocol</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.1.5 and later. On Windows, from Apache 2.3.3 and later.</td>\n</tr> </table> <p>This directive specifies the protocol used for a specific listening socket. The protocol is used to determine which module should handle a request and to apply protocol specific optimizations with the <code class=\"directive\">AcceptFilter</code> directive.</p> <p>You only need to set the protocol if you are running on non-standard ports; otherwise, <code>http</code> is assumed for port 80 and <code>https</code> for port 443.</p> <p>For example, if you are running <code>https</code> on a non-standard port, specify the protocol explicitly:</p> <pre class=\"prettyprint lang-config\">Protocol https</pre> <p>You can also specify the protocol using the <code class=\"directive\"><a href=\"mpm_common#listen\">Listen</a></code> directive.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#acceptfilter\">AcceptFilter</a></code></li> <li><code class=\"directive\"><a href=\"mpm_common#listen\">Listen</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"protocols\">Protocols Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Protocols available for a server/virtual host</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Protocols protocol ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Protocols http/1.1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Only available from Apache 2.4.17 and later.</td>\n</tr> </table> <p>This directive specifies the list of protocols supported for a server/virtual host. The list determines the allowed protocols a client may negotiate for this server/host.</p> <p>You need to set protocols if you want to extend the available protocols for a server/host. By default, only the http/1.1 protocol (which includes the compatibility with 1.0 and 0.9 clients) is allowed.</p> <p>For example, if you want to support HTTP/2 for a server with TLS, specify:</p> <pre class=\"prettyprint lang-config\">Protocols h2 http/1.1</pre> <p>Valid protocols are <code>http/1.1</code> for http and https connections, <code>h2</code> on https connections and <code>h2c</code> for http connections. Modules may enable more protocols.</p> <p>It is safe to specify protocols that are unavailable/disabled. Such protocol names will simply be ignored.</p> <p>Protocols specified in base servers are inherited for virtual hosts only if the virtual host has no own Protocols directive. Or, the other way around, Protocols directives in virtual hosts replace any such directive in the base server. </p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#protocolshonororder\">ProtocolsHonorOrder</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"protocolshonororder\">ProtocolsHonorOrder Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines if order of Protocols determines precedence during negotiation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProtocolsHonorOrder On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProtocolsHonorOrder On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Only available from Apache 2.4.17 and later.</td>\n</tr> </table> <p>This directive specifies if the server should honor the order in which the <code class=\"directive\">Protocols</code> directive lists protocols.</p> <p>If configured Off, the client supplied list order of protocols has precedence over the order in the server configuration.</p> <p>With <code class=\"directive\">ProtocolsHonorOrder</code> set to <code>on</code> (default), the client ordering does not matter and only the ordering in the server settings influences the outcome of the protocol negotiation.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#protocols\">Protocols</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"qualifyredirecturl\">QualifyRedirectURL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls whether the REDIRECT_URL environment variable is fully qualified</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>QualifyRedirectURL ON|OFF</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>QualifyRedirectURL OFF</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Directive supported in 2.4.18 and later. 2.4.17 acted as if 'QualifyRedirectURL ON' was configured.</td>\n</tr> </table> <p>This directive controls whether the server will ensure that the REDIRECT_URL environment variable is fully qualified. By default, the variable contains the verbatim URL requested by the client, such as \"/index.html\". With <code class=\"directive\"><a href=\"#qualifyredirecturl%20on\">QualifyRedirectURL ON</a></code>, the same request would result in a value such as \"http://www.example.com/index.html\".</p> <p>Even without this directive set, when a request is issued against a fully qualified URL, REDIRECT_URL will remain fully qualified. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"rlimitcpu\">RLimitCPU Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limits the CPU consumption of processes launched by Apache httpd children</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RLimitCPU seconds|max [seconds|max]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Unset; uses operating system defaults</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>Takes 1 or 2 parameters. The first parameter sets the soft resource limit for all processes and the second parameter sets the maximum resource limit. Either parameter can be a number, or <code>max</code> to indicate to the server that the limit should be set to the maximum allowed by the operating system configuration. Raising the maximum resource limit requires that the server is running as <code>root</code> or in the initial startup phase.</p> <p>This applies to processes forked from Apache httpd children servicing requests, not the Apache httpd children themselves. This includes CGI scripts and SSI exec commands, but not any processes forked from the Apache httpd parent, such as piped logs.</p> <p>CPU resource limits are expressed in seconds per process.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#rlimitmem\">RLimitMEM</a></code></li> <li><code class=\"directive\"><a href=\"#rlimitnproc\">RLimitNPROC</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"rlimitmem\">RLimitMEM Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limits the memory consumption of processes launched by Apache httpd children</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RLimitMEM bytes|max [bytes|max]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Unset; uses operating system defaults</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>Takes 1 or 2 parameters. The first parameter sets the soft resource limit for all processes and the second parameter sets the maximum resource limit. Either parameter can be a number, or <code>max</code> to indicate to the server that the limit should be set to the maximum allowed by the operating system configuration. Raising the maximum resource limit requires that the server is running as <code>root</code> or in the initial startup phase.</p> <p>This applies to processes forked from Apache httpd children servicing requests, not the Apache httpd children themselves. This includes CGI scripts and SSI exec commands, but not any processes forked from the Apache httpd parent, such as piped logs.</p> <p>Memory resource limits are expressed in bytes per process.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#rlimitcpu\">RLimitCPU</a></code></li> <li><code class=\"directive\"><a href=\"#rlimitnproc\">RLimitNPROC</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"rlimitnproc\">RLimitNPROC Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limits the number of processes that can be launched by processes launched by Apache httpd children</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RLimitNPROC number|max [number|max]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Unset; uses operating system defaults</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>Takes 1 or 2 parameters. The first parameter sets the soft resource limit for all processes, and the second parameter sets the maximum resource limit. Either parameter can be a number, or <code>max</code> to indicate to the server that the limit should be set to the maximum allowed by the operating system configuration. Raising the maximum resource limit requires that the server is running as <code>root</code> or in the initial startup phase.</p> <p>This applies to processes forked from Apache httpd children servicing requests, not the Apache httpd children themselves. This includes CGI scripts and SSI exec commands, but not any processes forked from the Apache httpd parent, such as piped logs.</p> <p>Process limits control the number of processes per user.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>If CGI processes are <strong>not</strong> running under user ids other than the web server user id, this directive will limit the number of processes that the server itself can create. Evidence of this situation will be indicated by <strong><code>cannot fork</code></strong> messages in the <code>error_log</code>.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#rlimitmem\">RLimitMEM</a></code></li> <li><code class=\"directive\"><a href=\"#rlimitcpu\">RLimitCPU</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"scriptinterpretersource\">ScriptInterpreterSource Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Technique for locating the interpreter for CGI scripts</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ScriptInterpreterSource Registry|Registry-Strict|Script</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ScriptInterpreterSource Script</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Win32 only.</td>\n</tr> </table> <p>This directive is used to control how Apache httpd finds the interpreter used to run CGI scripts. The default setting is <code>Script</code>. This causes Apache httpd to use the interpreter pointed to by the shebang line (first line, starting with <code>#!</code>) in the script. On Win32 systems this line usually looks like:</p> <pre class=\"prettyprint lang-perl\">#!C:/Perl/bin/perl.exe</pre> <p>or, if <code>perl</code> is in the <code>PATH</code>, simply:</p> <pre class=\"prettyprint lang-perl\">#!perl</pre> <p>Setting <code>ScriptInterpreterSource Registry</code> will cause the Windows Registry tree <code>HKEY_CLASSES_ROOT</code> to be searched using the script file extension (e.g., <code>.pl</code>) as a search key. The command defined by the registry subkey <code>Shell\\ExecCGI\\Command</code> or, if it does not exist, by the subkey <code>Shell\\Open\\Command</code> is used to open the script file. If the registry keys cannot be found, Apache httpd falls back to the behavior of the <code>Script</code> option.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>Be careful when using <code>ScriptInterpreterSource Registry</code> with <code class=\"directive\"><a href=\"mod_alias#scriptalias\">ScriptAlias</a></code>'ed directories, because Apache httpd will try to execute <strong>every</strong> file within this directory. The <code>Registry</code> setting may cause undesired program calls on files which are typically not executed. For example, the default open command on <code>.htm</code> files on most Windows systems will execute Microsoft Internet Explorer, so any HTTP request for an <code>.htm</code> file existing within the script directory would start the browser in the background on the server. This is a good way to crash your system within a minute or so.</p> </div> <p>The option <code>Registry-Strict</code> which is new in Apache HTTP Server 2.0 does the same thing as <code>Registry</code> but uses only the subkey <code>Shell\\ExecCGI\\Command</code>. The <code>ExecCGI</code> key is not a common one. It must be configured manually in the windows registry and hence prevents accidental program calls on your system.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"seerequesttail\">SeeRequestTail Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determine if mod_status displays the first 63 characters of a request or the last 63, assuming the request itself is greater than 63 chars.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SeeRequestTail On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SeeRequestTail Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache httpd 2.2.7 and later.</td>\n</tr> </table> <p>mod_status with <code>ExtendedStatus On</code> displays the actual request being handled. For historical purposes, only 63 characters of the request are actually stored for display purposes. This directive controls whether the 1st 63 characters are stored (the previous behavior and the default) or if the last 63 characters are. This is only applicable, of course, if the length of the request is 64 characters or greater.</p> <p>If Apache httpd is handling <code>GET /disk1/storage/apache/htdocs/images/imagestore1/food/apples.jpg HTTP/1.1</code> mod_status displays as follows: </p> <table class=\"bordered\"> <tr> <th>Off (default)</th> <td>GET /disk1/storage/apache/htdocs/images/imagestore1/food/apples</td> </tr> <tr> <th>On</th> <td>orage/apache/htdocs/images/imagestore1/food/apples.jpg HTTP/1.1</td> </tr> </table> </div>  <div class=\"directive-section\">\n<h2 id=\"serveradmin\">ServerAdmin Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Email address that the server includes in error messages sent to the client</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerAdmin email-address|URL</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">ServerAdmin</code> sets the contact address that the server includes in any error messages it returns to the client. If the <code>httpd</code> doesn't recognize the supplied argument as an URL, it assumes, that it's an <var>email-address</var> and prepends it with <code>mailto:</code> in hyperlink targets. However, it's recommended to actually use an email address, since there are a lot of CGI scripts that make that assumption. If you want to use an URL, it should point to another server under your control. Otherwise users may not be able to contact you in case of errors.</p> <p>It may be worth setting up a dedicated address for this, e.g.</p> <pre class=\"prettyprint lang-config\">ServerAdmin www-admin@foo.example.com</pre> <p>as users do not always mention that they are talking about the server!</p> </div>  <div class=\"directive-section\">\n<h2 id=\"serveralias\">ServerAlias Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Alternate names for a host used when matching requests to name-virtual hosts</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerAlias hostname [hostname] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">ServerAlias</code> directive sets the alternate names for a host, for use with <a href=\"../vhosts/name-based\">name-based virtual hosts</a>. The <code class=\"directive\">ServerAlias</code> may include wildcards, if appropriate.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost *:80&gt;\n  ServerName server.example.com\n  ServerAlias server server2.example.com server2\n  ServerAlias *.example.com\n  UseCanonicalName Off\n  # ...\n&lt;/VirtualHost&gt;</pre> <p>Name-based virtual hosts for the best-matching set of <code class=\"directive\"><a href=\"#virtualhost\">&lt;virtualhost&gt;</a></code>s are processed in the order they appear in the configuration. The first matching <code class=\"directive\"><a href=\"#servername\">ServerName</a></code> or <code class=\"directive\"><a href=\"#serveralias\">ServerAlias</a></code> is used, with no different precedence for wildcards (nor for ServerName vs. ServerAlias). </p> <p>The complete list of names in the <code class=\"directive\"><a href=\"#virtualhost\">&lt;VirtualHost&gt;</a></code> directive are treated just like a (non wildcard) <code class=\"directive\">ServerAlias</code>.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#usecanonicalname\">UseCanonicalName</a></code></li> <li><a href=\"../vhosts/index\">Apache HTTP Server Virtual Host documentation</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"servername\">ServerName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Hostname and port that the server uses to identify itself</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerName [scheme://]domain-name|ip-address[:port]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">ServerName</code> directive sets the request scheme, hostname and port that the server uses to identify itself. </p> <p><code class=\"directive\">ServerName</code> is used (possibly in conjunction with <code class=\"directive\"><a href=\"#serveralias\">ServerAlias</a></code>) to uniquely identify a virtual host, when using <a href=\"../vhosts/name-based\">name-based virtual hosts</a>.</p> <p>Additionally, this is used when creating self-referential redirection URLs when <code class=\"directive\"><a href=\"#usecanonicalname\">UseCanonicalName</a></code> is set to a non-default value.</p> <p>For example, if the name of the machine hosting the web server is <code>simple.example.com</code>, but the machine also has the DNS alias <code>www.example.com</code> and you wish the web server to be so identified, the following directive should be used:</p> <pre class=\"prettyprint lang-config\">ServerName www.example.com</pre> <p>The <code class=\"directive\">ServerName</code> directive may appear anywhere within the definition of a server. However, each appearance overrides the previous appearance (within that server).</p> <p>If no <code class=\"directive\">ServerName</code> is specified, the server attempts to deduce the client visible hostname by first asking the operating system for the system hostname, and if that fails, performing a reverse lookup on an IP address present on the system.</p> <p>If no port is specified in the <code class=\"directive\">ServerName</code>, then the server will use the port from the incoming request. For optimal reliability and predictability, you should specify an explicit hostname and port using the <code class=\"directive\">ServerName</code> directive.</p> <p>If you are using <a href=\"../vhosts/name-based\">name-based virtual hosts</a>, the <code class=\"directive\">ServerName</code> inside a <code class=\"directive\"><a href=\"#virtualhost\">&lt;VirtualHost&gt;</a></code> section specifies what hostname must appear in the request's <code>Host:</code> header to match this virtual host.</p> <p>Sometimes, the server runs behind a device that processes SSL, such as a reverse proxy, load balancer or SSL offload appliance. When this is the case, specify the <code>https://</code> scheme and the port number to which the clients connect in the <code class=\"directive\">ServerName</code> directive to make sure that the server generates the correct self-referential URLs. </p> <p>See the description of the <code class=\"directive\"><a href=\"#usecanonicalname\">UseCanonicalName</a></code> and <code class=\"directive\"><a href=\"#usecanonicalphysicalport\">UseCanonicalPhysicalPort</a></code> directives for settings which determine whether self-referential URLs (e.g., by the <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> module) will refer to the specified port, or to the port number given in the client's request. </p> <div class=\"warning\"> <p>Failure to set <code class=\"directive\">ServerName</code> to a name that your server can resolve to an IP address will result in a startup warning. <code>httpd</code> will then use whatever hostname it can determine, using the system's <code>hostname</code> command. This will almost never be the hostname you actually want.</p> <div class=\"example\"><pre>httpd: Could not reliably determine the server's fully qualified domain name, using rocinante.local for ServerName</pre></div> </div> <h3>See also</h3> <ul> <li><a href=\"../dns-caveats\">Issues Regarding DNS and Apache HTTP Server</a></li> <li><a href=\"../vhosts/index\">Apache HTTP Server virtual host documentation</a></li> <li><code class=\"directive\"><a href=\"#usecanonicalname\">UseCanonicalName</a></code></li> <li><code class=\"directive\"><a href=\"#usecanonicalphysicalport\">UseCanonicalPhysicalPort</a></code></li> <li><code class=\"directive\"><a href=\"#serveralias\">ServerAlias</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"serverpath\">ServerPath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Legacy URL pathname for a name-based virtual host that is accessed by an incompatible browser</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerPath URL-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">ServerPath</code> directive sets the legacy URL pathname for a host, for use with <a href=\"../vhosts/index\">name-based virtual hosts</a>.</p> <h3>See also</h3> <ul> <li><a href=\"../vhosts/index\">Apache HTTP Server Virtual Host documentation</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"serverroot\">ServerRoot Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Base directory for the server installation</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerRoot directory-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ServerRoot /usr/local/apache</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">ServerRoot</code> directive sets the directory in which the server lives. Typically it will contain the subdirectories <code>conf/</code> and <code>logs/</code>. Relative paths in other configuration directives (such as <code class=\"directive\"><a href=\"#include\">Include</a></code> or <code class=\"directive\"><a href=\"mod_so#loadmodule\">LoadModule</a></code>, for example) are taken as relative to this directory.</p> <pre class=\"prettyprint lang-config\">ServerRoot \"/home/httpd\"</pre> <p>The default location of <code class=\"directive\">ServerRoot</code> may be modified by using the <code>--prefix</code> argument to <a href=\"../programs/configure\"><code>configure</code></a>, and most third-party distributions of the server have a different default location from the one listed above.</p> <h3>See also</h3> <ul> <li><a href=\"../invoking\">the <code>-d</code> option to <code>httpd</code></a></li> <li>\n<a href=\"../misc/security_tips#serverroot\">the security tips</a> for information on how to properly set permissions on the <code class=\"directive\">ServerRoot</code>\n</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"serversignature\">ServerSignature Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures the footer on server-generated documents</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerSignature On|Off|EMail</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ServerSignature Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">ServerSignature</code> directive allows the configuration of a trailing footer line under server-generated documents (error messages, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> ftp directory listings, <code class=\"module\"><a href=\"mod_info\">mod_info</a></code> output, ...). The reason why you would want to enable such a footer line is that in a chain of proxies, the user often has no possibility to tell which of the chained servers actually produced a returned error message.</p> <p>The <code>Off</code> setting, which is the default, suppresses the footer line (and is therefore compatible with the behavior of Apache-1.2 and below). The <code>On</code> setting simply adds a line with the server version number and <code class=\"directive\"><a href=\"#servername\">ServerName</a></code> of the serving virtual host, and the <code>EMail</code> setting additionally creates a \"mailto:\" reference to the <code class=\"directive\"><a href=\"#serveradmin\">ServerAdmin</a></code> of the referenced document.</p> <p>After version 2.0.44, the details of the server version number presented are controlled by the <code class=\"directive\"><a href=\"#servertokens\">ServerTokens</a></code> directive.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#servertokens\">ServerTokens</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"servertokens\">ServerTokens Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures the <code>Server</code> HTTP response header</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ServerTokens Major|Minor|Min[imal]|Prod[uctOnly]|OS|Full</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ServerTokens Full</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive controls whether <code>Server</code> response header field which is sent back to clients includes a description of the generic OS-type of the server as well as information about compiled-in modules.</p> <dl> <dt>\n<code>ServerTokens Full</code> (or not specified)</dt> <dd>Server sends (<em>e.g.</em>): <code>Server: Apache/2.4.2 (Unix) PHP/4.2.2 MyMod/1.2</code>\n</dd> <dt><code>ServerTokens Prod[uctOnly]</code></dt> <dd>Server sends (<em>e.g.</em>): <code>Server: Apache</code>\n</dd> <dt><code>ServerTokens Major</code></dt> <dd>Server sends (<em>e.g.</em>): <code>Server: Apache/2</code>\n</dd> <dt><code>ServerTokens Minor</code></dt> <dd>Server sends (<em>e.g.</em>): <code>Server: Apache/2.4</code>\n</dd> <dt><code>ServerTokens Min[imal]</code></dt> <dd>Server sends (<em>e.g.</em>): <code>Server: Apache/2.4.2</code>\n</dd> <dt><code>ServerTokens OS</code></dt> <dd>Server sends (<em>e.g.</em>): <code>Server: Apache/2.4.2 (Unix)</code>\n</dd> </dl> <p>This setting applies to the entire server, and cannot be enabled or disabled on a virtualhost-by-virtualhost basis.</p> <p>After version 2.0.44, this directive also controls the information presented by the <code class=\"directive\"><a href=\"#serversignature\">ServerSignature</a></code> directive.</p> <div class=\"note\">Setting <code class=\"directive\">ServerTokens</code> to less than <code>minimal</code> is not recommended because it makes it more difficult to debug interoperational problems. Also note that disabling the Server: header does nothing at all to make your server more secure. The idea of \"security through obscurity\" is a myth and leads to a false sense of safety.</div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#serversignature\">ServerSignature</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"sethandler\">SetHandler Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Forces all matching files to be processed by a handler</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SetHandler handler-name|none|expression</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>expression argument 2.4.19 and later</td>\n</tr> </table> <p>When placed into an <code>.htaccess</code> file or a <code class=\"directive\"><a href=\"#directory\">&lt;Directory&gt;</a></code> or <code class=\"directive\"><a href=\"#location\">&lt;Location&gt;</a></code> section, this directive forces all matching files to be parsed through the <a href=\"../handler\">handler</a> given by <var>handler-name</var>. For example, if you had a directory you wanted to be parsed entirely as imagemap rule files, regardless of extension, you might put the following into an <code>.htaccess</code> file in that directory:</p> <pre class=\"prettyprint lang-config\">SetHandler imap-file</pre> <p>Another example: if you wanted to have the server display a status report whenever a URL of <code>http://servername/status</code> was called, you might put the following into <code>httpd.conf</code>:</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/status\"&gt;\n  SetHandler server-status\n&lt;/Location&gt;</pre> <p>You could also use this directive to configure a particular handler for files with a particular file extension. For example:</p> <pre class=\"prettyprint lang-config\">&lt;FilesMatch \"\\.php$\"&gt;\n    SetHandler application/x-httpd-php\n&lt;/FilesMatch&gt;</pre> <p>String-valued expressions can be used to reference per-request variables, including backreferences to named regular expressions:</p> <pre class=\"prettyprint lang-config\">&lt;LocationMatch ^/app/(?&lt;sub&gt;[^/]+)/&gt;\n     SetHandler \"proxy:unix:/var/run/app_%{env:MATCH_sub}.sock|fcgi://localhost:8080\"\n&lt;/LocationMatch&gt;</pre> <p>You can override an earlier defined <code class=\"directive\">SetHandler</code> directive by using the value <code>None</code>.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Because <code class=\"directive\">SetHandler</code> overrides default handlers, normal behavior such as handling of URLs ending in a slash (/) as directories or index files is suppressed.</p>\n</div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"setinputfilter\">SetInputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the filters that will process client requests and POST input</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SetInputFilter filter[;filter...]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">SetInputFilter</code> directive sets the filter or filters which will process client requests and POST input when they are received by the server. This is in addition to any filters defined elsewhere, including the <code class=\"directive\"><a href=\"mod_mime#addinputfilter\">AddInputFilter</a></code> directive.</p> <p>If more than one filter is specified, they must be separated by semicolons in the order in which they should process the content.</p> <h3>See also</h3> <ul> <li>\n<a href=\"../filter\">Filters</a> documentation</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"setoutputfilter\">SetOutputFilter Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the filters that will process responses from the server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SetOutputFilter filter[;filter...]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">SetOutputFilter</code> directive sets the filters which will process responses from the server before they are sent to the client. This is in addition to any filters defined elsewhere, including the <code class=\"directive\"><a href=\"mod_mime#addoutputfilter\">AddOutputFilter</a></code> directive.</p> <p>For example, the following configuration will process all files in the <code>/www/data/</code> directory for server-side includes.</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/www/data/\"&gt;\n  SetOutputFilter INCLUDES\n&lt;/Directory&gt;</pre> <p>If more than one filter is specified, they must be separated by semicolons in the order in which they should process the content.</p> <h3>See also</h3> <ul> <li>\n<a href=\"../filter\">Filters</a> documentation</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"timeout\">TimeOut Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Amount of time the server will wait for certain events before failing a request</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>TimeOut seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>TimeOut 60</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>The <code class=\"directive\">TimeOut</code> directive defines the length of time Apache httpd will wait for I/O in various circumstances:</p> <ul> <li>\n<p>When reading data from the client, the length of time to wait for a TCP packet to arrive if the read buffer is empty.</p> <p> For initial data on a new connection, this directive doesn't take effect until after any configured <code class=\"directive\"><a href=\"#acceptfilter\"> AcceptFilter</a></code> has passed the new connection to the server.</p> </li> <li>When writing data to the client, the length of time to wait for an acknowledgement of a packet if the send buffer is full.</li> <li>In <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, the length of time to wait for output from a CGI script.</li> <li>In <code class=\"module\"><a href=\"mod_ext_filter\">mod_ext_filter</a></code>, the length of time to wait for output from a filtering process.</li> <li>In <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>, the default timeout value if <code class=\"directive\"><a href=\"mod_proxy#proxytimeout\">ProxyTimeout</a></code> is not configured.</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"traceenable\">TraceEnable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines the behavior on <code>TRACE</code> requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>TraceEnable [on|off|extended]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>TraceEnable on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>This directive overrides the behavior of <code>TRACE</code> for both the core server and <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. The default <code>TraceEnable on</code> permits <code>TRACE</code> requests per RFC 2616, which disallows any request body to accompany the request. <code>TraceEnable off</code> causes the core server and <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> to return a <code>405</code> (Method not allowed) error to the client.</p> <p>Finally, for testing and diagnostic purposes only, request bodies may be allowed using the non-compliant <code>TraceEnable extended</code> directive. The core (as an origin server) will restrict the request body to 64Kb (plus 8Kb for chunk headers if <code>Transfer-Encoding: chunked</code> is used). The core will reflect the full headers and all chunk headers with the response body. As a proxy server, the request body is not restricted to 64Kb.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Despite claims to the contrary, enabling the <code>TRACE</code> method does not expose any security vulnerability in Apache httpd. The <code>TRACE</code> method is defined by the HTTP/1.1 specification and implementations are expected to support it.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"undefine\">UnDefine Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Undefine the existence of a variable</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>UnDefine parameter-name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>Undoes the effect of a <code class=\"directive\"><a href=\"#define\">Define</a></code> or of passing a <code>-D</code> argument to <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code>.</p> <p>This directive can be used to toggle the use of <code class=\"directive\"><a href=\"#ifdefine\">&lt;IfDefine&gt;</a></code> sections without needing to alter <code>-D</code> arguments in any startup scripts.</p> <p>While this directive is supported in virtual host context, the changes it makes are visible to any later configuration directives, beyond any enclosing virtual host.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"usecanonicalname\">UseCanonicalName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures how the server determines its own name and port</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>UseCanonicalName On|Off|DNS</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>UseCanonicalName Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>In many situations Apache httpd must construct a <em>self-referential</em> URL -- that is, a URL that refers back to the same server. With <code>UseCanonicalName On</code> Apache httpd will use the hostname and port specified in the <code class=\"directive\"><a href=\"#servername\">ServerName</a></code> directive to construct the canonical name for the server. This name is used in all self-referential URLs, and for the values of <code>SERVER_NAME</code> and <code>SERVER_PORT</code> in CGIs.</p> <p>With <code>UseCanonicalName Off</code> Apache httpd will form self-referential URLs using the hostname and port supplied by the client if any are supplied (otherwise it will use the canonical name, as defined above). These values are the same that are used to implement <a href=\"../vhosts/name-based\">name-based virtual hosts</a> and are available with the same clients. The CGI variables <code>SERVER_NAME</code> and <code>SERVER_PORT</code> will be constructed from the client supplied values as well.</p> <p>An example where this may be useful is on an intranet server where you have users connecting to the machine using short names such as <code>www</code>. You'll notice that if the users type a shortname and a URL which is a directory, such as <code>http://www/splat</code>, <em>without the trailing slash</em>, then Apache httpd will redirect them to <code>http://www.example.com/splat/</code>. If you have authentication enabled, this will cause the user to have to authenticate twice (once for <code>www</code> and once again for <code>www.example.com</code> -- see <a href=\"http://wiki.apache.org/httpd/FAQ#Why_does_Apache_ask_for_my_password_twice_before_serving_a_file.3F\"> the FAQ on this subject for more information</a>). But if <code class=\"directive\">UseCanonicalName</code> is set <code>Off</code>, then Apache httpd will redirect to <code>http://www/splat/</code>.</p> <p>There is a third option, <code>UseCanonicalName DNS</code>, which is intended for use with mass IP-based virtual hosting to support ancient clients that do not provide a <code>Host:</code> header. With this option, Apache httpd does a reverse DNS lookup on the server IP address that the client connected to in order to work out self-referential URLs.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>If CGIs make assumptions about the values of <code>SERVER_NAME</code>, they may be broken by this option. The client is essentially free to give whatever value they want as a hostname. But if the CGI is only using <code>SERVER_NAME</code> to construct self-referential URLs, then it should be just fine.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#usecanonicalphysicalport\">UseCanonicalPhysicalPort</a></code></li> <li><code class=\"directive\"><a href=\"#servername\">ServerName</a></code></li> <li><code class=\"directive\"><a href=\"mpm_common#listen\">Listen</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"usecanonicalphysicalport\">UseCanonicalPhysicalPort Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures how the server determines its own port</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>UseCanonicalPhysicalPort On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>UseCanonicalPhysicalPort Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p>In many situations Apache httpd must construct a <em>self-referential</em> URL -- that is, a URL that refers back to the same server. With <code>UseCanonicalPhysicalPort On</code>, Apache httpd will, when constructing the canonical port for the server to honor the <code class=\"directive\"><a href=\"#usecanonicalname\">UseCanonicalName</a></code> directive, provide the actual physical port number being used by this request as a potential port. With <code>UseCanonicalPhysicalPort Off</code>, Apache httpd will not ever use the actual physical port number, instead relying on all configured information to construct a valid port number.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>The ordering of the lookup when the physical port is used is as follows:</p> <dl> <dt><code>UseCanonicalName On</code></dt> <dd> <ol> <li>Port provided in <code class=\"directive\"><a href=\"#servername\">Servername</a></code>\n</li> <li>Physical port</li> <li>Default port</li> </ol> </dd> <dt><code>UseCanonicalName Off | DNS</code></dt> <dd> <ol> <li>Parsed port from <code>Host:</code> header</li> <li>Physical port</li> <li>Port provided in <code class=\"directive\"><a href=\"#servername\">Servername</a></code>\n</li> <li>Default port</li> </ol> </dd> </dl> <p>With <code>UseCanonicalPhysicalPort Off</code>, the physical ports are removed from the ordering.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#usecanonicalname\">UseCanonicalName</a></code></li> <li><code class=\"directive\"><a href=\"#servername\">ServerName</a></code></li> <li><code class=\"directive\"><a href=\"mpm_common#listen\">Listen</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"virtualhost\">&lt;VirtualHost&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Contains directives that apply only to a specific hostname or IP address</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;VirtualHost addr[:port] [addr[:port]] ...&gt; ... &lt;/VirtualHost&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Core</td>\n</tr> <tr>\n<th>Module:</th>\n<td>core</td>\n</tr> </table> <p><code class=\"directive\">&lt;VirtualHost&gt;</code> and <code>&lt;/VirtualHost&gt;</code> are used to enclose a group of directives that will apply only to a particular virtual host. Any directive that is allowed in a virtual host context may be used. When the server receives a request for a document on a particular virtual host, it uses the configuration directives enclosed in the <code class=\"directive\">&lt;VirtualHost&gt;</code> section. <var>Addr</var> can be any of the following, optionally followed by a colon and a port number (or *):</p> <ul> <li>The IP address of the virtual host;</li> <li>A fully qualified domain name for the IP address of the virtual host (not recommended);</li> <li>The character <code>*</code>, which acts as a wildcard and matches any IP address.</li> <li>The string <code>_default_</code>, which is an alias for <code>*</code>\n</li> </ul> <pre class=\"prettyprint lang-config\">&lt;VirtualHost 10.1.2.3:80&gt;\n  ServerAdmin webmaster@host.example.com\n  DocumentRoot \"/www/docs/host.example.com\"\n  ServerName host.example.com\n  ErrorLog \"logs/host.example.com-error_log\"\n  TransferLog \"logs/host.example.com-access_log\"\n&lt;/VirtualHost&gt;</pre> <p>IPv6 addresses must be specified in square brackets because the optional port number could not be determined otherwise. An IPv6 example is shown below:</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost [2001:db8::a00:20ff:fea7:ccea]:80&gt;\n  ServerAdmin webmaster@host.example.com\n  DocumentRoot \"/www/docs/host.example.com\"\n  ServerName host.example.com\n  ErrorLog \"logs/host.example.com-error_log\"\n  TransferLog \"logs/host.example.com-access_log\"\n&lt;/VirtualHost&gt;</pre> <p>Each Virtual Host must correspond to a different IP address, different port number, or a different host name for the server, in the former case the server machine must be configured to accept IP packets for multiple addresses. (If the machine does not have multiple network interfaces, then this can be accomplished with the <code>ifconfig alias</code> command -- if your OS supports it).</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>The use of <code class=\"directive\">&lt;VirtualHost&gt;</code> does <strong>not</strong> affect what addresses Apache httpd listens on. You may need to ensure that Apache httpd is listening on the correct addresses using <code class=\"directive\"><a href=\"mpm_common#listen\">Listen</a></code>.</p> </div> <p>A <code class=\"directive\"><a href=\"#servername\">ServerName</a></code> should be specified inside each <code class=\"directive\">&lt;VirtualHost&gt;</code> block. If it is absent, the <code class=\"directive\"><a href=\"#servername\">ServerName</a></code> from the \"main\" server configuration will be inherited.</p> <p>When a request is received, the server first maps it to the best matching <code class=\"directive\">&lt;VirtualHost&gt;</code> based on the local IP address and port combination only. Non-wildcards have a higher precedence. If no match based on IP and port occurs at all, the \"main\" server configuration is used.</p> <p>If multiple virtual hosts contain the best matching IP address and port, the server selects from these virtual hosts the best match based on the requested hostname. If no matching name-based virtual host is found, then the first listed virtual host that matched the IP address will be used. As a consequence, the first listed virtual host for a given IP address and port combination is the default virtual host for that IP and port combination.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>See the <a href=\"../misc/security_tips\">security tips</a> document for details on why your security could be compromised if the directory where log files are stored is writable by anyone other than the user that starts the server.</p> </div> <h3>See also</h3> <ul> <li><a href=\"../vhosts/index\">Apache HTTP Server Virtual Host documentation</a></li> <li><a href=\"../dns-caveats\">Issues Regarding DNS and Apache HTTP Server</a></li> <li><a href=\"../bind\">Setting which addresses and ports Apache HTTP Server uses</a></li> <li>\n<a href=\"../sections\">How &lt;Directory&gt;, &lt;Location&gt; and &lt;Files&gt; sections work</a> for an explanation of how these different sections are combined when a request is received</li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/core.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/core.html</a>\n  </p>\n</div>\n","mod/mod_lbmethod_bybusyness":"<h1>Apache Module mod_lbmethod_bybusyness</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Pending Request Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>lbmethod_bybusyness_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_lbmethod_bybusyness.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Split off from <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> in 2.3</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module does not provide any configuration directives of its own. It requires the services of <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>, and provides the <code>bybusyness</code> load balancing method.</p>     <h2 id=\"busyness\">Pending Request Counting Algorithm</h2> <p>Enabled via <code>lbmethod=bybusyness</code>, this scheduler keeps track of how many requests each worker is currently assigned at present. A new request is automatically assigned to the worker with the lowest number of active requests. This is useful in the case of workers that queue incoming requests independently of Apache, to ensure that queue length stays even and a request is always given to the worker most likely to service it the fastest and reduce latency.</p> <p>In the case of multiple least-busy workers, the statistics (and weightings) used by the Request Counting method are used to break the tie. Over time, the distribution of work will come to resemble that characteristic of <code>byrequests</code> (as implemented by <code class=\"module\"><a href=\"mod_lbmethod_byrequests\">mod_lbmethod_byrequests</a></code>).</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_bybusyness.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_bybusyness.html</a>\n  </p>\n</div>\n","mod/mod_lbmethod_byrequests":"<h1>Apache Module mod_lbmethod_byrequests</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Request Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>lbmethod_byrequests_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_lbmethod_byrequests.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Split off from <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> in 2.3</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module does not provide any configuration directives of its own. It requires the services of <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>, and provides the <code>byrequests</code> load balancing method..</p>     <h2 id=\"requests\">Request Counting Algorithm</h2> <p>Enabled via <code>lbmethod=byrequests</code>, the idea behind this scheduler is that we distribute the requests among the various workers to ensure that each gets their configured share of the number of requests. It works as follows:</p> <p><dfn>lbfactor</dfn> is <em>how much we expect this worker to work</em>, or <em>the workers' work quota</em>. This is a normalized value representing their \"share\" of the amount of work to be done.</p> <p><dfn>lbstatus</dfn> is <em>how urgent this worker has to work to fulfill its quota of work</em>.</p> <p>The <dfn>worker</dfn> is a member of the load balancer, usually a remote host serving one of the supported protocols.</p> <p>We distribute each worker's work quota to the worker, and then look which of them needs to work most urgently (biggest lbstatus). This worker is then selected for work, and its lbstatus reduced by the total work quota we distributed to all workers. Thus the sum of all lbstatus does not change(*) and we distribute the requests as desired.</p> <p>If some workers are disabled, the others will still be scheduled correctly.</p> <div class=\"example\"><pre><code>for each worker in workers worker lbstatus += worker lbfactor total factor += worker lbfactor if worker lbstatus &gt; candidate lbstatus candidate = worker candidate lbstatus -= total factor</code></pre></div> <p>If a balancer is configured as follows:</p> <table>\n<tr>\n<th>worker</th> <th class=\"data\">a</th> <th class=\"data\">b</th> <th class=\"data\">c</th> <th class=\"data\">d</th>\n</tr> <tr>\n<th>lbfactor</th> <td class=\"data\">25</td> <td class=\"data\">25</td> <td class=\"data\">25</td> <td class=\"data\">25</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\">0</td> <td class=\"data\">0</td> <td class=\"data\">0</td> <td class=\"data\">0</td>\n</tr> </table> <p>And <var>b</var> gets disabled, the following schedule is produced:</p> <table>\n<tr>\n<th>worker</th> <th class=\"data\">a</th> <th class=\"data\">b</th> <th class=\"data\">c</th> <th class=\"data\">d</th>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>-50</em></td> <td class=\"data\">0</td> <td class=\"data\">25</td> <td class=\"data\">25</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\">-25</td> <td class=\"data\">0</td> <td class=\"data\"><em>-25</em></td> <td class=\"data\">50</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\">0</td> <td class=\"data\">0</td> <td class=\"data\">0</td> <td class=\"data\"><em>0</em></td>\n</tr> <tr><td class=\"data\" colspan=\"5\">(repeat)</td></tr> </table> <p>That is it schedules: <var>a</var> <var>c</var> <var>d</var> <var>a</var> <var>c</var> <var>d</var> <var>a</var> <var>c</var> <var>d</var> ... Please note that:</p> <table>\n<tr>\n<th>worker</th> <th class=\"data\">a</th> <th class=\"data\">b</th> <th class=\"data\">c</th> <th class=\"data\">d</th>\n</tr> <tr>\n<th>lbfactor</th> <td class=\"data\">25</td> <td class=\"data\">25</td> <td class=\"data\">25</td> <td class=\"data\">25</td>\n</tr> </table> <p>Has the exact same behavior as:</p> <table>\n<tr>\n<th>worker</th> <th class=\"data\">a</th> <th class=\"data\">b</th> <th class=\"data\">c</th> <th class=\"data\">d</th>\n</tr> <tr>\n<th>lbfactor</th> <td class=\"data\">1</td> <td class=\"data\">1</td> <td class=\"data\">1</td> <td class=\"data\">1</td>\n</tr> </table> <p>This is because all values of <dfn>lbfactor</dfn> are normalized with respect to the others. For:</p> <table>\n<tr>\n<th>worker</th> <th class=\"data\">a</th> <th class=\"data\">b</th> <th class=\"data\">c</th>\n</tr> <tr>\n<th>lbfactor</th> <td class=\"data\">1</td> <td class=\"data\">4</td> <td class=\"data\">1</td>\n</tr> </table> <p>worker <var>b</var> will, on average, get 4 times the requests that <var>a</var> and <var>c</var> will.</p> <p>The following asymmetric configuration works as one would expect:</p> <table>\n<tr>\n<th>worker</th> <th class=\"data\">a</th> <th class=\"data\">b</th>\n</tr> <tr>\n<th>lbfactor</th> <td class=\"data\">70</td> <td class=\"data\">30</td>\n</tr> <tr><td class=\"data\" colspan=\"2\"> </td></tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>-30</em></td> <td class=\"data\">30</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\">40</td> <td class=\"data\"><em>-40</em></td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>10</em></td> <td class=\"data\">-10</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>-20</em></td> <td class=\"data\">20</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>-50</em></td> <td class=\"data\">50</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\">20</td> <td class=\"data\"><em>-20</em></td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>-10</em></td> <td class=\"data\">10</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>-40</em></td> <td class=\"data\">40</td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\">30</td> <td class=\"data\"><em>-30</em></td>\n</tr> <tr>\n<th>lbstatus</th> <td class=\"data\"><em>0</em></td> <td class=\"data\">0</td>\n</tr> <tr><td class=\"data\" colspan=\"3\">(repeat)</td></tr> </table> <p>That is after 10 schedules, the schedule repeats and 7 <var>a</var> are selected with 3 <var>b</var> interspersed.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_byrequests.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_byrequests.html</a>\n  </p>\n</div>\n","mod/mod_lbmethod_bytraffic":"<h1>Apache Module mod_lbmethod_bytraffic</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Weighted Traffic Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>lbmethod_bytraffic_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_lbmethod_bytraffic.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Split off from <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> in 2.3</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module does not provide any configuration directives of its own. It requires the services of <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>, and provides the <code>bytraffic</code> load balancing method..</p>     <h2 id=\"traffic\">Weighted Traffic Counting Algorithm</h2> <p>Enabled via <code>lbmethod=bytraffic</code>, the idea behind this scheduler is very similar to the Request Counting method, with the following changes:</p> <p><dfn>lbfactor</dfn> is <em>how much traffic, in bytes, we want this worker to handle</em>. This is also a normalized value representing their \"share\" of the amount of work to be done, but instead of simply counting the number of requests, we take into account the amount of traffic this worker has either seen or produced.</p> <p>If a balancer is configured as follows:</p> <table>\n<tr>\n<th>worker</th> <th class=\"data\">a</th> <th class=\"data\">b</th> <th class=\"data\">c</th>\n</tr> <tr>\n<th>lbfactor</th> <td class=\"data\">1</td> <td class=\"data\">2</td> <td class=\"data\">1</td>\n</tr> </table> <p>Then we mean that we want <var>b</var> to process twice the amount of bytes than <var>a</var> or <var>c</var> should. It does not necessarily mean that <var>b</var> would handle twice as many requests, but it would process twice the I/O. Thus, the size of the request and response are applied to the weighting and selection algorithm.</p> <p>Note: input and output bytes are weighted the same.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_bytraffic.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_bytraffic.html</a>\n  </p>\n</div>\n","mod/mod_lbmethod_heartbeat":"<h1>Apache Module mod_lbmethod_heartbeat</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Heartbeat Traffic Counting load balancer scheduler algorithm for <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>lbmethod_heartbeat_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_lbmethod_heartbeat.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>lbmethod=heartbeat uses the services of <code class=\"module\"><a href=\"mod_heartmonitor\">mod_heartmonitor</a></code> to balance between origin servers that are providing heartbeat info via the <code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code> module.</p> <p> This modules load balancing algorithm favors servers with more ready (idle) capacity over time, but does not select the server with the most ready capacity every time. Servers that have 0 active clients are penalized, with the assumption that they are not fully initialized.</p>    <div class=\"directive-section\">\n<h2 id=\"heartbeatstorage\">HeartbeatStorage Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Path to read heartbeat data</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>HeartbeatStorage file-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>HeartbeatStorage logs/hb.dat</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_lbmethod_heartbeat</td>\n</tr> </table> <p>The <code class=\"directive\">HeartbeatStorage</code> directive specifies the path to read heartbeat data. This flat-file is used only when <code class=\"module\"><a href=\"mod_slotmem_shm\">mod_slotmem_shm</a></code> is not loaded.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_heartbeat.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_lbmethod_heartbeat.html</a>\n  </p>\n</div>\n","mod/mod_isapi":"<h1>Apache Module mod_isapi</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>ISAPI Extensions within Apache for Windows</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>isapi_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_isapi.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Win32 only</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module implements the Internet Server extension API. It allows Internet Server extensions (<em>e.g.</em> ISAPI .dll modules) to be served by Apache for Windows, subject to the noted restrictions.</p> <p>ISAPI extension modules (.dll files) are written by third parties. The Apache Group does not author these modules, so we provide no support for them. Please contact the ISAPI's author directly if you are experiencing problems running their ISAPI extension. <strong>Please <em>do not</em> post such problems to Apache's lists or bug reporting pages.</strong></p>     <h2 id=\"usage\">Usage</h2> <p>In the server configuration file, use the <code class=\"directive\"><a href=\"mod_mime#addhandler\">AddHandler</a></code> directive to associate ISAPI files with the <code>isapi-handler</code> handler, and map it to them with their file extensions. To enable any .dll file to be processed as an ISAPI extension, edit the httpd.conf file and add the following line:</p> <pre class=\"prettyprint lang-config\">AddHandler isapi-handler .dll</pre> <div class=\"note\">In older versions of the Apache server, <code>isapi-isa</code> was the proper handler name, rather than <code>isapi-handler</code>. As of 2.3 development versions of the Apache server, <code>isapi-isa</code> is no longer valid. You will need to change your configuration to use <code>isapi-handler</code> instead.</div> <p>There is no capability within the Apache server to leave a requested module loaded. However, you may preload and keep a specific module loaded by using the following syntax in your httpd.conf:</p> <pre class=\"prettyprint lang-config\">ISAPICacheFile c:/WebWork/Scripts/ISAPI/mytest.dll</pre> <p>Whether or not you have preloaded an ISAPI extension, all ISAPI extensions are governed by the same permissions and restrictions as CGI scripts. That is, <code class=\"directive\"><a href=\"core#options\">Options</a></code> <code>ExecCGI</code> must be set for the directory that contains the ISAPI .dll file.</p> <p>Review the <a href=\"#notes\">Additional Notes</a> and the <a href=\"#journal\">Programmer's Journal</a> for additional details and clarification of the specific ISAPI support offered by <code class=\"module\"><a href=\"mod_isapi\">mod_isapi</a></code>.</p>   <h2 id=\"notes\">Additional Notes</h2> <p>Apache's ISAPI implementation conforms to all of the ISAPI 2.0 specification, except for some \"Microsoft-specific\" extensions dealing with asynchronous I/O. Apache's I/O model does not allow asynchronous reading and writing in a manner that the ISAPI could access. If an ISA tries to access unsupported features, including async I/O, a message is placed in the error log to help with debugging. Since these messages can become a flood, the directive <code>ISAPILogNotSupported Off</code> exists to quiet this noise.</p> <p>Some servers, like Microsoft IIS, load the ISAPI extension into the server and keep it loaded until memory usage is too high, or unless configuration options are specified. Apache currently loads and unloads the ISAPI extension each time it is requested, unless the <code class=\"directive\"><a href=\"#isapicachefile\">ISAPICacheFile</a></code> directive is specified. This is inefficient, but Apache's memory model makes this the most effective method. Many ISAPI modules are subtly incompatible with the Apache server, and unloading these modules helps to ensure the stability of the server.</p> <p>Also, remember that while Apache supports ISAPI Extensions, it <strong>does not support ISAPI Filters</strong>. Support for filters may be added at a later date, but no support is planned at this time.</p>   <h2 id=\"journal\">Programmer's Journal</h2> <p>If you are programming Apache 2.0 <code class=\"module\"><a href=\"mod_isapi\">mod_isapi</a></code> modules, you must limit your calls to <code>ServerSupportFunction</code> to the following directives:</p> <dl> <dt><code>HSE_REQ_SEND_URL_REDIRECT_RESP</code></dt> <dd>Redirect the user to another location.<br> This must be a fully qualified URL (<em>e.g.</em> <code>http://server/location</code>).</dd> <dt><code>HSE_REQ_SEND_URL</code></dt> <dd>Redirect the user to another location.<br> This cannot be a fully qualified URL, you are not allowed to pass the protocol or a server name (<em>e.g.</em> simply <code>/location</code>).<br> This redirection is handled by the server, not the browser.<br> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>In their recent documentation, Microsoft appears to have abandoned the distinction between the two <code>HSE_REQ_SEND_URL</code> functions. Apache continues to treat them as two distinct functions with different requirements and behaviors.</p> </div>\n</dd> <dt><code>HSE_REQ_SEND_RESPONSE_HEADER</code></dt> <dd>Apache accepts a response body following the header if it follows the blank line (two consecutive newlines) in the headers string argument. This body cannot contain NULLs, since the headers argument is NULL terminated.</dd> <dt><code>HSE_REQ_DONE_WITH_SESSION</code></dt> <dd>Apache considers this a no-op, since the session will be finished when the ISAPI returns from processing.</dd> <dt><code>HSE_REQ_MAP_URL_TO_PATH</code></dt> <dd>Apache will translate a virtual name to a physical name.</dd> <dt><code>HSE_APPEND_LOG_PARAMETER</code></dt> <dd> This logged message may be captured in any of the following logs: <ul> <li>in the <code>\\\"%{isapi-parameter}n\\\"</code> component in a <code class=\"directive\"><a href=\"mod_log_config#customlog\">CustomLog</a></code> directive</li> <li>in the <code>%q</code> log component with the <code class=\"directive\"><a href=\"#isapiappendlogtoquery\">ISAPIAppendLogToQuery</a></code> <code>On</code> directive</li> <li>in the error log with the <code class=\"directive\"><a href=\"#isapiappendlogtoerrors\">ISAPIAppendLogToErrors</a></code> <code>On</code> directive</li> </ul> <p>The first option, the <code>%{isapi-parameter}n</code> component, is always available and preferred.</p> </dd> <dt><code>HSE_REQ_IS_KEEP_CONN</code></dt> <dd>Will return the negotiated Keep-Alive status.</dd> <dt><code>HSE_REQ_SEND_RESPONSE_HEADER_EX</code></dt> <dd>Will behave as documented, although the <code>fKeepConn</code> flag is ignored.</dd> <dt><code>HSE_REQ_IS_CONNECTED</code></dt> <dd>Will report false if the request has been aborted.</dd> </dl> <p>Apache returns <code>FALSE</code> to any unsupported call to <code>ServerSupportFunction</code>, and sets the <code>GetLastError</code> value to <code>ERROR_INVALID_PARAMETER</code>.</p> <p><code>ReadClient</code> retrieves the request body exceeding the initial buffer (defined by <code class=\"directive\"><a href=\"#isapireadaheadbuffer\">ISAPIReadAheadBuffer</a></code>). Based on the <code class=\"directive\">ISAPIReadAheadBuffer</code> setting (number of bytes to buffer prior to calling the ISAPI handler) shorter requests are sent complete to the extension when it is invoked. If the request is longer, the ISAPI extension must use <code>ReadClient</code> to retrieve the remaining request body.</p> <p><code>WriteClient</code> is supported, but only with the <code>HSE_IO_SYNC</code> flag or no option flag (value of <code>0</code>). Any other <code>WriteClient</code> request will be rejected with a return value of <code>FALSE</code>, and a <code>GetLastError</code> value of <code>ERROR_INVALID_PARAMETER</code>.</p> <p><code>GetServerVariable</code> is supported, although extended server variables do not exist (as defined by other servers.) All the usual Apache CGI environment variables are available from <code>GetServerVariable</code>, as well as the <code>ALL_HTTP</code> and <code>ALL_RAW</code> values.</p> <p>Since httpd 2.0, <code class=\"module\"><a href=\"mod_isapi\">mod_isapi</a></code> supports additional features introduced in later versions of the ISAPI specification, as well as limited emulation of async I/O and the <code>TransmitFile</code> semantics. Apache httpd also supports preloading ISAPI .dlls for performance.</p>   <div class=\"directive-section\">\n<h2 id=\"isapiappendlogtoerrors\">ISAPIAppendLogToErrors Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Record <code>HSE_APPEND_LOG_PARAMETER</code> requests from ISAPI extensions to the error log</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ISAPIAppendLogToErrors on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ISAPIAppendLogToErrors off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_isapi</td>\n</tr> </table> <p>Record <code>HSE_APPEND_LOG_PARAMETER</code> requests from ISAPI extensions to the server error log.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"isapiappendlogtoquery\">ISAPIAppendLogToQuery Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Record <code>HSE_APPEND_LOG_PARAMETER</code> requests from ISAPI extensions to the query field</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ISAPIAppendLogToQuery on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ISAPIAppendLogToQuery on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_isapi</td>\n</tr> </table> <p>Record <code>HSE_APPEND_LOG_PARAMETER</code> requests from ISAPI extensions to the query field (appended to the <code class=\"directive\"><a href=\"mod_log_config#customlog\">CustomLog</a></code> <code>%q</code> component).</p> </div>  <div class=\"directive-section\">\n<h2 id=\"isapicachefile\">ISAPICacheFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>ISAPI .dll files to be loaded at startup</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ISAPICacheFile file-path [file-path] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_isapi</td>\n</tr> </table> <p>Specifies a space-separated list of file names to be loaded when the Apache server is launched, and remain loaded until the server is shut down. This directive may be repeated for every ISAPI .dll file desired. The full path name of each file should be specified. If the path name is not absolute, it will be treated relative to <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"isapifakeasync\">ISAPIFakeAsync Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Fake asynchronous support for ISAPI callbacks</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ISAPIFakeAsync on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ISAPIFakeAsync off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_isapi</td>\n</tr> </table> <p>While set to on, asynchronous support for ISAPI callbacks is simulated.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"isapilognotsupported\">ISAPILogNotSupported Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Log unsupported feature requests from ISAPI extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ISAPILogNotSupported on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ISAPILogNotSupported off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_isapi</td>\n</tr> </table> <p>Logs all requests for unsupported features from ISAPI extensions in the server error log. This may help administrators to track down problems. Once set to on and all desired ISAPI modules are functioning, it should be set back to off.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"isapireadaheadbuffer\">ISAPIReadAheadBuffer Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Size of the Read Ahead Buffer sent to ISAPI extensions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ISAPIReadAheadBuffer size</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ISAPIReadAheadBuffer 49152</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_isapi</td>\n</tr> </table> <p>Defines the maximum size of the Read Ahead Buffer sent to ISAPI extensions when they are initially invoked. All remaining data must be retrieved using the <code>ReadClient</code> callback; some ISAPI extensions may not support the <code>ReadClient</code> function. Refer questions to the ISAPI extension's author.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_isapi.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_isapi.html</a>\n  </p>\n</div>\n","mod/mod_proxy_balancer":"<h1>Apache Module mod_proxy_balancer</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>\n<code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> extension for load balancing </td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_balancer_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_balancer.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and it provides load balancing for all the supported protocols. The most important ones are:</p> <ul> <li>HTTP, using <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code>\n</li> <li>FTP, using <code class=\"module\"><a href=\"mod_proxy_ftp\">mod_proxy_ftp</a></code>\n</li> <li>AJP13, using <code class=\"module\"><a href=\"mod_proxy_ajp\">mod_proxy_ajp</a></code>\n</li> <li>WebSocket, using <code class=\"module\"><a href=\"mod_proxy_wstunnel\">mod_proxy_wstunnel</a></code>\n</li> </ul> <p>The Load balancing scheduler algorithm is not provided by this module but from other ones such as:</p> <ul> <li><code class=\"module\"><a href=\"mod_lbmethod_byrequests\">mod_lbmethod_byrequests</a></code></li> <li><code class=\"module\"><a href=\"mod_lbmethod_bytraffic\">mod_lbmethod_bytraffic</a></code></li> <li><code class=\"module\"><a href=\"mod_lbmethod_bybusyness\">mod_lbmethod_bybusyness</a></code></li> <li><code class=\"module\"><a href=\"mod_lbmethod_heartbeat\">mod_lbmethod_heartbeat</a></code></li> </ul> <p>Thus, in order to get the ability of load balancing, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>, <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> and at least one of load balancing scheduler algorithm modules have to be present in the server.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"scheduler\">Load balancer scheduler algorithm</h2> <p>At present, there are 3 load balancer scheduler algorithms available for use: Request Counting, Weighted Traffic Counting and Pending Request Counting. These are controlled via the <code>lbmethod</code> value of the Balancer definition. See the <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> directive for more information, especially regarding how to configure the Balancer and BalancerMembers.</p>   <h2 id=\"stickyness\">Load balancer stickyness</h2> <p>The balancer supports stickyness. When a request is proxied to some back-end, then all following requests from the same user should be proxied to the same back-end. Many load balancers implement this feature via a table that maps client IP addresses to back-ends. This approach is transparent to clients and back-ends, but suffers from some problems: unequal load distribution if clients are themselves hidden behind proxies, stickyness errors when a client uses a dynamic IP address that changes during a session and loss of stickyness, if the mapping table overflows.</p> <p>The module <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> implements stickyness on top of two alternative means: cookies and URL encoding. Providing the cookie can be either done by the back-end or by the Apache web server itself. The URL encoding is usually done on the back-end.</p>   <h2 id=\"example\">Examples of a balancer configuration</h2> <p>Before we dive into the technical details, here's an example of how you might use <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> to provide load balancing between two back-end servers: </p> <pre class=\"prettyprint lang-config\">&lt;Proxy \"balancer://mycluster\"&gt;\n    BalancerMember \"http://192.168.1.50:80\"\n    BalancerMember \"http://192.168.1.51:80\"\n&lt;/Proxy&gt;\nProxyPass \"/test\" \"balancer://mycluster\"\nProxyPassReverse \"/test\" \"balancer://mycluster\"</pre> <p>Another example of how to provide load balancing with stickyness using <code class=\"module\"><a href=\"mod_headers\">mod_headers</a></code>, even if the back-end server does not set a suitable session cookie: </p> <pre class=\"prettyprint lang-config\">Header add Set-Cookie \"ROUTEID=.%{BALANCER_WORKER_ROUTE}e; path=/\" env=BALANCER_ROUTE_CHANGED\n&lt;Proxy \"balancer://mycluster\"&gt;\n    BalancerMember \"http://192.168.1.50:80\" route=1\n    BalancerMember \"http://192.168.1.51:80\" route=2\n    ProxySet stickysession=ROUTEID\n&lt;/Proxy&gt;\nProxyPass \"/test\" \"balancer://mycluster\"\nProxyPassReverse \"/test\" \"balancer://mycluster\"</pre>   <h2 id=\"environment\">Exported Environment Variables</h2> <p>At present there are 6 environment variables exported:</p> <dl> <dt><var><a name=\"balancer_session_sticky\" id=\"balancer_session_sticky\">BALANCER_SESSION_STICKY</a></var></dt> <dd> <p>This is assigned the <var>stickysession</var> value used for the current request. It is the name of the cookie or request parameter used for sticky sessions</p> </dd> <dt><var><a name=\"balancer_session_route\" id=\"balancer_session_route\">BALANCER_SESSION_ROUTE</a></var></dt> <dd> <p>This is assigned the <var>route</var> parsed from the current request.</p> </dd> <dt><var><a name=\"balancer_name\" id=\"balancer_name\">BALANCER_NAME</a></var></dt> <dd> <p>This is assigned the name of the balancer used for the current request. The value is something like <code>balancer://foo</code>.</p> </dd> <dt><var><a name=\"balancer_worker_name\" id=\"balancer_worker_name\">BALANCER_WORKER_NAME</a></var></dt> <dd> <p>This is assigned the name of the worker used for the current request. The value is something like <code>http://hostA:1234</code>.</p> </dd> <dt><var><a name=\"balancer_worker_route\" id=\"balancer_worker_route\">BALANCER_WORKER_ROUTE</a></var></dt> <dd> <p>This is assigned the <var>route</var> of the worker that will be used for the current request.</p> </dd> <dt><var><a name=\"balancer_route_changed\" id=\"balancer_route_changed\">BALANCER_ROUTE_CHANGED</a></var></dt> <dd> <p>This is set to 1 if the session route does not match the worker route (BALANCER_SESSION_ROUTE != BALANCER_WORKER_ROUTE) or the session does not yet have an established route. This can be used to determine when/if the client needs to be sent an updated route when sticky sessions are used.</p> </dd> </dl>   <h2 id=\"balancer_manager\">Enabling Balancer Manager Support</h2> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_status\">mod_status</a></code>. Balancer manager enables dynamic update of balancer members. You can use balancer manager to change the balance factor of a particular member, or put it in the off line mode. </p> <p>Thus, in order to get the ability of load balancer management, <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> and <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> have to be present in the server.</p> <p>To enable load balancer management for browsers from the example.com domain add this code to your <code>httpd.conf</code> configuration file</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/balancer-manager\"&gt;\n    SetHandler balancer-manager\n    Require host example.com\n&lt;/Location&gt;</pre> <p>You can now access load balancer manager by using a Web browser to access the page <code>http://your.server.name/balancer-manager</code>. Please note that only Balancers defined outside of <code>&lt;Location ...&gt;</code> containers can be dynamically controlled by the Manager.</p>   <h2 id=\"stickyness_implementation\">Details on load balancer stickyness</h2> <p>When using cookie based stickyness, you need to configure the name of the cookie that contains the information about which back-end to use. This is done via the <var>stickysession</var> attribute added to either <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> or <code class=\"directive\"><a href=\"mod_proxy#proxyset\">ProxySet</a></code>. The name of the cookie is case-sensitive. The balancer extracts the value of the cookie and looks for a member worker with <var>route</var> equal to that value. The <var>route</var> must also be set in either <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> or <code class=\"directive\"><a href=\"mod_proxy#proxyset\">ProxySet</a></code>. The cookie can either be set by the back-end, or as shown in the above <a href=\"#example\">example</a> by the Apache web server itself.</p> <p>Some back-ends use a slightly different form of stickyness cookie, for instance Apache Tomcat. Tomcat adds the name of the Tomcat instance to the end of its session id cookie, separated with a dot (<code>.</code>) from the session id. Thus if the Apache web server finds a dot in the value of the stickyness cookie, it only uses the part behind the dot to search for the route. In order to let Tomcat know about its instance name, you need to set the attribute <code>jvmRoute</code> inside the Tomcat configuration file <code>conf/server.xml</code> to the value of the <var>route</var> of the worker that connects to the respective Tomcat. The name of the session cookie used by Tomcat (and more generally by Java web applications based on servlets) is <code>JSESSIONID</code> (upper case) but can be configured to something else.</p> <p>The second way of implementing stickyness is URL encoding. The web server searches for a query parameter in the URL of the request. The name of the parameter is specified again using <var>stickysession</var>. The value of the parameter is used to lookup a member worker with <var>route</var> equal to that value. Since it is not easy to extract and manipulate all URL links contained in responses, generally the work of adding the parameters to each link is done by the back-end generating the content. In some cases it might be feasible doing this via the web server using <code class=\"module\"><a href=\"mod_substitute\">mod_substitute</a></code> or <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code>. This can have negative impact on performance though.</p> <p>The Java standards implement URL encoding slightly different. They use a path info appended to the URL using a semicolon (<code>;</code>) as the separator and add the session id behind. As in the cookie case, Apache Tomcat can include the configured <code>jvmRoute</code> in this path info. To let Apache find this sort of path info, you neet to set <code>scolonpathdelim</code> to <code>On</code> in <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> or <code class=\"directive\"><a href=\"mod_proxy#proxyset\">ProxySet</a></code>.</p> <p>Finally you can support cookies and URL encoding at the same time, by configuring the name of the cookie and the name of the URL parameter separated by a vertical bar (<code>|</code>) as in the following example:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/test\" \"balancer://mycluster\" stickysession=JSESSIONID|jsessionid scolonpathdelim=On\n&lt;Proxy \"balancer://mycluster\"&gt;\n    BalancerMember \"http://192.168.1.50:80\" route=node1\n    BalancerMember \"http://192.168.1.51:80\" route=node2\n&lt;/Proxy&gt;</pre> <p>If the cookie and the request parameter both provide routing information for the same request, the information from the request parameter is used.</p>   <h2 id=\"stickyness_troubleshooting\">Troubleshooting load balancer stickyness</h2> <p>If you experience stickyness errors, e.g. users lose their application sessions and need to login again, you first want to check whether this is because the back-ends are sometimes unavailable or whether your configuration is wrong. To find out about possible stability problems with the back-ends, check your Apache error log for proxy error messages.</p> <p>To verify your configuration, first check, whether the stickyness is based on a cookie or on URL encoding. Next step would be logging the appropriate data in the access log by using an enhanced <code class=\"directive\"><a href=\"mod_log_config#logformat\">LogFormat</a></code>. The following fields are useful:</p> <dl> <dt><code>%{MYCOOKIE}C</code></dt> <dd>The value contained in the cookie with name <code>MYCOOKIE</code>. The name should be the same given in the <var>stickysession</var> attribute.</dd> <dt><code>%{Set-Cookie}o</code></dt> <dd>This logs any cookie set by the back-end. You can track, whether the back-end sets the session cookie you expect, and to which value it is set.</dd> <dt><code>%{BALANCER_SESSION_STICKY}e</code></dt> <dd>The name of the cookie or request parameter used to lookup the routing information.</dd> <dt><code>%{BALANCER_SESSION_ROUTE}e</code></dt> <dd>The route information found in the request.</dd> <dt><code>%{BALANCER_WORKER_ROUTE}e</code></dt> <dd>The route of the worker chosen.</dd> <dt><code>%{BALANCER_ROUTE_CHANGED}e</code></dt> <dd>Set to <code>1</code> if the route in the request is different from the route of the worker, i.e. the request couldn't be handled sticky.</dd> </dl> <p>Common reasons for loss of session are session timeouts, which are usually configurable on the back-end server.</p> <p>The balancer also logs detailed information about handling stickyness to the error log, if the log level is set to <code>debug</code> or higher. This is an easy way to troubleshoot stickyness problems, but the log volume might be to high for production servers under high load.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_balancer.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_balancer.html</a>\n  </p>\n</div>\n","mod/mod_log_debug":"<h1>Apache Module mod_log_debug</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Additional configurable debug logging</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>log_debug_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_log_debug.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.14 and later</td>\n</tr>\n</table>     <h2 id=\"examples\">Examples</h2> <ol> <li> Log message after request to /foo/* is processed: <pre class=\"prettyprint lang-config\">&lt;Location \"/foo/\"&gt;\nLogMessage \"/foo/ has been requested\"\n&lt;/Location&gt;</pre> </li> <li> Log message if request to /foo/* is processed in a sub-request: <pre class=\"prettyprint lang-config\">&lt;Location \"/foo/\"&gt;\nLogMessage \"subrequest to /foo/\" hook=type_checker expr=%{IS_SUBREQ}\n&lt;/Location&gt;</pre> The default log_transaction hook is not executed for sub-requests, therefore we have to use a different hook. </li> <li> Log message if an IPv6 client causes a request timeout: <pre class=\"prettyprint lang-config\">LogMessage \"IPv6 timeout from %{REMOTE_ADDR}\" \"expr=-T %{IPV6} &amp;&amp; %{REQUEST_STATUS} = 408\"</pre> Note the placing of the double quotes for the <code>expr=</code> argument. </li> <li> Log the value of the \"X-Foo\" request environment variable in each stage of the request: <pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\nLogMessage \"%{reqenv:X-Foo}\" hook=all\n&lt;/Location&gt;</pre> Together with microsecond time stamps in the error log, <code>hook=all</code> also lets you determine the times spent in the different parts of the request processing. </li> </ol>   <div class=\"directive-section\">\n<h2 id=\"logmessage\">LogMessage Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Log user-defined message to error log </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LogMessage message [hook=hook] [expr=expression]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>Unset</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_log_debug</td>\n</tr> </table> <p>This directive causes a user defined message to be logged to the error log. The message can use variables and functions from the <a href=\"../expr\">ap_expr syntax</a>. References to HTTP headers will not cause header names to be added to the Vary header. The messages are logged at loglevel info.</p> <p>The hook specifies before which phase of request processing the message will be logged. The following hooks are supported:</p> <table class=\"bordered\">\n<tr class=\"header\"><th>Name</th></tr> <tr><td><code>translate_name</code></td></tr> <tr class=\"odd\"><td><code>type_checker</code></td></tr> <tr><td><code>quick_handler</code></td></tr> <tr class=\"odd\"><td><code>map_to_storage</code></td></tr> <tr><td><code>check_access</code></td></tr> <tr class=\"odd\"><td><code>check_access_ex</code></td></tr> <tr><td><code>insert_filter</code></td></tr> <tr class=\"odd\"><td><code>check_authn</code></td></tr> <tr><td><code>check_authz</code></td></tr> <tr class=\"odd\"><td><code>fixups</code></td></tr> <tr><td><code>handler</code></td></tr> <tr class=\"odd\"><td><code>log_transaction</code></td></tr> </table> <p>The default is <code>log_transaction</code>. The special value <code>all</code> is also supported, causing a message to be logged at each phase. Not all hooks are executed for every request.</p> <p>The optional expression allows to restrict the message if a condition is met. The details of the expression syntax are described in the <a href=\"../expr\">ap_expr documentation</a>. References to HTTP headers will not cause the header names to be added to the Vary header.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_log_debug.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_log_debug.html</a>\n  </p>\n</div>\n","mod/mod_log_forensic":"<h1>Apache Module mod_log_forensic</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Forensic Logging of the requests made to the server</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>log_forensic_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_log_forensic.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>\n<code class=\"module\"><a href=\"mod_unique_id\">mod_unique_id</a></code> is no longer required since version 2.1</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides for forensic logging of client requests. Logging is done before and after processing a request, so the forensic log contains two log lines for each request. The forensic logger is very strict, which means:</p> <ul> <li>The format is fixed. You cannot modify the logging format at runtime.</li> <li>If it cannot write its data, the child process exits immediately and may dump core (depending on your <code class=\"directive\"><a href=\"mpm_common#coredumpdirectory\">CoreDumpDirectory</a></code> configuration).</li> </ul> <p>The <code>check_forensic</code> script, which can be found in the distribution's support directory, may be helpful in evaluating the forensic log output.</p>     <h2 id=\"formats\">Forensic Log Format</h2> <p>Each request is logged two times. The first time is <em>before</em> it's processed further (that is, after receiving the headers). The second log entry is written <em>after</em> the request processing at the same time where normal logging occurs.</p> <p>In order to identify each request, a unique request ID is assigned. This forensic ID can be cross logged in the normal transfer log using the <code>%{forensic-id}n</code> format string. If you're using <code class=\"module\"><a href=\"mod_unique_id\">mod_unique_id</a></code>, its generated ID will be used.</p> <p>The first line logs the forensic ID, the request line and all received headers, separated by pipe characters (<code>|</code>). A sample line looks like the following (all on one line):</p> <div class=\"example\"><pre>+yQtJf8CoAB4AAFNXBIEAAAAA|GET /manual/de/images/down.gif HTTP/1.1|Host:localhost%3a8080|User-Agent:Mozilla/5.0 (X11; U; Linux i686; en-US; rv%3a1.6) Gecko/20040216 Firefox/0.8|Accept:image/png, etc...</pre></div> <p>The plus character at the beginning indicates that this is the first log line of this request. The second line just contains a minus character and the ID again:</p> <div class=\"example\"><code>-yQtJf8CoAB4AAFNXBIEAAAAA</code></div> <p>The <code>check_forensic</code> script takes as its argument the name of the logfile. It looks for those <code>+</code>/<code>-</code> ID pairs and complains if a request was not completed.</p>   <h2 id=\"security\">Security Considerations</h2> <p>See the <a href=\"../misc/security_tips#serverroot\">security tips</a> document for details on why your security could be compromised if the directory where logfiles are stored is writable by anyone other than the user that starts the server.</p> <p>The log files may contain sensitive data such as the contents of <code>Authorization:</code> headers (which can contain passwords), so they should not be readable by anyone except the user that starts the server.</p>   <div class=\"directive-section\">\n<h2 id=\"forensiclog\">ForensicLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets filename of the forensic log</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ForensicLog filename|pipe</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_log_forensic</td>\n</tr> </table> <p>The <code class=\"directive\">ForensicLog</code> directive is used to log requests to the server for forensic analysis. Each log entry is assigned a unique ID which can be associated with the request using the normal <code class=\"directive\"><a href=\"mod_log_config#customlog\">CustomLog</a></code> directive. <code class=\"module\"><a href=\"mod_log_forensic\">mod_log_forensic</a></code> creates a token called <code>forensic-id</code>, which can be added to the transfer log using the <code>%{forensic-id}n</code> format string.</p> <p>The argument, which specifies the location to which the logs will be written, can take one of the following two types of values:</p> <dl> <dt><var>filename</var></dt> <dd>A filename, relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>.</dd> <dt><var>pipe</var></dt> <dd>The pipe character \"<code>|</code>\", followed by the path to a program to receive the log information on its standard input. The program name can be specified relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code> directive. <div class=\"warning\">\n<p><strong>Security:</strong></p> <p>If a program is used, then it will be run as the user who started <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code>. This will be root if the server was started by root; be sure that the program is secure or switches to a less privileged user.</p> </div> <div class=\"note\">\n<p><strong>Note</strong></p> <p>When entering a file path on non-Unix platforms, care should be taken to make sure that only forward slashes are used even though the platform may allow the use of back slashes. In general it is a good idea to always use forward slashes throughout the configuration files.</p> </div>\n</dd> </dl> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_log_forensic.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_log_forensic.html</a>\n  </p>\n</div>\n","mod/mod_http2":"<h1>Apache Module mod_http2</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Support for the HTTP/2 transport layer</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>http2_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_http2.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.17 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides HTTP/2 (<a href=\"https://tools.ietf.org/html/rfc7540\">RFC 7540</a>) support for the Apache HTTP Server.</p> <p>This module relies on <a href=\"http://nghttp2.org/\">libnghttp2</a> to provide the core http/2 engine.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>This module is experimental. Its behaviors, directives, and defaults are subject to more change from release to release relative to other standard modules. Users are encouraged to consult the \"CHANGES\" file for potential updates.</p> </div> <p>You must enable HTTP/2 via <code class=\"directive\"><a href=\"core#protocols\">Protocols</a></code> in order to use the functionality described in this document. The HTTP/2 protocol <a href=\"https://http2.github.io/faq/#does-http2-require-encryption\">does not require</a> the use of encryption so two schemes are available: <code>h2</code> (HTTP/2 over TLS) and <code>h2c</code> (HTTP/2 over TCP).</p> <p>Two useful configuration schemes are:</p> <div class=\"note\">\n<p><strong>HTTP/2 in a VirtualHost context (TLS only)</strong></p> <pre class=\"prettyprint lang-config\">Protocols h2 http/1.1</pre> <p>Allows HTTP/2 negotiation (h2) via TLS ALPN in a secure <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code>. HTTP/2 preamble checking (Direct mode, see <code class=\"directive\"><a href=\"#h2direct\">H2Direct</a></code>) is disabled by default for <code>h2</code>.</p> </div> <div class=\"note\">\n<p><strong>HTTP/2 in a Server context (TLS and cleartext)</strong></p> <pre class=\"prettyprint lang-config\">Protocols h2 h2c http/1.1</pre> <p>Allows HTTP/2 negotiation (h2) via TLS ALPN for secure <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code>. Allows HTTP/2 cleartext negotiation (h2c) upgrading from an initial HTTP/1.1 connection or via HTTP/2 preamble checking (Direct mode, see <code class=\"directive\"><a href=\"#h2direct\">H2Direct</a></code>).</p> </div> <p>Refer to the official <a href=\"https://http2.github.io/faq\">HTTP/2 FAQ</a> for any doubt about the protocol.</p>     <h2 id=\"how-it-works\">How it works</h2> <h3><a name=\"dimensioning\" id=\"dimensioning\">HTTP/2 Dimensioning</a></h3> <p> Enabling HTTP/2 on your Apache Server has impact on the resource consumption and if you have a busy site, you may need to consider carefully the implications. </p> <p> The first noticeable thing after enabling HTTP/2 is that your server processes will start additional threads. The reason for this is that HTTP/2 gives all requests that it receives to its own <em>Worker</em> threads for processing, collects the results and streams them out to the client. </p> <p> In the current implementation, these workers use a separate thread pool from the MPM workers that you might be familiar with. This is just how things are right now and not intended to be like this forever. (It might be forever for the 2.4.x release line, though.) So, HTTP/2 workers, or shorter H2Workers, will not show up in <code class=\"module\"><a href=\"mod_status\">mod_status</a></code>. They are also not counted against directives such as <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code>. However they take <code class=\"directive\"><a href=\"mpm_common#threadsperchild\">ThreadsPerChild</a></code> as default if you have not configured something else via <code class=\"directive\"><a href=\"#h2minworkers\">H2MinWorkers</a></code> and <code class=\"directive\"><a href=\"#h2maxworkers\">H2MaxWorkers</a></code>. </p> <p> Another thing to watch out for is is memory consumption. Since HTTP/2 keeps more state on the server to manage all the open request, priorities for and dependencies between them, it will always need more memory than HTTP/1.1 processing. There are three directives which steer the memory footprint of a HTTP/2 connection: <code class=\"directive\"><a href=\"#h2maxsessionstreams\">H2MaxSessionStreams</a></code>, <code class=\"directive\"><a href=\"#h2windowsize\">H2WindowSize</a></code> and <code class=\"directive\"><a href=\"#h2streammaxmemsize\">H2StreamMaxMemSize</a></code>. </p> <p> <code class=\"directive\"><a href=\"#h2maxsessionstreams\">H2MaxSessionStreams</a></code> limits the number of parallel requests that a client can make on a HTTP/2 connection. It depends on your site how many you should allow. The default is 100 which is plenty and unless you run into memory problems, I would keep it this way. Most requests that browsers send are GETs without a body, so they use up only a little bit of memory until the actual processing starts. </p> <p> <code class=\"directive\"><a href=\"#h2windowsize\">H2WindowSize</a></code> controls how much the client is allowed to send as body of a request, before it waits for the server to encourage more. Or, the other way around, it is the amount of request body data the server needs to be able to buffer. This is per request. </p> <p> And last, but not least, <code class=\"directive\"><a href=\"#h2streammaxmemsize\">H2StreamMaxMemSize</a></code> controls how much response data shall be buffered. The request sits in a H2Worker thread and is producing data, the HTTP/2 connection tries to send this to the client. If the client does not read fast enough, the connection will buffer this amount of data and then suspend the H2Worker. </p> <p> If you serve a lot of static files, <code class=\"directive\"><a href=\"#h2sessionextrafiles\">H2SessionExtraFiles</a></code> is of interest. This tells the server how many file handles per HTTP/2 connection it is allowed to waste for better performance. Because when a request produces a static file as the response, the file handle gets passed around and is buffered and not the file contents. That allows to serve many large files without wasting memory or copying data unnecessarily. However file handles are a limited resource for a process, and if too many are used this way, requests may fail under load as the amount of open handles has been exceeded. </p> <h3><a name=\"misdirected\" id=\"misdirected\">Multiple Hosts and Misdirected Requests</a></h3> <p> Many sites use the same TLS certificate for multiple virtual hosts. The certificate either has a wildcard name, such as '*.example.org' or carries several alternate names. Browsers using HTTP/2 will recognize that and reuse an already opened connection for such hosts. </p> <p> While this is great for performance, it comes at a price: such vhosts need more care in their configuration. The problem is that you will have multiple requests for multiple hosts on the same TLS connection. And that makes renegotiation impossible, in face the HTTP/2 standard forbids it. </p> <p> So, if you have several virtual hosts using the same certificate and want to use HTTP/2 for them, you need to make sure that all vhosts have exactly the same SSL configuration. You need the same protocol, ciphers and settings for client verification. </p> <p> If you mix things, Apache httpd will detect it and return a special response code, 421 Misdirected Request, to the client. </p> <h3><a name=\"envvars\" id=\"envvars\">Environment Variables</a></h3> <p> This module can be configured to provide HTTP/2 related information as additional environment variables to the SSI and CGI namespace, as well as in custom log configurations (see <code>%{VAR_NAME}e</code>). </p> <table class=\"bordered\"> <tr> <th><a name=\"table3\">Variable Name:</a></th> <th>Value Type:</th> <th>Description:</th> </tr> <tr>\n<td><code>HTTP2</code></td>\n<td>flag</td>\n<td>HTTP/2 is being used.</td>\n</tr> <tr>\n<td><code>H2PUSH</code></td>\n<td>flag</td>\n<td>HTTP/2 Server Push is enabled for this connection and also supported by the client.</td>\n</tr> <tr>\n<td><code>H2_PUSH</code></td>\n<td>flag</td>\n<td>alternate name for <code>H2PUSH</code>\n</td>\n</tr> <tr>\n<td><code>H2_PUSHED</code></td>\n<td>string</td>\n<td>empty or <code>PUSHED</code> for a request being pushed by the server.</td>\n</tr> <tr>\n<td><code>H2_PUSHED_ON</code></td>\n<td>number</td>\n<td>HTTP/2 stream number that triggered the push of this request.</td>\n</tr> <tr>\n<td><code>H2_STREAM_ID</code></td>\n<td>number</td>\n<td>HTTP/2 stream number of this request.</td>\n</tr> <tr>\n<td><code>H2_STREAM_TAG</code></td>\n<td>string</td>\n<td>HTTP/2 process unique stream identifier, consisting of connection id and stream id separated by <code>-</code>.</td>\n</tr> </table>   <div class=\"directive-section\">\n<h2 id=\"h2direct\">H2Direct Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>H2 Direct Protocol Switch</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2Direct on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2Direct on for h2c, off for h2 protocol</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive toggles the usage of the HTTP/2 Direct Mode. This should be used inside a <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> section to enable direct HTTP/2 communication for that virtual host. </p> <p> Direct communication means that if the first bytes received by the server on a connection match the HTTP/2 preamble, the HTTP/2 protocol is switched to immediately without further negotiation. This mode is defined in RFC 7540 for the cleartext (h2c) case. Its use on TLS connections not mandated by the standard. </p> <p> When a server/vhost does not have h2 or h2c enabled via <code class=\"directive\"><a href=\"core#protocols\">Protocols</a></code>, the connection is never inspected for a HTTP/2 preamble. <code class=\"directive\">H2Direct</code> does not matter then. This is important for connections that use protocols where an initial read might hang indefinitely, such as NNTP. </p> <p> For clients that have out-of-band knowledge about a server supporting h2c, direct HTTP/2 saves the client from having to perform an HTTP/1.1 upgrade, resulting in better performance and avoiding the Upgrade restrictions on request bodies. </p> <p> This makes direct h2c attractive for server to server communication as well, when the connection can be trusted or is secured by other means. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2Direct on</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2maxsessionstreams\">H2MaxSessionStreams Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of active streams per HTTP/2 session.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2MaxSessionStreams n</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2MaxSessionStreams 100</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive sets the maximum number of active streams per HTTP/2 session (e.g. connection) that the server allows. A stream is active if it is not <code>idle</code> or <code>closed</code> according to RFC 7540. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2MaxSessionStreams 20</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2maxworkeridleseconds\">H2MaxWorkerIdleSeconds Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of seconds h2 workers remain idle until shut down.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2MaxWorkerIdleSeconds n</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2MaxWorkerIdleSeconds 600</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive sets the maximum number of seconds a h2 worker may idle until it shuts itself down. This only happens while the number of h2 workers exceeds <code class=\"directive\"><a href=\"#h2minworkers\">H2MinWorkers</a></code>. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2MaxWorkerIdleSeconds 20</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2maxworkers\">H2MaxWorkers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum number of worker threads to use per child process.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2MaxWorkers n</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive sets the maximum number of worker threads to spawn per child process for HTTP/2 processing. If this directive is not used, <code class=\"module\"><a href=\"mod_http2\">mod_http2</a></code> will chose a value suitable for the <code>mpm</code> module loaded. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2MaxWorkers 20</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2minworkers\">H2MinWorkers Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Minimal number of worker threads to use per child process.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2MinWorkers n</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive sets the minimum number of worker threads to spawn per child process for HTTP/2 processing. If this directive is not used, <code class=\"module\"><a href=\"mod_http2\">mod_http2</a></code> will chose a value suitable for the <code>mpm</code> module loaded. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2MinWorkers 10</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2moderntlsonly\">H2ModernTLSOnly Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Require HTTP/2 connections to be \"modern TLS\" only</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2ModernTLSOnly on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2ModernTLSOnly on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.18 and later.</td>\n</tr> </table> <p> This directive toggles the security checks on HTTP/2 connections in TLS mode (https:). This can be used server wide or for specific <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code>s. </p> <p> The security checks require that the TSL protocol is at least TLSv1.2 and that none of the ciphers listed in RFC 7540, Appendix A is used. These checks will be extended once new security requirements come into place. </p> <p> The name stems from the <a href=\"https://wiki.mozilla.org/Security/Server_Side_TLS\">Security/Server Side TLS</a> definitions at mozilla where \"modern compatibility\" is defined. Mozilla Firefox and other browsers require modern compatibility for HTTP/2 connections. As everything in OpSec, this is a moving target and can be expected to evolve in the future. </p> <p> One purpose of having these checks in <code class=\"module\"><a href=\"mod_http2\">mod_http2</a></code> is to enforce this security level for all connections, not only those from browsers. The other purpose is to prevent the negotiation of HTTP/2 as a protocol should the requirements not be met. </p> <p> Ultimately, the security of the TLS connection is determined by the server configuration directives for <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code>. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2ModernTLSOnly off</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2push\">H2Push Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>H2 Server Push Switch</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2Push on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2Push on</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.18 and later.</td>\n</tr> </table> <p> This directive toggles the usage of the HTTP/2 server push protocol feature. This should be used inside a <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> section to enable direct HTTP/2 communication for that virtual host. </p> <p> The HTTP/2 protocol allows the server to push other resources to a client when it asked for a particular one. This is helpful if those resources are connected in some way and the client can be expected to ask for it anyway. The pushing then saves the time it takes the client to ask for the resources itself. On the other hand, pushing resources the client never needs or already has is a waste of bandwidth. </p> <p> Server pushes are detected by inspecting the <code>Link</code> headers of responses (see https://tools.ietf.org/html/rfc5988 for the specification). When a link thus specified has the <code>rel=preload</code> attribute, it is treated as a resource to be pushed. </p> <p> Link headers in responses are either set by the application or can be configured via <code class=\"module\"><a href=\"mod_headers\">mod_headers</a></code> as: </p> <div class=\"example\">\n<h3>mod_headers example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location /index.html&gt;\n    Header add Link \"&lt;/css/site.css&gt;;rel=preload\"\n    Header add Link \"&lt;/images/logo.jpg&gt;;rel=preload\"\n&lt;/Location&gt;</pre> </div> <p> As the example shows, there can be several link headers added to a response, resulting in several pushes being triggered. There are no checks in the module to avoid pushing the same resource twice or more to one client. Use with care. </p> <p> HTTP/2 server pushes are enabled by default. This directive allows it to be switch off on all resources of this server/virtual host. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2Push off</pre> </div> <p> Last but not least, pushes happen only when the client signals its willingness to accept those. Most browsers do, some, like Safari 9, do not. Also, pushes also only happen for resources from the same <em>authority</em> as the original response is for. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"h2pushdiarysize\">H2PushDiarySize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>H2 Server Push Diary Size</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2PushDiarySize n</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2PushDiarySize 256</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.19 and later.</td>\n</tr> </table> <p> This directive toggles the maximum number of HTTP/2 server pushes that are remembered per HTTP/2 connection. This can be used inside the <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> section to influence the number for all connections to that virtual host. </p> <p> The push diary records a digest (currently using a 64 bit number) of pushed resources (their URL) to avoid duplicate pushes on the same connection. These value are not persisted, so clients opening a new connection will experience known pushes again. There is ongoing work to enable a client to disclose a digest of the resources it already has, so the diary maybe initialized by the client on each connection setup. </p> <p> If the maximum size is reached, newer entries replace the oldest ones. A diary entry uses 8 bytes, letting a default diary with 256 entries consume around 2 KB of memory. </p> <p> A size of 0 will effectively disable the push diary. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"h2pushpriority\">H2PushPriority Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>H2 Server Push Priority</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2PushPriority mime-type [after|before|interleaved] [weight]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2PushPriority * After 16</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.18 and later. For having an effect, a nghttp2 library version 1.5.0 or newer is necessary.</td>\n</tr> </table> <p> This directive defines the priority handling of pushed responses based on the content-type of the response. This is usually defined per server config, but may also appear in a virtual host. </p> <p> HTTP/2 server pushes are always related to a client request. Each such request/response pairs, or <em>streams</em> have a dependency and a weight, together defining the <em>priority</em> of a stream. </p> <p> When a stream <em>depends</em> on another, say X depends on Y, then Y gets all bandwidth before X gets any. Note that this does not mean that Y will block X. If Y has no data to send, all bandwidth allocated to Y can be used by X. </p> <p> When a stream has more than one dependant, say X1 and X2 both depend on Y, the <em>weight</em> determines the bandwidth allocation. If X1 and X2 have the same weight, they both get half of the available bandwidth. If the weight of X1 is twice as large as that for X2, X1 gets twice the bandwidth of X2. </p> <p> Ultimately, every stream depends on the <em>root</em> stream which gets all the bandwidth available, but never sends anything. So all its bandwidth is distributed by weight among its children. Which either have data to send or distribute the bandwidth to their own children. And so on. If none of the children have data to send, that bandwidth get distributed somewhere else according to the same rules. </p> <p> The purpose of this priority system is to always make use of available bandwidth while allowing precedence and weight to be given to specific streams. Since, normally, all streams are initiated by the client, it is also the one that sets these priorities. </p> <p> Only when such a stream results in a PUSH, gets the server to decide what the <em>initial</em> priority of such a pushed stream is. In the examples below, X is the client stream. It depends on Y and the server decides to PUSH streams P1 and P2 onto X. </p> <p> The default priority rule is: </p> <div class=\"example\">\n<h3>Default Priority Rule</h3>\n<pre class=\"prettyprint lang-config\">H2PushPriority * After 16</pre> </div> <p> which reads as 'Send a pushed stream of any content-type depending on the client stream with weight 16'. And so P1 and P2 will be send after X and, as they have equal weight, share bandwidth equally among themselves. </p> <div class=\"example\">\n<h3>Interleaved Priority Rule</h3>\n<pre class=\"prettyprint lang-config\">H2PushPriority text/css Interleaved 256</pre> </div> <p> which reads as 'Send any CSS resource on the same dependency and weight as the client stream'. If P1 has content-type 'text/css', it will depend on Y (as does X) and its effective weight will be calculated as <code>P1ew = Xw * (P1w / 256)</code>. With P1w being 256, this will make the effective weight the same as the weight of X. If both X and P1 have data to send, bandwidth will be allocated to both equally. </p> <p> With Pw specified as 512, a pushed, interleaved stream would get double the weight of X. With 128 only half as much. Note that effective weights are always capped at 256. </p> <div class=\"example\">\n<h3>Before Priority Rule</h3>\n<pre class=\"prettyprint lang-config\">H2PushPriority application/json Before</pre> </div> <p> This says that any pushed stream of content type 'application/json' should be send out <em>before</em> X. This makes P1 dependent on Y and X dependent on P1. So, X will be stalled as long as P1 has data to send. The effective weight is inherited from the client stream. Specifying a weight is not allowed. </p> <p> Be aware that the effect of priority specifications is limited by the available server resources. If a server does not have workers available for pushed streams, the data for the stream may only ever arrive when other streams have been finished. </p> <p> Last, but not least, there are some specifics of the syntax to be used in this directive: </p> <ol> <li>'*' is the only special content-type that matches all others. 'image/*' will not work.</li> <li>The default dependency is 'After'. </li> <li>There are also default weights: for 'After' it is 16, 'interleaved' is 256. </li> </ol> <div class=\"example\">\n<h3>Shorter Priority Rules</h3>\n<pre class=\"prettyprint lang-config\">H2PushPriority application/json 32         # an After rule\nH2PushPriority image/jpeg before           # weight inherited\nH2PushPriority text/css   interleaved      # weight 256 default</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2serializeheaders\">H2SerializeHeaders Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Serialize Request/Response Processing Switch</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2SerializeHeaders on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2SerializeHeaders off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive toggles if HTTP/2 requests shall be serialized in HTTP/1.1 format for processing by <code>httpd</code> core or if received binary data shall be passed into the <code>request_rec</code>s directly. </p> <p> Serialization will lower performance, but gives more backward compatibility in case custom filters/hooks need it. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2SerializeHeaders on</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2sessionextrafiles\">H2SessionExtraFiles Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of Extra File Handles</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2SessionExtraFiles n</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive sets maximum number of <em>extra</em> file handles a HTTP/2 session is allowed to use. A file handle is counted as <em>extra</em> when it is transferred from a h2 worker thread to the main HTTP/2 connection handling. This commonly happens when serving static files. </p>\n<p> Depending on the processing model configured on the server, the number of connections times number of active streams may exceed the number of file handles for the process. On the other hand, converting every file into memory bytes early results in too many buffer writes. This option helps to mitigate that. </p>\n<p> The number of file handles used by a server process is then in the order of: </p> <pre>(h2_connections * extra_files) + (h2_max_worker)</pre> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2SessionExtraFiles 10</pre> </div> <p> If nothing is configured, the module tries to make a conservative guess how many files are safe to use. This depends largely on the MPM chosen. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"h2streammaxmemsize\">H2StreamMaxMemSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximum amount of output data buffered per stream.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2StreamMaxMemSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2StreamMaxMemSize 65536</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive sets the maximum number of outgoing data bytes buffered in memory for an active streams. This memory is not allocated per stream as such. Allocations are counted against this limit when they are about to be done. Stream processing freezes when the limit has been reached and will only continue when buffered data has been sent out to the client. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2StreamMaxMemSize 128000</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2tlscooldownsecs\">H2TLSCoolDownSecs Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td></td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2TLSCoolDownSecs seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2TLSCoolDownSecs 1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.18 and later.</td>\n</tr> </table> <p> This directive sets the number of seconds of idle time on a TLS connection before the TLS write size falls back to small (~1300 bytes) length. This can be used server wide or for specific <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code>s. </p> <p> See <code class=\"directive\"><a href=\"#h2tlswarmupsize\">H2TLSWarmUpSize</a></code> for a description of TLS warmup. <code class=\"directive\">H2TLSCoolDownSecs</code> reflects the fact that connections may deteriorate over time (and TCP flow adjusts) for idle connections as well. It is beneficial to overall performance to fall back to the pre-warmup phase after a number of seconds that no data has been sent. </p> <p> In deployments where connections can be considered reliable, this timer can be disabled by setting it to 0. </p> <p> The following example sets the seconds to zero, effectively disabling any cool down. Warmed up TLS connections stay on maximum record size. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2TLSCoolDownSecs 0</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2tlswarmupsize\">H2TLSWarmUpSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td></td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2TLSWarmUpSize amount</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2TLSWarmUpSize 1048576</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.4.18 and later.</td>\n</tr> </table> <p> This directive sets the number of bytes to be sent in small TLS records (~1300 bytes) until doing maximum sized writes (16k) on https: HTTP/2 connections. This can be used server wide or for specific <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code>s. </p> <p> Measurements by <a href=\"https://www.igvita.com\">google performance labs</a> show that best performance on TLS connections is reached, if initial record sizes stay below the MTU level, to allow a complete record to fit into an IP packet. </p> <p> While TCP adjust its flow-control and window sizes, longer TLS records can get stuck in queues or get lost and need retransmission. This is of course true for all packets. TLS however needs the whole record in order to decrypt it. Any missing bytes at the end will stall usage of the received ones. </p> <p> After a sufficient number of bytes have been send successfully, the TCP state of the connection is stable and maximum TLS record sizes (16 KB) can be used for optimal performance. </p> <p> In deployments where servers are reached locally or over reliable connections only, the value might be decreased with 0 disabling any warmup phase altogether. </p> <p> The following example sets the size to zero, effectively disabling any warmup phase. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2TLSWarmUpSize 0</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2upgrade\">H2Upgrade Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>H2 Upgrade Protocol Switch</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2Upgrade on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2Upgrade on for h2c, off for h2 protocol</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive toggles the usage of the HTTP/1.1 Upgrade method for switching to HTTP/2. This should be used inside a <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> section to enable Upgrades to HTTP/2 for that virtual host. </p> <p> This method of switching protocols is defined in HTTP/1.1 and uses the \"Upgrade\" header (thus the name) to announce willingness to use another protocol. This may happen on any request of a HTTP/1.1 connection. </p> <p> This method of protocol switching is enabled by default on cleartext (potential h2c) connections and disabled on TLS (potential h2), as mandated by RFC 7540. </p> <p> Please be aware that Upgrades are only accepted for requests that carry no body. POSTs and PUTs with content will never trigger an upgrade to HTTP/2. See <code class=\"directive\"><a href=\"#h2direct\">H2Direct</a></code> for an alternative to Upgrade. </p> <p> This mode only has an effect when h2 or h2c is enabled via the <code class=\"directive\"><a href=\"core#protocols\">Protocols</a></code>. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2Upgrade on</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"h2windowsize\">H2WindowSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Size of Stream Window for upstream data.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>H2WindowSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>H2WindowSize 65535</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_http2</td>\n</tr> </table> <p> This directive sets the size of the window that is used for flow control from client to server and limits the amount of data the server has to buffer. The client will stop sending on a stream once the limit has been reached until the server announces more available space (as it has processed some of the data). </p>\n<p> This limit affects only request bodies, not its meta data such as headers. Also, it has no effect on response bodies as the window size for those are managed by the clients. </p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">H2WindowSize 128000</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_http2.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_http2.html</a>\n  </p>\n</div>\n","mod/mod_logio":"<h1>Apache Module mod_logio</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Logging of input and output bytes per request</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>logio_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_logio.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides the logging of input and output number of bytes received/sent per request. The numbers reflect the actual bytes as received on the network, which then takes into account the headers and bodies of requests and responses. The counting is done before SSL/TLS on input and after SSL/TLS on output, so the numbers will correctly reflect any changes made by encryption.</p> <p>This module requires <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code>.</p> <div class=\"note\">When KeepAlive connections are used with SSL, the overhead of the SSL handshake is reflected in the byte count of the first request on the connection. When per-directory SSL renegotiation occurs, the bytes are associated with the request that triggered the renegotiation.</div>     <h2 id=\"formats\">Custom Log Formats</h2> <p>This module adds three new logging directives. The characteristics of the request itself are logged by placing \"<code>%</code>\" directives in the format string, which are replaced in the log file by the values as follows:</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Format String</th> <th>Description</th>\n</tr> <tr>\n<td><code>%I</code></td> <td>Bytes received, including request and headers, cannot be zero.</td>\n</tr> <tr class=\"odd\">\n<td><code>%O</code></td> <td>Bytes sent, including headers, cannot be zero.</td>\n</tr> <tr>\n<td><code>%S</code></td> <td>Bytes transferred (received and sent), including request and headers, cannot be zero. This is the combination of %I and %O.<br> Available in Apache 2.4.7 and later</td>\n</tr> <tr class=\"odd\">\n<td><code>%^FB</code></td> <td>Delay in microseconds between when the request arrived and the first byte of the response headers are written. Only available if <code class=\"directive\">LogIOTrackTTFB</code> is set to ON.<br> Available in Apache 2.4.13 and later</td>\n</tr> </table> <p>Usually, the functionality is used like this:</p> <dl> <dt>Combined I/O log format:</dt> <dd><code>\"%h %l %u %t \\\"%r\\\" %&gt;s %b \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\" %I %O\"</code></dd> </dl>   <div class=\"directive-section\">\n<h2 id=\"logiotrackttfb\">LogIOTrackTTFB Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable tracking of time to first byte (TTFB)</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LogIOTrackTTFB ON|OFF</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LogIOTrackTTFB OFF</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>none</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_logio</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Apache HTTP Server 2.4.13 and later</td>\n</tr> </table> <p>This directive configures whether this module tracks the delay between the request being read and the first byte of the response headers being written. The resulting value may be logged with the <code>%^FB</code> format.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_logio.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_logio.html</a>\n  </p>\n</div>\n","mod/mod_macro":"<h1>Apache Module mod_macro</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides macros within apache httpd runtime configuration files</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>macro_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_macro.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>Provides macros within Apache httpd runtime configuration files, to ease the process of creating numerous similar configuration blocks. When the server starts up, the macros are expanded using the provided parameters, and the result is processed as along with the rest of the configuration file.</p>     <h2 id=\"usage\">Usage</h2> <p>Macros are defined using <code class=\"directive\"><a href=\"#macro\">&lt;Macro&gt;</a></code> blocks, which contain the portion of your configuration that needs to be repeated, complete with variables for those parts that will need to be substituted.</p> <p>For example, you might use a macro to define a <code class=\"directive\"><a href=\"core#virtualhost\">&lt;VirtualHost&gt;</a></code> block, in order to define multiple similar virtual hosts:</p> <pre class=\"prettyprint lang-config\">&lt;Macro VHost $name $domain&gt;\n&lt;VirtualHost *:80&gt;\n    ServerName $domain\n    ServerAlias www.$domain\n\n    DocumentRoot \"/var/www/vhosts/$name\"\n    ErrorLog \"/var/log/httpd/$name.error_log\"\n    CustomLog \"/var/log/httpd/$name.access_log\" combined\n&lt;/VirtualHost&gt;\n&lt;/Macro&gt;</pre> <p>Macro names are case-insensitive, like httpd configuration directives. However, variable names are case sensitive.</p> <p>You would then invoke this macro several times to create virtual hosts:</p> <pre class=\"prettyprint lang-config\">Use VHost example example.com\nUse VHost myhost hostname.org\nUse VHost apache apache.org\n\nUndefMacro VHost</pre> <p>At server startup time, each of these <code class=\"directive\"><a href=\"#use\">Use</a></code> invocations would be expanded into a full virtualhost, as described by the <code class=\"directive\"><a href=\"#macro\">&lt;Macro&gt;</a></code> definition.</p> <p>The <code class=\"directive\"><a href=\"#undefmacro\">UndefMacro</a></code> directive is used so that later macros using the same variable names don't result in conflicting definitions.</p> <p>A more elaborate version of this example may be seen below in the Examples section.</p>   <h2 id=\"tips\">Tips</h2> <p>Parameter names should begin with a sigil such as <code>$</code>, <code>%</code>, or <code>@</code>, so that they are clearly identifiable, and also in order to help deal with interactions with other directives, such as the core <code class=\"directive\"><a href=\"core#define\">Define</a></code> directive. Failure to do so will result in a warning. Nevertheless, you are encouraged to have a good knowledge of your entire server configuration in order to avoid reusing the same variables in different scopes, which can cause confusion.</p> <p>Parameters prefixed with either <code>$</code> or <code>%</code> are not escaped. Parameters prefixes with <code>@</code> are escaped in quotes.</p> <p>Avoid using a parameter which contains another parameter as a prefix, (For example, <code>$win</code> and <code>$winter</code>) as this may cause confusion at expression evaluation time. In the event of such confusion, the longest possible parameter name is used.</p> <p>If you want to use a value within another string, it is useful to surround the parameter in braces, to avoid confusion:</p> <pre class=\"prettyprint lang-config\">&lt;Macro DocRoot ${docroot}&gt;\n    DocumentRoot \"/var/www/${docroot}/htdocs\"\n&lt;/Macro&gt;</pre>   <h2 id=\"examples\">Examples</h2> <h3>Virtual Host Definition</h3> <p>A common usage of <code class=\"module\"><a href=\"mod_macro\">mod_macro</a></code> is for the creation of dynamically-generated virtual hosts.</p> <pre class=\"prettyprint lang-config\">## Define a VHost Macro for repetitive configurations\n\n&lt;Macro VHost $host $port $dir&gt;\n  Listen $port\n  &lt;VirtualHost *:$port&gt;\n\n    ServerName $host\n    DocumentRoot \"$dir\"\n\n    # Public document root\n    &lt;Directory \"$dir\"&gt;\n        Require all granted\n    &lt;/Directory&gt;\n\n    # limit access to intranet subdir.\n    &lt;Directory \"$dir/intranet\"&gt;\n      Require ip 10.0.0.0/8\n    &lt;/Directory&gt;\n  &lt;/VirtualHost&gt;\n&lt;/Macro&gt;\n\n## Use of VHost with different arguments.\n\nUse VHost www.apache.org 80 /vhosts/apache/htdocs\nUse VHost example.org 8080 /vhosts/example/htdocs\nUse VHost www.example.fr 1234 /vhosts/example.fr/htdocs</pre> <h3>Removal of a macro definition</h3> <p>It's recommended that you undefine a macro once you've used it. This avoids confusion in a complex configuration file where there may be conflicts in variable names.</p> <pre class=\"prettyprint lang-config\">&lt;Macro DirGroup $dir $group&gt;\n  &lt;Directory \"$dir\"&gt;\n    Require group $group\n  &lt;/Directory&gt;\n&lt;/Macro&gt;\n\nUse DirGroup /www/apache/private private\nUse DirGroup /www/apache/server  admin\n\nUndefMacro DirGroup</pre>   <div class=\"directive-section\">\n<h2 id=\"macro\">&lt;Macro&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define a configuration file macro</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;Macro name [par1 .. parN]&gt; ... &lt;/Macro&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_macro</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;Macro&gt;</code> directive controls the definition of a macro within the server runtime configuration files. The first argument is the name of the macro. Other arguments are parameters to the macro. It is good practice to prefix parameter names with any of '<code>$%@</code>', and not macro names with such characters. </p> <pre class=\"prettyprint lang-config\">&lt;Macro LocalAccessPolicy&gt;\n    Require ip 10.2.16.0/24\n&lt;/Macro&gt;\n\n&lt;Macro RestrictedAccessPolicy $ipnumbers&gt;\n    Require ip $ipnumbers\n&lt;/Macro&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"undefmacro\">UndefMacro Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Undefine a macro</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>UndefMacro name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_macro</td>\n</tr> </table> <p>The <code class=\"directive\">UndefMacro</code> directive undefines a macro which has been defined before hand.</p> <pre class=\"prettyprint lang-config\">UndefMacro LocalAccessPolicy\nUndefMacro RestrictedAccessPolicy</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"use\">Use Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use a macro</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Use name [value1 ... valueN]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_macro</td>\n</tr> </table> <p>The <code class=\"directive\">Use</code> directive controls the use of a macro. The specified macro is expanded. It must be given the same number of arguments as in the macro definition. The provided values are associated to their corresponding initial parameters and are substituted before processing.</p> <pre class=\"prettyprint lang-config\">Use LocalAccessPolicy\n...\nUse RestrictedAccessPolicy \"192.54.172.0/24 192.54.148.0/24\"</pre> <p>is equivalent, with the macros defined above, to:</p> <pre class=\"prettyprint lang-config\">Require ip 10.2.16.0/24\n...\nRequire ip 192.54.172.0/24 192.54.148.0/24</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_macro.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_macro.html</a>\n  </p>\n</div>\n","mod/mod_nw_ssl":"<h1>Apache Module mod_nw_ssl</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Enable SSL encryption for NetWare</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>nwssl_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_nw_ssl.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>NetWare only</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module enables SSL encryption for a specified port. It takes advantage of the SSL encryption functionality that is built into the NetWare operating system.</p>    <div class=\"directive-section\">\n<h2 id=\"nwssltrustedcerts\">NWSSLTrustedCerts Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>List of additional client certificates</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>NWSSLTrustedCerts filename [filename] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_nw_ssl</td>\n</tr> </table> <p>Specifies a list of client certificate files (DER format) that are used when creating a proxied SSL connection. Each client certificate used by a server must be listed separately in its own <code>.der</code> file.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"nwsslupgradeable\">NWSSLUpgradeable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Allows a connection to be upgraded to an SSL connection upon request</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>NWSSLUpgradeable [IP-address:]portnumber</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_nw_ssl</td>\n</tr> </table> <p>Allow a connection that was created on the specified address and/or port to be upgraded to an SSL connection upon request from the client. The address and/or port must have already be defined previously with a <code class=\"directive\"><a href=\"mpm_common#listen\">Listen</a></code> directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"securelisten\">SecureListen Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables SSL encryption for the specified port</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SecureListen [IP-address:]portnumber Certificate-Name [MUTUAL]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_nw_ssl</td>\n</tr> </table> <p>Specifies the port and the eDirectory based certificate name that will be used to enable SSL encryption. An optional third parameter also enables mutual authentication.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_nw_ssl.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_nw_ssl.html</a>\n  </p>\n</div>\n","mod/mod_proxy_connect":"<h1>Apache Module mod_proxy_connect</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>\n<code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> extension for <code>CONNECT</code> request handling</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_connect_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_connect.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides support for the <code>CONNECT</code> HTTP method. This method is mainly used to tunnel SSL requests through proxy servers.</p> <p>Thus, in order to get the ability of handling <code>CONNECT</code> requests, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_connect\">mod_proxy_connect</a></code> have to be present in the server.</p> <p>CONNECT is also used when the server needs to send an HTTPS request through a forward proxy. In this case the server acts as a CONNECT client. This functionality is part of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_connect\">mod_proxy_connect</a></code> is not needed in this case.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"notes\">Request notes</h2> <p><code class=\"module\"><a href=\"mod_proxy_connect\">mod_proxy_connect</a></code> creates the following request notes for logging using the <code>%{VARNAME}n</code> format in <code class=\"directive\"><a href=\"mod_log_config#logformat\">LogFormat</a></code> or <code class=\"directive\"><a href=\"core#errorlogformat\">ErrorLogFormat</a></code>: </p> <dl> <dt>proxy-source-port</dt> <dd>The local port used for the connection to the backend server.</dd> </dl>   <div class=\"directive-section\">\n<h2 id=\"allowconnect\">AllowCONNECT Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Ports that are allowed to <code>CONNECT</code> through the proxy</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>AllowCONNECT port[-port] [port[-port]] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>AllowCONNECT 443 563</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_connect</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Moved from <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> in Apache 2.3.5. Port ranges available since Apache 2.3.7.</td>\n</tr> </table> <p>The <code class=\"directive\">AllowCONNECT</code> directive specifies a list of port numbers or ranges to which the proxy <code>CONNECT</code> method may connect. Today's browsers use this method when a <code>https</code> connection is requested and proxy tunneling over HTTP is in effect.</p> <p>By default, only the default https port (<code>443</code>) and the default snews port (<code>563</code>) are enabled. Use the <code class=\"directive\">AllowCONNECT</code> directive to override this default and allow connections to the listed ports only.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_connect.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_connect.html</a>\n  </p>\n</div>\n","mod/mod_include":"<h1>Apache Module mod_include</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Server-parsed html documents (Server Side Includes)</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>include_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_include.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides a filter which will process files before they are sent to the client. The processing is controlled by specially formatted SGML comments, referred to as <dfn>elements</dfn>. These elements allow conditional text, the inclusion of other files or programs, as well as the setting and printing of environment variables.</p>     <h2 id=\"enabling\">Enabling Server-Side Includes</h2> <p>Server Side Includes are implemented by the <code>INCLUDES</code> <a href=\"../filter\">filter</a>. If documents containing server-side include directives are given the extension .shtml, the following directives will make Apache parse them and assign the resulting document the mime type of <code>text/html</code>:</p> <pre class=\"prettyprint lang-config\">AddType text/html .shtml\nAddOutputFilter INCLUDES .shtml</pre> <p>The following directive must be given for the directories containing the shtml files (typically in a <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> section, but this directive is also valid in <code>.htaccess</code> files if <code class=\"directive\"><a href=\"core#allowoverride\">AllowOverride</a></code> <code>Options</code> is set):</p> <pre class=\"prettyprint lang-config\">Options +Includes</pre> <p>For backwards compatibility, the <code>server-parsed</code> <a href=\"../handler\">handler</a> also activates the INCLUDES filter. As well, Apache will activate the INCLUDES filter for any document with mime type <code>text/x-server-parsed-html</code> or <code>text/x-server-parsed-html3</code> (and the resulting output will have the mime type <code>text/html</code>).</p> <p>For more information, see our <a href=\"../howto/ssi\">Tutorial on Server Side Includes</a>.</p>   <h2 id=\"pathinfo\">PATH_INFO with Server Side Includes</h2> <p>Files processed for server-side includes no longer accept requests with <code>PATH_INFO</code> (trailing pathname information) by default. You can use the <code class=\"directive\"><a href=\"core#acceptpathinfo\">AcceptPathInfo</a></code> directive to configure the server to accept requests with <code>PATH_INFO</code>.</p>   <h2 id=\"elements\">Available Elements</h2> <p>The document is parsed as an HTML document, with special commands embedded as SGML comments. A command has the syntax: </p> <div class=\"example\"><pre>&lt;!--#element attribute=value attribute=value ... --&gt;</pre></div> <p>The value will often be enclosed in double quotes, but single quotes (<code>'</code>) and backticks (<code>`</code>) are also possible. Many commands only allow a single attribute-value pair. Note that the comment terminator (<code>--&gt;</code>) should be preceded by whitespace to ensure that it isn't considered part of an SSI token. Note that the leading <code>&lt;!--#</code> is <em>one</em> token and may not contain any whitespaces.</p> <p>The allowed elements are listed in the following table:</p> <table class=\"bordered\"> <tr>\n<th>Element</th>\n<th>Description</th>\n</tr> <tr>\n<td><code>comment</code></td> <td>SSI comment</td>\n</tr> <tr>\n<td><code>config</code></td> <td>configure output formats</td>\n</tr> <tr>\n<td><code>echo</code></td> <td>print variables</td>\n</tr> <tr>\n<td><code>exec</code></td> <td>execute external programs</td>\n</tr> <tr>\n<td><code>fsize</code></td> <td>print size of a file</td>\n</tr> <tr>\n<td><code>flastmod</code></td> <td>print last modification time of a file</td>\n</tr> <tr>\n<td><code>include</code></td> <td>include a file</td>\n</tr> <tr>\n<td><code>printenv</code></td> <td>print all available variables</td>\n</tr> <tr>\n<td><code>set</code></td> <td>set a value of a variable</td>\n</tr> </table> <p>SSI elements may be defined by modules other than <code class=\"module\"><a href=\"mod_include\">mod_include</a></code>. In fact, the <code><a href=\"#element.exec\">exec</a></code> element is provided by <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, and will only be available if this module is loaded.</p> <h3><a name=\"element.comment\" id=\"element.comment\">The comment Element</a></h3> <p>This command doesn't output anything. Its only use is to add comments within a file. These comments are not printed.</p> <p>This syntax is available in version 2.4.21 and later.</p> <div class=\"example\"><pre>&lt;!--#comment Blah Blah Blah --&gt;</pre></div> <h3><a name=\"element.config\" id=\"element.config\">The config Element</a></h3> <p>This command controls various aspects of the parsing. The valid attributes are:</p> <dl> <dt>\n<code>echomsg</code> (<em>Apache 2.1 and later</em>)</dt> <dd>\n<p>The value is a message that is sent back to the client if the <code><a href=\"#element.echo\">echo</a></code> element attempts to echo an undefined variable. This overrides any <code class=\"directive\"><a href=\"#ssiundefinedecho\">SSIUndefinedEcho</a></code> directives.</p> <div class=\"example\"><pre>&lt;!--#config echomsg=\"[Value Undefined]\" --&gt;</pre></div> </dd> <dt><code>errmsg</code></dt> <dd>\n<p>The value is a message that is sent back to the client if an error occurs while parsing the document. This overrides any <code class=\"directive\"><a href=\"#ssierrormsg\">SSIErrorMsg</a></code> directives.</p> <div class=\"example\"><pre>&lt;!--#config errmsg=\"[Oops, something broke.]\" --&gt;</pre></div> </dd> <dt><code>sizefmt</code></dt> <dd>\n<p>The value sets the format to be used when displaying the size of a file. Valid values are <code>bytes</code> for a count in bytes, or <code>abbrev</code> for a count in Kb or Mb as appropriate, for example a size of 1024 bytes will be printed as \"1K\".</p> <div class=\"example\"><pre>&lt;!--#config sizefmt=\"abbrev\" --&gt;</pre></div> </dd> <dt><code>timefmt</code></dt> <dd>\n<p>The value is a string to be used by the <code>strftime(3)</code> library routine when printing dates.</p> <div class=\"example\"><pre>&lt;!--#config timefmt=\"\"%R, %B %d, %Y\"\" --&gt;</pre></div> </dd> </dl> <h3><a name=\"element.echo\" id=\"element.echo\">The echo Element</a></h3> <p>This command prints one of the <a href=\"#includevars\">include variables</a> defined below. If the variable is unset, the result is determined by the <code class=\"directive\"><a href=\"#ssiundefinedecho\">SSIUndefinedEcho</a></code> directive. Any dates printed are subject to the currently configured <code>timefmt</code>.</p> <p>Attributes:</p> <dl> <dt><code>var</code></dt> <dd>The value is the name of the variable to print.</dd> <dt><code>decoding</code></dt> <dd>\n<p>Specifies whether Apache should strip an encoding from the variable before processing the variable further. The default is <code>none</code>, where no decoding will be done. If set to <code>url</code>, then URL decoding (also known as %-encoding; this is appropriate for use within URLs in links, etc.) will be performed. If set to <code>urlencoded</code>, application/x-www-form-urlencoded compatible encoding (found in query strings) will be stripped. If set to <code>base64</code>, base64 will be decoded, and if set to <code>entity</code>, HTML entity encoding will be stripped. Decoding is done prior to any further encoding on the variable. Multiple encodings can be stripped by specifying more than one comma separated encoding. The decoding setting will remain in effect until the next decoding attribute is encountered, or the element ends.</p> <p>The <code>decoding</code> attribute must <em>precede</em> the corresponding <code>var</code> attribute to be effective.</p> </dd> <dt><code>encoding</code></dt> <dd>\n<p>Specifies how Apache should encode special characters contained in the variable before outputting them. If set to <code>none</code>, no encoding will be done. If set to <code>url</code>, then URL encoding (also known as %-encoding; this is appropriate for use within URLs in links, etc.) will be performed. If set to <code>urlencoded</code>, application/x-www-form-urlencoded compatible encoding will be performed instead, and should be used with query strings. If set to <code>base64</code>, base64 encoding will be performed. At the start of an <code>echo</code> element, the default is set to <code>entity</code>, resulting in entity encoding (which is appropriate in the context of a block-level HTML element, <em>e.g.</em> a paragraph of text). This can be changed by adding an <code>encoding</code> attribute, which will remain in effect until the next <code>encoding</code> attribute is encountered or the element ends, whichever comes first.</p> <p>The <code>encoding</code> attribute must <em>precede</em> the corresponding <code>var</code> attribute to be effective.</p> <div class=\"warning\"> In order to avoid cross-site scripting issues, you should <em>always</em> encode user supplied data. </div> <div class=\"example\">\n<h3>Example</h3>\n<pre>&lt;!--#echo encoding=\"entity\" var=\"QUERY_STRING\" --&gt;</pre>\n</div> </dd> </dl> <h3><a name=\"element.exec\" id=\"element.exec\">The exec Element</a></h3> <p>The <code>exec</code> command executes a given shell command or CGI script. It requires <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> to be present in the server. If <code class=\"directive\"><a href=\"core#options\">Options</a></code> <code>IncludesNOEXEC</code> is set, this command is completely disabled. The valid attributes are:</p> <dl> <dt><code>cgi</code></dt> <dd>\n<p>The value specifies a (%-encoded) URL-path to the CGI script. If the path does not begin with a slash (/), then it is taken to be relative to the current document. The document referenced by this path is invoked as a CGI script, even if the server would not normally recognize it as such. However, the directory containing the script must be enabled for CGI scripts (with <code class=\"directive\"><a href=\"mod_alias#scriptalias\">ScriptAlias</a></code> or <code class=\"directive\"><a href=\"core#options\">Options</a></code> <code>ExecCGI</code>).</p> <p>The CGI script is given the <code>PATH_INFO</code> and query string (<code>QUERY_STRING</code>) of the original request from the client; these <em>cannot</em> be specified in the URL path. The include variables will be available to the script in addition to the standard <a href=\"mod_cgi\">CGI</a> environment.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre>&lt;!--#exec cgi=\"/cgi-bin/example.cgi\" --&gt;</pre>\n</div> <p>If the script returns a <code>Location:</code> header instead of output, then this will be translated into an HTML anchor.</p> <p>The <code><a href=\"#includevirtual\">include virtual</a></code> element should be used in preference to <code>exec cgi</code>. In particular, if you need to pass additional arguments to a CGI program, using the query string, this cannot be done with <code>exec cgi</code>, but can be done with <code>include virtual</code>, as shown here:</p> <div class=\"example\"><pre>&lt;!--#include virtual=\"/cgi-bin/example.cgi?argument=value\" --&gt;</pre></div> </dd> <dt><code>cmd</code></dt> <dd>\n<p>The server will execute the given string using <code>/bin/sh</code>. The <a href=\"#includevars\">include variables</a> are available to the command, in addition to the usual set of CGI variables.</p> <p>The use of <code><a href=\"#includevirtual\">#include virtual</a></code> is almost always prefered to using either <code>#exec cgi</code> or <code>#exec cmd</code>. The former (<code>#include virtual</code>) uses the standard Apache sub-request mechanism to include files or scripts. It is much better tested and maintained.</p> <p>In addition, on some platforms, like Win32, and on unix when using <a href=\"../suexec\">suexec</a>, you cannot pass arguments to a command in an <code>exec</code> directive, or otherwise include spaces in the command. Thus, while the following will work under a non-suexec configuration on unix, it will not produce the desired result under Win32, or when running suexec:</p> <div class=\"example\"><pre>&lt;!--#exec cmd=\"perl /path/to/perlscript arg1 arg2\" --&gt;</pre></div> </dd> </dl> <h3><a name=\"element.fsize\" id=\"element.fsize\">The fsize Element</a></h3> <p>This command prints the size of the specified file, subject to the <code>sizefmt</code> format specification. Attributes:</p> <dl> <dt><code>file</code></dt> <dd>The value is a path relative to the directory containing the current document being parsed. <div class=\"example\"><pre>This file is &lt;!--#fsize file=\"mod_include.html\" --&gt; bytes.</pre></div> The value of <code>file</code> cannot start with a slash (<code>/</code>), nor can it contain <code>../</code> so as to refer to a file above the current directory or outside of the document root. Attempting to so will result in the error message: <code>The given path was above the root path</code>. </dd> <dt><code>virtual</code></dt> <dd>The value is a (%-encoded) URL-path. If it does not begin with a slash (/) then it is taken to be relative to the current document. Note, that this does <em>not</em> print the size of any CGI output, but the size of the CGI script itself.</dd> </dl> <div class=\"example\"><pre>This file is &lt;!--#fsize virtual=\"/docs/mod/mod_include.html\" --&gt; bytes.</pre></div> <p>Note that in many cases these two are exactly the same thing. However, the <code>file</code> attribute doesn't respect URL-space aliases.</p> <h3><a name=\"element.flastmod\" id=\"element.flastmod\">The flastmod Element</a></h3> <p>This command prints the last modification date of the specified file, subject to the <code>timefmt</code> format specification. The attributes are the same as for the <code><a href=\"#element.fsize\">fsize</a></code> command.</p> <h3><a name=\"element.include\" id=\"element.include\">The include Element</a></h3> <p>This command inserts the text of another document or file into the parsed file. Any included file is subject to the usual access control. If the directory containing the parsed file has <a href=\"core#options\">Options</a> <code>IncludesNOEXEC</code> set, then only documents with a text <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME-type</a> (<code>text/plain</code>, <code>text/html</code> etc.) will be included. Otherwise CGI scripts are invoked as normal using the complete URL given in the command, including any query string.</p> <p>An attribute defines the location of the document, and may appear more than once in an include element; an inclusion is done for each attribute given to the include command in turn. The valid attributes are:</p> <dl> <dt><code>file</code></dt> <dd>The value is a path relative to the directory containing the current document being parsed. It cannot contain <code>../</code>, nor can it be an absolute path. Therefore, you cannot include files that are outside of the document root, or above the current document in the directory structure. The <code>virtual</code> attribute should always be used in preference to this one.</dd> <dt><code><a id=\"includevirtual\" name=\"includevirtual\">virtual</a></code></dt> <dd>\n<p>The value is a (%-encoded) URL-path. The URL cannot contain a scheme or hostname, only a path and an optional query string. If it does not begin with a slash (/) then it is taken to be relative to the current document.</p> <p>A URL is constructed from the attribute, and the output the server would return if the URL were accessed by the client is included in the parsed output. Thus included files can be nested.</p> <p>If the specified URL is a CGI program, the program will be executed and its output inserted in place of the directive in the parsed file. You may include a query string in a CGI url:</p> <div class=\"example\"><pre>&lt;!--#include virtual=\"/cgi-bin/example.cgi?argument=value\" --&gt;</pre></div> <p><code>include virtual</code> should be used in preference to <code>exec cgi</code> to include the output of CGI programs into an HTML document.</p> <p>If the <code class=\"directive\"><a href=\"mod_request#keptbodysize\">KeptBodySize</a></code> directive is correctly configured and valid for this included file, attempts to POST requests to the enclosing HTML document will be passed through to subrequests as POST requests as well. Without the directive, all subrequests are processed as GET requests.</p> </dd> <dt><code>onerror</code></dt> <dd>\n<p>The value is a (%-encoded) URL-path which is shown should a previous attempt to include a file or virtual attribute failed. To be effective, this attribute must be specified after the file or virtual attributes being covered. If the attempt to include the onerror path fails, or if onerror is not specified, the default error message will be included.</p> <div class=\"example\"><pre># Simple example\n&lt;!--#include virtual=\"/not-exist.html\" onerror=\"/error.html\" --&gt;</pre></div> <div class=\"example\"><pre># Dedicated onerror paths\n&lt;!--#include virtual=\"/path-a.html\" onerror=\"/error-a.html\" virtual=\"/path-b.html\" onerror=\"/error-b.html\" --&gt;</pre></div> </dd> </dl> <h3><a name=\"element.printenv\" id=\"element.printenv\">The printenv Element</a></h3> <p>This prints out a plain text listing of all existing variables and their values. Special characters are entity encoded (see the <code><a href=\"#element.echo\">echo</a></code> element for details) before being output. There are no attributes.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre>&lt;pre&gt; &lt;!--#printenv --&gt; &lt;/pre&gt;</pre>\n</div> <h3><a name=\"element.set\" id=\"element.set\">The set Element</a></h3> <p>This sets the value of a variable. Attributes:</p> <dl> <dt><code>var</code></dt> <dd>The name of the variable to set.</dd> <dt><code>value</code></dt> <dd>The value to give a variable.</dd> <dt><code>decoding</code></dt> <dd>\n<p>Specifies whether Apache should strip an encoding from the variable before processing the variable further. The default is <code>none</code>, where no decoding will be done. If set to <code>url</code>, <code>urlencoded</code>, <code>base64</code> or <code>entity</code>, URL decoding, application/x-www-form-urlencoded decoding, base64 decoding or HTML entity decoding will be performed respectively. More than one decoding can be specified by separating with commas. The decoding setting will remain in effect until the next decoding attribute is encountered, or the element ends. The <code>decoding</code> attribute must <em>precede</em> the corresponding <code>var</code> attribute to be effective.</p> </dd> <dt><code>encoding</code></dt> <dd>\n<p>Specifies how Apache should encode special characters contained in the variable before setting them. The default is <code>none</code>, where no encoding will be done. If set to <code>url</code>, <code>urlencoding</code>, <code>base64</code> or <code>entity</code>, URL encoding, application/x-www-form-urlencoded encoding, base64 encoding or HTML entity encoding will be performed respectively. More than one encoding can be specified by separating with commas. The encoding setting will remain in effect until the next encoding attribute is encountered, or the element ends. The <code>encoding</code> attribute must <em>precede</em> the corresponding <code>var</code> attribute to be effective. Encodings are applied after all decodings have been stripped.</p> </dd> </dl> <div class=\"example\">\n<h3>Example</h3>\n<pre>&lt;!--#set var=\"category\" value=\"help\" --&gt;</pre>\n</div>   <h2 id=\"includevars\">Include Variables</h2> <p>In addition to the variables in the standard CGI environment, these are available for the <code>echo</code> command, for <code>if</code> and <code>elif</code>, and to any program invoked by the document.</p> <dl> <dt><code>DATE_GMT</code></dt> <dd>The current date in Greenwich Mean Time.</dd> <dt><code>DATE_LOCAL</code></dt> <dd>The current date in the local time zone.</dd> <dt><code>DOCUMENT_ARGS</code></dt> <dd>This variable contains the query string of the active SSI document, or the empty string if a query string is not included. For subrequests invoked through the <code>include</code> SSI directive, <code>QUERY_STRING</code> will represent the query string of the subrequest and <code>DOCUMENT_ARGS</code> will represent the query string of the SSI document. (Available in Apache HTTP Server 2.4.19 and later.)</dd> <dt><code>DOCUMENT_NAME</code></dt> <dd>The filename (excluding directories) of the document requested by the user.</dd> <dt><code>DOCUMENT_URI</code></dt> <dd>The (%-decoded) URL path of the document requested by the user. Note that in the case of nested include files, this is <em>not</em> the URL for the current document. Note also that if the URL is modified internally (e.g. by an <code class=\"directive\"><a href=\"mod_alias#alias\">alias</a></code> or <code class=\"directive\"><a href=\"mod_dir#directoryindex\">directoryindex</a></code>), the modified URL is shown.</dd> <dt><code>LAST_MODIFIED</code></dt> <dd>The last modification date of the document requested by the user.</dd> <dt><code>QUERY_STRING_UNESCAPED</code></dt> <dd>If a query string is present in the request for the active SSI document, this variable contains the (%-decoded) query string, which is <em>escaped</em> for shell usage (special characters like <code>&amp;</code> etc. are preceded by backslashes). It is not set if a query string is not present. Use <code>DOCUMENT_ARGS</code> if shell escaping is not desired.</dd> </dl>   <h2 id=\"substitution\">Variable Substitution</h2> <p>Variable substitution is done within quoted strings in most cases where they may reasonably occur as an argument to an SSI directive. This includes the <code>config</code>, <code>exec</code>, <code>flastmod</code>, <code>fsize</code>, <code>include</code>, <code>echo</code>, and <code>set</code> directives. If <code class=\"directive\"><a href=\"#ssilegacyexprparser\">SSILegacyExprParser</a></code> is set to <code>on</code>, substitution also occurs in the arguments to conditional operators. You can insert a literal dollar sign into the string using backslash quoting:</p> <div class=\"example\"><pre>&lt;!--#set var=\"cur\" value=\"\\$test\" --&gt;</pre></div> <p>If a variable reference needs to be substituted in the middle of a character sequence that might otherwise be considered a valid identifier in its own right, it can be disambiguated by enclosing the reference in braces, <em>a la</em> shell substitution:</p> <div class=\"example\"><pre>&lt;!--#set var=\"Zed\" value=\"${REMOTE_HOST}_${REQUEST_METHOD}\" --&gt;</pre></div> <p>This will result in the <code>Zed</code> variable being set to \"<code>X_Y</code>\" if <code>REMOTE_HOST</code> is \"<code>X</code>\" and <code>REQUEST_METHOD</code> is \"<code>Y</code>\".</p>   <h2 id=\"flowctrl\">Flow Control Elements</h2> <p>The basic flow control elements are:</p> <div class=\"example\"><pre>&lt;!--#if expr=\"test_condition\" --&gt;\n&lt;!--#elif expr=\"test_condition\" --&gt;\n&lt;!--#else --&gt;\n&lt;!--#endif --&gt;</pre></div> <p>The <code>if</code> element works like an if statement in a programming language. The test condition is evaluated and if the result is true, then the text until the next <code>elif</code>, <code>else</code> or <code>endif</code> element is included in the output stream.</p> <p>The <code>elif</code> or <code>else</code> statements are used to put text into the output stream if the original <var>test_condition</var> was false. These elements are optional.</p> <p>The <code>endif</code> element ends the <code>if</code> element and is required.</p> <p><var>test_condition</var> is a boolean expression which follows the <a href=\"../expr\">ap_expr</a> syntax. The syntax can be changed to be compatible with Apache HTTPD 2.2.x using <code class=\"directive\"><a href=\"#ssilegacyexprparser\">SSILegacyExprParser</a></code>.</p> <p>The SSI variables set with the <code>var</code> element are exported into the request environment and can be accessed with the <code>reqenv</code> function. As a short-cut, the function name <code>v</code> is also available inside <code class=\"module\"><a href=\"mod_include\">mod_include</a></code>.</p> <p>The below example will print \"from local net\" if client IP address belongs to the 10.0.0.0/8 subnet.</p> <div class=\"example\"><pre>&lt;!--#if expr='-R \"10.0.0.0/8\"' --&gt;\n from local net\n &lt;!--#else --&gt;\n from somewhere else\n &lt;!--#endif --&gt;</pre></div> <p>The below example will print \"foo is bar\" if the variable <code>foo</code> is set to the value \"bar\".</p> <div class=\"example\"><pre>&lt;!--#if expr='v(\"foo\") = \"bar\"' --&gt;\n foo is bar\n &lt;!--#endif --&gt;</pre></div> <div class=\"note\">\n<p><strong>Reference Documentation</strong></p> <p>See also: <a href=\"../expr\">Expressions in Apache HTTP Server</a>, for a complete reference and examples. The <em>restricted</em> functions are not available inside <code class=\"module\"><a href=\"mod_include\">mod_include</a></code></p> </div>   <h2 id=\"legacyexpr\">Legacy expression syntax</h2> <p>This section describes the syntax of the <code>#if expr</code> element if <code class=\"directive\"><a href=\"#ssilegacyexprparser\">SSILegacyExprParser</a></code> is set to <code>on</code>.</p> <dl> <dt><code>string</code></dt> <dd>true if <var>string</var> is not empty</dd> <dt><code>-A string</code></dt> <dd>\n<p>true if the URL represented by the string is accessible by configuration, false otherwise. This is useful where content on a page is to be hidden from users who are not authorized to view the URL, such as a link to that URL. Note that the URL is only tested for whether access would be granted, not whether the URL exists.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre>&lt;!--#if expr=\"-A /private\" --&gt;\n Click &lt;a href=\"/private\"&gt;here&lt;/a&gt; to access private information.\n &lt;!--#endif --&gt;</pre>\n</div> </dd> <dt><code>string1 = string2<br> string1 == string2<br> string1 != string2</code></dt> <dd>\n<p>Compare <var>string1</var> with <var>string2</var>. If <var>string2</var> has the form <code>/string2/</code> then it is treated as a regular expression. Regular expressions are implemented by the <a href=\"http://www.pcre.org\">PCRE</a> engine and have the same syntax as those in <a href=\"http://www.perl.com\">perl 5</a>. Note that <code>==</code> is just an alias for <code>=</code> and behaves exactly the same way.</p> <p>If you are matching positive (<code>=</code> or <code>==</code>), you can capture grouped parts of the regular expression. The captured parts are stored in the special variables <code>$1</code> .. <code>$9</code>. The whole string matched by the regular expression is stored in the special variable <code>$0</code></p> <div class=\"example\">\n<h3>Example</h3>\n<pre>&lt;!--#if expr=\"$QUERY_STRING = /^sid=([a-zA-Z0-9]+)/\" --&gt;\n &lt;!--#set var=\"session\" value=\"$1\" --&gt;\n &lt;!--#endif --&gt;</pre>\n</div> </dd> <dt><code>string1 &lt; string2<br> string1 &lt;= string2<br> string1 &gt; string2<br> string1 &gt;= string2</code></dt> <dd>Compare <var>string1</var> with <var>string2</var>. Note, that strings are compared <em>literally</em> (using <code>strcmp(3)</code>). Therefore the string \"100\" is less than \"20\".</dd> <dt><code>( test_condition )</code></dt> <dd>true if <var>test_condition</var> is true</dd> <dt><code>! test_condition</code></dt> <dd>true if <var>test_condition</var> is false</dd> <dt><code>test_condition1 &amp;&amp; test_condition2</code></dt> <dd>true if both <var>test_condition1</var> and <var>test_condition2</var> are true</dd> <dt><code>test_condition1 || test_condition2</code></dt> <dd>true if either <var>test_condition1</var> or <var>test_condition2</var> is true</dd> </dl> <p>\"<code>=</code>\" and \"<code>!=</code>\" bind more tightly than \"<code>&amp;&amp;</code>\" and \"<code>||</code>\". \"<code>!</code>\" binds most tightly. Thus, the following are equivalent:</p> <div class=\"example\"><pre>&lt;!--#if expr=\"$a = test1 &amp;&amp; $b = test2\" --&gt;\n&lt;!--#if expr=\"($a = test1) &amp;&amp; ($b = test2)\" --&gt;</pre></div> <p>The boolean operators <code>&amp;&amp;</code> and <code>||</code> share the same priority. So if you want to bind such an operator more tightly, you should use parentheses.</p> <p>Anything that's not recognized as a variable or an operator is treated as a string. Strings can also be quoted: <code>'string'</code>. Unquoted strings can't contain whitespace (blanks and tabs) because it is used to separate tokens such as variables. If multiple strings are found in a row, they are concatenated using blanks. So,</p> <div class=\"example\"><p><code>string1 string2</code> results in <code>string1 string2</code><br> <br> and<br> <br> <code>'string1 string2'</code> results in <code>string1 string2</code>.</p></div> <div class=\"note\">\n<p><strong>Optimization of Boolean Expressions</strong></p> <p>If the expressions become more complex and slow down processing significantly, you can try to optimize them according to the evaluation rules:</p> <ul> <li>Expressions are evaluated from left to right</li> <li>Binary boolean operators (<code>&amp;&amp;</code> and <code>||</code>) are short circuited wherever possible. In conclusion with the rule above that means, <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> evaluates at first the left expression. If the left result is sufficient to determine the end result, processing stops here. Otherwise it evaluates the right side and computes the end result from both left and right results.</li> <li>Short circuit evaluation is turned off as long as there are regular expressions to deal with. These must be evaluated to fill in the backreference variables (<code>$1</code> .. <code>$9</code>).</li> </ul> <p>If you want to look how a particular expression is handled, you can recompile <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> using the <code>-DDEBUG_INCLUDE</code> compiler option. This inserts for every parsed expression tokenizer information, the parse tree and how it is evaluated into the output sent to the client.</p> </div> <div class=\"note\">\n<p><strong>Escaping slashes in regex strings</strong></p> <p>All slashes which are not intended to act as delimiters in your regex must be escaped. This is regardless of their meaning to the regex engine.</p> </div>   <div class=\"directive-section\">\n<h2 id=\"ssiendtag\">SSIEndTag Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>String that ends an include element</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSIEndTag tag</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSIEndTag \"--&gt;\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> </table> <p>This directive changes the string that <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> looks for to mark the end of an include element.</p> <pre class=\"prettyprint lang-config\">SSIEndTag \"%&gt;\"</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#ssistarttag\">SSIStartTag</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"ssierrormsg\">SSIErrorMsg Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Error message displayed when there is an SSI error</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSIErrorMsg message</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSIErrorMsg \"[an error occurred while processing this directive]\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> </table> <p>The <code class=\"directive\">SSIErrorMsg</code> directive changes the error message displayed when <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> encounters an error. For production servers you may consider changing the default error message to <code>\"&lt;!-- Error --&gt;\"</code> so that the message is not presented to the user.</p> <p>This directive has the same effect as the <code>&lt;!--#config errmsg=message --&gt;</code> element.</p> <pre class=\"prettyprint lang-config\">SSIErrorMsg \"&lt;!-- Error --&gt;\"</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"ssietag\">SSIETag Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls whether ETags are generated by the server.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSIETag on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSIETag off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.2.15 and later.</td>\n</tr> </table> <p>Under normal circumstances, a file filtered by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> may contain elements that are either dynamically generated, or that may have changed independently of the original file. As a result, by default the server is asked not to generate an <code>ETag</code> header for the response by adding <code>no-etag</code> to the request notes.</p> <p>The <code class=\"directive\">SSIETag</code> directive suppresses this behaviour, and allows the server to generate an <code>ETag</code> header. This can be used to enable caching of the output. Note that a backend server or dynamic content generator may generate an ETag of its own, ignoring <code>no-etag</code>, and this ETag will be passed by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> regardless of the value of this setting. <code class=\"directive\">SSIETag</code> can take on the following values:</p> <dl> <dt><code>off</code></dt> <dd>\n<code>no-etag</code> will be added to the request notes, and the server is asked not to generate an ETag. Where a server ignores the value of <code>no-etag</code> and generates an ETag anyway, the ETag will be respected.</dd> <dt><code>on</code></dt> <dd>Existing ETags will be respected, and ETags generated by the server will be passed on in the response.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"ssilastmodified\">SSILastModified Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Controls whether <code>Last-Modified</code> headers are generated by the server.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSILastModified on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSILastModified off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.2.15 and later.</td>\n</tr> </table> <p>Under normal circumstances, a file filtered by <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> may contain elements that are either dynamically generated, or that may have changed independently of the original file. As a result, by default the <code>Last-Modified</code> header is stripped from the response.</p> <p>The <code class=\"directive\">SSILastModified</code> directive overrides this behaviour, and allows the <code>Last-Modified</code> header to be respected if already present, or set if the header is not already present. This can be used to enable caching of the output. <code class=\"directive\">SSILastModified</code> can take on the following values:</p> <dl> <dt><code>off</code></dt> <dd>The <code>Last-Modified</code> header will be stripped from responses, unless the <code class=\"directive\"><a href=\"#xbithack\">XBitHack</a></code> directive is set to <code>full</code> as described below.</dd> <dt><code>on</code></dt> <dd>The <code>Last-Modified</code> header will be respected if already present in a response, and added to the response if the response is a file and the header is missing. The <code class=\"directive\"><a href=\"#ssilastmodified\">SSILastModified</a></code> directive takes precedence over <code class=\"directive\"><a href=\"#xbithack\">XBitHack</a></code>.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"ssilegacyexprparser\">SSILegacyExprParser Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable compatibility mode for conditional expressions.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSILegacyExprParser on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSILegacyExprParser off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.13 and later.</td>\n</tr> </table> <p>As of version 2.3.13, <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> has switched to the new <a href=\"../expr\">ap_expr</a> syntax for conditional expressions in <code>#if</code> flow control elements. This directive allows to switch to the <a href=\"#legacyexpr\">old syntax</a> which is compatible with Apache HTTPD version 2.2.x and earlier. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"ssistarttag\">SSIStartTag Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>String that starts an include element</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSIStartTag tag</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSIStartTag \"&lt;!--#\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> </table> <p>This directive changes the string that <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> looks for to mark an include element to process.</p> <p>You may want to use this option if you have 2 servers parsing the output of a file each processing different commands (possibly at different times).</p> <pre class=\"prettyprint lang-config\">SSIStartTag \"&lt;%\"\nSSIEndTag   \"%&gt;\"</pre> <p>The example given above, which also specifies a matching <code class=\"directive\"><a href=\"#ssiendtag\">SSIEndTag</a></code>, will allow you to use SSI directives as shown in the example below:</p> <div class=\"example\">\n<h3>SSI directives with alternate start and end tags</h3>\n<pre>&lt;%printenv %&gt;</pre>\n</div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#ssiendtag\">SSIEndTag</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"ssitimeformat\">SSITimeFormat Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Configures the format in which date strings are displayed</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSITimeFormat formatstring</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSITimeFormat \"%A, %d-%b-%Y %H:%M:%S %Z\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> </table> <p>This directive changes the format in which date strings are displayed when echoing <code>DATE</code> environment variables. The <var>formatstring</var> is as in <code>strftime(3)</code> from the C standard library.</p> <p>This directive has the same effect as the <code>&lt;!--#config timefmt=formatstring --&gt;</code> element.</p> <pre class=\"prettyprint lang-config\">SSITimeFormat \"%R, %B %d, %Y\"</pre> <p>The above directive would cause times to be displayed in the format \"22:26, June 14, 2002\".</p> </div>  <div class=\"directive-section\">\n<h2 id=\"ssiundefinedecho\">SSIUndefinedEcho Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>String displayed when an unset variable is echoed</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SSIUndefinedEcho string</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SSIUndefinedEcho \"(none)\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> </table> <p>This directive changes the string that <code class=\"module\"><a href=\"mod_include\">mod_include</a></code> displays when a variable is not set and \"echoed\".</p> <pre class=\"prettyprint lang-config\">SSIUndefinedEcho \"&lt;!-- undef --&gt;\"</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"xbithack\">XBitHack Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Parse SSI directives in files with the execute bit set</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>XBitHack on|off|full</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>XBitHack off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_include</td>\n</tr> </table> <p>The <code class=\"directive\">XBitHack</code> directive controls the parsing of ordinary html documents. This directive only affects files associated with the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME-type</a> <code>text/html</code>. <code class=\"directive\">XBitHack</code> can take on the following values:</p> <dl> <dt><code>off</code></dt> <dd>No special treatment of executable files.</dd> <dt><code>on</code></dt> <dd>Any <code>text/html</code> file that has the user-execute bit set will be treated as a server-parsed html document.</dd> <dt><code>full</code></dt> <dd>As for <code>on</code> but also test the group-execute bit. If it is set, then set the <code>Last-modified</code> date of the returned file to be the last modified time of the file. If it is not set, then no last-modified date is sent. Setting this bit allows clients and proxies to cache the result of the request. <div class=\"note\">\n<p><strong>Note</strong></p> <p>You would not want to use the full option, unless you assure the group-execute bit is unset for every SSI script which might <code>#include</code> a CGI or otherwise produces different output on each hit (or could potentially change on subsequent requests).</p> <p>The <code class=\"directive\"><a href=\"#ssilastmodified\">SSILastModified</a></code> directive takes precedence over the <code class=\"directive\"><a href=\"#xbithack\">XBitHack</a></code> directive when <code class=\"directive\"><a href=\"#ssilastmodified\">SSILastModified</a></code> is set to <code>on</code>.</p> </div> </dd> </dl> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_include.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_include.html</a>\n  </p>\n</div>\n","mod/mod_log_config":"<h1>Apache Module mod_log_config</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Logging of the requests made to the server</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>log_config_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_log_config.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides for flexible logging of client requests. Logs are written in a customizable format, and may be written directly to a file, or to an external program. Conditional logging is provided so that individual requests may be included or excluded from the logs based on characteristics of the request.</p> <p>Three directives are provided by this module: <code class=\"directive\"><a href=\"#transferlog\">TransferLog</a></code> to create a log file, <code class=\"directive\"><a href=\"#logformat\">LogFormat</a></code> to set a custom format, and <code class=\"directive\"><a href=\"#customlog\">CustomLog</a></code> to define a log file and format in one step. The <code class=\"directive\">TransferLog</code> and <code class=\"directive\">CustomLog</code> directives can be used multiple times in each server to cause each request to be logged to multiple files.</p>     <h2 id=\"formats\">Custom Log Formats</h2> <p>The format argument to the <code class=\"directive\"><a href=\"#logformat\">LogFormat</a></code> and <code class=\"directive\"><a href=\"#customlog\">CustomLog</a></code> directives is a string. This string is used to log each request to the log file. It can contain literal characters copied into the log files and the C-style control characters \"\\n\" and \"\\t\" to represent new-lines and tabs. Literal quotes and backslashes should be escaped with backslashes.</p> <p>The characteristics of the request itself are logged by placing \"<code>%</code>\" directives in the format string, which are replaced in the log file by the values as follows:</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Format String</th> <th>Description</th>\n</tr> <tr>\n<td><code>%%</code></td> <td>The percent sign.</td>\n</tr> <tr class=\"odd\">\n<td><code>%a</code></td> <td>Client IP address of the request (see the <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> module).</td>\n</tr> <tr>\n<td><code>%{c}a</code></td> <td>Underlying peer IP address of the connection (see the <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> module).</td>\n</tr> <tr class=\"odd\">\n<td><code>%A</code></td> <td>Local IP-address.</td>\n</tr> <tr>\n<td><code>%B</code></td> <td>Size of response in bytes, excluding HTTP headers.</td>\n</tr> <tr class=\"odd\">\n<td><code>%b</code></td> <td>Size of response in bytes, excluding HTTP headers. In CLF format, <em>i.e.</em> a '<code>-</code>' rather than a 0 when no bytes are sent.</td>\n</tr> <tr>\n<td><code>%{VARNAME}C</code></td> <td>The contents of cookie <var>VARNAME</var> in the request sent to the server. Only version 0 cookies are fully supported.</td>\n</tr> <tr class=\"odd\">\n<td><code>%D</code></td> <td>The time taken to serve the request, in microseconds.</td>\n</tr> <tr>\n<td><code>%{VARNAME}e</code></td> <td>The contents of the environment variable <var>VARNAME</var>.</td>\n</tr> <tr class=\"odd\">\n<td><code>%f</code></td> <td>Filename.</td>\n</tr> <tr>\n<td><code>%h</code></td> <td>Remote hostname. Will log the IP address if <code class=\"directive\"><a href=\"core#hostnamelookups\">HostnameLookups</a></code> is set to <code>Off</code>, which is the default. If it logs the hostname for only a few hosts, you probably have access control directives mentioning them by name. See <a href=\"mod_authz_host#reqhost\">the Require host documentation</a>.</td>\n</tr> <tr class=\"odd\">\n<td><code>%H</code></td> <td>The request protocol.</td>\n</tr> <tr>\n<td><code>%{VARNAME}i</code></td> <td>The contents of <code>VARNAME:</code> header line(s) in the request sent to the server. Changes made by other modules (e.g. <code class=\"module\"><a href=\"mod_headers\">mod_headers</a></code>) affect this. If you're interested in what the request header was prior to when most modules would have modified it, use <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code> to copy the header into an internal environment variable and log that value with the <code>%{VARNAME}e</code> described above. </td>\n</tr> <tr class=\"odd\">\n<td><code>%k</code></td> <td>Number of keepalive requests handled on this connection. Interesting if <code class=\"directive\"><a href=\"core#keepalive\">KeepAlive</a></code> is being used, so that, for example, a '1' means the first keepalive request after the initial one, '2' the second, etc...; otherwise this is always 0 (indicating the initial request).</td>\n</tr> <tr>\n<td><code>%l</code></td> <td>Remote logname (from identd, if supplied). This will return a dash unless <code class=\"module\"><a href=\"mod_ident\">mod_ident</a></code> is present and <code class=\"directive\"><a href=\"mod_ident#identitycheck\">IdentityCheck</a></code> is set <code>On</code>.</td>\n</tr> <tr class=\"odd\">\n<td><code>%L</code></td> <td>The request log ID from the error log (or '-' if nothing has been logged to the error log for this request). Look for the matching error log line to see what request caused what error.</td>\n</tr> <tr>\n<td><code>%m</code></td> <td>The request method.</td>\n</tr> <tr class=\"odd\">\n<td><code>%{VARNAME}n</code></td> <td>The contents of note <var>VARNAME</var> from another module.</td>\n</tr> <tr>\n<td><code>%{VARNAME}o</code></td> <td>The contents of <code>VARNAME:</code> header line(s) in the reply.</td>\n</tr> <tr class=\"odd\">\n<td><code>%p</code></td> <td>The canonical port of the server serving the request.</td>\n</tr> <tr>\n<td><code>%{format}p</code></td> <td>The canonical port of the server serving the request, or the server's actual port, or the client's actual port. Valid formats are <code>canonical</code>, <code>local</code>, or <code>remote</code>. </td>\n</tr> <tr class=\"odd\">\n<td><code>%P</code></td> <td>The process ID of the child that serviced the request.</td>\n</tr> <tr>\n<td><code>%{format}P</code></td> <td>The process ID or thread ID of the child that serviced the request. Valid formats are <code>pid</code>, <code>tid</code>, and <code>hextid</code>. <code>hextid</code> requires APR 1.2.0 or higher. </td>\n</tr> <tr class=\"odd\">\n<td><code>%q</code></td> <td>The query string (prepended with a <code>?</code> if a query string exists, otherwise an empty string).</td>\n</tr> <tr>\n<td><code>%r</code></td> <td>First line of request.</td>\n</tr> <tr class=\"odd\">\n<td><code>%R</code></td> <td>The handler generating the response (if any).</td>\n</tr> <tr>\n<td><code>%s</code></td> <td>Status. For requests that have been internally redirected, this is the status of the <em>original</em> request. Use <code>%&gt;s</code> for the final status.</td>\n</tr> <tr class=\"odd\">\n<td><code>%t</code></td> <td>Time the request was received, in the format <code>[18/Sep/2011:19:18:28 -0400]</code>. The last number indicates the timezone offset from GMT</td>\n</tr> <tr>\n<td><code>%{format}t</code></td> <td>The time, in the form given by format, which should be in an extended <code>strftime(3)</code> format (potentially localized). If the format starts with <code>begin:</code> (default) the time is taken at the beginning of the request processing. If it starts with <code>end:</code> it is the time when the log entry gets written, close to the end of the request processing. In addition to the formats supported by <code>strftime(3)</code>, the following format tokens are supported: <table> <tr>\n<td><code>sec</code></td>\n<td>number of seconds since the Epoch</td>\n</tr> <tr>\n<td><code>msec</code></td>\n<td>number of milliseconds since the Epoch</td>\n</tr> <tr>\n<td><code>usec</code></td>\n<td>number of microseconds since the Epoch</td>\n</tr> <tr>\n<td><code>msec_frac</code></td>\n<td>millisecond fraction</td>\n</tr> <tr>\n<td><code>usec_frac</code></td>\n<td>microsecond fraction</td>\n</tr> </table> These tokens can not be combined with each other or <code>strftime(3)</code> formatting in the same format string. You can use multiple <code>%{format}t</code> tokens instead. </td>\n</tr> <tr class=\"odd\">\n<td><code>%T</code></td> <td>The time taken to serve the request, in seconds.</td>\n</tr> <tr>\n<td><code>%{UNIT}T</code></td> <td>The time taken to serve the request, in a time unit given by <code>UNIT</code>. Valid units are <code>ms</code> for milliseconds, <code>us</code> for microseconds, and <code>s</code> for seconds. Using <code>s</code> gives the same result as <code>%T</code> without any format; using <code>us</code> gives the same result as <code>%D</code>. Combining <code>%T</code> with a unit is available in 2.4.13 and later.</td>\n</tr> <tr class=\"odd\">\n<td><code>%u</code></td> <td>Remote user if the request was authenticated. May be bogus if return status (<code>%s</code>) is 401 (unauthorized).</td>\n</tr> <tr>\n<td><code>%U</code></td> <td>The URL path requested, not including any query string.</td>\n</tr> <tr class=\"odd\">\n<td><code>%v</code></td> <td>The canonical <code class=\"directive\"><a href=\"core#servername\">ServerName</a></code> of the server serving the request.</td>\n</tr> <tr>\n<td><code>%V</code></td> <td>The server name according to the <code class=\"directive\"><a href=\"core#usecanonicalname\">UseCanonicalName</a></code> setting.</td>\n</tr> <tr class=\"odd\">\n<td><code>%X</code></td> <td>Connection status when response is completed: <table> <tr>\n<td>\n<code>X</code> =</td> <td>Connection aborted before the response completed.</td>\n</tr> <tr>\n<td>\n<code>+</code> =</td> <td>Connection may be kept alive after the response is sent.</td>\n</tr> <tr>\n<td>\n<code>-</code> = </td> <td>Connection will be closed after the response is sent.</td>\n</tr> </table> </td>\n</tr> <tr>\n<td><code>%I</code></td> <td>Bytes received, including request and headers. Cannot be zero. You need to enable <code class=\"module\"><a href=\"mod_logio\">mod_logio</a></code> to use this.</td>\n</tr> <tr class=\"odd\">\n<td><code>%O</code></td> <td>Bytes sent, including headers. May be zero in rare cases such as when a request is aborted before a response is sent. You need to enable <code class=\"module\"><a href=\"mod_logio\">mod_logio</a></code> to use this.</td>\n</tr> <tr>\n<td><code>%S</code></td> <td>Bytes transferred (received and sent), including request and headers, cannot be zero. This is the combination of %I and %O. You need to enable <code class=\"module\"><a href=\"mod_logio\">mod_logio</a></code> to use this.</td>\n</tr> <tr class=\"odd\">\n<td><code>%{VARNAME}^ti</code></td> <td>The contents of <code>VARNAME:</code> trailer line(s) in the request sent to the server. </td>\n</tr> <tr>\n<td><code>%{VARNAME}^to</code></td> <td>The contents of <code>VARNAME:</code> trailer line(s) in the response sent from the server. </td>\n</tr> </table> <h3><a name=\"modifiers\" id=\"modifiers\">Modifiers</a></h3> <p>Particular items can be restricted to print only for responses with specific HTTP status codes by placing a comma-separated list of status codes immediately following the \"%\". The status code list may be preceded by a \"<code>!</code>\" to indicate negation.</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Format String</th> <th>Meaning</th>\n</tr> <tr> <td><code>%400,501{User-agent}i</code></td> <td>Logs <code>User-agent</code> on 400 errors and 501 errors only. For other status codes, the literal string <code>\"-\"</code> will be logged.</td>\n</tr> <tr class=\"odd\">\n<td><code>%!200,304,302{Referer}i</code></td> <td>Logs <code>Referer</code> on all requests that do <em>not</em> return one of the three specified codes, \"<code>-</code>\" otherwise. </td>\n</tr> </table> <p>The modifiers \"&lt;\" and \"&gt;\" can be used for requests that have been internally redirected to choose whether the original or final (respectively) request should be consulted. By default, the <code>%</code> directives <code>%s, %U, %T, %D,</code> and <code>%r</code> look at the original request while all others look at the final request. So for example, <code>%&gt;s</code> can be used to record the final status of the request and <code>%&lt;u</code> can be used to record the original authenticated user on a request that is internally redirected to an unauthenticated resource.</p> <h3><a name=\"format-notes\" id=\"format-notes\">Format Notes</a></h3> <p>For security reasons, starting with version 2.0.46, non-printable and other special characters in <code>%r</code>, <code>%i</code> and <code>%o</code> are escaped using <code>\\xhh</code> sequences, where <var>hh</var> stands for the hexadecimal representation of the raw byte. Exceptions from this rule are <code>\"</code> and <code>\\</code>, which are escaped by prepending a backslash, and all whitespace characters, which are written in their C-style notation (<code>\\n</code>, <code>\\t</code>, etc). In versions prior to 2.0.46, no escaping was performed on these strings so you had to be quite careful when dealing with raw log files.</p> <p>Since httpd 2.0, unlike 1.3, the <code>%b</code> and <code>%B</code> format strings do not represent the number of bytes sent to the client, but simply the size in bytes of the HTTP response (which will differ, for instance, if the connection is aborted, or if SSL is used). The <code>%O</code> format provided by <code class=\"module\"><a href=\"mod_logio\">mod_logio</a></code> will log the actual number of bytes sent over the network.</p> <div class=\"note\"> <p>Note: <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> is implemented as a quick-handler and not as a standard handler. Therefore, the <code>%R</code> format string will not return any handler information when content caching is involved.</p> </div> <h3><a name=\"examples\" id=\"examples\">Examples</a></h3> <p>Some commonly used log format strings are:</p> <dl> <dt>Common Log Format (CLF)</dt> <dd><code>\"%h %l %u %t \\\"%r\\\" %&gt;s %b\"</code></dd> <dt>Common Log Format with Virtual Host</dt> <dd><code>\"%v %h %l %u %t \\\"%r\\\" %&gt;s %b\"</code></dd> <dt>NCSA extended/combined log format</dt> <dd><code>\"%h %l %u %t \\\"%r\\\" %&gt;s %b \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"\"</code></dd> <dt>Referer log format</dt> <dd><code>\"%{Referer}i -&gt; %U\"</code></dd> <dt>Agent (Browser) log format</dt> <dd><code>\"%{User-agent}i\"</code></dd> </dl> <p>You can use the <code>%{format}t</code> directive multiple times to build up a time format using the extended format tokens like <code>msec_frac</code>:</p> <dl> <dt>Timestamp including milliseconds</dt> <dd><code>\"%{%d/%b/%Y %T}t.%{msec_frac}t %{%z}t\"</code></dd> </dl>   <h2 id=\"security\">Security Considerations</h2> <p>See the <a href=\"../misc/security_tips#serverroot\">security tips</a> document for details on why your security could be compromised if the directory where logfiles are stored is writable by anyone other than the user that starts the server.</p>   <div class=\"directive-section\">\n<h2 id=\"bufferedlogs\">BufferedLogs Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Buffer log entries in memory before writing to disk</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BufferedLogs On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>BufferedLogs Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_log_config</td>\n</tr> </table> <p>The <code class=\"directive\">BufferedLogs</code> directive causes <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code> to store several log entries in memory and write them together to disk, rather than writing them after each request. On some systems, this may result in more efficient disk access and hence higher performance. It may be set only once for the entire server; it cannot be configured per virtual-host.</p> <div class=\"note\">This directive should be used with caution as a crash might cause loss of logging data.</div> </div>  <div class=\"directive-section\">\n<h2 id=\"customlog\">CustomLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets filename and format of log file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CustomLog file|pipe format|nickname [env=[!]environment-variable| expr=expression]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_log_config</td>\n</tr> </table> <p>The <code class=\"directive\">CustomLog</code> directive is used to log requests to the server. A log format is specified, and the logging can optionally be made conditional on request characteristics using environment variables.</p> <p>The first argument, which specifies the location to which the logs will be written, can take one of the following two types of values:</p> <dl> <dt><var>file</var></dt> <dd>A filename, relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>.</dd> <dt><var>pipe</var></dt> <dd>The pipe character \"<code>|</code>\", followed by the path to a program to receive the log information on its standard input. See the notes on <a href=\"../logs#piped\">piped logs</a> for more information. <div class=\"warning\">\n<p><strong>Security:</strong></p> <p>If a program is used, then it will be run as the user who started <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code>. This will be root if the server was started by root; be sure that the program is secure.</p> </div> <div class=\"warning\">\n<p><strong>Note</strong></p> <p>When entering a file path on non-Unix platforms, care should be taken to make sure that only forward slashed are used even though the platform may allow the use of back slashes. In general it is a good idea to always use forward slashes throughout the configuration files.</p> </div>\n</dd> </dl> <p>The second argument specifies what will be written to the log file. It can specify either a <var>nickname</var> defined by a previous <code class=\"directive\"><a href=\"#logformat\">LogFormat</a></code> directive, or it can be an explicit <var>format</var> string as described in the <a href=\"#formats\">log formats</a> section.</p> <p>For example, the following two sets of directives have exactly the same effect:</p> <pre class=\"prettyprint lang-config\"># CustomLog with format nickname\nLogFormat \"%h %l %u %t \\\"%r\\\" %&gt;s %b\" common\nCustomLog \"logs/access_log\" common\n\n# CustomLog with explicit format string\nCustomLog \"logs/access_log\" \"%h %l %u %t \\\"%r\\\" %&gt;s %b\"</pre> <p>The third argument is optional and controls whether or not to log a particular request. The condition can be the presence or absence (in the case of a '<code>env=!name</code>' clause) of a particular variable in the server <a href=\"../env\">environment</a>. Alternatively, the condition can be expressed as arbitrary boolean <a href=\"../expr\">expression</a>. If the condition is not satisfied, the request will not be logged. References to HTTP headers in the expression will not cause the header names to be added to the Vary header.</p> <p>Environment variables can be set on a per-request basis using the <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code> and/or <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> modules. For example, if you want to record requests for all GIF images on your server in a separate logfile but not in your main log, you can use:</p> <pre class=\"prettyprint lang-config\">SetEnvIf Request_URI \\.gif$ gif-image\nCustomLog \"gif-requests.log\" common env=gif-image\nCustomLog \"nongif-requests.log\" common env=!gif-image</pre> <p>Or, to reproduce the behavior of the old RefererIgnore directive, you might use the following:</p> <pre class=\"prettyprint lang-config\">SetEnvIf Referer example\\.com localreferer\nCustomLog \"referer.log\" referer env=!localreferer</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"globallog\">GlobalLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets filename and format of log file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>GlobalLogfile|pipe format|nickname [env=[!]environment-variable| expr=expression]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_log_config</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.4.19 and later</td>\n</tr> </table> <p>The <code class=\"directive\">GlobalLog</code> directive defines a log shared by the main server configuration and all defined virtual hosts.</p> <p>The <code class=\"directive\">GlobalLog</code> directive is identical to the <code class=\"directive\">CustomLog</code> directive, apart from the following differences:</p> <ul> <li>\n<code class=\"directive\">GlobalLog</code> is not valid in virtual host context.</li> <li>\n<code class=\"directive\">GlobalLog</code> is used by virtual hosts that define their own <code class=\"directive\">CustomLog</code>, unlike a globally specified <code class=\"directive\">CustomLog</code>.</li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"logformat\">LogFormat Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Describes a format for use in a log file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>LogFormat format|nickname [nickname]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>LogFormat \"%h %l %u %t \\\"%r\\\" %&gt;s %b\"</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_log_config</td>\n</tr> </table> <p>This directive specifies the format of the access log file.</p> <p>The <code class=\"directive\">LogFormat</code> directive can take one of two forms. In the first form, where only one argument is specified, this directive sets the log format which will be used by logs specified in subsequent <code class=\"directive\">TransferLog</code> directives. The single argument can specify an explicit <var>format</var> as discussed in the <a href=\"#formats\">custom log formats</a> section above. Alternatively, it can use a <var>nickname</var> to refer to a log format defined in a previous <code class=\"directive\">LogFormat</code> directive as described below.</p> <p>The second form of the <code class=\"directive\">LogFormat</code> directive associates an explicit <var>format</var> with a <var>nickname</var>. This <var>nickname</var> can then be used in subsequent <code class=\"directive\">LogFormat</code> or <code class=\"directive\"><a href=\"#customlog\">CustomLog</a></code> directives rather than repeating the entire format string. A <code class=\"directive\">LogFormat</code> directive that defines a nickname <strong>does nothing else</strong> -- that is, it <em>only</em> defines the nickname, it doesn't actually apply the format and make it the default. Therefore, it will not affect subsequent <code class=\"directive\"><a href=\"#transferlog\">TransferLog</a></code> directives. In addition, <code class=\"directive\">LogFormat</code> cannot use one nickname to define another nickname. Note that the nickname should not contain percent signs (<code>%</code>).</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">LogFormat \"%v %h %l %u %t \\\"%r\\\" %&gt;s %b\" vhost_common</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"transferlog\">TransferLog Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify location of a log file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>TransferLog file|pipe</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_log_config</td>\n</tr> </table> <p>This directive has exactly the same arguments and effect as the <code class=\"directive\"><a href=\"#customlog\">CustomLog</a></code> directive, with the exception that it does not allow the log format to be specified explicitly or for conditional logging of requests. Instead, the log format is determined by the most recently specified <code class=\"directive\"><a href=\"#logformat\">LogFormat</a></code> directive which does not define a nickname. Common Log Format is used if no other format has been specified.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">LogFormat \"%h %l %u %t \\\"%r\\\" %&gt;s %b \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"\"\nTransferLog logs/access_log</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_log_config.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_log_config.html</a>\n  </p>\n</div>\n","mod/mod_mime_magic":"<h1>Apache Module mod_mime_magic</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Determines the MIME type of a file by looking at a few bytes of its contents</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>mime_magic_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_mime_magic.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module determines the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME type</a> of files in the same way the Unix <code>file(1)</code> command works: it looks at the first few bytes of the file. It is intended as a \"second line of defense\" for cases that <code class=\"module\"><a href=\"mod_mime\">mod_mime</a></code> can't resolve.</p> <p>This module is derived from a free version of the <code>file(1)</code> command for Unix, which uses \"magic numbers\" and other hints from a file's contents to figure out what the contents are. This module is active only if the magic file is specified by the <code class=\"directive\"><a href=\"#mimemagicfile\">MimeMagicFile</a></code> directive.</p>     <h2 id=\"format\">Format of the Magic File</h2> <p>The contents of the file are plain ASCII text in 4-5 columns. Blank lines are allowed but ignored. Commented lines use a hash mark (<code>#</code>). The remaining lines are parsed for the following columns:</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Column</th>\n<th>Description</th>\n</tr> <tr>\n<td>1</td> <td>byte number to begin checking from<br> \"<code>&gt;</code>\" indicates a dependency upon the previous non-\"<code>&gt;</code>\" line</td>\n</tr> <tr class=\"odd\">\n<td>2</td> <td>\n<p>type of data to match</p> <table class=\"bordered\"> <tr>\n<td><code>byte</code></td> <td>single character</td>\n</tr> <tr>\n<td><code>short</code></td> <td>machine-order 16-bit integer</td>\n</tr> <tr>\n<td><code>long</code></td> <td>machine-order 32-bit integer</td>\n</tr> <tr>\n<td><code>string</code></td> <td>arbitrary-length string</td>\n</tr> <tr>\n<td><code>date</code></td> <td>long integer date (seconds since Unix epoch/1970)</td>\n</tr> <tr>\n<td><code>beshort</code></td> <td>big-endian 16-bit integer</td>\n</tr> <tr>\n<td><code>belong</code></td> <td>big-endian 32-bit integer</td>\n</tr> <tr>\n<td><code>bedate</code></td> <td>big-endian 32-bit integer date</td>\n</tr> <tr>\n<td><code>leshort</code></td> <td>little-endian 16-bit integer</td>\n</tr> <tr>\n<td><code>lelong</code></td> <td>little-endian 32-bit integer</td>\n</tr> <tr>\n<td><code>ledate</code></td> <td>little-endian 32-bit integer date</td>\n</tr> </table>\n</td>\n</tr> <tr>\n<td>3</td> <td>contents of data to match</td>\n</tr> <tr class=\"odd\">\n<td>4</td> <td>MIME type if matched</td>\n</tr> <tr>\n<td>5</td> <td>MIME encoding if matched (optional)</td>\n</tr> </table> <p>For example, the following magic file lines would recognize some audio formats:</p> <div class=\"example\"><pre># Sun/NeXT audio data\n0      string      .snd\n&gt;12    belong      1       audio/basic\n&gt;12    belong      2       audio/basic\n&gt;12    belong      3       audio/basic\n&gt;12    belong      4       audio/basic\n&gt;12    belong      5       audio/basic\n&gt;12    belong      6       audio/basic\n&gt;12    belong      7       audio/basic\n&gt;12    belong     23       audio/x-adpcm</pre></div> <p>Or these would recognize the difference between <code>*.doc</code> files containing Microsoft Word or FrameMaker documents. (These are incompatible file formats which use the same file suffix.)</p> <div class=\"example\"><pre># Frame\n0  string  \\&lt;MakerFile        application/x-frame\n0  string  \\&lt;MIFFile          application/x-frame\n0  string  \\&lt;MakerDictionary  application/x-frame\n0  string  \\&lt;MakerScreenFon   application/x-frame\n0  string  \\&lt;MML              application/x-frame\n0  string  \\&lt;Book             application/x-frame\n0  string  \\&lt;Maker            application/x-frame\n\n# MS-Word\n0  string  \\376\\067\\0\\043            application/msword\n0  string  \\320\\317\\021\\340\\241\\261  application/msword\n0  string  \\333\\245-\\0\\0\\0           application/msword</pre></div> <p>An optional MIME encoding can be included as a fifth column. For example, this can recognize gzipped files and set the encoding for them.</p> <div class=\"example\"><pre># gzip (GNU zip, not to be confused with\n#       [Info-ZIP/PKWARE] zip archiver)\n\n0  string  \\037\\213  application/octet-stream  x-gzip</pre></div>   <h2 id=\"performance\">Performance Issues</h2> <p>This module is not for every system. If your system is barely keeping up with its load or if you're performing a web server benchmark, you may not want to enable this because the processing is not free.</p> <p>However, an effort was made to improve the performance of the original <code>file(1)</code> code to make it fit in a busy web server. It was designed for a server where there are thousands of users who publish their own documents. This is probably very common on intranets. Many times, it's helpful if the server can make more intelligent decisions about a file's contents than the file name allows ...even if just to reduce the \"why doesn't my page work\" calls when users improperly name their own files. You have to decide if the extra work suits your environment.</p>   <h2 id=\"notes\">Notes</h2> <p>The following notes apply to the <code class=\"module\"><a href=\"mod_mime_magic\">mod_mime_magic</a></code> module and are included here for compliance with contributors' copyright restrictions that require their acknowledgment.</p> <div class=\"note\"> <p>mod_mime_magic: MIME type lookup via file magic numbers<br> Copyright (c) 1996-1997 Cisco Systems, Inc.</p> <p>This software was submitted by Cisco Systems to the Apache Group in July 1997. Future revisions and derivatives of this source code must acknowledge Cisco Systems as the original contributor of this module. All other licensing and usage conditions are those of the Apache Group.</p> <p>Some of this code is derived from the free version of the file command originally posted to comp.sources.unix. Copyright info for that program is included below as required.</p> </div> <div class=\"note\"> <p> - Copyright (c) Ian F. Darwin, 1987. Written by Ian F. Darwin.</p> <p>This software is not subject to any license of the American Telephone and Telegraph Company or of the Regents of the University of California.</p> <p>Permission is granted to anyone to use this software for any purpose on any computer system, and to alter it and redistribute it freely, subject to the following restrictions:</p> <ol> <li>The author is not responsible for the consequences of use of this software, no matter how awful, even if they arise from flaws in it.</li> <li>The origin of this software must not be misrepresented, either by explicit claim or by omission. Since few users ever read sources, credits must appear in the documentation.</li> <li>Altered versions must be plainly marked as such, and must not be misrepresented as being the original software. Since few users ever read sources, credits must appear in the documentation.</li> <li>This notice may not be removed or altered.</li> </ol> </div> <div class=\"note\"> <p>For compliance with Mr Darwin's terms: this has been very significantly modified from the free \"file\" command.</p> <ul> <li>all-in-one file for compilation convenience when moving from one version of Apache to the next.</li> <li>Memory allocation is done through the Apache API's pool structure.</li> <li>All functions have had necessary Apache API request or server structures passed to them where necessary to call other Apache API routines. (<em>i.e.</em>, usually for logging, files, or memory allocation in itself or a called function.)</li> <li>struct magic has been converted from an array to a single-ended linked list because it only grows one record at a time, it's only accessed sequentially, and the Apache API has no equivalent of <code>realloc()</code>.</li> <li>Functions have been changed to get their parameters from the server configuration instead of globals. (It should be reentrant now but has not been tested in a threaded environment.)</li> <li>Places where it used to print results to stdout now saves them in a list where they're used to set the MIME type in the Apache request record.</li> <li>Command-line flags have been removed since they will never be used here.</li> </ul> </div>   <div class=\"directive-section\">\n<h2 id=\"mimemagicfile\">MimeMagicFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable MIME-type determination based on file contents using the specified magic file</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MimeMagicFile file-path</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_mime_magic</td>\n</tr> </table> <p>The <code class=\"directive\">MimeMagicFile</code> directive can be used to enable this module, the default file is distributed at <code>conf/magic</code>. Non-rooted paths are relative to the <code class=\"directive\"><a href=\"core#serverroot\">ServerRoot</a></code>. Virtual hosts will use the same file as the main server unless a more specific setting is used, in which case the more specific setting overrides the main server's file.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">MimeMagicFile conf/magic</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_mime_magic.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_mime_magic.html</a>\n  </p>\n</div>\n","mod/mod_privileges":"<h1>Apache Module mod_privileges</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Support for Solaris privileges and for running virtual hosts under different user IDs.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>privileges_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_privileges.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and up, on Solaris 10 and OpenSolaris platforms</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module enables different Virtual Hosts to run with different Unix <var>User</var> and <var>Group</var> IDs, and with different <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">Solaris Privileges</a>. In particular, it offers a solution to the problem of privilege separation between different Virtual Hosts, first promised by the abandoned perchild MPM. It also offers other security enhancements.</p> <p>Unlike perchild, <code class=\"module\"><a href=\"mod_privileges\">mod_privileges</a></code> is not itself an MPM. It works <em>within</em> a processing model to set privileges and User/Group <em>per request</em> in a running process. It is therefore not compatible with a threaded MPM, and will refuse to run under one.</p> <p><code class=\"module\"><a href=\"mod_privileges\">mod_privileges</a></code> raises security issues similar to those of <a href=\"../suexec\">suexec</a>. But unlike suexec, it applies not only to CGI programs but to the entire request processing cycle, including in-process applications and subprocesses. It is ideally suited to running PHP applications under <strong>mod_php</strong>, which is also incompatible with threaded MPMs. It is also well-suited to other in-process scripting applications such as <strong>mod_perl</strong>, <strong>mod_python</strong>, and <strong>mod_ruby</strong>, and to applications implemented in C as apache modules where privilege separation is an issue.</p>     <h2 id=\"security\">Security Considerations</h2> <p><code class=\"module\"><a href=\"mod_privileges\">mod_privileges</a></code> introduces new security concerns in situations where <strong>untrusted code</strong> may be run <strong>within the webserver process</strong>. This applies to untrusted modules, and scripts running under modules such as mod_php or mod_perl. Scripts running externally (e.g. as CGI or in an appserver behind mod_proxy or mod_jk) are NOT affected.</p> <p>The basic security concerns with mod_privileges are:</p> <ul>\n<li>Running as a system user introduces the same security issues as mod_suexec, and near-equivalents such as cgiwrap and suphp.</li> <li>A privileges-aware malicious user extension (module or script) could escalate its privileges to anything available to the httpd process in any virtual host. This introduces new risks if (and only if) mod_privileges is compiled with the <var>BIG_SECURITY_HOLE</var> option.</li> <li>A privileges-aware malicious user extension (module or script) could escalate privileges to set its user ID to another system user (and/or group).</li> </ul> <p>The <code class=\"directive\">PrivilegesMode</code> directive allows you to select either <var>FAST</var> or <var>SECURE</var> mode. You can mix modes, using <var>FAST</var> mode for trusted users and fully-audited code paths, while imposing SECURE mode where an untrusted user has scope to introduce code.</p> <p>Before describing the modes, we should also introduce the target use cases: Benign vs Hostile. In a benign situation, you want to separate users for their convenience, and protect them and the server against the risks posed by honest mistakes, but you trust your users are not deliberately subverting system security. In a hostile situation - e.g. commercial hosting - you may have users deliberately attacking the system or each other.</p> <dl> <dt>FAST mode</dt> <dd>In <var>FAST</var> mode, requests are run in-process with the selected uid/gid and privileges, so the overhead is negligible. This is suitable for benign situations, but is not secure against an attacker escalating privileges with an in-process module or script.</dd> <dt>SECURE mode</dt> <dd>A request in <var>SECURE</var> mode forks a subprocess, which then drops privileges. This is a very similar case to running CGI with suexec, but for the entire request cycle, and with the benefit of fine-grained control of privileges.</dd> </dl> <p>You can select different <code class=\"directive\">PrivilegesMode</code>s for each virtual host, and even in a directory context within a virtual host. <var>FAST</var> mode is appropriate where the user(s) are trusted and/or have no privilege to load in-process code. <var>SECURE</var> mode is appropriate to cases where untrusted code might be run in-process. However, even in <var>SECURE</var> mode, there is no protection against a malicious user who is able to introduce privileges-aware code running <em>before the start of the request-processing cycle.</em></p>   <div class=\"directive-section\">\n<h2 id=\"dtraceprivileges\">DTracePrivileges Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether the privileges required by dtrace are enabled.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>DTracePrivileges On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>DTracePrivileges Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM).</td>\n</tr> </table> <p>This server-wide directive determines whether Apache will run with the <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">privileges</a> required to run <a href=\"http://sosc-dr.sun.com/bigadmin/content/dtrace/\">dtrace</a>. Note that <var>DTracePrivileges On</var> will not in itself activate DTrace, but <var>DTracePrivileges Off</var> will prevent it working.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"privilegesmode\">PrivilegesMode Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Trade off processing speed and efficiency vs security against malicious privileges-aware code.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>PrivilegesMode FAST|SECURE|SELECTIVE</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>PrivilegesMode FAST</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM).</td>\n</tr> </table>\n<p>This directive trades off performance vs security against malicious, privileges-aware code. In <var>SECURE</var> mode, each request runs in a secure subprocess, incurring a substantial performance penalty. In <var>FAST</var> mode, the server is not protected against escalation of privileges as discussed above.</p> <p>This directive differs slightly between a <code>&lt;Directory&gt;</code> context (including equivalents such as Location/Files/If) and a top-level or <code>&lt;VirtualHost&gt;</code>.</p> <p>At top-level, it sets a default that will be inherited by virtualhosts. In a virtual host, FAST or SECURE mode acts on the entire HTTP request, and any settings in a <code>&lt;Directory&gt;</code> context will be <strong>ignored</strong>. A third pseudo-mode SELECTIVE defers the choice of FAST vs SECURE to directives in a <code>&lt;Directory&gt;</code> context.</p> <p>In a <code>&lt;Directory&gt;</code> context, it is applicable only where SELECTIVE mode was set for the VirtualHost. Only FAST or SECURE can be set in this context (SELECTIVE would be meaningless).</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> Where SELECTIVE mode is selected for a virtual host, the activation of privileges must be deferred until <em>after</em> the mapping phase of request processing has determined what <code>&lt;Directory&gt;</code> context applies to the request. This might give an attacker opportunities to introduce code through a <code class=\"directive\"><a href=\"mod_rewrite#rewritemap\">RewriteMap</a></code> running at top-level or <code>&lt;VirtualHost&gt;</code> context <em>before</em> privileges have been dropped and userid/gid set. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"vhostcgimode\">VHostCGIMode Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether the virtualhost can run subprocesses, and the privileges available to subprocesses.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VHostCGIMode On|Off|Secure</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>VHostCGIMode On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM).</td>\n</tr> </table> <p>Determines whether the virtual host is allowed to run fork and exec, the <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">privileges</a> required to run subprocesses. If this is set to <var>Off</var> the virtualhost is denied the privileges and will not be able to run traditional CGI programs or scripts under the traditional <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, nor similar external programs such as those created by <code class=\"module\"><a href=\"mod_ext_filter\">mod_ext_filter</a></code> or <code class=\"directive\"><a href=\"mod_rewrite#rewritemap\">RewriteMap</a></code> <var>prog</var>. Note that it does not prevent CGI programs running under alternative process and security models such as <a href=\"https://httpd.apache.org/mod_fcgid/\">mod_fcgid</a>, which is a recommended solution in Solaris.</p> <p>If set to <var>On</var> or <var>Secure</var>, the virtual host is permitted to run external programs and scripts as above. Setting <code class=\"directive\">VHostCGIMode</code> <var>Secure</var> has the effect of denying privileges to the subprocesses, as described for <code class=\"directive\">VHostSecure</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"vhostcgiprivs\">VHostCGIPrivs Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Assign arbitrary privileges to subprocesses created by a virtual host.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VHostPrivs [+-]?privilege-name [[+-]?privilege-name] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>None</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM) and when <code class=\"module\"><a href=\"mod_privileges\">mod_privileges</a></code> is compiled with the <var>BIG_SECURITY_HOLE</var> compile-time option.</td>\n</tr> </table> <p><code class=\"directive\">VHostCGIPrivs</code> can be used to assign arbitrary <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">privileges</a> to subprocesses created by a virtual host, as discussed under <code class=\"directive\">VHostCGIMode</code>. Each <var>privilege-name</var> is the name of a Solaris privilege, such as <var>file_setid</var> or <var>sys_nfs</var>.</p> <p>A <var>privilege-name</var> may optionally be prefixed by + or -, which will respectively allow or deny a privilege. If used with neither + nor -, all privileges otherwise assigned to the virtualhost will be denied. You can use this to override any of the default sets and construct your own privilege set.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>This directive can open huge security holes in apache subprocesses, up to and including running them with root-level powers. Do not use it unless you fully understand what you are doing!</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"vhostgroup\">VHostGroup Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the Group ID under which a virtual host runs.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VHostGroup unix-groupid</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Inherits the group id specified in Group</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM).</td>\n</tr> </table> <p>The <code class=\"directive\">VHostGroup</code> directive sets the Unix group under which the server will process requests to a virtualhost. The group is set before the request is processed and reset afterwards using <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">Solaris Privileges</a>. Since the setting applies to the <em>process</em>, this is not compatible with threaded MPMs.</p> <p><var>Unix-group</var> is one of:</p> <dl> <dt>A group name</dt> <dd>Refers to the given group by name.</dd> <dt>\n<code>#</code> followed by a group number.</dt> <dd>Refers to a group by its number.</dd> </dl> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>This directive cannot be used to run apache as root! Nevertheless, it opens potential security issues similar to those discussed in the <a href=\"../suexec\">suexec</a> documentation.</p>\n</div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_unixd#group\">Group</a></code></li> <li><code class=\"directive\"><a href=\"mod_suexec#suexecusergroup\">SuexecUserGroup</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"vhostprivs\">VHostPrivs Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Assign arbitrary privileges to a virtual host.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VHostPrivs [+-]?privilege-name [[+-]?privilege-name] ...</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>None</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM) and when <code class=\"module\"><a href=\"mod_privileges\">mod_privileges</a></code> is compiled with the <var>BIG_SECURITY_HOLE</var> compile-time option.</td>\n</tr> </table> <p><code class=\"directive\">VHostPrivs</code> can be used to assign arbitrary <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">privileges</a> to a virtual host. Each <var>privilege-name</var> is the name of a Solaris privilege, such as <var>file_setid</var> or <var>sys_nfs</var>.</p> <p>A <var>privilege-name</var> may optionally be prefixed by + or -, which will respectively allow or deny a privilege. If used with neither + nor -, all privileges otherwise assigned to the virtualhost will be denied. You can use this to override any of the default sets and construct your own privilege set.</p> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>This directive can open huge security holes in apache, up to and including running requests with root-level powers. Do not use it unless you fully understand what you are doing!</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"vhostsecure\">VHostSecure Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether the server runs with enhanced security for the virtualhost.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VHostSecure On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>VHostSecure On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM).</td>\n</tr> </table> <p>Determines whether the virtual host processes requests with security enhanced by removal of <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">Privileges</a> that are rarely needed in a webserver, but which are available by default to a normal Unix user and may therefore be required by modules and applications. It is recommended that you retain the default (On) unless it prevents an application running. Since the setting applies to the <em>process</em>, this is not compatible with threaded MPMs.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>If <code class=\"directive\">VHostSecure</code> prevents an application running, this may be a warning sign that the application should be reviewed for security.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"vhostuser\">VHostUser Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the User ID under which a virtual host runs.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VHostUser unix-userid</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Inherits the userid specified in User</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_privileges</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available on Solaris 10 and OpenSolaris with non-threaded MPMs (<code class=\"module\"><a href=\"prefork\">prefork</a></code> or custom MPM).</td>\n</tr> </table> <p>The <code class=\"directive\">VHostUser</code> directive sets the Unix userid under which the server will process requests to a virtualhost. The userid is set before the request is processed and reset afterwards using <a href=\"http://sosc-dr.sun.com/bigadmin/features/articles/least_privilege.jsp\">Solaris Privileges</a>. Since the setting applies to the <em>process</em>, this is not compatible with threaded MPMs.</p> <p><var>Unix-userid</var> is one of:</p> <dl> <dt>A username</dt> <dd>Refers to the given user by name.</dd> <dt>\n<code>#</code> followed by a user number.</dt> <dd>Refers to a user by its number.</dd> </dl> <div class=\"warning\">\n<p><strong>Security</strong></p> <p>This directive cannot be used to run apache as root! Nevertheless, it opens potential security issues similar to those discussed in the <a href=\"../suexec\">suexec</a> documentation.</p>\n</div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code></li> <li><code class=\"directive\"><a href=\"mod_suexec#suexecusergroup\">SuexecUserGroup</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_privileges.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_privileges.html</a>\n  </p>\n</div>\n","mod/mod_proxy_ajp":"<h1>Apache Module mod_proxy_ajp</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>AJP support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_ajp_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_ajp.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.1 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides support for the <code>Apache JServ Protocol version 1.3</code> (hereafter <em>AJP13</em>).</p> <p>Thus, in order to get the ability of handling <code>AJP13</code> protocol, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_ajp\">mod_proxy_ajp</a></code> have to be present in the server.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"usage\">Usage</h2> <p>This module is used to reverse proxy to a backend application server (e.g. Apache Tomcat) using the AJP13 protocol. The usage is similar to an HTTP reverse proxy, but uses the <code>ajp://</code> prefix:</p> <div class=\"example\">\n<h3>Simple Reverse Proxy</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/app\" \"ajp://backend.example.com:8009/app\"</pre> </div> <p>Balancers may also be used:</p> <div class=\"example\">\n<h3>Balancer Reverse Proxy</h3>\n<pre class=\"prettyprint lang-config\">&lt;Proxy \"balancer://cluster\"&gt;\n    BalancerMember \"ajp://app1.example.com:8009\" loadfactor=1\n    BalancerMember \"ajp://app2.example.com:8009\" loadfactor=2\n    ProxySet lbmethod=bytraffic\n&lt;/Proxy&gt;\nProxyPass \"/app\" \"balancer://cluster/app\"</pre> </div> <p>Note that usually no <code class=\"directive\"><a href=\"mod_proxy#proxypassreverse\">ProxyPassReverse</a></code> directive is necessary. The AJP request includes the original host header given to the proxy, and the application server can be expected to generate self-referential headers relative to this host, so no rewriting is necessary.</p> <p>The main exception is when the URL path on the proxy differs from that on the backend. In this case, a redirect header can be rewritten relative to the original host URL (not the backend <code>ajp://</code> URL), for example:</p> <div class=\"example\">\n<h3>Rewriting Proxied Path</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/apps/foo\" \"ajp://backend.example.com:8009/foo\"\nProxyPassReverse \"/apps/foo\" \"http://www.example.com/foo\"</pre> </div> <p>However, it is usually better to deploy the application on the backend server at the same path as the proxy rather than to take this approach. </p>   <h2 id=\"env\">Environment Variables</h2> <p>Environment variables whose names have the prefix <code>AJP_</code> are forwarded to the origin server as AJP request attributes (with the AJP_ prefix removed from the name of the key).</p>   <h2 id=\"overviewprotocol\">Overview of the protocol</h2> <p>The <code>AJP13</code> protocol is packet-oriented. A binary format was presumably chosen over the more readable plain text for reasons of performance. The web server communicates with the servlet container over TCP connections. To cut down on the expensive process of socket creation, the web server will attempt to maintain persistent TCP connections to the servlet container, and to reuse a connection for multiple request/response cycles.</p> <p>Once a connection is assigned to a particular request, it will not be used for any others until the request-handling cycle has terminated. In other words, requests are not multiplexed over connections. This makes for much simpler code at either end of the connection, although it does cause more connections to be open at once.</p> <p>Once the web server has opened a connection to the servlet container, the connection can be in one of the following states:</p> <ul> <li> Idle <br> No request is being handled over this connection. </li> <li> Assigned <br> The connection is handling a specific request.</li> </ul> <p>Once a connection is assigned to handle a particular request, the basic request information (e.g. HTTP headers, etc) is sent over the connection in a highly condensed form (e.g. common strings are encoded as integers). Details of that format are below in Request Packet Structure. If there is a body to the request <code>(content-length &gt; 0)</code>, that is sent in a separate packet immediately after.</p> <p>At this point, the servlet container is presumably ready to start processing the request. As it does so, it can send the following messages back to the web server:</p> <ul> <li>SEND_HEADERS <br>Send a set of headers back to the browser.</li> <li>SEND_BODY_CHUNK <br>Send a chunk of body data back to the browser. </li> <li>GET_BODY_CHUNK <br>Get further data from the request if it hasn't all been transferred yet. This is necessary because the packets have a fixed maximum size and arbitrary amounts of data can be included the body of a request (for uploaded files, for example). (Note: this is unrelated to HTTP chunked transfer).</li> <li>END_RESPONSE <br> Finish the request-handling cycle.</li> </ul> <p>Each message is accompanied by a differently formatted packet of data. See Response Packet Structures below for details.</p>   <h2 id=\"basppacketstruct\">Basic Packet Structure</h2> <p>There is a bit of an XDR heritage to this protocol, but it differs in lots of ways (no 4 byte alignment, for example).</p> <p>AJP13 uses network byte order for all data types.</p> <p>There are four data types in the protocol: bytes, booleans, integers and strings.</p> <dl> <dt><strong>Byte</strong></dt>\n<dd>A single byte.</dd> <dt><strong>Boolean</strong></dt> <dd>A single byte, <code>1 = true</code>, <code>0 = false</code>. Using other non-zero values as true (i.e. C-style) may work in some places, but it won't in others.</dd> <dt><strong>Integer</strong></dt> <dd>A number in the range of <code>0 to 2^16 (32768)</code>. Stored in 2 bytes with the high-order byte first.</dd> <dt><strong>String</strong></dt> <dd>A variable-sized string (length bounded by 2^16). Encoded with the length packed into two bytes first, followed by the string (including the terminating '\\0'). Note that the encoded length does <strong>not</strong> include the trailing '\\0' -- it is like <code>strlen</code>. This is a touch confusing on the Java side, which is littered with odd autoincrement statements to skip over these terminators. I believe the reason this was done was to allow the C code to be extra efficient when reading strings which the servlet container is sending back -- with the terminating \\0 character, the C code can pass around references into a single buffer, without copying. if the \\0 was missing, the C code would have to copy things out in order to get its notion of a string.</dd> </dl> <h3>Packet Size</h3> <p>According to much of the code, the max packet size is <code>8 * 1024 bytes (8K)</code>. The actual length of the packet is encoded in the header.</p> <h3>Packet Headers</h3> <p>Packets sent from the server to the container begin with <code>0x1234</code>. Packets sent from the container to the server begin with <code>AB</code> (that's the ASCII code for A followed by the ASCII code for B). After those first two bytes, there is an integer (encoded as above) with the length of the payload. Although this might suggest that the maximum payload could be as large as 2^16, in fact, the code sets the maximum to be 8K.</p> <table> <tr> <th colspan=\"6\"><em>Packet Format (Server-&gt;Container)</em></th> </tr> <tr> <th>Byte</th> <td>0</td> <td>1</td> <td>2</td> <td>3</td> <td>4...(n+3)</td> </tr> <tr> <th>Contents</th> <td>0x12</td> <td>0x34</td> <td colspan=\"2\">Data Length (n)</td> <td>Data</td> </tr> </table> <table> <tr> <th colspan=\"6\"><em>Packet Format (Container-&gt;Server)</em></th> </tr> <tr> <th>Byte</th> <td>0</td> <td>1</td> <td>2</td> <td>3</td> <td>4...(n+3)</td> </tr> <tr> <th>Contents</th> <td>A</td> <td>B</td> <td colspan=\"2\">Data Length (n)</td> <td>Data</td> </tr> </table> <p>For most packets, the first byte of the payload encodes the type of message. The exception is for request body packets sent from the server to the container -- they are sent with a standard packet header (<code>0x1234</code> and then length of the packet), but without any prefix code after that.</p> <p>The web server can send the following messages to the servlet container:</p> <table> <tr> <td>Code</td> <td>Type of Packet</td> <td>Meaning</td> </tr> <tr> <td>2</td> <td>Forward Request</td> <td>Begin the request-processing cycle with the following data</td> </tr> <tr> <td>7</td> <td>Shutdown</td> <td>The web server asks the container to shut itself down.</td> </tr> <tr> <td>8</td> <td>Ping</td> <td>The web server asks the container to take control (secure login phase).</td> </tr> <tr> <td>10</td> <td>CPing</td> <td>The web server asks the container to respond quickly with a CPong. </td> </tr> <tr> <td>none</td> <td>Data</td> <td>Size (2 bytes) and corresponding body data.</td> </tr> </table> <p>To ensure some basic security, the container will only actually do the <code>Shutdown</code> if the request comes from the same machine on which it's hosted.</p> <p>The first <code>Data</code> packet is send immediately after the <code>Forward Request</code> by the web server.</p> <p>The servlet container can send the following types of messages to the webserver:</p> <table> <tr> <td>Code</td> <td>Type of Packet</td> <td>Meaning</td> </tr> <tr> <td>3</td> <td>Send Body Chunk</td> <td>Send a chunk of the body from the servlet container to the web server (and presumably, onto the browser). </td> </tr> <tr> <td>4</td> <td>Send Headers</td> <td>Send the response headers from the servlet container to the web server (and presumably, onto the browser).</td> </tr> <tr> <td>5</td> <td>End Response</td> <td>Marks the end of the response (and thus the request-handling cycle). </td> </tr> <tr> <td>6</td> <td>Get Body Chunk</td> <td>Get further data from the request if it hasn't all been transferred yet.</td> </tr> <tr> <td>9</td> <td>CPong Reply</td> <td>The reply to a CPing request</td> </tr> </table> <p>Each of the above messages has a different internal structure, detailed below.</p>   <h2 id=\"rpacetstruct\">Request Packet Structure</h2> <p>For messages from the server to the container of type <em>Forward Request</em>:</p> <div class=\"example\"><pre>AJP13_FORWARD_REQUEST :=\n    prefix_code      (byte) 0x02 = JK_AJP13_FORWARD_REQUEST\n    method           (byte)\n    protocol         (string)\n    req_uri          (string)\n    remote_addr      (string)\n    remote_host      (string)\n    server_name      (string)\n    server_port      (integer)\n    is_ssl           (boolean)\n    num_headers      (integer)\n    request_headers *(req_header_name req_header_value)\n    attributes      *(attribut_name attribute_value)\n    request_terminator (byte) OxFF</pre></div> <p>The <code>request_headers</code> have the following structure: </p>\n<div class=\"example\"><pre>req_header_name :=\n    sc_req_header_name | (string)  [see below for how this is parsed]\n\nsc_req_header_name := 0xA0xx (integer)\n\nreq_header_value := (string)</pre></div> <p>The <code>attributes</code> are optional and have the following structure:</p> <div class=\"example\"><pre>attribute_name := sc_a_name | (sc_a_req_attribute string)\n\nattribute_value := (string)</pre></div> <p>Not that the all-important header is <code>content-length</code>, because it determines whether or not the container looks for another packet immediately.</p> <h3>Detailed description of the elements of Forward Request </h3> <h3>Request prefix</h3> <p>For all requests, this will be 2. See above for details on other Prefix codes.</p> <h3>Method</h3> <p>The HTTP method, encoded as a single byte:</p> <table> <tr>\n<td>Command Name</td>\n<td>Code</td>\n</tr> <tr>\n<td>OPTIONS</td>\n<td>1</td>\n</tr> <tr>\n<td>GET</td>\n<td>2</td>\n</tr> <tr>\n<td>HEAD</td>\n<td>3</td>\n</tr> <tr>\n<td>POST</td>\n<td>4</td>\n</tr> <tr>\n<td>PUT</td>\n<td>5</td>\n</tr> <tr>\n<td>DELETE</td>\n<td>6</td>\n</tr> <tr>\n<td>TRACE</td>\n<td>7</td>\n</tr> <tr>\n<td>PROPFIND</td>\n<td>8</td>\n</tr> <tr>\n<td>PROPPATCH</td>\n<td>9</td>\n</tr> <tr>\n<td>MKCOL</td>\n<td>10</td>\n</tr> <tr>\n<td>COPY</td>\n<td>11</td>\n</tr> <tr>\n<td>MOVE</td>\n<td>12</td>\n</tr> <tr>\n<td>LOCK</td>\n<td>13</td>\n</tr> <tr>\n<td>UNLOCK</td>\n<td>14</td>\n</tr> <tr>\n<td>ACL</td>\n<td>15</td>\n</tr> <tr>\n<td>REPORT</td>\n<td>16</td>\n</tr> <tr>\n<td>VERSION-CONTROL</td>\n<td>17</td>\n</tr> <tr>\n<td>CHECKIN</td>\n<td>18</td>\n</tr> <tr>\n<td>CHECKOUT</td>\n<td>19</td>\n</tr> <tr>\n<td>UNCHECKOUT</td>\n<td>20</td>\n</tr> <tr>\n<td>SEARCH</td>\n<td>21</td>\n</tr> <tr>\n<td>MKWORKSPACE</td>\n<td>22</td>\n</tr> <tr>\n<td>UPDATE</td>\n<td>23</td>\n</tr> <tr>\n<td>LABEL</td>\n<td>24</td>\n</tr> <tr>\n<td>MERGE</td>\n<td>25</td>\n</tr> <tr>\n<td>BASELINE_CONTROL</td>\n<td>26</td>\n</tr> <tr>\n<td>MKACTIVITY</td>\n<td>27</td>\n</tr> </table> <p>Later version of ajp13, will transport additional methods, even if they are not in this list.</p> <h3>protocol, req_uri, remote_addr, remote_host, server_name, server_port, is_ssl</h3> <p>These are all fairly self-explanatory. Each of these is required, and will be sent for every request.</p> <h3>Headers</h3> <p>The structure of <code>request_headers</code> is the following: First, the number of headers <code>num_headers</code> is encoded. Then, a series of header name <code>req_header_name</code> / value <code>req_header_value</code> pairs follows. Common header names are encoded as integers, to save space. If the header name is not in the list of basic headers, it is encoded normally (as a string, with prefixed length). The list of common headers <code>sc_req_header_name</code>and their codes is as follows (all are case-sensitive):</p> <table> <tr>\n<td>Name</td>\n<td>Code value</td>\n<td>Code name</td>\n</tr> <tr>\n<td>accept</td>\n<td>0xA001</td>\n<td>SC_REQ_ACCEPT</td>\n</tr> <tr>\n<td>accept-charset</td>\n<td>0xA002</td>\n<td>SC_REQ_ACCEPT_CHARSET </td>\n</tr> <tr>\n<td>accept-encoding</td>\n<td>0xA003</td>\n<td>SC_REQ_ACCEPT_ENCODING </td>\n</tr> <tr>\n<td>accept-language</td>\n<td>0xA004</td>\n<td>SC_REQ_ACCEPT_LANGUAGE </td>\n</tr> <tr>\n<td>authorization</td>\n<td>0xA005</td>\n<td>SC_REQ_AUTHORIZATION</td> </tr> <tr>\n<td>connection</td>\n<td>0xA006</td>\n<td>SC_REQ_CONNECTION</td>\n</tr> <tr>\n<td>content-type</td>\n<td>0xA007</td>\n<td>SC_REQ_CONTENT_TYPE</td> </tr> <tr>\n<td>content-length</td>\n<td>0xA008</td>\n<td>SC_REQ_CONTENT_LENGTH</td> </tr> <tr>\n<td>cookie</td>\n<td>0xA009</td>\n<td>SC_REQ_COOKIE</td>\n</tr> <tr>\n<td>cookie2</td>\n<td>0xA00A</td>\n<td>SC_REQ_COOKIE2</td>\n</tr> <tr>\n<td>host</td>\n<td>0xA00B</td>\n<td>SC_REQ_HOST</td>\n</tr> <tr>\n<td>pragma</td>\n<td>0xA00C</td>\n<td>SC_REQ_PRAGMA</td>\n</tr> <tr>\n<td>referer</td>\n<td>0xA00D</td>\n<td>SC_REQ_REFERER</td>\n</tr> <tr>\n<td>user-agent</td>\n<td>0xA00E</td>\n<td>SC_REQ_USER_AGENT</td>\n</tr> </table> <p>The Java code that reads this grabs the first two-byte integer and if it sees an <code>'0xA0'</code> in the most significant byte, it uses the integer in the second byte as an index into an array of header names. If the first byte is not <code>0xA0</code>, it assumes that the two-byte integer is the length of a string, which is then read in.</p> <p>This works on the assumption that no header names will have length greater than <code>0x9FFF (==0xA000 - 1)</code>, which is perfectly reasonable, though somewhat arbitrary.</p> <div class=\"note\">\n<p><strong>Note:</strong></p> The <code>content-length</code> header is extremely important. If it is present and non-zero, the container assumes that the request has a body (a POST request, for example), and immediately reads a separate packet off the input stream to get that body. </div> <h3>Attributes</h3> <p>The attributes prefixed with a <code>?</code> (e.g. <code>?context</code>) are all optional. For each, there is a single byte code to indicate the type of attribute, and then its value (string or integer). They can be sent in any order (though the C code always sends them in the order listed below). A special terminating code is sent to signal the end of the list of optional attributes. The list of byte codes is:</p> <table> <tr>\n<td>Information</td>\n<td>Code Value</td>\n<td>Type Of Value</td>\n<td>Note</td>\n</tr> <tr>\n<td>?context</td>\n<td>0x01</td>\n<td>-</td>\n<td>Not currently implemented </td>\n</tr> <tr>\n<td>?servlet_path</td>\n<td>0x02</td>\n<td>-</td>\n<td>Not currently implemented </td>\n</tr> <tr>\n<td>?remote_user</td>\n<td>0x03</td>\n<td>String</td>\n<td></td>\n</tr> <tr>\n<td>?auth_type</td>\n<td>0x04</td>\n<td>String</td>\n<td></td>\n</tr> <tr>\n<td>?query_string</td>\n<td>0x05</td>\n<td>String</td>\n<td></td>\n</tr> <tr>\n<td>?jvm_route</td>\n<td>0x06</td>\n<td>String</td>\n<td></td>\n</tr> <tr>\n<td>?ssl_cert</td>\n<td>0x07</td>\n<td>String</td>\n<td></td>\n</tr> <tr>\n<td>?ssl_cipher</td>\n<td>0x08</td>\n<td>String</td>\n<td></td>\n</tr> <tr>\n<td>?ssl_session</td>\n<td>0x09</td>\n<td>String</td>\n<td></td>\n</tr> <tr>\n<td>?req_attribute</td>\n<td>0x0A</td>\n<td>String</td>\n<td>Name (the name of the attribute follows)</td>\n</tr> <tr>\n<td>?ssl_key_size</td>\n<td>0x0B</td>\n<td>Integer</td>\n<td></td>\n</tr> <tr>\n<td>are_done</td>\n<td>0xFF</td>\n<td>-</td>\n<td>request_terminator</td>\n</tr> </table> <p>The <code>context</code> and <code>servlet_path</code> are not currently set by the C code, and most of the Java code completely ignores whatever is sent over for those fields (and some of it will actually break if a string is sent along after one of those codes). I don't know if this is a bug or an unimplemented feature or just vestigial code, but it's missing from both sides of the connection.</p> <p>The <code>remote_user</code> and <code>auth_type</code> presumably refer to HTTP-level authentication, and communicate the remote user's username and the type of authentication used to establish their identity (e.g. Basic, Digest).</p> <p>The <code>query_string</code>, <code>ssl_cert</code>, <code>ssl_cipher</code>, and <code>ssl_session</code> refer to the corresponding pieces of HTTP and HTTPS.</p> <p>The <code>jvm_route</code>, is used to support sticky sessions -- associating a user's sesson with a particular Tomcat instance in the presence of multiple, load-balancing servers.</p> <p>Beyond this list of basic attributes, any number of other attributes can be sent via the <code>req_attribute</code> code <code>0x0A</code>. A pair of strings to represent the attribute name and value are sent immediately after each instance of that code. Environment values are passed in via this method.</p> <p>Finally, after all the attributes have been sent, the attribute terminator, <code>0xFF</code>, is sent. This signals both the end of the list of attributes and also then end of the Request Packet.</p>   <h2 id=\"resppacketstruct\">Response Packet Structure</h2> <p>for messages which the container can send back to the server.</p> <div class=\"example\"><pre>AJP13_SEND_BODY_CHUNK :=\n  prefix_code   3\n  chunk_length  (integer)\n  chunk        *(byte)\n  chunk_terminator (byte) Ox00\n\n\nAJP13_SEND_HEADERS :=\n  prefix_code       4\n  http_status_code  (integer)\n  http_status_msg   (string)\n  num_headers       (integer)\n  response_headers *(res_header_name header_value)\n\nres_header_name :=\n    sc_res_header_name | (string)   [see below for how this is parsed]\n\nsc_res_header_name := 0xA0 (byte)\n\nheader_value := (string)\n\nAJP13_END_RESPONSE :=\n  prefix_code       5\n  reuse             (boolean)\n\n\nAJP13_GET_BODY_CHUNK :=\n  prefix_code       6\n  requested_length  (integer)</pre></div> <h3>Details:</h3> <h3>Send Body Chunk</h3> <p>The chunk is basically binary data, and is sent directly back to the browser.</p> <h3>Send Headers</h3> <p>The status code and message are the usual HTTP things (e.g. <code>200</code> and <code>OK</code>). The response header names are encoded the same way the request header names are. See header_encoding above for details about how the codes are distinguished from the strings.<br> The codes for common headers are:</p> <table> <tr>\n<td>Name</td>\n<td>Code value</td>\n</tr> <tr>\n<td>Content-Type</td>\n<td>0xA001</td>\n</tr> <tr>\n<td>Content-Language</td>\n<td>0xA002</td>\n</tr> <tr>\n<td>Content-Length</td>\n<td>0xA003</td>\n</tr> <tr>\n<td>Date</td>\n<td>0xA004</td>\n</tr> <tr>\n<td>Last-Modified</td>\n<td>0xA005</td>\n</tr> <tr>\n<td>Location</td>\n<td>0xA006</td>\n</tr> <tr>\n<td>Set-Cookie</td>\n<td>0xA007</td>\n</tr> <tr>\n<td>Set-Cookie2</td>\n<td>0xA008</td>\n</tr> <tr>\n<td>Servlet-Engine</td>\n<td>0xA009</td>\n</tr> <tr>\n<td>Status</td>\n<td>0xA00A</td>\n</tr> <tr>\n<td>WWW-Authenticate</td>\n<td>0xA00B</td>\n</tr> </table> <p> After the code or the string header name, the header value is immediately encoded.</p> <h3>End Response</h3> <p>Signals the end of this request-handling cycle. If the <code>reuse</code> flag is true <code>(anything other than 0 in the actual C code)</code>, this TCP connection can now be used to handle new incoming requests. If <code>reuse</code> is false (==0), the connection should be closed.</p> <h3>Get Body Chunk</h3> <p>The container asks for more data from the request (If the body was too large to fit in the first packet sent over or when the request is chunked). The server will send a body packet back with an amount of data which is the minimum of the <code>request_length</code>, the maximum send body size <code>(8186 (8 Kbytes - 6))</code>, and the number of bytes actually left to send from the request body.<br> If there is no more data in the body (i.e. the servlet container is trying to read past the end of the body), the server will send back an <em>empty</em> packet, which is a body packet with a payload length of 0. <code>(0x12,0x34,0x00,0x00)</code></p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_ajp.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_ajp.html</a>\n  </p>\n</div>\n","mod/mod_proxy_express":"<h1>Apache Module mod_proxy_express</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Dynamic mass reverse proxy extension for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_express_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_express.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module creates dynamically configured mass reverse proxies, by mapping the Host: header of the HTTP request to a server name and backend URL stored in a DBM file. This allows for easy use of a huge number of reverse proxies with no configuration changes. It is much less feature-full than <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>, which also provides dynamic growth, but is intended to handle much, much larger numbers of backends. It is ideally suited as a front-end HTTP switch.</p> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div> <div class=\"note\">\n<p><strong>Limitations</strong></p> <ul> <li>This module is not intended to replace the dynamic capability of <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>. Instead, it is intended to be mostly a lightweight and fast alternative to using <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> with <code class=\"directive\">RewriteMap</code> and the <code>[P]</code> flag for mapped reverse proxying. </li> <li>It does not support regex or pattern matching at all. </li> <li>It emulates: <pre class=\"prettyprint lang-config\">&lt;VirtualHost *:80&gt;\n   ServerName front.end.server\n   ProxyPass \"/\" \"back.end.server:port\"\n   ProxyPassReverse \"/\" \"back.end.server:port\"\n&lt;/VirtualHost&gt;</pre> That is, the entire URL is appended to the mapped backend URL. This is in keeping with the intent of being a simple but fast reverse proxy switch. </li> </ul> </div>    <div class=\"directive-section\">\n<h2 id=\"proxyexpressdbmfile\">ProxyExpressDBMFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Pathname to DBM file.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyExpressDBMFile &lt;pathname&gt;</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>None</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_express</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.13 and later</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyExpressDBMFile</code> directive points to the location of the Express map DBM file. This file serves to map the incoming server name, obtained from the Host: header, to a backend URL.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>The file is constructed from a plain text file format using the <code><a href=\"../programs/httxt2dbm\">httxt2dbm</a></code> utility.</p> <div class=\"example\">\n<p><strong>ProxyExpress map file</strong></p>\n<pre>##\n##express-map.txt:\n##\n\nwww1.example.com http://192.168.211.2:8080\nwww2.example.com http://192.168.211.12:8088\nwww3.example.com http://192.168.212.10</pre>\n</div> <div class=\"example\">\n<p><strong>Create DBM file</strong></p>\n<pre>httxt2dbm -i express-map.txt -o emap</pre>\n</div> <div class=\"example\">\n<p><strong>Configuration</strong></p>\n<pre>ProxyExpressEnable on\nProxyExpressDBMFile emap</pre>\n</div> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyexpressdbmtype\">ProxyExpressDBMType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>DBM type of file.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyExpressDBMFile &lt;type&gt;</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>\"default\"</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_express</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.13 and later</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyExpressDBMType</code> directive controls the DBM type expected by the module. The default is the default DBM type created with <code><a href=\"../programs/httxt2dbm\">httxt2dbm</a></code>.</p> <p>Possible values are (not all may be available at run time):</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Value</th>\n<th>Description</th>\n</tr> <tr>\n<td><code>db</code></td>\n<td> Berkeley DB files</td>\n</tr> <tr class=\"odd\">\n<td><code>gdbm</code></td>\n<td> GDBM files</td>\n</tr> <tr>\n<td><code>ndbm</code></td>\n<td> NDBM files</td>\n</tr> <tr class=\"odd\">\n<td><code>sdbm</code></td>\n<td> SDBM files (always available)</td>\n</tr> <tr>\n<td><code>default</code></td>\n<td> default DBM type</td>\n</tr> </table> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyexpressenable\">ProxyExpressEnable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable the module functionality.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyExpressEnable [on|off]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>off</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_express</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.13 and later</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyExpressEnable</code> directive controls whether the module will be active.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_express.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_express.html</a>\n  </p>\n</div>\n","mod/mod_proxy_fcgi":"<h1>Apache Module mod_proxy_fcgi</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>FastCGI support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_fcgi_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_fcgi.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides support for the <a href=\"http://www.fastcgi.com/\">FastCGI</a> protocol.</p> <p>Thus, in order to get the ability of handling the <code>FastCGI</code> protocol, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code> have to be present in the server.</p> <p>Unlike <a href=\"http://httpd.apache.org/mod_fcgid/\">mod_fcgid</a> and <a href=\"http://www.fastcgi.com/\">mod_fastcgi</a>, <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code> has no provision for starting the application process; <code class=\"program\"><a href=\"../programs/fcgistarter\">fcgistarter</a></code> is provided (on some platforms) for that purpose. Alternatively, external launching or process management may be available in the FastCGI application framework in use.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"examples\">Examples</h2> <p>Remember, in order to make the following examples work, you have to enable <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code>.</p> <div class=\"example\">\n<h3>Single application instance</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/myapp/\" \"fcgi://localhost:4000/\"</pre> </div> <p> <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code> disables connection reuse by default, so after a request has been completed the connection will NOT be held open by that httpd child process and won't be reused. If the FastCGI application is able to handle concurrent connections from httpd, you can opt-in to connection reuse as shown in the following example:</p> <div class=\"example\">\n<h3>Single application instance, connection reuse (2.4.11 and later)</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/myapp/\" \"fcgi://localhost:4000/\" enablereuse=on</pre> </div> <p> The following example passes the request URI as a filesystem path for the PHP-FPM daemon to run. The request URL is implicitly added to the 2nd parameter. The hostname and port following fcgi:// are where PHP-FPM is listening. Connection pooling is enabled.</p> <div class=\"example\">\n<h3>PHP-FPM</h3>\n<pre class=\"prettyprint lang-config\">ProxyPassMatch \"^/myapp/.*\\.php(/.*)?$\" \"fcgi://localhost:9000/var/www/\" enablereuse=on</pre> </div> <p> The following example passes the request URI as a filesystem path for the PHP-FPM daemon to run. In this case, PHP-FPM is listening on a unix domain socket (UDS). Requires 2.4.9 or later. With this syntax, the hostname and optional port following fcgi:// are ignored.</p> <div class=\"example\">\n<h3>PHP-FPM with UDS</h3>\n<pre class=\"prettyprint lang-config\"># UDS does not currently support connection reuse\nProxyPassMatch \"^/(.*\\.php(/.*)?)$\" \"unix:/var/run/php5-fpm.sock|fcgi://localhost/var/www/\"</pre> </div> <p>The balanced gateway needs <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> and at least one load balancer algorithm module, such as <code class=\"module\"><a href=\"mod_lbmethod_byrequests\">mod_lbmethod_byrequests</a></code>, in addition to the proxy modules listed above. <code class=\"module\"><a href=\"mod_lbmethod_byrequests\">mod_lbmethod_byrequests</a></code> is the default, and will be used for this example configuration.</p> <div class=\"example\">\n<h3>Balanced gateway to multiple application instances</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/myapp/\" \"balancer://myappcluster/\"\n&lt;Proxy \"balancer://myappcluster/\"&gt;\n    BalancerMember \"fcgi://localhost:4000\"\n    BalancerMember \"fcgi://localhost:4001\"\n&lt;/Proxy&gt;</pre> </div> <p>You can also force a request to be handled as a reverse-proxy request, by creating a suitable Handler pass-through. The example configuration below will pass all requests for PHP scripts to the specified FastCGI server using reverse proxy. This feature is available in Apache HTTP Server 2.4.10 and later. For performance reasons, you will want to define a <a href=\"mod_proxy#workers\">worker</a> representing the same fcgi:// backend. The benefit of this form is that it allows the normal mapping of URI to filename to occur in the server, and the local filesystem result is passed to the backend. When FastCGI is configured this way, the server can calculate the most accurate PATH_INFO. </p> <div class=\"example\">\n<h3>Proxy via Handler</h3>\n<pre class=\"prettyprint lang-config\">&lt;FilesMatch \"\\.php$\"&gt;\n    # Note: The only part that varies is /path/to/app.sock\n    SetHandler  \"proxy:unix:/path/to/app.sock|fcgi://localhost/\"\n&lt;/FilesMatch&gt;\n\n# Define a matching worker.\n# The part that is matched to the SetHandler is the part that\n# follows the pipe. If you need to distinguish, \"localhost; can\n# be anything unique.\n&lt;Proxy \"fcgi://localhost/\" enablereuse=on max=10&gt;\n&lt;/Proxy&gt;\n\n&lt;FilesMatch ...&gt;\n    SetHandler  \"proxy:fcgi://localhost:9000\"\n&lt;/FilesMatch&gt;\n\n&lt;FilesMatch ...&gt;\n    SetHandler  \"proxy:balancer://myappcluster/\"\n&lt;/FilesMatch&gt;</pre> </div>   <h2 id=\"env\">Environment Variables</h2> <p>In addition to the configuration directives that control the behaviour of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>, there are a number of <dfn>environment variables</dfn> that control the FCGI protocol provider:</p> <dl> <dt>proxy-fcgi-pathinfo</dt> <dd>When configured via <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> or <code class=\"directive\"><a href=\"mod_proxy#proxypassmatch\">ProxyPassMatch</a></code>, <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code> will not set the <var>PATH_INFO</var> environment variable. This allows the backend FCGI server to correctly determine <var>SCRIPT_NAME</var> and <var>Script-URI</var> and be compliant with RFC 3875 section 3.3. If instead you need <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code> to generate a \"best guess\" for <var>PATH_INFO</var>, set this env-var. This is a workaround for a bug in some FCGI implementations. This variable can be set to multiple values to tweak at how the best guess is chosen (In 2.4.11 and later only): <dl> <dt>first-dot</dt> <dd>PATH_INFO is split from the slash following the <em>first</em> \".\" in the URL.</dd> <dt>last-dot</dt> <dd>PATH_INFO is split from the slash following the <em>last</em> \".\" in the URL.</dd> <dt>full</dt> <dd>PATH_INFO is calculated by an attempt to map the URL to the local filesystem.</dd> <dt>unescape</dt> <dd>PATH_INFO is the path component of the URL, unescaped / decoded.</dd> <dt>any other value</dt> <dd>PATH_INFO is the same as the path component of the URL. Originally, this was the only proxy-fcgi-pathinfo option.</dd> </dl> </dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_fcgi.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_fcgi.html</a>\n  </p>\n</div>\n","mod/mod_proxy_fdpass":"<h1>Apache Module mod_proxy_fdpass</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>fdpass external process support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_fdpass_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_fdpass.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available for unix in version 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides support for the passing the socket of the client to another process.</p> <p><code>mod_proxy_fdpass</code> uses the ability of AF_UNIX domain sockets to <a href=\"http://www.freebsd.org/cgi/man.cgi?query=recv\">pass an open file descriptor</a> to allow another process to finish handling a request. </p> <p>The module has a <code>proxy_fdpass_flusher</code> provider interface, which allows another module to optionally send the response headers, or even the start of the response body. The default <code>flush</code> provider disables keep-alive, and sends the response headers, letting the external process just send a response body. </p> <p>In order to use another provider, you have to set the <code>flusher</code> parameter in the <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> directive. </p> <p>At this time the only data passed to the external process is the client socket. To receive a client socket, call recvfrom with an allocated <a href=\"http://www.kernel.org/doc/man-pages/online/pages/man3/cmsg.3.html\"><code>struct cmsghdr</code></a>. Future versions of this module may include more data after the client socket, but this is not implemented at this time. </p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_fdpass.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_fdpass.html</a>\n  </p>\n</div>\n","mod/mod_proxy_hcheck":"<h1>Apache Module mod_proxy_hcheck</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Dynamic health check of Balancer members (workers) for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_hcheck_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_hcheck.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.21 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides for dynamic health checking of balancer members (workers). This can be enabled on a worker-by-worker basis. The health check is done independently of the actual reverse proxy requests.</p> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_watchdog\">mod_watchdog</a></code>.</p> <div class=\"note\">\n<p><strong>Parameters</strong></p> <p>The health check mechanism is enabled via the use of additional BalancerMember parameters, which are configured in the standard way via <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code>:</p> <p>A new BalancerMember status state (flag) is defined via this module: \"<code>C</code>\". When the worker is taken offline due to failures as determined by the health check module, this flag is set, and can be seen (and modified) via the <code>balancer-manager</code>.</p> <table> <tr>\n<th>Parameter</th> <th>Default</th> <th>Description</th>\n</tr> <tr>\n<td>hcmethod</td> <td>None</td> <td>No dynamic health check performed. Choices are: <table> <tr>\n<th>Method</th>\n<th>Description</th>\n<th>Note</th>\n</tr> <tr>\n<td>None</td>\n<td>No dynamic health checking done</td>\n<td></td>\n</tr> <tr>\n<td>TCP</td>\n<td>Check that a socket to the backend can be created: e.g. \"are you up\"</td>\n<td></td>\n</tr> <tr>\n<td>OPTIONS</td>\n<td>Send an <code>HTTP OPTIONS</code> request to the backend</td>\n<td>*</td>\n</tr> <tr>\n<td>HEAD</td>\n<td>Send an <code>HTTP HEAD</code> request to the backend</td>\n<td>*</td>\n</tr> <tr>\n<td>GET</td>\n<td>Send an <code>HTTP GET</code> request to the backend</td>\n<td>*</td>\n</tr> <tr><td colspan=\"3\"></td></tr> <tr><td colspan=\"3\">*: Unless <code>hcexpr</code> is used, a 2xx or 3xx HTTP status will be interpreted as <em>passing</em> the health check</td></tr> </table> </td>\n</tr> <tr>\n<td>hcpasses</td> <td>1</td> <td>Number of successful health check tests before worker is re-enabled</td>\n</tr> <tr>\n<td>hcfails</td> <td>1</td> <td>Number of failed health check tests before worker is disabled</td>\n</tr> <tr>\n<td>hcinterval</td> <td>30</td> <td>Period of health checks in seconds (e.g. performed every 30 seconds)</td>\n</tr> <tr>\n<td>hcuri</td> <td> </td> <td>Additional URI to be appended to the worker URL for the health check.</td>\n</tr> <tr>\n<td>hctemplate</td> <td> </td> <td>Name of template, created via <code class=\"directive\">ProxyHCTemplate</code> to use for setting health check parameters for this worker</td>\n</tr> <tr>\n<td>hcexpr</td> <td> </td> <td>Name of expression, created via <code class=\"directive\">ProxyHCExpr</code>, used to check response headers for health.<br> <em>If not used, 2xx thru 3xx status codes imply success</em>\n</td>\n</tr> </table> </div>     <h2 id=\"examples\">Usage examples</h2> <p>The following example shows how one might configured health checking for various backend servers:</p> <pre class=\"prettyprint lang-config\">ProxyHCExpr ok234 {%{REQUEST_STATUS} =~ /^[234]/}\nProxyHCExpr gdown {%{REQUEST_STATUS} =~ /^[5]/}\nProxyHCExpr in_maint {hc('body') !~ /Under maintenance/}\n\n&lt;Proxy balancer://foo&gt;\n  BalancerMember http://www.example.com/  hcmethod=GET hcexpr=in_maint hcuri=/status.php\n  BalancerMember http://www2.example.com/  hcmethod=HEAD hcexpr=ok234 hcinterval=10\n  BalancerMember http://www3.example.com/ hcmethod=TCP hcinterval=5 hcpasses=2 hcfails=3\n  BalancerMember http://www4.example.com/\n&lt;/Proxy&gt;\n\nProxyPass \"/\" \"balancer://foo\"\nProxyPassReverse \"/\" \"balancer://foo\"</pre> <p>In this scenario, <code>http://www.example.com/</code> is health checked by sending a <code>GET /status.php</code> request to that server and seeing that the returned page does not include the string <em>Under maintenance</em>. If it does, that server is put in health-check fail mode, and disabled. This dynamic check is performed every 30 seconds, which is the default.</p> <p><code>http://www2.example.com/</code> is checked by sending a simple <code>HEAD</code> request every 10 seconds and making sure that the response status is 2xx, 3xx or 4xx. <code>http://www3.example.com/</code> is checked every 5 seconds by simply ensuring that the socket to that server is up. If the backend is marked as \"down\" and it passes 2 health check, it will be re-enabled and added back into the load balancer. It takes 3 back-to-back health check failures to disable the server and move it out of rotation. Finally, <code>http://www4.example.com/</code> is not dynamically checked at all.</p>   <div class=\"directive-section\">\n<h2 id=\"proxyhcexpr\">ProxyHCExpr Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Creates a named condition expression to use to determine health of the backend based on its response.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHCExpr name {ap_expr expression}</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_hcheck</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyHCExpr</code> directive allows for creating a named condition expression that checks the response headers of the backend server to determine its health. This named condition can then be assigned to balancer members via the <code>hcexpr</code> parameter</p> <div class=\"example\">\n<h3>ProxyHCExpr: Allow for 2xx/3xx/4xx as passing</h3>\n<pre class=\"prettyprint lang-config\">ProxyHCExpr ok234 {%{REQUEST_STATUS} =~ /^[234]/}\nProxyPass \"/apps\"     \"http://backend.example.com/\" hcexpr=ok234</pre> </div> <div class=\"note\"> The <a href=\"../expr\">expression</a> can use curly-parens (\"{}\") as quoting deliminators in addition to normal quotes. </div> <p>If using a health check method (eg: <code>GET</code>) which results in a response body, that body itself can be checked via <code>ap_expr</code> using the <code>hc()</code> expression function, which is unique to this module.</p> <p>In the following example, we send the backend a <code>GET</code> request and if the response body contains the phrase <em>Under maintenance</em>, we want to disable the backend.</p> <div class=\"example\">\n<h3>ProxyHCExpr: Checking response body</h3>\n<pre class=\"prettyprint lang-config\">ProxyHCExpr in_maint {hc('body') !~ /Under maintenance/}\nProxyPass \"/apps\"     \"http://backend.example.com/\" hcexpr=in_maint hcmethod=get hcuri=/status.php</pre> </div> <p><em>NOTE:</em> Since response body can quite large, it is best if used against specific status pages.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhctemplate\">ProxyHCTemplate Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Creates a named template for setting various health check parameters</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHCTemplate name parameter=setting &lt;...&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_hcheck</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyHCTemplate</code> directive allows for creating a named set (template) of health check parameters that can then be assigned to balancer members via the <code>hctemplate</code> parameter</p> <div class=\"example\">\n<h3>ProxyHCTemplate</h3>\n<pre class=\"prettyprint lang-config\">ProxyHCTemplate tcp5 hcmethod=tcp hcinterval=5\nProxyPass \"/apps\"     \"http://backend.example.com/\" hctemplate=tcp5</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhctpsize\">ProxyHCTPsize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the size of the threadpool used for the health check workers.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHCTPsize &lt;size&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_hcheck</td>\n</tr> </table> <p>If Apache httpd and APR are built with thread support, the health check module will offload the work of the actual checking to a threadpool associated with the Watchdog process, allowing for parallel checks. The <code class=\"directive\">ProxyHCTPsize</code> directive determines the size of this threadpool. If set to <code>0</code>, no threadpool is used at all, resulting in serialized health checks. The default size is 16.</p> <div class=\"example\">\n<h3>ProxyHCTPsize</h3>\n<pre class=\"prettyprint lang-config\">ProxyHCTPsize 32</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_hcheck.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_hcheck.html</a>\n  </p>\n</div>\n","mod/mod_proxy_ftp":"<h1>Apache Module mod_proxy_ftp</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>FTP support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_ftp_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_ftp.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides support for the proxying FTP sites. Note that FTP support is currently limited to the GET method.</p> <p>Thus, in order to get the ability of handling FTP proxy requests, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_ftp\">mod_proxy_ftp</a></code> have to be present in the server.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"mimetypes\">Why doesn't file type <var>xxx</var> download via FTP?</h2> <p>You probably don't have that particular file type defined as <code>application/octet-stream</code> in your proxy's mime.types configuration file. A useful line can be</p> <div class=\"example\"><pre>application/octet-stream   bin dms lha lzh exe class tgz taz</pre></div> <p>Alternatively you may prefer to default everything to binary:</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\">ForceType application/octet-stream</pre> </div>   <h2 id=\"type\">How can I force an FTP ASCII download of File <var>xxx</var>?</h2> <p>In the rare situation where you must download a specific file using the FTP <code>ASCII</code> transfer method (while the default transfer is in <code>binary</code> mode), you can override <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>'s default by suffixing the request with <code>;type=a</code> to force an ASCII transfer. (FTP Directory listings are always executed in ASCII mode, however.)</p>   <h2 id=\"ftpnonget\">How can I do FTP upload?</h2> <p>Currently, only GET is supported for FTP in mod_proxy. You can of course use HTTP upload (POST or PUT) through an Apache proxy.</p>   <h2 id=\"percent2fhck\">How can I access FTP files outside of my home directory?</h2> <p>An FTP URI is interpreted relative to the home directory of the user who is logging in. Alas, to reach higher directory levels you cannot use /../, as the dots are interpreted by the browser and not actually sent to the FTP server. To address this problem, the so called <dfn>Squid %2f hack</dfn> was implemented in the Apache FTP proxy; it is a solution which is also used by other popular proxy servers like the <a href=\"http://www.squid-cache.org/\">Squid Proxy Cache</a>. By prepending <code>/%2f</code> to the path of your request, you can make such a proxy change the FTP starting directory to <code>/</code> (instead of the home directory). For example, to retrieve the file <code>/etc/motd</code>, you would use the URL:</p> <div class=\"example\"><code>ftp://user@host/%2f/etc/motd</code></div>   <h2 id=\"ftppass\">How can I hide the FTP cleartext password in my browser's URL line?</h2> <p>To log in to an FTP server by username and password, Apache uses different strategies. In absence of a user name and password in the URL altogether, Apache sends an anonymous login to the FTP server, <em>i.e.</em>,</p> <div class=\"example\"><pre>user: anonymous\npassword: apache_proxy@</pre></div> <p>This works for all popular FTP servers which are configured for anonymous access.</p> <p>For a personal login with a specific username, you can embed the user name into the URL, like in:</p> <div class=\"example\"><code>ftp://username@host/myfile</code></div> <p>If the FTP server asks for a password when given this username (which it should), then Apache will reply with a <code>401</code> (Authorization required) response, which causes the Browser to pop up the username/password dialog. Upon entering the password, the connection attempt is retried, and if successful, the requested resource is presented. The advantage of this procedure is that your browser does not display the password in cleartext (which it would if you had used</p> <div class=\"example\"><code>ftp://username:password@host/myfile</code></div> <p>in the first place).</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>The password which is transmitted in such a way is not encrypted on its way. It travels between your browser and the Apache proxy server in a base64-encoded cleartext string, and between the Apache proxy and the FTP server as plaintext. You should therefore think twice before accessing your FTP server via HTTP (or before accessing your personal files via FTP at all!) When using insecure channels, an eavesdropper might intercept your password on its way.</p> </div>   <h2 id=\"wildcard\">Why do I get a file listing when I expected a file to be downloaded?</h2> <p>In order to allow both browsing the directories on an FTP server and downloading files, Apache looks at the request URL. If it looks like a directory, or contains wildcard characters (\"*?[{~\"), then it guesses that a listing is wanted instead of a download.</p> <p>You can disable the special handling of names with wildcard characters. See the <code class=\"directive\">ProxyFtpListOnWildcard</code> directive. </p>   <div class=\"directive-section\">\n<h2 id=\"proxyftpdircharset\">ProxyFtpDirCharset Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define the character set for proxied FTP listings</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyFtpDirCharset character set</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyFtpDirCharset ISO-8859-1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_ftp</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.2.7 and later. Moved from <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> in Apache 2.3.5.</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyFtpDirCharset</code> directive defines the character set to be set for FTP directory listings in HTML generated by <code class=\"module\"><a href=\"mod_proxy_ftp\">mod_proxy_ftp</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyftpescapewildcards\">ProxyFtpEscapeWildcards Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Whether wildcards in requested filenames are escaped when sent to the FTP server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyFtpEscapeWildcards [on|off]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>on</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_ftp</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.3 and later</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyFtpEscapeWildcards</code> directive controls whether wildcard characters (\"*?[{~\") in requested filenames are escaped with backslash before sending them to the FTP server. That is the default behavior, but many FTP servers don't know about the escaping and try to serve the literal filenames they were sent, including the backslashes in the names. </p> <p>Set to \"off\" to allow downloading files with wildcards in their names from FTP servers that don't understand wildcard escaping.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyftplistonwildcard\">ProxyFtpListOnWildcard Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Whether wildcards in requested filenames trigger a file listing</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyFtpListOnWildcard [on|off]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>on</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_ftp</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.3 and later</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyFtpListOnWildcard</code> directive controls whether wildcard characters (\"*?[{~\") in requested filenames cause <code class=\"module\"><a href=\"mod_proxy_ftp\">mod_proxy_ftp</a></code> to return a listing of files instead of downloading a file. By default (value on), they do. Set to \"off\" to allow downloading files even if they have wildcard characters in their names.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_ftp.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_ftp.html</a>\n  </p>\n</div>\n","mod/mod_proxy_http":"<h1>Apache Module mod_proxy_http</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>HTTP support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_http_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_http.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides the features used for proxying HTTP and HTTPS requests. <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> supports HTTP/0.9, HTTP/1.0 and HTTP/1.1. It does <em>not</em> provide any caching abilities. If you want to set up a caching proxy, you might want to use the additional service of the <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> module.</p> <p>Thus, in order to get the ability of handling HTTP proxy requests, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> have to be present in the server.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"env\">Environment Variables</h2> <p>In addition to the configuration directives that control the behaviour of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>, there are a number of <dfn>environment variables</dfn> that control the HTTP protocol provider. Environment variables below that don't specify specific values are enabled when set to any value.</p> <dl> <dt>proxy-sendextracrlf</dt> <dd>Causes proxy to send an extra CR-LF newline on the end of a request. This is a workaround for a bug in some browsers.</dd> <dt>force-proxy-request-1.0</dt> <dd>Forces the proxy to send requests to the backend as HTTP/1.0 and disables HTTP/1.1 features.</dd> <dt>proxy-nokeepalive</dt> <dd>Forces the proxy to close the backend connection after each request.</dd> <dt>proxy-chain-auth</dt> <dd>If the proxy requires authentication, it will read and consume the proxy authentication credentials sent by the client. With <var>proxy-chain-auth</var> it will <em>also</em> forward the credentials to the next proxy in the chain. This may be necessary if you have a chain of proxies that share authentication information. <strong>Security Warning:</strong> Do not set this unless you know you need it, as it forwards sensitive information!</dd> <dt>proxy-sendcl</dt> <dd>HTTP/1.0 required all HTTP requests that include a body (e.g. POST requests) to include a <var>Content-Length</var> header. This environment variable forces the Apache proxy to send this header to the backend server, regardless of what the Client sent to the proxy. It ensures compatibility when proxying for an HTTP/1.0 or unknown backend. However, it may require the entire request to be buffered by the proxy, so it becomes very inefficient for large requests.</dd> <dt>proxy-sendchunks or proxy-sendchunked</dt> <dd>This is the opposite of <var>proxy-sendcl</var>. It allows request bodies to be sent to the backend using chunked transfer encoding. This allows the request to be efficiently streamed, but requires that the backend server supports HTTP/1.1.</dd> <dt>proxy-interim-response</dt> <dd>This variable takes values <code>RFC</code> (the default) or <code>Suppress</code>. Earlier httpd versions would suppress HTTP interim (1xx) responses sent from the backend. This is technically a violation of the HTTP protocol. In practice, if a backend sends an interim response, it may itself be extending the protocol in a manner we know nothing about, or just broken. So this is now configurable: set <code>proxy-interim-response RFC</code> to be fully protocol compliant, or <code>proxy-interim-response Suppress</code> to suppress interim responses.</dd> <dt>proxy-initial-not-pooled</dt> <dd>If this variable is set, no pooled connection will be reused if the client request is the initial request on the frontend connection. This avoids the \"proxy: error reading status line from remote server\" error message caused by the race condition that the backend server closed the pooled connection after the connection check by the proxy and before data sent by the proxy reached the backend. It has to be kept in mind that setting this variable downgrades performance, especially with HTTP/1.0 clients. </dd> </dl>   <h2 id=\"notes\">Request notes</h2> <p><code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> creates the following request notes for logging using the <code>%{VARNAME}n</code> format in <code class=\"directive\"><a href=\"mod_log_config#logformat\">LogFormat</a></code> or <code class=\"directive\"><a href=\"core#errorlogformat\">ErrorLogFormat</a></code>: </p> <dl> <dt>proxy-source-port</dt> <dd>The local port used for the connection to the backend server.</dd> <dt>proxy-status</dt> <dd>The HTTP status received from the backend server.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_http.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_http.html</a>\n  </p>\n</div>\n","mod/mod_proxy_http2":"<h1>Apache Module mod_proxy_http2</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>HTTP/2 support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_http2_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_http2.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides the features used for proxying HTTP/2 requests. <code class=\"module\"><a href=\"mod_proxy_http2\">mod_proxy_http2</a></code> supports HTTP/2 only. It does <em>not</em> provide any downgrades to HTTP/1.1.</p> <p>Thus, in order to get the ability of handling HTTP/2 proxy requests, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_http2\">mod_proxy_http2</a></code> have to be present in the server.</p> <p><code class=\"module\"><a href=\"mod_proxy_http2\">mod_proxy_http2</a></code> works with incoming requests over HTTP/1.1 and HTTP/2 requests. If <code class=\"module\"><a href=\"mod_http2\">mod_http2</a></code> handles the frontend connection, requests against the same HTTP/2 backend are sent over a single connection, whenever possible.</p> <p>This module relies on <a href=\"http://nghttp2.org/\">libnghttp2</a> to provide the core http/2 engine.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>This module is experimental. Its behaviors, directives, and defaults are subject to more change from release to release relative to other standard modules. Users are encouraged to consult the \"CHANGES\" file for potential updates.</p> </div> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"notes\">Request notes</h2> <p><code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> creates the following request notes for logging using the <code>%{VARNAME}n</code> format in <code class=\"directive\"><a href=\"mod_log_config#logformat\">LogFormat</a></code> or <code class=\"directive\"><a href=\"core#errorlogformat\">ErrorLogFormat</a></code>: </p> <dl> <dt>proxy-source-port</dt> <dd>The local port used for the connection to the backend server.</dd> <dt>proxy-status</dt> <dd>The HTTP/2 status received from the backend server.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_http2.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_http2.html</a>\n  </p>\n</div>\n","mod/mod_proxy_scgi":"<h1>Apache Module mod_proxy_scgi</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>SCGI gateway module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_scgi_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_scgi.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.2.14 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides support for the <a href=\"http://python.ca/scgi/protocol.txt\">SCGI protocol, version 1</a>.</p> <p>Thus, in order to get the ability of handling the SCGI protocol, <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_scgi\">mod_proxy_scgi</a></code> have to be present in the server.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying until you have <a href=\"mod_proxy#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div>     <h2 id=\"examples\">Examples</h2> <p>Remember, in order to make the following examples work, you have to enable <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and <code class=\"module\"><a href=\"mod_proxy_scgi\">mod_proxy_scgi</a></code>.</p> <div class=\"example\">\n<h3>Simple gateway</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass /scgi-bin/ scgi://localhost:4000/</pre> </div> <p>The balanced gateway needs <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> and at least one load balancer algorithm module, such as <code class=\"module\"><a href=\"mod_lbmethod_byrequests\">mod_lbmethod_byrequests</a></code>, in addition to the proxy modules listed above. <code class=\"module\"><a href=\"mod_lbmethod_byrequests\">mod_lbmethod_byrequests</a></code> is the default, and will be used for this example configuration.</p> <div class=\"example\">\n<h3>Balanced gateway</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/scgi-bin/\" \"balancer://somecluster/\"\n&lt;Proxy \"balancer://somecluster\"&gt;\n    BalancerMember \"scgi://localhost:4000\"\n    BalancerMember \"scgi://localhost:4001\"\n&lt;/Proxy&gt;</pre> </div>   <h2 id=\"env\">Environment Variables</h2> <p>In addition to the configuration directives that control the behaviour of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>, an <dfn>environment variable</dfn> may also control the SCGI protocol provider:</p> <dl> <dt>proxy-scgi-pathinfo</dt> <dd>By default <code class=\"module\"><a href=\"mod_proxy_scgi\">mod_proxy_scgi</a></code> will neither create nor export the <var>PATH_INFO</var> environment variable. This allows the backend SCGI server to correctly determine <var>SCRIPT_NAME</var> and <var>Script-URI</var> and be compliant with RFC 3875 section 3.3. If instead you need <code class=\"module\"><a href=\"mod_proxy_scgi\">mod_proxy_scgi</a></code> to generate a \"best guess\" for <var>PATH_INFO</var>, set this env-var. The variable must be set before <code class=\"directive\"><a href=\"env#setenv\">SetEnv</a></code> is effective. <code class=\"directive\"><a href=\"setenv#setenvif\">SetEnvIf</a></code> can be used instead: <code>SetEnvIf Request_URI . proxy-scgi-pathinfo</code> </dd> </dl>   <div class=\"directive-section\">\n<h2 id=\"proxyscgiinternalredirect\">ProxySCGIInternalRedirect Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable or disable internal redirect responses from the backend</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxySCGIInternalRedirect On|Off|Headername</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxySCGIInternalRedirect On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_scgi</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>The <var>Headername</var> feature is available in version 2.4.13 and later</td>\n</tr> </table> <p>The <code class=\"directive\">ProxySCGIInternalRedirect</code> enables the backend to internally redirect the gateway to a different URL. This feature originates in <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code>, which internally redirects the response if the response status is <code>OK</code> (<code>200</code>) and the response contains a <code>Location</code> (or configured alternate header) and its value starts with a slash (<code>/</code>). This value is interpreted as a new local URL that Apache httpd internally redirects to.</p> <p><code class=\"module\"><a href=\"mod_proxy_scgi\">mod_proxy_scgi</a></code> does the same as <code class=\"module\"><a href=\"mod_cgi\">mod_cgi</a></code> in this regard, except that you can turn off the feature or specify the use of a header other than <code>Location</code>.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">    ProxySCGIInternalRedirect Off\n\n# Django and some other frameworks will fully qualify \"local URLs\"\n# set by the application, so an alternate header must be used.\n&lt;Location /django-app/&gt;\n    ProxySCGIInternalRedirect X-Location\n&lt;/Location&gt;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyscgisendfile\">ProxySCGISendfile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable evaluation of <var>X-Sendfile</var> pseudo response header</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxySCGISendfile On|Off|Headername</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxySCGISendfile Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_scgi</td>\n</tr> </table> <p>The <code class=\"directive\">ProxySCGISendfile</code> directive enables the SCGI backend to let files be served directly by the gateway. This is useful for performance purposes  httpd can use <code>sendfile</code> or other optimizations, which are not possible if the file comes over the backend socket. Additionally, the file contents are not transmitted twice.</p> <p>The <code class=\"directive\">ProxySCGISendfile</code> argument determines the gateway behaviour:</p> <dl> <dt><code>Off</code></dt> <dd>No special handling takes place.</dd> <dt><code>On</code></dt> <dd>The gateway looks for a backend response header called <code>X-Sendfile</code> and interprets the value as the filename to serve. The header is removed from the final response headers. This is equivalent to <code>ProxySCGISendfile X-Sendfile</code>.</dd> <dt>anything else</dt> <dd>Similar to <code>On</code>, but instead of the hardcoded header name <code>X-Sendfile</code>, the argument is used as the header name.</dd> </dl> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\"># Use the default header (X-Sendfile)\nProxySCGISendfile On\n    \n# Use a different header\nProxySCGISendfile X-Send-Static</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_scgi.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_scgi.html</a>\n  </p>\n</div>\n","mod/mod_proxy_html":"<h1>Apache Module mod_proxy_html</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Rewrite HTML links in to ensure they are addressable from Clients' networks in a proxy context.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_html_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_html.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later. Available as a third-party module for earlier 2.x versions</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides an output filter to rewrite HTML links in a proxy situation, to ensure that links work for users outside the proxy. It serves the same purpose as Apache's ProxyPassReverse directive does for HTTP headers, and is an essential component of a reverse proxy.</p> <p>For example, if a company has an application server at <code>appserver.example.com</code> that is only visible from within the company's internal network, and a public webserver <code>www.example.com</code>, they may wish to provide a gateway to the application server at <code>http://www.example.com/appserver/</code>. When the application server links to itself, those links need to be rewritten to work through the gateway. mod_proxy_html serves to rewrite <code>&lt;a href=\"http://appserver.example.com/foo/bar.html\"&gt;foobar&lt;/a&gt;</code> to <code>&lt;a href=\"http://www.example.com/appserver/foo/bar.html\"&gt;foobar&lt;/a&gt;</code> making it accessible from outside.</p> <p>mod_proxy_html was originally developed at Webing, whose\nextensive <a href=\"http://apache.webthing.com/mod_proxy_html/\">documentation</a> may be useful to users.</p>    <div class=\"directive-section\">\n<h2 id=\"proxyhtmlbufsize\">ProxyHTMLBufSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the buffer size increment for buffering inline scripts and stylesheets.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLBufSize bytes</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>In order to parse non-HTML content (stylesheets and scripts) embedded in HTML documents, mod_proxy_html has to read the entire script or stylesheet into a buffer. This buffer will be expanded as necessary to hold the largest script or stylesheet in a page, in increments of <var>bytes</var> as set by this directive.</p> <p>The default is 8192, and will work well for almost all pages. However, if you know you're proxying pages containing stylesheets and/or scripts bigger than 8K (that is, for a single script or stylesheet, NOT in total), it will be more efficient to set a larger buffer size and avoid the need to resize the buffer dynamically during a request. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlcharsetout\">ProxyHTMLCharsetOut Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify a charset for mod_proxy_html output.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLCharsetOut Charset | *</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>This selects an encoding for mod_proxy_html output. It should not normally be used, as any change from the default <code>UTF-8</code> (Unicode - as used internally by libxml2) will impose an additional processing overhead. The special token <code>ProxyHTMLCharsetOut *</code> will generate output using the same encoding as the input.</p> <p>Note that this relies on <code class=\"module\"><a href=\"mod_xml2enc\">mod_xml2enc</a></code> being loaded.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmldoctype\">ProxyHTMLDocType Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets an HTML or XHTML document type declaration.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLDocType HTML|XHTML [Legacy]\nOR \nProxyHTMLDocType fpi [SGML|XML]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>In the first form, documents will be declared as HTML 4.01 or XHTML 1.0 according to the option selected. This option also determines whether HTML or XHTML syntax is used for output. Note that the format of the documents coming from the backend server is immaterial: the parser will deal with it automatically. If the optional second argument is set to \"Legacy\", documents will be declared \"Transitional\", an option that may be necessary if you are proxying pre-1998 content or working with defective authoring/publishing tools.</p> <p>In the second form, it will insert your own FPI. The optional second argument determines whether SGML/HTML or XML/XHTML syntax will be used.</p> <p>The default is changed to omitting any FPI, on the grounds that no FPI is better than a bogus one. If your backend generates decent HTML or XHTML, set it accordingly.</p> <p>If the first form is used, mod_proxy_html will also clean up the HTML to the specified standard. It cannot fix every error, but it will strip out bogus elements and attributes. It will also optionally log other errors at <code class=\"directive\"><a href=\"core#loglevel\">LogLevel</a></code> Debug.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlenable\">ProxyHTMLEnable Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Turns the proxy_html filter on or off.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLEnable On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyHTMLEnable Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party module for earlier 2.x versions.</td>\n</tr> </table> <p>A simple switch to enable or disable the proxy_html filter. If <code class=\"module\"><a href=\"mod_xml2enc\">mod_xml2enc</a></code> is loaded it will also automatically set up internationalisation support.</p> <p>Note that the proxy_html filter will only act on HTML data (Content-Type text/html or application/xhtml+xml) and when the data are proxied. You can override this (at your own risk) by setting the <var>PROXY_HTML_FORCE</var> environment variable.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlevents\">ProxyHTMLEvents Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify attributes to treat as scripting events.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLEvents attribute [attribute ...]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>Specifies one or more attributes to treat as scripting events and apply <code class=\"directive\">ProxyHTMLURLMap</code>s to where enabled. You can specify any number of attributes in one or more <code>ProxyHTMLEvents</code> directives.</p> <p>Normally you'll set this globally. If you set ProxyHTMLEvents in more than one scope so that one overrides the other, you'll need to specify a complete set in each of those scopes.</p> <p>A default configuration is supplied in <var>proxy-html.conf</var> and defines the events in standard HTML 4 and XHTML 1.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlextended\">ProxyHTMLExtended Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether to fix links in inline scripts, stylesheets, and scripting events.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLExtended On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyHTMLExtended Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>Set to <code>Off</code>, HTML links are rewritten according to the <code class=\"directive\">ProxyHTMLURLMap</code> directives, but links appearing in Javascript and CSS are ignored.</p> <p>Set to <code>On</code>, all scripting events (as determined by <code class=\"directive\">ProxyHTMLEvents</code>) and embedded scripts or stylesheets are also processed by the <code class=\"directive\">ProxyHTMLURLMap</code> rules, according to the flags set for each rule. Since this requires more parsing, performance will be best if you only enable it when strictly necessary. </p>\n<p> You'll also need to take care over patterns matched, since the parser has no knowledge of what is a URL within an embedded script or stylesheet. In particular, extended matching of <code>/</code> is likely to lead to false matches. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlfixups\">ProxyHTMLFixups Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Fixes for simple HTML errors.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLFixups [lowercase] [dospath] [reset]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>This directive takes one to three arguments as follows:</p> <ul> <li>\n<code>lowercase</code> Urls are rewritten to lowercase</li> <li>\n<code>dospath</code> Backslashes in URLs are rewritten to forward slashes.</li> <li>\n<code>reset</code> Unset any options set at a higher level in the configuration.</li> </ul> <p>Take care when using these. The fixes will correct certain authoring mistakes, but risk also erroneously fixing links that were correct to start with. Only use them if you know you have a broken backend server.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlinterp\">ProxyHTMLInterp Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables per-request interpolation of <code class=\"directive\">ProxyHTMLURLMap</code> rules.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLInterp On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyHTMLInterp Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>This enables per-request interpolation in <code class=\"directive\">ProxyHTMLURLMap</code> to- and from- patterns.</p> <p>If interpolation is not enabled, all rules are pre-compiled at startup. With interpolation, they must be re-compiled for every request, which implies an extra processing overhead. It should therefore be enabled only when necessary.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmllinks\">ProxyHTMLLinks Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Specify HTML elements that have URL attributes to be rewritten.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLLinks element attribute [attribute2 ...]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>Specifies elements that have URL attributes that should be rewritten using standard <code class=\"directive\">ProxyHTMLURLMap</code>s. You will need one ProxyHTMLLinks directive per element, but it can have any number of attributes.</p> <p>Normally you'll set this globally. If you set ProxyHTMLLinks in more than one scope so that one overrides the other, you'll need to specify a complete set in each of those scopes.</p> <p>A default configuration is supplied in <var>proxy-html.conf</var> and defines the HTML links for standard HTML 4 and XHTML 1.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlmeta\">ProxyHTMLMeta Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Turns on or off extra pre-parsing of metadata in HTML <code>&lt;head&gt;</code> sections.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLMeta On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyHTMLMeta Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party module for earlier 2.x versions.</td>\n</tr> </table> <p>This turns on or off pre-parsing of metadata in HTML <code>&lt;head&gt;</code> sections.</p> <p>If not required, turning ProxyHTMLMeta Off will give a small performance boost by skipping this parse step. However, it is sometimes necessary for internationalisation to work correctly.</p> <p>ProxyHTMLMeta has two effects. Firstly and most importantly it enables detection of character encodings declared in the form</p> <pre>&lt;meta http-equiv=\"Content-Type\" content=\"text/html;charset=<var>foo</var>\"&gt;</pre> <p>or, in the case of an XHTML document, an XML declaration. It is NOT required if the charset is declared in a real HTTP header (which is always preferable) from the backend server, nor if the document is <var>utf-8</var> (unicode) or a subset such as ASCII. You may also be able to dispense with it where documents use a default declared using <code class=\"directive\"><a href=\"mod_xml2enc#xml2encdefault\">xml2EncDefault</a></code>, but that risks propagating an incorrect declaration. A <code class=\"directive\">ProxyHTMLCharsetOut</code> can remove that risk, but is likely to be a bigger processing overhead than enabling ProxyHTMLMeta.</p> <p>The other effect of enabling ProxyHTMLMeta is to parse all <code>&lt;meta http-equiv=...&gt;</code> declarations and convert them to real HTTP headers, in keeping with the original purpose of this form of the HTML &lt;meta&gt; element.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlstripcomments\">ProxyHTMLStripComments Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines whether to strip HTML comments.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLStripComments On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyHTMLStripComments Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party for earlier 2.x versions</td>\n</tr> </table> <p>This directive will cause mod_proxy_html to strip HTML comments. Note that this will also kill off any scripts or styles embedded in comments (a bogosity introduced in 1995/6 with Netscape 2 for the benefit of then-older browsers, but still in use today). It may also interfere with comment-based processors such as SSI or ESI: be sure to run any of those <em>before</em> mod_proxy_html in the filter chain if stripping comments!</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyhtmlurlmap\">ProxyHTMLURLMap Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Defines a rule to rewrite HTML links</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyHTMLURLMap from-pattern to-pattern [flags] [cond]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy_html</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later; available as a third-party module for earlier 2.x versions.</td>\n</tr> </table> <p>This is the key directive for rewriting HTML links. When parsing a document, whenever a link target matches <var>from-pattern</var>, the matching portion will be rewritten to <var>to-pattern</var>, as modified by any flags supplied and by the <code class=\"directive\">ProxyHTMLExtended</code> directive.</p> <p>The optional third argument may define any of the following <strong>Flags</strong>. Flags are case-sensitive.</p> <dl> <dt>h</dt> <dd><p>Ignore HTML links (pass through unchanged)</p></dd> <dt>e</dt> <dd><p>Ignore scripting events (pass through unchanged)</p></dd> <dt>c</dt> <dd><p>Pass embedded script and style sections through untouched.</p></dd> <dt>L</dt> <dd><p>Last-match. If this rule matches, no more rules are applied (note that this happens automatically for HTML links).</p></dd> <dt>l</dt> <dd><p>Opposite to L. Overrides the one-change-only default behaviour with HTML links.</p></dd> <dt>R</dt> <dd>\n<p>Use Regular Expression matching-and-replace. <code>from-pattern</code> is a regexp, and <code>to-pattern</code> a replacement string that may be based on the regexp. Regexp memory is supported: you can use brackets () in the <code>from-pattern</code> and retrieve the matches with $1 to $9 in the <code>to-pattern</code>.</p> <p>If R is not set, it will use string-literal search-and-replace. The logic is <em>starts-with</em> in HTML links, but <em>contains</em> in scripting events and embedded script and style sections. </p> </dd> <dt>x</dt> <dd><p>Use POSIX extended Regular Expressions. Only applicable with R.</p></dd> <dt>i</dt> <dd><p>Case-insensitive matching. Only applicable with R.</p></dd> <dt>n</dt> <dd><p>Disable regexp memory (for speed). Only applicable with R.</p></dd> <dt>s</dt> <dd><p>Line-based regexp matching. Only applicable with R.</p></dd> <dt>^</dt> <dd><p>Match at start only. This applies only to string matching (not regexps) and is irrelevant to HTML links.</p></dd> <dt>$</dt> <dd><p>Match at end only. This applies only to string matching (not regexps) and is irrelevant to HTML links.</p></dd> <dt>V</dt> <dd>\n<p>Interpolate environment variables in <code>to-pattern</code>. A string of the form <code>${varname|default}</code> will be replaced by the value of environment variable <code>varname</code>. If that is unset, it is replaced by <code>default</code>. The <code>|default</code> is optional.</p> <p>NOTE: interpolation will only be enabled if <code class=\"directive\">ProxyHTMLInterp</code> is <var>On</var>.</p> </dd> <dt>v</dt> <dd>\n<p>Interpolate environment variables in <code>from-pattern</code>. Patterns supported are as above.</p> <p>NOTE: interpolation will only be enabled if <code class=\"directive\">ProxyHTMLInterp</code> is <var>On</var>.</p> </dd> </dl> <p>The optional fourth <strong>cond</strong> argument defines a condition that will be evaluated per Request, provided <code class=\"directive\">ProxyHTMLInterp</code> is <var>On</var>. If the condition evaluates FALSE the map will not be applied in this request. If TRUE, or if no condition is defined, the map is applied.</p> <p>A <strong>cond</strong> is evaluated by the <a href=\"../expr\">Expression Parser</a>. In addition, the simpler syntax of conditions in mod_proxy_html 3.x for HTTPD 2.0 and 2.2 is also supported.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_html.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_html.html</a>\n  </p>\n</div>\n","mod/mod_proxy_wstunnel":"<h1>Apache Module mod_proxy_wstunnel</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Websockets support module for <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_wstunnel_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy_wstunnel.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.5 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module <em>requires</em> the service of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>. It provides support for the tunnelling of web socket connections to a backend websockets server. The connection is automatically upgraded to a websocket connection:</p> <div class=\"example\">\n<h3>HTTP Response</h3>\n<pre class=\"prettyprint lang-config\">Upgrade: WebSocket\nConnection: Upgrade</pre> </div> <p>Proxying requests to a websockets server like <code>echo.websocket.org</code> can be done using the <code class=\"directive\"><a href=\"mod_proxy#proxypass\">ProxyPass</a></code> directive:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/ws2/\"  \"ws://echo.websocket.org/\"\nProxyPass \"/wss2/\" \"wss://echo.websocket.org/\"</pre> <p>Load balancing for multiple backends can be achieved using <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_wstunnel.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy_wstunnel.html</a>\n  </p>\n</div>\n","mod/mod_ratelimit":"<h1>Apache Module mod_ratelimit</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Bandwidth Rate Limiting for Clients</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>ratelimit_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_ratelimit.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>Provides a filter named <code>RATE_LIMIT</code> to limit client bandwidth. The connection speed to be simulated is specified, in KiB/s, using the environment variable <code>rate-limit</code>.</p> <div class=\"example\">\n<h3>Example Configuration</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/downloads\"&gt;\n    SetOutputFilter RATE_LIMIT\n    SetEnv rate-limit 400 \n&lt;/Location&gt;</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_ratelimit.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_ratelimit.html</a>\n  </p>\n</div>\n","mod/mod_reflector":"<h1>Apache Module mod_reflector</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Reflect a request body as a response via the output filter stack.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>reflector_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_reflector.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module allows request bodies to be reflected back to the client, in the process passing the request through the output filter stack. A suitably configured chain of filters can be used to transform the request into a response. This module can be used to turn an output filter into an HTTP service.</p>     <h2 id=\"examples\">Examples</h2> <dl> <dt>Compression service</dt> <dd>Pass the request body through the DEFLATE filter to compress the body. This request requires a Content-Encoding request header containing \"gzip\" for the filter to return compressed data. <pre class=\"prettyprint lang-config\">&lt;Location \"/compress\"&gt;\n    SetHandler reflector\n    SetOutputFilter DEFLATE\n&lt;/Location&gt;</pre> </dd> <dt>Image downsampling service</dt> <dd>Pass the request body through an image downsampling filter, and reflect the results to the caller. <pre class=\"prettyprint lang-config\">&lt;Location \"/downsample\"&gt;\n    SetHandler reflector\n    SetOutputFilter DOWNSAMPLE\n&lt;/Location&gt;</pre> </dd> </dl>   <div class=\"directive-section\">\n<h2 id=\"reflectorheader\">ReflectorHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Reflect an input header to the output headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ReflectorHeader inputheader [outputheader]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_reflector</td>\n</tr> </table> <p>This directive controls the reflection of request headers to the response. The first argument is the name of the request header to copy. If the optional second argument is specified, it will be used as the name of the response header, otherwise the original request header name will be used.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_reflector.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_reflector.html</a>\n  </p>\n</div>\n","mod/mod_request":"<h1>Apache Module mod_request</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Filters to handle and make available HTTP request bodies</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>request_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_request.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table>    <div class=\"directive-section\">\n<h2 id=\"keptbodysize\">KeptBodySize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Keep the request body instead of discarding it up to the specified maximum size, for potential use by filters such as mod_include.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>KeptBodySize maximum size in bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>KeptBodySize 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_request</td>\n</tr> </table> <p>Under normal circumstances, request handlers such as the default handler for static files will discard the request body when it is not needed by the request handler. As a result, filters such as mod_include are limited to making <code>GET</code> requests only when including other URLs as subrequests, even if the original request was a <code>POST</code> request, as the discarded request body is no longer available once filter processing is taking place.</p> <p>When this directive has a value greater than zero, request handlers that would otherwise discard request bodies will instead set the request body aside for use by filters up to the maximum size specified. In the case of the mod_include filter, an attempt to <code>POST</code> a request to the static shtml file will cause any subrequests to be <code>POST</code> requests, instead of <code>GET</code> requests as before.</p> <p>This feature makes it possible to break up complex web pages and web applications into small individual components, and combine the components and the surrounding web page structure together using <code class=\"module\"><a href=\"mod_include\">mod_include</a></code>. The components can take the form of CGI programs, scripted languages, or URLs reverse proxied into the URL space from another server using <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>.</p> <p><strong>Note:</strong> Each request set aside has to be set aside in temporary RAM until the request is complete. As a result, care should be taken to ensure sufficient RAM is available on the server to support the intended load. Use of this directive should be limited to where needed on targeted parts of your URL space, and with the lowest possible value that is still big enough to hold a request body.</p> <p>If the request size sent by the client exceeds the maximum size allocated by this directive, the server will return <code>413 Request Entity Too Large</code>.</p> <h3>See also</h3> <ul> <li>\n<a href=\"mod_include\">mod_include</a> documentation</li> <li>\n<a href=\"mod_auth_form\">mod_auth_form</a> documentation</li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_request.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_request.html</a>\n  </p>\n</div>\n","mod/mod_remoteip":"<h1>Apache Module mod_remoteip</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Replaces the original client IP address for the connection with the useragent IP address list presented by a proxies or a load balancer via the request headers. </td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>remoteip_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_remoteip.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module is used to treat the useragent which initiated the request as the originating useragent as identified by httpd for the purposes of authorization and logging, even where that useragent is behind a load balancer, front end server, or proxy server.</p> <p>The module overrides the client IP address for the connection with the useragent IP address reported in the request header configured with the <code class=\"directive\"><a href=\"#remoteipheader\">RemoteIPHeader</a></code> directive.</p> <p>Once replaced as instructed, this overridden useragent IP address is then used for the <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code> <code class=\"directive\"><a href=\"mod_authz_core#require\">Require ip</a></code> feature, is reported by <code class=\"module\"><a href=\"mod_status\">mod_status</a></code>, and is recorded by <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code> <code>%a</code> and <code class=\"module\"><a href=\"core\">core</a></code> <code>%a</code> format strings. The underlying client IP of the connection is available in the <code>%{c}a</code> format string.</p> <div class=\"warning\">It is critical to only enable this behavior from intermediate hosts (proxies, etc) which are trusted by this server, since it is trivial for the remote useragent to impersonate another useragent.</div>     <h2 id=\"processing\">Remote IP Processing</h2> <p>Apache by default identifies the useragent with the connection's client_ip value, and the connection remote_host and remote_logname are derived from this value. These fields play a role in authentication, authorization and logging and other purposes by other loadable modules.</p> <p>mod_remoteip overrides the client IP of the connection with the advertised useragent IP as provided by a proxy or load balancer, for the duration of the request. A load balancer might establish a long lived keepalive connection with the server, and each request will have the correct useragent IP, even though the underlying client IP address of the load balancer remains unchanged.</p> <p>When multiple, comma delimited useragent IP addresses are listed in the header value, they are processed in Right-to-Left order. Processing halts when a given useragent IP address is not trusted to present the preceding IP address. The header field is updated to this remaining list of unconfirmed IP addresses, or if all IP addresses were trusted, this header is removed from the request altogether.</p> <p>In overriding the client IP, the module stores the list of intermediate hosts in a remoteip-proxy-ip-list note, which <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code> can record using the <code>%{remoteip-proxy-ip-list}n</code> format token. If the administrator needs to store this as an additional header, this same value can also be recording as a header using the directive <code class=\"directive\"><a href=\"#remoteipproxiesheader\">RemoteIPProxiesHeader</a></code>.</p> <div class=\"note\">\n<p><strong>IPv4-over-IPv6 Mapped Addresses</strong></p> As with httpd in general, any IPv4-over-IPv6 mapped addresses are recorded in their IPv4 representation.</div> <div class=\"note\">\n<p><strong>Internal (Private) Addresses</strong></p> All internal addresses 10/8, 172.16/12, 192.168/16, 169.254/16 and 127/8 blocks (and IPv6 addresses outside of the public 2000::/3 block) are only evaluated by mod_remoteip when <code class=\"directive\"><a href=\"#remoteipinternalproxy\">RemoteIPInternalProxy</a></code> internal (intranet) proxies are registered.</div>   <div class=\"directive-section\">\n<h2 id=\"remoteipheader\">RemoteIPHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Declare the header field which should be parsed for useragent IP addresses</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoteIPHeader header-field</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_remoteip</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#remoteipheader\">RemoteIPHeader</a></code> directive triggers <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> to treat the value of the specified <var>header-field</var> header as the useragent IP address, or list of intermediate useragent IP addresses, subject to further configuration of the <code class=\"directive\"><a href=\"#remoteipinternalproxy\">RemoteIPInternalProxy</a></code> and <code class=\"directive\"><a href=\"#remoteiptrustedproxy\">RemoteIPTrustedProxy</a></code> directives. Unless these other directives are used, <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> will trust all hosts presenting a <code class=\"directive\"><a href=\"#remoteipheader\">RemoteIPHeader</a></code> IP value.</p> <div class=\"example\">\n<h3>Internal (Load Balancer) Example</h3>\n<pre class=\"prettyprint lang-config\">RemoteIPHeader X-Client-IP</pre> </div> <div class=\"example\">\n<h3>Proxy Example</h3>\n<pre class=\"prettyprint lang-config\">RemoteIPHeader X-Forwarded-For</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"remoteipinternalproxy\">RemoteIPInternalProxy Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Declare client intranet IP addresses trusted to present the RemoteIPHeader value</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoteIPInternalProxy proxy-ip|proxy-ip/subnet|hostname ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_remoteip</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#remoteipinternalproxy\">RemoteIPInternalProxy</a></code> directive adds one or more addresses (or address blocks) to trust as presenting a valid RemoteIPHeader value of the useragent IP. Unlike the <code class=\"directive\"><a href=\"#remoteiptrustedproxy\">RemoteIPTrustedProxy</a></code> directive, any IP address presented in this header, including private intranet addresses, are trusted when passed from these proxies.</p> <div class=\"example\">\n<h3>Internal (Load Balancer) Example</h3>\n<pre class=\"prettyprint lang-config\">RemoteIPHeader X-Client-IP\nRemoteIPInternalProxy 10.0.2.0/24\nRemoteIPInternalProxy gateway.localdomain</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"remoteipinternalproxylist\">RemoteIPInternalProxyList Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Declare client intranet IP addresses trusted to present the RemoteIPHeader value</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoteIPInternalProxyList filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_remoteip</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#remoteipinternalproxylist\">RemoteIPInternalProxyList</a></code> directive specifies a file parsed at startup, and builds a list of addresses (or address blocks) to trust as presenting a valid RemoteIPHeader value of the useragent IP.</p> <p>The '<code>#</code>' hash character designates a comment line, otherwise each whitespace or newline separated entry is processed identically to the <code class=\"directive\"><a href=\"#remoteipinternalproxy\">RemoteIPInternalProxy</a></code> directive.</p> <div class=\"example\">\n<h3>Internal (Load Balancer) Example</h3>\n<pre class=\"prettyprint lang-config\">RemoteIPHeader X-Client-IP\nRemoteIPInternalProxyList conf/trusted-proxies.lst</pre> </div> <div class=\"example\">\n<h3>conf/trusted-proxies.lst contents</h3>\n<pre># Our internally trusted proxies;\n10.0.2.0/24         #Everyone in the testing group\ngateway.localdomain #The front end balancer</pre>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"remoteipproxiesheader\">RemoteIPProxiesHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Declare the header field which will record all intermediate IP addresses</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoteIPProxiesHeader HeaderFieldName</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_remoteip</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#remoteipproxiesheader\">RemoteIPProxiesHeader</a></code> directive specifies a header into which <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> will collect a list of all of the intermediate client IP addresses trusted to resolve the useragent IP of the request. Note that intermediate <code class=\"directive\"><a href=\"#remoteiptrustedproxy\">RemoteIPTrustedProxy</a></code> addresses are recorded in this header, while any intermediate <code class=\"directive\"><a href=\"#remoteipinternalproxy\">RemoteIPInternalProxy</a></code> addresses are discarded.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">RemoteIPHeader X-Forwarded-For\nRemoteIPProxiesHeader X-Forwarded-By</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"remoteiptrustedproxy\">RemoteIPTrustedProxy Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Declare client intranet IP addresses trusted to present the RemoteIPHeader value</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoteIPTrustedProxy proxy-ip|proxy-ip/subnet|hostname ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_remoteip</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#remoteiptrustedproxy\">RemoteIPTrustedProxy</a></code> directive adds one or more addresses (or address blocks) to trust as presenting a valid RemoteIPHeader value of the useragent IP. Unlike the <code class=\"directive\"><a href=\"#remoteipinternalproxy\">RemoteIPInternalProxy</a></code> directive, any intranet or private IP address reported by such proxies, including the 10/8, 172.16/12, 192.168/16, 169.254/16 and 127/8 blocks (or outside of the IPv6 public 2000::/3 block) are not trusted as the useragent IP, and are left in the <code class=\"directive\"><a href=\"#remoteipheader\">RemoteIPHeader</a></code> header's value.</p> <div class=\"example\">\n<h3>Trusted (Load Balancer) Example</h3>\n<pre class=\"prettyprint lang-config\">RemoteIPHeader X-Forwarded-For\nRemoteIPTrustedProxy 10.0.2.16/28\nRemoteIPTrustedProxy proxy.example.com</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"remoteiptrustedproxylist\">RemoteIPTrustedProxyList Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Declare client intranet IP addresses trusted to present the RemoteIPHeader value</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RemoteIPTrustedProxyList filename</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_remoteip</td>\n</tr> </table> <p>The <code class=\"directive\"><a href=\"#remoteiptrustedproxylist\">RemoteIPTrustedProxyList</a></code> directive specifies a file parsed at startup, and builds a list of addresses (or address blocks) to trust as presenting a valid RemoteIPHeader value of the useragent IP.</p> <p>The '<code>#</code>' hash character designates a comment line, otherwise each whitespace or newline separated entry is processed identically to the <code class=\"directive\"><a href=\"#remoteiptrustedproxy\">RemoteIPTrustedProxy</a></code> directive.</p> <div class=\"example\">\n<h3>Trusted (Load Balancer) Example</h3>\n<pre class=\"prettyprint lang-config\">RemoteIPHeader X-Forwarded-For\nRemoteIPTrustedProxyList conf/trusted-proxies.lst</pre> </div> <div class=\"example\">\n<h3>conf/trusted-proxies.lst contents</h3>\n<pre># Identified external proxies;\n192.0.2.16/28 #wap phone group of proxies\nproxy.isp.example.com #some well known ISP</pre>\n</div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_remoteip.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_remoteip.html</a>\n  </p>\n</div>\n","mod/mod_sed":"<h1>Apache Module mod_sed</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Filter Input (request) and Output (response) content using <code>sed</code> syntax</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>sed_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_sed.c sed0.c sed1.c regexp.c regexp.h sed.h</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p> <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code> is an in-process content filter. The <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code> filter implements the <code>sed</code> editing commands implemented by the Solaris 10 <code>sed</code> program as described in the <a href=\"http://www.gnu.org/software/sed/manual/sed.txt\">manual page</a>. However, unlike <code>sed</code>, <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code> doesn't take data from standard input. Instead, the filter acts on the entity data sent between client and server. <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code> can be used as an input or output filter. <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code> is a content filter, which means that it cannot be used to modify client or server http headers. </p> <p> The <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code> output filter accepts a chunk of data, executes the <code>sed</code> scripts on the data, and generates the output which is passed to the next filter in the chain. </p> <p> The <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code> input filter reads the data from the next filter in the chain, executes the <code>sed</code> scripts, and returns the generated data to the caller filter in the filter chain. </p> <p> Both the input and output filters only process the data if newline characters are seen in the content. At the end of the data, the rest of the data is treated as the last line. </p> <p>A tutorial article on <code class=\"module\"><a href=\"mod_sed\">mod_sed</a></code>, and why it is more powerful than simple string or regular expression search and replace, is available <a href=\"https://blogs.oracle.com/basant/entry/using_mod_sed_to_filter\">on the author's blog</a>.</p>     <h2 id=\"sampleconf\">Sample Configuration</h2> <div class=\"example\">\n<h3>Adding an output filter </h3>\n<pre class=\"prettyprint lang-config\"># In the following example, the sed filter will change the string\n# \"monday\" to \"MON\" and the string \"sunday\" to SUN in html documents\n# before sending to the client.\n&lt;Directory \"/var/www/docs/sed\"&gt; \n    AddOutputFilter Sed html \n    OutputSed \"s/monday/MON/g\" \n    OutputSed \"s/sunday/SUN/g\" \n&lt;/Directory&gt;</pre> </div> <div class=\"example\">\n<h3>Adding an input filter </h3>\n<pre class=\"prettyprint lang-config\"># In the following example, the sed filter will change the string\n# \"monday\" to \"MON\" and the string \"sunday\" to SUN in the POST data\n# sent to PHP.\n&lt;Directory \"/var/www/docs/sed\"&gt; \n    AddInputFilter Sed php \n    InputSed \"s/monday/MON/g\" \n    InputSed \"s/sunday/SUN/g\" \n&lt;/Directory&gt;</pre> </div>   <h2 id=\"sed_commands\">Sed Commands</h2> <p> Complete details of the <code>sed</code> command can be found from the <a href=\"http://www.gnu.org/software/sed/manual/sed.txt\">sed manual page</a>. </p> <dl> <dt><code>b</code></dt> <dd>Branch to the label specified (similar to goto).</dd> <dt><code>h</code></dt> <dd>Copy the current line to the hold buffer.</dd> <dt><code>H</code></dt> <dd>Append the current line to the hold buffer.</dd> <dt><code>g</code></dt> <dd>Copy the hold buffer to the current line.</dd> <dt><code>G</code></dt> <dd>Append the hold buffer to the current line.</dd> <dt><code>x</code></dt> <dd>Swap the contents of the hold buffer and the current line.</dd> </dl>   <div class=\"directive-section\">\n<h2 id=\"inputsed\">InputSed Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sed command to filter request data (typically <code>POST</code> data)</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>InputSed sed-command</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_sed</td>\n</tr> </table> <p>The <code class=\"directive\">InputSed</code> directive specifies the <code>sed</code> command to execute on the request data e.g., <code>POST</code> data. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"outputsed\">OutputSed Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sed command for filtering response content</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>OutputSed sed-command</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_sed</td>\n</tr> </table> <p>The <code class=\"directive\">OutputSed</code> directive specifies the <code>sed</code> command to execute on the response. </p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_sed.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_sed.html</a>\n  </p>\n</div>\n","mod/mod_session_cookie":"<h1>Apache Module mod_session_cookie</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Cookie based session support</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>session_cookie_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_session_cookie.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>The session modules make use of HTTP cookies, and as such can fall victim to Cross Site Scripting attacks, or expose potentially private information to clients. Please ensure that the relevant risks have been taken into account before enabling the session functionality on your server.</p> </div> <p>This submodule of <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> provides support for the storage of user sessions on the remote browser within HTTP cookies.</p> <p>Using cookies to store a session removes the need for the server or a group of servers to store the session locally, or collaborate to share a session, and can be useful for high traffic environments where a server based session might be too resource intensive.</p> <p>If session privacy is required, the <code class=\"module\"><a href=\"mod_session_crypto\">mod_session_crypto</a></code> module can be used to encrypt the contents of the session before writing the session to the client.</p> <p>For more details on the session interface, see the documentation for the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> module.</p>     <h2 id=\"basicexamples\">Basic Examples</h2> <p>To create a simple session and store it in a cookie called <var>session</var>, configure the session as follows:</p> <div class=\"example\">\n<h3>Browser based session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCookieName session path=/</pre> </div> <p>For more examples on how the session can be configured to be read from and written to by a CGI application, see the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> examples section.</p> <p>For documentation on how the session can be used to store username and password details, see the <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> module.</p>   <div class=\"directive-section\">\n<h2 id=\"sessioncookiename\">SessionCookieName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name and attributes for the RFC2109 cookie storing the session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionCookieName name attributes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_cookie</td>\n</tr> </table> <p>The <code class=\"directive\">SessionCookieName</code> directive specifies the name and optional attributes of an RFC2109 compliant cookie inside which the session will be stored. RFC2109 cookies are set using the <code>Set-Cookie</code> HTTP header. </p> <p>An optional list of cookie attributes can be specified, as per the example below. These attributes are inserted into the cookie as is, and are not interpreted by Apache. Ensure that your attributes are defined correctly as per the cookie specification. </p> <div class=\"example\">\n<h3>Cookie with attributes</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCookieName session path=/private;domain=example.com;httponly;secure;version=1;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessioncookiename2\">SessionCookieName2 Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name and attributes for the RFC2965 cookie storing the session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionCookieName2 name attributes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_cookie</td>\n</tr> </table> <p>The <code class=\"directive\">SessionCookieName2</code> directive specifies the name and optional attributes of an RFC2965 compliant cookie inside which the session will be stored. RFC2965 cookies are set using the <code>Set-Cookie2</code> HTTP header. </p> <p>An optional list of cookie attributes can be specified, as per the example below. These attributes are inserted into the cookie as is, and are not interpreted by Apache. Ensure that your attributes are defined correctly as per the cookie specification. </p> <div class=\"example\">\n<h3>Cookie2 with attributes</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCookieName2 session path=/private;domain=example.com;httponly;secure;version=1;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessioncookieremove\">SessionCookieRemove Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Control for whether session cookies should be removed from incoming HTTP headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionCookieRemove On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionCookieRemove Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_cookie</td>\n</tr> </table> <p>The <code class=\"directive\">SessionCookieRemove</code> flag controls whether the cookies containing the session will be removed from the headers during request processing.</p> <p>In a reverse proxy situation where the Apache server acts as a server frontend for a backend origin server, revealing the contents of the session cookie to the backend could be a potential privacy violation. When set to on, the session cookie will be removed from the incoming HTTP headers.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_session_cookie.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_session_cookie.html</a>\n  </p>\n</div>\n","mod/mod_slotmem_plain":"<h1>Apache Module mod_slotmem_plain</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Slot-based shared memory provider.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>slotmem_plain_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_slotmem_plain.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code>mod_slotmem_plain</code> is a memory provider which provides for creation and access to a plain memory segment in which the datasets are organized in \"slots.\" </p> <p>If the memory needs to be shared between threads and processes, a better provider would be <code class=\"module\"><a href=\"mod_slotmem_shm\">mod_slotmem_shm</a></code>. </p> <p><code>mod_slotmem_plain</code> provides the following API functions: </p> <dl> <dt>apr_status_t doall(ap_slotmem_instance_t *s, ap_slotmem_callback_fn_t *func, void *data, apr_pool_t *pool)</dt> <dd>call the callback on all worker slots</dd> <dt>apr_status_t create(ap_slotmem_instance_t **new, const char *name, apr_size_t item_size, unsigned int item_num, ap_slotmem_type_t type, apr_pool_t *pool)</dt> <dd>create a new slotmem with each item size is item_size.</dd> <dt>apr_status_t attach(ap_slotmem_instance_t **new, const char *name, apr_size_t *item_size, unsigned int *item_num, apr_pool_t *pool)</dt> <dd>attach to an existing slotmem.</dd> <dt>apr_status_t dptr(ap_slotmem_instance_t *s, unsigned int item_id, void**mem)</dt> <dd>get the direct pointer to the memory associated with this worker slot.</dd> <dt>apr_status_t get(ap_slotmem_instance_t *s, unsigned int item_id, unsigned char *dest, apr_size_t dest_len)</dt> <dd>get/read the memory from this slot to dest</dd> <dt>apr_status_t put(ap_slotmem_instance_t *slot, unsigned int item_id, unsigned char *src, apr_size_t src_len)</dt> <dd>put/write the data from src to this slot</dd> <dt>unsigned int num_slots(ap_slotmem_instance_t *s)</dt> <dd>return the total number of slots in the segment</dd> <dt>apr_size_t slot_size(ap_slotmem_instance_t *s)</dt> <dd>return the total data size, in bytes, of a slot in the segment</dd> <dt>apr_status_t grab(ap_slotmem_instance_t *s, unsigned int *item_id);</dt> <dd>grab or allocate the first free slot and mark as in-use (does not do any data copying)</dd> <dt>apr_status_t fgrab(ap_slotmem_instance_t *s, unsigned int item_id);</dt> <dd>forced grab or allocate the specified slot and mark as in-use (does not do any data copying)</dd> <dt>apr_status_t release(ap_slotmem_instance_t *s, unsigned int item_id);</dt> <dd>release or free a slot and mark as not in-use (does not do any data copying)</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_slotmem_plain.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_slotmem_plain.html</a>\n  </p>\n</div>\n","mod/mod_slotmem_shm":"<h1>Apache Module mod_slotmem_shm</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Slot-based shared memory provider.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>slotmem_shm_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_slotmem_shm.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code>mod_slotmem_shm</code> is a memory provider which provides for creation and access to a shared memory segment in which the datasets are organized in \"slots.\" </p> <p>All shared memory is cleared and cleaned with each restart, whether graceful or not. The data itself is stored and restored within a file noted by the <code>name</code> parameter in the <code>create</code> and <code>attach</code> calls. If not specified with an absolute path, the file will be created relative to the path specified by the <code class=\"directive\"><a href=\"core#defaultruntimedir\">DefaultRuntimeDir</a></code> directive. </p> <p><code>mod_slotmem_shm</code> provides the following API functions: </p> <dl> <dt>apr_status_t doall(ap_slotmem_instance_t *s, ap_slotmem_callback_fn_t *func, void *data, apr_pool_t *pool)</dt> <dd>call the callback on all worker slots</dd> <dt>apr_status_t create(ap_slotmem_instance_t **new, const char *name, apr_size_t item_size, unsigned int item_num, ap_slotmem_type_t type, apr_pool_t *pool)</dt> <dd>create a new slotmem with each item size is item_size. <code>name</code> is used to generate a filename for the persistent store of the shared memory if configured. Values are: <dl> <dt><code>\"none\"</code></dt> <dd><code>Anonymous shared memory and no persistent store</code></dd> <dt><code>\"file-name\"</code></dt> <dd><code>[DefaultRuntimeDir]/file-name</code></dd> <dt><code>\"/absolute-file-name\"</code></dt> <dd><code>Absolute file name</code></dd> </dl>\n</dd> <dt>apr_status_t attach(ap_slotmem_instance_t **new, const char *name, apr_size_t *item_size, unsigned int *item_num, apr_pool_t *pool)</dt> <dd>attach to an existing slotmem. See <code>create</code> for description of <code>name</code> parameter.</dd> <dt>apr_status_t dptr(ap_slotmem_instance_t *s, unsigned int item_id, void**mem)</dt> <dd>get the direct pointer to the memory associated with this worker slot.</dd> <dt>apr_status_t get(ap_slotmem_instance_t *s, unsigned int item_id, unsigned char *dest, apr_size_t dest_len)</dt> <dd>get/read the memory from this slot to dest</dd> <dt>apr_status_t put(ap_slotmem_instance_t *slot, unsigned int item_id, unsigned char *src, apr_size_t src_len)</dt> <dd>put/write the data from src to this slot</dd> <dt>unsigned int num_slots(ap_slotmem_instance_t *s)</dt> <dd>return the total number of slots in the segment</dd> <dt>apr_size_t slot_size(ap_slotmem_instance_t *s)</dt> <dd>return the total data size, in bytes, of a slot in the segment</dd> <dt>apr_status_t grab(ap_slotmem_instance_t *s, unsigned int *item_id);</dt> <dd>grab or allocate the first free slot and mark as in-use (does not do any data copying)</dd> <dt>apr_status_t fgrab(ap_slotmem_instance_t *s, unsigned int item_id);</dt> <dd>forced grab or allocate the specified slot and mark as in-use (does not do any data copying)</dd> <dt>apr_status_t release(ap_slotmem_instance_t *s, unsigned int item_id);</dt> <dd>release or free a slot and mark as not in-use (does not do any data copying)</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_slotmem_shm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_slotmem_shm.html</a>\n  </p>\n</div>\n","mod/mod_session_crypto":"<h1>Apache Module mod_session_crypto</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Session encryption support</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>session_crypto_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_session_crypto.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>The session modules make use of HTTP cookies, and as such can fall victim to Cross Site Scripting attacks, or expose potentially private information to clients. Please ensure that the relevant risks have been taken into account before enabling the session functionality on your server.</p> </div> <p>This submodule of <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> provides support for the encryption of user sessions before being written to a local database, or written to a remote browser via an HTTP cookie.</p> <p>This can help provide privacy to user sessions where the contents of the session should be kept private from the user, or where protection is needed against the effects of cross site scripting attacks.</p> <p>For more details on the session interface, see the documentation for the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> module.</p>     <h2 id=\"basicusage\">Basic Usage</h2> <p>To create a simple encrypted session and store it in a cookie called <var>session</var>, configure the session as follows:</p> <div class=\"example\">\n<h3>Browser based encrypted session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCookieName session path=/\nSessionCryptoPassphrase secret</pre> </div> <p>The session will be encrypted with the given key. Different servers can be configured to share sessions by ensuring the same encryption key is used on each server.</p> <p>If the encryption key is changed, sessions will be invalidated automatically.</p> <p>For documentation on how the session can be used to store username and password details, see the <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> module.</p>   <div class=\"directive-section\">\n<h2 id=\"sessioncryptocipher\">SessionCryptoCipher Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The crypto cipher to be used to encrypt the session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionCryptoCipher name</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>aes256</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_crypto</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\">SessionCryptoCipher</code> directive allows the cipher to be used during encryption. If not specified, the cipher defaults to <code>aes256</code>.</p> <p>Possible values depend on the crypto driver in use, and could be one of:</p> <ul>\n<li>3des192</li>\n<li>aes128</li>\n<li>aes192</li>\n<li>aes256</li>\n</ul> </div>  <div class=\"directive-section\">\n<h2 id=\"sessioncryptodriver\">SessionCryptoDriver Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The crypto driver to be used to encrypt the session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionCryptoDriver name [param[=value]]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_crypto</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\">SessionCryptoDriver</code> directive specifies the name of the crypto driver to be used for encryption. If not specified, the driver defaults to the recommended driver compiled into APR-util.</p> <p>The <var>NSS</var> crypto driver requires some parameters for configuration, which are specified as parameters with optional values after the driver name.</p> <div class=\"example\">\n<h3>NSS without a certificate database</h3>\n<pre class=\"prettyprint lang-config\">SessionCryptoDriver nss</pre> </div> <div class=\"example\">\n<h3>NSS with certificate database</h3>\n<pre class=\"prettyprint lang-config\">SessionCryptoDriver nss dir=certs</pre> </div> <div class=\"example\">\n<h3>NSS with certificate database and parameters</h3>\n<pre class=\"prettyprint lang-config\">SessionCryptoDriver nss dir=certs key3=key3.db cert7=cert7.db secmod=secmod</pre> </div> <div class=\"example\">\n<h3>NSS with paths containing spaces</h3>\n<pre class=\"prettyprint lang-config\">SessionCryptoDriver nss \"dir=My Certs\" key3=key3.db cert7=cert7.db secmod=secmod</pre> </div> <p>The <var>NSS</var> crypto driver might have already been configured by another part of the server, for example from <code>mod_nss</code> or <code class=\"module\"><a href=\"mod_ldap\">mod_ldap</a></code>. If found to have already been configured, a warning will be logged, and the existing configuration will have taken affect. To avoid this warning, use the noinit parameter as follows.</p> <div class=\"example\">\n<h3>NSS with certificate database</h3>\n<pre class=\"prettyprint lang-config\">SessionCryptoDriver nss noinit</pre> </div> <p>To prevent confusion, ensure that all modules requiring NSS are configured with identical parameters.</p> <p>The <var>openssl</var> crypto driver supports an optional parameter to specify the engine to be used for encryption.</p> <div class=\"example\">\n<h3>OpenSSL with engine support</h3>\n<pre class=\"prettyprint lang-config\">SessionCryptoDriver openssl engine=name</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessioncryptopassphrase\">SessionCryptoPassphrase Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The key used to encrypt the session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionCryptoPassphrase secret [ secret ... ]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_crypto</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\">SessionCryptoPassphrase</code> directive specifies the keys to be used to enable symmetrical encryption on the contents of the session before writing the session, or decrypting the contents of the session after reading the session.</p> <p>Keys are more secure when they are long, and consist of truly random characters. Changing the key on a server has the effect of invalidating all existing sessions.</p> <p>Multiple keys can be specified in order to support key rotation. The first key listed will be used for encryption, while all keys listed will be attempted for decryption. To rotate keys across multiple servers over a period of time, add a new secret to the end of the list, and once rolled out completely to all servers, remove the first key from the start of the list.</p> <p>As of version 2.4.7 if the value begins with <var>exec:</var> the resulting command will be executed and the first line returned to standard output by the program will be used as the key.</p> <div class=\"example\"><pre>#key used as-is\nSessionCryptoPassphrase secret\n\n#Run /path/to/program to get key\nSessionCryptoPassphrase exec:/path/to/program\n\n#Run /path/to/otherProgram and provide arguments\nSessionCryptoPassphrase \"exec:/path/to/otherProgram argument1\"</pre></div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessioncryptopassphrasefile\">SessionCryptoPassphraseFile Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>File containing keys used to encrypt the session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionCryptoPassphraseFile filename</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Experimental</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_crypto</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3.0 and later</td>\n</tr> </table> <p>The <code class=\"directive\">SessionCryptoPassphraseFile</code> directive specifies the name of a configuration file containing the keys to use for encrypting or decrypting the session, specified one per line. The file is read on server start, and a graceful restart will be necessary for httpd to pick up changes to the keys.</p> <p>Unlike the <code class=\"directive\">SessionCryptoPassphrase</code> directive, the keys are not exposed within the httpd configuration and can be hidden by protecting the file appropriately.</p> <p>Multiple keys can be specified in order to support key rotation. The first key listed will be used for encryption, while all keys listed will be attempted for decryption. To rotate keys across multiple servers over a period of time, add a new secret to the end of the list, and once rolled out completely to all servers, remove the first key from the start of the list.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_session_crypto.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_session_crypto.html</a>\n  </p>\n</div>\n","mod/mod_session_dbd":"<h1>Apache Module mod_session_dbd</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>DBD/SQL based session support</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>session_dbd_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_session_dbd.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>The session modules make use of HTTP cookies, and as such can fall victim to Cross Site Scripting attacks, or expose potentially private information to clients. Please ensure that the relevant risks have been taken into account before enabling the session functionality on your server.</p> </div> <p>This submodule of <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> provides support for the storage of user sessions within a SQL database using the <code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> module.</p> <p>Sessions can either be <strong>anonymous</strong>, where the session is keyed by a unique UUID string stored on the browser in a cookie, or <strong>per user</strong>, where the session is keyed against the userid of the logged in user.</p> <p>SQL based sessions are hidden from the browser, and so offer a measure of privacy without the need for encryption.</p> <p>Different webservers within a server farm may choose to share a database, and so share sessions with one another.</p> <p>For more details on the session interface, see the documentation for the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> module.</p>     <h2 id=\"dbdconfig\">DBD Configuration</h2> <p>Before the <code class=\"module\"><a href=\"mod_session_dbd\">mod_session_dbd</a></code> module can be configured to maintain a session, the <code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code> module must be configured to make the various database queries available to the server.</p> <p>There are four queries required to keep a session maintained, to select an existing session, to update an existing session, to insert a new session, and to delete an expired or empty session. These queries are configured as per the example below.</p> <div class=\"example\">\n<h3>Sample DBD configuration</h3>\n<pre class=\"prettyprint lang-config\">DBDriver pgsql\nDBDParams \"dbname=apachesession user=apache password=xxxxx host=localhost\"\nDBDPrepareSQL \"delete from session where key = %s\" deletesession\nDBDPrepareSQL \"update session set value = %s, expiry = %lld, key = %s where key = %s\" updatesession\nDBDPrepareSQL \"insert into session (value, expiry, key) values (%s, %lld, %s)\" insertsession\nDBDPrepareSQL \"select value from session where key = %s and (expiry = 0 or expiry &gt; %lld)\" selectsession\nDBDPrepareSQL \"delete from session where expiry != 0 and expiry &lt; %lld\" cleansession</pre> </div>   <h2 id=\"anonymous\">Anonymous Sessions</h2> <p>Anonymous sessions are keyed against a unique UUID, and stored on the browser within an HTTP cookie. This method is similar to that used by most application servers to store session information.</p> <p>To create a simple anonymous session and store it in a postgres database table called <var>apachesession</var>, and save the session ID in a cookie called <var>session</var>, configure the session as follows:</p> <div class=\"example\">\n<h3>SQL based anonymous session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionDBDCookieName session path=/</pre> </div> <p>For more examples on how the session can be configured to be read from and written to by a CGI application, see the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> examples section.</p> <p>For documentation on how the session can be used to store username and password details, see the <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> module.</p>   <h2 id=\"peruser\">Per User Sessions</h2> <p>Per user sessions are keyed against the username of a successfully authenticated user. It offers the most privacy, as no external handle to the session exists outside of the authenticated realm.</p> <p>Per user sessions work within a correctly configured authenticated environment, be that using basic authentication, digest authentication or SSL client certificates. Due to the limitations of who came first, the chicken or the egg, per user sessions cannot be used to store authentication credentials from a module like <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code>.</p> <p>To create a simple per user session and store it in a postgres database table called <var>apachesession</var>, and with the session keyed to the userid, configure the session as follows:</p> <div class=\"example\">\n<h3>SQL based per user session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionDBDPerUser On</pre> </div>   <h2 id=\"housekeeping\">Database Housekeeping</h2> <p>Over the course of time, the database can be expected to start accumulating expired sessions. At this point, the <code class=\"module\"><a href=\"mod_session_dbd\">mod_session_dbd</a></code> module is not yet able to handle session expiry automatically.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>The administrator will need to set up an external process via cron to clean out expired sessions.</p> </div>   <div class=\"directive-section\">\n<h2 id=\"sessiondbdcookiename\">SessionDBDCookieName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name and attributes for the RFC2109 cookie storing the session ID</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDCookieName name attributes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDCookieName</code> directive specifies the name and optional attributes of an RFC2109 compliant cookie inside which the session ID will be stored. RFC2109 cookies are set using the <code>Set-Cookie</code> HTTP header. </p> <p>An optional list of cookie attributes can be specified, as per the example below. These attributes are inserted into the cookie as is, and are not interpreted by Apache. Ensure that your attributes are defined correctly as per the cookie specification. </p> <div class=\"example\">\n<h3>Cookie with attributes</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionDBDCookieName session path=/private;domain=example.com;httponly;secure;version=1;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessiondbdcookiename2\">SessionDBDCookieName2 Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name and attributes for the RFC2965 cookie storing the session ID</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDCookieName2 name attributes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDCookieName2</code> directive specifies the name and optional attributes of an RFC2965 compliant cookie inside which the session ID will be stored. RFC2965 cookies are set using the <code>Set-Cookie2</code> HTTP header. </p> <p>An optional list of cookie attributes can be specified, as per the example below. These attributes are inserted into the cookie as is, and are not interpreted by Apache. Ensure that your attributes are defined correctly as per the cookie specification. </p> <div class=\"example\">\n<h3>Cookie2 with attributes</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionDBDCookieName2 session path=/private;domain=example.com;httponly;secure;version=1;</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessiondbdcookieremove\">SessionDBDCookieRemove Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Control for whether session ID cookies should be removed from incoming HTTP headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDCookieRemove On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionDBDCookieRemove On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDCookieRemove</code> flag controls whether the cookies containing the session ID will be removed from the headers during request processing.</p> <p>In a reverse proxy situation where the Apache server acts as a server frontend for a backend origin server, revealing the contents of the session ID cookie to the backend could be a potential privacy violation. When set to on, the session ID cookie will be removed from the incoming HTTP headers.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sessiondbddeletelabel\">SessionDBDDeleteLabel Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The SQL query to use to remove sessions from the database</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDDeleteLabel label</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionDBDDeleteLabel deletesession</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDDeleteLabel</code> directive sets the default delete query label to be used to delete an expired or empty session. This label must have been previously defined using the <code class=\"directive\"><a href=\"mod_dbd#dbdpreparesql\">DBDPrepareSQL</a></code> directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sessiondbdinsertlabel\">SessionDBDInsertLabel Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The SQL query to use to insert sessions into the database</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDInsertLabel label</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionDBDInsertLabel insertsession</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDInsertLabel</code> directive sets the default insert query label to be used to load in a session. This label must have been previously defined using the <code class=\"directive\"><a href=\"mod_dbd#dbdpreparesql\">DBDPrepareSQL</a></code> directive.</p> <p>If an attempt to update the session affects no rows, this query will be called to insert the session into the database.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sessiondbdperuser\">SessionDBDPerUser Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable a per user session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDPerUser On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionDBDPerUser Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDPerUser</code> flag enables a per user session keyed against the user's login name. If the user is not logged in, this directive will be ignored.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sessiondbdselectlabel\">SessionDBDSelectLabel Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The SQL query to use to select sessions from the database</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDSelectLabel label</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionDBDSelectLabel selectsession</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDSelectLabel</code> directive sets the default select query label to be used to load in a session. This label must have been previously defined using the <code class=\"directive\"><a href=\"mod_dbd#dbdpreparesql\">DBDPrepareSQL</a></code> directive.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sessiondbdupdatelabel\">SessionDBDUpdateLabel Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The SQL query to use to update existing sessions in the database</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionDBDUpdateLabel label</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionDBDUpdateLabel updatesession</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session_dbd</td>\n</tr> </table> <p>The <code class=\"directive\">SessionDBDUpdateLabel</code> directive sets the default update query label to be used to load in a session. This label must have been previously defined using the <code class=\"directive\"><a href=\"mod_dbd#dbdpreparesql\">DBDPrepareSQL</a></code> directive.</p> <p>If an attempt to update the session affects no rows, the insert query will be called to insert the session into the database. If the database supports InsertOrUpdate, override this query to perform the update in one query instead of two.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_session_dbd.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_session_dbd.html</a>\n  </p>\n</div>\n","mod/mod_setenvif":"<h1>Apache Module mod_setenvif</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Allows the setting of environment variables based on characteristics of the request</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>setenvif_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_setenvif.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code> module allows you to set internal environment variables according to whether different aspects of the request match regular expressions you specify. These environment variables can be used by other parts of the server to make decisions about actions to be taken, as well as becoming available to CGI scripts and SSI pages.</p> <p>The directives are considered in the order they appear in the configuration files. So more complex sequences can be used, such as this example, which sets <code>netscape</code> if the browser is mozilla but not MSIE.</p> <pre class=\"prettyprint lang-config\">BrowserMatch ^Mozilla netscape\nBrowserMatch MSIE !netscape</pre> <p>When the server looks up a path via an internal <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#subrequest\" title=\"see glossary\">subrequest</a> such as looking for a <code class=\"directive\"><a href=\"mod_dir#directoryindex\">DirectoryIndex</a></code> or generating a directory listing with <code class=\"module\"><a href=\"mod_autoindex\">mod_autoindex</a></code>, per-request environment variables are <em>not</em> inherited in the subrequest. Additionally, <code class=\"directive\"><a href=\"#setenvif\">SetEnvIf</a></code> directives are not separately evaluated in the subrequest due to the API phases <code class=\"module\"><a href=\"mod_setenvif\">mod_setenvif</a></code> takes action in.</p>    <div class=\"directive-section\">\n<h2 id=\"browsermatch\">BrowserMatch Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets environment variables conditional on HTTP User-Agent </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BrowserMatch regex [!]env-variable[=value] [[!]env-variable[=value]] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_setenvif</td>\n</tr> </table> <p>The <code class=\"directive\">BrowserMatch</code> is a special cases of the <code class=\"directive\"><a href=\"#setenvif\">SetEnvIf</a></code> directive that sets environment variables conditional on the <code>User-Agent</code> HTTP request header. The following two lines have the same effect:</p> <pre class=\"prettyprint lang-config\">BrowserMatch Robot is_a_robot\nSetEnvIf User-Agent Robot is_a_robot</pre> <p>Some additional examples:</p> <pre class=\"prettyprint lang-config\">BrowserMatch ^Mozilla forms jpeg=yes browser=netscape\nBrowserMatch \"^Mozilla/[2-3]\" tables agif frames javascript\nBrowserMatch MSIE !javascript</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"browsermatchnocase\">BrowserMatchNoCase Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets environment variables conditional on User-Agent without respect to case</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BrowserMatchNoCase regex [!]env-variable[=value] [[!]env-variable[=value]] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_setenvif</td>\n</tr> </table> <p>The <code class=\"directive\">BrowserMatchNoCase</code> directive is semantically identical to the <code class=\"directive\"><a href=\"#browsermatch\">BrowserMatch</a></code> directive. However, it provides for case-insensitive matching. For example:</p> <pre class=\"prettyprint lang-config\">BrowserMatchNoCase mac platform=macintosh\nBrowserMatchNoCase win platform=windows</pre> <p>The <code class=\"directive\">BrowserMatch</code> and <code class=\"directive\">BrowserMatchNoCase</code> directives are special cases of the <code class=\"directive\"><a href=\"#setenvif\">SetEnvIf</a></code> and <code class=\"directive\"><a href=\"#setenvifnocase\">SetEnvIfNoCase</a></code> directives. The following two lines have the same effect:</p> <pre class=\"prettyprint lang-config\">BrowserMatchNoCase Robot is_a_robot\nSetEnvIfNoCase User-Agent Robot is_a_robot</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"setenvif\">SetEnvIf Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets environment variables based on attributes of the request </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SetEnvIf attribute regex [!]env-variable[=value] [[!]env-variable[=value]] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_setenvif</td>\n</tr> </table> <p>The <code class=\"directive\">SetEnvIf</code> directive defines environment variables based on attributes of the request. The <em>attribute</em> specified in the first argument can be one of four things:</p> <ol> <li>An HTTP request header field (see <a href=\"http://www.rfc-editor.org/rfc/rfc2616.txt\">RFC2616</a> for more information about these); for example: <code>Host</code>, <code>User-Agent</code>, <code>Referer</code>, and <code>Accept-Language</code>. A regular expression may be used to specify a set of request headers.</li> <li>One of the following aspects of the request: <ul> <li>\n<code>Remote_Host</code> - the hostname (if available) of the client making the request</li> <li>\n<code>Remote_Addr</code> - the IP address of the client making the request</li> <li>\n<code>Server_Addr</code> - the IP address of the server on which the request was received (only with versions later than 2.0.43)</li> <li>\n<code>Request_Method</code> - the name of the method being used (<code>GET</code>, <code>POST</code>, <em>et cetera</em>)</li> <li>\n<code>Request_Protocol</code> - the name and version of the protocol with which the request was made (<em>e.g.</em>, \"HTTP/0.9\", \"HTTP/1.1\", <em>etc.</em>)</li> <li>\n<code>Request_URI</code> - the resource requested on the HTTP request line -- generally the portion of the URL following the scheme and host portion without the query string. See the <code class=\"directive\"><a href=\"mod_rewrite#rewritecond\">RewriteCond</a></code> directive of <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> for extra information on how to match your query string.</li> </ul> </li> <li>The name of an environment variable in the list of those associated with the request. This allows <code class=\"directive\">SetEnvIf</code> directives to test against the result of prior matches. Only those environment variables defined by earlier <code>SetEnvIf[NoCase]</code> directives are available for testing in this manner. 'Earlier' means that they were defined at a broader scope (such as server-wide) or previously in the current directive's scope. Environment variables will be considered only if there was no match among request characteristics and a regular expression was not used for the <em>attribute</em>.</li> </ol> <p>The second argument (<em>regex</em>) is a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a>. If the <em>regex</em> matches against the <em>attribute</em>, then the remainder of the arguments are evaluated.</p> <p>The rest of the arguments give the names of variables to set, and optionally values to which they should be set. These take the form of</p> <ol> <li>\n<code><em>varname</em></code>, or</li> <li>\n<code>!<em>varname</em></code>, or</li> <li><code><em>varname</em>=<em>value</em></code></li> </ol> <p>In the first form, the value will be set to \"1\". The second will remove the given variable if already defined, and the third will set the variable to the literal value given by <code><em>value</em></code>. Since version 2.0.51, Apache httpd will recognize occurrences of <code>$1</code>..<code>$9</code> within <var>value</var> and replace them by parenthesized subexpressions of <var>regex</var>. <code>$0</code> provides access to the whole string matched by that pattern.</p> <pre class=\"prettyprint lang-config\">SetEnvIf Request_URI \"\\.gif$\" object_is_image=gif\nSetEnvIf Request_URI \"\\.jpg$\" object_is_image=jpg\nSetEnvIf Request_URI \"\\.xbm$\" object_is_image=xbm\n    \nSetEnvIf Referer www\\.mydomain\\.example\\.com intra_site_referral\n    \nSetEnvIf object_is_image xbm XBIT_PROCESSING=1\n    \nSetEnvIf Request_URI \"\\.(.*)$\" EXTENSION=$1\n\nSetEnvIf ^TS  ^[a-z]  HAVE_TS</pre> <p>The first three will set the environment variable <code>object_is_image</code> if the request was for an image file, and the fourth sets <code>intra_site_referral</code> if the referring page was somewhere on the <code>www.mydomain.example.com</code> Web site.</p> <p>The last example will set environment variable <code>HAVE_TS</code> if the request contains any headers that begin with \"TS\" whose values begins with any character in the set [a-z].</p> <h3>See also</h3> <ul> <li>\n<a href=\"../env\">Environment Variables in Apache HTTP Server</a>, for additional examples. </li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"setenvifexpr\">SetEnvIfExpr Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets environment variables based on an ap_expr expression</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SetEnvIfExpr expr [!]env-variable[=value] [[!]env-variable[=value]] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_setenvif</td>\n</tr> </table> <p>The <code class=\"directive\">SetEnvIfExpr</code> directive defines environment variables based on an <code class=\"directive\"><a href=\"core#if\">&lt;If&gt;</a></code> <code>ap_expr</code>. These expressions will be evaluated at runtime, and applied <em>env-variable</em> in the same fashion as <code class=\"directive\">SetEnvIf</code>.</p> <pre class=\"prettyprint lang-config\">SetEnvIfExpr \"tolower(req('X-Sendfile')) == 'd:\\images\\very_big.iso')\" iso_delivered</pre> <p>This would set the environment variable <code>iso_delivered</code> every time our application attempts to send it via <code>X-Sendfile</code></p> <p>A more useful example would be to set the variable rfc1918 if the remote IP address is a private address according to RFC 1918:</p> <pre class=\"prettyprint lang-config\">SetEnvIfExpr \"-R '10.0.0.0/8' || -R '172.16.0.0/12' || -R '192.168.0.0/16'\" rfc1918</pre> <h3>See also</h3> <ul> <li>\n<a href=\"../expr\">Expressions in Apache HTTP Server</a>, for a complete reference and more examples.</li> <li>\n<code class=\"directive\"><a href=\"core#if\">&lt;If&gt;</a></code> can be used to achieve similar results.</li> <li><code class=\"module\"><a href=\"mod_filter\">mod_filter</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"setenvifnocase\">SetEnvIfNoCase Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets environment variables based on attributes of the request without respect to case</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SetEnvIfNoCase attribute regex [!]env-variable[=value] [[!]env-variable[=value]] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_setenvif</td>\n</tr> </table> <p>The <code class=\"directive\">SetEnvIfNoCase</code> is semantically identical to the <code class=\"directive\"><a href=\"#setenvif\">SetEnvIf</a></code> directive, and differs only in that the regular expression matching is performed in a case-insensitive manner. For example:</p> <pre class=\"prettyprint lang-config\">SetEnvIfNoCase Host Example\\.Org site=example</pre> <p>This will cause the <code>site</code> environment variable to be set to \"<code>example</code>\" if the HTTP request header field <code>Host:</code> was included and contained <code>Example.Org</code>, <code>example.org</code>, or any other combination.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_setenvif.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_setenvif.html</a>\n  </p>\n</div>\n","mod/mod_socache_dbm":"<h1>Apache Module mod_socache_dbm</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>DBM based shared object cache provider.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>socache_dbm_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_socache_dbm.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code>mod_socache_dbm</code> is a shared object cache provider which provides for creation and access to a cache backed by a DBM database. </p> <div class=\"example\"><code>dbm:/path/to/datafile</code></div> <p>Details of other shared object cache providers can be found <a href=\"../socache\">here</a>. </p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_socache_dbm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_socache_dbm.html</a>\n  </p>\n</div>\n","mod/mod_socache_dc":"<h1>Apache Module mod_socache_dc</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Distcache based shared object cache provider.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>socache_dc_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_socache_dc.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_socache_dc\">mod_socache_dc</a></code> is a shared object cache provider which provides for creation and access to a cache backed by the <a href=\"http://distcache.sourceforge.net/\">distcache</a> distributed session caching libraries. </p> <p>Details of other shared object cache providers can be found <a href=\"../socache\">here</a>. </p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_socache_dc.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_socache_dc.html</a>\n  </p>\n</div>\n","mod/mod_socache_memcache":"<h1>Apache Module mod_socache_memcache</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Memcache based shared object cache provider.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>socache_memcache_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_socache_memcache.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code>mod_socache_memcache</code> is a shared object cache provider which provides for creation and access to a cache backed by the <a href=\"http://memcached.org/\">memcached</a> high-performance, distributed memory object caching system. </p> <p>This shared object cache provider's \"create\" method requires a comma separated list of memcached host/port specifications. If using this provider via another modules configuration (such as <code class=\"directive\"><a href=\"mod_ssl#sslsessioncache\">SSLSessionCache</a></code>), provide the list of servers as the optional \"arg\" parameter.</p> <pre class=\"prettyprint lang-config\">SSLSessionCache memcache:memcache.example.com:12345,memcache2.example.com:12345</pre> <p>Details of other shared object cache providers can be found <a href=\"../socache\">here</a>. </p>    <div class=\"directive-section\">\n<h2 id=\"memcacheconnttl\">MemcacheConnTTL Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Keepalive time for idle connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>MemcacheConnTTL num[units]</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>MemcacheConnTTL 15s</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_socache_memcache</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.4.17 and later</td>\n</tr> </table> <p>Set the time to keep idle connections with the memcache server(s) alive (threaded platforms only).</p> <p>Valid values for <code class=\"directive\">MemcacheConnTTL</code> are times up to one hour. 0 means no timeout.</p> <div class=\"note\"><p>This timeout defaults to units of seconds, but accepts suffixes for milliseconds (ms), seconds (s), minutes (min), and hours (h). </p></div> <p>Before Apache 2.4.17, this timeout was hardcoded and its value was 600 usec. So, the closest configuration to match the legacy behaviour is to set <code class=\"directive\">MemcacheConnTTL</code> to 1ms.</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\"># Set a timeout of 10 minutes\nMemcacheConnTTL 10min\n# Set a timeout of 60 seconds\nMemcacheConnTTL 60</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_socache_memcache.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_socache_memcache.html</a>\n  </p>\n</div>\n","mod/mod_socache_shmcb":"<h1>Apache Module mod_socache_shmcb</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>shmcb based shared object cache provider.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>socache_shmcb_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_socache_shmcb.c</td>\n</tr>\n</table> <h3>Summary</h3> <p><code>mod_socache_shmcb</code> is a shared object cache provider which provides for creation and access to a cache backed by a high-performance cyclic buffer inside a shared memory segment. </p> <div class=\"example\"><code>shmcb:/path/to/datafile(512000)</code></div> <p>Details of other shared object cache providers can be found <a href=\"../socache\">here</a>. </p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_socache_shmcb.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_socache_shmcb.html</a>\n  </p>\n</div>\n","mod/mod_session":"<h1>Apache Module mod_session</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Session support</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>session_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_session.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>The session modules make use of HTTP cookies, and as such can fall victim to Cross Site Scripting attacks, or expose potentially private information to clients. Please ensure that the relevant risks have been taken into account before enabling the session functionality on your server.</p> </div> <p>This module provides support for a server wide per user session interface. Sessions can be used for keeping track of whether a user has been logged in, or for other per user information that should be kept available across requests.</p> <p>Sessions may be stored on the server, or may be stored on the browser. Sessions may also be optionally encrypted for added security. These features are divided into several modules in addition to <code class=\"module\"><a href=\"mod_session\">mod_session</a></code>; <code class=\"module\"><a href=\"mod_session_crypto\">mod_session_crypto</a></code>, <code class=\"module\"><a href=\"mod_session_cookie\">mod_session_cookie</a></code> and <code class=\"module\"><a href=\"mod_session_dbd\">mod_session_dbd</a></code>. Depending on the server requirements, load the appropriate modules into the server (either statically at compile time or dynamically via the <code class=\"directive\"><a href=\"mod_so#loadmodule\">LoadModule</a></code> directive).</p> <p>Sessions may be manipulated from other modules that depend on the session, or the session may be read from and written to using environment variables and HTTP headers, as appropriate.</p>     <h2 id=\"whatisasession\">What is a session?</h2> <p>At the core of the session interface is a table of key and value pairs that are made accessible across browser requests. These pairs can be set to any valid string, as needed by the application making use of the session.</p> <p>The \"session\" is a <strong>application/x-www-form-urlencoded</strong> string containing these key value pairs, as defined by the <a href=\"http://www.w3.org/TR/html4/\">HTML specification</a>.</p> <p>The session can optionally be encrypted and base64 encoded before being written to the storage mechanism, as defined by the administrator.</p>   <h2 id=\"whocanuseasession\">Who can use a session?</h2> <p>The session interface is primarily developed for the use by other server modules, such as <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code>, however CGI based applications can optionally be granted access to the contents of the session via the HTTP_SESSION environment variable. Sessions have the option to be modified and/or updated by inserting an HTTP response header containing the new session parameters.</p>   <h2 id=\"serversession\">Keeping sessions on the server</h2> <p>Apache can be configured to keep track of per user sessions stored on a particular server or group of servers. This functionality is similar to the sessions available in typical application servers.</p> <p>If configured, sessions are tracked through the use of a session ID that is stored inside a cookie, or extracted from the parameters embedded within the URL query string, as found in a typical GET request.</p> <p>As the contents of the session are stored exclusively on the server, there is an expectation of privacy of the contents of the session. This does have performance and resource implications should a large number of sessions be present, or where a large number of webservers have to share sessions with one another.</p> <p>The <code class=\"module\"><a href=\"mod_session_dbd\">mod_session_dbd</a></code> module allows the storage of user sessions within a SQL database via <code class=\"module\"><a href=\"mod_dbd\">mod_dbd</a></code>.</p>   <h2 id=\"browsersession\">Keeping sessions on the browser</h2> <p>In high traffic environments where keeping track of a session on a server is too resource intensive or inconvenient, the option exists to store the contents of the session within a cookie on the client browser instead.</p> <p>This has the advantage that minimal resources are required on the server to keep track of sessions, and multiple servers within a server farm have no need to share session information.</p> <p>The contents of the session however are exposed to the client, with a corresponding risk of a loss of privacy. The <code class=\"module\"><a href=\"mod_session_crypto\">mod_session_crypto</a></code> module can be configured to encrypt the contents of the session before writing the session to the client.</p> <p>The <code class=\"module\"><a href=\"mod_session_cookie\">mod_session_cookie</a></code> allows the storage of user sessions on the browser within an HTTP cookie.</p>   <h2 id=\"basicexamples\">Basic Examples</h2> <p>Creating a session is as simple as turning the session on, and deciding where the session will be stored. In this example, the session will be stored on the browser, in a cookie called <code>session</code>.</p> <div class=\"example\">\n<h3>Browser based session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCookieName session path=/</pre> </div> <p>The session is not useful unless it can be written to or read from. The following example shows how values can be injected into the session through the use of a predetermined HTTP response header called <code>X-Replace-Session</code>.</p> <div class=\"example\">\n<h3>Writing to a session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCookieName session path=/\nSessionHeader X-Replace-Session</pre> </div> <p>The header should contain name value pairs expressed in the same format as a query string in a URL, as in the example below. Setting a key to the empty string has the effect of removing that key from the session.</p> <div class=\"example\">\n<h3>CGI to write to a session</h3>\n<pre class=\"prettyprint lang-sh\">#!/bin/bash\necho \"Content-Type: text/plain\"\necho \"X-Replace-Session: key1=foo&amp;key2=&amp;key3=bar\"\necho\nenv</pre> </div> <p>If configured, the session can be read back from the HTTP_SESSION environment variable. By default, the session is kept private, so this has to be explicitly turned on with the <code class=\"directive\"><a href=\"#sessionenv\">SessionEnv</a></code> directive.</p> <div class=\"example\">\n<h3>Read from a session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionEnv On\nSessionCookieName session path=/\nSessionHeader X-Replace-Session</pre> </div> <p>Once read, the CGI variable <code>HTTP_SESSION</code> should contain the value <code>key1=foo&amp;key3=bar</code>.</p>   <h2 id=\"sessionprivacy\">Session Privacy</h2> <p>Using the \"show cookies\" feature of your browser, you would have seen a clear text representation of the session. This could potentially be a problem should the end user need to be kept unaware of the contents of the session, or where a third party could gain unauthorised access to the data within the session.</p> <p>The contents of the session can be optionally encrypted before being placed on the browser using the <code class=\"module\"><a href=\"mod_session_crypto\">mod_session_crypto</a></code> module.</p> <div class=\"example\">\n<h3>Browser based encrypted session</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCryptoPassphrase secret\nSessionCookieName session path=/</pre> </div> <p>The session will be automatically decrypted on load, and encrypted on save by Apache, the underlying application using the session need have no knowledge that encryption is taking place.</p> <p>Sessions stored on the server rather than on the browser can also be encrypted as needed, offering privacy where potentially sensitive information is being shared between webservers in a server farm using the <code class=\"module\"><a href=\"mod_session_dbd\">mod_session_dbd</a></code> module.</p>   <h2 id=\"cookieprivacy\">Cookie Privacy</h2> <p>The HTTP cookie mechanism also offers privacy features, such as the ability to restrict cookie transport to SSL protected pages only, or to prevent browser based javascript from gaining access to the contents of the cookie.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Some of the HTTP cookie privacy features are either non-standard, or are not implemented consistently across browsers. The session modules allow you to set cookie parameters, but it makes no guarantee that privacy will be respected by the browser. If security is a concern, use the <code class=\"module\"><a href=\"mod_session_crypto\">mod_session_crypto</a></code> to encrypt the contents of the session, or store the session on the server using the <code class=\"module\"><a href=\"mod_session_dbd\">mod_session_dbd</a></code> module.</p> </div> <p>Standard cookie parameters can be specified after the name of the cookie, as in the example below.</p> <div class=\"example\">\n<h3>Setting cookie parameters</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCryptoPassphrase secret\nSessionCookieName session path=/private;domain=example.com;httponly;secure;</pre> </div> <p>In cases where the Apache server forms the frontend for backend origin servers, it is possible to have the session cookies removed from the incoming HTTP headers using the <code class=\"directive\"><a href=\"mod_session_cookie#sessioncookieremove\">SessionCookieRemove</a></code> directive. This keeps the contents of the session cookies from becoming accessible from the backend server. </p>   <h2 id=\"authentication\">Session Support for Authentication</h2> <p>As is possible within many application servers, authentication modules can use a session for storing the username and password after login. The <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> saves the user's login name and password within the session.</p> <div class=\"example\">\n<h3>Form based authentication</h3>\n<pre class=\"prettyprint lang-config\">Session On\nSessionCryptoPassphrase secret\nSessionCookieName session path=/\nAuthFormProvider file\nAuthUserFile \"conf/passwd\"\nAuthType form\nAuthName realm\n#...</pre> </div> <p>See the <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code> module for documentation and complete examples.</p>   <h2 id=\"integration\">Integrating Sessions with External Applications</h2> <p>In order for sessions to be useful, it must be possible to share the contents of a session with external applications, and it must be possible for an external application to write a session of its own.</p> <p> A typical example might be an application that changes a user's password set by <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code>. This application would need to read the current username and password from the session, make the required changes to the user's password, and then write the new password to the session in order to provide a seamless transition to the new password.</p> <p>A second example might involve an application that registers a new user for the first time. When registration is complete, the username and password is written to the session, providing a seamless transition to being logged in.</p> <dl> <dt>Apache modules</dt> <dd>Modules within the server that need access to the session can use the <strong>mod_session.h</strong> API in order to read from and write to the session. This mechanism is used by modules like <code class=\"module\"><a href=\"mod_auth_form\">mod_auth_form</a></code>. </dd> <dt>CGI programs and scripting languages</dt> <dd>Applications that run within the webserver can optionally retrieve the value of the session from the <strong>HTTP_SESSION</strong> environment variable. The session should be encoded as a <strong>application/x-www-form-urlencoded</strong> string as described by the <a href=\"http://www.w3.org/TR/html4/\">HTML specification</a>. The environment variable is controlled by the setting of the <code class=\"directive\"><a href=\"#sessionenv\">SessionEnv</a></code> directive. The session can be written to by the script by returning a <strong>application/x-www-form-urlencoded</strong> response header with a name set by the <code class=\"directive\"><a href=\"#sessionheader\">SessionHeader</a></code> directive. In both cases, any encryption or decryption, and the reading the session from or writing the session to the chosen storage mechanism is handled by the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> modules and corresponding configuration. </dd> <dt>Applications behind <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>\n</dt> <dd>If the <code class=\"directive\"><a href=\"#sessionheader\">SessionHeader</a></code> directive is used to define an HTTP request header, the session, encoded as a <strong>application/x-www-form-urlencoded</strong> string, will be made available to the application. If the same header is provided in the response, the value of this response header will be used to replace the session. As above, any encryption or decryption, and the reading the session from or writing the session to the chosen storage mechanism is handled by the <code class=\"module\"><a href=\"mod_session\">mod_session</a></code> modules and corresponding configuration.</dd> <dt>Standalone applications</dt> <dd>Applications might choose to manipulate the session outside the control of the Apache HTTP server. In this case, it is the responsibility of the application to read the session from the chosen storage mechanism, decrypt the session, update the session, encrypt the session and write the session to the chosen storage mechanism, as appropriate.</dd> </dl>   <div class=\"directive-section\">\n<h2 id=\"session\">Session Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables a session for the current directory or location</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Session On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Session Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session</td>\n</tr> </table> <p>The <code class=\"directive\">Session</code> directive enables a session for the directory or location container. Further directives control where the session will be stored and how privacy is maintained.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sessionenv\">SessionEnv Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Control whether the contents of the session are written to the <var>HTTP_SESSION</var> environment variable</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionEnv On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionEnv Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session</td>\n</tr> </table> <p>If set to <var>On</var>, the <code class=\"directive\">SessionEnv</code> directive causes the contents of the session to be written to a CGI environment variable called <var>HTTP_SESSION</var>.</p> <p>The string is written in the URL query format, for example:</p> <div class=\"example\"><code>key1=foo&amp;key3=bar</code></div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessionexclude\">SessionExclude Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define URL prefixes for which a session is ignored</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionExclude path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session</td>\n</tr> </table> <p>The <code class=\"directive\">SessionExclude</code> directive allows sessions to be disabled relative to URL prefixes only. This can be used to make a website more efficient, by targeting a more precise URL space for which a session should be maintained. By default, all URLs within the directory or location are included in the session. The <code class=\"directive\"><a href=\"#sessionexclude\">SessionExclude</a></code> directive takes precedence over the <code class=\"directive\"><a href=\"#sessioninclude\">SessionInclude</a></code> directive.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>This directive has a similar purpose to the <var>path</var> attribute in HTTP cookies, but should not be confused with this attribute. This directive does not set the <var>path</var> attribute, which must be configured separately.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessionheader\">SessionHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Import session updates from a given HTTP response header</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionHeader header</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>none</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session</td>\n</tr> </table> <p>The <code class=\"directive\">SessionHeader</code> directive defines the name of an HTTP response header which, if present, will be parsed and written to the current session.</p> <p>The header value is expected to be in the URL query format, for example:</p> <div class=\"example\"><code>key1=foo&amp;key2=&amp;key3=bar</code></div> <p>Where a key is set to the empty string, that key will be removed from the session.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"sessioninclude\">SessionInclude Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define URL prefixes for which a session is valid</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionInclude path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>all URLs</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session</td>\n</tr> </table> <p>The <code class=\"directive\">SessionInclude</code> directive allows sessions to be made valid for specific URL prefixes only. This can be used to make a website more efficient, by targeting a more precise URL space for which a session should be maintained. By default, all URLs within the directory or location are included in the session.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>This directive has a similar purpose to the <var>path</var> attribute in HTTP cookies, but should not be confused with this attribute. This directive does not set the <var>path</var> attribute, which must be configured separately.</p>\n</div> </div>  <div class=\"directive-section\">\n<h2 id=\"sessionmaxage\">SessionMaxAge Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Define a maximum age in seconds for a session</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SessionMaxAge maxage</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SessionMaxAge 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>AuthConfig</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_session</td>\n</tr> </table> <p>The <code class=\"directive\">SessionMaxAge</code> directive defines a time limit for which a session will remain valid. When a session is saved, this time limit is reset and an existing session can be continued. If a session becomes older than this limit without a request to the server to refresh the session, the session will time out and be removed. Where a session is used to stored user login details, this has the effect of logging the user out automatically after the given time.</p> <p>Setting the maxage to zero disables session expiry.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_session.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_session.html</a>\n  </p>\n</div>\n","mod/mod_speling":"<h1>Apache Module mod_speling</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Attempts to correct mistaken URLs by ignoring capitalization, or attempting to correct various minor misspellings.</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>speling_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_speling.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>Requests to documents sometimes cannot be served by the core apache server because the request was misspelled or miscapitalized. This module addresses this problem by trying to find a matching document, even after all other modules gave up. It does its work by comparing each document name in the requested directory against the requested document name <strong>without regard to case</strong>, and allowing <strong>up to one misspelling</strong> (character insertion / omission / transposition or wrong character). A list is built with all document names which were matched using this strategy.</p> <p>If, after scanning the directory,</p> <ul> <li>no matching document was found, Apache will proceed as usual and return a \"document not found\" error.</li> <li>only one document is found that \"almost\" matches the request, then it is returned in the form of a redirection response.</li> <li>more than one document with a close match was found, then the list of the matches is returned to the client, and the client can select the correct candidate.</li> </ul>    <div class=\"directive-section\">\n<h2 id=\"checkcaseonly\">CheckCaseOnly Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Limits the action of the speling module to case corrections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CheckCaseOnly on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CheckCaseOnly Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_speling</td>\n</tr> </table> <p>When set, this directive limits the action of the spelling correction to lower/upper case changes. Other potential corrections are not performed.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"checkspelling\">CheckSpelling Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables the spelling module</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CheckSpelling on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CheckSpelling Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>Options</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_speling</td>\n</tr> </table> <p>This directive enables or disables the spelling module. When enabled, keep in mind that</p> <ul> <li>the directory scan which is necessary for the spelling correction will have an impact on the server's performance when many spelling corrections have to be performed at the same time.</li> <li>the document trees should not contain sensitive files which could be matched inadvertently by a spelling \"correction\".</li> <li>the module is unable to correct misspelled user names (as in <code>http://my.host/~apahce/</code>), just file names or directory names.</li> <li>spelling corrections apply strictly to existing files, so a request for the <code>&lt;Location \"/status\"&gt;</code> may get incorrectly treated as the negotiated file \"<code>/stats.html</code>\".</li> </ul> <p>mod_speling should not be enabled in <a href=\"mod_dav\">DAV</a> enabled directories, because it will try to \"spell fix\" newly created resource names against existing filenames, e.g., when trying to upload a new document <code>doc43.html</code> it might redirect to an existing document <code>doc34.html</code>, which is not what was intended. </p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_speling.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_speling.html</a>\n  </p>\n</div>\n","mod/mod_substitute":"<h1>Apache Module mod_substitute</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Perform search and replace operations on response bodies</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>substitute_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_substitute.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache HTTP Server 2.2.7 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_substitute\">mod_substitute</a></code> provides a mechanism to perform both regular expression and fixed string substitutions on response bodies.</p>    <div class=\"directive-section\">\n<h2 id=\"substitute\">Substitute Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Pattern to filter the response content</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>Substitute s/pattern/substitution/[infq]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_substitute</td>\n</tr> </table> <p>The <code class=\"directive\">Substitute</code> directive specifies a search and replace pattern to apply to the response body.</p> <p>The meaning of the pattern can be modified by using any combination of these flags:</p> <dl> <dt><code>i</code></dt> <dd>Perform a case-insensitive match.</dd> <dt><code>n</code></dt> <dd>By default the pattern is treated as a regular expression. Using the <code>n</code> flag forces the pattern to be treated as a fixed string.</dd> <dt><code>f</code></dt> <dd>The <code>f</code> flag causes <code>mod_substitute</code> to flatten the result of a substitution allowing for later substitutions to take place on the boundary of this one. This is the default.</dd> <dt><code>q</code></dt> <dd>The <code>q</code> flag causes <code>mod_substitute</code> to not flatten the buckets after each substitution. This can result in much faster response and a decrease in memory utilization, but should only be used if there is no possibility that the result of one substitution will ever match a pattern or regex of a subsequent one.</dd> </dl> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\n    AddOutputFilterByType SUBSTITUTE text/html\n    Substitute \"s/foo/bar/ni\"\n&lt;/Location&gt;</pre> </div> <p>If either the pattern or the substitution contain a slash character then an alternative delimiter should be used:</p> <div class=\"example\">\n<h3>Example of using an alternate delimiter</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\n    AddOutputFilterByType SUBSTITUTE text/html\n    Substitute \"s|&lt;BR */?&gt;|&lt;br /&gt;|i\"\n&lt;/Location&gt;</pre> </div> <p>Backreferences can be used in the comparison and in the substitution, when regular expressions are used, as illustrated in the following example: </p> <div class=\"example\">\n<h3>Example of using backreferences and captures</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\n    AddOutputFilterByType SUBSTITUTE text/html\n    # \"foo=k,bar=k\" -&gt; \"foo/bar=k\"\n    Substitute \"s|foo=(\\w+),bar=\\1|foo/bar=$1\"\n&lt;/Location&gt;</pre> </div> <p>A common use scenario for <code>mod_substitute</code> is the situation in which a front-end server proxies requests to a back-end server which returns HTML with hard-coded embedded URLs that refer to the back-end server. These URLs don't work for the end-user, since the back-end server is unreachable.</p> <p>In this case, <code>mod_substitute</code> can be used to rewrite those URLs into something that will work from the front end:</p> <div class=\"example\">\n<h3>Rewriting URLs embedded in proxied content</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass        \"/blog/\" \"http://internal.blog.example.com\"\nProxyPassReverse \"/blog/\" \"http://internal.blog.example.com/\"\n\nSubstitute \"s|http://internal.blog.example.com/|http://www.example.com/blog/|i\"</pre> </div> <p><code class=\"directive\"><a href=\"mod_proxy#proxypassreverse\">ProxyPassReverse</a></code> modifies any <code>Location</code> (redirect) headers that are sent by the back-end server, and, in this example, <code class=\"directive\">Substitute</code> takes care of the rest of the problem by fixing up the HTML response as well.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"substituteinheritbefore\">SubstituteInheritBefore Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Change the merge order of inherited patterns</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SubstituteInheritBefore on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SubstituteInheritBefore off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_substitute</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.17 and later</td>\n</tr> </table> <p>Whether to apply the inherited <code class=\"directive\"><a href=\"#substitute\">Substitute</a></code> patterns first (<code>on</code>), or after the ones of the current context (<code>off</code>). <code class=\"directive\">SubstituteInheritBefore</code> is itself inherited, hence contexts that inherit it (those that don't specify their own <code class=\"directive\">SubstituteInheritBefore</code> value) will apply the closest defined merge order.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"substitutemaxlinelength\">SubstituteMaxLineLength Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set the maximum line size</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SubstituteMaxLineLength bytes(b|B|k|K|m|M|g|G)</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>SubstituteMaxLineLength 1m</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_substitute</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.4.11 and later</td>\n</tr> </table> <p>The maximum line size handled by <code class=\"module\"><a href=\"mod_substitute\">mod_substitute</a></code> is limited to restrict memory use. The limit can be configured using <code class=\"directive\">SubstituteMaxLineLength</code>. The value can be given as the number of bytes and can be suffixed with a single letter <code>b</code>, <code>B</code>, <code>k</code>, <code>K</code>, <code>m</code>, <code>M</code>, <code>g</code>, <code>G</code> to provide the size in bytes, kilobytes, megabytes or gigabytes respectively.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;Location \"/\"&gt;\n    AddOutputFilterByType SUBSTITUTE text/html\n    SubstituteMaxLineLength 10m\n    Substitute \"s/foo/bar/ni\"\n&lt;/Location&gt;</pre> </div> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_substitute.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_substitute.html</a>\n  </p>\n</div>\n","mod/mod_suexec":"<h1>Apache Module mod_suexec</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Allows CGI scripts to run as a specified user and Group</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>suexec_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_suexec.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module, in combination with the <code class=\"program\"><a href=\"../programs/suexec\">suexec</a></code> support program allows CGI scripts to run as a specified user and Group.</p>    <div class=\"directive-section\">\n<h2 id=\"suexecusergroup\">SuexecUserGroup Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>User and group for CGI programs to run as</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>SuexecUserGroup User Group</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_suexec</td>\n</tr> </table> <p>The <code class=\"directive\">SuexecUserGroup</code> directive allows you to specify a user and group for CGI programs to run as. Non-CGI requests are still processed with the user specified in the <code class=\"directive\"><a href=\"mod_unixd#user\">User</a></code> directive.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">SuexecUserGroup nobody nogroup</pre> </div> <p>Startup will fail if this directive is specified but the suEXEC feature is disabled.</p> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"mod_unixd#suexec\">Suexec</a></code></li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_suexec.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_suexec.html</a>\n  </p>\n</div>\n","mod/mod_unique_id":"<h1>Apache Module mod_unique_id</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides an environment variable with a unique identifier for each request</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>unique_id_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_unique_id.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides a magic token for each request which is guaranteed to be unique across \"all\" requests under very specific conditions. The unique identifier is even unique across multiple machines in a properly configured cluster of machines. The environment variable <code>UNIQUE_ID</code> is set to the identifier for each request. Unique identifiers are useful for various reasons which are beyond the scope of this document.</p>     <h2 id=\"theory\">Theory</h2> <p>First a brief recap of how the Apache server works on Unix machines. This feature currently isn't supported on Windows NT. On Unix machines, Apache creates several children, the children process requests one at a time. Each child can serve multiple requests in its lifetime. For the purpose of this discussion, the children don't share any data with each other. We'll refer to the children as <dfn>httpd processes</dfn>.</p> <p>Your website has one or more machines under your administrative control, together we'll call them a cluster of machines. Each machine can possibly run multiple instances of Apache. All of these collectively are considered \"the universe\", and with certain assumptions we'll show that in this universe we can generate unique identifiers for each request, without extensive communication between machines in the cluster.</p> <p>The machines in your cluster should satisfy these requirements. (Even if you have only one machine you should synchronize its clock with NTP.)</p> <ul> <li>The machines' times are synchronized via NTP or other network time protocol.</li> <li>The machines' hostnames all differ, such that the module can do a hostname lookup on the hostname and receive a different IP address for each machine in the cluster.</li> </ul> <p>As far as operating system assumptions go, we assume that pids (process ids) fit in 32-bits. If the operating system uses more than 32-bits for a pid, the fix is trivial but must be performed in the code.</p> <p>Given those assumptions, at a single point in time we can identify any httpd process on any machine in the cluster from all other httpd processes. The machine's IP address and the pid of the httpd process are sufficient to do this. A httpd process can handle multiple requests simultaneously if you use a multi-threaded MPM. In order to identify threads, we use a thread index Apache httpd uses internally. So in order to generate unique identifiers for requests we need only distinguish between different points in time.</p> <p>To distinguish time we will use a Unix timestamp (seconds since January 1, 1970 UTC), and a 16-bit counter. The timestamp has only one second granularity, so the counter is used to represent up to 65536 values during a single second. The quadruple <em>( ip_addr, pid, time_stamp, counter )</em> is sufficient to enumerate 65536 requests per second per httpd process. There are issues however with pid reuse over time, and the counter is used to alleviate this issue.</p> <p>When an httpd child is created, the counter is initialized with ( current microseconds divided by 10 ) modulo 65536 (this formula was chosen to eliminate some variance problems with the low order bits of the microsecond timers on some systems). When a unique identifier is generated, the time stamp used is the time the request arrived at the web server. The counter is incremented every time an identifier is generated (and allowed to roll over).</p> <p>The kernel generates a pid for each process as it forks the process, and pids are allowed to roll over (they're 16-bits on many Unixes, but newer systems have expanded to 32-bits). So over time the same pid will be reused. However unless it is reused within the same second, it does not destroy the uniqueness of our quadruple. That is, we assume the system does not spawn 65536 processes in a one second interval (it may even be 32768 processes on some Unixes, but even this isn't likely to happen).</p> <p>Suppose that time repeats itself for some reason. That is, suppose that the system's clock is screwed up and it revisits a past time (or it is too far forward, is reset correctly, and then revisits the future time). In this case we can easily show that we can get pid and time stamp reuse. The choice of initializer for the counter is intended to help defeat this. Note that we really want a random number to initialize the counter, but there aren't any readily available numbers on most systems (<em>i.e.</em>, you can't use rand() because you need to seed the generator, and can't seed it with the time because time, at least at one second resolution, has repeated itself). This is not a perfect defense.</p> <p>How good a defense is it? Suppose that one of your machines serves at most 500 requests per second (which is a very reasonable upper bound at this writing, because systems generally do more than just shovel out static files). To do that it will require a number of children which depends on how many concurrent clients you have. But we'll be pessimistic and suppose that a single child is able to serve 500 requests per second. There are 1000 possible starting counter values such that two sequences of 500 requests overlap. So there is a 1.5% chance that if time (at one second resolution) repeats itself this child will repeat a counter value, and uniqueness will be broken. This was a very pessimistic example, and with real world values it's even less likely to occur. If your system is such that it's still likely to occur, then perhaps you should make the counter 32 bits (by editing the code).</p> <p>You may be concerned about the clock being \"set back\" during summer daylight savings. However this isn't an issue because the times used here are UTC, which \"always\" go forward. Note that x86 based Unixes may need proper configuration for this to be true -- they should be configured to assume that the motherboard clock is on UTC and compensate appropriately. But even still, if you're running NTP then your UTC time will be correct very shortly after reboot.</p> <p>The <code>UNIQUE_ID</code> environment variable is constructed by encoding the 144-bit (32-bit IP address, 32 bit pid, 32 bit time stamp, 16 bit counter, 32 bit thread index) quadruple using the alphabet <code>[A-Za-z0-9@-]</code> in a manner similar to MIME base64 encoding, producing 24 characters. The MIME base64 alphabet is actually <code>[A-Za-z0-9+/]</code> however <code>+</code> and <code>/</code> need to be specially encoded in URLs, which makes them less desirable. All values are encoded in network byte ordering so that the encoding is comparable across architectures of different byte ordering. The actual ordering of the encoding is: time stamp, IP address, pid, counter. This ordering has a purpose, but it should be emphasized that applications should not dissect the encoding. Applications should treat the entire encoded <code>UNIQUE_ID</code> as an opaque token, which can be compared against other <code>UNIQUE_ID</code>s for equality only.</p> <p>The ordering was chosen such that it's possible to change the encoding in the future without worrying about collision with an existing database of <code>UNIQUE_ID</code>s. The new encodings should also keep the time stamp as the first element, and can otherwise use the same alphabet and bit length. Since the time stamps are essentially an increasing sequence, it's sufficient to have a <em>flag second</em> in which all machines in the cluster stop serving any request, and stop using the old encoding format. Afterwards they can resume requests and begin issuing the new encodings.</p> <p>This we believe is a relatively portable solution to this problem. The identifiers generated have essentially an infinite life-time because future identifiers can be made longer as required. Essentially no communication is required between machines in the cluster (only NTP synchronization is required, which is low overhead), and no communication between httpd processes is required (the communication is implicit in the pid value assigned by the kernel). In very specific situations the identifier can be shortened, but more information needs to be assumed (for example the 32-bit IP address is overkill for any site, but there is no portable shorter replacement for it). </p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_unique_id.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_unique_id.html</a>\n  </p>\n</div>\n","mod/mod_usertrack":"<h1>Apache Module mod_usertrack</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td> <em>Clickstream</em> logging of user activity on a site </td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>usertrack_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_usertrack.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>Provides tracking of a user through your website via browser cookies.</p>     <h2 id=\"logging\">Logging</h2> <p><code class=\"module\"><a href=\"mod_usertrack\">mod_usertrack</a></code> sets a cookie which can be logged via <code class=\"module\"><a href=\"mod_log_config\">mod_log_config</a></code> configurable logging formats:</p> <pre class=\"prettyprint lang-config\">LogFormat \"%{Apache}n %r %t\" usertrack\nCustomLog logs/clickstream.log usertrack</pre>   <div class=\"directive-section\">\n<h2 id=\"cookiedomain\">CookieDomain Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>The domain to which the tracking cookie applies</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CookieDomain domain</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_usertrack</td>\n</tr> </table> <p>This directive controls the setting of the domain to which the tracking cookie applies. If not present, no domain is included in the cookie header field.</p> <p>The domain string <strong>must</strong> begin with a dot, and <strong>must</strong> include at least one embedded dot. That is, <code>.example.com</code> is legal, but <code>www.example.com</code> and <code>.com</code> are not.</p> <div class=\"note\">Most browsers in use today will not allow cookies to be set for a two-part top level domain, such as <code>.co.uk</code>, although such a domain ostensibly fulfills the requirements above.<br> These domains are equivalent to top level domains such as <code>.com</code>, and allowing such cookies may be a security risk. Thus, if you are under a two-part top level domain, you should still use your actual domain, as you would with any other top level domain (for example <code>.example.co.uk</code>). </div> <pre class=\"prettyprint lang-config\">CookieDomain .example.com</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cookieexpires\">CookieExpires Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Expiry time for the tracking cookie</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CookieExpires expiry-period</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_usertrack</td>\n</tr> </table> <p>When used, this directive sets an expiry time on the cookie generated by the usertrack module. The <em>expiry-period</em> can be given either as a number of seconds, or in the format such as \"2 weeks 3 days 7 hours\". Valid denominations are: years, months, weeks, days, hours, minutes and seconds. If the expiry time is in any format other than one number indicating the number of seconds, it must be enclosed by double quotes.</p> <p>If this directive is not used, cookies last only for the current browser session.</p> <pre class=\"prettyprint lang-config\">CookieExpires \"3 weeks\"</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cookiename\">CookieName Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Name of the tracking cookie</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CookieName token</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CookieName Apache</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_usertrack</td>\n</tr> </table> <p>This directive allows you to change the name of the cookie this module uses for its tracking purposes. By default the cookie is named \"<code>Apache</code>\".</p> <p>You must specify a valid cookie name; results are unpredictable if you use a name containing unusual characters. Valid characters include A-Z, a-z, 0-9, \"_\", and \"-\".</p> <pre class=\"prettyprint lang-config\">CookieName clicktrack</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cookiestyle\">CookieStyle Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Format of the cookie header field</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CookieStyle Netscape|Cookie|Cookie2|RFC2109|RFC2965</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CookieStyle Netscape</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_usertrack</td>\n</tr> </table> <p>This directive controls the format of the cookie header field. The three formats allowed are:</p> <ul> <li>\n<strong>Netscape</strong>, which is the original but now deprecated syntax. This is the default, and the syntax Apache has historically used.</li> <li>\n<strong>Cookie</strong> or <strong>RFC2109</strong>, which is the syntax that superseded the Netscape syntax.</li> <li>\n<strong>Cookie2</strong> or <strong>RFC2965</strong>, which is the most current cookie syntax.</li> </ul> <p>Not all clients can understand all of these formats, but you should use the newest one that is generally acceptable to your users' browsers. At the time of writing, most browsers support all three of these formats, with <code>Cookie2</code> being the preferred format.</p> <pre class=\"prettyprint lang-config\">CookieStyle Cookie2</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"cookietracking\">CookieTracking Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables tracking cookie</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>CookieTracking on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>CookieTracking off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_usertrack</td>\n</tr> </table> <p>When <code class=\"module\"><a href=\"mod_usertrack\">mod_usertrack</a></code> is loaded, and <code>CookieTracking on</code> is set, Apache will send a user-tracking cookie for all new requests. This directive can be used to turn this behavior on or off on a per-server or per-directory basis. By default, enabling <code class=\"module\"><a href=\"mod_usertrack\">mod_usertrack</a></code> will <strong>not</strong> activate cookies. </p> <pre class=\"prettyprint lang-config\">CookieTracking on</pre> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_usertrack.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_usertrack.html</a>\n  </p>\n</div>\n","mod/mod_proxy":"<h1>Apache Module mod_proxy</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Multi-protocol proxy/gateway server</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>proxy_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_proxy.c</td>\n</tr>\n</table> <h3>Summary</h3> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying with <code class=\"directive\"><a href=\"#proxyrequests\">ProxyRequests</a></code> until you have <a href=\"#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div> <p><code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> and related modules implement a proxy/gateway for Apache HTTP Server, supporting a number of popular protocols as well as several different load balancing algorithms. Third-party modules can add support for additional protocols and load balancing algorithms.</p> <p>A set of modules must be loaded into the server to provide the necessary features. These modules can be included statically at build time or dynamically via the <code class=\"directive\"><a href=\"mod_so#loadmodule\">LoadModule</a></code> directive). The set must include:</p> <ul> <li>\n<code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code>, which provides basic proxy capabilities</li> <li>\n<code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> and one or more balancer modules if load balancing is required. (See <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> for more information.)</li> <li>one or more proxy scheme, or protocol, modules: <table class=\"bordered\"> <tr>\n<th>Protocol</th>\n<th>Module</th>\n</tr> <tr>\n<td>AJP13 (Apache JServe Protocol version 1.3)</td>\n<td><code class=\"module\">mod_proxy_ajp</code></td>\n</tr> <tr>\n<td>CONNECT (for SSL)</td>\n<td><code class=\"module\">mod_proxy_connect</code></td>\n</tr> <tr>\n<td>FastCGI</td>\n<td><code class=\"module\">mod_proxy_fcgi</code></td>\n</tr> <tr>\n<td>ftp</td>\n<td><code class=\"module\">mod_proxy_ftp</code></td>\n</tr> <tr>\n<td>HTTP/0.9, HTTP/1.0, and HTTP/1.1</td>\n<td><code class=\"module\">mod_proxy_http</code></td>\n</tr> <tr>\n<td>SCGI</td>\n<td><code class=\"module\">mod_proxy_scgi</code></td>\n</tr> <tr>\n<td>WS and WSS (Web-sockets)</td>\n<td><code class=\"module\">mod_proxy_wstunnel</code></td>\n</tr> </table> </li> </ul> <p>In addition, extended features are provided by other modules. Caching is provided by <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code> and related modules. The ability to contact remote servers using the SSL/TLS protocol is provided by the <code>SSLProxy*</code> directives of <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code>. These additional modules will need to be loaded and configured to take advantage of these features.</p>     <h2 id=\"forwardreverse\">Forward Proxies and Reverse Proxies/Gateways</h2> <p>Apache HTTP Server can be configured in both a <dfn>forward</dfn> and <dfn>reverse</dfn> proxy (also known as <dfn>gateway</dfn>) mode.</p> <p>An ordinary <dfn>forward proxy</dfn> is an intermediate server that sits between the client and the <em>origin server</em>. In order to get content from the origin server, the client sends a request to the proxy naming the origin server as the target. The proxy then requests the content from the origin server and returns it to the client. The client must be specially configured to use the forward proxy to access other sites.</p> <p>A typical usage of a forward proxy is to provide Internet access to internal clients that are otherwise restricted by a firewall. The forward proxy can also use caching (as provided by <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code>) to reduce network usage.</p> <p>The forward proxy is activated using the <code class=\"directive\"><a href=\"#proxyrequests\">ProxyRequests</a></code> directive. Because forward proxies allow clients to access arbitrary sites through your server and to hide their true origin, it is essential that you <a href=\"#access\">secure your server</a> so that only authorized clients can access the proxy before activating a forward proxy.</p> <p>A <dfn>reverse proxy</dfn> (or <dfn>gateway</dfn>), by contrast, appears to the client just like an ordinary web server. No special configuration on the client is necessary. The client makes ordinary requests for content in the namespace of the reverse proxy. The reverse proxy then decides where to send those requests and returns the content as if it were itself the origin.</p> <p>A typical usage of a reverse proxy is to provide Internet users access to a server that is behind a firewall. Reverse proxies can also be used to balance load among several back-end servers or to provide caching for a slower back-end server. In addition, reverse proxies can be used simply to bring several servers into the same URL space.</p> <p>A reverse proxy is activated using the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive or the <code>[P]</code> flag to the <code class=\"directive\"><a href=\"mod_rewrite#rewriterule\">RewriteRule</a></code> directive. It is <strong>not</strong> necessary to turn <code class=\"directive\"><a href=\"#proxyrequests\">ProxyRequests</a></code> on in order to configure a reverse proxy.</p>   <h2 id=\"examples\">Basic Examples</h2> <p>The examples below are only a very basic idea to help you get started. Please read the documentation on the individual directives.</p> <p>In addition, if you wish to have caching enabled, consult the documentation from <code class=\"module\"><a href=\"mod_cache\">mod_cache</a></code>.</p> <div class=\"example\">\n<h3>Reverse Proxy</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/foo\" \"http://foo.example.com/bar\"\nProxyPassReverse \"/foo\" \"http://foo.example.com/bar\"</pre> </div> <div class=\"example\">\n<h3>Forward Proxy</h3>\n<pre class=\"prettyprint lang-config\">ProxyRequests On\nProxyVia On\n\n&lt;Proxy \"*\"&gt;\n  Require host internal.example.com\n&lt;/Proxy&gt;</pre> </div>   <h2 id=\"handler\">Access via Handler</h2> <p>You can also force a request to be handled as a reverse-proxy request, by creating a suitable Handler pass-through. The example configuration below will pass all requests for PHP scripts to the specified FastCGI server using reverse proxy: </p> <div class=\"example\">\n<h3>Reverse Proxy PHP scripts</h3>\n<pre class=\"prettyprint lang-config\">&lt;FilesMatch \"\\.php$\"&gt;\n    # Unix sockets require 2.4.7 or later\n    SetHandler  \"proxy:unix:/path/to/app.sock|fcgi://localhost/\"\n&lt;/FilesMatch&gt;</pre> </div> <p>This feature is available in Apache HTTP Server 2.4.10 and later.</p>   <h2 id=\"workers\">Workers</h2> <p>The proxy manages the configuration of origin servers and their communication parameters in objects called <dfn>workers</dfn>. There are two built-in workers: the default forward proxy worker and the default reverse proxy worker. Additional workers can be configured explicitly.</p> <p>The two default workers have a fixed configuration and will be used if no other worker matches the request. They do not use HTTP Keep-Alive or connection pooling. The TCP connections to the origin server will instead be opened and closed for each request.</p> <p>Explicitly configured workers are identified by their URL. They are usually created and configured using <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> or <code class=\"directive\"><a href=\"#proxypassmatch\">ProxyPassMatch</a></code> when used for a reverse proxy:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/example\" \"http://backend.example.com\" connectiontimeout=5 timeout=30</pre> <p>This will create a worker associated with the origin server URL <code>http://backend.example.com</code> that will use the given timeout values. When used in a forward proxy, workers are usually defined via the <code class=\"directive\"><a href=\"#proxyset\">ProxySet</a></code> directive:</p> <pre class=\"prettyprint lang-config\">ProxySet \"http://backend.example.com\" connectiontimeout=5 timeout=30</pre> <p>or alternatively using <code class=\"directive\"><a href=\"#proxy\">Proxy</a></code> and <code class=\"directive\"><a href=\"#proxyset\">ProxySet</a></code>:</p> <pre class=\"prettyprint lang-config\">&lt;Proxy \"http://backend.example.com\"&gt;\n  ProxySet connectiontimeout=5 timeout=30\n&lt;/Proxy&gt;</pre> <p>Using explicitly configured workers in the forward mode is not very common, because forward proxies usually communicate with many different origin servers. Creating explicit workers for some of the origin servers can still be useful if they are used very often. Explicitly configured workers have no concept of forward or reverse proxying by themselves. They encapsulate a common concept of communication with origin servers. A worker created by <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> for use in a reverse proxy will also be used for forward proxy requests whenever the URL to the origin server matches the worker URL, and vice versa.</p> <p>The URL identifying a direct worker is the URL of its origin server including any path components given:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/examples\" \"http://backend.example.com/examples\"\nProxyPass \"/docs\" \"http://backend.example.com/docs\"</pre> <p>This example defines two different workers, each using a separate connection pool and configuration.</p> <div class=\"warning\">\n<p><strong>Worker Sharing</strong></p> <p>Worker sharing happens if the worker URLs overlap, which occurs when the URL of some worker is a leading substring of the URL of another worker defined later in the configuration file. In the following example</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/apps\" \"http://backend.example.com/\" timeout=60\nProxyPass \"/examples\" \"http://backend.example.com/examples\" timeout=10</pre> <p>the second worker isn't actually created. Instead the first worker is used. The benefit is, that there is only one connection pool, so connections are more often reused. Note that all configuration attributes given explicitly for the later worker will be ignored. This will be logged as a warning. In the above example, the resulting timeout value for the URL <code>/examples</code> will be <code>60</code> instead of <code>10</code>!</p> <p>If you want to avoid worker sharing, sort your worker definitions by URL length, starting with the longest worker URLs. If you want to maximize worker sharing, use the reverse sort order. See also the related warning about ordering <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directives.</p> </div> <p>Explicitly configured workers come in two flavors: <dfn>direct workers</dfn> and <dfn>(load) balancer workers</dfn>. They support many important configuration attributes which are described below in the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive. The same attributes can also be set using <code class=\"directive\"><a href=\"#proxyset\">ProxySet</a></code>.</p> <p>The set of options available for a direct worker depends on the protocol which is specified in the origin server URL. Available protocols include <code>ajp</code>, <code>fcgi</code>, <code>ftp</code>, <code>http</code> and <code>scgi</code>.</p> <p>Balancer workers are virtual workers that use direct workers known as their members to actually handle the requests. Each balancer can have multiple members. When it handles a request, it chooses a member based on the configured load balancing algorithm.</p> <p>A balancer worker is created if its worker URL uses <code>balancer</code> as the protocol scheme. The balancer URL uniquely identifies the balancer worker. Members are added to a balancer using <code class=\"directive\"><a href=\"#balancermember\">BalancerMember</a></code>.</p> <div class=\"note\">\n<p><strong>DNS resolution for origin domains</strong></p> <p>DNS resolution happens when the socket to the origin domain is created for the first time. When connection pooling is used, each backend domain is resolved only once per child process, and reused for all further connections until the child is recycled. This information should to be considered while planning DNS maintenance tasks involving backend domains. Please also check <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> parameters for more details about connection reuse. </p> </div>   <h2 id=\"access\">Controlling Access to Your Proxy</h2> <p>You can control who can access your proxy via the <code class=\"directive\"><a href=\"#proxy\">&lt;Proxy&gt;</a></code> control block as in the following example:</p> <pre class=\"prettyprint lang-config\">&lt;Proxy \"*\"&gt;\n  Require ip 192.168.0\n&lt;/Proxy&gt;</pre> <p>For more information on access control directives, see <code class=\"module\"><a href=\"mod_authz_host\">mod_authz_host</a></code>.</p> <p>Strictly limiting access is essential if you are using a forward proxy (using the <code class=\"directive\"><a href=\"#proxyrequests\">ProxyRequests</a></code> directive). Otherwise, your server can be used by any client to access arbitrary hosts while hiding his or her true identity. This is dangerous both for your network and for the Internet at large. When using a reverse proxy (using the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive with <code>ProxyRequests Off</code>), access control is less critical because clients can only contact the hosts that you have specifically configured.</p> <p><strong>See Also</strong> the <a href=\"mod_proxy_http#env\">Proxy-Chain-Auth</a> environment variable.</p>   <h2 id=\"startup\">Slow Startup</h2> <p>If you're using the <code class=\"directive\"><a href=\"#proxyblock\">ProxyBlock</a></code> directive, hostnames' IP addresses are looked up and cached during startup for later match test. This may take a few seconds (or more) depending on the speed with which the hostname lookups occur.</p>   <h2 id=\"intranet\">Intranet Proxy</h2> <p>An Apache httpd proxy server situated in an intranet needs to forward external requests through the company's firewall (for this, configure the <code class=\"directive\"><a href=\"#proxyremote\">ProxyRemote</a></code> directive to forward the respective <var>scheme</var> to the firewall proxy). However, when it has to access resources within the intranet, it can bypass the firewall when accessing hosts. The <code class=\"directive\"><a href=\"#noproxy\">NoProxy</a></code> directive is useful for specifying which hosts belong to the intranet and should be accessed directly.</p> <p>Users within an intranet tend to omit the local domain name from their WWW requests, thus requesting \"http://somehost/\" instead of <code>http://somehost.example.com/</code>. Some commercial proxy servers let them get away with this and simply serve the request, implying a configured local domain. When the <code class=\"directive\"><a href=\"#proxydomain\">ProxyDomain</a></code> directive is used and the server is <a href=\"#proxyrequests\">configured for proxy service</a>, Apache httpd can return a redirect response and send the client to the correct, fully qualified, server address. This is the preferred method since the user's bookmark files will then contain fully qualified hosts.</p>   <h2 id=\"envsettings\">Protocol Adjustments</h2> <p>For circumstances where <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> is sending requests to an origin server that doesn't properly implement keepalives or HTTP/1.1, there are two <a href=\"../env\">environment variables</a> that can force the request to use HTTP/1.0 with no keepalive. These are set via the <code class=\"directive\"><a href=\"mod_env#setenv\">SetEnv</a></code> directive.</p> <p>These are the <code>force-proxy-request-1.0</code> and <code>proxy-nokeepalive</code> notes.</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/buggyappserver/\"&gt;\n  ProxyPass \"http://buggyappserver:7001/foo/\"\n  SetEnv force-proxy-request-1.0 1\n  SetEnv proxy-nokeepalive 1\n&lt;/Location&gt;</pre>   <h2 id=\"request-bodies\">Request Bodies</h2> <p>Some request methods such as POST include a request body. The HTTP protocol requires that requests which include a body either use chunked transfer encoding or send a <code>Content-Length</code> request header. When passing these requests on to the origin server, <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> will always attempt to send the <code>Content-Length</code>. But if the body is large and the original request used chunked encoding, then chunked encoding may also be used in the upstream request. You can control this selection using <a href=\"../env\">environment variables</a>. Setting <code>proxy-sendcl</code> ensures maximum compatibility with upstream servers by always sending the <code>Content-Length</code>, while setting <code>proxy-sendchunked</code> minimizes resource usage by using chunked encoding.</p> <p>Under some circumstances, the server must spool request bodies to disk to satisfy the requested handling of request bodies. For example, this spooling will occur if the original body was sent with chunked encoding (and is large), but the administrator has asked for backend requests to be sent with Content-Length or as HTTP/1.0. This spooling can also occur if the request body already has a Content-Length header, but the server is configured to filter incoming request bodies.</p> <p><code class=\"directive\"><a href=\"core#limitrequestbody\">LimitRequestBody</a></code> only applies to request bodies that the server will spool to disk</p>   <h2 id=\"x-headers\">Reverse Proxy Request Headers</h2> <p>When acting in a reverse-proxy mode (using the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive, for example), <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> adds several request headers in order to pass information to the origin server. These headers are:</p> <dl> <dt><code>X-Forwarded-For</code></dt> <dd>The IP address of the client.</dd> <dt><code>X-Forwarded-Host</code></dt> <dd>The original host requested by the client in the <code>Host</code> HTTP request header.</dd> <dt><code>X-Forwarded-Server</code></dt> <dd>The hostname of the proxy server.</dd> </dl> <p>Be careful when using these headers on the origin server, since they will contain more than one (comma-separated) value if the original request already contained one of these headers. For example, you can use <code>%{X-Forwarded-For}i</code> in the log format string of the origin server to log the original clients IP address, but you may get more than one address if the request passes through several proxies.</p> <p>See also the <code class=\"directive\"><a href=\"#proxypreservehost\">ProxyPreserveHost</a></code> and <code class=\"directive\"><a href=\"#proxyvia\">ProxyVia</a></code> directives, which control other request headers.</p> <p>Note: If you need to specify custom request headers to be added to the forwarded request, use the <code class=\"directive\"><a href=\"mod_headers#requestheader\">RequestHeader</a></code> directive.</p>   <div class=\"directive-section\">\n<h2 id=\"balancergrowth\">BalancerGrowth Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Number of additional Balancers that can be added Post-configuration</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BalancerGrowth #</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>BalancerGrowth 5</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>BalancerGrowth is only available in Apache HTTP Server 2.3.13 and later.</td>\n</tr> </table> <p>This directive allows for growth potential in the number of Balancers available for a virtualhost in addition to the number pre-configured. It only takes effect if there is at least one pre-configured Balancer.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"balancerinherit\">BalancerInherit Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Inherit ProxyPassed Balancers/Workers from the main server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BalancerInherit On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>BalancerInherit On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>BalancerInherit is only available in Apache HTTP Server 2.4.5 and later.</td>\n</tr> </table> <p>This directive will cause the current server/vhost to \"inherit\" ProxyPass Balancers and Workers defined in the main server. This can cause issues and inconsistent behavior if using the Balancer Manager and so should be disabled if using that feature.</p> <p>The setting in the global server defines the default for all vhosts.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"balancermember\">BalancerMember Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Add a member to a load balancing group</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BalancerMember [balancerurl] url [key=value [key=value ...]]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>BalancerMember is only available in Apache HTTP Server 2.2 and later.</td>\n</tr> </table> <p>This directive adds a member to a load balancing group. It can be used within a <code>&lt;Proxy balancer://...&gt;</code> container directive and can take any of the key value pair parameters available to <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directives.</p> <p>One additional parameter is available only to <code class=\"directive\">BalancerMember</code> directives: <var>loadfactor</var>. This is the member load factor - a number between 1 (default) and 100, which defines the weighted load to be applied to the member in question.</p> <p>The <var>balancerurl</var> is only needed when not within a <code>&lt;Proxy balancer://...&gt;</code> container directive. It corresponds to the url of a balancer defined in <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive.</p> <p>The path component of the balancer URL in any <code>&lt;Proxy balancer://...&gt;</code> container directive is ignored.</p> <p>Trailing slashes should typically be removed from the URL of a <code class=\"directive\">BalancerMember</code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"balancerpersist\">BalancerPersist Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Attempt to persist changes made by the Balancer Manager across restarts.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>BalancerPersist On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>BalancerPersist Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>BalancerPersist is only available in Apache HTTP Server 2.4.4 and later.</td>\n</tr> </table> <p>This directive will cause the shared memory storage associated with the balancers and balancer members to be persisted across restarts. This allows these local changes to not be lost during the normal restart/graceful state transitions.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"noproxy\">NoProxy Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Hosts, domains, or networks that will be connected to directly</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>NoProxy host [host] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This directive is only useful for Apache httpd proxy servers within intranets. The <code class=\"directive\">NoProxy</code> directive specifies a list of subnets, IP addresses, hosts and/or domains, separated by spaces. A request to a host which matches one or more of these is always served directly, without forwarding to the configured <code class=\"directive\"><a href=\"#proxyremote\">ProxyRemote</a></code> proxy server(s).</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProxyRemote  \"*\"  \"http://firewall.example.com:81\"\nNoProxy         \".example.com\" \"192.168.112.0/21\"</pre> </div> <p>The <var>host</var> arguments to the <code class=\"directive\">NoProxy</code> directive are one of the following type list:</p> <dl> <dt><var><a name=\"domain\" id=\"domain\">Domain</a></var></dt> <dd> <p>A <dfn>Domain</dfn> is a partially qualified DNS domain name, preceded by a period. It represents a list of hosts which logically belong to the same DNS domain or zone (<em>i.e.</em>, the suffixes of the hostnames are all ending in <var>Domain</var>).</p> <div class=\"example\">\n<h3>Examples</h3>\n<pre>.com .example.org.</pre>\n</div> <p>To distinguish <var>Domain</var>s from <var><a href=\"#hostname\">Hostname</a></var>s (both syntactically and semantically; a DNS domain can have a DNS A record, too!), <var>Domain</var>s are always written with a leading period.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Domain name comparisons are done without regard to the case, and <var>Domain</var>s are always assumed to be anchored in the root of the DNS tree; therefore, the two domains <code>.ExAmple.com</code> and <code>.example.com.</code> (note the trailing period) are considered equal. Since a domain comparison does not involve a DNS lookup, it is much more efficient than subnet comparison.</p> </div>\n</dd> <dt><var><a name=\"subnet\" id=\"subnet\">SubNet</a></var></dt> <dd> <p>A <dfn>SubNet</dfn> is a partially qualified internet address in numeric (dotted quad) form, optionally followed by a slash and the netmask, specified as the number of significant bits in the <var>SubNet</var>. It is used to represent a subnet of hosts which can be reached over a common network interface. In the absence of the explicit net mask it is assumed that omitted (or zero valued) trailing digits specify the mask. (In this case, the netmask can only be multiples of 8 bits wide.) Examples:</p> <dl> <dt>\n<code>192.168</code> or <code>192.168.0.0</code>\n</dt> <dd>the subnet 192.168.0.0 with an implied netmask of 16 valid bits (sometimes used in the netmask form <code>255.255.0.0</code>)</dd> <dt><code>192.168.112.0/21</code></dt> <dd>the subnet <code>192.168.112.0/21</code> with a netmask of 21 valid bits (also used in the form <code>255.255.248.0</code>)</dd> </dl> <p>As a degenerate case, a <em>SubNet</em> with 32 valid bits is the equivalent to an <var><a href=\"#ipaddr\">IPAddr</a></var>, while a <var>SubNet</var> with zero valid bits (<em>e.g.</em>, 0.0.0.0/0) is the same as the constant <var>_Default_</var>, matching any IP address.</p>\n</dd> <dt><var><a name=\"ipaddr\" id=\"ipaddr\">IPAddr</a></var></dt> <dd> <p>A <dfn>IPAddr</dfn> represents a fully qualified internet address in numeric (dotted quad) form. Usually, this address represents a host, but there need not necessarily be a DNS domain name connected with the address.</p> <div class=\"example\">\n<h3>Example</h3>\n<code>192.168.123.7</code>\n</div> <div class=\"note\">\n<p><strong>Note</strong></p> <p>An <var>IPAddr</var> does not need to be resolved by the DNS system, so it can result in more effective apache performance.</p> </div>\n</dd> <dt><var><a name=\"hostname\" id=\"hostname\">Hostname</a></var></dt> <dd> <p>A <dfn>Hostname</dfn> is a fully qualified DNS domain name which can be resolved to one or more <var><a href=\"#ipaddr\">IPAddrs</a></var> via the DNS domain name service. It represents a logical host (in contrast to <var><a href=\"#domain\">Domain</a></var>s, see above) and must be resolvable to at least one <var><a href=\"#ipaddr\">IPAddr</a></var> (or often to a list of hosts with different <var><a href=\"#ipaddr\">IPAddr</a></var>s).</p> <div class=\"example\">\n<h3>Examples</h3>\n<pre>prep.ai.example.edu\nwww.example.org</pre>\n</div> <div class=\"note\">\n<p><strong>Note</strong></p> <p>In many situations, it is more effective to specify an <var><a href=\"#ipaddr\">IPAddr</a></var> in place of a <var>Hostname</var> since a DNS lookup can be avoided. Name resolution in Apache httpd can take a remarkable deal of time when the connection to the name server uses a slow PPP link.</p> <p><var>Hostname</var> comparisons are done without regard to the case, and <var>Hostname</var>s are always assumed to be anchored in the root of the DNS tree; therefore, the two hosts <code>WWW.ExAmple.com</code> and <code>www.example.com.</code> (note the trailing period) are considered equal.</p> </div>\n</dd> </dl> <h3>See also</h3> <ul> <li><a href=\"../dns-caveats\">DNS Issues</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"proxy\">&lt;Proxy&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Container for directives applied to proxied resources</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;Proxy wildcard-url&gt; ...&lt;/Proxy&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>Directives placed in <code class=\"directive\">&lt;Proxy&gt;</code> sections apply only to matching proxied content. Shell-style wildcards are allowed.</p> <p>For example, the following will allow only hosts in <code>yournetwork.example.com</code> to access content via your proxy server:</p> <pre class=\"prettyprint lang-config\">&lt;Proxy \"*\"&gt;\n  Require host yournetwork.example.com\n&lt;/Proxy&gt;</pre> <p>The following example will process all files in the <code>foo</code> directory of <code>example.com</code> through the <code>INCLUDES</code> filter when they are sent through the proxy server:</p> <pre class=\"prettyprint lang-config\">&lt;Proxy \"http://example.com/foo/*\"&gt;\n  SetOutputFilter INCLUDES\n&lt;/Proxy&gt;</pre> <div class=\"note\">\n<p><strong>Differences from the Location configuration section</strong></p> <p>A backend URL matches the configuration section if it begins with the the <var>wildcard-url</var> string, even if the last path segment in the directive only matches a prefix of the backend URL. For example, &lt;Proxy \"http://example.com/foo\"&gt; matches all of http://example.com/foo, http://example.com/foo/bar, and http://example.com/foobar. The matching of the final URL differs from the behavior of the <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> section, which for purposes of this note treats the final path component as if it ended in a slash.</p> <p>For more control over the matching, see <code class=\"directive\">&lt;ProxyMatch&gt;</code>.</p> </div> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#proxymatch\">&lt;ProxyMatch&gt;</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyaddheaders\">ProxyAddHeaders Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Add proxy information in X-Forwarded-* headers</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyAddHeaders Off|On</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyAddHeaders On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.10 and later</td>\n</tr> </table> <p>This directive determines whether or not proxy related information should be passed to the backend server through X-Forwarded-For, X-Forwarded-Host and X-Forwarded-Server HTTP headers.</p> <div class=\"note\">\n<p><strong>Effectiveness</strong></p> <p>This option is of use only for HTTP proxying, as handled by <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code>.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxybadheader\">ProxyBadHeader Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determines how to handle bad header lines in a response</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyBadHeader IsError|Ignore|StartBody</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyBadHeader IsError</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyBadHeader</code> directive determines the behavior of <code class=\"module\"><a href=\"mod_proxy\">mod_proxy</a></code> if it receives syntactically invalid response header lines (<em>i.e.</em> containing no colon) from the origin server. The following arguments are possible:</p> <dl> <dt><code>IsError</code></dt> <dd>Abort the request and end up with a 502 (Bad Gateway) response. This is the default behavior.</dd> <dt><code>Ignore</code></dt> <dd>Treat bad header lines as if they weren't sent.</dd> <dt><code>StartBody</code></dt> <dd>When receiving the first bad header line, finish reading the headers and treat the remainder as body. This helps to work around buggy backend servers which forget to insert an empty line between the headers and the body.</dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyblock\">ProxyBlock Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Words, hosts, or domains that are banned from being proxied</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyBlock *|word|host|domain [word|host|domain] ...</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyBlock</code> directive specifies a list of words, hosts and/or domains, separated by spaces. HTTP, HTTPS, and FTP document requests to sites whose names contain matched words, hosts or domains are <em>blocked</em> by the proxy server. The proxy module will also attempt to determine IP addresses of list items which may be hostnames during startup, and cache them for match test as well. That may slow down the startup time of the server.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProxyBlock \"news.example.com\" \"auctions.example.com\" \"friends.example.com\"</pre> </div> <p>Note that <code>example</code> would also be sufficient to match any of these sites.</p> <p>Hosts would also be matched if referenced by IP address.</p> <p>Note also that</p> <pre class=\"prettyprint lang-config\">ProxyBlock \"*\"</pre> <p>blocks connections to all sites.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxydomain\">ProxyDomain Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Default domain name for proxied requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyDomain Domain</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This directive is only useful for Apache httpd proxy servers within intranets. The <code class=\"directive\">ProxyDomain</code> directive specifies the default domain which the apache proxy server will belong to. If a request to a host without a domain name is encountered, a redirection response to the same host with the configured <var>Domain</var> appended will be generated.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProxyRemote  \"*\"  \"http://firewall.example.com:81\"\nNoProxy         \".example.com\" \"192.168.112.0/21\"\nProxyDomain     \".example.com\"</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyerroroverride\">ProxyErrorOverride Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Override error pages for proxied content</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyErrorOverride On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyErrorOverride Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This directive is useful for reverse-proxy setups where you want to have a common look and feel on the error pages seen by the end user. This also allows for included files (via <code class=\"module\"><a href=\"mod_include\">mod_include</a></code>'s SSI) to get the error code and act accordingly. (Default behavior would display the error page of the proxied server. Turning this on shows the SSI Error message.)</p> <p>This directive does not affect the processing of informational (1xx), normal success (2xx), or redirect (3xx) responses.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyiobuffersize\">ProxyIOBufferSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Determine size of internal data throughput buffer</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyIOBufferSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyIOBufferSize 8192</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyIOBufferSize</code> directive adjusts the size of the internal buffer which is used as a scratchpad for the data between input and output. The size must be at least <code>512</code>.</p> <p>In almost every case, there's no reason to change that value.</p> <p>If used with AJP, this directive sets the maximum AJP packet size in bytes. Values larger than 65536 are set to 65536. If you change it from the default, you must also change the <code>packetSize</code> attribute of your AJP connector on the Tomcat side! The attribute <code>packetSize</code> is only available in Tomcat <code>5.5.20+</code> and <code>6.0.2+</code></p> <p>Normally it is not necessary to change the maximum packet size. Problems with the default value have been reported when sending certificates or certificate chains.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxymatch\">&lt;ProxyMatch&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Container for directives applied to regular-expression-matched proxied resources</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;ProxyMatch regex&gt; ...&lt;/ProxyMatch&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;ProxyMatch&gt;</code> directive is identical to the <code class=\"directive\"><a href=\"#proxy\">&lt;Proxy&gt;</a></code> directive, except that it matches URLs using <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expressions</a>.</p> <p>From 2.4.8 onwards, named groups and backreferences are captured and written to the environment with the corresponding name prefixed with \"MATCH_\" and in upper case. This allows elements of URLs to be referenced from within <a href=\"../expr\">expressions</a> and modules like <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>. In order to prevent confusion, numbered (unnamed) backreferences are ignored. Use named groups instead.</p> <pre class=\"prettyprint lang-config\">&lt;ProxyMatch \"^http://(?&lt;sitename&gt;[^/]+)\"&gt;\n    Require ldap-group cn=%{env:MATCH_SITENAME},ou=combined,o=Example\n&lt;/ProxyMatch&gt;</pre> <h3>See also</h3> <ul> <li><code class=\"directive\"><a href=\"#proxy\">&lt;Proxy&gt;</a></code></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"proxymaxforwards\">ProxyMaxForwards Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maximium number of proxies that a request can be forwarded through</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyMaxForwards number</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyMaxForwards -1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Default behaviour changed in 2.2.7</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyMaxForwards</code> directive specifies the maximum number of proxies through which a request may pass if there's no <code>Max-Forwards</code> header supplied with the request. This may be set to prevent infinite proxy loops or a DoS attack.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProxyMaxForwards 15</pre> </div> <p>Note that setting <code class=\"directive\">ProxyMaxForwards</code> is a violation of the HTTP/1.1 protocol (RFC2616), which forbids a Proxy setting <code>Max-Forwards</code> if the Client didn't set it. Earlier Apache httpd versions would always set it. A negative <code class=\"directive\">ProxyMaxForwards</code> value, including the default -1, gives you protocol-compliant behavior but may leave you open to loops.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypass\">ProxyPass Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps remote servers into the local server URL-space</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPass [path] !|url [key=value [key=value ...]] [nocanon] [interpolate] [noquery]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Unix Domain Socket (UDS) support added in 2.4.7</td>\n</tr> </table> <p>This directive allows remote servers to be mapped into the space of the local server. The local server does not act as a proxy in the conventional sense but appears to be a mirror of the remote server. The local server is often called a <dfn>reverse proxy</dfn> or <dfn>gateway</dfn>. The <var>path</var> is the name of a local virtual path; <var>url</var> is a partial URL for the remote server and cannot include a query string.</p> <div class=\"note\">\n<strong>Note: </strong>This directive cannot be used within a <code>&lt;Directory&gt;</code> context.</div> <div class=\"warning\">The <code class=\"directive\"><a href=\"#proxyrequests\">ProxyRequests</a></code> directive should usually be set <strong>off</strong> when using <code class=\"directive\">ProxyPass</code>.</div> <p>In 2.4.7 and later, support for using a Unix Domain Socket is available by using a target which prepends <code>unix:/path/lis.sock|</code>. For example, to proxy HTTP and target the UDS at /home/www/socket, you would use <code>unix:/home/www.socket|http://localhost/whatever/</code>.</p> <div class=\"note\">\n<strong>Note:</strong> The path associated with the <code>unix:</code> URL is <code class=\"directive\">DefaultRuntimeDir</code> aware.</div> <p>When used inside a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> section, the first argument is omitted and the local directory is obtained from the <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code>. The same will occur inside a <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section; however, ProxyPass does not interpret the regexp as such, so it is necessary to use <code class=\"directive\">ProxyPassMatch</code> in this situation instead.</p> <p>Suppose the local server has address <code>http://example.com/</code>; then</p> <pre class=\"prettyprint lang-config\">&lt;Location \"/mirror/foo/\"&gt;\n    ProxyPass \"http://backend.example.com/\"\n&lt;/Location&gt;</pre> <p>will cause a local request for <code>http://example.com/mirror/foo/bar</code> to be internally converted into a proxy request to <code>http://backend.example.com/bar</code>.</p> <p>The ProxyPass directive is not supported in <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> or <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code> sections.</p> <p>If you require a more flexible reverse-proxy configuration, see the <code class=\"directive\"><a href=\"mod_rewrite#rewriterule\">RewriteRule</a></code> directive with the <code>[P]</code> flag.</p> <p>The following alternative syntax is possible; however, it can carry a performance penalty when present in very large numbers. The advantage of the below syntax is that it allows for dynamic control via the <a href=\"mod_proxy_balancer#balancer_manager\">Balancer Manager</a> interface:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/mirror/foo/\" \"http://backend.example.com/\"</pre> <div class=\"warning\"> <p>If the first argument ends with a trailing <strong>/</strong>, the second argument should also end with a trailing <strong>/</strong>, and vice versa. Otherwise, the resulting requests to the backend may miss some needed slashes and do not deliver the expected results. </p> </div> <p>The <code>!</code> directive is useful in situations where you don't want to reverse-proxy a subdirectory, <em>e.g.</em></p> <pre class=\"prettyprint lang-config\">&lt;Location \"/mirror/foo/\"&gt;\n    ProxyPass \"http://backend.example.com/\"\n&lt;/Location&gt;\n&lt;Location \"/mirror/foo/i\"&gt;\n    ProxyPass \"!\"\n&lt;/Location&gt;</pre> <pre class=\"prettyprint lang-config\">ProxyPass \"/mirror/foo/i\" \"!\"\nProxyPass \"/mirror/foo\" \"http://backend.example.com\"</pre> <p>will proxy all requests to <code>/mirror/foo</code> to <code>backend.example.com</code> <em>except</em> requests made to <code>/mirror/foo/i</code>.</p> <div class=\"warning\">\n<p><strong>Ordering ProxyPass Directives</strong></p> <p>The configured <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> and <code class=\"directive\"><a href=\"#proxypassmatch\">ProxyPassMatch</a></code> rules are checked in the order of configuration. The first rule that matches wins. So usually you should sort conflicting <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> rules starting with the longest URLs first. Otherwise, later rules for longer URLS will be hidden by any earlier rule which uses a leading substring of the URL. Note that there is some relation with worker sharing. In contrast, only one <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive can be placed in a <code class=\"directive\"><a href=\"core#location\">Location</a></code> block, and the most specific location will take precedence.</p> <p>For the same reasons, exclusions must come <em>before</em> the general <code class=\"directive\">ProxyPass</code> directives.</p> </div> <p><strong>ProxyPass <code>key=value</code> Parameters</strong></p> <p>In Apache HTTP Server 2.1 and later, mod_proxy supports pooled connections to a backend server. Connections created on demand can be retained in a pool for future use. Limits on the pool size and other settings can be coded on the <code class=\"directive\">ProxyPass</code> directive using <code>key=value</code> parameters, described in the tables below.</p> <p>By default, mod_proxy will allow and retain the maximum number of connections that could be used simultaneously by that web server child process. Use the <code>max</code> parameter to reduce the number from the default. Use the <code>ttl</code> parameter to set an optional time to live; connections which have been unused for at least <code>ttl</code> seconds will be closed. <code>ttl</code> can be used to avoid using a connection which is subject to closing because of the backend server's keep-alive timeout.</p> <p>The pool of connections is maintained per web server child process, and <code>max</code> and other settings are not coordinated among all child processes, except when only one child process is allowed by configuration or MPM design.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProxyPass \"/example\" \"http://backend.example.com\" max=20 ttl=120 retry=300</pre> </div> <table class=\"bordered\"><tr><th>BalancerMember parameters</th></tr></table> <table> <tr>\n<th>Parameter</th> <th>Default</th> <th>Description</th>\n</tr> <tr>\n<td>min</td> <td>0</td> <td>Minimum number of connection pool entries, unrelated to the actual number of connections. This only needs to be modified from the default for special circumstances where heap memory associated with the backend connections should be preallocated or retained.</td>\n</tr> <tr>\n<td>max</td> <td>1...n</td> <td>Maximum number of connections that will be allowed to the backend server. The default for this limit is the number of threads per process in the active MPM. In the Prefork MPM, this is always 1, while with other MPMs, it is controlled by the <code class=\"directive\">ThreadsPerChild</code> directive.</td>\n</tr> <tr>\n<td>smax</td> <td>max</td> <td>Retained connection pool entries above this limit are freed during certain operations if they have been unused for longer than the time to live, controlled by the <code>ttl</code> parameter. If the connection pool entry has an associated connection, it will be closed. This only needs to be modified from the default for special circumstances where connection pool entries and any associated connections which have exceeded the time to live need to be freed or closed more aggressively.</td>\n</tr> <tr>\n<td>acquire</td> <td>-</td> <td>If set, this will be the maximum time to wait for a free connection in the connection pool, in milliseconds. If there are no free connections in the pool, the Apache httpd will return <code>SERVER_BUSY</code> status to the client. </td>\n</tr> <tr>\n<td>connectiontimeout</td> <td>timeout</td> <td>Connect timeout in seconds. The number of seconds Apache httpd waits for the creation of a connection to the backend to complete. By adding a postfix of ms, the timeout can be also set in milliseconds. </td>\n</tr> <tr>\n<td>disablereuse</td> <td>Off</td> <td>This parameter should be used when you want to force mod_proxy to immediately close a connection to the backend after being used, and thus, disable its persistent connection and pool for that backend. This helps in various situations where a firewall between Apache httpd and the backend server (regardless of protocol) tends to silently drop connections or when backends themselves may be under round- robin DNS. To disable connection pooling reuse, set this property value to <code>On</code>. </td>\n</tr> <tr>\n<td>enablereuse</td> <td>On</td> <td>This is the inverse of 'disablereuse' above, provided as a convenience for scheme handlers that require opt-in for connection reuse (such as <code class=\"module\"><a href=\"mod_proxy_fcgi\">mod_proxy_fcgi</a></code>). 2.4.11 and later only. </td>\n</tr> <tr>\n<td>flushpackets</td> <td>off</td> <td>Determines whether the proxy module will auto-flush the output brigade after each \"chunk\" of data. 'off' means that it will flush only when needed; 'on' means after each chunk is sent; and 'auto' means poll/wait for a period of time and flush if no input has been received for 'flushwait' milliseconds. Currently, this is in effect only for AJP. </td>\n</tr> <tr>\n<td>flushwait</td> <td>10</td> <td>The time to wait for additional input, in milliseconds, before flushing the output brigade if 'flushpackets' is 'auto'. </td>\n</tr> <tr>\n<td>iobuffersize</td> <td>8192</td> <td>Adjusts the size of the internal scratchpad IO buffer. This allows you to override the <code class=\"directive\">ProxyIOBufferSize</code> for a specific worker. This must be at least 512 or set to 0 for the system default of 8192. </td>\n</tr> <tr>\n<td>keepalive</td> <td>Off</td> <td>\n<p>This parameter should be used when you have a firewall between your Apache httpd and the backend server, which tends to drop inactive connections. This flag will tell the Operating System to send <code>KEEP_ALIVE</code> messages on inactive connections and thus prevent the firewall from dropping the connection. To enable keepalive, set this property value to <code>On</code>. </p> <p>The frequency of initial and subsequent TCP keepalive probes depends on global OS settings, and may be as high as 2 hours. To be useful, the frequency configured in the OS must be smaller than the threshold used by the firewall.</p> </td>\n</tr> <tr>\n<td>lbset</td> <td>0</td> <td>Sets the load balancer cluster set that the worker is a member of. The load balancer will try all members of a lower numbered lbset before trying higher numbered ones. </td>\n</tr> <tr>\n<td>ping</td> <td>0</td> <td>Ping property tells the webserver to \"test\" the connection to the backend before forwarding the request. For AJP, it causes <code class=\"module\"><a href=\"mod_proxy_ajp\">mod_proxy_ajp</a></code> to send a <code>CPING</code> request on the ajp13 connection (implemented on Tomcat 3.3.2+, 4.1.28+ and 5.0.13+). For HTTP, it causes <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> to send a <code>100-Continue</code> to the backend (only valid for HTTP/1.1 - for non HTTP/1.1 backends, this property has no effect). In both cases, the parameter is the delay in seconds to wait for the reply. This feature has been added to avoid problems with hung and busy backends. This will increase the network traffic during the normal operation which could be an issue, but it will lower the traffic in case some of the cluster nodes are down or busy. By adding a postfix of ms, the delay can be also set in milliseconds. </td>\n</tr> <tr>\n<td>receivebuffersize</td> <td>0</td> <td>Adjusts the size of the explicit (TCP/IP) network buffer size for proxied connections. This allows you to override the <code class=\"directive\">ProxyReceiveBufferSize</code> for a specific worker. This must be at least 512 or set to 0 for the system default. </td>\n</tr> <tr>\n<td>redirect</td> <td>-</td> <td>Redirection Route of the worker. This value is usually set dynamically to enable safe removal of the node from the cluster. If set, all requests without session id will be redirected to the BalancerMember that has route parameter equal to this value. </td>\n</tr> <tr>\n<td>retry</td> <td>60</td> <td>Connection pool worker retry timeout in seconds. If the connection pool worker to the backend server is in the error state, Apache httpd will not forward any requests to that server until the timeout expires. This enables to shut down the backend server for maintenance and bring it back online later. A value of 0 means always retry workers in an error state with no timeout. </td>\n</tr> <tr>\n<td>route</td> <td>-</td> <td>Route of the worker when used inside load balancer. The route is a value appended to session id. </td>\n</tr> <tr>\n<td>status</td> <td>-</td> <td>Single letter value defining the initial status of this worker. <table> <tr><td>D: Worker is disabled and will not accept any requests.</td></tr> <tr><td>S: Worker is administratively stopped.</td></tr> <tr><td>I: Worker is in ignore-errors mode and will always be considered available.</td></tr> <tr><td>H: Worker is in hot-standby mode and will only be used if no other viable workers are available.</td></tr> <tr><td>E: Worker is in an error state.</td></tr> <tr><td>N: Worker is in drain mode and will only accept existing sticky sessions destined for itself and ignore all other requests.</td></tr> </table>Status can be set (which is the default) by prepending with '+' or cleared by prepending with '-'. Thus, a setting of 'S-E' sets this worker to Stopped and clears the in-error flag. </td>\n</tr> <tr>\n<td>timeout</td> <td><code class=\"directive\">ProxyTimeout</code></td> <td>Connection timeout in seconds. The number of seconds Apache httpd waits for data sent by / to the backend. </td>\n</tr> <tr>\n<td>ttl</td> <td>-</td> <td>Time to live for inactive connections and associated connection pool entries, in seconds. Once reaching this limit, a connection will not be used again; it will be closed at some later time. </td>\n</tr> <tr>\n<td>flusher</td> <td>flush</td> <td>\n<p>Name of the provider used by <code class=\"module\"><a href=\"mod_proxy_fdpass\">mod_proxy_fdpass</a></code>. See the documentation of this module for more details.</p> </td>\n</tr> </table> <p>If the Proxy directive scheme starts with the <code>balancer://</code> (eg: <code>balancer://cluster</code>, any path information is ignored), then a virtual worker that does not really communicate with the backend server will be created. Instead, it is responsible for the management of several \"real\" workers. In that case, the special set of parameters can be added to this virtual worker. See <code class=\"module\"><a href=\"mod_proxy_balancer\">mod_proxy_balancer</a></code> for more information about how the balancer works. </p> <table class=\"bordered\"><tr><th>Balancer parameters</th></tr></table> <table> <tr>\n<th>Parameter</th> <th>Default</th> <th>Description</th>\n</tr> <tr>\n<td>lbmethod</td> <td>byrequests</td> <td>Balancer load-balance method. Select the load-balancing scheduler method to use. Either <code>byrequests</code>, to perform weighted request counting; <code>bytraffic</code>, to perform weighted traffic byte count balancing; or <code>bybusyness</code>, to perform pending request balancing. The default is <code>byrequests</code>. </td>\n</tr> <tr>\n<td>maxattempts</td> <td>One less than the number of workers, or 1 with a single worker.</td> <td>Maximum number of failover attempts before giving up. </td>\n</tr> <tr>\n<td>nofailover</td> <td>Off</td> <td>If set to <code>On</code>, the session will break if the worker is in error state or disabled. Set this value to <code>On</code> if backend servers do not support session replication. </td>\n</tr> <tr>\n<td>stickysession</td> <td>-</td> <td>Balancer sticky session name. The value is usually set to something like <code>JSESSIONID</code> or <code>PHPSESSIONID</code>, and it depends on the backend application server that support sessions. If the backend application server uses different name for cookies and url encoded id (like servlet containers) use | to separate them. The first part is for the cookie the second for the path.<br> Available in Apache HTTP Server 2.4.4 and later. </td>\n</tr> <tr>\n<td>stickysessionsep</td> <td>\".\"</td> <td>Sets the separation symbol in the session cookie. Some backend application servers do not use the '.' as the symbol. For example, the Oracle Weblogic server uses '!'. The correct symbol can be set using this option. The setting of 'Off' signifies that no symbol is used. </td>\n</tr> <tr>\n<td>scolonpathdelim</td> <td>Off</td> <td>If set to <code>On</code>, the semi-colon character ';' will be used as an additional sticky session path delimiter/separator. This is mainly used to emulate mod_jk's behavior when dealing with paths such as <code>JSESSIONID=6736bcf34;foo=aabfa</code> </td>\n</tr> <tr>\n<td>timeout</td> <td>0</td> <td>Balancer timeout in seconds. If set, this will be the maximum time to wait for a free worker. The default is to not wait. </td>\n</tr> <tr>\n<td>failonstatus</td> <td>-</td> <td>A single or comma-separated list of HTTP status codes. If set, this will force the worker into error state when the backend returns any status code in the list. Worker recovery behaves the same as other worker errors. </td>\n</tr> <tr>\n<td>failontimeout</td> <td>Off</td> <td>If set, an IO read timeout after a request is sent to the backend will force the worker into error state. Worker recovery behaves the same as other worker errors.<br> Available in Apache HTTP Server 2.4.5 and later. </td>\n</tr> <tr>\n<td>nonce</td> <td>&lt;auto&gt;</td> <td>The protective nonce used in the <code>balancer-manager</code> application page. The default is to use an automatically determined UUID-based nonce, to provide for further protection for the page. If set, then the nonce is set to that value. A setting of <code>None</code> disables all nonce checking. <div class=\"note\">\n<p><strong>Note</strong></p> <p>In addition to the nonce, the <code>balancer-manager</code> page should be protected via an ACL.</p> </div> </td>\n</tr> <tr>\n<td>growth</td> <td>0</td> <td>Number of additional BalancerMembers to allow to be added to this balancer in addition to those defined at configuration. </td>\n</tr> <tr>\n<td>forcerecovery</td> <td>On</td> <td>Force the immediate recovery of all workers without considering the retry parameter of the workers if all workers of a balancer are in error state. There might be cases where an already overloaded backend can get into deeper trouble if the recovery of all workers is enforced without considering the retry parameter of each worker. In this case, set to <code>Off</code>.<br> Available in Apache HTTP Server 2.4.2 and later. </td>\n</tr> </table> <p>A sample balancer setup:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/special-area\" \"http://special.example.com\" smax=5 max=10\nProxyPass \"/\" \"balancer://mycluster/\" stickysession=JSESSIONID|jsessionid nofailover=On\n&lt;Proxy \"balancer://mycluster\"&gt;\n    BalancerMember \"ajp://1.2.3.4:8009\"\n    BalancerMember \"ajp://1.2.3.5:8009\" loadfactor=20\n    # Less powerful server, don't send as many requests there,\n    BalancerMember \"ajp://1.2.3.6:8009\" loadfactor=5\n&lt;/Proxy&gt;</pre> <p>Setting up a hot-standby that will only be used if no other members are available:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/\" \"balancer://hotcluster/\"\n&lt;Proxy \"balancer://hotcluster\"&gt;\n    BalancerMember \"ajp://1.2.3.4:8009\" loadfactor=1\n    BalancerMember \"ajp://1.2.3.5:8009\" loadfactor=2\n    # The server below is on hot standby\n    BalancerMember \"ajp://1.2.3.6:8009\" status=+H\n    ProxySet lbmethod=bytraffic\n&lt;/Proxy&gt;</pre> <p><strong>Additional ProxyPass Keywords</strong></p> <p>Normally, mod_proxy will canonicalise ProxyPassed URLs. But this may be incompatible with some backends, particularly those that make use of <var>PATH_INFO</var>. The optional <var>nocanon</var> keyword suppresses this and passes the URL path \"raw\" to the backend. Note that this keyword may affect the security of your backend, as it removes the normal limited protection against URL-based attacks provided by the proxy.</p> <p>Normally, mod_proxy will include the query string when generating the <var>SCRIPT_FILENAME</var> environment variable. The optional <var>noquery</var> keyword (available in httpd 2.4.1 and later) prevents this.</p> <p>The optional <var>interpolate</var> keyword, in combination with <code class=\"directive\">ProxyPassInterpolateEnv</code>, causes the ProxyPass to interpolate environment variables, using the syntax <var>${VARNAME}</var>. Note that many of the standard CGI-derived environment variables will not exist when this interpolation happens, so you may still have to resort to <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> for complex rules. Also note that interpolation is not supported within the scheme portion of a URL. Dynamic determination of the scheme can be accomplished with <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> as in the following example.</p> <pre class=\"prettyprint lang-config\">RewriteEngine On\n\nRewriteCond \"%{HTTPS}\" =off\nRewriteRule \".\" \"-\" [E=protocol:http]\nRewriteCond \"%{HTTPS}\" =on\nRewriteRule \".\" \"-\" [E=protocol:https]\n\nRewriteRule \"^/mirror/foo/(.*)\" \"%{ENV:protocol}://backend.example.com/$1\" [P]\nProxyPassReverse  \"/mirror/foo/\" \"http://backend.example.com/\"\nProxyPassReverse  \"/mirror/foo/\" \"https://backend.example.com/\"</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypassinherit\">ProxyPassInherit Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Inherit ProxyPass directives defined from the main server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPassInherit On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyPassInherit On</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>ProxyPassInherit is only available in Apache HTTP Server 2.4.5 and later. </td>\n</tr> </table> <p>This directive will cause the current server/vhost to \"inherit\" <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directives defined in the main server. This can cause issues and inconsistent behavior if using the Balancer Manager for dynamic changes and so should be disabled if using that feature.</p> <p>The setting in the global server defines the default for all vhosts.</p> <p>Disabling ProxyPassInherit also disables <code class=\"directive\"><a href=\"#balancerinherit\">BalancerInherit</a></code>.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypassinterpolateenv\">ProxyPassInterpolateEnv Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enable Environment Variable interpolation in Reverse Proxy configurations</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPassInterpolateEnv On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyPassInterpolateEnv Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in httpd 2.2.9 and later</td>\n</tr> </table> <p>This directive, together with the <var>interpolate</var> argument to <code class=\"directive\">ProxyPass</code>, <code class=\"directive\">ProxyPassReverse</code>, <code class=\"directive\">ProxyPassReverseCookieDomain</code>, and <code class=\"directive\">ProxyPassReverseCookiePath</code>, enables reverse proxies to be dynamically configured using environment variables which may be set by another module such as <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>. It affects the <code class=\"directive\">ProxyPass</code>, <code class=\"directive\">ProxyPassReverse</code>, <code class=\"directive\">ProxyPassReverseCookieDomain</code>, and <code class=\"directive\">ProxyPassReverseCookiePath</code> directives and causes them to substitute the value of an environment variable <code>varname</code> for the string <code>${varname}</code> in configuration directives if the <var>interpolate</var> option is set.</p> <p>Keep this turned off (for server performance) unless you need it!</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypassmatch\">ProxyPassMatch Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Maps remote servers into the local server URL-space using regular expressions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPassMatch [regex] !|url [key=value [key=value ...]]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This directive is equivalent to <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> but makes use of regular expressions instead of simple prefix matching. The supplied regular expression is matched against the <var>url</var>, and if it matches, the server will substitute any parenthesized matches into the given string and use it as a new <var>url</var>.</p> <div class=\"note\">\n<strong>Note: </strong>This directive cannot be used within a <code>&lt;Directory&gt;</code> context.</div> <p>Suppose the local server has address <code>http://example.com/</code>; then</p> <pre class=\"prettyprint lang-config\">ProxyPassMatch \"^/(.*\\.gif)$\" \"http://backend.example.com/$1\"</pre> <p>will cause a local request for <code>http://example.com/foo/bar.gif</code> to be internally converted into a proxy request to <code>http://backend.example.com/foo/bar.gif</code>.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>The URL argument must be parsable as a URL <em>before</em> regexp substitutions (as well as after). This limits the matches you can use. For instance, if we had used</p> <pre class=\"prettyprint lang-config\">ProxyPassMatch \"^(/.*\\.gif)$\" \"http://backend.example.com:8000$1\"</pre> <p>in our previous example, it would fail with a syntax error at server startup. This is a bug (PR 46665 in the ASF bugzilla), and the workaround is to reformulate the match:</p> <pre class=\"prettyprint lang-config\">ProxyPassMatch \"^/(.*\\.gif)$\" \"http://backend.example.com:8000/$1\"</pre> </div> <p>The <code>!</code> directive is useful in situations where you don't want to reverse-proxy a subdirectory.</p> <p>When used inside a <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section, the first argument is omitted and the regexp is obtained from the <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code>.</p> <p>If you require a more flexible reverse-proxy configuration, see the <code class=\"directive\"><a href=\"mod_rewrite#rewriterule\">RewriteRule</a></code> directive with the <code>[P]</code> flag.</p> <div class=\"note\"> <p><strong>Default Substitution</strong></p> <p>When the URL parameter doesn't use any backreferences into the regular expression, the original URL will be appended to the URL parameter. </p> </div> <div class=\"warning\"> <p><strong>Security Warning</strong></p> <p>Take care when constructing the target URL of the rule, considering the security impact from allowing the client influence over the set of URLs to which your server will act as a proxy. Ensure that the scheme and hostname part of the URL is either fixed or does not allow the client undue influence.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypassreverse\">ProxyPassReverse Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Adjusts the URL in HTTP response headers sent from a reverse proxied server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPassReverse [path] url [interpolate]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This directive lets Apache httpd adjust the URL in the <code>Location</code>, <code>Content-Location</code> and <code>URI</code> headers on HTTP redirect responses. This is essential when Apache httpd is used as a reverse proxy (or gateway) to avoid bypassing the reverse proxy because of HTTP redirects on the backend servers which stay behind the reverse proxy.</p> <p>Only the HTTP response headers specifically mentioned above will be rewritten. Apache httpd will not rewrite other response headers, nor will it by default rewrite URL references inside HTML pages. This means that if the proxied content contains absolute URL references, they will bypass the proxy. To rewrite HTML content to match the proxy, you must load and enable <code class=\"module\"><a href=\"mod_proxy_html\">mod_proxy_html</a></code>. </p> <p><var>path</var> is the name of a local virtual path; <var>url</var> is a partial URL for the remote server. These parameters are used the same way as for the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive.</p> <p>For example, suppose the local server has address <code>http://example.com/</code>; then</p> <pre class=\"prettyprint lang-config\">ProxyPass         \"/mirror/foo/\" \"http://backend.example.com/\"\nProxyPassReverse  \"/mirror/foo/\" \"http://backend.example.com/\"\nProxyPassReverseCookieDomain  \"backend.example.com\"  \"public.example.com\"\nProxyPassReverseCookiePath  \"/\"  \"/mirror/foo/\"</pre> <p>will not only cause a local request for the <code>http://example.com/mirror/foo/bar</code> to be internally converted into a proxy request to <code>http://backend.example.com/bar</code> (the functionality which <code>ProxyPass</code> provides here). It also takes care of redirects which the server <code>backend.example.com</code> sends when redirecting <code>http://backend.example.com/bar</code> to <code>http://backend.example.com/quux</code> . Apache httpd adjusts this to <code>http://example.com/mirror/foo/quux</code> before forwarding the HTTP redirect response to the client. Note that the hostname used for constructing the URL is chosen in respect to the setting of the <code class=\"directive\"><a href=\"core#usecanonicalname\">UseCanonicalName</a></code> directive.</p> <p>Note that this <code class=\"directive\">ProxyPassReverse</code> directive can also be used in conjunction with the proxy feature (<code>RewriteRule ... [P]</code>) from <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> because it doesn't depend on a corresponding <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive.</p> <p>The optional <var>interpolate</var> keyword, used together with <code class=\"directive\">ProxyPassInterpolateEnv</code>, enables interpolation of environment variables specified using the format <var>${VARNAME}</var>. Note that interpolation is not supported within the scheme portion of a URL.</p> <p>When used inside a <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> section, the first argument is omitted and the local directory is obtained from the <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code>. The same occurs inside a <code class=\"directive\"><a href=\"core#locationmatch\">&lt;LocationMatch&gt;</a></code> section, but will probably not work as intended, as ProxyPassReverse will interpret the regexp literally as a path; if needed in this situation, specify the ProxyPassReverse outside the section or in a separate <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> section.</p> <p>This directive is not supported in <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> or <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code> sections.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypassreversecookiedomain\">ProxyPassReverseCookieDomain Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Adjusts the Domain string in Set-Cookie headers from a reverse- proxied server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPassReverseCookieDomain internal-domain public-domain [interpolate]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>Usage is basically similar to <code class=\"directive\"><a href=\"#proxypassreverse\">ProxyPassReverse</a></code>, but instead of rewriting headers that are a URL, this rewrites the <code>domain</code> string in <code>Set-Cookie</code> headers.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypassreversecookiepath\">ProxyPassReverseCookiePath Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Adjusts the Path string in Set-Cookie headers from a reverse- proxied server</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPassReverseCookiePath internal-path public-path [interpolate]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p> Useful in conjunction with <code class=\"directive\"><a href=\"#proxypassreverse\">ProxyPassReverse</a></code> in situations where backend URL paths are mapped to public paths on the reverse proxy. This directive rewrites the <code>path</code> string in <code>Set-Cookie</code> headers. If the beginning of the cookie path matches <var>internal-path</var>, the cookie path will be replaced with <var>public-path</var>. </p>\n<p> In the example given with <code class=\"directive\"><a href=\"#proxypassreverse\">ProxyPassReverse</a></code>, the directive: </p> <pre class=\"prettyprint lang-config\">ProxyPassReverseCookiePath  \"/\"  \"/mirror/foo/\"</pre> <p> will rewrite a cookie with backend path <code>/</code> (or <code>/example</code> or, in fact, anything) to <code>/mirror/foo/</code>. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxypreservehost\">ProxyPreserveHost Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Use incoming Host HTTP request header for proxy request</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyPreserveHost On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyPreserveHost Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Usable in directory context in 2.3.3 and later.</td>\n</tr> </table> <p>When enabled, this option will pass the Host: line from the incoming request to the proxied host, instead of the hostname specified in the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> line.</p> <p>This option should normally be turned <code>Off</code>. It is mostly useful in special configurations like proxied mass name-based virtual hosting, where the original Host header needs to be evaluated by the backend server.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyreceivebuffersize\">ProxyReceiveBufferSize Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Network buffer size for proxied HTTP and FTP connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyReceiveBufferSize bytes</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyReceiveBufferSize 0</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyReceiveBufferSize</code> directive specifies an explicit (TCP/IP) network buffer size for proxied HTTP and FTP connections, for increased throughput. It has to be greater than <code>512</code> or set to <code>0</code> to indicate that the system's default buffer size should be used.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProxyReceiveBufferSize 2048</pre> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyremote\">ProxyRemote Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Remote proxy used to handle certain requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyRemote match remote-server</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This defines remote proxies to this proxy. <var>match</var> is either the name of a URL-scheme that the remote server supports, or a partial URL for which the remote server should be used, or <code>*</code> to indicate the server should be contacted for all requests. <var>remote-server</var> is a partial URL for the remote server. Syntax:</p> <div class=\"example\"><pre>remote-server = scheme://hostname[:port]</pre></div> <p><var>scheme</var> is effectively the protocol that should be used to communicate with the remote server; only <code>http</code> and <code>https</code> are supported by this module. When using <code>https</code>, the requests are forwarded through the remote proxy using the HTTP CONNECT method.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">ProxyRemote \"http://goodguys.example.com/\" \"http://mirrorguys.example.com:8000\"\nProxyRemote \"*\" \"http://cleverproxy.localdomain\"\nProxyRemote \"ftp\" \"http://ftpproxy.mydomain:8080\"</pre> </div> <p>In the last example, the proxy will forward FTP requests, encapsulated as yet another HTTP proxy request, to another proxy which can handle them.</p> <p>This option also supports reverse proxy configuration; a backend webserver can be embedded within a virtualhost URL space even if that server is hidden by another forward proxy.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyremotematch\">ProxyRemoteMatch Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Remote proxy used to handle requests matched by regular expressions</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyRemoteMatch regex remote-server</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>The <code class=\"directive\">ProxyRemoteMatch</code> is identical to the <code class=\"directive\"><a href=\"#proxyremote\">ProxyRemote</a></code> directive, except that the first argument is a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> match against the requested URL.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyrequests\">ProxyRequests Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables forward (standard) proxy requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyRequests On|Off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyRequests Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This allows or prevents Apache httpd from functioning as a forward proxy server. (Setting ProxyRequests to <code>Off</code> does not disable use of the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive.)</p> <p>In a typical reverse proxy or gateway configuration, this option should be set to <code>Off</code>.</p> <p>In order to get the functionality of proxying HTTP or FTP sites, you need also <code class=\"module\"><a href=\"mod_proxy_http\">mod_proxy_http</a></code> or <code class=\"module\"><a href=\"mod_proxy_ftp\">mod_proxy_ftp</a></code> (or both) present in the server.</p> <p>In order to get the functionality of (forward) proxying HTTPS sites, you need <code class=\"module\"><a href=\"mod_proxy_connect\">mod_proxy_connect</a></code> enabled in the server.</p> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Do not enable proxying with <code class=\"directive\"><a href=\"#proxyrequests\">ProxyRequests</a></code> until you have <a href=\"#access\">secured your server</a>. Open proxy servers are dangerous both to your network and to the Internet at large.</p> </div> <h3>See also</h3> <ul> <li><a href=\"#forwardreverse\">Forward and Reverse Proxies/Gateways</a></li> </ul> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyset\">ProxySet Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set various Proxy balancer or member parameters</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxySet url key=value [key=value ...]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>ProxySet is only available in Apache HTTP Server 2.2 and later.</td>\n</tr> </table> <p>This directive is used as an alternate method of setting any of the parameters available to Proxy balancers and workers normally done via the <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive. If used within a <code>&lt;Proxy balancer url|worker url&gt;</code> container directive, the <var>url</var> argument is not required. As a side effect the respective balancer or worker gets created. This can be useful when doing reverse proxying via a <code class=\"directive\"><a href=\"mod_rewrite#rewriterule\">RewriteRule</a></code> instead of a <code class=\"directive\"><a href=\"#proxypass\">ProxyPass</a></code> directive.</p> <div class=\"example\">\n<pre class=\"prettyprint lang-config\">&lt;Proxy \"balancer://hotcluster\"&gt;\n    BalancerMember \"http://www2.example.com:8080\" loadfactor=1\n    BalancerMember \"http://www3.example.com:8080\" loadfactor=2\n    ProxySet lbmethod=bytraffic\n&lt;/Proxy&gt;</pre> </div> <pre class=\"prettyprint lang-config\">&lt;Proxy \"http://backend\"&gt;\n    ProxySet keepalive=On\n&lt;/Proxy&gt;</pre> <pre class=\"prettyprint lang-config\">ProxySet \"balancer://foo\" lbmethod=bytraffic timeout=15</pre> <pre class=\"prettyprint lang-config\">ProxySet \"ajp://backend:7001\" timeout=15</pre> <div class=\"warning\">\n<p><strong>Warning</strong></p> <p>Keep in mind that the same parameter key can have a different meaning depending whether it is applied to a balancer or a worker, as shown by the two examples above regarding timeout.</p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxysourceaddress\">ProxySourceAddress Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Set local IP address for outgoing proxy connections</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxySourceAddress address</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.3.9 and later</td>\n</tr> </table> <p>This directive allows to set a specific local address to bind to when connecting to a backend server.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxystatus\">ProxyStatus Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Show Proxy LoadBalancer status in mod_status</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyStatus Off|On|Full</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyStatus Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in version 2.2 and later</td>\n</tr> </table> <p>This directive determines whether or not proxy loadbalancer status data is displayed via the <code class=\"module\"><a href=\"mod_status\">mod_status</a></code> server-status page.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p><strong>Full</strong> is synonymous with <strong>On</strong></p> </div> </div>  <div class=\"directive-section\">\n<h2 id=\"proxytimeout\">ProxyTimeout Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Network timeout for proxied requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyTimeout seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>Value of Timeout</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This directive allows a user to specifiy a timeout on proxy requests. This is useful when you have a slow/buggy appserver which hangs, and you would rather just return a timeout and fail gracefully instead of waiting however long it takes the server to return.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"proxyvia\">ProxyVia Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Information provided in the <code>Via</code> HTTP response header for proxied requests</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>ProxyVia On|Off|Full|Block</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>ProxyVia Off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_proxy</td>\n</tr> </table> <p>This directive controls the use of the <code>Via:</code> HTTP header by the proxy. Its intended use is to control the flow of proxy requests along a chain of proxy servers. See <a href=\"http://www.ietf.org/rfc/rfc2616.txt\">RFC 2616</a> (HTTP/1.1), section 14.45 for an explanation of <code>Via:</code> header lines.</p> <ul> <li>If set to <code>Off</code>, which is the default, no special processing is performed. If a request or reply contains a <code>Via:</code> header, it is passed through unchanged.</li> <li>If set to <code>On</code>, each request and reply will get a <code>Via:</code> header line added for the current host.</li> <li>If set to <code>Full</code>, each generated <code>Via:</code> header line will additionally have the Apache httpd server version shown as a <code>Via:</code> comment field.</li> <li>If set to <code>Block</code>, every proxy request will have all its <code>Via:</code> header lines removed. No new <code>Via:</code> header will be generated.</li> </ul> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_proxy.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_proxy.html</a>\n  </p>\n</div>\n","mod/mod_version":"<h1>Apache Module mod_version</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Version dependent configuration</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>version_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_version.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module is designed for the use in test suites and large networks which have to deal with different httpd versions and different configurations. It provides a new container -- <code class=\"directive\"><a href=\"#ifversion\">&lt;IfVersion&gt;</a></code>, which allows a flexible version checking including numeric comparisons and regular expressions.</p> <div class=\"example\">\n<h3>Examples</h3>\n<pre class=\"prettyprint lang-config\">&lt;IfVersion 2.4.2&gt;\n    # current httpd version is exactly 2.4.2\n&lt;/IfVersion&gt;\n\n&lt;IfVersion &gt;= 2.5&gt;\n    # use really new features :-)\n&lt;/IfVersion&gt;</pre> </div> <p>See below for further possibilities.</p>    <div class=\"directive-section\">\n<h2 id=\"ifversion\">&lt;IfVersion&gt; Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>contains version dependent configuration</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>&lt;IfVersion [[!]operator] version&gt; ... &lt;/IfVersion&gt;</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>All</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_version</td>\n</tr> </table> <p>The <code class=\"directive\">&lt;IfVersion&gt;</code> section encloses configuration directives which are executed only if the <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> version matches the desired criteria. For normal (numeric) comparisons the <var>version</var> argument has the format <code>major[.minor[.patch]]</code>, e.g. <code>2.1.0</code> or <code>2.2</code>. <var>minor</var> and <var>patch</var> are optional. If these numbers are omitted, they are assumed to be zero. The following numerical <var>operator</var>s are possible:</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th><var>operator</var></th>\n<th>description</th>\n</tr> <tr>\n<td>\n<code>=</code> or <code>==</code>\n</td> <td>httpd version is equal</td>\n</tr> <tr class=\"odd\">\n<td><code>&gt;</code></td> <td>httpd version is greater than</td>\n</tr> <tr>\n<td><code>&gt;=</code></td> <td>httpd version is greater or equal</td>\n</tr> <tr class=\"odd\">\n<td><code>&lt;</code></td> <td>httpd version is less than</td>\n</tr> <tr>\n<td><code>&lt;=</code></td> <td>httpd version is less or equal</td>\n</tr> </table> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;IfVersion &gt;= 2.3&gt;\n    # this happens only in versions greater or\n    # equal 2.3.0.\n&lt;/IfVersion&gt;</pre> </div> <p>Besides the numerical comparison it is possible to match a <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expression</a> against the httpd version. There are two ways to write it:</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th><var>operator</var></th>\n<th>description</th>\n</tr> <tr>\n<td>\n<code>=</code> or <code>==</code>\n</td> <td>\n<var>version</var> has the form <code>/regex/</code>\n</td>\n</tr> <tr class=\"odd\">\n<td><code>~</code></td> <td>\n<var>version</var> has the form <code>regex</code>\n</td>\n</tr> </table> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">&lt;IfVersion = /^2.4.[01234]$/&gt;\n    # e.g. workaround for buggy versions\n&lt;/IfVersion&gt;</pre> </div> <p>In order to reverse the meaning, all operators can be preceded by an exclamation mark (<code>!</code>):</p> <pre class=\"prettyprint lang-config\">&lt;IfVersion !~ ^2.4.[01234]$&gt;\n    # not for those versions\n&lt;/IfVersion&gt;</pre> <p>If the <var>operator</var> is omitted, it is assumed to be <code>=</code>.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_version.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_version.html</a>\n  </p>\n</div>\n","mod/mod_watchdog":"<h1>Apache Module mod_watchdog</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>provides infrastructure for other modules to periodically run tasks</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>watchdog_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_watchdog.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Available in Apache 2.3 and later</td>\n</tr>\n</table> <h3>Summary</h3> <p><code class=\"module\"><a href=\"mod_watchdog\">mod_watchdog</a></code> defines programmatic hooks for other modules to periodically run tasks. These modules can register handlers for <code class=\"module\"><a href=\"mod_watchdog\">mod_watchdog</a></code> hooks. Currently, the following modules in the Apache distribution use this functionality:</p> <ul> <li><code class=\"module\"><a href=\"mod_heartbeat\">mod_heartbeat</a></code></li> <li><code class=\"module\"><a href=\"mod_heartmonitor\">mod_heartmonitor</a></code></li> </ul> <div class=\"warning\"> To allow a module to use <code class=\"module\"><a href=\"mod_watchdog\">mod_watchdog</a></code> functionality, <code class=\"module\"><a href=\"mod_watchdog\">mod_watchdog</a></code> itself must be statically linked to the server core or, if a dynamic module, be loaded before the calling module. </div>    <div class=\"directive-section\">\n<h2 id=\"watchdoginterval\">WatchdogInterval Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Watchdog interval in seconds</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>WatchdogInterval number-of-seconds</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>WatchdogInterval 1</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_watchdog</td>\n</tr> </table> <p>Sets the interval at which the watchdog_step hook runs. Default is to run every second.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_watchdog.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_watchdog.html</a>\n  </p>\n</div>\n","mod/mod_xml2enc":"<h1>Apache Module mod_xml2enc</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Enhanced charset/internationalisation support for libxml2-based filter modules</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>xml2enc_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_xml2enc.c</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4 and later. Available as a third-party module for 2.2.x versions</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module provides enhanced internationalisation support for markup-aware filter modules such as <code class=\"module\"><a href=\"mod_proxy_html\">mod_proxy_html</a></code>. It can automatically detect the encoding of input data and ensure they are correctly processed by the <a href=\"http://xmlsoft.org/\">libxml2</a> parser, including converting to Unicode (UTF-8) where necessary. It can also convert data to an encoding of choice after markup processing, and will ensure the correct <var>charset</var> value is set in the HTTP <var>Content-Type</var> header.</p>     <h2 id=\"usage\">Usage</h2> <p>There are two usage scenarios: with modules programmed to work with mod_xml2enc, and with those that are not aware of it:</p> <dl> <dt>Filter modules enabled for mod_xml2enc</dt>\n<dd> <p>Modules such as <code class=\"module\"><a href=\"mod_proxy_html\">mod_proxy_html</a></code> version 3.1 and up use the <code>xml2enc_charset</code> optional function to retrieve the charset argument to pass to the libxml2 parser, and may use the <code>xml2enc_filter</code> optional function to postprocess to another encoding. Using mod_xml2enc with an enabled module, no configuration is necessary: the other module will configure mod_xml2enc for you (though you may still want to customise it using the configuration directives below).</p> </dd> <dt>Non-enabled modules</dt>\n<dd> <p>To use it with a libxml2-based module that isn't explicitly enabled for mod_xml2enc, you will have to configure the filter chain yourself. So to use it with a filter <strong>foo</strong> provided by a module <strong>mod_foo</strong> to improve the latter's i18n support with HTML and XML, you could use</p> <pre><code>FilterProvider iconv xml2enc Content-Type $text/html FilterProvider iconv xml2enc Content-Type $xml FilterProvider markup foo Content-Type $text/html FilterProvider markup foo Content-Type $xml FilterChain iconv markup</code></pre> <p><strong>mod_foo</strong> will now support any character set supported by either (or both) of libxml2 or apr_xlate/iconv.</p> </dd>\n</dl>   <h2 id=\"api\">Programming API</h2> <p>Programmers writing libxml2-based filter modules are encouraged to enable them for mod_xml2enc, to provide strong i18n support for your users without reinventing the wheel. The programming API is exposed in <var>mod_xml2enc.h</var>, and a usage example is <code class=\"module\"><a href=\"mod_proxy_html\">mod_proxy_html</a></code>.</p>   <h2 id=\"sniffing\">Detecting an Encoding</h2> <p>Unlike <code class=\"module\"><a href=\"mod_charset_lite\">mod_charset_lite</a></code>, mod_xml2enc is designed to work with data whose encoding cannot be known in advance and thus configured. It therefore uses 'sniffing' techniques to detect the encoding of HTTP data as follows:</p> <ol> <li>If the HTTP <var>Content-Type</var> header includes a <var>charset</var> parameter, that is used.</li> <li>If the data start with an XML Byte Order Mark (BOM) or an XML encoding declaration, that is used.</li> <li>If an encoding is declared in an HTML <code>&lt;META&gt;</code> element, that is used.</li> <li>If none of the above match, the default value set by <code class=\"directive\">xml2EncDefault</code> is used.</li> </ol> <p>The rules are applied in order. As soon as a match is found, it is used and detection is stopped.</p>   <h2 id=\"output\">Output Encoding</h2> <p><a href=\"http://xmlsoft.org/\">libxml2</a> always uses UTF-8 (Unicode) internally, and libxml2-based filter modules will output that by default. mod_xml2enc can change the output encoding through the API, but there is currently no way to configure that directly.</p> <p>Changing the output encoding should (in theory, at least) never be necessary, and is not recommended due to the extra processing load on the server of an unnecessary conversion.</p>   <h2 id=\"alias\">Unsupported Encodings</h2> <p>If you are working with encodings that are not supported by any of the conversion methods available on your platform, you can still alias them to a supported encoding using <code class=\"directive\">xml2EncAlias</code>.</p>   <div class=\"directive-section\">\n<h2 id=\"xml2encalias\">xml2EncAlias Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Recognise Aliases for encoding values</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>xml2EncAlias charset alias [alias ...]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_xml2enc</td>\n</tr> </table> <p>This server-wide directive aliases one or more encoding to another encoding. This enables encodings not recognised by libxml2 to be handled internally by libxml2's encoding support using the translation table for a recognised encoding. This serves two purposes: to support character sets (or names) not recognised either by libxml2 or iconv, and to skip conversion for an encoding where it is known to be unnecessary.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"xml2encdefault\">xml2EncDefault Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets a default encoding to assume when absolutely no information can be <a href=\"#sniffing\">automatically detected</a>\n</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>xml2EncDefault name</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_xml2enc</td>\n</tr> <tr>\n<th>Compatibility:</th>\n<td>Version 2.4.0 and later; available as a third-party module for earlier versions.</td>\n</tr> </table> <p>If you are processing data with known encoding but no encoding information, you can set this default to help mod_xml2enc process the data correctly. For example, to work with the default value of Latin1 (<var>iso-8859-1</var> specified in HTTP/1.0, use</p> <pre class=\"prettyprint lang-config\">xml2EncDefault iso-8859-1</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"xml2startparse\">xml2StartParse Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Advise the parser to skip leading junk.</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>xml2StartParse element [element ...]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Base</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_xml2enc</td>\n</tr> </table> <p>Specify that the markup parser should start at the first instance of any of the elements specified. This can be used as a workaround where a broken backend inserts leading junk that messes up the parser (<a href=\"http://bahumbug.wordpress.com/2006/10/12/mod_proxy_html-revisited/\">example here</a>).</p> <p>It should never be used for XML, nor well-formed HTML.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_xml2enc.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_xml2enc.html</a>\n  </p>\n</div>\n","mod/mod_rewrite":"<h1>Apache Module mod_rewrite</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides a rule-based rewriting engine to rewrite requested URLs on the fly</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>rewrite_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_rewrite.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>The <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> module uses a rule-based rewriting engine, based on a PCRE regular-expression parser, to rewrite requested URLs on the fly. By default, <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> maps a URL to a filesystem path. However, it can also be used to redirect one URL to another URL, or to invoke an internal proxy fetch.</p> <p><code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> provides a flexible and powerful way to manipulate URLs using an unlimited number of rules. Each rule can have an unlimited number of attached rule conditions, to allow you to rewrite URL based on server variables, environment variables, HTTP headers, or time stamps.</p> <p><code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> operates on the full URL path, including the path-info section. A rewrite rule can be invoked in <code>httpd.conf</code> or in <code>.htaccess</code>. The path generated by a rewrite rule can include a query string, or can lead to internal sub-processing, external request redirection, or internal proxy throughput.</p> <p>Further details, discussion, and examples, are provided in the <a href=\"../rewrite/index\">detailed mod_rewrite documentation</a>.</p>     <h2 id=\"logging\">Logging</h2> <p><code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> offers detailed logging of its actions at the <code>trace1</code> to <code>trace8</code> log levels. The log level can be set specifically for <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> using the <code class=\"directive\"><a href=\"core#loglevel\">LogLevel</a></code> directive: Up to level <code>debug</code>, no actions are logged, while <code>trace8</code> means that practically all actions are logged.</p> <div class=\"note\"> Using a high trace log level for <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> will slow down your Apache HTTP Server dramatically! Use a log level higher than <code>trace2</code> only for debugging! </div> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">LogLevel alert rewrite:trace3</pre> </div> <div class=\"note\">\n<p><strong>RewriteLog</strong></p> <p>Those familiar with earlier versions of <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> will no doubt be looking for the <code>RewriteLog</code> and <code>RewriteLogLevel</code> directives. This functionality has been completely replaced by the new per-module logging configuration mentioned above. </p> <p>To get just the <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code>-specific log messages, pipe the log file through grep:</p> <div class=\"example\"><pre>tail -f error_log|fgrep '[rewrite:'</pre></div> </div>   <div class=\"directive-section\">\n<h2 id=\"rewritebase\">RewriteBase Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets the base URL for per-directory rewrites</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RewriteBase URL-path</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><code>None</code></td>\n</tr> <tr>\n<th>Context:</th>\n<td>directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_rewrite</td>\n</tr> </table> <p>The <code class=\"directive\">RewriteBase</code> directive specifies the URL prefix to be used for per-directory (htaccess) <code class=\"directive\"><a href=\"#rewriterule\">RewriteRule</a></code> directives that substitute a relative path.</p> <p> This directive is <em>required</em> when you use a relative path in a substitution in per-directory (htaccess) context unless either of the following conditions are true:</p> <ul> <li> The original request, and the substitution, are underneath the <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code> (as opposed to reachable by other means, such as <code class=\"directive\"><a href=\"mod_alias#alias\">Alias</a></code>).</li> <li> The <em>filesystem</em> path to the directory containing the <code class=\"directive\"><a href=\"#rewriterule\">RewriteRule</a></code>, suffixed by the relative substitution is also valid as a URL path on the server (this is rare).</li> <li> In Apache HTTP Server 2.4.16 and later, this directive may be omitted when the request is mapped via <code class=\"directive\"><a href=\"mod_alias#alias\">Alias</a></code> or <code class=\"module\"><a href=\"mod_userdir\">mod_userdir</a></code>.</li> </ul> <p> In the example below, <code class=\"directive\">RewriteBase</code> is necessary to avoid rewriting to http://example.com/opt/myapp-1.2.3/welcome.html since the resource was not relative to the document root. This misconfiguration would normally cause the server to look for an \"opt\" directory under the document root.</p> <pre class=\"prettyprint lang-config\">DocumentRoot \"/var/www/example.com\"\nAliasMatch \"^/myapp\" \"/opt/myapp-1.2.3\"\n&lt;Directory \"/opt/myapp-1.2.3\"&gt;\n    RewriteEngine On\n    RewriteBase \"/myapp/\"\n    RewriteRule \"^index\\.html$\"  \"welcome.html\"\n&lt;/Directory&gt;</pre> </div>  <div class=\"directive-section\">\n<h2 id=\"rewritecond\">RewriteCond Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Defines a condition under which rewriting will take place </td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RewriteCond TestString CondPattern</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_rewrite</td>\n</tr> </table> <p>The <code class=\"directive\">RewriteCond</code> directive defines a rule condition. One or more <code class=\"directive\">RewriteCond</code> can precede a <code class=\"directive\"><a href=\"#rewriterule\">RewriteRule</a></code> directive. The following rule is then only used if both the current state of the URI matches its pattern, <strong>and</strong> if these conditions are met.</p> <p><em>TestString</em> is a string which can contain the following expanded constructs in addition to plain text:</p> <ul> <li> <strong>RewriteRule backreferences</strong>: These are backreferences of the form <strong><code>$N</code></strong> (0 &lt;= N &lt;= 9). $1 to $9 provide access to the grouped parts (in parentheses) of the pattern, from the <code>RewriteRule</code> which is subject to the current set of <code>RewriteCond</code> conditions. $0 provides access to the whole string matched by that pattern. </li> <li> <strong>RewriteCond backreferences</strong>: These are backreferences of the form <strong><code>%N</code></strong> (0 &lt;= N &lt;= 9). %1 to %9 provide access to the grouped parts (again, in parentheses) of the pattern, from the last matched <code>RewriteCond</code> in the current set of conditions. %0 provides access to the whole string matched by that pattern. </li> <li> <strong>RewriteMap expansions</strong>: These are expansions of the form <strong><code>${mapname:key|default}</code></strong>. See <a href=\"#mapfunc\">the documentation for RewriteMap</a> for more details. </li> <li> <strong>Server-Variables</strong>: These are variables of the form <strong><code>%{</code> <em>NAME_OF_VARIABLE</em> <code>}</code></strong> where <em>NAME_OF_VARIABLE</em> can be a string taken from the following list: <table> <tr> <th>HTTP headers:</th> <th>connection &amp; request:</th> <th></th> </tr> <tr> <td> HTTP_ACCEPT<br> HTTP_COOKIE<br> HTTP_FORWARDED<br> HTTP_HOST<br> HTTP_PROXY_CONNECTION<br> HTTP_REFERER<br> HTTP_USER_AGENT<br> </td> <td> AUTH_TYPE<br> CONN_REMOTE_ADDR<br> CONTEXT_PREFIX<br> CONTEXT_DOCUMENT_ROOT<br> IPV6<br> PATH_INFO<br> QUERY_STRING<br> REMOTE_ADDR<br> REMOTE_HOST<br> REMOTE_IDENT<br> REMOTE_PORT<br> REMOTE_USER<br> REQUEST_METHOD<br> SCRIPT_FILENAME<br> </td> <td></td> </tr> <tr> <th>server internals:</th> <th>date and time:</th> <th>specials:</th> </tr> <tr> <td> DOCUMENT_ROOT<br> SCRIPT_GROUP<br> SCRIPT_USER<br> SERVER_ADDR<br> SERVER_ADMIN<br> SERVER_NAME<br> SERVER_PORT<br> SERVER_PROTOCOL<br> SERVER_SOFTWARE<br> </td> <td> TIME_YEAR<br> TIME_MON<br> TIME_DAY<br> TIME_HOUR<br> TIME_MIN<br> TIME_SEC<br> TIME_WDAY<br> TIME<br> </td> <td> API_VERSION<br> CONN_REMOTE_ADDR<br> HTTPS<br> IS_SUBREQ<br> REMOTE_ADDR<br> REQUEST_FILENAME<br> REQUEST_SCHEME<br> REQUEST_URI<br> THE_REQUEST<br> </td> </tr> </table> <p>These variables all correspond to the similarly named HTTP MIME-headers, C variables of the Apache HTTP Server or <code>struct tm</code> fields of the Unix system. Most are documented <a href=\"../expr#vars\">here</a> or elsewhere in the Manual or in the CGI specification.</p> <p>SERVER_NAME and SERVER_PORT depend on the values of <code class=\"directive\"><a href=\"core#usecanonicalname\">UseCanonicalName</a></code> and <code class=\"directive\"><a href=\"core#usecanonicalphysicalport\">UseCanonicalPhysicalPort</a></code> respectively.</p> <p>Those that are special to mod_rewrite include those below.</p> <dl> <dt><code>API_VERSION</code></dt> <dd>This is the version of the Apache httpd module API (the internal interface between server and module) in the current httpd build, as defined in include/ap_mmn.h. The module API version corresponds to the version of Apache httpd in use (in the release version of Apache httpd 1.3.14, for instance, it is 19990320:10), but is mainly of interest to module authors.</dd> <dt><code>CONN_REMOTE_ADDR</code></dt> <dd>Since 2.4.8: The peer IP address of the connection (see the <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> module).</dd> <dt><code>HTTPS</code></dt> <dd>Will contain the text \"on\" if the connection is using SSL/TLS, or \"off\" otherwise. (This variable can be safely used regardless of whether or not <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is loaded).</dd> <dt><code>IS_SUBREQ</code></dt> <dd>Will contain the text \"true\" if the request currently being processed is a sub-request, \"false\" otherwise. Sub-requests may be generated by modules that need to resolve additional files or URIs in order to complete their tasks.</dd> <dt><code>REMOTE_ADDR</code></dt> <dd>The IP address of the remote host (see the <code class=\"module\"><a href=\"mod_remoteip\">mod_remoteip</a></code> module).</dd> <dt><code>REQUEST_FILENAME</code></dt> <dd>The full local filesystem path to the file or script matching the request, if this has already been determined by the server at the time <code>REQUEST_FILENAME</code> is referenced. Otherwise, such as when used in virtual host context, the same value as <code>REQUEST_URI</code>. Depending on the value of <code class=\"directive\"><a href=\"core#acceptpathinfo\">AcceptPathInfo</a></code>, the server may have only used some leading components of the <code>REQUEST_URI</code> to map the request to a file. </dd> <dt><code>REQUEST_SCHEME</code></dt> <dd>Will contain the scheme of the request (usually \"http\" or \"https\"). This value can be influenced with <code class=\"directive\"><a href=\"core#servername\">ServerName</a></code>.</dd> <dt><code>REQUEST_URI</code></dt> <dd>The path component of the requested URI, such as \"/index.html\". This notably excludes the query string which is available as its own variable named <code>QUERY_STRING</code>.</dd> <dt><code>THE_REQUEST</code></dt> <dd>The full HTTP request line sent by the browser to the server (e.g., \"<code>GET /index.html HTTP/1.1</code>\"). This does not include any additional headers sent by the browser. This value has not been unescaped (decoded), unlike most other variables below.</dd> </dl> </li> </ul> <p>If the <em>TestString</em> has the special value <code>expr</code>, the <em>CondPattern</em> will be treated as an <a href=\"../expr\">ap_expr</a>. HTTP headers referenced in the expression will be added to the Vary header if the <code>novary</code> flag is not given.</p> <p>Other things you should be aware of:</p> <ol> <li> <p>The variables SCRIPT_FILENAME and REQUEST_FILENAME contain the same value - the value of the <code>filename</code> field of the internal <code>request_rec</code> structure of the Apache HTTP Server. The first name is the commonly known CGI variable name while the second is the appropriate counterpart of REQUEST_URI (which contains the value of the <code>uri</code> field of <code>request_rec</code>).</p> <p>If a substitution occurred and the rewriting continues, the value of both variables will be updated accordingly.</p> <p>If used in per-server context (<em>i.e.</em>, before the request is mapped to the filesystem) SCRIPT_FILENAME and REQUEST_FILENAME cannot contain the full local filesystem path since the path is unknown at this stage of processing. Both variables will initially contain the value of REQUEST_URI in that case. In order to obtain the full local filesystem path of the request in per-server context, use an URL-based look-ahead <code>%{LA-U:REQUEST_FILENAME}</code> to determine the final value of REQUEST_FILENAME.</p>\n</li> <li> <code>%{ENV:variable}</code>, where <em>variable</em> can be any environment variable, is also available. This is looked-up via internal Apache httpd structures and (if not found there) via <code>getenv()</code> from the Apache httpd server process.</li> <li> <code>%{SSL:variable}</code>, where <em>variable</em> is the name of an <a href=\"mod_ssl#envvars\">SSL environment variable</a>, can be used whether or not <code class=\"module\"><a href=\"mod_ssl\">mod_ssl</a></code> is loaded, but will always expand to the empty string if it is not. Example: <code>%{SSL:SSL_CIPHER_USEKEYSIZE}</code> may expand to <code>128</code>. These variables are available even without setting the <code>StdEnvVars</code> option of the <code class=\"directive\"><a href=\"mod_ssl#ssloptions\">SSLOptions</a></code> directive.</li> <li> <code>%{HTTP:header}</code>, where <em>header</em> can be any HTTP MIME-header name, can always be used to obtain the value of a header sent in the HTTP request. Example: <code>%{HTTP:Proxy-Connection}</code> is the value of the HTTP header ``<code>Proxy-Connection:</code>''. <p>If a HTTP header is used in a condition this header is added to the Vary header of the response in case the condition evaluates to true for the request. It is <strong>not</strong> added if the condition evaluates to false for the request. Adding the HTTP header to the Vary header of the response is needed for proper caching.</p> <p>It has to be kept in mind that conditions follow a short circuit logic in the case of the '<strong><code>ornext|OR</code></strong>' flag so that certain conditions might not be evaluated at all.</p>\n</li> <li> <a id=\"LA-U\" name=\"LA-U\"><code>%{LA-U:variable}</code></a> can be used for look-aheads which perform an internal (URL-based) sub-request to determine the final value of <em>variable</em>. This can be used to access variable for rewriting which is not available at the current stage, but will be set in a later phase. <p>For instance, to rewrite according to the <code>REMOTE_USER</code> variable from within the per-server context (<code>httpd.conf</code> file) you must use <code>%{LA-U:REMOTE_USER}</code> - this variable is set by the authorization phases, which come <em>after</em> the URL translation phase (during which mod_rewrite operates).</p> <p>On the other hand, because mod_rewrite implements its per-directory context (<code>.htaccess</code> file) via the Fixup phase of the API and because the authorization phases come <em>before</em> this phase, you just can use <code>%{REMOTE_USER}</code> in that context.</p>\n</li> <li> <code>%{LA-F:variable}</code> can be used to perform an internal (filename-based) sub-request, to determine the final value of <em>variable</em>. Most of the time, this is the same as LA-U above.</li> </ol> <p><em>CondPattern</em> is the condition pattern, a regular expression which is applied to the current instance of the <em>TestString</em>. <em>TestString</em> is first evaluated, before being matched against <em>CondPattern</em>.</p> <p><em>CondPattern</em> is usually a <em>perl compatible regular expression</em>, but there is additional syntax available to perform other useful tests against the <em>Teststring</em>:</p> <ol> <li>You can prefix the pattern string with a '<code>!</code>' character (exclamation mark) to negate the result of the condition, no matter what kind of <em>CondPattern</em> is used. </li> <li> You can perform lexicographical string comparisons: <dl> <dt><strong>&lt;CondPattern</strong></dt> <dd>Lexicographically precedes<br> Treats the <em>CondPattern</em> as a plain string and compares it lexicographically to <em>TestString</em>. True if <em>TestString</em> lexicographically precedes <em>CondPattern</em>.</dd> <dt><strong>&gt;CondPattern</strong></dt> <dd>Lexicographically follows<br> Treats the <em>CondPattern</em> as a plain string and compares it lexicographically to <em>TestString</em>. True if <em>TestString</em> lexicographically follows <em>CondPattern</em>.</dd> <dt><strong>=CondPattern</strong></dt> <dd>Lexicographically equal<br> Treats the <em>CondPattern</em> as a plain string and compares it lexicographically to <em>TestString</em>. True if <em>TestString</em> is lexicographically equal to <em>CondPattern</em> (the two strings are exactly equal, character for character). If <em>CondPattern</em> is <code>\"\"</code> (two quotation marks) this compares <em>TestString</em> to the empty string.</dd> <dt><strong>&lt;=CondPattern</strong></dt> <dd>Lexicographically less than or equal to<br> Treats the <em>CondPattern</em> as a plain string and compares it lexicographically to <em>TestString</em>. True if <em>TestString</em> lexicographically precedes <em>CondPattern</em>, or is equal to <em>CondPattern</em> (the two strings are equal, character for character).</dd> <dt><strong>&gt;=CondPattern</strong></dt> <dd>Lexicographically greater than or equal to<br> Treats the <em>CondPattern</em> as a plain string and compares it lexicographically to <em>TestString</em>. True if <em>TestString</em> lexicographically follows <em>CondPattern</em>, or is equal to <em>CondPattern</em> (the two strings are equal, character for character).</dd> </dl> </li> <li> You can perform integer comparisons: <dl> <dt><strong>-eq</strong></dt> <dd>Is numerically <strong>eq</strong>ual to<br> The <em>TestString</em> is treated as an integer, and is numerically compared to the <em>CondPattern</em>. True if the two are numerically equal.</dd> <dt><strong>-ge</strong></dt> <dd>Is numerically <strong>g</strong>reater than or <strong>e</strong>qual to<br> The <em>TestString</em> is treated as an integer, and is numerically compared to the <em>CondPattern</em>. True if the <em>TestString</em> is numerically greater than or equal to the <em>CondPattern</em>.</dd> <dt><strong>-gt</strong></dt> <dd>Is numerically <strong>g</strong>reater <strong>t</strong>han<br> The <em>TestString</em> is treated as an integer, and is numerically compared to the <em>CondPattern</em>. True if the <em>TestString</em> is numerically greater than the <em>CondPattern</em>.</dd> <dt><strong>-le</strong></dt> <dd>Is numerically <strong>l</strong>ess than or <strong>e</strong>qual to<br> The <em>TestString</em> is treated as an integer, and is numerically compared to the <em>CondPattern</em>. True if the <em>TestString</em> is numerically less than or equal to the <em>CondPattern</em>. Avoid confusion with the <strong>-l</strong> by using the <strong>-L</strong> or <strong>-h</strong> variant.</dd> <dt><strong>-lt</strong></dt> <dd>Is numerically <strong>l</strong>ess <strong>t</strong>han<br> The <em>TestString</em> is treated as an integer, and is numerically compared to the <em>CondPattern</em>. True if the <em>TestString</em> is numerically less than the <em>CondPattern</em>. Avoid confusion with the <strong>-l</strong> by using the <strong>-L</strong> or <strong>-h</strong> variant.</dd> <dt><strong>-ne</strong></dt> <dd>Is numerically <strong>n</strong>ot <strong>e</strong>qual to<br> The <em>TestString</em> is treated as an integer, and is numerically compared to the <em>CondPattern</em>. True if the two are numerically different. This is equivalent to <code>!-eq</code>.</dd> </dl> </li> <li>You can perform various file attribute tests: <dl> <dt><strong>-d</strong></dt> <dd>Is <strong>d</strong>irectory.<br> Treats the <em>TestString</em> as a pathname and tests whether or not it exists, and is a directory. </dd> <dt><strong>-f</strong></dt> <dd>Is regular <strong>f</strong>ile.<br> Treats the <em>TestString</em> as a pathname and tests whether or not it exists, and is a regular file. </dd> <dt><strong>-F</strong></dt> <dd>Is existing file, via subrequest.<br> Checks whether or not <em>TestString</em> is a valid file, accessible via all the server's currently-configured access controls for that path. This uses an internal subrequest to do the check, so use it with care - it can impact your server's performance! </dd> <dt><strong>-h</strong></dt> <dd>Is symbolic link, bash convention.<br> See <strong>-l</strong>. </dd> <dt><strong>-l</strong></dt> <dd>Is symbolic <strong>l</strong>ink.<br> Treats the <em>TestString</em> as a pathname and tests whether or not it exists, and is a symbolic link. May also use the bash convention of <strong>-L</strong> or <strong>-h</strong> if there's a possibility of confusion such as when using the <strong>-lt</strong> or <strong>-le</strong> tests. </dd> <dt><strong>-L</strong></dt> <dd>Is symbolic link, bash convention.<br> See <strong>-l</strong>.</dd> <dt><strong>-s</strong></dt> <dd>Is regular file, with <strong>s</strong>ize.<br> Treats the <em>TestString</em> as a pathname and tests whether or not it exists, and is a regular file with size greater than zero.</dd> <dt><strong>-U</strong></dt> <dd>\n<p>Is existing URL, via subrequest.<br> Checks whether or not <em>TestString</em> is a valid URL, accessible via all the server's currently-configured access controls for that path. This uses an internal subrequest to do the check, so use it with care - it can impact your server's performance!</p> <p> This flag <em>only</em> returns information about things like access control, authentication, and authorization. This flag <em>does not</em> return information about the status code the configured handler (static file, CGI, proxy, etc.) would have returned.</p> </dd> <dt><strong>-x</strong></dt> <dd>Has e<strong>x</strong>ecutable permissions.<br> Treats the <em>TestString</em> as a pathname and tests whether or not it exists, and has executable permissions. These permissions are determined according to the underlying OS.</dd> </dl> For example: <pre class=\"prettyprint lang-config\">RewriteCond /var/www/%{REQUEST_URI} !-f\nRewriteRule ^(.+) /other/archive/$1 [R]</pre> </li> <li> <p>If the <em>TestString</em> has the special value <code>expr</code>, the <em>CondPattern</em> will be treated as an <a href=\"../expr\">ap_expr</a>.</p> <p> In the below example, <code>-strmatch</code> is used to compare the <code>REFERER</code> against the site hostname, to block unwanted hotlinking. </p> <pre class=\"prettyprint lang-config\">RewriteCond expr \"! %{HTTP_REFERER} -strmatch '*://%{HTTP_HOST}/*'\"\nRewriteRule \"^/images\" \"-\" [F]</pre> </li> <li>You can also set special flags for <em>CondPattern</em> by appending <strong><code>[</code><em>flags</em><code>]</code></strong> as the third argument to the <code>RewriteCond</code> directive, where <em>flags</em> is a comma-separated list of any of the following flags: <ul> <li>'<strong><code>nocase|NC</code></strong>' (<strong>n</strong>o <strong>c</strong>ase)<br> This makes the test case-insensitive - differences between 'A-Z' and 'a-z' are ignored, both in the expanded <em>TestString</em> and the <em>CondPattern</em>. This flag is effective only for comparisons between <em>TestString</em> and <em>CondPattern</em>. It has no effect on filesystem and subrequest checks.</li> <li> '<strong><code>ornext|OR</code></strong>' (<strong>or</strong> next condition)<br> Use this to combine rule conditions with a local OR instead of the implicit AND. Typical example: <pre class=\"prettyprint lang-config\">RewriteCond \"%{REMOTE_HOST}\"  \"^host1\"  [OR]\nRewriteCond \"%{REMOTE_HOST}\"  \"^host2\"  [OR]\nRewriteCond \"%{REMOTE_HOST}\"  \"^host3\"\nRewriteRule ...some special stuff for any of these hosts...</pre> Without this flag you would have to write the condition/rule pair three times. </li> <li>'<strong><code>novary|NV</code></strong>' (<strong>n</strong>o <strong>v</strong>ary)<br> If a HTTP header is used in the condition, this flag prevents this header from being added to the Vary header of the response. <br> Using this flag might break proper caching of the response if the representation of this response varies on the value of this header. So this flag should be only used if the meaning of the Vary header is well understood. </li> </ul> </li> </ol> <p><strong>Example:</strong></p> <p>To rewrite the Homepage of a site according to the ``<code>User-Agent:</code>'' header of the request, you can use the following: </p> <pre class=\"prettyprint lang-config\">RewriteCond  \"%{HTTP_USER_AGENT}\"  \"(iPhone|Blackberry|Android)\"\nRewriteRule  \"^/$\"                 \"/homepage.mobile.html\"  [L]\n\nRewriteRule  \"^/$\"                 \"/homepage.std.html\"     [L]</pre> <p>Explanation: If you use a browser which identifies itself as a mobile browser (note that the example is incomplete, as there are many other mobile platforms), the mobile version of the homepage is served. Otherwise, the standard page is served. </p> </div>  <div class=\"directive-section\">\n<h2 id=\"rewriteengine\">RewriteEngine Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Enables or disables runtime rewriting engine</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RewriteEngine on|off</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>RewriteEngine off</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_rewrite</td>\n</tr> </table> <p>The <code class=\"directive\">RewriteEngine</code> directive enables or disables the runtime rewriting engine. If it is set to <code>off</code> this module does no runtime processing at all. It does not even update the <code>SCRIPT_URx</code> environment variables.</p> <p>Use this directive to disable rules in a particular context, rather than commenting out all the <code class=\"directive\"><a href=\"#rewriterule\">RewriteRule</a></code> directives.</p> <p>Note that rewrite configurations are not inherited by virtual hosts. This means that you need to have a <code>RewriteEngine on</code> directive for each virtual host in which you wish to use rewrite rules.</p> <p><code class=\"directive\"><a href=\"#rewritemap\">RewriteMap</a></code> directives of the type <code>prg</code> are not started during server initialization if they're defined in a context that does not have <code class=\"directive\">RewriteEngine</code> set to <code>on</code></p> </div>  <div class=\"directive-section\">\n<h2 id=\"rewritemap\">RewriteMap Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Defines a mapping function for key-lookup</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RewriteMap MapName MapType:MapSource</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_rewrite</td>\n</tr> </table> <p>The <code class=\"directive\">RewriteMap</code> directive defines a <em>Rewriting Map</em> which can be used inside rule substitution strings by the mapping-functions to insert/substitute fields through a key lookup. The source of this lookup can be of various types.</p> <p>The <a id=\"mapfunc\" name=\"mapfunc\"><em>MapName</em></a> is the name of the map and will be used to specify a mapping-function for the substitution strings of a rewriting rule via one of the following constructs:</p> <p class=\"indent\"> <strong><code>${</code> <em>MapName</em> <code>:</code> <em>LookupKey</em> <code>}</code><br> <code>${</code> <em>MapName</em> <code>:</code> <em>LookupKey</em> <code>|</code> <em>DefaultValue</em> <code>}</code></strong> </p> <p>When such a construct occurs, the map <em>MapName</em> is consulted and the key <em>LookupKey</em> is looked-up. If the key is found, the map-function construct is substituted by <em>SubstValue</em>. If the key is not found then it is substituted by <em>DefaultValue</em> or by the empty string if no <em>DefaultValue</em> was specified. Empty values behave as if the key was absent, therefore it is not possible to distinguish between empty-valued keys and absent keys.</p> <p>For example, you might define a <code class=\"directive\">RewriteMap</code> as:</p> <pre class=\"prettyprint lang-config\">RewriteMap examplemap \"txt:/path/to/file/map.txt\"</pre> <p>You would then be able to use this map in a <code class=\"directive\">RewriteRule</code> as follows:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"^/ex/(.*)\" \"${examplemap:$1}\"</pre> <p>The following combinations for <em>MapType</em> and <em>MapSource</em> can be used:</p> <dl> <dt>txt</dt> <dd>A plain text file containing space-separated key-value pairs, one per line. (<a href=\"../rewrite/rewritemap#txt\">Details ...</a>)</dd> <dt>rnd</dt> <dd>Randomly selects an entry from a plain text file (<a href=\"../rewrite/rewritemap#rnd\">Details ...</a>)</dd> <dt>dbm</dt> <dd>Looks up an entry in a dbm file containing name, value pairs. Hash is constructed from a plain text file format using the <code><a href=\"../programs/httxt2dbm\">httxt2dbm</a></code> utility. (<a href=\"../rewrite/rewritemap#dbm\">Details ...</a>)</dd> <dt>int</dt> <dd>One of the four available internal functions provided by <code>RewriteMap</code>: toupper, tolower, escape or unescape. (<a href=\"../rewrite/rewritemap#int\">Details ...</a>)</dd> <dt>prg</dt> <dd>Calls an external program or script to process the rewriting. (<a href=\"../rewrite/rewritemap#prg\">Details ...</a>)</dd> <dt>dbd or fastdbd</dt> <dd>A SQL SELECT statement to be performed to look up the rewrite target. (<a href=\"../rewrite/rewritemap#dbd\">Details ...</a>)</dd> </dl> <p>Further details, and numerous examples, may be found in the <a href=\"../rewrite/rewritemap\">RewriteMap HowTo</a></p> </div>  <div class=\"directive-section\">\n<h2 id=\"rewriteoptions\">RewriteOptions Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Sets some special options for the rewrite engine</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RewriteOptions Options</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_rewrite</td>\n</tr> </table> <p>The <code class=\"directive\">RewriteOptions</code> directive sets some special options for the current per-server or per-directory configuration. The <em>Option</em> string can currently only be one of the following:</p> <dl> <dt><code>Inherit</code></dt> <dd> <p>This forces the current configuration to inherit the configuration of the parent. In per-virtual-server context, this means that the maps, conditions and rules of the main server are inherited. In per-directory context this means that conditions and rules of the parent directory's <code>.htaccess</code> configuration or <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> sections are inherited. The inherited rules are virtually copied to the section where this directive is being used. If used in combination with local rules, the inherited rules are copied behind the local rules. The position of this directive - below or above of local rules - has no influence on this behavior. If local rules forced the rewriting to stop, the inherited rules won't be processed.</p> <div class=\"warning\"> Rules inherited from the parent scope are applied <strong>after</strong> rules specified in the child scope. </div> </dd> <dt><code>InheritBefore</code></dt> <dd> <p> Like <code>Inherit</code> above, but the rules from the parent scope are applied <strong>before</strong> rules specified in the child scope.<br> Available in Apache HTTP Server 2.3.10 and later.</p> </dd> <dt><code>InheritDown</code></dt> <dd> <p>If this option is enabled, all child configurations will inherit the configuration of the current configuration. It is equivalent to specifying <code>RewriteOptions Inherit</code> in all child configurations. See the <code>Inherit</code> option for more details on how the parent-child relationships are handled.<br> Available in Apache HTTP Server 2.4.8 and later.</p> </dd> <dt><code>InheritDownBefore</code></dt> <dd> <p>Like <code>InheritDown</code> above, but the rules from the current scope are applied <strong>before</strong> rules specified in any child's scope.<br> Available in Apache HTTP Server 2.4.8 and later.</p> </dd> <dt><code>IgnoreInherit</code></dt> <dd> <p>This option forces the current and child configurations to ignore all rules that would be inherited from a parent specifying <code>InheritDown</code> or <code>InheritDownBefore</code>.<br> Available in Apache HTTP Server 2.4.8 and later.</p> </dd> <dt><code>AllowNoSlash</code></dt> <dd> <p>By default, <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> will ignore URLs that map to a directory on disk but lack a trailing slash, in the expectation that the <code class=\"module\"><a href=\"mod_dir\">mod_dir</a></code> module will issue the client with a redirect to the canonical URL with a trailing slash.</p> <p>When the <code class=\"directive\"><a href=\"mod_dir#directoryslash\">DirectorySlash</a></code> directive is set to off, the <code>AllowNoSlash</code> option can be enabled to ensure that rewrite rules are no longer ignored. This option makes it possible to apply rewrite rules within .htaccess files that match the directory without a trailing slash, if so desired.<br> Available in Apache HTTP Server 2.4.0 and later.</p> </dd> <dt><code>AllowAnyURI</code></dt> <dd> <p>When <code class=\"directive\"><a href=\"#rewriterule\">RewriteRule</a></code> is used in <code>VirtualHost</code> or server context with version 2.2.22 or later of httpd, <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> will only process the rewrite rules if the request URI is a URL-path. This avoids some security issues where particular rules could allow \"surprising\" pattern expansions (see <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3368\">CVE-2011-3368</a> and <a href=\"http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4317\">CVE-2011-4317</a>). To lift the restriction on matching a URL-path, the <code>AllowAnyURI</code> option can be enabled, and <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> will apply the rule set to any request URI string, regardless of whether that string matches the URL-path grammar required by the HTTP specification.<br> Available in Apache HTTP Server 2.4.3 and later.</p> <div class=\"warning\"> <p><strong>Security Warning</strong></p> <p>Enabling this option will make the server vulnerable to security issues if used with rewrite rules which are not carefully authored. It is <strong>strongly recommended</strong> that this option is not used. In particular, beware of input strings containing the '<code>@</code>' character which could change the interpretation of the transformed URI, as per the above CVE names.</p> </div> </dd> <dt><code>MergeBase</code></dt> <dd> <p>With this option, the value of <code class=\"directive\"><a href=\"#rewritebase\">RewriteBase</a></code> is copied from where it's explicitly defined into any sub-directory or sub-location that doesn't define its own <code class=\"directive\"><a href=\"#rewritebase\">RewriteBase</a></code>. This was the default behavior in 2.4.0 through 2.4.3, and the flag to restore it is available Apache HTTP Server 2.4.4 and later.</p> </dd> <dt><code>IgnoreContextInfo</code></dt> <dd> <p>When a relative substitution is made in directory (htaccess) context and <code class=\"directive\"><a href=\"#rewritebase\">RewriteBase</a></code> has not been set, this module uses some extended URL and filesystem context information to change the relative substitution back into a URL. Modules such as <code class=\"module\"><a href=\"mod_userdir\">mod_userdir</a></code> and <code class=\"module\"><a href=\"mod_alias\">mod_alias</a></code> supply this extended context info. Available in 2.4.16 and later.</p> </dd> </dl> </div>  <div class=\"directive-section\">\n<h2 id=\"rewriterule\">RewriteRule Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Defines rules for the rewriting engine</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>RewriteRule Pattern Substitution [flags]</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host, directory, .htaccess</td>\n</tr> <tr>\n<th>Override:</th>\n<td>FileInfo</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_rewrite</td>\n</tr> </table> <p>The <code class=\"directive\">RewriteRule</code> directive is the real rewriting workhorse. The directive can occur more than once, with each instance defining a single rewrite rule. The order in which these rules are defined is important - this is the order in which they will be applied at run-time.</p> <p><a id=\"patterns\" name=\"patterns\"><em>Pattern</em></a> is a perl compatible <a id=\"regexp\" name=\"regexp\">regular expression</a>. On the first RewriteRule, it is matched against the (%-decoded) URL-path of the request, or, in per-directory context (see below), the URL path relative to that per-directory context. Subsequent patterns are matched against the output of the last matching RewriteRule.</p> <div class=\"note\">\n<p><strong><a id=\"what_is_matched\" name=\"what_is_matched\">What is matched?</a></strong></p> <p>In <code class=\"directive\"><a href=\"core#virtualhost\">VirtualHost</a></code> context, The <em>Pattern</em> will initially be matched against the part of the URL after the hostname and port, and before the query string (e.g. \"/app1/index.html\").</p> <p>In <code class=\"directive\"><a href=\"core#directory\">Directory</a></code> and htaccess context, the <em>Pattern</em> will initially be matched against the <em>filesystem</em> path, after removing the prefix that led the server to the current <code class=\"directive\">RewriteRule</code> (e.g. \"app1/index.html\" or \"index.html\" depending on where the directives are defined).</p> <p>If you wish to match against the hostname, port, or query string, use a <code class=\"directive\"><a href=\"#rewritecond\">RewriteCond</a></code> with the <code>%{HTTP_HOST}</code>, <code>%{SERVER_PORT}</code>, or <code>%{QUERY_STRING}</code> variables respectively.</p> <p>In any case, remember that regular expressions are substring matches. That is, you don't need the regex to describe the entire string, just the part that you wish to match. Thus, using a regex of <code>.</code> is often sufficient rather than <code>.*</code>, and the regex <code>abc</code> is <strong>not</strong> the same as <code>^abc$</code>.</p> </div> <div class=\"note\">\n<p><strong>Per-directory Rewrites</strong></p> <ul> <li>The rewrite engine may be used in <a href=\"../howto/htaccess\">.htaccess</a> files and in <code class=\"directive\"><a href=\"core#directory\">&lt;Directory&gt;</a></code> sections, with some additional complexity.</li> <li>To enable the rewrite engine in this context, you need to set \"<code>RewriteEngine On</code>\" <strong>and</strong> \"<code>Options FollowSymLinks</code>\" must be enabled. If your administrator has disabled override of <code>FollowSymLinks</code> for a user's directory, then you cannot use the rewrite engine. This restriction is required for security reasons.</li> <li>When using the rewrite engine in <code>.htaccess</code> files the per-directory prefix (which always is the same for a specific directory) is automatically <em>removed</em> for the RewriteRule pattern matching and automatically <em>added</em> after any relative (not starting with a slash or protocol name) substitution encounters the end of a rule set. See the <code class=\"directive\"><a href=\"#rewritebase\">RewriteBase</a></code> directive for more information regarding what prefix will be added back to relative substitutions.</li> <li> If you wish to match against the full URL-path in a per-directory (htaccess) RewriteRule, use the <code>%{REQUEST_URI}</code> variable in a <code class=\"directive\"><a href=\"#rewritecond\">RewriteCond</a></code>.</li> <li>The removed prefix always ends with a slash, meaning the matching occurs against a string which <em>never</em> has a leading slash. Therefore, a <em>Pattern</em> with <code>^/</code> never matches in per-directory context.</li> <li>Although rewrite rules are syntactically permitted in <code class=\"directive\"><a href=\"core#location\">&lt;Location&gt;</a></code> and <code class=\"directive\"><a href=\"core#files\">&lt;Files&gt;</a></code> sections (including their regular expression counterparts), this should never be necessary and is unsupported. A likely feature to break in these contexts is relative substitutions.</li> </ul> </div> <p>For some hints on <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#regex\" title=\"see glossary\">regular expressions</a>, see the <a href=\"../rewrite/intro#regex\">mod_rewrite Introduction</a>.</p> <p>In mod_rewrite, the NOT character ('<code>!</code>') is also available as a possible pattern prefix. This enables you to negate a pattern; to say, for instance: ``<em>if the current URL does <strong>NOT</strong> match this pattern</em>''. This can be used for exceptional cases, where it is easier to match the negative pattern, or as a last default rule.</p> <div class=\"note\">\n<p><strong>Note</strong></p> When using the NOT character to negate a pattern, you cannot include grouped wildcard parts in that pattern. This is because, when the pattern does NOT match (ie, the negation matches), there are no contents for the groups. Thus, if negated patterns are used, you cannot use <code>$N</code> in the substitution string! </div> <p>The <a id=\"rhs\" name=\"rhs\"><em>Substitution</em></a> of a rewrite rule is the string that replaces the original URL-path that was matched by <em>Pattern</em>. The <em>Substitution</em> may be a:</p> <dl> <dt>file-system path</dt> <dd>Designates the location on the file-system of the resource to be delivered to the client. Substitutions are only treated as a file-system path when the rule is configured in server (virtualhost) context and the first component of the path in the substitution exists in the file-system</dd> <dt>URL-path</dt> <dd>A <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code>-relative path to the resource to be served. Note that <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> tries to guess whether you have specified a file-system path or a URL-path by checking to see if the first segment of the path exists at the root of the file-system. For example, if you specify a <em>Substitution</em> string of <code>/www/file.html</code>, then this will be treated as a URL-path <em>unless</em> a directory named <code>www</code> exists at the root or your file-system (or, in the case of using rewrites in a <code>.htaccess</code> file, relative to your document root), in which case it will be treated as a file-system path. If you wish other URL-mapping directives (such as <code class=\"directive\"><a href=\"mod_alias#alias\">Alias</a></code>) to be applied to the resulting URL-path, use the <code>[PT]</code> flag as described below.</dd> <dt>Absolute URL</dt> <dd>If an absolute URL is specified, <code class=\"module\"><a href=\"mod_rewrite\">mod_rewrite</a></code> checks to see whether the hostname matches the current host. If it does, the scheme and hostname are stripped out and the resulting path is treated as a URL-path. Otherwise, an external redirect is performed for the given URL. To force an external redirect back to the current host, see the <code>[R]</code> flag below.</dd> <dt>\n<code>-</code> (dash)</dt> <dd>A dash indicates that no substitution should be performed (the existing path is passed through untouched). This is used when a flag (see below) needs to be applied without changing the path.</dd> </dl> <p>In addition to plain text, the <em>Substitution</em> string can include</p> <ol> <li>back-references (<code>$N</code>) to the RewriteRule pattern</li> <li>back-references (<code>%N</code>) to the last matched RewriteCond pattern</li> <li>server-variables as in rule condition test-strings (<code>%{VARNAME}</code>)</li> <li>\n<a href=\"#mapfunc\">mapping-function</a> calls (<code>${mapname:key|default}</code>)</li> </ol> <p>Back-references are identifiers of the form <code>$</code><strong>N</strong> (<strong>N</strong>=0..9), which will be replaced by the contents of the <strong>N</strong>th group of the matched <em>Pattern</em>. The server-variables are the same as for the <em>TestString</em> of a <code class=\"directive\"><a href=\"#rewritecond\">RewriteCond</a></code> directive. The mapping-functions come from the <code class=\"directive\"><a href=\"#rewritemap\">RewriteMap</a></code> directive and are explained there. These three types of variables are expanded in the order above.</p> <p>Rewrite rules are applied to the results of previous rewrite rules, in the order in which they are defined in the config file. The URL-path or file-system path (see <a href=\"#what_is_matched\">\"What is matched?\"</a>, above) is <strong>completely replaced</strong> by the <em>Substitution</em> and the rewriting process continues until all rules have been applied, or it is explicitly terminated by an <a href=\"../rewrite/flags#flag_l\"><code>L</code> flag</a>, or other flag which implies immediate termination, such as <code>END</code> or <code>F</code>.</p> <div class=\"note\">\n<p><strong>Modifying the Query String</strong></p> <p>By default, the query string is passed through unchanged. You can, however, create URLs in the substitution string containing a query string part. Simply use a question mark inside the substitution string to indicate that the following text should be re-injected into the query string. When you want to erase an existing query string, end the substitution string with just a question mark. To combine new and old query strings, use the <code>[QSA]</code> flag.</p> </div> <p>Additionally you can set special <a name=\"rewriteflags\" id=\"rewriteflags\">actions</a> to be performed by appending <strong><code>[</code><em>flags</em><code>]</code></strong> as the third argument to the <code class=\"directive\">RewriteRule</code> directive. <em>Flags</em> is a comma-separated list, surround by square brackets, of any of the flags in the following table. More details, and examples, for each flag, are available in the <a href=\"../rewrite/flags\">Rewrite Flags document</a>.</p> <table class=\"bordered\">\n<tr class=\"header\">\n<th>Flag and syntax</th> <th>Function</th> </tr> <tr> <td>B</td> <td>Escape non-alphanumeric characters in backreferences <em>before</em> applying the transformation. <em><a href=\"../rewrite/flags#flag_b\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>backrefnoplus|BNP</td> <td>If backreferences are being escaped, spaces should be escaped to %20 instead of +. Useful when the backreference will be used in the path component rather than the query string.<em><a href=\"../rewrite/flags#flag_bnp\">details ...</a></em>\n</td> </tr> <tr> <td>chain|C</td> <td>Rule is chained to the following rule. If the rule fails, the rule(s) chained to it will be skipped. <em><a href=\"../rewrite/flags#flag_c\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>cookie|CO=<em>NAME</em>:<em>VAL</em>\n</td> <td>Sets a cookie in the client browser. Full syntax is: CO=<em>NAME</em>:<em>VAL</em>:<em>domain</em>[:<em>lifetime</em>[:<em>path</em>[:<em>secure</em>[:<em>httponly</em>]]]] <em><a href=\"../rewrite/flags#flag_co\">details ...</a></em> </td> </tr> <tr> <td>discardpath|DPI</td> <td>Causes the PATH_INFO portion of the rewritten URI to be discarded. <em><a href=\"../rewrite/flags#flag_dpi\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>END</td> <td>Stop the rewriting process immediately and don't apply any more rules. Also prevents further execution of rewrite rules in per-directory and .htaccess context. (Available in 2.3.9 and later) <em><a href=\"../rewrite/flags#flag_end\">details ...</a></em>\n</td> </tr> <tr> <td>env|E=[!]<em>VAR</em>[:<em>VAL</em>]</td> <td>Causes an environment variable <em>VAR</em> to be set (to the value <em>VAL</em> if provided). The form !<em>VAR</em> causes the environment variable <em>VAR</em> to be unset. <em><a href=\"../rewrite/flags#flag_e\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>forbidden|F</td> <td>Returns a 403 FORBIDDEN response to the client browser. <em><a href=\"../rewrite/flags#flag_f\">details ...</a></em>\n</td> </tr> <tr> <td>gone|G</td> <td>Returns a 410 GONE response to the client browser. <em><a href=\"../rewrite/flags#flag_g\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>Handler|H=<em>Content-handler</em>\n</td> <td>Causes the resulting URI to be sent to the specified <em>Content-handler</em> for processing. <em><a href=\"../rewrite/flags#flag_h\">details ...</a></em>\n</td> </tr> <tr> <td>last|L</td> <td>Stop the rewriting process immediately and don't apply any more rules. Especially note caveats for per-directory and .htaccess context (see also the END flag). <em><a href=\"../rewrite/flags#flag_l\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>next|N</td> <td>Re-run the rewriting process, starting again with the first rule, using the result of the ruleset so far as a starting point. <em><a href=\"../rewrite/flags#flag_n\">details ...</a></em>\n</td> </tr> <tr> <td>nocase|NC</td> <td>Makes the pattern comparison case-insensitive. <em><a href=\"../rewrite/flags#flag_nc\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>noescape|NE</td> <td>Prevent mod_rewrite from applying hexcode escaping of special characters in the result of the rewrite. <em><a href=\"../rewrite/flags#flag_ne\">details ...</a></em>\n</td> </tr> <tr> <td>nosubreq|NS</td> <td>Causes a rule to be skipped if the current request is an internal sub-request. <em><a href=\"../rewrite/flags#flag_ns\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>proxy|P</td> <td>Force the substitution URL to be internally sent as a proxy request. <em><a href=\"../rewrite/flags#flag_p\">details ...</a></em>\n</td> </tr> <tr> <td>passthrough|PT</td> <td>Forces the resulting URI to be passed back to the URL mapping engine for processing of other URI-to-filename translators, such as <code>Alias</code> or <code>Redirect</code>. <em><a href=\"../rewrite/flags#flag_pt\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>qsappend|QSA</td> <td>Appends any query string from the original request URL to any query string created in the rewrite target.<em><a href=\"../rewrite/flags#flag_qsa\">details ...</a></em>\n</td> </tr> <tr> <td>qsdiscard|QSD</td> <td>Discard any query string attached to the incoming URI. <em><a href=\"../rewrite/flags#flag_qsd\">details ...</a></em>\n</td> </tr> <tr class=\"odd\"> <td>qslast|QSL</td> <td>Interpret the last (right-most) question mark as the query string delimeter, instead of the first (left-most) as normally used. Available in 2.4.19 and later. <em><a href=\"../rewrite/flags#flag_qsl\">details ...</a></em>\n</td> </tr> <tr> <td>redirect|R[=<em>code</em>]</td> <td>Forces an external redirect, optionally with the specified HTTP status code. <em><a href=\"../rewrite/flags#flag_r\">details ...</a></em> </td> </tr> <tr class=\"odd\"> <td>skip|S=<em>num</em>\n</td> <td>Tells the rewriting engine to skip the next <em>num</em> rules if the current rule matches. <em><a href=\"../rewrite/flags#flag_s\">details ...</a></em>\n</td> </tr> <tr> <td>type|T=<em>MIME-type</em>\n</td> <td>Force the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#mime-type\" title=\"see glossary\">MIME-type</a> of the target file to be the specified type. <em><a href=\"../rewrite/flags#flag_t\">details ...</a></em>\n</td> </tr> </table> <div class=\"note\">\n<p><strong>Home directory expansion</strong></p> <p> When the substitution string begins with a string resembling \"/~user\" (via explicit text or backreferences), mod_rewrite performs home directory expansion independent of the presence or configuration of <code class=\"module\"><a href=\"mod_userdir\">mod_userdir</a></code>.</p> <p> This expansion does not occur when the <em>PT</em> flag is used on the <code class=\"directive\"><a href=\"#rewriterule\">RewriteRule</a></code> directive.</p> </div> <p>Here are all possible substitution combinations and their meanings:</p> <p><strong>Inside per-server configuration (<code>httpd.conf</code>)<br> for request ``<code>GET /somepath/pathinfo</code>'':</strong><br> </p> <table class=\"bordered\">\n<tr class=\"header\"> <th>Given Rule</th> <th>Resulting Substitution</th> </tr> <tr> <td>^/somepath(.*) otherpath$1</td> <td>invalid, not supported</td> </tr> <tr class=\"odd\"> <td>^/somepath(.*) otherpath$1 [R]</td> <td>invalid, not supported</td> </tr> <tr> <td>^/somepath(.*) otherpath$1 [P]</td> <td>invalid, not supported</td> </tr> <tr class=\"odd\"> <td>^/somepath(.*) /otherpath$1</td> <td>/otherpath/pathinfo</td> </tr> <tr> <td>^/somepath(.*) /otherpath$1 [R]</td> <td>http://thishost/otherpath/pathinfo via external redirection</td> </tr> <tr class=\"odd\"> <td>^/somepath(.*) /otherpath$1 [P]</td> <td>doesn't make sense, not supported</td> </tr> <tr> <td>^/somepath(.*) http://thishost/otherpath$1</td> <td>/otherpath/pathinfo</td> </tr> <tr class=\"odd\"> <td>^/somepath(.*) http://thishost/otherpath$1 [R]</td> <td>http://thishost/otherpath/pathinfo via external redirection</td> </tr> <tr> <td>^/somepath(.*) http://thishost/otherpath$1 [P]</td> <td>doesn't make sense, not supported</td> </tr> <tr class=\"odd\"> <td>^/somepath(.*) http://otherhost/otherpath$1</td> <td>http://otherhost/otherpath/pathinfo via external redirection</td> </tr> <tr> <td>^/somepath(.*) http://otherhost/otherpath$1 [R]</td> <td>http://otherhost/otherpath/pathinfo via external redirection (the [R] flag is redundant)</td> </tr> <tr class=\"odd\"> <td>^/somepath(.*) http://otherhost/otherpath$1 [P]</td> <td>http://otherhost/otherpath/pathinfo via internal proxy</td> </tr> </table> <p><strong>Inside per-directory configuration for <code>/somepath</code><br> (<code>/physical/path/to/somepath/.htaccess</code>, with <code>RewriteBase \"/somepath\"</code>)<br> for request ``<code>GET /somepath/localpath/pathinfo</code>'':</strong><br> </p> <table class=\"bordered\">\n<tr class=\"header\"> <th>Given Rule</th> <th>Resulting Substitution</th> </tr> <tr> <td>^localpath(.*) otherpath$1</td> <td>/somepath/otherpath/pathinfo</td> </tr> <tr class=\"odd\"> <td>^localpath(.*) otherpath$1 [R]</td> <td>http://thishost/somepath/otherpath/pathinfo via external redirection</td> </tr> <tr> <td>^localpath(.*) otherpath$1 [P]</td> <td>doesn't make sense, not supported</td> </tr> <tr class=\"odd\"> <td>^localpath(.*) /otherpath$1</td> <td>/otherpath/pathinfo</td> </tr> <tr> <td>^localpath(.*) /otherpath$1 [R]</td> <td>http://thishost/otherpath/pathinfo via external redirection</td> </tr> <tr class=\"odd\"> <td>^localpath(.*) /otherpath$1 [P]</td> <td>doesn't make sense, not supported</td> </tr> <tr> <td>^localpath(.*) http://thishost/otherpath$1</td> <td>/otherpath/pathinfo</td> </tr> <tr class=\"odd\"> <td>^localpath(.*) http://thishost/otherpath$1 [R]</td> <td>http://thishost/otherpath/pathinfo via external redirection</td> </tr> <tr> <td>^localpath(.*) http://thishost/otherpath$1 [P]</td> <td>doesn't make sense, not supported</td> </tr> <tr class=\"odd\"> <td>^localpath(.*) http://otherhost/otherpath$1</td> <td>http://otherhost/otherpath/pathinfo via external redirection</td> </tr> <tr> <td>^localpath(.*) http://otherhost/otherpath$1 [R]</td> <td>http://otherhost/otherpath/pathinfo via external redirection (the [R] flag is redundant)</td> </tr> <tr class=\"odd\"> <td>^localpath(.*) http://otherhost/otherpath$1 [P]</td> <td>http://otherhost/otherpath/pathinfo via internal proxy</td> </tr> </table> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_rewrite.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_rewrite.html</a>\n  </p>\n</div>\n","mod/mod_vhost_alias":"<h1>Apache Module mod_vhost_alias</h1>  <table class=\"module\">\n<tr>\n<th>Description:</th>\n<td>Provides for dynamically configured mass virtual hosting</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>ModuleIdentifier:</th>\n<td>vhost_alias_module</td>\n</tr> <tr>\n<th>SourceFile:</th>\n<td>mod_vhost_alias.c</td>\n</tr>\n</table> <h3>Summary</h3> <p>This module creates dynamically configured virtual hosts, by allowing the IP address and/or the <code>Host:</code> header of the HTTP request to be used as part of the pathname to determine what files to serve. This allows for easy use of a huge number of virtual hosts with similar configurations.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>If <code class=\"module\"><a href=\"mod_alias\">mod_alias</a></code> or <code class=\"module\"><a href=\"mod_userdir\">mod_userdir</a></code> are used for translating URIs to filenames, they will override the directives of <code class=\"module\"><a href=\"mod_vhost_alias\">mod_vhost_alias</a></code> described below. For example, the following configuration will map <code>/cgi-bin/script.pl</code> to <code>/usr/local/apache2/cgi-bin/script.pl</code> in all cases:</p> <pre class=\"prettyprint lang-config\">ScriptAlias \"/cgi-bin/\" \"/usr/local/apache2/cgi-bin/\"\nVirtualScriptAlias \"/never/found/%0/cgi-bin/\"</pre> </div>     <h2 id=\"interpol\">Directory Name Interpolation</h2> <p>All the directives in this module interpolate a string into a pathname. The interpolated string (henceforth called the \"name\") may be either the server name (see the <code class=\"directive\"><a href=\"core#usecanonicalname\">UseCanonicalName</a></code> directive for details on how this is determined) or the IP address of the virtual host on the server in dotted-quad format. The interpolation is controlled by specifiers inspired by <code>printf</code> which have a number of formats:</p> <table> <tr>\n<td><code>%%</code></td> <td>insert a <code>%</code>\n</td>\n</tr> <tr>\n<td><code>%p</code></td> <td>insert the port number of the virtual host</td>\n</tr> <tr>\n<td><code>%N.M</code></td> <td>insert (part of) the name</td>\n</tr> </table> <p><code>N</code> and <code>M</code> are used to specify substrings of the name. <code>N</code> selects from the dot-separated components of the name, and <code>M</code> selects characters within whatever <code>N</code> has selected. <code>M</code> is optional and defaults to zero if it isn't present; the dot must be present if and only if <code>M</code> is present. The interpretation is as follows:</p> <table> <tr>\n<td><code>0</code></td> <td>the whole name</td>\n</tr> <tr>\n<td><code>1</code></td> <td>the first part</td>\n</tr> <tr>\n<td><code>2</code></td> <td>the second part</td>\n</tr> <tr>\n<td><code>-1</code></td> <td>the last part</td>\n</tr> <tr>\n<td><code>-2</code></td> <td>the penultimate part</td>\n</tr> <tr>\n<td><code>2+</code></td> <td>the second and all subsequent parts</td>\n</tr> <tr>\n<td><code>-2+</code></td> <td>the penultimate and all preceding parts</td>\n</tr> <tr>\n<td>\n<code>1+</code> and <code>-1+</code>\n</td> <td>the same as <code>0</code>\n</td>\n</tr> </table> <p>If <code>N</code> or <code>M</code> is greater than the number of parts available a single underscore is interpolated. </p>   <h2 id=\"examples\">Examples</h2> <p>For simple name-based virtual hosts you might use the following directives in your server configuration file:</p> <pre class=\"prettyprint lang-config\">UseCanonicalName    Off\nVirtualDocumentRoot \"/usr/local/apache/vhosts/%0\"</pre> <p>A request for <code>http://www.example.com/directory/file.html</code> will be satisfied by the file <code>/usr/local/apache/vhosts/www.example.com/directory/file.html</code>. </p> <p>For a very large number of virtual hosts it is a good idea to arrange the files to reduce the size of the <code>vhosts</code> directory. To do this you might use the following in your configuration file:</p> <pre class=\"prettyprint lang-config\">UseCanonicalName    Off\nVirtualDocumentRoot \"/usr/local/apache/vhosts/%3+/%2.1/%2.2/%2.3/%2\"</pre> <p>A request for <code>http://www.domain.example.com/directory/file.html</code> will be satisfied by the file <code>/usr/local/apache/vhosts/example.com/d/o/m/domain/directory/file.html</code>.</p> <p>A more even spread of files can be achieved by hashing from the end of the name, for example: </p> <pre class=\"prettyprint lang-config\">VirtualDocumentRoot \"/usr/local/apache/vhosts/%3+/%2.-1/%2.-2/%2.-3/%2\"</pre> <p>The example request would come from <code>/usr/local/apache/vhosts/example.com/n/i/a/domain/directory/file.html</code>.</p> <p>Alternatively you might use: </p> <pre class=\"prettyprint lang-config\">VirtualDocumentRoot \"/usr/local/apache/vhosts/%3+/%2.1/%2.2/%2.3/%2.4+\"</pre> <p>The example request would come from <code>/usr/local/apache/vhosts/example.com/d/o/m/ain/directory/file.html</code>.</p> <p> A very common request by users is the ability to point multiple domains to multiple document roots without having to worry about the length or number of parts of the hostname being requested. If the requested hostname is <code>sub.www.domain.example.com</code> instead of simply <code>www.domain.example.com</code>, then using %3+ will result in the document root being <code>/usr/local/apache/vhosts/domain.example.com/...</code> instead of the intended <code>example.com</code> directory. In such cases, it can be beneficial to use the combination <code>%-2.0.%-1.0</code>, which will always yield the domain name and the tld, for example <code>example.com</code> regardless of the number of subdomains appended to the hostname. As such, one can make a configuration that will direct all first, second or third level subdomains to the same directory: </p> <pre class=\"prettyprint lang-config\">VirtualDocumentRoot \"/usr/local/apache/vhosts/%-2.0.%-1.0\"</pre> <p> In the example above, both <code>www.example.com</code> as well as <code>www.sub.example.com</code> or <code>example.com</code> will all point to <code>/usr/local/apache/vhosts/example.com</code>. </p> <p>For IP-based virtual hosting you might use the following in your configuration file:</p> <pre class=\"prettyprint lang-config\">UseCanonicalName DNS\nVirtualDocumentRootIP \"/usr/local/apache/vhosts/%1/%2/%3/%4/docs\"\nVirtualScriptAliasIP  \"/usr/local/apache/vhosts/%1/%2/%3/%4/cgi-bin\"</pre> <p>A request for <code>http://www.domain.example.com/directory/file.html</code> would be satisfied by the file <code>/usr/local/apache/vhosts/10/20/30/40/docs/directory/file.html</code> if the IP address of <code>www.domain.example.com</code> were 10.20.30.40. A request for <code>http://www.domain.example.com/cgi-bin/script.pl</code> would be satisfied by executing the program <code>/usr/local/apache/vhosts/10/20/30/40/cgi-bin/script.pl</code>.</p> <p>If you want to include the <code>.</code> character in a <code>VirtualDocumentRoot</code> directive, but it clashes with a <code>%</code> directive, you can work around the problem in the following way:</p> <pre class=\"prettyprint lang-config\">VirtualDocumentRoot \"/usr/local/apache/vhosts/%2.0.%3.0\"</pre> <p>A request for <code>http://www.domain.example.com/directory/file.html</code> will be satisfied by the file <code>/usr/local/apache/vhosts/domain.example/directory/file.html</code>.</p> <p>The <code class=\"directive\"><a href=\"mod_log_config#logformat\">LogFormat</a></code> directives <code>%V</code> and <code>%A</code> are useful in conjunction with this module.</p>   <div class=\"directive-section\">\n<h2 id=\"virtualdocumentroot\">VirtualDocumentRoot Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Dynamically configure the location of the document root for a given virtual host</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VirtualDocumentRoot interpolated-directory|none</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>VirtualDocumentRoot none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_vhost_alias</td>\n</tr> </table> <p>The <code class=\"directive\">VirtualDocumentRoot</code> directive allows you to determine where Apache HTTP Server will find your documents based on the value of the server name. The result of expanding <em>interpolated-directory</em> is used as the root of the document tree in a similar manner to the <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code> directive's argument. If <em>interpolated-directory</em> is <code>none</code> then <code class=\"directive\">VirtualDocumentRoot</code> is turned off. This directive cannot be used in the same context as <code class=\"directive\"><a href=\"#virtualdocumentrootip\">VirtualDocumentRootIP</a></code>.</p> <div class=\"warning\">\n<p><strong>Note</strong></p> <code class=\"directive\">VirtualDocumentRoot</code> will override any <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code> directives you may have put in the same context or child contexts. Putting a <code class=\"directive\">VirtualDocumentRoot</code> in the global server scope will effectively override <code class=\"directive\"><a href=\"core#documentroot\">DocumentRoot</a></code> directives in any virtual hosts defined later on, unless you set <code class=\"directive\">VirtualDocumentRoot</code> to <code>None</code> in each virtual host. </div> </div>  <div class=\"directive-section\">\n<h2 id=\"virtualdocumentrootip\">VirtualDocumentRootIP Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Dynamically configure the location of the document root for a given virtual host</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VirtualDocumentRootIP interpolated-directory|none</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>VirtualDocumentRootIP none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_vhost_alias</td>\n</tr> </table> <p>The <code class=\"directive\">VirtualDocumentRootIP</code> directive is like the <code class=\"directive\"><a href=\"#virtualdocumentroot\">VirtualDocumentRoot</a></code> directive, except that it uses the IP address of the server end of the connection for directory interpolation instead of the server name.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"virtualscriptalias\">VirtualScriptAlias Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Dynamically configure the location of the CGI directory for a given virtual host</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VirtualScriptAlias interpolated-directory|none</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>VirtualScriptAlias none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_vhost_alias</td>\n</tr> </table> <p>The <code class=\"directive\">VirtualScriptAlias</code> directive allows you to determine where Apache httpd will find CGI scripts in a similar manner to <code class=\"directive\"><a href=\"#virtualdocumentroot\">VirtualDocumentRoot</a></code> does for other documents. It matches requests for URIs starting <code>/cgi-bin/</code>, much like <code class=\"directive\"><a href=\"mod_alias#scriptalias\">ScriptAlias</a></code> <code>/cgi-bin/</code> would.</p> </div>  <div class=\"directive-section\">\n<h2 id=\"virtualscriptaliasip\">VirtualScriptAliasIP Directive</h2> <table class=\"directive\"> <tr>\n<th>Description:</th>\n<td>Dynamically configure the location of the CGI directory for a given virtual host</td>\n</tr> <tr>\n<th>Syntax:</th>\n<td><pre>VirtualScriptAliasIP interpolated-directory|none</pre></td>\n</tr> <tr>\n<th>Default:</th>\n<td><pre>VirtualScriptAliasIP none</pre></td>\n</tr> <tr>\n<th>Context:</th>\n<td>server config, virtual host</td>\n</tr> <tr>\n<th>Status:</th>\n<td>Extension</td>\n</tr> <tr>\n<th>Module:</th>\n<td>mod_vhost_alias</td>\n</tr> </table> <p>The <code class=\"directive\">VirtualScriptAliasIP</code> directive is like the <code class=\"directive\"><a href=\"#virtualscriptalias\">VirtualScriptAlias</a></code> directive, except that it uses the IP address of the server end of the connection for directory interpolation instead of the server name.</p> </div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/mod/mod_vhost_alias.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/mod/mod_vhost_alias.html</a>\n  </p>\n</div>\n","programs/ab":"<h1>ab - Apache HTTP server benchmarking tool</h1>  <p><code>ab</code> is a tool for benchmarking your Apache Hypertext Transfer Protocol (HTTP) server. It is designed to give you an impression of how your current Apache installation performs. This especially shows you how many requests per second your Apache installation is capable of serving.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>ab [ -A auth-username:password ] [ -b windowsize ] [ -B local-address ] [ -c concurrency ] [ -C cookie-name=value ] [ -d ] [ -e csv-file ] [ -f protocol ] [ -g gnuplot-file ] [ -h ] [ -H custom-header ] [ -i ] [ -k ] [ -l ] [ -m HTTP-method ] [ -n requests ] [ -p POST-file ] [ -P proxy-auth-username:password ] [ -q ] [ -r ] [ -s timeout ] [ -S ] [ -t timelimit ] [ -T content-type ] [ -u PUT-file ] [ -v verbosity] [ -V ] [ -w ] [ -x &lt;table&gt;-attributes ] [ -X proxy[:port] ] [ -y &lt;tr&gt;-attributes ] [ -z &lt;td&gt;-attributes ] [ -Z ciphersuite ] [http[s]://]hostname[:port]/path</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-A auth-username:password</code></dt> <dd>Supply BASIC Authentication credentials to the server. The username and password are separated by a single <code>:</code> and sent on the wire base64 encoded. The string is sent regardless of whether the server needs it (<em>i.e.</em>, has sent an 401 authentication needed).</dd> <dt><code>-b windowsize</code></dt> <dd>Size of TCP send/receive buffer, in bytes.</dd> <dt><code>-B local-address</code></dt> <dd>Address to bind to when making outgoing connections.</dd> <dt><code>-c concurrency</code></dt> <dd>Number of multiple requests to perform at a time. Default is one request at a time.</dd> <dt><code>-C cookie-name=value</code></dt> <dd>Add a <code>Cookie:</code> line to the request. The argument is typically in the form of a <code>name=value</code> pair. This field is repeatable.</dd> <dt><code>-d</code></dt> <dd>Do not display the \"percentage served within XX [ms] table\". (legacy support).</dd> <dt><code>-e csv-file</code></dt> <dd>Write a Comma separated value (CSV) file which contains for each percentage (from 1% to 100%) the time (in milliseconds) it took to serve that percentage of the requests. This is usually more useful than the 'gnuplot' file; as the results are already 'binned'.</dd> <dt><code>-f protocol</code></dt> <dd>Specify SSL/TLS protocol (SSL2, SSL3, TLS1, TLS1.1, TLS1.2, or ALL). TLS1.1 and TLS1.2 support available in 2.4.4 and later.</dd> <dt><code>-g gnuplot-file</code></dt> <dd>Write all measured values out as a 'gnuplot' or TSV (Tab separate values) file. This file can easily be imported into packages like Gnuplot, IDL, Mathematica, Igor or even Excel. The labels are on the first line of the file. </dd> <dt><code>-h</code></dt> <dd>Display usage information.</dd> <dt><code>-H custom-header</code></dt> <dd>Append extra headers to the request. The argument is typically in the form of a valid header line, containing a colon-separated field-value pair (<em>i.e.</em>, <code>\"Accept-Encoding: zip/zop;8bit\"</code>).</dd> <dt><code>-i</code></dt> <dd>Do <code>HEAD</code> requests instead of <code>GET</code>.</dd> <dt><code>-k</code></dt> <dd>Enable the HTTP KeepAlive feature, <em>i.e.</em>, perform multiple requests within one HTTP session. Default is no KeepAlive.</dd> <dt><code>-l</code></dt> <dd>Do not report errors if the length of the responses is not constant. This can be useful for dynamic pages. Available in 2.4.7 and later. </dd> <dt><code>-m HTTP-method</code></dt> <dd>Custom HTTP method for the requests. Available in 2.4.10 and later.</dd> <dt><code>-n requests</code></dt> <dd>Number of requests to perform for the benchmarking session. The default is to just perform a single request which usually leads to non-representative benchmarking results.</dd> <dt><code>-p POST-file</code></dt> <dd>File containing data to POST. Remember to also set <code>-T</code>.</dd> <dt><code>-P proxy-auth-username:password</code></dt> <dd>Supply BASIC Authentication credentials to a proxy en-route. The username and password are separated by a single <code>:</code> and sent on the wire base64 encoded. The string is sent regardless of whether the proxy needs it (<em>i.e.</em>, has sent an 407 proxy authentication needed).</dd> <dt><code>-q</code></dt> <dd>When processing more than 150 requests, <code>ab</code> outputs a progress count on <code>stderr</code> every 10% or 100 requests or so. The <code>-q</code> flag will suppress these messages.</dd> <dt><code>-r</code></dt> <dd>Don't exit on socket receive errors.</dd> <dt><code>-s timeout</code></dt> <dd>Maximum number of seconds to wait before the socket times out. Default is 30 seconds. Available in 2.4.4 and later.</dd> <dt><code>-S</code></dt> <dd>Do not display the median and standard deviation values, nor display the warning/error messages when the average and median are more than one or two times the standard deviation apart. And default to the min/avg/max values. (legacy support).</dd> <dt><code>-t timelimit</code></dt> <dd>Maximum number of seconds to spend for benchmarking. This implies a <code>-n 50000</code> internally. Use this to benchmark the server within a fixed total amount of time. Per default there is no timelimit.</dd> <dt><code>-T content-type</code></dt> <dd>Content-type header to use for POST/PUT data, eg. <code>application/x-www-form-urlencoded</code>. Default is <code>text/plain</code>.</dd> <dt><code>-u PUT-file</code></dt> <dd>File containing data to PUT. Remember to also set <code>-T</code>.</dd> <dt><code>-v verbosity</code></dt> <dd>Set verbosity level - <code>4</code> and above prints information on headers, <code>3</code> and above prints response codes (404, 200, etc.), <code>2</code> and above prints warnings and info.</dd> <dt><code>-V</code></dt> <dd>Display version number and exit.</dd> <dt><code>-w</code></dt> <dd>Print out results in HTML tables. Default table is two columns wide, with a white background.</dd> <dt><code>-x &lt;table&gt;-attributes</code></dt> <dd>String to use as attributes for <code>&lt;table&gt;</code>. Attributes are inserted <code>&lt;table here &gt;</code>.</dd> <dt><code>-X proxy[:port]</code></dt> <dd>Use a proxy server for the requests.</dd> <dt><code>-y &lt;tr&gt;-attributes</code></dt> <dd>String to use as attributes for <code>&lt;tr&gt;</code>.</dd> <dt><code>-z &lt;td&gt;-attributes</code></dt> <dd>String to use as attributes for <code>&lt;td&gt;</code>.</dd> <dt><code>-Z ciphersuite</code></dt> <dd>Specify SSL/TLS cipher suite (See openssl ciphers)</dd> </dl>   <h2 id=\"output\">Output</h2> <p>The following list describes the values returned by <code>ab</code>: </p> <dl> <dt>Server Software</dt> <dd>The value, if any, returned in the <var>server</var> HTTP header of the first successful response. This includes all characters in the header from beginning to the point a character with decimal value of 32 (most notably: a space or CR/LF) is detected.</dd> <dt>Server Hostname</dt> <dd>The DNS or IP address given on the command line</dd> <dt>Server Port</dt> <dd>The port to which ab is connecting. If no port is given on the command line, this will default to 80 for http and 443 for https.</dd> <dt>SSL/TLS Protocol</dt> <dd>The protocol parameters negotiated between the client and server. This will only be printed if SSL is used.</dd> <dt>Document Path</dt> <dd>The request URI parsed from the command line string.</dd> <dt>Document Length</dt> <dd>This is the size in bytes of the first successfully returned document. If the document length changes during testing, the response is considered an error.</dd> <dt>Concurrency Level</dt> <dd>The number of concurrent clients used during the test</dd> <dt>Time taken for tests</dt> <dd>This is the time taken from the moment the first socket connection is created to the moment the last response is received</dd> <dt>Complete requests</dt> <dd>The number of successful responses received</dd> <dt>Failed requests</dt> <dd>The number of requests that were considered a failure. If the number is greater than zero, another line will be printed showing the number of requests that failed due to connecting, reading, incorrect content length, or exceptions.</dd> <dt>Write errors</dt> <dd>The number of errors that failed during write (broken pipe).</dd> <dt>Non-2xx responses</dt> <dd>The number of responses that were not in the 200 series of response codes. If all responses were 200, this field is not printed.</dd> <dt>Keep-Alive requests</dt> <dd>The number of connections that resulted in Keep-Alive requests</dd> <dt>Total body sent</dt> <dd>If configured to send data as part of the test, this is the total number of bytes sent during the tests. This field is omitted if the test did not include a body to send.</dd> <dt>Total transferred</dt> <dd>The total number of bytes received from the server. This number is essentially the number of bytes sent over the wire.</dd> <dt>HTML transferred</dt> <dd>The total number of document bytes received from the server. This number excludes bytes received in HTTP headers</dd> <dt>Requests per second</dt> <dd>This is the number of requests per second. This value is the result of dividing the number of requests by the total time taken</dd> <dt>Time per request</dt> <dd>The average time spent per request. The first value is calculated with the formula <code>concurrency * timetaken * 1000 / done</code> while the second value is calculated with the formula <code>timetaken * 1000 / done</code>\n</dd> <dt>Transfer rate</dt> <dd>The rate of transfer as calculated by the formula <code>totalread / 1024 / timetaken</code>\n</dd> </dl>   <h2 id=\"bugs\">Bugs</h2> <p>There are various statically declared buffers of fixed length. Combined with the lazy parsing of the command line arguments, the response headers from the server and other external inputs, this might bite you.</p> <p>It does not implement HTTP/1.x fully; only accepts some 'expected' forms of responses. The rather heavy use of <code>strstr(3)</code> shows up top in profile, which might indicate a performance problem; <em>i.e.</em>, you would measure the <code>ab</code> performance rather than the server's.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/ab.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/ab.html</a>\n  </p>\n</div>\n","programs/fcgistarter":"<h1>fcgistarter - Start a FastCGI program</h1>       <h2 id=\"note\">Note</h2> <p>Currently only works on Unix systems.</p>   <h2 id=\"synopsis\">Synopsis</h2> <pre>fcgistarter -c command -p port [ -i interface ] -N num</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-c command</code></dt> <dd>FastCGI program</dd> <dt><code>-p port</code></dt> <dd>Port which the program will listen on</dd> <dt><code>-i interface</code></dt> <dd>Interface which the program will listen on</dd> <dt><code>-N num</code></dt> <dd>Number of instances of the program</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/fcgistarter.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/fcgistarter.html</a>\n  </p>\n</div>\n","programs/htcacheclean":"<h1>htcacheclean - Clean up the disk cache</h1>  <p><code>htcacheclean</code> is used to keep the size of <code class=\"module\"><a href=\"../mod/mod_cache_disk\">mod_cache_disk</a></code>'s storage within a given size limit, or limit on inodes in use. This tool can run either manually or in daemon mode. When running in daemon mode, it sleeps in the background and checks the cache directory at regular intervals for cached content to be removed. You can stop the daemon cleanly by sending it a TERM or INT signal. When run manually, a once off check of the cache directory is made for cached content to be removed. If one or more URLs are specified, each URL will be deleted from the cache, if present.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>htcacheclean [ -D ] [ -v ] [ -t ] [ -r ] [ -n ] [ -Rround ] -ppath [-llimit| -Llimit]</pre> <pre>htcacheclean [ -n ] [ -t ] [ -i ] [ -Ppidfile ] [ -Rround ] -dinterval -ppath [-llimit| -Llimit]</pre> <pre>htcacheclean [ -v ] [ -Rround ] -ppath [ -a ] [ -A ]</pre> <pre>htcacheclean [ -D ] [ -v ] [ -t ] [ -Rround ] -ppath url</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-dinterval</code></dt> <dd>Daemonize and repeat cache cleaning every <var>interval</var> minutes. This option is mutually exclusive with the <code>-D</code>, <code>-v</code> and <code>-r</code> options. To shutdown the daemon cleanly, just send it a <code>SIGTERM</code> or <code>SIGINT</code>.</dd> <dt><code>-D</code></dt> <dd>Do a dry run and don't delete anything. This option is mutually exclusive with the <code>-d</code> option. When doing a dry run and deleting directories with <code>-t</code>, the inodes reported deleted in the stats cannot take into account the directories deleted, and will be marked as an estimate.</dd> <dt><code>-v</code></dt> <dd>Be verbose and print statistics. This option is mutually exclusive with the <code>-d</code> option.</dd> <dt><code>-r</code></dt> <dd>Clean thoroughly. This assumes that the Apache web server is not running (otherwise you may get garbage in the cache). This option is mutually exclusive with the <code>-d</code> option and implies the <code>-t</code> option.</dd> <dt><code>-n</code></dt> <dd>Be nice. This causes slower processing in favour of other processes. <code>htcacheclean</code> will sleep from time to time so that (a) the disk IO will be delayed and (b) the kernel can schedule other processes in the meantime.</dd> <dt><code>-t</code></dt> <dd>Delete all empty directories. By default only cache files are removed, however with some configurations the large number of directories created may require attention. If your configuration requires a very large number of directories, to the point that inode or file allocation table exhaustion may become an issue, use of this option is advised.</dd> <dt><code>-ppath</code></dt> <dd>Specify <var>path</var> as the root directory of the disk cache. This should be the same value as specified with the <code class=\"directive\"><a href=\"../mod/mod_cache_disk#cacheroot\">CacheRoot</a></code> directive.</dd> <dt><code>-Ppidfile</code></dt> <dd>Specify <var>pidfile</var> as the name of the file to write the process ID to when daemonized.</dd> <dt><code>-Rround</code></dt> <dd>Specify <var>round</var> as the amount to round sizes up to, to compensate for disk block sizes. Set to the block size of the cache partition.</dd> <dt><code>-llimit</code></dt> <dd>Specify <var>limit</var> as the total disk cache size limit. The value is expressed in bytes by default (or attaching <code>B</code> to the number). Attach <code>K</code> for Kbytes or <code>M</code> for MBytes.</dd> <dt><code>-Llimit</code></dt> <dd>Specify <var>limit</var> as the total disk cache inode limit.</dd> <dt><code>-i</code></dt> <dd>Be intelligent and run only when there was a modification of the disk cache. This option is only possible together with the <code>-d</code> option.</dd> <dt><code>-a</code></dt> <dd>List the URLs currently stored in the cache. Variants of the same URL will be listed once for each variant.</dd> <dt><code>-A</code></dt> <dd>List the URLs currently stored in the cache, along with their attributes in the following order: url, header size, body size, status, entity version, date, expiry, request time, response time, body present, head request.</dd> </dl>   <h2 id=\"delete\">Deleting a specific URL</h2> <p>If <code>htcacheclean</code> is passed one or more URLs, each URL will be deleted from the cache. If multiple variants of an URL exists, all variants would be deleted.</p> <p>When a reverse proxied URL is to be deleted, the effective URL is constructed from the <strong>Host</strong> header, the <strong>port</strong>, the <strong>path</strong> and the <strong>query</strong>. Note the '?' in the URL must always be specified explicitly, whether a query string is present or not. For example, an attempt to delete the path <strong>/</strong> from the server <strong>localhost</strong>, the URL to delete would be <strong>http://localhost:80/?</strong>.</p>   <h2 id=\"list\">Listing URLs in the Cache</h2> <p>By passing the <code>-a</code> or <code>-A</code> options to <code>htcacheclean</code>, the URLs within the cache will be listed as they are found, one URL per line. The <code>-A</code> option dumps the full cache entry after the URL, with fields in the following order:</p> <dl> <dt>url</dt>\n<dd>The URL of the entry.</dd> <dt>header size</dt>\n<dd>The size of the header in bytes.</dd> <dt>body size</dt>\n<dd>The size of the body in bytes.</dd> <dt>status</dt>\n<dd>Status of the cached response.</dd> <dt>entity version</dt>\n<dd>The number of times this entry has been revalidated without being deleted.</dd> <dt>date</dt>\n<dd>Date of the response.</dd> <dt>expiry</dt>\n<dd>Expiry date of the response.</dd> <dt>request time</dt>\n<dd>Time of the start of the request.</dd> <dt>response time</dt>\n<dd>Time of the end of the request.</dd> <dt>body present</dt>\n<dd>If 0, no body is stored with this request, 1 otherwise.</dd> <dt>head request</dt>\n<dd>If 1, the entry contains a cached HEAD request with no body, 0 otherwise.</dd> </dl>   <h2 id=\"exit\">Exit Status</h2> <p><code>htcacheclean</code> returns a zero status (\"true\") if all operations were successful, <code>1</code> otherwise. If an URL is specified, and the URL was cached and successfully removed, <code>0</code> is returned, <code>2</code> otherwise. If an error occurred during URL removal, <code>1</code> is returned.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/htcacheclean.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/htcacheclean.html</a>\n  </p>\n</div>\n","programs/htdigest":"<h1>htdigest - manage user files for digest authentication</h1>  <p><code>htdigest</code> is used to create and update the flat-files used to store usernames, realm and password for digest authentication of HTTP users. Resources available from the Apache HTTP server can be restricted to just the users listed in the files created by <code>htdigest</code>.</p> <p>This manual page only lists the command line arguments. For details of the directives necessary to configure digest authentication in <code class=\"program\"><a href=\"httpd\">httpd</a></code> see the Apache manual, which is part of the Apache distribution or can be found at <a href=\"http://httpd.apache.org/\">http://httpd.apache.org/</a>.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>htdigest [ -c ] passwdfile realm username</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-c</code></dt> <dd>Create the <var>passwdfile</var>. If <var>passwdfile</var> already exists, it is deleted first.</dd> <dt><code>passwdfile</code></dt> <dd>Name of the file to contain the username, realm and password. If <code>-c</code> is given, this file is created if it does not already exist, or deleted and recreated if it does exist.</dd> <dt><code>realm</code></dt> <dd>The realm name to which the user name belongs. See <a href=\"http://tools.ietf.org/html/rfc2617#section-3.2.1\"> http://tools.ietf.org/html/rfc2617#section-3.2.1</a> for more details. </dd> <dt><code>username</code></dt> <dd>The user name to create or update in <var>passwdfile</var>. If <var>username</var> does not exist is this file, an entry is added. If it does exist, the password is changed.</dd> </dl>   <h2 id=\"security\">Security Considerations</h2> <p>This program is not safe as a setuid executable. Do <em>not</em> make it setuid.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/htdigest.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/htdigest.html</a>\n  </p>\n</div>\n","programs/httxt2dbm":"<h1>httxt2dbm - Generate dbm files for use with RewriteMap</h1>  <p><code>httxt2dbm</code> is used to generate dbm files from text input, for use in <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> with the <code>dbm</code> map type.</p> <p>If the output file already exists, it will not be truncated. New keys will be added and existing keys will be updated.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>httxt2dbm [ -v ] [ -f DBM_TYPE ] -i SOURCE_TXT -o OUTPUT_DBM</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-v</code></dt> <dd>More verbose output</dd> <dt><code>-f DBM_TYPE</code></dt> <dd>Specify the DBM type to be used for the output. If not specified, will use the <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#apr\" title=\"see glossary\">APR</a> Default. Available types are: <code>GDBM</code> for GDBM files, <code>SDBM</code> for SDBM files, <code>DB</code> for berkeley DB files, <code>NDBM</code> for NDBM files, <code>default</code> for the default DBM type. </dd> <dt><code>-i SOURCE_TXT</code></dt> <dd>Input file from which the dbm is to be created. The file should be formated with one record per line, of the form: <code>key value</code>. See the documentation for <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> for further details of this file's format and meaning. </dd> <dt><code>-o OUTPUT_DBM</code></dt> <dd>Name of the output dbm files.</dd> </dl>   <h2 id=\"examples\">Examples</h2> <div class=\"example\"><pre>httxt2dbm -i rewritemap.txt -o rewritemap.dbm\nhttxt2dbm -f SDBM -i rewritemap.txt -o rewritemap.dbm</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/httxt2dbm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/httxt2dbm.html</a>\n  </p>\n</div>\n","programs/logresolve":"<h1>logresolve - Resolve IP-addresses to hostnames in Apache log files</h1>  <p><code>logresolve</code> is a post-processing program to resolve IP-addresses in Apache's access logfiles. To minimize impact on your nameserver, logresolve has its very own internal hash-table cache. This means that each IP number will only be looked up the first time it is found in the log file.</p> <p>Takes an Apache log file on standard input. The IP addresses must be the first thing on each line and must be separated from the remainder of the line by a space.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>logresolve [ -s filename ] [ -c ] &lt; access_log &gt; access_log.new</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-s filename</code></dt> <dd>Specifies a filename to record statistics.</dd> <dt><code>-c</code></dt> <dd>This causes <code>logresolve</code> to apply some DNS checks: after finding the hostname from the IP address, it looks up the IP addresses for the hostname and checks that one of these matches the original address.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/logresolve.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/logresolve.html</a>\n  </p>\n</div>\n","programs/htdbm":"<h1>htdbm - Manipulate DBM password databases</h1>  <p><code>htdbm</code> is used to manipulate the DBM format files used to store usernames and password for basic authentication of HTTP users via <code class=\"module\"><a href=\"../mod/mod_authn_dbm\">mod_authn_dbm</a></code>. See the <code class=\"program\"><a href=\"dbmmanage\">dbmmanage</a></code> documentation for more information about these DBM files.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>htdbm [ -TDBTYPE ] [ -i ] [ -c ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -t ] [ -v ] filename username</pre> <pre>htdbm -b [ -TDBTYPE ] [ -c ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -t ] [ -v ] filename username password</pre> <pre>htdbm -n [ -i ] [ -c ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -t ] [ -v ] username</pre> <pre>htdbm -nb [ -c ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -t ] [ -v ] username password</pre> <pre>htdbm -v [ -TDBTYPE ] [ -i ] [ -c ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -t ] [ -v ] filename username</pre> <pre>htdbm -vb [ -TDBTYPE ] [ -c ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -t ] [ -v ] filename username password</pre> <pre>htdbm -x [ -TDBTYPE ] filename username</pre> <pre>htdbm -l [ -TDBTYPE ]</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-b</code></dt> <dd>Use batch mode; <em>i.e.</em>, get the password from the command line rather than prompting for it. This option should be used with extreme care, since <strong>the password is clearly visible</strong> on the command line. For script use see the <code>-i</code> option.</dd> <dt><code>-i</code></dt> <dd>Read the password from stdin without verification (for script usage).</dd> <dt><code>-c</code></dt> <dd>Create the <var>passwdfile</var>. If <var>passwdfile</var> already exists, it is rewritten and truncated. This option cannot be combined with the <code>-n</code> option.</dd> <dt><code>-n</code></dt> <dd>Display the results on standard output rather than updating a database. This option changes the syntax of the command line, since the <var>passwdfile</var> argument (usually the first one) is omitted. It cannot be combined with the <code>-c</code> option.</dd> <dt><code>-m</code></dt> <dd>Use MD5 encryption for passwords. On Windows and Netware, this is the default.</dd> <dt><code>-B</code></dt> <dd>Use bcrypt encryption for passwords. This is currently considered to be very secure.</dd> <dt><code>-C</code></dt> <dd>This flag is only allowed in combination with <code>-B</code> (bcrypt encryption). It sets the computing time used for the bcrypt algorithm (higher is more secure but slower, default: 5, valid: 4 to 31).</dd> <dt><code>-d</code></dt> <dd>Use <code>crypt()</code> encryption for passwords. The default on all platforms but Windows and Netware. Though possibly supported by <code>htdbm</code> on all platforms, it is not supported by the <code class=\"program\"><a href=\"httpd\">httpd</a></code> server on Windows and Netware. This algorithm is <strong>insecure</strong> by today's standards.</dd> <dt><code>-s</code></dt> <dd>Use SHA encryption for passwords. Facilitates migration from/to Netscape servers using the LDAP Directory Interchange Format (ldif). This algorithm is <strong>insecure</strong> by today's standards.</dd> <dt><code>-p</code></dt> <dd>Use plaintext passwords. Though <code>htdbm</code> will support creation on all platforms, the <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon will only accept plain text passwords on Windows and Netware.</dd> <dt><code>-l</code></dt> <dd>Print each of the usernames and comments from the database on stdout.</dd> <dt><code>-v</code></dt> <dd>Verify the username and password. The program will print a message indicating whether the supplied password is valid. If the password is invalid, the program exits with error code 3.</dd> <dt><code>-x</code></dt> <dd>Delete user. If the username exists in the specified DBM file, it will be deleted.</dd> <dt><code>-t</code></dt> <dd>Interpret the final parameter as a comment. When this option is specified, an additional string can be appended to the command line; this string will be stored in the \"Comment\" field of the database, associated with the specified username.</dd> <dt><code>filename</code></dt> <dd>The filename of the DBM format file. Usually without the extension <code>.db</code>, <code>.pag</code>, or <code>.dir</code>. If <code>-c</code> is given, the DBM file is created if it does not already exist, or updated if it does exist.</dd> <dt><code>username</code></dt> <dd>The username to create or update in <var>passwdfile</var>. If <var>username</var> does not exist in this file, an entry is added. If it does exist, the password is changed.</dd> <dt><code>password</code></dt> <dd>The plaintext password to be encrypted and stored in the DBM file. Used only with the <code>-b</code> flag.</dd> <dt><code>-TDBTYPE</code></dt> <dd>Type of DBM file (SDBM, GDBM, DB, or \"default\").</dd> </dl>   <h2 id=\"bugs\">Bugs</h2> <p>One should be aware that there are a number of different DBM file formats in existence, and with all likelihood, libraries for more than one format may exist on your system. The three primary examples are SDBM, NDBM, GNU GDBM, and Berkeley/Sleepycat DB 2/3/4. Unfortunately, all these libraries use different file formats, and you must make sure that the file format used by <var>filename</var> is the same format that <code>htdbm</code> expects to see. <code>htdbm</code> currently has no way of determining what type of DBM file it is looking at. If used against the wrong format, will simply return nothing, or may create a different DBM file with a different name, or at worst, it may corrupt the DBM file if you were attempting to write to it.</p> <p>One can usually use the <code>file</code> program supplied with most Unix systems to see what format a DBM file is in.</p>   <h2 id=\"exit\">Exit Status</h2> <p><code>htdbm</code> returns a zero status (\"true\") if the username and password have been successfully added or updated in the DBM File. <code>htdbm</code> returns <code>1</code> if it encounters some problem accessing files, <code>2</code> if there was a syntax problem with the command line, <code>3</code> if the password was entered interactively and the verification entry didn't match, <code>4</code> if its operation was interrupted, <code>5</code> if a value is too long (username, filename, password, or final computed record), <code>6</code> if the username contains illegal characters (see the <a href=\"#restrictions\">Restrictions section</a>), and <code>7</code> if the file is not a valid DBM password file.</p>   <h2 id=\"examples\">Examples</h2> <div class=\"example\"><pre>htdbm /usr/local/etc/apache/.htdbm-users jsmith</pre></div> <p>Adds or modifies the password for user <code>jsmith</code>. The user is prompted for the password. If executed on a Windows system, the password will be encrypted using the modified Apache MD5 algorithm; otherwise, the system's <code>crypt()</code> routine will be used. If the file does not exist, <code>htdbm</code> will do nothing except return an error.</p> <div class=\"example\"><pre>htdbm -c /home/doe/public_html/.htdbm jane</pre></div> <p>Creates a new file and stores a record in it for user <code>jane</code>. The user is prompted for the password. If the file exists and cannot be read, or cannot be written, it is not altered and <code>htdbm</code> will display a message and return an error status.</p> <div class=\"example\"><pre>htdbm -mb /usr/web/.htdbm-all jones Pwd4Steve</pre></div> <p>Encrypts the password from the command line (<code>Pwd4Steve</code>) using the MD5 algorithm, and stores it in the specified file.</p>   <h2 id=\"security\">Security Considerations</h2> <p>Web password files such as those managed by <code>htdbm</code> should <em>not</em> be within the Web server's URI space -- that is, they should not be fetchable with a browser.</p> <p>The use of the <code>-b</code> option is discouraged, since when it is used the unencrypted password appears on the command line.</p> <p>When using the <code>crypt()</code> algorithm, note that only the first 8 characters of the password are used to form the password. If the supplied password is longer, the extra characters will be silently discarded.</p> <p>The SHA encryption format does not use salting: for a given password, there is only one encrypted representation. The <code>crypt()</code> and MD5 formats permute the representation by prepending a random salt string, to make dictionary attacks against the passwords more difficult.</p> <p>The SHA and <code>crypt()</code> formats are insecure by today's standards.</p>   <h2 id=\"restrictions\">Restrictions</h2> <p>On the Windows platform, passwords encrypted with <code>htdbm</code> are limited to no more than <code>255</code> characters in length. Longer passwords will be truncated to 255 characters.</p> <p>The MD5 algorithm used by <code>htdbm</code> is specific to the Apache software; passwords encrypted using it will not be usable with other Web servers.</p> <p>Usernames are limited to <code>255</code> bytes and may not include the character <code>:</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/htdbm.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/htdbm.html</a>\n  </p>\n</div>\n","programs/htpasswd":"<h1>htpasswd - Manage user files for basic authentication</h1>  <p><code>htpasswd</code> is used to create and update the flat-files used to store usernames and password for basic authentication of HTTP users. If <code>htpasswd</code> cannot access a file, such as not being able to write to the output file or not being able to read the file in order to update it, it returns an error status and makes no changes.</p> <p>Resources available from the Apache HTTP server can be restricted to just the users listed in the files created by <code>htpasswd</code>. This program can only manage usernames and passwords stored in a flat-file. It can encrypt and display password information for use in other types of data stores, though. To use a DBM database see <code class=\"program\"><a href=\"dbmmanage\">dbmmanage</a></code> or <code class=\"program\"><a href=\"htdbm\">htdbm</a></code>.</p> <p><code>htpasswd</code> encrypts passwords using either bcrypt, a version of MD5 modified for Apache, SHA1, or the system's <code>crypt()</code> routine. Files managed by <code>htpasswd</code> may contain a mixture of different encoding types of passwords; some user records may have bcrypt or MD5-encrypted passwords while others in the same file may have passwords encrypted with <code>crypt()</code>.</p> <p>This manual page only lists the command line arguments. For details of the directives necessary to configure user authentication in <code class=\"program\"><a href=\"httpd\">httpd</a></code> see the Apache manual, which is part of the Apache distribution or can be found at <a href=\"http://httpd.apache.org\">http://httpd.apache.org/</a>.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>htpasswd [ -c ] [ -i ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -D ] [ -v ] passwdfile username</pre> <pre>htpasswd -b [ -c ] [ -m | -B | -d | -s | -p ] [ -C cost ] [ -D ] [ -v ] passwdfile username password</pre> <pre>htpasswd -n [ -i ] [ -m | -B | -d | -s | -p ] [ -C cost ] username</pre> <pre>htpasswd -nb [ -m | -B | -d | -s | -p ] [ -C cost ] username password</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-b</code></dt> <dd>Use batch mode; <em>i.e.</em>, get the password from the command line rather than prompting for it. This option should be used with extreme care, since <strong>the password is clearly visible</strong> on the command line. For script use see the <code>-i</code> option. Available in 2.4.4 and later.</dd> <dt><code>-i</code></dt> <dd>Read the password from stdin without verification (for script usage).</dd> <dt><code>-c</code></dt> <dd>Create the <var>passwdfile</var>. If <var>passwdfile</var> already exists, it is rewritten and truncated. This option cannot be combined with the <code>-n</code> option.</dd> <dt><code>-n</code></dt> <dd>Display the results on standard output rather than updating a file. This is useful for generating password records acceptable to Apache for inclusion in non-text data stores. This option changes the syntax of the command line, since the <var>passwdfile</var> argument (usually the first one) is omitted. It cannot be combined with the <code>-c</code> option.</dd> <dt><code>-m</code></dt> <dd>Use MD5 encryption for passwords. This is the default (since version 2.2.18).</dd> <dt><code>-B</code></dt> <dd>Use bcrypt encryption for passwords. This is currently considered to be very secure.</dd> <dt><code>-C</code></dt> <dd>This flag is only allowed in combination with <code>-B</code> (bcrypt encryption). It sets the computing time used for the bcrypt algorithm (higher is more secure but slower, default: 5, valid: 4 to 31).</dd> <dt><code>-d</code></dt> <dd>Use <code>crypt()</code> encryption for passwords. This is not supported by the <code class=\"program\"><a href=\"httpd\">httpd</a></code> server on Windows and Netware. This algorithm limits the password length to 8 characters. This algorithm is <strong>insecure</strong> by today's standards. It used to be the default algorithm until version 2.2.17.</dd> <dt><code>-s</code></dt> <dd>Use SHA encryption for passwords. Facilitates migration from/to Netscape servers using the LDAP Directory Interchange Format (ldif). This algorithm is <strong>insecure</strong> by today's standards.</dd> <dt><code>-p</code></dt> <dd>Use plaintext passwords. Though <code>htpasswd</code> will support creation on all platforms, the <code class=\"program\"><a href=\"httpd\">httpd</a></code> daemon will only accept plain text passwords on Windows and Netware.</dd> <dt><code>-D</code></dt> <dd>Delete user. If the username exists in the specified htpasswd file, it will be deleted.</dd> <dt><code>-v</code></dt> <dd>Verify password. Verify that the given password matches the password of the user stored in the specified htpasswd file. Available in 2.4.5 and later.</dd> <dt><code>passwdfile</code></dt> <dd>Name of the file to contain the user name and password. If <code>-c</code> is given, this file is created if it does not already exist, or rewritten and truncated if it does exist.</dd> <dt><code>username</code></dt> <dd>The username to create or update in <var>passwdfile</var>. If <var>username</var> does not exist in this file, an entry is added. If it does exist, the password is changed.</dd> <dt><code>password</code></dt> <dd>The plaintext password to be encrypted and stored in the file. Only used with the <code>-b</code> flag.</dd> </dl>   <h2 id=\"exit\">Exit Status</h2> <p><code>htpasswd</code> returns a zero status (\"true\") if the username and password have been successfully added or updated in the <var>passwdfile</var>. <code>htpasswd</code> returns <code>1</code> if it encounters some problem accessing files, <code>2</code> if there was a syntax problem with the command line, <code>3</code> if the password was entered interactively and the verification entry didn't match, <code>4</code> if its operation was interrupted, <code>5</code> if a value is too long (username, filename, password, or final computed record), <code>6</code> if the username contains illegal characters (see the <a href=\"#restrictions\">Restrictions section</a>), and <code>7</code> if the file is not a valid password file.</p>   <h2 id=\"examples\">Examples</h2> <div class=\"example\"><pre>htpasswd /usr/local/etc/apache/.htpasswd-users jsmith</pre></div> <p>Adds or modifies the password for user <code>jsmith</code>. The user is prompted for the password. The password will be encrypted using the modified Apache MD5 algorithm. If the file does not exist, <code>htpasswd</code> will do nothing except return an error.</p> <div class=\"example\"><pre>htpasswd -c /home/doe/public_html/.htpasswd jane</pre></div> <p>Creates a new file and stores a record in it for user <code>jane</code>. The user is prompted for the password. If the file exists and cannot be read, or cannot be written, it is not altered and <code>htpasswd</code> will display a message and return an error status.</p> <div class=\"example\"><pre>htpasswd -db /usr/web/.htpasswd-all jones Pwd4Steve</pre></div> <p>Encrypts the password from the command line (<code>Pwd4Steve</code>) using the <code>crypt()</code> algorithm, and stores it in the specified file.</p>   <h2 id=\"security\">Security Considerations</h2> <p>Web password files such as those managed by <code>htpasswd</code> should <em>not</em> be within the Web server's URI space -- that is, they should not be fetchable with a browser.</p> <p>This program is not safe as a setuid executable. Do <em>not</em> make it setuid.</p> <p>The use of the <code>-b</code> option is discouraged, since when it is used the unencrypted password appears on the command line.</p> <p>When using the <code>crypt()</code> algorithm, note that only the first 8 characters of the password are used to form the password. If the supplied password is longer, the extra characters will be silently discarded.</p> <p>The SHA encryption format does not use salting: for a given password, there is only one encrypted representation. The <code>crypt()</code> and MD5 formats permute the representation by prepending a random salt string, to make dictionary attacks against the passwords more difficult.</p> <p>The SHA and <code>crypt()</code> formats are insecure by today's standards.</p>   <h2 id=\"restrictions\">Restrictions</h2> <p>On the Windows platform, passwords encrypted with <code>htpasswd</code> are limited to no more than <code>255</code> characters in length. Longer passwords will be truncated to 255 characters.</p> <p>The MD5 algorithm used by <code>htpasswd</code> is specific to the Apache software; passwords encrypted using it will not be usable with other Web servers.</p> <p>Usernames are limited to <code>255</code> bytes and may not include the character <code>:</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/htpasswd.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/htpasswd.html</a>\n  </p>\n</div>\n","programs/log_server_status":"<h1>log_server_status - Log periodic status summaries</h1>  <p>This perl script is designed to be run at a frequent interval by something like cron. It connects to the server and downloads the status information. It reformats the information to a single line and logs it to a file. Adjust the variables at the top of the script to specify the location of the resulting logfile. <code class=\"module\"><a href=\"../mod/mod_status\">mod_status</a></code> will need to be loaded and configured in order for this script to do its job.</p>    <h2 id=\"configure\">Usage</h2> <p>The script contains the following section.</p> <pre class=\"prettyprint lang-perl\">my $wherelog = \"/usr/local/apache2/logs/\";  # Logs will be like \"/usr/local/apache2/logs/19960312\"\nmy $server   = \"localhost\";        # Name of server, could be \"www.foo.com\"\nmy $port     = \"80\";               # Port on server\nmy $request = \"/server-status/?auto\";    # Request to send</pre> <p>You'll need to ensure that these variables have the correct values, and you'll need to have the <code>/server-status</code> handler configured at the location specified, and the specified log location needs to be writable by the user which will run the script.</p> <p>Run the script periodically via cron to produce a daily log file, which can then be used for statistical analysis.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/log_server_status.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/log_server_status.html</a>\n  </p>\n</div>\n","programs/rotatelogs":"<h1>rotatelogs - Piped logging program to rotate Apache logs</h1>  <p><code>rotatelogs</code> is a simple program for use in conjunction with Apache's piped logfile feature. It supports rotation based on a time interval or maximum size of the log.</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>rotatelogs [ -l ] [ -L linkname ] [ -p program ] [ -f ] [ -t ] [ -v ] [ -e ] [ -c ] [ -n number-of-files ] logfile rotationtime|filesize(B|K|M|G) [ offset ]</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-l</code></dt> <dd>Causes the use of local time rather than GMT as the base for the interval or for <code>strftime(3)</code> formatting with size-based rotation.</dd> <dt>\n<code>-L</code> <var>linkname</var>\n</dt> <dd>Causes a hard link to be made from the current logfile to the specified link name. This can be used to watch the log continuously across rotations using a command like <code>tail -F linkname</code>.</dd> <dt>\n<code>-p</code> <var>program</var>\n</dt> <dd>If given, <code>rotatelogs</code> will execute the specified program every time a new log file is opened. The filename of the newly opened file is passed as the first argument to the program. If executing after a rotation, the old log file is passed as the second argument. <code>rotatelogs</code> does not wait for the specified program to terminate before continuing to operate, and will not log any error code returned on termination. The spawned program uses the same stdin, stdout, and stderr as rotatelogs itself, and also inherits the environment.</dd> <dt><code>-f</code></dt> <dd>Causes the logfile to be opened immediately, as soon as <code>rotatelogs</code> starts, instead of waiting for the first logfile entry to be read (for non-busy sites, there may be a substantial delay between when the server is started and when the first request is handled, meaning that the associated logfile does not \"exist\" until then, which causes problems from some automated logging tools)</dd> <dt><code>-t</code></dt> <dd>Causes the logfile to be truncated instead of rotated. This is useful when a log is processed in real time by a command like tail, and there is no need for archived data. No suffix will be added to the filename, however format strings containing '%' characters will be respected. </dd> <dt><code>-v</code></dt> <dd>Produce verbose output on STDERR. The output contains the result of the configuration parsing, and all file open and close actions.</dd> <dt><code>-e</code></dt> <dd>Echo logs through to stdout. Useful when logs need to be further processed in real time by a further tool in the chain.</dd> <dt><code>-c</code></dt> <dd>Create log file for each interval, even if empty.</dd> <dt><code>-n number-of-files</code></dt> <dd>Use a circular list of filenames without timestamps. With -n 3, the series of log files opened would be \"logfile\", \"logfile.1\", \"logfile.2\", then overwriting \"logfile\". Available in 2.4.5 and later.</dd> <dt><code>logfile</code></dt> <dd>\n<p>The path plus basename of the logfile. If <var>logfile</var> includes any '%' characters, it is treated as a format string for <code>strftime(3)</code>. Otherwise, the suffix <var>.nnnnnnnnnn</var> is automatically added and is the time in seconds (unless the -t option is used). Both formats compute the start time from the beginning of the current period. For example, if a rotation time of 86400 is specified, the hour, minute, and second fields created from the <code>strftime(3)</code> format will all be zero, referring to the beginning of the current 24-hour period (midnight).</p> <p>When using <code>strftime(3)</code> filename formatting, be sure the log file format has enough granularity to produce a different file name each time the logs are rotated. Otherwise rotation will overwrite the same file instead of starting a new one. For example, if <var>logfile</var> was <code>/var/log/errorlog.%Y-%m-%d</code> with log rotation at 5 megabytes, but 5 megabytes was reached twice in the same day, the same log file name would be produced and log rotation would keep writing to the same file.</p> </dd> <dt><code>rotationtime</code></dt> <dd>The time between log file rotations in seconds. The rotation occurs at the beginning of this interval. For example, if the rotation time is 3600, the log file will be rotated at the beginning of every hour; if the rotation time is 86400, the log file will be rotated every night at midnight. (If no data is logged during an interval, no file will be created.)</dd> <dt><code>filesize(B|K|M|G)</code></dt> <dd>The maximum file size in followed by exactly one of the letters <code>B</code> (Bytes), <code>K</code> (KBytes), <code>M</code> (MBytes) or <code>G</code> (GBytes). <p> When time and size are specified, the size must be given after the time. Rotation will occur whenever either time or size limits are reached. </p> </dd> <dt><code>offset</code></dt> <dd>The number of minutes offset from UTC. If omitted, zero is assumed and UTC is used. For example, to use local time in the zone UTC -5 hours, specify a value of <code>-300</code> for this argument. In most cases, <code>-l</code> should be used instead of specifying an offset.</dd> </dl>   <h2 id=\"examples\">Examples</h2> <div class=\"example\"><pre>CustomLog \"|bin/rotatelogs /var/log/logfile 86400\" common</pre></div> <p>This creates the files /var/log/logfile.nnnn where nnnn is the system time at which the log nominally starts (this time will always be a multiple of the rotation time, so you can synchronize cron scripts with it). At the end of each rotation time (here after 24 hours) a new log is started.</p> <div class=\"example\"><pre>CustomLog \"|bin/rotatelogs -l /var/log/logfile.%Y.%m.%d 86400\" common</pre></div> <p>This creates the files /var/log/logfile.yyyy.mm.dd where yyyy is the year, mm is the month, and dd is the day of the month. Logging will switch to a new file every day at midnight, local time.</p> <div class=\"example\"><pre>CustomLog \"|bin/rotatelogs /var/log/logfile 5M\" common</pre></div> <p>This configuration will rotate the logfile whenever it reaches a size of 5 megabytes.</p> <div class=\"example\"><pre>ErrorLog \"|bin/rotatelogs /var/log/errorlog.%Y-%m-%d-%H_%M_%S 5M\"</pre></div> <p>This configuration will rotate the error logfile whenever it reaches a size of 5 megabytes, and the suffix to the logfile name will be created of the form <code>errorlog.YYYY-mm-dd-HH_MM_SS</code>.</p> <div class=\"example\"><pre>CustomLog \"|bin/rotatelogs -t /var/log/logfile 86400\" common</pre></div> <p>This creates the file /var/log/logfile, truncating the file at startup and then truncating the file once per day. It is expected in this scenario that a separate process (such as tail) would process the file in real time.</p>   <h2 id=\"portability\">Portability</h2> <p>The following logfile format string substitutions should be supported by all <code>strftime(3)</code> implementations, see the <code>strftime(3)</code> man page for library-specific extensions.</p> <table class=\"bordered\">\n<tr>\n<td><code>%A</code></td>\n<td>full weekday name (localized)</td>\n</tr> <tr class=\"odd\">\n<td><code>%a</code></td>\n<td>3-character weekday name (localized)</td>\n</tr> <tr>\n<td><code>%B</code></td>\n<td>full month name (localized)</td>\n</tr> <tr class=\"odd\">\n<td><code>%b</code></td>\n<td>3-character month name (localized)</td>\n</tr> <tr>\n<td><code>%c</code></td>\n<td>date and time (localized)</td>\n</tr> <tr class=\"odd\">\n<td><code>%d</code></td>\n<td>2-digit day of month</td>\n</tr> <tr>\n<td><code>%H</code></td>\n<td>2-digit hour (24 hour clock)</td>\n</tr> <tr class=\"odd\">\n<td><code>%I</code></td>\n<td>2-digit hour (12 hour clock)</td>\n</tr> <tr>\n<td><code>%j</code></td>\n<td>3-digit day of year</td>\n</tr> <tr class=\"odd\">\n<td><code>%M</code></td>\n<td>2-digit minute</td>\n</tr> <tr>\n<td><code>%m</code></td>\n<td>2-digit month</td>\n</tr> <tr class=\"odd\">\n<td><code>%p</code></td>\n<td>am/pm of 12 hour clock (localized)</td>\n</tr> <tr>\n<td><code>%S</code></td>\n<td>2-digit second</td>\n</tr> <tr class=\"odd\">\n<td><code>%U</code></td>\n<td>2-digit week of year (Sunday first day of week)</td>\n</tr> <tr>\n<td><code>%W</code></td>\n<td>2-digit week of year (Monday first day of week)</td>\n</tr> <tr class=\"odd\">\n<td><code>%w</code></td>\n<td>1-digit weekday (Sunday first day of week)</td>\n</tr> <tr>\n<td><code>%X</code></td>\n<td>time (localized)</td>\n</tr> <tr class=\"odd\">\n<td><code>%x</code></td>\n<td>date (localized)</td>\n</tr> <tr>\n<td><code>%Y</code></td>\n<td>4-digit year</td>\n</tr> <tr class=\"odd\">\n<td><code>%y</code></td>\n<td>2-digit year</td>\n</tr> <tr>\n<td><code>%Z</code></td>\n<td>time zone name</td>\n</tr> <tr class=\"odd\">\n<td><code>%%</code></td>\n<td>literal `%'</td>\n</tr> </table><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/rotatelogs.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/rotatelogs.html</a>\n  </p>\n</div>\n","programs/split-logfile":"<h1>split-logfile - Split up multi-vhost logfiles</h1>  <p>This perl script will take a combined Web server access log file and break its contents into separate files. It assumes that the first field of each line is the virtual host identity, put there using the \"<code>%v</code>\" variable in <code class=\"directive\"><a href=\"../mod/mod_log_config#logformat\">LogFormat</a></code>. </p>    <h2 id=\"split-logfile\">Usage</h2> <p>Create a log file with virtual host information in it:</p> <pre class=\"prettyprint lang-config\">LogFormat \"%v %h %l %u %t \\\"%r\\\" %&gt;s %b \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"\" combined_plus_vhost\nCustomLog logs/access_log combined_plus_vhost</pre> <p>Log files will be created, in the directory where you run the script, for each virtual host name that appears in the combined log file. These logfiles will named after the hostname, with a <code>.log</code> file extension.</p> <p>The combined log file is read from stdin. Records read will be appended to any existing log files.</p> <div class=\"example\"><pre>split-logfile &lt; access_log</pre></div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/split-logfile.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/split-logfile.html</a>\n  </p>\n</div>\n","programs/suexec":"<h1>suexec - Switch user before executing external programs</h1>  <p><code>suexec</code> is used by the Apache HTTP Server to switch to another user before executing CGI programs. In order to achieve this, it must run as <code>root</code>. Since the HTTP daemon normally doesn't run as <code>root</code>, the <code>suexec</code> executable needs the setuid bit set and must be owned by <code>root</code>. It should never be writable for any other person than <code>root</code>.</p> <p>For further information about the concepts and the security model of suexec please refer to the suexec documentation (<a href=\"http://httpd.apache.org/docs/2.4/suexec.html\">http://httpd.apache.org/docs/2.4/suexec.html</a>).</p>     <h2 id=\"synopsis\">Synopsis</h2> <pre>suexec -V</pre>   <h2 id=\"options\">Options</h2> <dl> <dt><code>-V</code></dt> <dd>If you are <code>root</code>, this option displays the compile options of <code>suexec</code>. For security reasons all configuration options are changeable only at compile time.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/programs/suexec.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/programs/suexec.html</a>\n  </p>\n</div>\n","dns-caveats":"<h1>Issues Regarding DNS and Apache HTTP Server</h1>  <p>This page could be summarized with the statement: don't configure Apache HTTP Server in such a way that it relies on DNS resolution for parsing of the configuration files. If httpd requires DNS resolution to parse the configuration files then your server may be subject to reliability problems (ie. it might not start up), or denial and theft of service attacks (including virtual hosts able to steal hits from other virtual hosts).</p>     <h2 id=\"example\">A Simple Example</h2> <pre class=\"prettyprint lang-config\"># This is a misconfiguration example, do not use on your server\n&lt;VirtualHost www.example.dom&gt;\n  ServerAdmin webgirl@example.dom\n  DocumentRoot \"/www/example\"\n&lt;/VirtualHost&gt;</pre> <p>In order for the server to function properly, it absolutely needs to have two pieces of information about each virtual host: the <code class=\"directive\"><a href=\"mod/core#servername\">ServerName</a></code> and at least one IP address that the server will bind and respond to. The above example does not include the IP address, so httpd must use DNS to find the address of <code>www.example.dom</code>. If for some reason DNS is not available at the time your server is parsing its config file, then this virtual host <strong>will not be configured</strong>. It won't be able to respond to any hits to this virtual host.</p> <p>Suppose that <code>www.example.dom</code> has address 192.0.2.1. Then consider this configuration snippet:</p> <pre class=\"prettyprint lang-config\"># This is a misconfiguration example, do not use on your server\n&lt;VirtualHost 192.0.2.1&gt;\n  ServerAdmin webgirl@example.dom\n  DocumentRoot \"/www/example\"\n&lt;/VirtualHost&gt;</pre> <p>This time httpd needs to use reverse DNS to find the <code>ServerName</code> for this virtualhost. If that reverse lookup fails then it will partially disable the virtualhost. If the virtual host is name-based then it will effectively be totally disabled, but if it is IP-based then it will mostly work. However, if httpd should ever have to generate a full URL for the server which includes the server name (such as when a Redirect is issued), then it will fail to generate a valid URL.</p> <p>Here is a snippet that avoids both of these problems:</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost 192.0.2.1&gt;\n  ServerName www.example.dom\n  ServerAdmin webgirl@example.dom\n  DocumentRoot \"/www/example\"\n&lt;/VirtualHost&gt;</pre>   <h2 id=\"denial\">Denial of Service</h2> <p>Consider this configuration snippet:</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost www.example1.dom&gt;\n  ServerAdmin webgirl@example1.dom\n  DocumentRoot \"/www/example1\"\n&lt;/VirtualHost&gt;\n&lt;VirtualHost www.example2.dom&gt;\n  ServerAdmin webguy@example2.dom\n  DocumentRoot \"/www/example2\"\n&lt;/VirtualHost&gt;</pre> <p>Suppose that you've assigned 192.0.2.1 to <code>www.example1.dom</code> and 192.0.2.2 to <code>www.example2.dom</code>. Furthermore, suppose that <code>example1.dom</code> has control of their own DNS. With this config you have put <code>example1.dom</code> into a position where they can steal all traffic destined to <code>example2.dom</code>. To do so, all they have to do is set <code>www.example1.dom</code> to 192.0.2.2. Since they control their own DNS you can't stop them from pointing the <code>www.example1.dom</code> record wherever they wish.</p> <p>Requests coming in to 192.0.2.2 (including all those where users typed in URLs of the form <code>http://www.example2.dom/whatever</code>) will all be served by the <code>example1.dom</code> virtual host. To better understand why this happens requires a more in-depth discussion of how httpd matches up incoming requests with the virtual host that will serve it. A rough document describing this <a href=\"vhosts/details\">is available</a>.</p>   <h2 id=\"main\">The \"main server\" Address</h2> <p><a href=\"vhosts/name-based\">Name-based virtual host support</a> requires httpd to know the IP address(es) of the host that <code class=\"program\"><a href=\"programs/httpd\">httpd</a></code> is running on. To get this address it uses either the global <code class=\"directive\"><a href=\"mod/core#servername\">ServerName</a></code> (if present) or calls the C function <code>gethostname</code> (which should return the same as typing \"hostname\" at the command prompt). Then it performs a DNS lookup on this address. At present there is no way to avoid this lookup.</p> <p>If you fear that this lookup might fail because your DNS server is down then you can insert the hostname in <code>/etc/hosts</code> (where you probably already have it so that the machine can boot properly). Then ensure that your machine is configured to use <code>/etc/hosts</code> in the event that DNS fails. Depending on what OS you are using this might be accomplished by editing <code>/etc/resolv.conf</code>, or maybe <code>/etc/nsswitch.conf</code>.</p> <p>If your server doesn't have to perform DNS for any other reason then you might be able to get away with running httpd with the <code>HOSTRESORDER</code> environment variable set to \"local\". This all depends on what OS and resolver libraries you are using. It also affects CGIs unless you use <code class=\"module\"><a href=\"mod/mod_env\">mod_env</a></code> to control the environment. It's best to consult the man pages or FAQs for your OS.</p>   <h2 id=\"tips\">Tips to Avoid These Problems</h2> <ul> <li> use IP addresses in <code class=\"directive\"><a href=\"mod/core#virtualhost\">VirtualHost</a></code> </li> <li> use IP addresses in <code class=\"directive\"><a href=\"mod/mpm_common#listen\">Listen</a></code> </li> <li> ensure all virtual hosts have an explicit <code class=\"directive\"><a href=\"mod/core#servername\">ServerName</a></code> </li> <li>create a <code>&lt;VirtualHost _default_:*&gt;</code> server that has no pages to serve</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/dns-caveats.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/dns-caveats.html</a>\n  </p>\n</div>\n","custom-error":"<h1>Custom Error Responses</h1>  <p>Although the Apache HTTP Server provides generic error responses in the event of 4xx or 5xx HTTP status codes, these responses are rather stark, uninformative, and can be intimidating to site users. You may wish to provide custom error responses which are either friendlier, or in some language other than English, or perhaps which are styled more in line with your site layout.</p> <p>Customized error responses can be defined for any HTTP status code designated as an error condition - that is, any 4xx or 5xx status.</p> <p>Additionally, a set of values are provided, so that the error document can be customized further based on the values of these variables, using <a href=\"howto/ssi\">Server Side Includes</a>. Or, you can have error conditions handled by a cgi program, or other dynamic handler (PHP, mod_perl, etc) which makes use of these variables.</p>     <h2 id=\"configuration\">Configuration</h2> <p>Custom error documents are configured using the <code class=\"directive\"><a href=\"mod/core#errordocument\">ErrorDocument</a></code> directive, which may be used in global, virtualhost, or directory context. It may be used in .htaccess files if <code class=\"directive\"><a href=\"mod/core#allowoverride\">AllowOverride</a></code> is set to FileInfo.</p> <pre class=\"prettyprint lang-config\">ErrorDocument 500 \"Sorry, our script crashed. Oh dear\"\nErrorDocument 500 /cgi-bin/crash-recover\nErrorDocument 500 http://error.example.com/server_error.html\nErrorDocument 404 /errors/not_found.html\nErrorDocument 401 /subscription/how_to_subscribe.html</pre> <p>The syntax of the <code>ErrorDocument</code> directive is:</p> <pre class=\"prettyprint lang-config\">ErrorDocument &lt;3-digit-code&gt; &lt;action&gt;</pre> <p>where the action will be treated as:</p> <ol> <li>A local URL to redirect to (if the action begins with a \"/\").</li> <li>An external URL to redirect to (if the action is a valid URL).</li> <li>Text to be displayed (if none of the above). The text must be wrapped in quotes (\") if it consists of more than one word.</li> </ol> <p>When redirecting to a local URL, additional environment variables are set so that the response can be further customized. They are not sent to external URLs.</p>   <h2 id=\"variables\">Available Variables</h2> <p>Redirecting to another URL can be useful, but only if some information can be passed which can then be used to explain or log the error condition more clearly.</p> <p>To achieve this, when the error redirect is sent, additional environment variables will be set, which will be generated from the headers provided to the original request by prepending 'REDIRECT_' onto the original header name. This provides the error document the context of the original request.</p> <p>For example, you might receive, in addition to more usual environment variables, the following.</p> <div class=\"example\"><pre>REDIRECT_HTTP_ACCEPT=*/*, image/gif, image/jpeg, image/png\nREDIRECT_HTTP_USER_AGENT=Mozilla/5.0 Fedora/3.5.8-1.fc12 Firefox/3.5.8\nREDIRECT_PATH=.:/bin:/usr/local/bin:/sbin\nREDIRECT_QUERY_STRING=\nREDIRECT_REMOTE_ADDR=121.345.78.123\nREDIRECT_REMOTE_HOST=client.example.com\nREDIRECT_SERVER_NAME=www.example.edu\nREDIRECT_SERVER_PORT=80\nREDIRECT_SERVER_SOFTWARE=Apache/2.2.15\nREDIRECT_URL=/cgi-bin/buggy.pl</pre></div> <p><code>REDIRECT_</code> environment variables are created from the environment variables which existed prior to the redirect. They are renamed with a <code>REDIRECT_</code> prefix, <em>i.e.</em>, <code>HTTP_USER_AGENT</code> becomes <code>REDIRECT_HTTP_USER_AGENT</code>.</p> <p><code>REDIRECT_URL</code>, <code>REDIRECT_STATUS</code>, and <code>REDIRECT_QUERY_STRING</code> are guaranteed to be set, and the other headers will be set only if they existed prior to the error condition.</p> <p><strong>None</strong> of these will be set if the <code class=\"directive\"><a href=\"mod/core#errordocument\">ErrorDocument</a></code> target is an <em>external</em> redirect (anything starting with a scheme name like <code>http:</code>, even if it refers to the same host as the server).</p>   <h2 id=\"custom\">Customizing Error Responses</h2> <p>If you point your <code>ErrorDocument</code> to some variety of dynamic handler such as a server-side include document, CGI script, or some variety of other handler, you may wish to use the available custom environment variables to customize this response.</p> <p>If the ErrorDocument specifies a local redirect to a CGI script, the script should include a \"<code>Status:</code>\" header field in its output in order to ensure the propagation all the way back to the client of the error condition that caused it to be invoked. For instance, a Perl ErrorDocument script might include the following:</p> <pre class=\"prettyprint lang-perl\">...\nprint  \"Content-type: text/html\\n\";\nprintf \"Status: %s Condition Intercepted\\n\", $ENV{\"REDIRECT_STATUS\"};\n...</pre> <p>If the script is dedicated to handling a particular error condition, such as <code>404 Not Found</code>, it can use the specific code and error text instead.</p> <p>Note that if the response contains <code>Location:</code> header (in order to issue a client-side redirect), the script <em>must</em> emit an appropriate <code>Status:</code> header (such as <code>302 Found</code>). Otherwise the <code>Location:</code> header may have no effect.</p>   <h2 id=\"multi-lang\">Multi Language Custom Error Documents</h2> <p>Provided with your installation of the Apache HTTP Server is a directory of custom error documents translated into 16 different languages. There's also a configuration file in the <code>conf/extra</code> configuration directory that can be included to enable this feature.</p> <p>In your server configuration file, you'll see a line such as:</p> <pre class=\"prettyprint lang-config\"># Multi-language error messages\n#Include conf/extra/httpd-multilang-errordoc.conf</pre> <p>Uncommenting this <code>Include</code> line will enable this feature, and provide language-negotiated error messages, based on the language preference set in the client browser.</p> <p>Additionally, these documents contain various of the <code>REDIRECT_</code> variables, so that additional information can be provided to the end-user about what happened, and what they can do now.</p> <p>These documents can be customized to whatever degree you wish to provide more useful information to users about your site, and what they can expect to find there.</p> <p><code class=\"module\"><a href=\"mod/mod_include\">mod_include</a></code> and <code class=\"module\"><a href=\"mod/mod_negotiation\">mod_negotiation</a></code> must be enabled to use this feature.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/custom-error.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/custom-error.html</a>\n  </p>\n</div>\n","socache":"<h1>Shared Object Cache in Apache HTTP Server</h1>  <p>The Shared Object Cache provides a means to share simple data across all a server's workers, regardless of <a href=\"mpm\">thread and process models</a>. It is used where the advantages of sharing data across processes outweigh the performance overhead of inter-process communication.</p>    <h2 id=\"providers\">Shared Object Cache Providers</h2> <p>The shared object cache as such is an abstraction. Four different modules implement it. To use the cache, one or more of these modules must be present, and configured.</p> <p>The only configuration required is to select which cache provider to use. This is the responsibility of modules using the cache, and they enable selection using directives such as <code class=\"directive\"><a href=\"mod/mod_cache_socache#cachesocache\">CacheSocache</a></code>, <code class=\"directive\"><a href=\"mod/mod_authn_socache#authncachesocache\">AuthnCacheSOCache</a></code>, <code class=\"directive\"><a href=\"mod/mod_ssl#sslsessioncache\">SSLSessionCache</a></code>, and <code class=\"directive\"><a href=\"mod/mod_ssl#sslstaplingcache\">SSLStaplingCache</a></code>.</p> <p>Currently available providers are:</p> <dl> <dt>\"dbm\" (<code class=\"module\"><a href=\"mod/mod_socache_dbm\">mod_socache_dbm</a></code>)</dt> <dd>This makes use of a DBM hash file. The choice of underlying DBM used may be configurable if the installed APR version supports multiple DBM implementations.</dd> <dt>\"dc\" (<code class=\"module\"><a href=\"mod/mod_socache_dc\">mod_socache_dc</a></code>)</dt> <dd>This makes use of the <a href=\"http://distcache.sourceforge.net/\">distcache</a> distributed session caching libraries.</dd> <dt>\"memcache\" (<code class=\"module\"><a href=\"mod/mod_socache_memcache\">mod_socache_memcache</a></code>)</dt> <dd>This makes use of the <a href=\"http://memcached.org/\">memcached</a> high-performance, distributed memory object caching system.</dd> <dt>\"shmcb\" (<code class=\"module\"><a href=\"mod/mod_socache_shmcb\">mod_socache_shmcb</a></code>)</dt> <dd>This makes use of a high-performance cyclic buffer inside a shared memory segment.</dd> </dl> <p>The API provides the following functions:</p> <dl> <dt>const char *create(ap_socache_instance_t **instance, const char *arg, apr_pool_t *tmp, apr_pool_t *p);</dt> <dd>Create a session cache based on the given configuration string. The instance pointer returned in the instance paramater will be passed as the first argument to subsequent invocations.</dd> <dt>apr_status_t init(ap_socache_instance_t *instance, const char *cname, const struct ap_socache_hints *hints, server_rec *s, apr_pool_t *pool)</dt> <dd>Initialize the cache. The cname must be of maximum length 16 characters, and uniquely identifies the consumer of the cache within the server; using the module name is recommended, e.g. \"mod_ssl-sess\". This string may be used within a filesystem path so use of only alphanumeric [a-z0-9_-] characters is recommended. If hints is non-NULL, it gives a set of hints for the provider. Return APR error code.</dd> <dt>void destroy(ap_socache_instance_t *instance, server_rec *s)</dt> <dd>Destroy a given cache instance object.</dd> <dt>apr_status_t store(ap_socache_instance_t *instance, server_rec *s, const unsigned char *id, unsigned int idlen, apr_time_t expiry, unsigned char *data, unsigned int datalen, apr_pool_t *pool)</dt> <dd>Store an object in a cache instance.</dd> <dt>apr_status_t retrieve(ap_socache_instance_t *instance, server_rec *s, const unsigned char *id, unsigned int idlen, unsigned char *data, unsigned int *datalen, apr_pool_t *pool)</dt> <dd>Retrieve a cached object.</dd> <dt>apr_status_t remove(ap_socache_instance_t *instance, server_rec *s, const unsigned char *id, unsigned int idlen, apr_pool_t *pool)</dt> <dd>Remove an object from the cache.</dd> <dt>void status(ap_socache_instance_t *instance, request_rec *r, int flags)</dt> <dd>Dump the status of a cache instance for mod_status.</dd> <dt>apr_status_t iterate(ap_socache_instance_t *instance, server_rec *s, void *userctx, ap_socache_iterator_t *iterator, apr_pool_t *pool)</dt> <dd>Dump all cached objects through an iterator callback.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/socache.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/socache.html</a>\n  </p>\n</div>\n","vhosts/fd-limits":"<h1>File Descriptor Limits</h1>  <p>When using a large number of Virtual Hosts, Apache may run out of available file descriptors (sometimes called <cite>file handles</cite>) if each Virtual Host specifies different log files. The total number of file descriptors used by Apache is one for each distinct error log file, one for every other log file directive, plus 10-20 for internal use. Unix operating systems limit the number of file descriptors that may be used by a process; the limit is typically 64, and may usually be increased up to a large hard-limit.</p> <p>Although Apache attempts to increase the limit as required, this may not work if:</p> <ol> <li>Your system does not provide the <code>setrlimit()</code> system call.</li> <li>The <code>setrlimit(RLIMIT_NOFILE)</code> call does not function on your system (such as Solaris 2.3)</li> <li>The number of file descriptors required exceeds the hard limit.</li> <li>Your system imposes other limits on file descriptors, such as a limit on stdio streams only using file descriptors below 256. (Solaris 2)</li> </ol> <p>In the event of problems you can:</p> <ul> <li>Reduce the number of log files; don't specify log files in the <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> sections, but only log to the main log files. (See <a href=\"#splitlogs\">Splitting up your log files</a>, below, for more information on doing this.)</li> <li> If you system falls into 1 or 2 (above), then increase the file descriptor limit before starting Apache, using a script like <div class=\"example\"><pre>#!/bin/sh\nulimit -S -n 100\nexec httpd</pre></div> </li> </ul>    <h2 id=\"splitlogs\">Splitting up your log files</h2> <p>If you want to log multiple virtual hosts to the same log file, you may want to split up the log files afterwards in order to run statistical analysis of the various virtual hosts. This can be accomplished in the following manner.</p> <p>First, you will need to add the virtual host information to the log entries. This can be done using the <code class=\"directive\"><a href=\"../mod/mod_log_config#logformat\"> LogFormat</a></code> directive, and the <code>%v</code> variable. Add this to the beginning of your log format string:</p> <pre class=\"prettyprint lang-config\">LogFormat \"%v %h %l %u %t \\\"%r\\\" %&gt;s %b\" vhost\nCustomLog logs/multiple_vhost_log vhost</pre> <p>This will create a log file in the common log format, but with the canonical virtual host (whatever appears in the <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> directive) prepended to each line. (See <code class=\"module\"><a href=\"../mod/mod_log_config\">mod_log_config</a></code> for more about customizing your log files.)</p> <p>When you wish to split your log file into its component parts (one file per virtual host) you can use the program <code><a href=\"https://httpd.apache.org/docs/2.4/en/programs/other.html\">split-logfile</a></code> to accomplish this. You'll find this program in the <code>support</code> directory of the Apache distribution.</p> <p>Run this program with the command:</p> <div class=\"example\"><pre>split-logfile &lt; /logs/multiple_vhost_log</pre></div> <p>This program, when run with the name of your vhost log file, will generate one file for each virtual host that appears in your log file. Each file will be called <code>hostname.log</code>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/vhosts/fd-limits.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/vhosts/fd-limits.html</a>\n  </p>\n</div>\n","ssl/ssl_howto":"<h1>SSL/TLS Strong Encryption: How-To</h1>  <p>This document is intended to get you started, and get a few things working. You are strongly encouraged to read the rest of the SSL documentation, and arrive at a deeper understanding of the material, before progressing to the advanced techniques.</p>     <h2 id=\"configexample\">Basic Configuration Example</h2> <p>Your SSL configuration will need to contain, at minimum, the following directives.</p> <pre class=\"prettyprint lang-config\">LoadModule ssl_module modules/mod_ssl.so\n\nListen 443\n&lt;VirtualHost *:443&gt;\n    ServerName www.example.com\n    SSLEngine on\n    SSLCertificateFile \"/path/to/www.example.com.cert\"\n    SSLCertificateKeyFile \"/path/to/www.example.com.key\"\n&lt;/VirtualHost&gt;</pre>   <h2 id=\"ciphersuites\">Cipher Suites and Enforcing Strong Security</h2> <ul> <li><a href=\"#onlystrong\">How can I create an SSL server which accepts strong encryption only?</a></li> <li><a href=\"#strongurl\">How can I create an SSL server which accepts all types of ciphers in general, but requires a strong cipher for access to a particular URL?</a></li> </ul> <h3><a name=\"onlystrong\" id=\"onlystrong\">How can I create an SSL server which accepts strong encryption only?</a></h3> <p>The following enables only the strongest ciphers:</p> <pre class=\"prettyprint lang-config\">SSLCipherSuite HIGH:!aNULL:!MD5</pre> <p>While with the following configuration you specify a preference for specific speed-optimized ciphers (which will be selected by mod_ssl, provided that they are supported by the client):</p> <pre class=\"prettyprint lang-config\">SSLCipherSuite RC4-SHA:AES128-SHA:HIGH:!aNULL:!MD5\nSSLHonorCipherOrder on</pre> <h3><a name=\"strongurl\" id=\"strongurl\">How can I create an SSL server which accepts all types of ciphers in general, but requires a strong ciphers for access to a particular URL?</a></h3> <p>Obviously, a server-wide <code class=\"directive\"><a href=\"../mod/mod_ssl#sslciphersuite\">SSLCipherSuite</a></code> which restricts ciphers to the strong variants, isn't the answer here. However, <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> can be reconfigured within <code>Location</code> blocks, to give a per-directory solution, and can automatically force a renegotiation of the SSL parameters to meet the new configuration. This can be done as follows:</p> <pre class=\"prettyprint lang-config\"># be liberal in general\nSSLCipherSuite ALL:!aNULL:RC4+RSA:+HIGH:+MEDIUM:+LOW:+EXP:+eNULL\n\n&lt;Location \"/strong/area\"&gt;\n# but https://hostname/strong/area/ and below\n# requires strong ciphers\nSSLCipherSuite HIGH:!aNULL:!MD5\n&lt;/Location&gt;</pre>   <h2 id=\"ocspstapling\">OCSP Stapling</h2> <p>The Online Certificate Status Protocol (OCSP) is a mechanism for determining whether or not a server certificate has been revoked, and OCSP Stapling is a special form of this in which the server, such as httpd and mod_ssl, maintains current OCSP responses for its certificates and sends them to clients which communicate with the server. Most certificates contain the address of an OCSP responder maintained by the issuing Certificate Authority, and mod_ssl can communicate with that responder to obtain a signed response that can be sent to clients communicating with the server.</p> <p>Because the client can obtain the certificate revocation status from the server, without requiring an extra connection from the client to the Certificate Authority, OCSP Stapling is the preferred way for the revocation status to be obtained. Other benefits of eliminating the communication between clients and the Certificate Authority are that the client browsing history is not exposed to the Certificate Authority and obtaining status is more reliable by not depending on potentially heavily loaded Certificate Authority servers.</p> <p>Because the response obtained by the server can be reused for all clients using the same certificate during the time that the response is valid, the overhead for the server is minimal.</p> <p>Once general SSL support has been configured properly, enabling OCSP Stapling generally requires only very minor modifications to the httpd configuration  the addition of these two directives:</p> <pre class=\"prettyprint lang-config\">SSLUseStapling On\nSSLStaplingCache \"shmcb:logs/ssl_stapling(32768)\"</pre> <p>These directives are placed at global scope (i.e., not within a virtual host definition) wherever other global SSL configuration directives are placed, such as in <code>conf/extra/httpd-ssl.conf</code> for normal open source builds of httpd, <code>/etc/apache2/mods-enabled/ssl.conf</code> for the Ubuntu or Debian-bundled httpd, etc.</p> <p>The path on the <code class=\"directive\">SSLStaplingCache</code> directive (e.g., <code>logs/</code>) should match the one on the <code class=\"directive\">SSLSessionCache</code> directive. This path is relative to <code class=\"directive\">ServerRoot</code>.</p> <p>This particular <code class=\"directive\">SSLStaplingCache</code> directive requires <code class=\"module\"><a href=\"../mod/mod_socache_shmcb\">mod_socache_shmcb</a></code> (from the <code>shmcb</code> prefix on the directive's argument). This module is usually enabled already for <code class=\"directive\">SSLSessionCache</code> or on behalf of some module other than <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code>. If you enabled an SSL session cache using a mechanism other than <code class=\"module\"><a href=\"../mod/mod_socache_shmcb\">mod_socache_shmcb</a></code>, use that alternative mechanism for <code class=\"directive\">SSLStaplingCache</code> as well. For example:</p> <pre class=\"prettyprint lang-config\">SSLSessionCache \"dbm:logs/ssl_scache\"\nSSLStaplingCache \"dbm:logs/ssl_stapling\"</pre> <p>You can use the openssl command-line program to verify that an OCSP response is sent by your server:</p> <pre>$ openssl s_client -connect www.example.com:443 -status -servername www.example.com\n...\nOCSP response: \n======================================\nOCSP Response Data:\n    OCSP Response Status: successful (0x0)\n    Response Type: Basic OCSP Response\n...\n    Cert Status: Good\n...</pre> <p>The following sections highlight the most common situations which require further modification to the configuration. Refer also to the <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> reference manual.</p> <h3>If more than a few SSL certificates are used for the server</h3> <p>OCSP responses are stored in the SSL stapling cache. While the responses are typically a few hundred to a few thousand bytes in size, mod_ssl supports OCSP responses up to around 10K bytes in size. With more than a few certificates, the stapling cache size (32768 bytes in the example above) may need to be increased. Error message AH01929 will be logged in case of an error storing a response.</p> <h3>If the certificate does not point to an OCSP responder, or if a different address must be used</h3> <p>Refer to the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslstaplingforceurl\">SSLStaplingForceURL</a></code> directive.</p> <p>You can confirm that a server certificate points to an OCSP responder using the openssl command-line program, as follows:</p> <pre>$ openssl x509 -in ./www.example.com.crt -text | grep 'OCSP.*http'\nOCSP - URI:http://ocsp.example.com</pre> <p>If the OCSP URI is provided and the web server can communicate to it directly without using a proxy, no configuration is required. Note that firewall rules that control outbound connections from the web server may need to be adjusted.</p> <p>If no OCSP URI is provided, contact your Certificate Authority to determine if one is available; if so, configure it with <code class=\"directive\"><a href=\"../mod/mod_ssl#sslstaplingforceurl\">SSLStaplingForceURL</a></code> in the virtual host that uses the certificate.</p> <h3>If multiple SSL-enabled virtual hosts are configured and OCSP Stapling should be disabled for some</h3> <p>Add <code>SSLUseStapling Off</code> to the virtual hosts for which OCSP Stapling should be disabled.</p> <h3>If the OCSP responder is slow or unreliable</h3> <p>Several directives are available to handle timeouts and errors. Refer to the documentation for the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslstaplingfaketrylater\">SSLStaplingFakeTryLater</a></code>, <code class=\"directive\"><a href=\"../mod/mod_ssl#sslstaplingrespondertimeout\">SSLStaplingResponderTimeout</a></code>, and <code class=\"directive\"><a href=\"../mod/mod_ssl#sslstaplingreturnrespondererrors\">SSLStaplingReturnResponderErrors</a></code> directives.</p> <h3>If mod_ssl logs error AH02217</h3> <pre>AH02217: ssl_stapling_init_cert: Can't retrieve issuer certificate!</pre> <p>In order to support OCSP Stapling when a particular server certificate is used, the certificate chain for that certificate must be configured. If it was not configured as part of enabling SSL, the AH02217 error will be issued when stapling is enabled, and an OCSP response will not be provided for clients using the certificate.</p> <p>Refer to the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslcertificatechainfile\">SSLCertificateChainFile</a></code> and <code class=\"directive\"><a href=\"../mod/mod_ssl#sslcertificatefile\">SSLCertificateFile</a></code> for instructions for configuring the certificate chain.</p>   <h2 id=\"accesscontrol\">Client Authentication and Access Control</h2> <ul> <li><a href=\"#allclients\">How can I force clients to authenticate using certificates?</a></li> <li><a href=\"#arbitraryclients\">How can I force clients to authenticate using certificates for a particular URL, but still allow arbitrary clients to access the rest of the server?</a></li> <li><a href=\"#certauthenticate\">How can I allow only clients who have certificates to access a particular URL, but allow all clients to access the rest of the server?</a></li> <li><a href=\"#intranet\">How can I require HTTPS with strong ciphers, and either basic authentication or client certificates, for access to part of the Intranet website, for clients coming from the Internet?</a></li> </ul> <h3><a name=\"allclients\" id=\"allclients\">How can I force clients to authenticate using certificates?</a></h3> <p>When you know all of your users (eg, as is often the case on a corporate Intranet), you can require plain certificate authentication. All you need to do is to create client certificates signed by your own CA certificate (<code>ca.crt</code>) and then verify the clients against this certificate.</p> <pre class=\"prettyprint lang-config\"># require a client certificate which has to be directly\n# signed by our CA certificate in ca.crt\nSSLVerifyClient require\nSSLVerifyDepth 1\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"</pre> <h3><a name=\"arbitraryclients\" id=\"arbitraryclients\">How can I force clients to authenticate using certificates for a particular URL, but still allow arbitrary clients to access the rest of the server?</a></h3> <p>To force clients to authenticate using certificates for a particular URL, you can use the per-directory reconfiguration features of <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code>:</p> <pre class=\"prettyprint lang-config\">SSLVerifyClient none\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"\n\n&lt;Location \"/secure/area\"&gt;\nSSLVerifyClient require\nSSLVerifyDepth 1\n&lt;/Location&gt;</pre> <h3><a name=\"certauthenticate\" id=\"certauthenticate\">How can I allow only clients who have certificates to access a particular URL, but allow all clients to access the rest of the server?</a></h3> <p>The key to doing this is checking that part of the client certificate matches what you expect. Usually this means checking all or part of the Distinguished Name (DN), to see if it contains some known string. There are two ways to do this, using either <code class=\"module\"><a href=\"../mod/mod_auth_basic\">mod_auth_basic</a></code> or <code class=\"directive\"><a href=\"../mod/mod_ssl#sslrequire\">SSLRequire</a></code>.</p> <p>The <code class=\"module\"><a href=\"../mod/mod_auth_basic\">mod_auth_basic</a></code> method is generally required when the certificates are completely arbitrary, or when their DNs have no common fields (usually the organisation, etc.). In this case, you should establish a password database containing <em>all</em> clients allowed, as follows:</p> <pre class=\"prettyprint lang-config\">SSLVerifyClient      none\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"\nSSLCACertificatePath \"conf/ssl.crt\"\n\n&lt;Directory \"/usr/local/apache2/htdocs/secure/area\"&gt;\n    SSLVerifyClient      require\n    SSLVerifyDepth       5\n    SSLOptions           +FakeBasicAuth\n    SSLRequireSSL\n    AuthName             \"Snake Oil Authentication\"\n    AuthType             Basic\n    AuthBasicProvider    file\n    AuthUserFile         \"/usr/local/apache2/conf/httpd.passwd\"\n    Require              valid-user\n&lt;/Directory&gt;</pre> <p>The password used in this example is the DES encrypted string \"password\". See the <code class=\"directive\"><a href=\"../mod/mod_ssl#ssloptions\">SSLOptions</a></code> docs for more information.</p> <div class=\"example\">\n<h3>httpd.passwd</h3>\n<pre>/C=DE/L=Munich/O=Snake Oil, Ltd./OU=Staff/CN=Foo:xxj31ZMTZzkVA\n/C=US/L=S.F./O=Snake Oil, Ltd./OU=CA/CN=Bar:xxj31ZMTZzkVA\n/C=US/L=L.A./O=Snake Oil, Ltd./OU=Dev/CN=Quux:xxj31ZMTZzkVA</pre>\n</div> <p>When your clients are all part of a common hierarchy, which is encoded into the DN, you can match them more easily using <code class=\"directive\"><a href=\"../mod/mod_ssl#sslrequire\">SSLRequire</a></code>, as follows:</p> <pre class=\"prettyprint lang-config\">SSLVerifyClient      none\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"\nSSLCACertificatePath \"conf/ssl.crt\"\n\n&lt;Directory \"/usr/local/apache2/htdocs/secure/area\"&gt;\n  SSLVerifyClient      require\n  SSLVerifyDepth       5\n  SSLOptions           +FakeBasicAuth\n  SSLRequireSSL\n  SSLRequire       %{SSL_CLIENT_S_DN_O}  eq \"Snake Oil, Ltd.\" \\\n               and %{SSL_CLIENT_S_DN_OU} in {\"Staff\", \"CA\", \"Dev\"}\n&lt;/Directory&gt;</pre> <h3><a name=\"intranet\" id=\"intranet\">How can I require HTTPS with strong ciphers, and either basic authentication or client certificates, for access to part of the Intranet website, for clients coming from the Internet? I still want to allow plain HTTP access for clients on the Intranet.</a></h3> <p>These examples presume that clients on the Intranet have IPs in the range 192.168.1.0/24, and that the part of the Intranet website you want to allow internet access to is <code>/usr/local/apache2/htdocs/subarea</code>. This configuration should remain outside of your HTTPS virtual host, so that it applies to both HTTPS and HTTP.</p> <pre class=\"prettyprint lang-config\">SSLCACertificateFile \"conf/ssl.crt/company-ca.crt\"\n\n&lt;Directory \"/usr/local/apache2/htdocs\"&gt;\n    #   Outside the subarea only Intranet access is granted\n    Require              ip 192.168.1.0/24\n&lt;/Directory&gt;\n\n&lt;Directory \"/usr/local/apache2/htdocs/subarea\"&gt;\n    #   Inside the subarea any Intranet access is allowed\n    #   but from the Internet only HTTPS + Strong-Cipher + Password\n    #   or the alternative HTTPS + Strong-Cipher + Client-Certificate\n    \n    #   If HTTPS is used, make sure a strong cipher is used.\n    #   Additionally allow client certs as alternative to basic auth.\n    SSLVerifyClient      optional\n    SSLVerifyDepth       1\n    SSLOptions           +FakeBasicAuth +StrictRequire\n    SSLRequire           %{SSL_CIPHER_USEKEYSIZE} &gt;= 128\n    \n    #   Force clients from the Internet to use HTTPS\n    RewriteEngine        on\n    RewriteCond          \"%{REMOTE_ADDR}\" \"!^192\\.168\\.1\\.[0-9]+$\"\n    RewriteCond          \"%{HTTPS}\" \"!=on\"\n    RewriteRule          \".\" \"-\" [F]\n    \n    #   Allow Network Access and/or Basic Auth\n    Satisfy              any\n    \n    #   Network Access Control\n    Require              ip 192.168.1.0/24\n    \n    #   HTTP Basic Authentication\n    AuthType             basic\n    AuthName             \"Protected Intranet Area\"\n    AuthBasicProvider    file\n    AuthUserFile         \"conf/protected.passwd\"\n    Require              valid-user\n&lt;/Directory&gt;</pre>   <h2 id=\"logging\">Logging</h2> <p><code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> can log extremely verbose debugging information to the error log, when its <code class=\"directive\"><a href=\"../mod/core#loglevel\">LogLevel</a></code> is set to the higher trace levels. On the other hand, on a very busy server, level <code>info</code> may already be too much. Remember that you can configure the <code class=\"directive\"><a href=\"../mod/core#loglevel\">LogLevel</a></code> per module to suite your needs.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/ssl/ssl_howto.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/ssl/ssl_howto.html</a>\n  </p>\n</div>\n","rewrite/access":"<h1>Using mod_rewrite to control access</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It describes how you can use <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> to control access to various resources, and other related techniques. This includes many examples of common uses of mod_rewrite, including detailed descriptions of how each works.</p> <div class=\"warning\">Note that many of these examples won't work unchanged in your particular server configuration, so it's important that you understand them, rather than merely cutting and pasting the examples into your configuration.</div>     <h2 id=\"blocked-inline-images\">Forbidding Image \"Hotlinking\"</h2> <dl> <dt>Description:</dt> <dd> <p>The following technique forbids the practice of other sites including your images inline in their pages. This practice is often referred to as \"hotlinking\", and results in your bandwidth being used to serve content for someone else's site.</p> </dd> <dt>Solution:</dt> <dd> <p>This technique relies on the value of the <code>HTTP_REFERER</code> variable, which is optional. As such, it's possible for some people to circumvent this limitation. However, most users will experience the failed request, which should, over time, result in the image being removed from that other site.</p> <p>There are several ways that you can handle this situation.</p> <p>In this first example, we simply deny the request, if it didn't initiate from a page on our site. For the purpose of this example, we assume that our site is <code>www.example.com</code>.</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_REFERER}\" \"!^$\"\nRewriteCond \"%{HTTP_REFERER}\" \"!www.example.com\" [NC]\nRewriteRule \"\\.(gif|jpg|png)$\"    \"-\"   [F,NC]</pre> <p>In this second example, instead of failing the request, we display an alternate image instead.</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_REFERER}\" \"!^$\"\nRewriteCond \"%{HTTP_REFERER}\" \"!www.example.com\" [NC]\nRewriteRule \"\\.(gif|jpg|png)$\"    \"/images/go-away.png\"   [R,NC]</pre> <p>In the third example, we redirect the request to an image on some other site.</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_REFERER}\" \"!^$\"\nRewriteCond \"%{HTTP_REFERER}\" \"!www.example.com\" [NC]\nRewriteRule \"\\.(gif|jpg|png)$\" \"http://other.example.com/image.gif\"   [R,NC]</pre> <p>Of these techniques, the last two tend to be the most effective in getting people to stop hotlinking your images, because they will simply not see the image that they expected to see.</p> </dd> <dt>Discussion:</dt> <dd> <p>If all you wish to do is deny access to the resource, rather than redirecting that request elsewhere, this can be accomplished without the use of mod_rewrite:</p> <pre class=\"prettyprint lang-config\">SetEnvIf Referer \"example\\.com\" localreferer\n&lt;FilesMatch \"\\.(jpg|png|gif)$\"&gt;\n    Require env localreferer\n&lt;/FilesMatch&gt;</pre> </dd> </dl>   <h2 id=\"blocking-of-robots\">Blocking of Robots</h2> <dl> <dt>Description:</dt> <dd> <p> In this recipe, we discuss how to block persistent requests from a particular robot, or user agent.</p> <p>The standard for robot exclusion defines a file, <code>/robots.txt</code> that specifies those portions of your website where you wish to exclude robots. However, some robots do not honor these files. </p> <p>Note that there are methods of accomplishing this which do not use mod_rewrite. Note also that any technique that relies on the clients <code>USER_AGENT</code> string can be circumvented very easily, since that string can be changed.</p> </dd> <dt>Solution:</dt> <dd> <p>We use a ruleset that specifies the directory to be protected, and the client <code>USER_AGENT</code> that identifies the malicious or persistent robot.</p> <p>In this example, we are blocking a robot called <code>NameOfBadRobot</code> from a location <code>/secret/files</code>. You may also specify an IP address range, if you are trying to block that user agent only from the particular source.</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_USER_AGENT}\"   \"^NameOfBadRobot\"\nRewriteCond \"%{REMOTE_ADDR}\"       \"=123\\.45\\.67\\.[8-9]\"\nRewriteRule \"^/secret/files/\"   \"-\"   [F]</pre> </dd> <dt>Discussion:</dt> <dd> <p> Rather than using mod_rewrite for this, you can accomplish the same end using alternate means, as illustrated here: </p> <pre class=\"prettyprint lang-config\">SetEnvIfNoCase User-Agent \"^NameOfBadRobot\" goaway\n&lt;Location \"/secret/files\"&gt;\n    &lt;RequireAll&gt;\n        Require all granted\n        Require not env goaway\n    &lt;/RequireAll&gt;\n&lt;/Location&gt;</pre> <p> As noted above, this technique is trivial to circumvent, by simply modifying the <code>USER_AGENT</code> request header. If you are experiencing a sustained attack, you should consider blocking it at a higher level, such as at your firewall. </p> </dd> </dl>   <h2 id=\"host-deny\">Denying Hosts in a Blacklist</h2> <dl> <dt>Description:</dt> <dd> <p>We wish to maintain a blacklist of hosts, rather like <code>hosts.deny</code>, and have those hosts blocked from accessing our server.</p> </dd> <dt>Solution:</dt> <dd> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteMap    hosts-deny  \"txt:/path/to/hosts.deny\"\nRewriteCond   \"${hosts-deny:%{REMOTE_ADDR}|NOT-FOUND}\" \"!=NOT-FOUND\" [OR]\nRewriteCond   \"${hosts-deny:%{REMOTE_HOST}|NOT-FOUND}\" \"!=NOT-FOUND\"\nRewriteRule   \"^\"  \"-\"  [F]</pre> <div class=\"example\"><pre>##\n## hosts.deny\n##\n## ATTENTION! This is a map, not a list, even when we treat it as such.\n## mod_rewrite parses it for key/value pairs, so at least a\n## dummy value \"-\" must be present for each entry.\n##\n\n193.102.180.41 -\nbsdti1.sdm.de -\n192.76.162.40 -</pre></div> </dd> <dt>Discussion:</dt> <dd> <p> The second RewriteCond assumes that you have HostNameLookups turned on, so that client IP addresses will be resolved. If that's not the case, you should drop the second RewriteCond, and drop the <code>[OR]</code> flag from the first RewriteCond. </p> </dd> </dl>   <h2 id=\"referer-deflector\">Referer-based Deflector</h2> <dl> <dt>Description:</dt> <dd> <p>Redirect requests based on the Referer from which the request came, with different targets per Referer.</p> </dd> <dt>Solution:</dt> <dd> <p>The following ruleset uses a map file to associate each Referer with a redirection target.</p> <pre class=\"prettyprint lang-config\">RewriteMap  deflector \"txt:/path/to/deflector.map\"\n\nRewriteCond \"%{HTTP_REFERER}\" !=\"\"\nRewriteCond \"${deflector:%{HTTP_REFERER}}\" \"=-\"\nRewriteRule \"^\" \"%{HTTP_REFERER}\" [R,L]\n\nRewriteCond \"%{HTTP_REFERER}\" !=\"\"\nRewriteCond \"${deflector:%{HTTP_REFERER}|NOT-FOUND}\" \"!=NOT-FOUND\"\nRewriteRule \"^\" \"${deflector:%{HTTP_REFERER}}\" [R,L]</pre> <p>The map file lists redirection targets for each referer, or, if we just wish to redirect back to where they came from, a \"-\" is placed in the map:</p> <pre class=\"prettyprint lang-config\">##\n##  deflector.map\n##\n\nhttp://badguys.example.com/bad/index.html    -\nhttp://badguys.example.com/bad/index2.html   -\nhttp://badguys.example.com/bad/index3.html   http://somewhere.example.com/</pre> </dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/access.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/access.html</a>\n  </p>\n</div>\n","rewrite/vhosts":"<h1>Dynamic mass virtual hosts with mod_rewrite</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It describes how you can use <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> to create dynamically configured virtual hosts.</p> <div class=\"warning\">mod_rewrite is not the best way to configure virtual hosts. You should first consider the <a href=\"../vhosts/mass\">alternatives</a> before resorting to mod_rewrite. See also the \"<a href=\"avoid#vhosts\">how to avoid mod_rewrite</a> document.</div>     <h2 id=\"per-hostname\">Virtual Hosts For Arbitrary Hostnames</h2> <dl> <dt>Description:</dt> <dd> <p>We want to automatically create a virtual host for every hostname which resolves in our domain, without having to create new VirtualHost sections.</p> <p>In this recipe, we assume that we'll be using the hostname <code>www.SITE.example.com</code> for each user, and serve their content out of <code>/home/SITE/www</code>.</p> </dd> <dt>Solution:</dt> <dd> <pre class=\"prettyprint lang-config\">RewriteEngine on\n\nRewriteMap    lowercase int:tolower\n\nRewriteCond   \"${lowercase:%{<strong>HTTP_HOST</strong>}}\"   \"^www\\.<strong>([^.]+)</strong>\\.example\\.com$\"\nRewriteRule   \"^(.*)\" \"/home/<strong>%1</strong>/www$1\"</pre> </dd> <dt>Discussion</dt> <dd> <div class=\"warning\">You will need to take care of the DNS resolution - Apache does not handle name resolution. You'll need either to create CNAME records for each hostname, or a DNS wildcard record. Creating DNS records is beyond the scope of this document.</div> <p>The internal <code>tolower</code> RewriteMap directive is used to ensure that the hostnames being used are all lowercase, so that there is no ambiguity in the directory structure which must be created.</p> <p>Parentheses used in a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> are captured into the backreferences <code>%1</code>, <code>%2</code>, etc, while parentheses used in <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> are captured into the backreferences <code>$1</code>, <code>$2</code>, etc.</p> <p> As with many techniques discussed in this document, mod_rewrite really isn't the best way to accomplish this task. You should, instead, consider using <code class=\"module\"><a href=\"../mod/mod_vhost_alias\">mod_vhost_alias</a></code> instead, as it will much more gracefully handle anything beyond serving static files, such as any dynamic content, and Alias resolution. </p> </dd> </dl>   <h2 id=\"simple.rewrite\">Dynamic Virtual Hosts Using <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>\n</h2> <p>This extract from <code>httpd.conf</code> does the same thing as <a href=\"#per-hostname\">the first example</a>. The first half is very similar to the corresponding part above, except for some changes, required for backward compatibility and to make the <code>mod_rewrite</code> part work properly; the second half configures <code>mod_rewrite</code> to do the actual work.</p> <p>Because <code>mod_rewrite</code> runs before other URI translation modules (e.g., <code>mod_alias</code>), <code>mod_rewrite</code> must be told to explicitly ignore any URLs that would have been handled by those modules. And, because these rules would otherwise bypass any <code>ScriptAlias</code> directives, we must have <code>mod_rewrite</code> explicitly enact those mappings.</p> <pre class=\"prettyprint lang-config\"># get the server name from the Host: header\nUseCanonicalName Off\n\n# splittable logs\nLogFormat \"%{Host}i %h %l %u %t \\\"%r\\\" %s %b\" vcommon\nCustomLog \"logs/access_log\" vcommon\n\n&lt;Directory \"/www/hosts\"&gt;\n    # ExecCGI is needed here because we can't force\n    # CGI execution in the way that ScriptAlias does\n    Options FollowSymLinks ExecCGI\n&lt;/Directory&gt;\n\nRewriteEngine On\n\n# a ServerName derived from a Host: header may be any case at all\nRewriteMap  lowercase  int:tolower\n\n## deal with normal documents first:\n# allow Alias \"/icons/\" to work - repeat for other aliases\nRewriteCond  \"%{REQUEST_URI}\"  \"!^/icons/\"\n# allow CGIs to work\nRewriteCond  \"%{REQUEST_URI}\"  \"!^/cgi-bin/\"\n# do the magic\nRewriteRule  \"^/(.*)$\"  \"/www/hosts/${lowercase:%{SERVER_NAME}}/docs/$1\"\n\n## and now deal with CGIs - we have to force a handler\nRewriteCond  \"%{REQUEST_URI}\"  \"^/cgi-bin/\"\nRewriteRule  \"^/(.*)$\"  \"/www/hosts/${lowercase:%{SERVER_NAME}}/cgi-bin/$1\"  [H=cgi-script]</pre>   <h2 id=\"xtra-conf\">Using a Separate Virtual Host Configuration File</h2> <p>This arrangement uses more advanced <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> features to work out the translation from virtual host to document root, from a separate configuration file. This provides more flexibility, but requires more complicated configuration.</p> <p>The <code>vhost.map</code> file should look something like this:</p> <div class=\"example\"><pre>customer-1.example.com /www/customers/1\ncustomer-2.example.com /www/customers/2\n# ...\ncustomer-N.example.com /www/customers/N</pre></div> <p>The <code>httpd.conf</code> should contain the following:</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\n\nRewriteMap   lowercase  int:tolower\n\n# define the map file\nRewriteMap   vhost      \"txt:/www/conf/vhost.map\"\n\n# deal with aliases as above\nRewriteCond  \"%{REQUEST_URI}\"               \"!^/icons/\"\nRewriteCond  \"%{REQUEST_URI}\"               \"!^/cgi-bin/\"\nRewriteCond  \"${lowercase:%{SERVER_NAME}}\"  \"^(.+)$\"\n# this does the file-based remap\nRewriteCond  \"${vhost:%1}\"                  \"^(/.*)$\"\nRewriteRule  \"^/(.*)$\"                      \"%1/docs/$1\"\n\nRewriteCond  \"%{REQUEST_URI}\"               \"^/cgi-bin/\"\nRewriteCond  \"${lowercase:%{SERVER_NAME}}\"  \"^(.+)$\"\nRewriteCond  \"${vhost:%1}\"                  \"^(/.*)$\"\nRewriteRule  \"^/(.*)$\"                      \"%1/cgi-bin/$1\" [H=cgi-script]</pre><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/vhosts.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/vhosts.html</a>\n  </p>\n</div>\n","rewrite/proxy":"<h1>Using mod_rewrite for Proxying</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It describes how to use the RewriteRule's [P] flag to proxy content to another server. A number of recipes are provided that describe common scenarios.</p>     <h2 id=\"dynamic-proxy\">Proxying Content with mod_rewrite</h2> <dl> <dt>Description:</dt> <dd> <p> mod_rewrite provides the [P] flag, which allows URLs to be passed, via mod_proxy, to another server. Two examples are given here. In one example, a URL is passed directly to another server, and served as though it were a local URL. In the other example, we proxy missing content to a back-end server.</p> </dd> <dt>Solution:</dt> <dd> <p>To simply map a URL to another server, we use the [P] flag, as follows:</p> <pre class=\"prettyprint lang-config\">RewriteEngine  on\nRewriteBase    \"/products/\"\nRewriteRule    \"^widget/(.*)$\"  \"http://product.example.com/widget/$1\"  [P]\nProxyPassReverse \"/products/widget/\" \"http://product.example.com/widget/\"</pre> <p>In the second example, we proxy the request only if we can't find the resource locally. This can be very useful when you're migrating from one server to another, and you're not sure if all the content has been migrated yet.</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{REQUEST_FILENAME}\"       !-f\nRewriteCond \"%{REQUEST_FILENAME}\"       !-d\nRewriteRule \"^/(.*)\" \"http://old.example.com/$1\" [P]\nProxyPassReverse \"/\" \"http://old.example.com/\"</pre> </dd> <dt>Discussion:</dt> <dd>\n<p>In each case, we add a <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypassreverse\">ProxyPassReverse</a></code> directive to ensure that any redirects issued by the backend are correctly passed on to the client.</p> <p>Consider using either <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code> or <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypassmatch\">ProxyPassMatch</a></code> whenever possible in preference to mod_rewrite.</p> </dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/proxy.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/proxy.html</a>\n  </p>\n</div>\n","ssl/ssl_intro":"<h1>SSL/TLS Strong Encryption: An Introduction</h1>  <p>As an introduction this chapter is aimed at readers who are familiar with the Web, HTTP, and Apache, but are not security experts. It is not intended to be a definitive guide to the SSL protocol, nor does it discuss specific techniques for managing certificates in an organization, or the important legal issues of patents and import and export restrictions. Rather, it is intended to provide a common background to <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> users by pulling together various concepts, definitions, and examples as a starting point for further exploration.</p>     <h2 id=\"cryptographictech\">Cryptographic Techniques</h2> <p>Understanding SSL requires an understanding of cryptographic algorithms, message digest functions (aka. one-way or hash functions), and digital signatures. These techniques are the subject of entire books (see for instance [<a href=\"#AC96\">AC96</a>]) and provide the basis for privacy, integrity, and authentication.</p> <h3><a name=\"cryptographicalgo\" id=\"cryptographicalgo\">Cryptographic Algorithms</a></h3> <p>Suppose Alice wants to send a message to her bank to transfer some money. Alice would like the message to be private, since it will include information such as her account number and transfer amount. One solution is to use a cryptographic algorithm, a technique that would transform her message into an encrypted form, unreadable until it is decrypted. Once in this form, the message can only be decrypted by using a secret key. Without the key the message is useless: good cryptographic algorithms make it so difficult for intruders to decode the original text that it isn't worth their effort.</p> <p>There are two categories of cryptographic algorithms: conventional and public key.</p> <dl> <dt>Conventional cryptography</dt> <dd>also known as symmetric cryptography, requires the sender and receiver to share a key: a secret piece of information that may be used to encrypt or decrypt a message. As long as this key is kept secret, nobody other than the sender or recipient can read the message. If Alice and the bank know a secret key, then they can send each other private messages. The task of sharing a key between sender and recipient before communicating, while also keeping it secret from others, can be problematic.</dd> <dt>Public key cryptography</dt> <dd>also known as asymmetric cryptography, solves the key exchange problem by defining an algorithm which uses two keys, each of which may be used to encrypt a message. If one key is used to encrypt a message then the other must be used to decrypt it. This makes it possible to receive secure messages by simply publishing one key (the public key) and keeping the other secret (the private key).</dd> </dl> <p>Anyone can encrypt a message using the public key, but only the owner of the private key will be able to read it. In this way, Alice can send private messages to the owner of a key-pair (the bank), by encrypting them using their public key. Only the bank will be able to decrypt them.</p> <h3><a name=\"messagedigests\" id=\"messagedigests\">Message Digests</a></h3> <p>Although Alice may encrypt her message to make it private, there is still a concern that someone might modify her original message or substitute it with a different one, in order to transfer the money to themselves, for instance. One way of guaranteeing the integrity of Alice's message is for her to create a concise summary of her message and send this to the bank as well. Upon receipt of the message, the bank creates its own summary and compares it with the one Alice sent. If the summaries are the same then the message has been received intact.</p> <p>A summary such as this is called a <dfn>message digest</dfn>, <em>one-way function</em> or <em>hash function</em>. Message digests are used to create a short, fixed-length representation of a longer, variable-length message. Digest algorithms are designed to produce a unique digest for each message. Message digests are designed to make it impractically difficult to determine the message from the digest and (in theory) impossible to find two different messages which create the same digest -- thus eliminating the possibility of substituting one message for another while maintaining the same digest.</p> <p>Another challenge that Alice faces is finding a way to send the digest to the bank securely; if the digest is not sent securely, its integrity may be compromised and with it the possibility for the bank to determine the integrity of the original message. Only if the digest is sent securely can the integrity of the associated message be determined.</p> <p>One way to send the digest securely is to include it in a digital signature.</p> <h3><a name=\"digitalsignatures\" id=\"digitalsignatures\">Digital Signatures</a></h3> <p>When Alice sends a message to the bank, the bank needs to ensure that the message is really from her, so an intruder cannot request a transaction involving her account. A <em>digital signature</em>, created by Alice and included with the message, serves this purpose.</p> <p>Digital signatures are created by encrypting a digest of the message and other information (such as a sequence number) with the sender's private key. Though anyone can <em>decrypt</em> the signature using the public key, only the sender knows the private key. This means that only the sender can have signed the message. Including the digest in the signature means the signature is only good for that message; it also ensures the integrity of the message since no one can change the digest and still sign it.</p> <p>To guard against interception and reuse of the signature by an intruder at a later date, the signature contains a unique sequence number. This protects the bank from a fraudulent claim from Alice that she did not send the message -- only she could have signed it (non-repudiation).</p>   <h2 id=\"certificates\">Certificates</h2> <p>Although Alice could have sent a private message to the bank, signed it and ensured the integrity of the message, she still needs to be sure that she is really communicating with the bank. This means that she needs to be sure that the public key she is using is part of the bank's key-pair, and not an intruder's. Similarly, the bank needs to verify that the message signature really was signed by the private key that belongs to Alice.</p> <p>If each party has a certificate which validates the other's identity, confirms the public key and is signed by a trusted agency, then both can be assured that they are communicating with whom they think they are. Such a trusted agency is called a <em>Certificate Authority</em> and certificates are used for authentication.</p> <h3><a name=\"certificatecontents\" id=\"certificatecontents\">Certificate Contents</a></h3> <p>A certificate associates a public key with the real identity of an individual, server, or other entity, known as the subject. As shown in <a href=\"#table1\">Table 1</a>, information about the subject includes identifying information (the distinguished name) and the public key. It also includes the identification and signature of the Certificate Authority that issued the certificate and the period of time during which the certificate is valid. It may have additional information (or extensions) as well as administrative information for the Certificate Authority's use, such as a serial number.</p> <h4><a name=\"table1\" id=\"table1\">Table 1: Certificate Information</a></h4> <table> <tr>\n<th>Subject</th> <td>Distinguished Name, Public Key</td>\n</tr> <tr>\n<th>Issuer</th> <td>Distinguished Name, Signature</td>\n</tr> <tr>\n<th>Period of Validity</th> <td>Not Before Date, Not After Date</td>\n</tr> <tr>\n<th>Administrative Information</th> <td>Version, Serial Number</td>\n</tr> <tr>\n<th>Extended Information</th> <td>Basic Constraints, Netscape Flags, etc.</td>\n</tr> </table> <p>A distinguished name is used to provide an identity in a specific context -- for instance, an individual might have a personal certificate as well as one for their identity as an employee. Distinguished names are defined by the X.509 standard [<a href=\"#X509\">X509</a>], which defines the fields, field names and abbreviations used to refer to the fields (see <a href=\"#table2\">Table 2</a>).</p> <h4><a name=\"table2\" id=\"table2\">Table 2: Distinguished Name Information</a></h4> <table class=\"bordered\"> <tr>\n<th>DN Field</th> <th>Abbrev.</th> <th>Description</th> <th>Example</th>\n</tr> <tr>\n<td>Common Name</td> <td>CN</td> <td>Name being certified</td> <td>CN=Joe Average</td>\n</tr> <tr>\n<td>Organization or Company</td> <td>O</td> <td>Name is associated with this<br>organization</td> <td>O=Snake Oil, Ltd.</td>\n</tr> <tr>\n<td>Organizational Unit</td> <td>OU</td> <td>Name is associated with this <br>organization unit, such as a department</td> <td>OU=Research Institute</td>\n</tr> <tr>\n<td>City/Locality</td> <td>L</td> <td>Name is located in this City</td> <td>L=Snake City</td>\n</tr> <tr>\n<td>State/Province</td> <td>ST</td> <td>Name is located in this State/Province</td> <td>ST=Desert</td>\n</tr> <tr>\n<td>Country</td> <td>C</td> <td>Name is located in this Country (ISO code)</td> <td>C=XZ</td>\n</tr> </table> <p>A Certificate Authority may define a policy specifying which distinguished field names are optional and which are required. It may also place requirements upon the field contents, as may users of certificates. For example, a Netscape browser requires that the Common Name for a certificate representing a server matches a wildcard pattern for the domain name of that server, such as <code>*.snakeoil.com</code>.</p> <p>The binary format of a certificate is defined using the ASN.1 notation [<a href=\"#ASN1\">ASN1</a>] [<a href=\"#PKCS\">PKCS</a>]. This notation defines how to specify the contents and encoding rules define how this information is translated into binary form. The binary encoding of the certificate is defined using Distinguished Encoding Rules (DER), which are based on the more general Basic Encoding Rules (BER). For those transmissions which cannot handle binary, the binary form may be translated into an ASCII form by using Base64 encoding [<a href=\"#MIME\">MIME</a>]. When placed between begin and end delimiter lines (as below), this encoded version is called a PEM (\"Privacy Enhanced Mail\") encoded certificate.</p> <div class=\"example\">\n<h3>Example of a PEM-encoded certificate (snakeoil.crt)</h3>\n<pre>-----BEGIN CERTIFICATE-----\nMIIC7jCCAlegAwIBAgIBATANBgkqhkiG9w0BAQQFADCBqTELMAkGA1UEBhMCWFkx\nFTATBgNVBAgTDFNuYWtlIERlc2VydDETMBEGA1UEBxMKU25ha2UgVG93bjEXMBUG\nA1UEChMOU25ha2UgT2lsLCBMdGQxHjAcBgNVBAsTFUNlcnRpZmljYXRlIEF1dGhv\ncml0eTEVMBMGA1UEAxMMU25ha2UgT2lsIENBMR4wHAYJKoZIhvcNAQkBFg9jYUBz\nbmFrZW9pbC5kb20wHhcNOTgxMDIxMDg1ODM2WhcNOTkxMDIxMDg1ODM2WjCBpzEL\nMAkGA1UEBhMCWFkxFTATBgNVBAgTDFNuYWtlIERlc2VydDETMBEGA1UEBxMKU25h\na2UgVG93bjEXMBUGA1UEChMOU25ha2UgT2lsLCBMdGQxFzAVBgNVBAsTDldlYnNl\ncnZlciBUZWFtMRkwFwYDVQQDExB3d3cuc25ha2VvaWwuZG9tMR8wHQYJKoZIhvcN\nAQkBFhB3d3dAc25ha2VvaWwuZG9tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKB\ngQDH9Ge/s2zcH+da+rPTx/DPRp3xGjHZ4GG6pCmvADIEtBtKBFAcZ64n+Dy7Np8b\nvKR+yy5DGQiijsH1D/j8HlGE+q4TZ8OFk7BNBFazHxFbYI4OKMiCxdKzdif1yfaa\nlWoANFlAzlSdbxeGVHoT0K+gT5w3UxwZKv2DLbCTzLZyPwIDAQABoyYwJDAPBgNV\nHRMECDAGAQH/AgEAMBEGCWCGSAGG+EIBAQQEAwIAQDANBgkqhkiG9w0BAQQFAAOB\ngQAZUIHAL4D09oE6Lv2k56Gp38OBDuILvwLg1v1KL8mQR+KFjghCrtpqaztZqcDt\n2q2QoyulCgSzHbEGmi0EsdkPfg6mp0penssIFePYNI+/8u9HT4LuKMJX15hxBam7\ndUHzICxBVC1lnHyYGjDuAMhe396lYAn8bCld1/L4NMGBCQ==\n-----END CERTIFICATE-----</pre>\n</div> <h3><a name=\"certificateauthorities\" id=\"certificateauthorities\">Certificate Authorities</a></h3> <p>By verifying the information in a certificate request before granting the certificate, the Certificate Authority assures itself of the identity of the private key owner of a key-pair. For instance, if Alice requests a personal certificate, the Certificate Authority must first make sure that Alice really is the person the certificate request claims she is.</p> <h4><a name=\"certificatechains\" id=\"certificatechains\">Certificate Chains</a></h4> <p>A Certificate Authority may also issue a certificate for another Certificate Authority. When examining a certificate, Alice may need to examine the certificate of the issuer, for each parent Certificate Authority, until reaching one which she has confidence in. She may decide to trust only certificates with a limited chain of issuers, to reduce her risk of a \"bad\" certificate in the chain.</p> <h4><a name=\"rootlevelca\" id=\"rootlevelca\">Creating a Root-Level CA</a></h4> <p>As noted earlier, each certificate requires an issuer to assert the validity of the identity of the certificate subject, up to the top-level Certificate Authority (CA). This presents a problem: who can vouch for the certificate of the top-level authority, which has no issuer? In this unique case, the certificate is \"self-signed\", so the issuer of the certificate is the same as the subject. Browsers are preconfigured to trust well-known certificate authorities, but it is important to exercise extra care in trusting a self-signed certificate. The wide publication of a public key by the root authority reduces the risk in trusting this key -- it would be obvious if someone else publicized a key claiming to be the authority.</p> <p>A number of companies, such as <a href=\"http://www.thawte.com/\">Thawte</a> and <a href=\"http://www.verisign.com/\">VeriSign</a> have established themselves as Certificate Authorities. These companies provide the following services:</p> <ul> <li>Verifying certificate requests</li> <li>Processing certificate requests</li> <li>Issuing and managing certificates</li> </ul> <p>It is also possible to create your own Certificate Authority. Although risky in the Internet environment, it may be useful within an Intranet where the organization can easily verify the identities of individuals and servers.</p> <h4><a name=\"certificatemanagement\" id=\"certificatemanagement\">Certificate Management</a></h4> <p>Establishing a Certificate Authority is a responsibility which requires a solid administrative, technical and management framework. Certificate Authorities not only issue certificates, they also manage them -- that is, they determine for how long certificates remain valid, they renew them and keep lists of certificates that were issued in the past but are no longer valid (Certificate Revocation Lists, or CRLs).</p> <p>For example, if Alice is entitled to a certificate as an employee of a company but has now left that company, her certificate may need to be revoked. Because certificates are only issued after the subject's identity has been verified and can then be passed around to all those with whom the subject may communicate, it is impossible to tell from the certificate alone that it has been revoked. Therefore when examining certificates for validity it is necessary to contact the issuing Certificate Authority to check CRLs -- this is usually not an automated part of the process.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>If you use a Certificate Authority that browsers are not configured to trust by default, it is necessary to load the Certificate Authority certificate into the browser, enabling the browser to validate server certificates signed by that Certificate Authority. Doing so may be dangerous, since once loaded, the browser will accept all certificates signed by that Certificate Authority.</p> </div>   <h2 id=\"ssl\">Secure Sockets Layer (SSL)</h2> <p>The Secure Sockets Layer protocol is a protocol layer which may be placed between a reliable connection-oriented network layer protocol (e.g. TCP/IP) and the application protocol layer (e.g. HTTP). SSL provides for secure communication between client and server by allowing mutual authentication, the use of digital signatures for integrity and encryption for privacy.</p> <p>The protocol is designed to support a range of choices for specific algorithms used for cryptography, digests and signatures. This allows algorithm selection for specific servers to be made based on legal, export or other concerns and also enables the protocol to take advantage of new algorithms. Choices are negotiated between client and server when establishing a protocol session.</p> <h3><a name=\"table4\" id=\"table4\">Table 4: Versions of the SSL protocol</a></h3> <table class=\"bordered\"> <tr>\n<th>Version</th> <th>Source</th> <th>Description</th> </tr> <tr>\n<td>SSL v2.0</td> <td>Vendor Standard (from Netscape Corp.)</td> <td>First SSL protocol for which implementations exist</td> </tr> <tr>\n<td>SSL v3.0</td> <td>Expired Internet Draft (from Netscape Corp.) [<a href=\"#SSL3\">SSL3</a>]</td> <td>Revisions to prevent specific security attacks, add non-RSA ciphers and support for certificate chains</td> </tr> <tr>\n<td>TLS v1.0</td> <td>Proposed Internet Standard (from IETF) [<a href=\"#TLS1\">TLS1</a>]</td> <td>Revision of SSL 3.0 to update the MAC layer to HMAC, add block padding for block ciphers, message order standardization and more alert messages.</td> </tr> <tr>\n<td>TLS v1.1</td> <td>Proposed Internet Standard (from IETF) [<a href=\"#TLS11\">TLS11</a>]</td> <td>Update of TLS 1.0 to add protection against Cipher block chaining (CBC) attacks.</td> </tr> <tr>\n<td>TLS v1.2</td> <td>Proposed Internet Standard (from IETF) [<a href=\"#TLS12\">TLS12</a>]</td> <td>Update of TLS 1.2 deprecating MD5 as hash, and adding incompatibility to SSL so it will never negotiate the use of SSLv2.</td> </tr> </table> <p>There are a number of versions of the SSL protocol, as shown in <a href=\"#table4\">Table 4</a>. As noted there, one of the benefits in SSL 3.0 is that it adds support of certificate chain loading. This feature allows a server to pass a server certificate along with issuer certificates to the browser. Chain loading also permits the browser to validate the server certificate, even if Certificate Authority certificates are not installed for the intermediate issuers, since they are included in the certificate chain. SSL 3.0 is the basis for the Transport Layer Security [<a href=\"#TLS1\">TLS</a>] protocol standard, currently in development by the Internet Engineering Task Force (IETF).</p> <h3><a name=\"session\" id=\"session\">Establishing a Session</a></h3> <p>The SSL session is established by following a handshake sequence between client and server, as shown in <a href=\"#figure1\">Figure 1</a>. This sequence may vary, depending on whether the server is configured to provide a server certificate or request a client certificate. Although cases exist where additional handshake steps are required for management of cipher information, this article summarizes one common scenario. See the SSL specification for the full range of possibilities.</p> <div class=\"note\">\n<p><strong>Note</strong></p> <p>Once an SSL session has been established, it may be reused. This avoids the performance penalty of repeating the many steps needed to start a session. To do this, the server assigns each SSL session a unique session identifier which is cached in the server and which the client can use in future connections to reduce the handshake time (until the session identifier expires from the cache of the server).</p> </div> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/ssl_intro_fig1.gif\" alt=\"\" width=\"423\" height=\"327\"><br> <a id=\"figure1\" name=\"figure1\"><dfn>Figure 1</dfn></a>: Simplified SSL Handshake Sequence</p> <p>The elements of the handshake sequence, as used by the client and server, are listed below:</p> <ol> <li>Negotiate the Cipher Suite to be used during data transfer</li> <li>Establish and share a session key between client and server</li> <li>Optionally authenticate the server to the client</li> <li>Optionally authenticate the client to the server</li> </ol> <p>The first step, Cipher Suite Negotiation, allows the client and server to choose a Cipher Suite supported by both of them. The SSL3.0 protocol specification defines 31 Cipher Suites. A Cipher Suite is defined by the following components:</p> <ul> <li>Key Exchange Method</li> <li>Cipher for Data Transfer</li> <li>Message Digest for creating the Message Authentication Code (MAC)</li> </ul> <p>These three elements are described in the sections that follow.</p> <h3><a name=\"keyexchange\" id=\"keyexchange\">Key Exchange Method</a></h3> <p>The key exchange method defines how the shared secret symmetric cryptography key used for application data transfer will be agreed upon by client and server. SSL 2.0 uses RSA key exchange only, while SSL 3.0 supports a choice of key exchange algorithms including RSA key exchange (when certificates are used), and Diffie-Hellman key exchange (for exchanging keys without certificates, or without prior communication between client and server).</p> <p>One variable in the choice of key exchange methods is digital signatures -- whether or not to use them, and if so, what kind of signatures to use. Signing with a private key provides protection against a man-in-the-middle-attack during the information exchange used to generating the shared key [<a href=\"#AC96\">AC96</a>, p516].</p> <h3><a name=\"ciphertransfer\" id=\"ciphertransfer\">Cipher for Data Transfer</a></h3> <p>SSL uses conventional symmetric cryptography, as described earlier, for encrypting messages in a session. There are nine choices of how to encrypt, including the option not to encrypt:</p> <ul> <li>No encryption</li> <li>Stream Ciphers <ul> <li>RC4 with 40-bit keys</li> <li>RC4 with 128-bit keys</li> </ul>\n</li> <li>CBC Block Ciphers <ul>\n<li>RC2 with 40 bit key</li> <li>DES with 40 bit key</li> <li>DES with 56 bit key</li> <li>Triple-DES with 168 bit key</li> <li>Idea (128 bit key)</li> <li>Fortezza (96 bit key)</li> </ul>\n</li> </ul> <p>\"CBC\" refers to Cipher Block Chaining, which means that a portion of the previously encrypted cipher text is used in the encryption of the current block. \"DES\" refers to the Data Encryption Standard [<a href=\"#AC96\">AC96</a>, ch12], which has a number of variants (including DES40 and 3DES_EDE). \"Idea\" is currently one of the best and cryptographically strongest algorithms available, and \"RC2\" is a proprietary algorithm from RSA DSI [<a href=\"#AC96\">AC96</a>, ch13].</p> <h3><a name=\"digestfuntion\" id=\"digestfuntion\">Digest Function</a></h3> <p>The choice of digest function determines how a digest is created from a record unit. SSL supports the following:</p> <ul> <li>No digest (Null choice)</li> <li>MD5, a 128-bit hash</li> <li>Secure Hash Algorithm (SHA-1), a 160-bit hash</li> </ul> <p>The message digest is used to create a Message Authentication Code (MAC) which is encrypted with the message to verify integrity and to protect against replay attacks.</p> <h3><a name=\"handshake\" id=\"handshake\">Handshake Sequence Protocol</a></h3> <p>The handshake sequence uses three protocols:</p> <ul> <li>The <dfn>SSL Handshake Protocol</dfn> for performing the client and server SSL session establishment.</li> <li>The <dfn>SSL Change Cipher Spec Protocol</dfn> for actually establishing agreement on the Cipher Suite for the session.</li> <li>The <dfn>SSL Alert Protocol</dfn> for conveying SSL error messages between client and server.</li> </ul> <p>These protocols, as well as application protocol data, are encapsulated in the <dfn>SSL Record Protocol</dfn>, as shown in <a href=\"#figure2\">Figure 2</a>. An encapsulated protocol is transferred as data by the lower layer protocol, which does not examine the data. The encapsulated protocol has no knowledge of the underlying protocol.</p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/ssl_intro_fig2.gif\" alt=\"\" width=\"428\" height=\"217\"><br> <a id=\"figure2\" name=\"figure2\"><dfn>Figure 2</dfn></a>: SSL Protocol Stack </p> <p>The encapsulation of SSL control protocols by the record protocol means that if an active session is renegotiated the control protocols will be transmitted securely. If there was no previous session, the Null cipher suite is used, which means there will be no encryption and messages will have no integrity digests, until the session has been established.</p> <h3><a name=\"datatransfer\" id=\"datatransfer\">Data Transfer</a></h3> <p>The SSL Record Protocol, shown in <a href=\"#figure3\">Figure 3</a>, is used to transfer application and SSL Control data between the client and server, where necessary fragmenting this data into smaller units, or combining multiple higher level protocol data messages into single units. It may compress, attach digest signatures, and encrypt these units before transmitting them using the underlying reliable transport protocol (Note: currently, no major SSL implementations include support for compression).</p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/ssl_intro_fig3.gif\" alt=\"\" width=\"423\" height=\"323\"><br> <a id=\"figure3\" name=\"figure3\"><dfn>Figure 3</dfn></a>: SSL Record Protocol </p> <h3><a name=\"securehttp\" id=\"securehttp\">Securing HTTP Communication</a></h3> <p>One common use of SSL is to secure Web HTTP communication between a browser and a webserver. This does not preclude the use of non-secured HTTP - the secure version (called HTTPS) is the same as plain HTTP over SSL, but uses the URL scheme <code>https</code> rather than <code>http</code>, and a different server port (by default, port 443). This functionality is a large part of what <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> provides for the Apache webserver.</p>   <h2 id=\"references\">References</h2> <dl> <dt><a id=\"AC96\" name=\"AC96\">[AC96]</a></dt> <dd>Bruce Schneier, <q>Applied Cryptography</q>, 2nd Edition, Wiley, 1996. See <a href=\"http://www.counterpane.com/\">http://www.counterpane.com/</a> for various other materials by Bruce Schneier.</dd> <dt><a id=\"ASN1\" name=\"ASN1\">[ASN1]</a></dt> <dd>ITU-T Recommendation X.208, <q>Specification of Abstract Syntax Notation One (ASN.1)</q>, last updated 2008. See <a href=\"http://www.itu.int/ITU-T/asn1/\">http://www.itu.int/ITU-T/asn1/</a>. </dd> <dt><a id=\"X509\" name=\"X509\">[X509]</a></dt> <dd>ITU-T Recommendation X.509, <q>The Directory - Authentication Framework</q>. For references, see <a href=\"http://en.wikipedia.org/wiki/X.509\">http://en.wikipedia.org/wiki/X.509</a>. </dd> <dt><a id=\"PKCS\" name=\"PKCS\">[PKCS]</a></dt> <dd>\n<q>Public Key Cryptography Standards (PKCS)</q>, RSA Laboratories Technical Notes, See <a href=\"http://www.rsasecurity.com/rsalabs/pkcs/\">http://www.rsasecurity.com/rsalabs/pkcs/</a>.</dd> <dt><a id=\"MIME\" name=\"MIME\">[MIME]</a></dt> <dd>N. Freed, N. Borenstein, <q>Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</q>, RFC2045. See for instance <a href=\"http://tools.ietf.org/html/rfc2045\">http://tools.ietf.org/html/rfc2045</a>.</dd> <dt><a id=\"SSL3\" name=\"SSL3\">[SSL3]</a></dt> <dd>Alan O. Freier, Philip Karlton, Paul C. Kocher, <q>The SSL Protocol Version 3.0</q>, 1996. See <a href=\"http://www.netscape.com/eng/ssl3/draft302.txt\">http://www.netscape.com/eng/ssl3/draft302.txt</a>.</dd> <dt><a id=\"TLS1\" name=\"TLS1\">[TLS1]</a></dt> <dd>Tim Dierks, Christopher Allen, <q>The TLS Protocol Version 1.0</q>, 1999. See <a href=\"http://ietf.org/rfc/rfc2246.txt\">http://ietf.org/rfc/rfc2246.txt</a>.</dd> <dt><a id=\"TLS11\" name=\"TLS11\">[TLS11]</a></dt> <dd>\n<q>The TLS Protocol Version 1.1</q>, 2006. See <a href=\"http://tools.ietf.org/html/rfc4346\">http://tools.ietf.org/html/rfc4346</a>.</dd> <dt><a id=\"TLS12\" name=\"TLS12\">[TLS12]</a></dt> <dd>\n<q>The TLS Protocol Version 1.2</q>, 2008. See <a href=\"http://tools.ietf.org/html/rfc5246\">http://tools.ietf.org/html/rfc5246</a>.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/ssl/ssl_intro.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/ssl/ssl_intro.html</a>\n  </p>\n</div>\n","ssl/ssl_compat":"<h1>SSL/TLS Strong Encryption: Compatibility</h1>  <p> This page covers backwards compatibility between mod_ssl and other SSL solutions. mod_ssl is not the only SSL solution for Apache; four additional products are (or were) also available: Ben Laurie's freely available <a href=\"http://www.apache-ssl.org/\">Apache-SSL</a> (from where mod_ssl were originally derived in 1998), Red Hat's commercial Secure Web Server (which was based on mod_ssl), Covalent's commercial Raven SSL Module (also based on mod_ssl) and finally C2Net's (now Red Hat's) commercial product <a href=\"http://www.redhat.com/explore/stronghold/\">Stronghold</a> (based on a different evolution branch, named Sioux up to Stronghold 2.x, and based on mod_ssl since Stronghold 3.x).</p> <p> mod_ssl mostly provides a superset of the functionality of all the other solutions, so it's simple to migrate from one of the older modules to mod_ssl. The configuration directives and environment variable names used by the older SSL solutions vary from those used in mod_ssl; mapping tables are included here to give the equivalents used by mod_ssl.</p>     <h2 id=\"configuration\">Configuration Directives</h2> <p>The mapping between configuration directives used by Apache-SSL 1.x and mod_ssl 2.0.x is given in <a href=\"#table1\">Table 1</a>. The mapping from Sioux 1.x and Stronghold 2.x is only partial because of special functionality in these interfaces which mod_ssl doesn't provide.</p> <h3><a name=\"table1\" id=\"table1\">Table 1: Configuration Directive Mapping</a></h3> <table>\n<tr class=\"header\">\n<th>Old Directive</th>\n<th>mod_ssl Directive</th>\n<th>Comment</th>\n</tr> <tr class=\"header\"><th colspan=\"3\">Apache-SSL 1.x &amp; mod_ssl 2.0.x compatibility:</th></tr> <tr>\n<td><code>SSLEnable</code></td>\n<td><pre>SSLEngine on</pre></td>\n<td>compactified</td>\n</tr> <tr class=\"odd\">\n<td><code>SSLDisable</code></td>\n<td><pre>SSLEngine off</pre></td>\n<td>compactified</td>\n</tr> <tr>\n<td>\n<code>SSLLogFile</code> <em>file</em>\n</td>\n<td></td>\n<td>Use per-module <code class=\"directive\"><a href=\"../mod/core#loglevel\">LogLevel</a></code> setting instead.</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSLRequiredCiphers</code> <em>spec</em>\n</td>\n<td>\n<code>SSLCipherSuite</code> <em>spec</em>\n</td>\n<td>renamed</td>\n</tr> <tr>\n<td>\n<code>SSLRequireCipher</code> <em>c1</em> ...</td>\n<td>\n<code>SSLRequire %{SSL_CIPHER} in {\"</code><em>c1</em><code>\", ...}</code>\n</td>\n<td>generalized</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSLBanCipher</code> <em>c1</em> ...</td>\n<td>\n<code>SSLRequire not (%{SSL_CIPHER} in {\"</code><em>c1</em><code>\", ...})</code>\n</td>\n<td>generalized</td>\n</tr> <tr>\n<td><code>SSLFakeBasicAuth</code></td>\n<td><pre>SSLOptions +FakeBasicAuth</pre></td>\n<td>merged</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSLCacheServerPath</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>functionality removed</td>\n</tr> <tr>\n<td>\n<code>SSLCacheServerPort</code> <em>integer</em>\n</td>\n<td>-</td>\n<td>functionality removed</td>\n</tr> <tr class=\"header\"><th colspan=\"3\">Apache-SSL 1.x compatibility:</th></tr> <tr class=\"odd\">\n<td><code>SSLExportClientCertificates</code></td>\n<td><pre>SSLOptions +ExportCertData</pre></td>\n<td>merged</td>\n</tr> <tr>\n<td>\n<code>SSLCacheServerRunDir</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr class=\"header\"><th colspan=\"3\">Sioux 1.x compatibility:</th></tr> <tr class=\"odd\">\n<td>\n<code>SSL_CertFile</code> <em>file</em>\n</td>\n<td>\n<code>SSLCertificateFile</code> <em>file</em>\n</td>\n<td>renamed</td>\n</tr> <tr>\n<td>\n<code>SSL_KeyFile</code> <em>file</em>\n</td>\n<td>\n<code>SSLCertificateKeyFile</code> <em>file</em>\n</td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_CipherSuite</code> <em>arg</em>\n</td>\n<td>\n<code>SSLCipherSuite</code> <em>arg</em>\n</td>\n<td>renamed</td>\n</tr> <tr>\n<td>\n<code>SSL_X509VerifyDir</code> <em>arg</em>\n</td>\n<td>\n<code>SSLCACertificatePath</code> <em>arg</em>\n</td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_Log</code> <em>file</em>\n</td>\n<td><code>-</code></td>\n<td>Use per-module <code class=\"directive\"><a href=\"../mod/core#loglevel\">LogLevel</a></code> setting instead.</td>\n</tr> <tr>\n<td>\n<code>SSL_Connect</code> <em>flag</em>\n</td>\n<td>\n<code>SSLEngine</code> <em>flag</em>\n</td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_ClientAuth</code> <em>arg</em>\n</td>\n<td>\n<code>SSLVerifyClient</code> <em>arg</em>\n</td>\n<td>renamed</td>\n</tr> <tr>\n<td>\n<code>SSL_X509VerifyDepth</code> <em>arg</em>\n</td>\n<td>\n<code>SSLVerifyDepth</code> <em>arg</em>\n</td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_FetchKeyPhraseFrom</code> <em>arg</em>\n</td>\n<td>-</td>\n<td>not directly mappable; use SSLPassPhraseDialog</td>\n</tr> <tr>\n<td>\n<code>SSL_SessionDir</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>not directly mappable; use SSLSessionCache</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_Require</code> <em>expr</em>\n</td>\n<td>-</td>\n<td>not directly mappable; use SSLRequire</td>\n</tr> <tr>\n<td>\n<code>SSL_CertFileType</code> <em>arg</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_KeyFileType</code> <em>arg</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr>\n<td>\n<code>SSL_X509VerifyPolicy</code> <em>arg</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_LogX509Attributes</code> <em>arg</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr class=\"header\"><th colspan=\"3\">Stronghold 2.x compatibility:</th></tr> <tr>\n<td>\n<code>StrongholdAccelerator</code> <em>engine</em>\n</td>\n<td>\n<code>SSLCryptoDevice</code> <em>engine</em>\n</td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>StrongholdKey</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>functionality not needed</td>\n</tr> <tr>\n<td>\n<code>StrongholdLicenseFile</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>functionality not needed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSLFlag</code> <em>flag</em>\n</td>\n<td>\n<code>SSLEngine</code> <em>flag</em>\n</td>\n<td>renamed</td>\n</tr> <tr>\n<td>\n<code>SSLSessionLockFile</code> <em>file</em>\n</td>\n<td>\n<code>SSLMutex</code> <em>file</em>\n</td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSLCipherList</code> <em>spec</em>\n</td>\n<td>\n<code>SSLCipherSuite</code> <em>spec</em>\n</td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>RequireSSL</code></td>\n<td><code>SSLRequireSSL</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSLErrorFile</code> <em>file</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr>\n<td>\n<code>SSLRoot</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_CertificateLogDir</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr>\n<td>\n<code>AuthCertDir</code> <em>dir</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSL_Group</code> <em>name</em>\n</td>\n<td>-</td>\n<td>functionality not supported</td>\n</tr> <tr>\n<td>\n<code>SSLProxyMachineCertPath</code> <em>dir</em>\n</td>\n<td>\n<code>SSLProxyMachineCertificatePath</code> <em>dir</em>\n</td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td>\n<code>SSLProxyMachineCertFile</code> <em>file</em>\n</td>\n<td>\n<code>SSLProxyMachineCertificateFile</code> <em>file</em>\n</td>\n<td>renamed</td>\n</tr> <tr>\n<td>\n<code>SSLProxyCipherList</code> <em>spec</em>\n</td>\n<td>\n<code>SSLProxyCipherSpec</code> <em>spec</em>\n</td>\n<td>renamed</td>\n</tr> </table>   <h2 id=\"variables\">Environment Variables</h2> <p>The mapping between environment variable names used by the older SSL solutions and the names used by mod_ssl is given in <a href=\"#table2\">Table 2</a>.</p> <h3><a name=\"table2\" id=\"table2\">Table 2: Environment Variable Derivation</a></h3> <table>\n<tr class=\"header\">\n<th>Old Variable</th>\n<th>mod_ssl Variable</th>\n<th>Comment</th>\n</tr> <tr>\n<td><code>SSL_PROTOCOL_VERSION</code></td>\n<td><code>SSL_PROTOCOL</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSLEAY_VERSION</code></td>\n<td><code>SSL_VERSION_LIBRARY</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>HTTPS_SECRETKEYSIZE</code></td>\n<td><code>SSL_CIPHER_USEKEYSIZE</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>HTTPS_KEYSIZE</code></td>\n<td><code>SSL_CIPHER_ALGKEYSIZE</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>HTTPS_CIPHER</code></td>\n<td><code>SSL_CIPHER</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>HTTPS_EXPORT</code></td>\n<td><code>SSL_CIPHER_EXPORT</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_KEY_SIZE</code></td>\n<td><code>SSL_CIPHER_ALGKEYSIZE</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_CERTIFICATE</code></td>\n<td><code>SSL_SERVER_CERT</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_CERT_START</code></td>\n<td><code>SSL_SERVER_V_START</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_CERT_END</code></td>\n<td><code>SSL_SERVER_V_END</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_CERT_SERIAL</code></td>\n<td><code>SSL_SERVER_M_SERIAL</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_SIGNATURE_ALGORITHM</code></td>\n<td><code>SSL_SERVER_A_SIG</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_DN</code></td>\n<td><code>SSL_SERVER_S_DN</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_CN</code></td>\n<td><code>SSL_SERVER_S_DN_CN</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_EMAIL</code></td>\n<td><code>SSL_SERVER_S_DN_Email</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_O</code></td>\n<td><code>SSL_SERVER_S_DN_O</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_OU</code></td>\n<td><code>SSL_SERVER_S_DN_OU</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_C</code></td>\n<td><code>SSL_SERVER_S_DN_C</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_SP</code></td>\n<td><code>SSL_SERVER_S_DN_SP</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_L</code></td>\n<td><code>SSL_SERVER_S_DN_L</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_IDN</code></td>\n<td><code>SSL_SERVER_I_DN</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_ICN</code></td>\n<td><code>SSL_SERVER_I_DN_CN</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_IEMAIL</code></td>\n<td><code>SSL_SERVER_I_DN_Email</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_IO</code></td>\n<td><code>SSL_SERVER_I_DN_O</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_IOU</code></td>\n<td><code>SSL_SERVER_I_DN_OU</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_IC</code></td>\n<td><code>SSL_SERVER_I_DN_C</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SERVER_ISP</code></td>\n<td><code>SSL_SERVER_I_DN_SP</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_IL</code></td>\n<td><code>SSL_SERVER_I_DN_L</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_CERTIFICATE</code></td>\n<td><code>SSL_CLIENT_CERT</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_CERT_START</code></td>\n<td><code>SSL_CLIENT_V_START</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_CERT_END</code></td>\n<td><code>SSL_CLIENT_V_END</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_CERT_SERIAL</code></td>\n<td><code>SSL_CLIENT_M_SERIAL</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_SIGNATURE_ALGORITHM</code></td>\n<td><code>SSL_CLIENT_A_SIG</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_DN</code></td>\n<td><code>SSL_CLIENT_S_DN</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_CN</code></td>\n<td><code>SSL_CLIENT_S_DN_CN</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_EMAIL</code></td>\n<td><code>SSL_CLIENT_S_DN_Email</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_O</code></td>\n<td><code>SSL_CLIENT_S_DN_O</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_OU</code></td>\n<td><code>SSL_CLIENT_S_DN_OU</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_C</code></td>\n<td><code>SSL_CLIENT_S_DN_C</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_SP</code></td>\n<td><code>SSL_CLIENT_S_DN_SP</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_L</code></td>\n<td><code>SSL_CLIENT_S_DN_L</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_IDN</code></td>\n<td><code>SSL_CLIENT_I_DN</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_ICN</code></td>\n<td><code>SSL_CLIENT_I_DN_CN</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_IEMAIL</code></td>\n<td><code>SSL_CLIENT_I_DN_Email</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_IO</code></td>\n<td><code>SSL_CLIENT_I_DN_O</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_IOU</code></td>\n<td><code>SSL_CLIENT_I_DN_OU</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_IC</code></td>\n<td><code>SSL_CLIENT_I_DN_C</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_ISP</code></td>\n<td><code>SSL_CLIENT_I_DN_SP</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_IL</code></td>\n<td><code>SSL_CLIENT_I_DN_L</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_EXPORT</code></td>\n<td><code>SSL_CIPHER_EXPORT</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_KEYSIZE</code></td>\n<td><code>SSL_CIPHER_ALGKEYSIZE</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SECKEYSIZE</code></td>\n<td><code>SSL_CIPHER_USEKEYSIZE</code></td>\n<td>renamed</td>\n</tr> <tr>\n<td><code>SSL_SSLEAY_VERSION</code></td>\n<td><code>SSL_VERSION_LIBRARY</code></td>\n<td>renamed</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_STRONG_CRYPTO</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr>\n<td><code>SSL_SERVER_KEY_EXP</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_KEY_ALGORITHM</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr>\n<td><code>SSL_SERVER_KEY_SIZE</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_SESSIONDIR</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr>\n<td><code>SSL_SERVER_CERTIFICATELOGDIR</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_CERTFILE</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr>\n<td><code>SSL_SERVER_KEYFILE</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_SERVER_KEYFILETYPE</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_KEY_EXP</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr class=\"odd\">\n<td><code>SSL_CLIENT_KEY_ALGORITHM</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> <tr>\n<td><code>SSL_CLIENT_KEY_SIZE</code></td>\n<td><code>-</code></td>\n<td>Not supported by mod_ssl</td>\n</tr> </table>   <h2 id=\"customlog\">Custom Log Functions</h2> <p> When mod_ssl is enabled, additional functions exist for the <a href=\"../mod/mod_log_config#formats\">Custom Log Format</a> of <code class=\"module\"><a href=\"../mod/mod_log_config\">mod_log_config</a></code> as documented in the Reference Chapter. Beside the ``<code>%{</code><em>varname</em><code>}x</code>'' eXtension format function which can be used to expand any variables provided by any module, an additional Cryptography ``<code>%{</code><em>name</em><code>}c</code>'' cryptography format function exists for backward compatibility. The currently implemented function calls are listed in <a href=\"#table3\">Table 3</a>.</p> <h3><a name=\"table3\" id=\"table3\">Table 3: Custom Log Cryptography Function</a></h3> <table> <tr>\n<th>Function Call</th>\n<th>Description</th>\n</tr> <tr>\n<td><code>%...{version}c</code></td> <td>SSL protocol version</td>\n</tr> <tr>\n<td><code>%...{cipher}c</code></td> <td>SSL cipher</td>\n</tr> <tr>\n<td><code>%...{subjectdn}c</code></td> <td>Client Certificate Subject Distinguished Name</td>\n</tr> <tr>\n<td><code>%...{issuerdn}c</code></td> <td>Client Certificate Issuer Distinguished Name</td>\n</tr> <tr>\n<td><code>%...{errcode}c</code></td> <td>Certificate Verification Error (numerical)</td>\n</tr> <tr>\n<td><code>%...{errstr}c</code></td> <td>Certificate Verification Error (string)</td>\n</tr> </table><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/ssl/ssl_compat.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/ssl/ssl_compat.html</a>\n  </p>\n</div>\n","rewrite/intro":"<h1>Apache mod_rewrite Introduction</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It describes the basic concepts necessary for use of <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>. Other documents go into greater detail, but this doc should help the beginner get their feet wet. </p>     <h2 id=\"introduction\">Introduction</h2> <p>The Apache module <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> is a very powerful and sophisticated module which provides a way to do URL manipulations. With it, you can do nearly all types of URL rewriting that you may need. It is, however, somewhat complex, and may be intimidating to the beginner. There is also a tendency to treat rewrite rules as magic incantation, using them without actually understanding what they do.</p> <p>This document attempts to give sufficient background so that what follows is understood, rather than just copied blindly. </p> <p>Remember that many common URL-manipulation tasks don't require the full power and complexity of <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>. For simple tasks, see <code class=\"module\"><a href=\"../mod/mod_alias\">mod_alias</a></code> and the documentation on <a href=\"../urlmapping\">mapping URLs to the filesystem</a>.</p> <p>Finally, before proceeding, be sure to configure <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>'s log level to one of the trace levels using the <code class=\"directive\"><a href=\"../mod/core#loglevel\">LogLevel</a></code> directive. Although this can give an overwhelming amount of information, it is indispensable in debugging problems with <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> configuration, since it will tell you exactly how each rule is processed.</p>   <h2 id=\"regex\">Regular Expressions</h2> <p>mod_rewrite uses the <a href=\"http://pcre.org/\">Perl Compatible Regular Expression</a> vocabulary. In this document, we do not attempt to provide a detailed reference to regular expressions. For that, we recommend the <a href=\"http://pcre.org/pcre.txt\">PCRE man pages</a>, the <a href=\"http://perldoc.perl.org/perlre.html\">Perl regular expression man page</a>, and <a href=\"http://shop.oreilly.com/product/9780596528126.do\">Mastering Regular Expressions, by Jeffrey Friedl</a>.</p> <p>In this document, we attempt to provide enough of a regex vocabulary to get you started, without being overwhelming, in the hope that <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code>s will be scientific formulae, rather than magical incantations.</p> <h3><a name=\"regexvocab\" id=\"regexvocab\">Regex vocabulary</a></h3> <p>The following are the minimal building blocks you will need, in order to write regular expressions and <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code>s. They certainly do not represent a complete regular expression vocabulary, but they are a good place to start, and should help you read basic regular expressions, as well as write your own.</p> <table> <tr> <th>Character</th> <th>Meaning</th> <th>Example</th> </tr> <tr>\n<td><code>.</code></td>\n<td>Matches any single character</td>\n<td>\n<code>c.t</code> will match <code>cat</code>, <code>cot</code>, <code>cut</code>, etc.</td>\n</tr> <tr>\n<td><code>+</code></td>\n<td>Repeats the previous match one or more times</td>\n<td>\n<code>a+</code> matches <code>a</code>, <code>aa</code>, <code>aaa</code>, etc</td>\n</tr> <tr>\n<td><code>*</code></td>\n<td>Repeats the previous match zero or more times.</td>\n<td>\n<code>a*</code> matches all the same things <code>a+</code> matches, but will also match an empty string.</td>\n</tr> <tr>\n<td><code>?</code></td>\n<td>Makes the match optional.</td>\n<td> <code>colou?r</code> will match <code>color</code> and <code>colour</code>.</td> </tr> <tr>\n<td><code>^</code></td>\n<td>Called an anchor, matches the beginning of the string</td>\n<td>\n<code>^a</code> matches a string that begins with <code>a</code>\n</td>\n</tr> <tr>\n<td><code>$</code></td>\n<td>The other anchor, this matches the end of the string.</td>\n<td>\n<code>a$</code> matches a string that ends with <code>a</code>.</td>\n</tr> <tr>\n<td><pre>( )</pre></td>\n<td>Groups several characters into a single unit, and captures a match for use in a backreference.</td>\n<td>\n<code>(ab)+</code> matches <code>ababab</code> - that is, the <code>+</code> applies to the group. For more on backreferences see <a href=\"#InternalBackRefs\">below</a>.</td>\n</tr> <tr>\n<td><pre>[ ]</pre></td>\n<td>A character class - matches one of the characters</td>\n<td>\n<code>c[uoa]t</code> matches <code>cut</code>, <code>cot</code> or <code>cat</code>.</td>\n</tr> <tr>\n<td><pre>[^ ]</pre></td>\n<td>Negative character class - matches any character not specified</td>\n<td>\n<code>c[^/]t</code> matches <code>cat</code> or <code>c=t</code> but not <code>c/t</code>\n</td>\n</tr> </table> <p>In <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> the <code>!</code> character can be used before a regular expression to negate it. This is, a string will be considered to have matched only if it does not match the rest of the expression.</p> <h3><a name=\"InternalBackRefs\" id=\"InternalBackRefs\">Regex Back-Reference Availability</a></h3> <p>One important thing here has to be remembered: Whenever you use parentheses in <em>Pattern</em> or in one of the <em>CondPattern</em>, back-references are internally created which can be used with the strings <code>$N</code> and <code>%N</code> (see below). These are available for creating the <em>Substitution</em> parameter of a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> or the <em>TestString</em> parameter of a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code>.</p> <p> Captures in the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> patterns are (counterintuitively) available to all preceding <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> directives, because the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> expression is evaluated before the individual conditions.</p> <p>Figure 1 shows to which locations the back-references are transferred for expansion as well as illustrating the flow of the RewriteRule, RewriteCond matching. In the next chapters, we will be exploring how to use these back-references, so do not fret if it seems a bit alien to you at first. </p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/rewrite_backreferences.png\" alt=\"Flow of RewriteRule and RewriteCond matching\"><br> <dfn>Figure 1:</dfn> The back-reference flow through a rule.<br> In this example, a request for <code>/test/1234</code> would be transformed into <code>/admin.foo?page=test&amp;id=1234&amp;host=admin.example.com</code>. </p>   <h2 id=\"rewriterule\">RewriteRule Basics</h2> <p>A <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> consists of three arguments separated by spaces. The arguments are</p> <ol> <li>\n<var>Pattern</var>: which incoming URLs should be affected by the rule;</li> <li>\n<var>Substitution</var>: where should the matching requests be sent;</li> <li>\n<var>[flags]</var>: options affecting the rewritten request.</li> </ol> <p>The <var>Pattern</var> is a <a href=\"#regex\">regular expression</a>. It is initially (for the first rewrite rule or until a substitution occurs) matched against the URL-path of the incoming request (the part after the hostname but before any question mark indicating the beginning of a query string) or, in per-directory context, against the request's path relative to the directory for which the rule is defined. Once a substitution has occurred, the rules that follow are matched against the substituted value. </p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/syntax_rewriterule.png\" alt=\"Syntax of the RewriteRule directive\"><br> <dfn>Figure 2:</dfn> Syntax of the RewriteRule directive. </p> <p>The <var>Substitution</var> can itself be one of three things:</p> <dl> <dt>A full filesystem path to a resource</dt> <dd> <pre class=\"prettyprint lang-config\">RewriteRule \"^/games\" \"/usr/local/games/web\"</pre> <p>This maps a request to an arbitrary location on your filesystem, much like the <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code> directive.</p> </dd> <dt>A web-path to a resource</dt> <dd> <pre class=\"prettyprint lang-config\">RewriteRule \"^/foo$\" \"/bar\"</pre> <p>If <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> is set to <code>/usr/local/apache2/htdocs</code>, then this directive would map requests for <code>http://example.com/foo</code> to the path <code>/usr/local/apache2/htdocs/bar</code>.</p> </dd> <dt>An absolute URL</dt> <dd> <pre class=\"prettyprint lang-config\">RewriteRule \"^/product/view$\" \"http://site2.example.com/seeproduct.html\" [R]</pre> <p>This tells the client to make a new request for the specified URL.</p> </dd> </dl> <p>The <var>Substitution</var> can also contain <em>back-references</em> to parts of the incoming URL-path matched by the <var>Pattern</var>. Consider the following:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"^/product/(.*)/view$\" \"/var/web/productdb/$1\"</pre> <p>The variable <code>$1</code> will be replaced with whatever text was matched by the expression inside the parenthesis in the <var>Pattern</var>. For example, a request for <code>http://example.com/product/r14df/view</code> will be mapped to the path <code>/var/web/productdb/r14df</code>.</p> <p>If there is more than one expression in parenthesis, they are available in order in the variables <code>$1</code>, <code>$2</code>, <code>$3</code>, and so on.</p>   <h2 id=\"flags\">Rewrite Flags</h2> <p>The behavior of a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> can be modified by the application of one or more flags to the end of the rule. For example, the matching behavior of a rule can be made case-insensitive by the application of the <code>[NC]</code> flag: </p> <pre class=\"prettyprint lang-config\">RewriteRule \"^puppy.html\" \"smalldog.html\" [NC]</pre> <p>For more details on the available flags, their meanings, and examples, see the <a href=\"flags\">Rewrite Flags</a> document.</p>   <h2 id=\"rewritecond\">Rewrite Conditions</h2> <p>One or more <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> directives can be used to restrict the types of requests that will be subject to the following <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code>. The first argument is a variable describing a characteristic of the request, the second argument is a <a href=\"#regex\">regular expression</a> that must match the variable, and a third optional argument is a list of flags that modify how the match is evaluated.</p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/syntax_rewritecond.png\" alt=\"Syntax of the RewriteCond directive\"><br> <dfn>Figure 3:</dfn> Syntax of the RewriteCond directive </p> <p>For example, to send all requests from a particular IP range to a different server, you could use:</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{REMOTE_ADDR}\" \"^10\\.2\\.\"\nRewriteRule \"(.*)\" \"http://intranet.example.com$1\"</pre> <p>When more than one <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> is specified, they must all match for the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> to be applied. For example, to deny requests that contain the word \"hack\" in their query string, unless they also contain a cookie containing the word \"go\", you could use:</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{QUERY_STRING}\" \"hack\"\nRewriteCond \"%{HTTP_COOKIE}\" \"!go\"\nRewriteRule \".\" \"-\" [F]</pre> <p>Notice that the exclamation mark specifies a negative match, so the rule is only applied if the cookie does not contain \"go\".</p> <p>Matches in the regular expressions contained in the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code>s can be used as part of the <var>Substitution</var> in the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> using the variables <code>%1</code>, <code>%2</code>, etc. For example, this will direct the request to a different directory depending on the hostname used to access the site:</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_HOST}\" \"(.*)\"\nRewriteRule \"^/(.*)\" \"/sites/%1/$1\"</pre> <p>If the request was for <code>http://example.com/foo/bar</code>, then <code>%1</code> would contain <code>example.com</code> and <code>$1</code> would contain <code>foo/bar</code>.</p>   <h2 id=\"rewritemap\">Rewrite maps</h2> <p>The <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive provides a way to call an external function, so to speak, to do your rewriting for you. This is discussed in greater detail in the <a href=\"rewritemap\">RewriteMap supplementary documentation</a>.</p>   <h2 id=\"htaccess\">.htaccess files</h2> <p>Rewriting is typically configured in the main server configuration setting (outside any <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> section) or inside <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> containers. This is the easiest way to do rewriting and is recommended. It is possible, however, to do rewriting inside <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> sections or <a href=\"../howto/htaccess\"><code>.htaccess</code> files</a> at the expense of some additional complexity. This technique is called per-directory rewrites.</p> <p>The main difference with per-server rewrites is that the path prefix of the directory containing the <code>.htaccess</code> file is stripped before matching in the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code>. In addition, the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritebase\">RewriteBase</a></code> should be used to assure the request is properly mapped.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/intro.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/intro.html</a>\n  </p>\n</div>\n","rewrite/remapping":"<h1>Redirecting and Remapping with mod_rewrite</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It describes how you can use <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> to redirect and remap request. This includes many examples of common uses of mod_rewrite, including detailed descriptions of how each works.</p> <div class=\"warning\">Note that many of these examples won't work unchanged in your particular server configuration, so it's important that you understand them, rather than merely cutting and pasting the examples into your configuration.</div>     <h2 id=\"old-to-new\">From Old to New (internal)</h2> <dl> <dt>Description:</dt> <dd> <p>Assume we have recently renamed the page <code>foo.html</code> to <code>bar.html</code> and now want to provide the old URL for backward compatibility. However, we want that users of the old URL even not recognize that the pages was renamed - that is, we don't want the address to change in their browser.</p> </dd> <dt>Solution:</dt> <dd> <p>We rewrite the old URL to the new one internally via the following rule:</p> <pre class=\"prettyprint lang-config\">RewriteEngine  on\nRewriteRule    \"^<strong>/foo</strong>\\.html$\"  \"<strong>/bar</strong>.html\" [PT]</pre> </dd> </dl>   <h2 id=\"old-to-new-extern\">Rewriting From Old to New (external)</h2> <dl> <dt>Description:</dt> <dd> <p>Assume again that we have recently renamed the page <code>foo.html</code> to <code>bar.html</code> and now want to provide the old URL for backward compatibility. But this time we want that the users of the old URL get hinted to the new one, i.e. their browsers Location field should change, too.</p> </dd> <dt>Solution:</dt> <dd> <p>We force a HTTP redirect to the new URL which leads to a change of the browsers and thus the users view:</p> <pre class=\"prettyprint lang-config\">RewriteEngine  on\nRewriteRule    \"^<strong>/foo</strong>\\.html$\"  \"<strong>bar</strong>.html\"  [<strong>R</strong>]</pre> </dd> <dt>Discussion</dt> <dd> <p>In this example, as contrasted to the <a href=\"#old-to-new-intern\">internal</a> example above, we can simply use the Redirect directive. mod_rewrite was used in that earlier example in order to hide the redirect from the client:</p> <pre class=\"prettyprint lang-config\">Redirect \"/foo.html\" \"/bar.html\"</pre> </dd> </dl>   <h2 id=\"movehomedirs\">Resource Moved to Another Server</h2> <dl> <dt>Description:</dt> <dd> <p>If a resource has moved to another server, you may wish to have URLs continue to work for a time on the old server while people update their bookmarks.</p> </dd> <dt>Solution:</dt> <dd> <p>You can use <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> to redirect these URLs to the new server, but you might also consider using the Redirect or RedirectMatch directive.</p> <pre class=\"prettyprint lang-config\">#With mod_rewrite\nRewriteEngine on\nRewriteRule   \"^/docs/(.+)\"  \"http://new.example.com/docs/$1\"  [R,L]</pre> <pre class=\"prettyprint lang-config\">#With RedirectMatch\nRedirectMatch \"^/docs/(.*)\" \"http://new.example.com/docs/$1\"</pre> <pre class=\"prettyprint lang-config\">#With Redirect\nRedirect \"/docs/\" \"http://new.example.com/docs/\"</pre> </dd> </dl>   <h2 id=\"static-to-dynamic\">From Static to Dynamic</h2> <dl> <dt>Description:</dt> <dd> <p>How can we transform a static page <code>foo.html</code> into a dynamic variant <code>foo.cgi</code> in a seamless way, i.e. without notice by the browser/user.</p> </dd> <dt>Solution:</dt> <dd> <p>We just rewrite the URL to the CGI-script and force the handler to be <strong>cgi-script</strong> so that it is executed as a CGI program. This way a request to <code>/~quux/foo.html</code> internally leads to the invocation of <code>/~quux/foo.cgi</code>.</p> <pre class=\"prettyprint lang-config\">RewriteEngine  on\nRewriteBase    \"/~quux/\"\nRewriteRule    \"^foo\\.html$\"  \"foo.cgi\"  [H=<strong>cgi-script</strong>]</pre> </dd> </dl>   <h2 id=\"backward-compatibility\">Backward Compatibility for file extension change</h2> <dl> <dt>Description:</dt> <dd> <p>How can we make URLs backward compatible (still existing virtually) after migrating <code>document.YYYY</code> to <code>document.XXXX</code>, e.g. after translating a bunch of <code>.html</code> files to <code>.php</code>?</p> </dd> <dt>Solution:</dt> <dd> <p>We rewrite the name to its basename and test for existence of the new extension. If it exists, we take that name, else we rewrite the URL to its original state.</p> <pre class=\"prettyprint lang-config\">#   backward compatibility ruleset for\n#   rewriting document.html to document.php\n#   when and only when document.php exists\n&lt;Directory \"/var/www/htdocs\"&gt;\n    RewriteEngine on\n    RewriteBase \"/var/www/htdocs\"\n\n    RewriteCond \"$1.php\" -f\n    RewriteCond \"$1.html\" !-f\n    RewriteRule \"^(.*).html$\" \"$1.php\"\n&lt;/Directory&gt;</pre> </dd> <dt>Discussion</dt> <dd> <p>This example uses an often-overlooked feature of mod_rewrite, by taking advantage of the order of execution of the ruleset. In particular, mod_rewrite evaluates the left-hand-side of the RewriteRule before it evaluates the RewriteCond directives. Consequently, $1 is already defined by the time the RewriteCond directives are evaluated. This allows us to test for the existence of the original (<code>document.html</code>) and target (<code>document.php</code>) files using the same base filename.</p> <p>This ruleset is designed to use in a per-directory context (In a &lt;Directory&gt; block or in a .htaccess file), so that the <code>-f</code> checks are looking at the correct directory path. You may need to set a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritebase\">RewriteBase</a></code> directive to specify the directory base that you're working in.</p> </dd> </dl>   <h2 id=\"canonicalhost\">Canonical Hostnames</h2> <dl> <dt>Description:</dt> <dd>The goal of this rule is to force the use of a particular hostname, in preference to other hostnames which may be used to reach the same site. For example, if you wish to force the use of <strong>www.example.com</strong> instead of <strong>example.com</strong>, you might use a variant of the following recipe.</dd> <dt>Solution:</dt> <dd> <p>The very best way to solve this doesn't involve mod_rewrite at all, but rather uses the <code class=\"directive\"><a href=\"../mod/mod_alias#redirect\">Redirect</a></code> directive placed in a virtual host for the non-canonical hostname(s).</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost *:80&gt;\n  ServerName undesired.example.com\n  ServerAlias example.com notthis.example.com\n\n  Redirect \"/\" \"http://www.example.com/\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:80&gt;\n  ServerName www.example.com\n&lt;/VirtualHost&gt;</pre> <p>You can alternatively accomplish this using the <code class=\"directive\"><a href=\"../mod/core#if\">&lt;If&gt;</a></code> directive:</p> <pre class=\"prettyprint lang-config\">&lt;If \"%{HTTP_HOST} != 'www.example.com'\"&gt;\n\tRedirect \"/\" \"http://www.example.com/\"\n&lt;/If&gt;</pre> <p>Or, for example, to redirect a portion of your site to HTTPS, you might do the following:</p> <pre class=\"prettyprint lang-config\">&lt;If \"%{SERVER_PROTOCOL} != 'HTTPS'\"&gt;\n\tRedirect \"/admin/\" \"https://www.example.com/admin/\"\n&lt;/If&gt;</pre> <p>If, for whatever reason, you still want to use <code>mod_rewrite</code> - if, for example, you need this to work with a larger set of RewriteRules - you might use one of the recipes below.</p> <p>For sites running on a port other than 80:</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_HOST}\"   \"!^www\\.example\\.com\" [NC]\nRewriteCond \"%{HTTP_HOST}\"   \"!^$\"\nRewriteCond \"%{SERVER_PORT}\" \"!^80$\"\nRewriteRule \"^/?(.*)         \"http://www.example.com:%{SERVER_PORT}/$1\" [L,R,NE]</pre> <p>And for a site running on port 80</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_HOST}\"   \"!^www\\.example\\.com\" [NC]\nRewriteCond \"%{HTTP_HOST}\"   \"!^$\"\nRewriteRule \"^/?(.*)\"        \"http://www.example.com/$1\" [L,R,NE]</pre> <p> If you wanted to do this generically for all domain names - that is, if you want to redirect <strong>example.com</strong> to <strong>www.example.com</strong> for all possible values of <strong>example.com</strong>, you could use the following recipe:</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_HOST}\" \"!^www\\.\" [NC]\nRewriteCond \"%{HTTP_HOST}\" \"!^$\"\nRewriteRule \"^/?(.*)\"      \"http://www.%{HTTP_HOST}/$1\" [L,R,NE]</pre> <p>These rulesets will work either in your main server configuration file, or in a <code>.htaccess</code> file placed in the <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> of the server.</p> </dd> </dl>   <h2 id=\"multipledirs\">Search for pages in more than one directory</h2> <dl> <dt>Description:</dt> <dd> <p>A particular resource might exist in one of several places, and we want to look in those places for the resource when it is requested. Perhaps we've recently rearranged our directory structure, dividing content into several locations.</p> </dd> <dt>Solution:</dt> <dd> <p>The following ruleset searches in two directories to find the resource, and, if not finding it in either place, will attempt to just serve it out of the location requested.</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\n\n#   first try to find it in dir1/...\n#   ...and if found stop and be happy:\nRewriteCond         \"%{DOCUMENT_ROOT}/<strong>dir1</strong>/%{REQUEST_URI}\"  -f\nRewriteRule \"^(.+)\" \"%{DOCUMENT_ROOT}/<strong>dir1</strong>/$1\"  [L]\n\n#   second try to find it in dir2/...\n#   ...and if found stop and be happy:\nRewriteCond         \"%{DOCUMENT_ROOT}/<strong>dir2</strong>/%{REQUEST_URI}\"  -f\nRewriteRule \"^(.+)\" \"%{DOCUMENT_ROOT}/<strong>dir2</strong>/$1\"  [L]\n\n#   else go on for other Alias or ScriptAlias directives,\n#   etc.\nRewriteRule   \"^\"  \"-\"  [PT]</pre> </dd> </dl>   <h2 id=\"archive-access-multiplexer\">Redirecting to Geographically Distributed Servers</h2> <dl> <dt>Description:</dt> <dd> <p>We have numerous mirrors of our website, and want to redirect people to the one that is located in the country where they are located.</p> </dd> <dt>Solution:</dt> <dd> <p>Looking at the hostname of the requesting client, we determine which country they are coming from. If we can't do a lookup on their IP address, we fall back to a default server.</p> <p>We'll use a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive to build a list of servers that we wish to use.</p> <pre class=\"prettyprint lang-config\">HostnameLookups on\nRewriteEngine on\nRewriteMap    multiplex         \"txt:/path/to/map.mirrors\"\nRewriteCond   \"%{REMOTE_HOST}\"  \"([a-z]+)$\" [NC]\nRewriteRule   \"^/(.*)$\"  \"${multiplex:<strong>%1</strong>|http://www.example.com/}$1\"  [R,L]</pre> <div class=\"example\"><pre>## map.mirrors -- Multiplexing Map\n\nde http://www.example.de/\nuk http://www.example.uk/\ncom http://www.example.com/\n##EOF##</pre></div> </dd> <dt>Discussion</dt> <dd> <div class=\"warning\">This ruleset relies on <code class=\"directive\"><a href=\"../mod/core#hostnamelookups\">HostNameLookups</a></code> being set <code>on</code>, which can be a significant performance hit.</div> <p>The <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> directive captures the last portion of the hostname of the requesting client - the country code - and the following RewriteRule uses that value to look up the appropriate mirror host in the map file.</p> </dd> </dl>   <h2 id=\"browser-dependent-content\">Browser Dependent Content</h2> <dl> <dt>Description:</dt> <dd> <p>We wish to provide different content based on the browser, or user-agent, which is requesting the content.</p> </dd> <dt>Solution:</dt> <dd> <p>We have to decide, based on the HTTP header \"User-Agent\", which content to serve. The following config does the following: If the HTTP header \"User-Agent\" contains \"Mozilla/3\", the page <code>foo.html</code> is rewritten to <code>foo.NS.html</code> and the rewriting stops. If the browser is \"Lynx\" or \"Mozilla\" of version 1 or 2, the URL becomes <code>foo.20.html</code>. All other browsers receive page <code>foo.32.html</code>. This is done with the following ruleset:</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{HTTP_USER_AGENT}\"  \"^<strong>Mozilla/3</strong>.*\"\nRewriteRule \"^foo\\.html$\"         \"foo.<strong>NS</strong>.html\"          [<strong>L</strong>]\n\nRewriteCond \"%{HTTP_USER_AGENT}\"  \"^Lynx/\" [OR]\nRewriteCond \"%{HTTP_USER_AGENT}\"  \"^Mozilla/[12]\"\nRewriteRule \"^foo\\.html$\"         \"foo.<strong>20</strong>.html\"          [<strong>L</strong>]\n\nRewriteRule \"^foo\\.html$\"         \"foo.<strong>32</strong>.html\"          [<strong>L</strong>]</pre> </dd> </dl>   <h2 id=\"canonicalurl\">Canonical URLs</h2> <dl> <dt>Description:</dt> <dd> <p>On some webservers there is more than one URL for a resource. Usually there are canonical URLs (which are be actually used and distributed) and those which are just shortcuts, internal ones, and so on. Independent of which URL the user supplied with the request, they should finally see the canonical one in their browser address bar.</p> </dd> <dt>Solution:</dt> <dd> <p>We do an external HTTP redirect for all non-canonical URLs to fix them in the location view of the Browser and for all subsequent requests. In the example ruleset below we replace <code>/puppies</code> and <code>/canines</code> by the canonical <code>/dogs</code>.</p> <pre class=\"prettyprint lang-config\">RewriteRule   \"^/(puppies|canines)/(.*)\"    \"/dogs/$2\"  [R]</pre> </dd> <dt>Discussion:</dt> <dd> This should really be accomplished with Redirect or RedirectMatch directives: <pre class=\"prettyprint lang-config\">RedirectMatch \"^/(puppies|canines)/(.*)\" \"/dogs/$2\"</pre> </dd> </dl>   <h2 id=\"moveddocroot\">Moved <code>DocumentRoot</code>\n</h2> <dl> <dt>Description:</dt> <dd> <p>Usually the <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> of the webserver directly relates to the URL \"<code>/</code>\". But often this data is not really of top-level priority. For example, you may wish for visitors, on first entering a site, to go to a particular subdirectory <code>/about/</code>. This may be accomplished using the following ruleset:</p> </dd> <dt>Solution:</dt> <dd> <p>We redirect the URL <code>/</code> to <code>/about/</code>: </p> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteRule   \"^/$\"  \"/about/\"  [<strong>R</strong>]</pre> <p>Note that this can also be handled using the <code class=\"directive\"><a href=\"../mod/mod_alias#redirectmatch\">RedirectMatch</a></code> directive:</p> <pre class=\"prettyprint lang-config\">RedirectMatch \"^/$\" \"http://example.com/about/\"</pre> <p>Note also that the example rewrites only the root URL. That is, it rewrites a request for <code>http://example.com/</code>, but not a request for <code>http://example.com/page.html</code>. If you have in fact changed your document root - that is, if <strong>all</strong> of your content is in fact in that subdirectory, it is greatly preferable to simply change your <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> directive, or move all of the content up one directory, rather than rewriting URLs.</p> </dd> </dl>   <h2 id=\"fallback-resource\">Fallback Resource</h2> <dl> <dt>Description:</dt> <dd>You want a single resource (say, a certain file, like index.php) to handle all requests that come to a particular directory, except those that should go to an existing resource such as an image, or a css file.</dd> <dt>Solution:</dt> <dd> <p>As of version 2.2.16, you should use the <code class=\"directive\"><a href=\"../mod/mod_dir#fallbackresource\">FallbackResource</a></code> directive for this:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/var/www/my_blog\"&gt;\n  FallbackResource \"index.php\"\n&lt;/Directory&gt;</pre> <p>However, in earlier versions of Apache, or if your needs are more complicated than this, you can use a variation of the following rewrite set to accomplish the same thing:</p> <pre class=\"prettyprint lang-config\">&lt;Directory \"/var/www/my_blog\"&gt;\n  RewriteBase \"/my_blog\"\n\n  RewriteCond \"/var/www/my_blog/%{REQUEST_FILENAME}\" !-f\n  RewriteCond \"/var/www/my_blog/%{REQUEST_FILENAME}\" !-d\n  RewriteRule \"^\" \"index.php\" [PT]\n&lt;/Directory&gt;</pre> <p>If, on the other hand, you wish to pass the requested URI as a query string argument to index.php, you can replace that RewriteRule with:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"(.*)\" \"index.php?$1\" [PT,QSA]</pre> <p>Note that these rulesets can be used in a <code>.htaccess</code> file, as well as in a &lt;Directory&gt; block.</p> </dd> </dl>   <h2 id=\"rewrite-query\">Rewrite query string</h2> <dl> <dt>Description:</dt> <dd>You want to capture a particular value from a query string and either replace it or incorporate it into another component of the URL.</dd> <dt>Solutions:</dt> <dd> <p> Many of the solutions in this section will all use the same condition, which leaves the matched value in the %2 backreference. %1 is the beginining of the query string (up to the key of intererest), and %3 is the remainder. This condition is a bit complex for flexibility and to avoid double '&amp;&amp;' in the substitutions.</p> <ul> <li>This solution removes the matching key and value: <pre class=\"prettyprint lang-config\"># Remove mykey=???\nRewriteCond \"%{QUERY_STRING}\" \"(.*(?:^|&amp;))mykey=([^&amp;]*)&amp;?(.*)&amp;?$\"\nRewriteRule \"(.*)\" \"$1?%1%3\"</pre> </li> <li>This solution uses the captured value in the URL subsitution, discarding the rest of the original query by appending a '?': <pre class=\"prettyprint lang-config\"># Copy from query string to PATH_INFO\nRewriteCond \"%{QUERY_STRING}\" \"(.*(?:^|&amp;))mykey=([^&amp;]*)&amp;?(.*)&amp;?$\"\nRewriteRule \"(.*)\" \"$1/products/%2/?\" [PT]</pre> </li> <li>This solution checks the captured value in a subsequent condition: <pre class=\"prettyprint lang-config\"># Capture the value of mykey in the query string\nRewriteCond \"%{QUERY_STRING}\" \"(.*(?:^|&amp;))mykey=([^&amp;]*)&amp;?(.*)&amp;?$\"\nRewriteCond \"%2\" !=not-so-secret-value \nRewriteRule \"(.*)\" - [F]</pre> </li> <li>This solution shows the reverse of the previous ones, copying path components (perhaps PATH_INFO) from the URL into the query string. <pre class=\"prettyprint lang-config\"># The desired URL might be /products/kitchen-sink, and the script expects \n# /path?products=kitchen-sink.\nRewriteRule \"^/?path/([^/]+)/([^/]+)\" \"/path?$1=$2\" [PT]</pre> </li> </ul> </dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/remapping.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/remapping.html</a>\n  </p>\n</div>\n","rewrite/flags":"<h1>RewriteRule Flags</h1>  <p>This document discusses the flags which are available to the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> directive, providing detailed explanations and examples.</p>     <h2 id=\"introduction\">Introduction</h2> <p>A <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> can have its behavior modified by one or more flags. Flags are included in square brackets at the end of the rule, and multiple flags are separated by commas.</p> <pre class=\"prettyprint lang-config\">RewriteRule pattern target [Flag1,Flag2,Flag3]</pre> <p>Each flag (with a few exceptions) has a short form, such as <code>CO</code>, as well as a longer form, such as <code>cookie</code>. While it is most common to use the short form, it is recommended that you familiarize yourself with the long form, so that you remember what each flag is supposed to do. Some flags take one or more arguments. Flags are not case sensitive.</p> <p>Flags that alter metadata associated with the request (T=, H=, E=) have no affect in per-directory and htaccess context, when a substitution (other than '-') is performed during the same round of rewrite processing. </p> <p>Presented here are each of the available flags, along with an example of how you might use them.</p>   <h2 id=\"flag_b\">B (escape backreferences)</h2> <p>The [B] flag instructs <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> to escape non-alphanumeric characters before applying the transformation. </p> <p><code>mod_rewrite</code> has to unescape URLs before mapping them, so backreferences are unescaped at the time they are applied. Using the B flag, non-alphanumeric characters in backreferences will be escaped. For example, consider the rule:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"^search/(.*)$\" \"/search.php?term=$1\"</pre> <p>Given a search term of 'x &amp; y/z', a browser will encode it as 'x%20%26%20y%2Fz', making the request 'search/x%20%26%20y%2Fz'. Without the B flag, this rewrite rule will map to 'search.php?term=x &amp; y/z', which isn't a valid URL, and so would be encoded as <code>search.php?term=x%20&amp;y%2Fz=</code>, which is not what was intended.</p> <p>With the B flag set on this same rule, the parameters are re-encoded before being passed on to the output URL, resulting in a correct mapping to <code>/search.php?term=x%20%26%20y%2Fz</code>.</p> <p>Note that you may also need to set <code class=\"directive\"><a href=\"../mod/core#allowencodedslashes\">AllowEncodedSlashes</a></code> to <code>On</code> to get this particular example to work, as httpd does not allow encoded slashes in URLs, and returns a 404 if it sees one.</p> <p>This escaping is particularly necessary in a proxy situation, when the backend may break if presented with an unescaped URL.</p>   <h2 id=\"flag_c\">C|chain</h2> <p>The [C] or [chain] flag indicates that the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> is chained to the next rule. That is, if the rule matches, then it is processed as usual and control moves on to the next rule. However, if it does not match, then the next rule, and any other rules that are chained together, are skipped.</p>   <h2 id=\"flag_co\">CO|cookie</h2> <p>The [CO], or [cookie] flag, allows you to set a cookie when a particular <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> matches. The argument consists of three required fields and four optional fields.</p> <p>The full syntax for the flag, including all attributes, is as follows:</p> <div class=\"example\"><code>[CO=NAME:VALUE:DOMAIN:lifetime:path:secure:httponly]</code></div> <p>If a literal ':' character is needed in any of the cookie fields, an alternate syntax is available. To opt-in to the alternate syntax, the cookie \"Name\" should be preceded with a ';' character, and field separators should be specified as ';'.</p> <div class=\"example\"><code>[CO=;NAME;VALUE:MOREVALUE;DOMAIN;lifetime;path;secure;httponly]</code></div> <p>You must declare a name, a value, and a domain for the cookie to be set.</p> <dl> <dt>Domain</dt> <dd>The domain for which you want the cookie to be valid. This may be a hostname, such as <code>www.example.com</code>, or it may be a domain, such as <code>.example.com</code>. It must be at least two parts separated by a dot. That is, it may not be merely <code>.com</code> or <code>.net</code>. Cookies of that kind are forbidden by the cookie security model.</dd> </dl> <p>You may optionally also set the following values:</p> <dl> <dt>Lifetime</dt> <dd>The time for which the cookie will persist, in minutes.</dd> <dd>A value of 0 indicates that the cookie will persist only for the current browser session. This is the default value if none is specified.</dd> <dt>Path</dt> <dd>The path, on the current website, for which the cookie is valid, such as <code>/customers/</code> or <code>/files/download/</code>.</dd> <dd>By default, this is set to <code>/</code> - that is, the entire website.</dd> <dt>Secure</dt> <dd>If set to <code>secure</code>, <code>true</code>, or <code>1</code>, the cookie will only be permitted to be translated via secure (https) connections.</dd> <dt>httponly</dt> <dd>If set to <code>HttpOnly</code>, <code>true</code>, or <code>1</code>, the cookie will have the <code>HttpOnly</code> flag set, which means that the cookie is inaccessible to JavaScript code on browsers that support this feature.</dd> </dl> <p>Consider this example:</p> <pre class=\"prettyprint lang-config\">RewriteEngine On\nRewriteRule \"^/index\\.html\" \"-\" [CO=frontdoor:yes:.example.com:1440:/]</pre> <p>In the example give, the rule doesn't rewrite the request. The \"-\" rewrite target tells mod_rewrite to pass the request through unchanged. Instead, it sets a cookie called 'frontdoor' to a value of 'yes'. The cookie is valid for any host in the <code>.example.com</code> domain. It is set to expire in 1440 minutes (24 hours) and is returned for all URIs.</p>   <h2 id=\"flag_dpi\">DPI|discardpath</h2> <p>The DPI flag causes the PATH_INFO portion of the rewritten URI to be discarded.</p> <p>This flag is available in version 2.2.12 and later.</p> <p>In per-directory context, the URI each <code class=\"directive\">RewriteRule</code> compares against is the concatenation of the current values of the URI and PATH_INFO.</p> <p>The current URI can be the initial URI as requested by the client, the result of a previous round of mod_rewrite processing, or the result of a prior rule in the current round of mod_rewrite processing.</p> <p>In contrast, the PATH_INFO that is appended to the URI before each rule reflects only the value of PATH_INFO before this round of mod_rewrite processing. As a consequence, if large portions of the URI are matched and copied into a substitution in multiple <code class=\"directive\">RewriteRule</code> directives, without regard for which parts of the URI came from the current PATH_INFO, the final URI may have multiple copies of PATH_INFO appended to it.</p> <p>Use this flag on any substitution where the PATH_INFO that resulted from the previous mapping of this request to the filesystem is not of interest. This flag permanently forgets the PATH_INFO established before this round of mod_rewrite processing began. PATH_INFO will not be recalculated until the current round of mod_rewrite processing completes. Subsequent rules during this round of processing will see only the direct result of substitutions, without any PATH_INFO appended.</p>   <h2 id=\"flag_e\">E|env</h2> <p>With the [E], or [env] flag, you can set the value of an environment variable. Note that some environment variables may be set after the rule is run, thus unsetting what you have set. See <a href=\"../env\">the Environment Variables document</a> for more details on how Environment variables work.</p> <p>The full syntax for this flag is:</p> <pre class=\"prettyprint lang-config\">[E=VAR:VAL]\n[E=!VAR]</pre> <p><code>VAL</code> may contain backreferences (<code>$N</code> or <code>%N</code>) which are expanded.</p> <p>Using the short form</p> <div class=\"example\"><code>[E=VAR]</code></div> <p>you can set the environment variable named <code>VAR</code> to an empty value.</p> <p>The form</p> <div class=\"example\"><code>[E=!VAR]</code></div> <p>allows to unset a previously set environment variable named <code>VAR</code>.</p> <p>Environment variables can then be used in a variety of contexts, including CGI programs, other RewriteRule directives, or CustomLog directives.</p> <p>The following example sets an environment variable called 'image' to a value of '1' if the requested URI is an image file. Then, that environment variable is used to exclude those requests from the access log.</p> <pre class=\"prettyprint lang-config\">RewriteRule \"\\.(png|gif|jpg)$\" \"-\" [E=image:1]\nCustomLog \"logs/access_log\" combined env=!image</pre> <p>Note that this same effect can be obtained using <code class=\"directive\"><a href=\"../mod/mod_setenvif#setenvif\">SetEnvIf</a></code>. This technique is offered as an example, not as a recommendation.</p>   <h2 id=\"flag_end\">END</h2> <p>Using the [END] flag terminates not only the current round of rewrite processing (like [L]) but also prevents any subsequent rewrite processing from occurring in per-directory (htaccess) context.</p> <p>This does not apply to new requests resulting from external redirects.</p>   <h2 id=\"flag_f\">F|forbidden</h2> <p>Using the [F] flag causes the server to return a 403 Forbidden status code to the client. While the same behavior can be accomplished using the <code class=\"directive\"><a href=\"../mod/mod_access_compat#deny\">Deny</a></code> directive, this allows more flexibility in assigning a Forbidden status.</p> <p>The following rule will forbid <code>.exe</code> files from being downloaded from your server.</p> <pre class=\"prettyprint lang-config\">RewriteRule \"\\.exe\" \"-\" [F]</pre> <p>This example uses the \"-\" syntax for the rewrite target, which means that the requested URI is not modified. There's no reason to rewrite to another URI, if you're going to forbid the request.</p> <p>When using [F], an [L] is implied - that is, the response is returned immediately, and no further rules are evaluated.</p>   <h2 id=\"flag_g\">G|gone</h2> <p>The [G] flag forces the server to return a 410 Gone status with the response. This indicates that a resource used to be available, but is no longer available.</p> <p>As with the [F] flag, you will typically use the \"-\" syntax for the rewrite target when using the [G] flag:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"oldproduct\" \"-\" [G,NC]</pre> <p>When using [G], an [L] is implied - that is, the response is returned immediately, and no further rules are evaluated.</p>   <h2 id=\"flag_h\">H|handler</h2> <p>Forces the resulting request to be handled with the specified handler. For example, one might use this to force all files without a file extension to be parsed by the php handler:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"!\\.\" \"-\" [H=application/x-httpd-php]</pre> <p> The regular expression above - <code>!\\.</code> - will match any request that does not contain the literal <code>.</code> character. </p> <p>This can be also used to force the handler based on some conditions. For example, the following snippet used in per-server context allows <code>.php</code> files to be <em>displayed</em> by <code>mod_php</code> if they are requested with the <code>.phps</code> extension:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"^(/source/.+\\.php)s$\" \"$1\" [H=application/x-httpd-php-source]</pre> <p>The regular expression above - <code>^(/source/.+\\.php)s$</code> - will match any request that starts with <code>/source/</code> followed by 1 or n characters followed by <code>.phps</code> literally. The backreference $1 referrers to the captured match within parenthesis of the regular expression.</p>   <h2 id=\"flag_l\">L|last</h2> <p>The [L] flag causes <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> to stop processing the rule set. In most contexts, this means that if the rule matches, no further rules will be processed. This corresponds to the <code>last</code> command in Perl, or the <code>break</code> command in C. Use this flag to indicate that the current rule should be applied immediately without considering further rules.</p> <p>If you are using <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> in either <code>.htaccess</code> files or in <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> sections, it is important to have some understanding of how the rules are processed. The simplified form of this is that once the rules have been processed, the rewritten request is handed back to the URL parsing engine to do what it may with it. It is possible that as the rewritten request is handled, the <code>.htaccess</code> file or <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> section may be encountered again, and thus the ruleset may be run again from the start. Most commonly this will happen if one of the rules causes a redirect - either internal or external - causing the request process to start over.</p> <p>It is therefore important, if you are using <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> directives in one of these contexts, that you take explicit steps to avoid rules looping, and not count solely on the [L] flag to terminate execution of a series of rules, as shown below.</p> <p> An alternative flag, [END], can be used to terminate not only the current round of rewrite processing but prevent any subsequent rewrite processing from occurring in per-directory (htaccess) context. This does not apply to new requests resulting from external redirects.</p> <p>The example given here will rewrite any request to <code>index.php</code>, giving the original request as a query string argument to <code>index.php</code>, however, the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> ensures that if the request is already for <code>index.php</code>, the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> will be skipped.</p> <pre class=\"prettyprint lang-config\">RewriteBase \"/\"\nRewriteCond \"%{REQUEST_URI}\" \"!=/index.php\"\nRewriteRule \"^(.*)\" \"/index.php?req=$1\" [L,PT]</pre>   <h2 id=\"flag_n\">N|next</h2> <p> The [N] flag causes the ruleset to start over again from the top, using the result of the ruleset so far as a starting point. Use with extreme caution, as it may result in loop. </p> <p> The [Next] flag could be used, for example, if you wished to replace a certain string or letter repeatedly in a request. The example shown here will replace A with B everywhere in a request, and will continue doing so until there are no more As to be replaced. </p> <pre class=\"prettyprint lang-config\">RewriteRule \"(.*)A(.*)\" \"$1B$2\" [N]</pre> <p>You can think of this as a <code>while</code> loop: While this pattern still matches (i.e., while the URI still contains an <code>A</code>), perform this substitution (i.e., replace the <code>A</code> with a <code>B</code>).</p> <p>In 2.4.8 and later, this module returns an error after 32,000 iterations to protect against unintended looping. An alternative maximum number of iterations can be specified by adding to the N flag. </p> <pre class=\"prettyprint lang-config\"># Be willing to replace 1 character in each pass of the loop\nRewriteRule \"(.+)[&gt;&lt;;]$\" \"$1\" [N=64000]\n# ... or, give up if after 10 loops\nRewriteRule \"(.+)[&gt;&lt;;]$\" \"$1\" [N=10]</pre>   <h2 id=\"flag_nc\">NC|nocase</h2> <p>Use of the [NC] flag causes the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> to be matched in a case-insensitive manner. That is, it doesn't care whether letters appear as upper-case or lower-case in the matched URI.</p> <p>In the example below, any request for an image file will be proxied to your dedicated image server. The match is case-insensitive, so that <code>.jpg</code> and <code>.JPG</code> files are both acceptable, for example.</p> <pre class=\"prettyprint lang-config\">RewriteRule \"(.*\\.(jpg|gif|png))$\" \"http://images.example.com$1\" [P,NC]</pre>   <h2 id=\"flag_ne\">NE|noescape</h2> <p>By default, special characters, such as <code>&amp;</code> and <code>?</code>, for example, will be converted to their hexcode equivalent. Using the [NE] flag prevents that from happening. </p> <pre class=\"prettyprint lang-config\">RewriteRule \"^/anchor/(.+)\" \"/bigpage.html#$1\" [NE,R]</pre> <p> The above example will redirect <code>/anchor/xyz</code> to <code>/bigpage.html#xyz</code>. Omitting the [NE] will result in the # being converted to its hexcode equivalent, <code>%23</code>, which will then result in a 404 Not Found error condition. </p>   <h2 id=\"flag_ns\">NS|nosubreq</h2> <p>Use of the [NS] flag prevents the rule from being used on subrequests. For example, a page which is included using an SSI (Server Side Include) is a subrequest, and you may want to avoid rewrites happening on those subrequests. Also, when <code class=\"module\"><a href=\"../mod/mod_dir\">mod_dir</a></code> tries to find out information about possible directory default files (such as <code>index.html</code> files), this is an internal subrequest, and you often want to avoid rewrites on such subrequests. On subrequests, it is not always useful, and can even cause errors, if the complete set of rules are applied. Use this flag to exclude problematic rules.</p> <p>To decide whether or not to use this rule: if you prefix URLs with CGI-scripts, to force them to be processed by the CGI-script, it's likely that you will run into problems (or significant overhead) on sub-requests. In these cases, use this flag.</p> <p> Images, javascript files, or css files, loaded as part of an HTML page, are not subrequests - the browser requests them as separate HTTP requests. </p>   <h2 id=\"flag_p\">P|proxy</h2> <p>Use of the [P] flag causes the request to be handled by <code class=\"module\"><a href=\"../mod/mod_proxy\">mod_proxy</a></code>, and handled via a proxy request. For example, if you wanted all image requests to be handled by a back-end image server, you might do something like the following:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"/(.*)\\.(jpg|gif|png)$\" \"http://images.example.com/$1.$2\" [P]</pre> <p>Use of the [P] flag implies [L] - that is, the request is immediately pushed through the proxy, and any following rules will not be considered.</p> <p> You must make sure that the substitution string is a valid URI (typically starting with <code>http://</code><em>hostname</em>) which can be handled by the <code class=\"module\"><a href=\"../mod/mod_proxy\">mod_proxy</a></code>. If not, you will get an error from the proxy module. Use this flag to achieve a more powerful implementation of the <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code> directive, to map remote content into the namespace of the local server.</p> <div class=\"warning\"> <p><strong>Security Warning</strong></p> <p>Take care when constructing the target URL of the rule, considering the security impact from allowing the client influence over the set of URLs to which your server will act as a proxy. Ensure that the scheme and hostname part of the URL is either fixed, or does not allow the client undue influence.</p> </div> <div class=\"warning\"> <p><strong>Performance warning</strong></p> <p>Using this flag triggers the use of <code class=\"module\"><a href=\"../mod/mod_proxy\">mod_proxy</a></code>, without handling of persistent connections. This means the performance of your proxy will be better if you set it up with <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code> or <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypassmatch\">ProxyPassMatch</a></code></p> <p>This is because this flag triggers the use of the default worker, which does not handle connection pooling.</p> <p>Avoid using this flag and prefer those directives, whenever you can.</p> </div> <p>Note: <code class=\"module\"><a href=\"../mod/mod_proxy\">mod_proxy</a></code> must be enabled in order to use this flag.</p>   <h2 id=\"flag_pt\">PT|passthrough</h2> <p> The target (or substitution string) in a RewriteRule is assumed to be a file path, by default. The use of the [PT] flag causes it to be treated as a URI instead. That is to say, the use of the [PT] flag causes the result of the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> to be passed back through URL mapping, so that location-based mappings, such as <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code>, <code class=\"directive\"><a href=\"../mod/mod_alias#redirect\">Redirect</a></code>, or <code class=\"directive\"><a href=\"../mod/mod_alias#scriptalias\">ScriptAlias</a></code>, for example, might have a chance to take effect. </p> <p> If, for example, you have an <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code> for /icons, and have a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> pointing there, you should use the [PT] flag to ensure that the <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code> is evaluated. </p> <pre class=\"prettyprint lang-config\">Alias \"/icons\" \"/usr/local/apache/icons\"\nRewriteRule \"/pics/(.+)\\.jpg$\" \"/icons/$1.gif\" [PT]</pre> <p> Omission of the [PT] flag in this case will cause the Alias to be ignored, resulting in a 'File not found' error being returned. </p> <p>The <code>PT</code> flag implies the <code>L</code> flag: rewriting will be stopped in order to pass the request to the next phase of processing.</p> <p>Note that the <code>PT</code> flag is implied in per-directory contexts such as <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> sections or in <code>.htaccess</code> files. The only way to circumvent that is to rewrite to <code>-</code>.</p>   <h2 id=\"flag_qsa\">QSA|qsappend</h2> <p> When the replacement URI contains a query string, the default behavior of <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> is to discard the existing query string, and replace it with the newly generated one. Using the [QSA] flag causes the query strings to be combined. </p> <p>Consider the following rule:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"/pages/(.+)\" \"/page.php?page=$1\" [QSA]</pre> <p>With the [QSA] flag, a request for <code>/pages/123?one=two</code> will be mapped to <code>/page.php?page=123&amp;one=two</code>. Without the [QSA] flag, that same request will be mapped to <code>/page.php?page=123</code> - that is, the existing query string will be discarded. </p>   <h2 id=\"flag_qsd\">QSD|qsdiscard</h2> <p> When the requested URI contains a query string, and the target URI does not, the default behavior of <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> is to copy that query string to the target URI. Using the [QSD] flag causes the query string to be discarded. </p> <p>This flag is available in version 2.4.0 and later.</p> <p> Using [QSD] and [QSA] together will result in [QSD] taking precedence. </p> <p> If the target URI has a query string, the default behavior will be observed - that is, the original query string will be discarded and replaced with the query string in the <code>RewriteRule</code> target URI. </p>   <h2 id=\"flag_qsl\">QSL|qslast</h2> <p> By default, the first (left-most) question mark in the substitution delimits the path from the query string. Using the [QSL] flag instructs <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> to instead split the two components using the last (right-most) question mark. </p> <p> This is useful when mapping to files that have literal question marks in their filename. If no query string is used in the substitution, a question mark can be appended to it in combination with this flag. </p> <p> This flag is available in version 2.4.19 and later.</p>   <h2 id=\"flag_r\">R|redirect</h2> <p> Use of the [R] flag causes a HTTP redirect to be issued to the browser. If a fully-qualified URL is specified (that is, including <code>http://servername/</code>) then a redirect will be issued to that location. Otherwise, the current protocol, servername, and port number will be used to generate the URL sent with the redirect. </p> <p> <em>Any</em> valid HTTP response status code may be specified, using the syntax [R=305], with a 302 status code being used by default if none is specified. The status code specified need not necessarily be a redirect (3xx) status code. However, if a status code is outside the redirect range (300-399) then the substitution string is dropped entirely, and rewriting is stopped as if the <code>L</code> were used.</p> <p>In addition to response status codes, you may also specify redirect status using their symbolic names: <code>temp</code> (default), <code>permanent</code>, or <code>seeother</code>.</p> <p> You will almost always want to use [R] in conjunction with [L] (that is, use [R,L]) because on its own, the [R] flag prepends <code>http://thishost[:thisport]</code> to the URI, but then passes this on to the next rule in the ruleset, which can often result in 'Invalid URI in request' warnings. </p>   <h2 id=\"flag_s\">S|skip</h2> <p>The [S] flag is used to skip rules that you don't want to run. The syntax of the skip flag is [S=<em>N</em>], where <em>N</em> signifies the number of rules to skip (provided the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\"> RewriteRule</a></code> matches). This can be thought of as a <code>goto</code> statement in your rewrite ruleset. In the following example, we only want to run the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> if the requested URI doesn't correspond with an actual file.</p> <pre class=\"prettyprint lang-config\"># Is the request for a non-existent file?\nRewriteCond \"%{REQUEST_FILENAME}\" \"!-f\"\nRewriteCond \"%{REQUEST_FILENAME}\" \"!-d\"\n# If so, skip these two RewriteRules\nRewriteRule \".?\" \"-\" [S=2]\n\nRewriteRule \"(.*\\.gif)\" \"images.php?$1\"\nRewriteRule \"(.*\\.html)\" \"docs.php?$1\"</pre> <p>This technique is useful because a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> only applies to the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> immediately following it. Thus, if you want to make a <code>RewriteCond</code> apply to several <code>RewriteRule</code>s, one possible technique is to negate those conditions and add a <code>RewriteRule</code> with a [Skip] flag. You can use this to make pseudo if-then-else constructs: The last rule of the then-clause becomes <code>skip=N</code>, where N is the number of rules in the else-clause:</p> <pre class=\"prettyprint lang-config\"># Does the file exist?\nRewriteCond \"%{REQUEST_FILENAME}\" \"!-f\"\nRewriteCond \"%{REQUEST_FILENAME}\" \"!-d\"\n# Create an if-then-else construct by skipping 3 lines if we meant to go to the \"else\" stanza.\nRewriteRule \".?\" \"-\" [S=3]\n\n# IF the file exists, then:\n    RewriteRule \"(.*\\.gif)\" \"images.php?$1\"\n    RewriteRule \"(.*\\.html)\" \"docs.php?$1\"\n    # Skip past the \"else\" stanza.\n    RewriteRule \".?\" \"-\" [S=1]\n# ELSE...\n    RewriteRule \"(.*)\" \"404.php?file=$1\"\n# END</pre> <p>It is probably easier to accomplish this kind of configuration using the <code class=\"directive\">&lt;If&gt;</code>, <code class=\"directive\">&lt;ElseIf&gt;</code>, and <code class=\"directive\">&lt;Else&gt;</code> directives instead.</p>   <h2 id=\"flag_t\">T|type</h2> <p>Sets the MIME type with which the resulting response will be sent. This has the same effect as the <code class=\"directive\"><a href=\"../mod/mod_mime#addtype\">AddType</a></code> directive.</p> <p>For example, you might use the following technique to serve Perl source code as plain text, if requested in a particular way:</p> <pre class=\"prettyprint lang-config\"># Serve .pl files as plain text\nRewriteRule \"\\.pl$\" \"-\" [T=text/plain]</pre> <p>Or, perhaps, if you have a camera that produces jpeg images without file extensions, you could force those images to be served with the correct MIME type by virtue of their file names:</p> <pre class=\"prettyprint lang-config\"># Files with 'IMG' in the name are jpg images.\nRewriteRule \"IMG\" \"-\" [T=image/jpg]</pre> <p>Please note that this is a trivial example, and could be better done using <code class=\"directive\"><a href=\"../mod/core#filesmatch\">&lt;FilesMatch&gt;</a></code> instead. Always consider the alternate solutions to a problem before resorting to rewrite, which will invariably be a less efficient solution than the alternatives.</p> <p> If used in per-directory context, use only <code>-</code> (dash) as the substitution <em>for the entire round of mod_rewrite processing</em>, otherwise the MIME-type set with this flag is lost due to an internal re-processing (including subsequent rounds of mod_rewrite processing). The <code>L</code> flag can be useful in this context to end the <em>current</em> round of mod_rewrite processing.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/flags.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/flags.html</a>\n  </p>\n</div>\n","rewrite/advanced":"<h1>Advanced Techniques with mod_rewrite</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It provides a few advanced techniques using mod_rewrite.</p> <div class=\"warning\">Note that many of these examples won't work unchanged in your particular server configuration, so it's important that you understand them, rather than merely cutting and pasting the examples into your configuration.</div>     <h2 id=\"sharding\">URL-based sharding across multiple backends</h2> <dl> <dt>Description:</dt> <dd> <p>A common technique for distributing the burden of server load or storage space is called \"sharding\". When using this method, a front-end server will use the url to consistently \"shard\" users or objects to separate backend servers.</p> </dd> <dt>Solution:</dt> <dd> <p>A mapping is maintained, from users to target servers, in external map files. They look like:</p> <div class=\"example\"><pre>user1 physical_host_of_user1\nuser2 physical_host_of_user2\n: :</pre></div> <p>We put this into a <code>map.users-to-hosts</code> file. The aim is to map;</p> <div class=\"example\"><code>/u/user1/anypath</code></div> <p>to</p> <div class=\"example\"><code>http://physical_host_of_user1/u/user/anypath</code></div> <p>thus every URL path need not be valid on every backend physical host. The following ruleset does this for us with the help of the map files assuming that server0 is a default server which will be used if a user has no entry in the map:</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteMap      users-to-hosts   \"txt:/path/to/map.users-to-hosts\"\nRewriteRule   \"^/u/([^/]+)/?(.*)\"   \"http://${users-to-hosts:$1|server0}/u/$1/$2\"</pre> </dd> </dl> <p>See the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> documentation for more discussion of the syntax of this directive.</p>   <h2 id=\"on-the-fly-content\">On-the-fly Content-Regeneration</h2> <dl> <dt>Description:</dt> <dd> <p>We wish to dynamically generate content, but store it statically once it is generated. This rule will check for the existence of the static file, and if it's not there, generate it. The static files can be removed periodically, if desired (say, via cron) and will be regenerated on demand.</p> </dd> <dt>Solution:</dt> <dd> This is done via the following ruleset: <pre class=\"prettyprint lang-config\"># This example is valid in per-directory context only\nRewriteCond \"%{REQUEST_URI}\"   \"!-U\"\nRewriteRule \"^(.+)\\.html$\"          \"/regenerate_page.cgi\"   [PT,L]</pre> <p>The <code>-U</code> operator determines whether the test string (in this case, <code>REQUEST_URI</code>) is a valid URL. It does this via a subrequest. In the event that this subrequest fails - that is, the requested resource doesn't exist - this rule invokes the CGI program <code>/regenerate_page.cgi</code>, which generates the requested resource and saves it into the document directory, so that the next time it is requested, a static copy can be served.</p> <p>In this way, documents that are infrequently updated can be served in static form. if documents need to be refreshed, they can be deleted from the document directory, and they will then be regenerated the next time they are requested.</p> </dd> </dl>   <h2 id=\"load-balancing\">Load Balancing</h2> <dl> <dt>Description:</dt> <dd> <p>We wish to randomly distribute load across several servers using mod_rewrite.</p> </dd> <dt>Solution:</dt> <dd> <p>We'll use <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> and a list of servers to accomplish this.</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteMap lb \"rnd:/path/to/serverlist.txt\"\nRewriteRule \"^/(.*)\" \"http://${lb:servers}/$1\" [P,L]</pre> <p><code>serverlist.txt</code> will contain a list of the servers:</p> <div class=\"example\"><pre>## serverlist.txt\n\nservers one.example.com|two.example.com|three.example.com</pre></div> <p>If you want one particular server to get more of the load than the others, add it more times to the list.</p> </dd> <dt>Discussion</dt> <dd> <p>Apache comes with a load-balancing module - <code class=\"module\"><a href=\"../mod/mod_proxy_balancer\">mod_proxy_balancer</a></code> - which is far more flexible and featureful than anything you can cobble together using mod_rewrite.</p> </dd> </dl>   <h2 id=\"structuredhomedirs\">Structured Userdirs</h2> <dl> <dt>Description:</dt> <dd> <p>Some sites with thousands of users use a structured homedir layout, <em>i.e.</em> each homedir is in a subdirectory which begins (for instance) with the first character of the username. So, <code>/~larry/anypath</code> is <code>/home/l/larry/public_html/anypath</code> while <code>/~waldo/anypath</code> is <code>/home/w/waldo/public_html/anypath</code>.</p> </dd> <dt>Solution:</dt> <dd> <p>We use the following ruleset to expand the tilde URLs into the above layout.</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteRule   \"^/~(<strong>([a-z])</strong>[a-z0-9]+)(.*)\"  \"/home/<strong>$2</strong>/$1/public_html$3\"</pre> </dd> </dl>   <h2 id=\"redirectanchors\">Redirecting Anchors</h2> <dl> <dt>Description:</dt> <dd> <p>By default, redirecting to an HTML anchor doesn't work, because mod_rewrite escapes the <code>#</code> character, turning it into <code>%23</code>. This, in turn, breaks the redirection.</p> </dd> <dt>Solution:</dt> <dd> <p>Use the <code>[NE]</code> flag on the <code>RewriteRule</code>. NE stands for No Escape. </p> </dd> <dt>Discussion:</dt> <dd>This technique will of course also work with other special characters that mod_rewrite, by default, URL-encodes.</dd> </dl>   <h2 id=\"time-dependent\">Time-Dependent Rewriting</h2> <dl> <dt>Description:</dt> <dd> <p>We wish to use mod_rewrite to serve different content based on the time of day.</p> </dd> <dt>Solution:</dt> <dd> <p>There are a lot of variables named <code>TIME_xxx</code> for rewrite conditions. In conjunction with the special lexicographic comparison patterns <code>&lt;STRING</code>, <code>&gt;STRING</code> and <code>=STRING</code> we can do time-dependent redirects:</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteCond   \"%{TIME_HOUR}%{TIME_MIN}\" \"&gt;0700\"\nRewriteCond   \"%{TIME_HOUR}%{TIME_MIN}\" \"&lt;1900\"\nRewriteRule   \"^foo\\.html$\"             \"foo.day.html\" [L]\nRewriteRule   \"^foo\\.html$\"             \"foo.night.html\"</pre> <p>This provides the content of <code>foo.day.html</code> under the URL <code>foo.html</code> from <code>07:01-18:59</code> and at the remaining time the contents of <code>foo.night.html</code>.</p> <div class=\"warning\">\n<code class=\"module\"><a href=\"../mod/mod_cache\">mod_cache</a></code>, intermediate proxies and browsers may each cache responses and cause the either page to be shown outside of the time-window configured. <code class=\"module\"><a href=\"../mod/mod_expires\">mod_expires</a></code> may be used to control this effect. You are, of course, much better off simply serving the content dynamically, and customizing it based on the time of day.</div> </dd> </dl>   <h2 id=\"setenvvars\">Set Environment Variables Based On URL Parts</h2> <dl> <dt>Description:</dt> <dd> <p>At time, we want to maintain some kind of status when we perform a rewrite. For example, you want to make a note that you've done that rewrite, so that you can check later to see if a request can via that rewrite. One way to do this is by setting an environment variable.</p> </dd> <dt>Solution:</dt> <dd> <p>Use the [E] flag to set an environment variable.</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteRule   \"^/horse/(.*)\"   \"/pony/$1\" [E=<strong>rewritten:1</strong>]</pre> <p>Later in your ruleset you might check for this environment variable using a RewriteCond:</p> <pre class=\"prettyprint lang-config\">RewriteCond \"%{ENV:rewritten}\" \"=1\"</pre> <p>Note that environment variables do not survive an external redirect. You might consider using the [CO] flag to set a cookie.</p> </dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/advanced.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/advanced.html</a>\n  </p>\n</div>\n","rewrite/avoid":"<h1>When not to use mod_rewrite</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It describes perhaps one of the most important concepts about <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> - namely, when to avoid using it.</p> <p><code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> should be considered a last resort, when other alternatives are found wanting. Using it when there are simpler alternatives leads to configurations which are confusing, fragile, and hard to maintain. Understanding what other alternatives are available is a very important step towards <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> mastery.</p> <p>Note that many of these examples won't work unchanged in your particular server configuration, so it's important that you understand them, rather than merely cutting and pasting the examples into your configuration.</p> <p>The most common situation in which <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> is the right tool is when the very best solution requires access to the server configuration files, and you don't have that access. Some configuration directives are only available in the server configuration file. So if you are in a hosting situation where you only have .htaccess files to work with, you may need to resort to <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>.</p>     <h2 id=\"redirect\">Simple Redirection</h2> <p><code class=\"module\"><a href=\"../mod/mod_alias\">mod_alias</a></code> provides the <code class=\"directive\"><a href=\"../mod/mod_alias#redirect\">Redirect</a></code> and <code class=\"directive\"><a href=\"../mod/mod_alias#redirectmatch\">RedirectMatch</a></code> directives, which provide a means to redirect one URL to another. This kind of simple redirection of one URL, or a class of URLs, to somewhere else, should be accomplished using these directives rather than <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code>. <code>RedirectMatch</code> allows you to include a regular expression in your redirection criteria, providing many of the benefits of using <code>RewriteRule</code>.</p> <p>A common use for <code>RewriteRule</code> is to redirect an entire class of URLs. For example, all URLs in the <code>/one</code> directory must be redirected to <code>http://one.example.com/</code>, or perhaps all <code>http</code> requests must be redirected to <code>https</code>.</p> <p>These situations are better handled by the <code>Redirect</code> directive. Remember that <code>Redirect</code> preserves path information. That is to say, a redirect for a URL <code>/one</code> will also redirect all URLs under that, such as <code>/one/two.html</code> and <code>/one/three/four.html</code>.</p> <p>To redirect URLs under <code>/one</code> to <code>http://one.example.com</code>, do the following:</p> <pre class=\"prettyprint lang-config\">Redirect \"/one/\" \"http://one.example.com/\"</pre> <p>To redirect one hostname to another, for example <code>example.com</code> to <code>www.example.com</code>, see the <a href=\"remapping#canonicalhost\">Canonical Hostnames</a> recipe.</p> <p>To redirect <code>http</code> URLs to <code>https</code>, do the following:</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost *:80&gt;\n    ServerName www.example.com\n    Redirect \"/\" \"https://www.example.com/\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:443&gt;\n    ServerName www.example.com\n    # ... SSL configuration goes here\n&lt;/VirtualHost&gt;</pre> <p>The use of <code>RewriteRule</code> to perform this task may be appropriate if there are other <code>RewriteRule</code> directives in the same scope. This is because, when there are <code>Redirect</code> and <code>RewriteRule</code> directives in the same scope, the <code>RewriteRule</code> directives will run first, regardless of the order of appearance in the configuration file.</p> <p>In the case of the <em>http-to-https</em> redirection, the use of <code>RewriteRule</code> would be appropriate if you don't have access to the main server configuration file, and are obliged to perform this task in a <code>.htaccess</code> file instead.</p>   <h2 id=\"alias\">URL Aliasing</h2> <p>The <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code> directive provides mapping from a URI to a directory - usually a directory outside of your <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code>. Although it is possible to perform this mapping with <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>, <code class=\"directive\"><a href=\"../mod/mod_alias#alias\">Alias</a></code> is the preferred method, for reasons of simplicity and performance.</p> <div class=\"example\">\n<h3>Using Alias</h3>\n<pre class=\"prettyprint lang-config\">Alias \"/cats\" \"/var/www/virtualhosts/felines/htdocs\"</pre> </div> <p> The use of <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> to perform this mapping may be appropriate when you do not have access to the server configuration files. Alias may only be used in server or virtualhost context, and not in a <code>.htaccess</code> file. </p> <p>Symbolic links would be another way to accomplish the same thing, if you have <code>Options FollowSymLinks</code> enabled on your server.</p>   <h2 id=\"vhosts\">Virtual Hosting</h2> <p>Although it is possible to handle <a href=\"vhosts\">virtual hosts with mod_rewrite</a>, it is seldom the right way. Creating individual <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> blocks is almost always the right way to go. In the event that you have an enormous number of virtual hosts, consider using <code class=\"module\"><a href=\"../mod/mod_vhost_alias\">mod_vhost_alias</a></code> to create these hosts automatically.</p> <p>Modules such as <code class=\"module\"><a href=\"../mod/mod_macro\">mod_macro</a></code> are also useful for creating a large number of virtual hosts dynamically.</p> <p>Using <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> for vitualhost creation may be appropriate if you are using a hosting service that does not provide you access to the server configuration files, and you are therefore restricted to configuration using <code>.htaccess</code> files.</p> <p>See the <a href=\"vhosts\">virtual hosts with mod_rewrite</a> document for more details on how you might accomplish this if it still seems like the right approach.</p>   <h2 id=\"proxy\">Simple Proxying</h2> <p><code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> provides the <a href=\"flags#flag_p\">[P]</a> flag to pass rewritten URIs through <code class=\"module\"><a href=\"../mod/mod_proxy\">mod_proxy</a></code>.</p> <pre class=\"prettyprint lang-config\">RewriteRule \"^/?images(.*)\" \"http://imageserver.local/images$1\" [P]</pre> <p>However, in many cases, when there is no actual pattern matching needed, as in the example shown above, the <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code> directive is a better choice. The example here could be rendered as:</p> <pre class=\"prettyprint lang-config\">ProxyPass \"/images/\" \"http://imageserver.local/images/\"</pre> <p>Note that whether you use <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> or <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypass\">ProxyPass</a></code>, you'll still need to use the <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypassreverse\">ProxyPassReverse</a></code> directive to catch redirects issued from the back-end server:</p> <pre class=\"prettyprint lang-config\">ProxyPassReverse \"/images/\" \"http://imageserver.local/images/\"</pre> <p>You may need to use <code>RewriteRule</code> instead when there are other <code>RewriteRule</code>s in effect in the same scope, as a <code>RewriteRule</code> will usually take effect before a <code>ProxyPass</code>, and so may preempt what you're trying to accomplish.</p>   <h2 id=\"setenv\">Environment Variable Testing</h2> <p><code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> is frequently used to take a particular action based on the presence or absence of a particular environment variable or request header. This can be done more efficiently using the <code class=\"directive\"><a href=\"../mod/core#if\">&lt;If&gt;</a></code>.</p> <p>Consider, for example, the common scenario where <code class=\"directive\">RewriteRule</code> is used to enforce a canonical hostname, such as <code>www.example.com</code> instead of <code>example.com</code>. This can be done using the <code class=\"directive\"><a href=\"../mod/core#if\">&lt;If&gt;</a></code> directive, as shown here:</p> <pre class=\"prettyprint lang-config\">&lt;If \"req('Host') != 'www.example.com'\"&gt;\n    Redirect \"/\" \"http://www.example.com/\"\n&lt;/If&gt;</pre> <p>This technique can be used to take actions based on any request header, response header, or environment variable, replacing <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> in many common scenarios.</p> <p>See especially the <a href=\"../expr\">expression evaluation documentation</a> for a overview of what types of expressions you can use in <code class=\"directive\"><a href=\"../mod/core#if\">&lt;If&gt;</a></code> sections, and in certain other directives.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/avoid.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/avoid.html</a>\n  </p>\n</div>\n","rewrite/tech":"<h1>Apache mod_rewrite Technical Details</h1>  <p>This document discusses some of the technical details of mod_rewrite and URL matching.</p>     <h2 id=\"InternalAPI\">API Phases</h2> <p>The Apache HTTP Server handles requests in several phases. At each of these phases, one or more modules may be called upon to handle that portion of the request lifecycle. Phases include things like URL-to-filename translation, authentication, authorization, content, and logging. (This is not an exhaustive list.)</p> <p>mod_rewrite acts in two of these phases (or \"hooks\", as they are often called) to influence how URLs may be rewritten.</p> <p>First, it uses the URL-to-filename translation hook, which occurs after the HTTP request has been read, but before any authorization starts. Secondly, it uses the Fixup hook, which is after the authorization phases, and after per-directory configuration files (<code>.htaccess</code> files) have been read, but before the content handler is called.</p> <p>So, after a request comes in and a corresponding server or virtual host has been determined, the rewriting engine starts processing any <code>mod_rewrite</code> directives appearing in the per-server configuration. (i.e., in the main server configuration file and <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;Virtualhost&gt;</a></code> sections.) This happens in the URL-to-filename phase.</p> <p>A few steps later, once the final data directories have been found, the per-directory configuration directives (<code>.htaccess</code> files and <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> blocks) are applied. This happens in the Fixup phase.</p> <p>In each of these cases, mod_rewrite rewrites the <code>REQUEST_URI</code> either to a new URL, or to a filename.</p> <p>In per-directory context (i.e., within <code>.htaccess</code> files and <code>Directory</code> blocks), these rules are being applied after a URL has already been translated to a filename. Because of this, the URL-path that mod_rewrite initially compares <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> directives against is the full filesystem path to the translated filename with the current directories path (including a trailing slash) removed from the front.</p> <p> To illustrate: If rules are in /var/www/foo/.htaccess and a request for /foo/bar/baz is being processed, an expression like ^bar/baz$ would match.</p> <p> If a substitution is made in per-directory context, a new internal subrequest is issued with the new URL, which restarts processing of the request phases. If the substitution is a relative path, the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritebase\">RewriteBase</a></code> directive determines the URL-path prefix prepended to the substitution. In per-directory context, care must be taken to create rules which will eventually (in some future \"round\" of per-directory rewrite processing) not perform a substitution to avoid looping. (See <a href=\"http://wiki.apache.org/httpd/RewriteLooping\">RewriteLooping</a> for further discussion of this problem.)</p> <p>Because of this further manipulation of the URL in per-directory context, you'll need to take care to craft your rewrite rules differently in that context. In particular, remember that the leading directory path will be stripped off of the URL that your rewrite rules will see. Consider the examples below for further clarification.</p> <table class=\"bordered\"> <tr> <th>Location of rule</th> <th>Rule</th> </tr> <tr> <td>VirtualHost section</td> <td>RewriteRule \"^/images/(.+)\\.jpg\" \"/images/$1.gif\"</td> </tr> <tr> <td>.htaccess file in document root</td> <td>RewriteRule \"^images/(.+)\\.jpg\" \"images/$1.gif\"</td> </tr> <tr> <td>.htaccess file in images directory</td> <td>RewriteRule \"^(.+)\\.jpg\" \"$1.gif\"</td> </tr> </table> <p>For even more insight into how mod_rewrite manipulates URLs in different contexts, you should consult the <a href=\"../mod/mod_rewrite#logging\">log entries</a> made during rewriting.</p>   <h2 id=\"InternalRuleset\">Ruleset Processing</h2> <p>Now when mod_rewrite is triggered in these two API phases, it reads the configured rulesets from its configuration structure (which itself was either created on startup for per-server context or during the directory walk of the Apache kernel for per-directory context). Then the URL rewriting engine is started with the contained ruleset (one or more rules together with their conditions). The operation of the URL rewriting engine itself is exactly the same for both configuration contexts. Only the final result processing is different.</p> <p>The order of rules in the ruleset is important because the rewriting engine processes them in a special (and not very obvious) order. The rule is this: The rewriting engine loops through the ruleset rule by rule (<code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> directives) and when a particular rule matches it optionally loops through existing corresponding conditions (<code>RewriteCond</code> directives). For historical reasons the conditions are given first, and so the control flow is a little bit long-winded. See Figure 1 for more details.</p> <p class=\"figure\"> <img src=\"https://httpd.apache.org/docs/2.4/en/images/rewrite_process_uri.png\" alt=\"Flow of RewriteRule and RewriteCond matching\"><br> <dfn>Figure 1:</dfn>The control flow through the rewriting ruleset </p> <p>First the URL is matched against the <em>Pattern</em> of each rule. If it fails, mod_rewrite immediately stops processing this rule, and continues with the next rule. If the <em>Pattern</em> matches, mod_rewrite looks for corresponding rule conditions (RewriteCond directives, appearing immediately above the RewriteRule in the configuration). If none are present, it substitutes the URL with a new value, which is constructed from the string <em>Substitution</em>, and goes on with its rule-looping. But if conditions exist, it starts an inner loop for processing them in the order that they are listed. For conditions, the logic is different: we don't match a pattern against the current URL. Instead we first create a string <em>TestString</em> by expanding variables, back-references, map lookups, <em>etc.</em> and then we try to match <em>CondPattern</em> against it. If the pattern doesn't match, the complete set of conditions and the corresponding rule fails. If the pattern matches, then the next condition is processed until no more conditions are available. If all conditions match, processing is continued with the substitution of the URL with <em>Substitution</em>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/tech.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/tech.html</a>\n  </p>\n</div>\n","vhosts/ip-based":"<h1>Apache IP-based Virtual Host Support</h1>      <h2 id=\"explanation\">What is IP-based virtual hosting</h2> <p>IP-based virtual hosting is a method to apply different directives based on the IP address and port a request is received on. Most commonly, this is used to serve different websites on different ports or interfaces.</p> <p>In many cases, <a href=\"name-based\">name-based virtual hosts</a> are more convenient, because they allow many virtual hosts to share a single address/port. See <a href=\"name-based#namevip\">Name-based vs. IP-based Virtual Hosts</a> to help you decide. </p>   <h2 id=\"requirements\">System requirements</h2> <p>As the term <cite>IP-based</cite> indicates, the server <strong>must have a different IP address/port combination for each IP-based virtual host</strong>. This can be achieved by the machine having several physical network connections, or by use of virtual interfaces which are supported by most modern operating systems (see system documentation for details, these are frequently called \"ip aliases\", and the \"ifconfig\" command is most commonly used to set them up), and/or using multiple port numbers.</p> <p> In the terminology of Apache HTTP Server, using a single IP address but multiple TCP ports, is also IP-based virtual hosting.</p>   <h2 id=\"howto\">How to set up Apache</h2> <p>There are two ways of configuring apache to support multiple hosts. Either by running a separate <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> daemon for each hostname, or by running a single daemon which supports all the virtual hosts.</p> <p>Use multiple daemons when:</p> <ul> <li>There are security partitioning issues, such as company1 does not want anyone at company2 to be able to read their data except via the web. In this case you would need two daemons, each running with different <code class=\"directive\"><a href=\"../mod/mod_unixd#user\">User</a></code>, <code class=\"directive\"><a href=\"../mod/mod_unixd#group\">Group</a></code>, <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code>, and <code class=\"directive\"><a href=\"../mod/core#serverroot\">ServerRoot</a></code> settings.</li> <li>You can afford the memory and file descriptor requirements of listening to every IP alias on the machine. It's only possible to <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> to the \"wildcard\" address, or to specific addresses. So if you have a need to listen to a specific address for whatever reason, then you will need to listen to all specific addresses. (Although one <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> could listen to N-1 of the addresses, and another could listen to the remaining address.)</li> </ul> <p>Use a single daemon when:</p> <ul> <li>Sharing of the httpd configuration between virtual hosts is acceptable.</li> <li>The machine services a large number of requests, and so the performance loss in running separate daemons may be significant.</li> </ul>   <h2 id=\"multiple\">Setting up multiple daemons</h2> <p>Create a separate <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> installation for each virtual host. For each installation, use the <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> directive in the configuration file to select which IP address (or virtual host) that daemon services. e.g.</p> <pre class=\"prettyprint lang-config\">Listen 192.0.2.100:80</pre> <p>It is recommended that you use an IP address instead of a hostname (see <a href=\"../dns-caveats\">DNS caveats</a>).</p>   <h2 id=\"single\">Setting up a single daemon with virtual hosts</h2> <p>For this case, a single <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> will service requests for the main server and all the virtual hosts. The <code class=\"directive\"><a href=\"../mod/core#virtualhost\">VirtualHost</a></code> directive in the configuration file is used to set the values of <code class=\"directive\"><a href=\"../mod/core#serveradmin\">ServerAdmin</a></code>, <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code>, <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code>, <code class=\"directive\"><a href=\"../mod/core#errorlog\">ErrorLog</a></code> and <code class=\"directive\"><a href=\"../mod/mod_log_config#transferlog\">TransferLog</a></code> or <code class=\"directive\"><a href=\"../mod/mod_log_config#customlog\">CustomLog</a></code> configuration directives to different values for each virtual host. e.g.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost 172.20.30.40:80&gt;\n    ServerAdmin webmaster@www1.example.com\n    DocumentRoot \"/www/vhosts/www1\"\n    ServerName www1.example.com\n    ErrorLog \"/www/logs/www1/error_log\"\n    CustomLog \"/www/logs/www1/access_log\" combined\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.50:80&gt;\n    ServerAdmin webmaster@www2.example.org\n    DocumentRoot \"/www/vhosts/www2\"\n    ServerName www2.example.org\n    ErrorLog \"/www/logs/www2/error_log\"\n    CustomLog \"/www/logs/www2/access_log\" combined\n&lt;/VirtualHost&gt;</pre> <p>It is recommended that you use an IP address instead of a hostname in the &lt;VirtualHost&gt; directive (see <a href=\"../dns-caveats\">DNS caveats</a>).</p> <p> Specific IP addresses or ports have precedence over their wildcard equivalents, and any virtual host that matches has precedence over the servers base configuration.</p> <p>Almost <strong>any</strong> configuration directive can be put in the VirtualHost directive, with the exception of directives that control process creation and a few other directives. To find out if a directive can be used in the VirtualHost directive, check the Context using the <a href=\"https://httpd.apache.org/docs/2.4/en/mod/directives.html\">directive index</a>.</p> <p><code class=\"directive\"><a href=\"../mod/mod_suexec#suexecusergroup\">SuexecUserGroup</a></code> may be used inside a VirtualHost directive if the <a href=\"../suexec\">suEXEC wrapper</a> is used.</p> <p><em>SECURITY:</em> When specifying where to write log files, be aware of some security risks which are present if anyone other than the user that starts Apache has write access to the directory where they are written. See the <a href=\"../misc/security_tips\">security tips</a> document for details.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/vhosts/ip-based.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/vhosts/ip-based.html</a>\n  </p>\n</div>\n","misc/password_encryptions":"<h1>Password Formats</h1>  <p>Notes about the password encryption formats generated and understood by Apache.</p>     <h2 id=\"basic\">Basic Authentication</h2> <p>There are five formats that Apache recognizes for basic-authentication passwords. Note that not all formats work on every platform:</p> <dl> <dt>bcrypt</dt> <dd>\"$2y$\" + the result of the crypt_blowfish algorithm. See the APR source file <a href=\"http://svn.apache.org/viewvc/apr/apr/trunk/crypto/crypt_blowfish.c?view=markup\">crypt_blowfish.c</a> for the details of the algorithm.</dd> <dt>MD5</dt> <dd>\"$apr1$\" + the result of an Apache-specific algorithm using an iterated (1,000 times) MD5 digest of various combinations of a random 32-bit salt and the password. See the APR source file <a href=\"http://svn.apache.org/viewvc/apr/apr/trunk/crypto/apr_md5.c?view=markup\">apr_md5.c</a> for the details of the algorithm.</dd> <dt>SHA1</dt> <dd>\"{SHA}\" + Base64-encoded SHA-1 digest of the password. Insecure.</dd> <dt>CRYPT</dt> <dd>Unix only. Uses the traditional Unix <code>crypt(3)</code> function with a randomly-generated 32-bit salt (only 12 bits used) and the first 8 characters of the password. Insecure.</dd> <dt>PLAIN TEXT (i.e. <em>unencrypted</em>)</dt> <dd>Windows &amp; Netware only. Insecure.</dd> </dl> <h3>Generating values with htpasswd</h3> <div class=\"example\">\n<h3>bcrypt</h3>\n<pre>$ htpasswd -nbB myName myPassword\nmyName:$2y$05$c4WoMPo3SXsafkva.HHa6uXQZWr7oboPiC2bT/r7q1BB8I2s0BRqC</pre>\n</div> <div class=\"example\">\n<h3>MD5</h3>\n<pre>$ htpasswd -nbm myName myPassword\nmyName:$apr1$r31.....$HqJZimcKQFAMYayBlzkrA/</pre>\n</div> <div class=\"example\">\n<h3>SHA1</h3>\n<pre>$ htpasswd -nbs myName myPassword\nmyName:{SHA}VBPuJHI7uixaa6LQGWx4s+5GKNE=</pre>\n</div> <div class=\"example\">\n<h3>CRYPT</h3>\n<pre>$ htpasswd -nbd myName myPassword\nmyName:rqXexS6ZhobKA</pre>\n</div> <h3>Generating CRYPT and MD5 values with the OpenSSL command-line program</h3> <p>OpenSSL knows the Apache-specific MD5 algorithm.</p> <div class=\"example\">\n<h3>MD5</h3>\n<pre>$ openssl passwd -apr1 myPassword\n$apr1$qHDFfhPC$nITSVHgYbDAK1Y0acGRnY0</pre>\n</div> <div class=\"example\">\n<h3>CRYPT</h3>\n<pre>openssl passwd -crypt myPassword\nqQ5vTYO3c8dsU</pre>\n</div> <h3>Validating CRYPT or MD5 passwords with the OpenSSL command line program</h3> <p>The salt for a CRYPT password is the first two characters (converted to a binary value). To validate <code>myPassword</code> against <code>rqXexS6ZhobKA</code></p> <div class=\"example\">\n<h3>CRYPT</h3>\n<pre>$ openssl passwd -crypt -salt rq myPassword\nWarning: truncating password to 8 characters\nrqXexS6ZhobKA</pre>\n</div> <p>Note that using <code>myPasswo</code> instead of <code>myPassword</code> will produce the same result because only the first 8 characters of CRYPT passwords are considered.</p> <p>The salt for an MD5 password is between <code>$apr1$</code> and the following <code>$</code> (as a Base64-encoded binary value - max 8 chars). To validate <code>myPassword</code> against <code>$apr1$r31.....$HqJZimcKQFAMYayBlzkrA/</code></p> <div class=\"example\">\n<h3>MD5</h3>\n<pre>$ openssl passwd -apr1 -salt r31..... myPassword\n$apr1$r31.....$HqJZimcKQFAMYayBlzkrA/</pre>\n</div> <h3>Database password fields for mod_dbd</h3> <p>The SHA1 variant is probably the most useful format for DBD authentication. Since the SHA1 and Base64 functions are commonly available, other software can populate a database with encrypted passwords that are usable by Apache basic authentication.</p> <p>To create Apache SHA1-variant basic-authentication passwords in various languages:</p> <div class=\"example\">\n<h3>PHP</h3>\n<pre>'{SHA}' . base64_encode(sha1($password, TRUE))</pre>\n</div> <div class=\"example\">\n<h3>Java</h3>\n<pre>\"{SHA}\" + new sun.misc.BASE64Encoder().encode(java.security.MessageDigest.getInstance(\"SHA1\").digest(password.getBytes()))</pre>\n</div> <div class=\"example\">\n<h3>ColdFusion</h3>\n<pre>\"{SHA}\" &amp; ToBase64(BinaryDecode(Hash(password, \"SHA1\"), \"Hex\"))</pre>\n</div> <div class=\"example\">\n<h3>Ruby</h3>\n<pre>require 'digest/sha1'\nrequire 'base64'\n'{SHA}' + Base64.encode64(Digest::SHA1.digest(password))</pre>\n</div> <div class=\"example\">\n<h3>C or C++</h3>\n<pre>Use the APR function: apr_sha1_base64</pre>\n</div> <div class=\"example\">\n<h3>Python</h3>\n<pre>import base64\nimport hashlib\n\"{SHA}\" + format(base64.b64encode(hashlib.sha1(password).digest()))</pre>\n</div> <div class=\"example\">\n<h3>PostgreSQL (with the contrib/pgcrypto functions installed)</h3>\n<code>'{SHA}'||encode(digest(password,'sha1'),'base64')</code>\n</div>   <h2 id=\"digest\">Digest Authentication</h2> <p>Apache recognizes one format for digest-authentication passwords - the MD5 hash of the string <code>user:realm:password</code> as a 32-character string of hexadecimal digits. <code>realm</code> is the Authorization Realm argument to the <code class=\"directive\"><a href=\"../mod/mod_authn_core#authname\">AuthName</a></code> directive in httpd.conf.</p> <h3>Database password fields for mod_dbd</h3> <p>Since the MD5 function is commonly available, other software can populate a database with encrypted passwords that are usable by Apache digest authentication.</p> <p>To create Apache digest-authentication passwords in various languages:</p> <div class=\"example\">\n<h3>PHP</h3>\n<pre>md5($user . ':' . $realm . ':' .$password)</pre>\n</div> <div class=\"example\">\n<h3>Java</h3>\n<pre>byte b[] = java.security.MessageDigest.getInstance(\"MD5\").digest( (user + \":\" + realm + \":\" + password ).getBytes());\njava.math.BigInteger bi = new java.math.BigInteger(1, b);\nString s = bi.toString(16);\nwhile (s.length() &lt; 32)\n s = \"0\" + s;  // String s is the encrypted password</pre>\n</div> <div class=\"example\">\n<h3>ColdFusion</h3>\n<pre>LCase(Hash( (user &amp; \":\" &amp; realm &amp; \":\" &amp; password) , \"MD5\"))</pre>\n</div> <div class=\"example\">\n<h3>Ruby</h3>\n<pre>require 'digest/md5'\nDigest::MD5.hexdigest(user + ':' + realm + ':' + password)</pre>\n</div> <div class=\"example\">\n<h3>PostgreSQL (with the contrib/pgcrypto functions installed)</h3>\n<pre>encode(digest( user || ':' || realm || ':' || password , 'md5'), 'hex')</pre>\n</div><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/misc/password_encryptions.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/misc/password_encryptions.html</a>\n  </p>\n</div>\n","ssl/ssl_faq":"<h1>SSL/TLS Strong Encryption: FAQ</h1>  <blockquote> <p>The wise man doesn't give the right answers, he poses the right questions.</p> <p class=\"cite\">-- <cite>Claude Levi-Strauss</cite></p> </blockquote>     <h2 id=\"installation\">Installation</h2> <ul> <li><a href=\"#mutex\">Why do I get permission errors related to SSLMutex when I start Apache?</a></li> <li><a href=\"#entropy\">Why does mod_ssl stop with the error \"Failed to generate temporary 512 bit RSA private key\" when I start Apache?</a></li> </ul> <h3><a name=\"mutex\" id=\"mutex\">Why do I get permission errors related to SSLMutex when I start Apache?</a></h3> <p>Errors such as ``<code>mod_ssl: Child could not open SSLMutex lockfile /opt/apache/logs/ssl_mutex.18332 (System error follows) [...] System: Permission denied (errno: 13)</code>'' are usually caused by overly restrictive permissions on the <em>parent</em> directories. Make sure that all parent directories (here <code>/opt</code>, <code>/opt/apache</code> and <code>/opt/apache/logs</code>) have the x-bit set for, at minimum, the UID under which Apache's children are running (see the <code class=\"directive\"><a href=\"../mod/mod_unixd#user\">User</a></code> directive).</p> <h3><a name=\"entropy\" id=\"entropy\">Why does mod_ssl stop with the error \"Failed to generate temporary 512 bit RSA private key\" when I start Apache?</a></h3> <p>Cryptographic software needs a source of unpredictable data to work correctly. Many open source operating systems provide a \"randomness device\" that serves this purpose (usually named <code>/dev/random</code>). On other systems, applications have to seed the OpenSSL Pseudo Random Number Generator (PRNG) manually with appropriate data before generating keys or performing public key encryption. As of version 0.9.5, the OpenSSL functions that need randomness report an error if the PRNG has not been seeded with at least 128 bits of randomness.</p> <p>To prevent this error, <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> has to provide enough entropy to the PRNG to allow it to work correctly. This can be done via the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslrandomseed\">SSLRandomSeed</a></code> directive.</p>   <h2 id=\"aboutconfig\">Configuration</h2> <ul> <li><a href=\"#parallel\">Is it possible to provide HTTP and HTTPS from the same server?</a></li> <li><a href=\"#ports\">Which port does HTTPS use?</a></li> <li><a href=\"#httpstest\">How do I speak HTTPS manually for testing purposes?</a></li> <li><a href=\"#hang\">Why does the connection hang when I connect to my SSL-aware Apache server?</a></li> <li><a href=\"#refused\">Why do I get ``Connection Refused'' errors, when trying to access my newly installed Apache+mod_ssl server via HTTPS?</a></li> <li><a href=\"#envvars\">Why are the <code>SSL_XXX</code> variables not available to my CGI &amp; SSI scripts?</a></li> <li><a href=\"#relative\">How can I switch between HTTP and HTTPS in relative hyperlinks?</a></li> </ul> <h3><a name=\"parallel\" id=\"parallel\">Is it possible to provide HTTP and HTTPS from the same server?</a></h3> <p>Yes. HTTP and HTTPS use different server ports (HTTP binds to port 80, HTTPS to port 443), so there is no direct conflict between them. You can either run two separate server instances bound to these ports, or use Apache's elegant virtual hosting facility to create two virtual servers, both served by the same instance of Apache - one responding over HTTP to requests on port 80, and the other responding over HTTPS to requests on port 443.</p> <h3><a name=\"ports\" id=\"ports\">Which port does HTTPS use?</a></h3> <p>You can run HTTPS on any port, but the standards specify port 443, which is where any HTTPS compliant browser will look by default. You can force your browser to look on a different port by specifying it in the URL. For example, if your server is set up to serve pages over HTTPS on port 8080, you can access them at <code>https://example.com:8080/</code></p> <h3><a name=\"httpstest\" id=\"httpstest\">How do I speak HTTPS manually for testing purposes?</a></h3> <p>While you usually just use</p> <div class=\"example\"><pre>$ telnet localhost 80\nGET / HTTP/1.0</pre></div> <p>for simple testing of Apache via HTTP, it's not so easy for HTTPS because of the SSL protocol between TCP and HTTP. With the help of OpenSSL's <code>s_client</code> command, however, you can do a similar check via HTTPS:</p> <div class=\"example\"><pre>$ openssl s_client -connect localhost:443 -state -debug\nGET / HTTP/1.0</pre></div> <p>Before the actual HTTP response you will receive detailed information about the SSL handshake. For a more general command line client which directly understands both HTTP and HTTPS, can perform GET and POST operations, can use a proxy, supports byte ranges, etc. you should have a look at the nifty <a href=\"http://curl.haxx.se/\">cURL</a> tool. Using this, you can check that Apache is responding correctly to requests via HTTP and HTTPS as follows:</p> <div class=\"example\"><pre>$ curl http://localhost/\n$ curl https://localhost/</pre></div> <h3><a name=\"hang\" id=\"hang\">Why does the connection hang when I connect to my SSL-aware Apache server?</a></h3> <p>This can happen when you try to connect to a HTTPS server (or virtual server) via HTTP (eg, using <code>http://example.com/</code> instead of <code>https://example.com</code>). It can also happen when trying to connect via HTTPS to a HTTP server (eg, using <code>https://example.com/</code> on a server which doesn't support HTTPS, or which supports it on a non-standard port). Make sure that you're connecting to a (virtual) server that supports SSL.</p> <h3><a name=\"refused\" id=\"refused\">Why do I get ``Connection Refused'' messages, when trying to access my newly installed Apache+mod_ssl server via HTTPS?</a></h3> <p> This error can be caused by an incorrect configuration. Please make sure that your <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> directives match your <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> directives. If all else fails, please start afresh, using the default configuration provided by <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code>.</p> <h3><a name=\"envvars\" id=\"envvars\">Why are the <code>SSL_XXX</code> variables not available to my CGI &amp; SSI scripts?</a></h3> <p>Please make sure you have ``<code>SSLOptions +StdEnvVars</code>'' enabled for the context of your CGI/SSI requests.</p> <h3><a name=\"relative\" id=\"relative\">How can I switch between HTTP and HTTPS in relative hyperlinks?</a></h3> <p>Usually, to switch between HTTP and HTTPS, you have to use fully-qualified hyperlinks (because you have to change the URL scheme). Using <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> however, you can manipulate relative hyperlinks, to achieve the same effect.</p> <pre class=\"prettyprint lang-config\">RewriteEngine on\nRewriteRule   \"^/(.*)_SSL$\"   \"https://%{SERVER_NAME}/$1\" [R,L]\nRewriteRule   \"^/(.*)_NOSSL$\" \"http://%{SERVER_NAME}/$1\"  [R,L]</pre> <p>This rewrite ruleset lets you use hyperlinks of the form <code>&lt;a href=\"document.html_SSL\"&gt;</code>, to switch to HTTPS in a relative link. (Replace SSL with NOSSL to switch to HTTP.)</p>   <h2 id=\"aboutcerts\">Certificates</h2> <ul> <li><a href=\"#keyscerts\">What are RSA Private Keys, CSRs and Certificates?</a></li> <li><a href=\"#startup\">Is there a difference on startup between a non-SSL-aware Apache and an SSL-aware Apache?</a></li> <li><a href=\"#selfcert\">How do I create a self-signed SSL Certificate for testing purposes?</a></li> <li><a href=\"#realcert\">How do I create a real SSL Certificate?</a></li> <li><a href=\"#ownca\">How do I create and use my own Certificate Authority (CA)?</a></li> <li><a href=\"#passphrase\">How can I change the pass-phrase on my private key file?</a></li> <li><a href=\"#removepassphrase\">How can I get rid of the pass-phrase dialog at Apache startup time?</a></li> <li><a href=\"#verify\">How do I verify that a private key matches its Certificate?</a></li> <li><a href=\"#pemder\">How can I convert a certificate from PEM to DER format?</a></li> <li><a href=\"#gid\">Why do browsers complain that they cannot verify my server certificate?</a></li> </ul> <h3><a name=\"keyscerts\" id=\"keyscerts\">What are RSA Private Keys, CSRs and Certificates?</a></h3> <p>An RSA private key file is a digital file that you can use to decrypt messages sent to you. It has a public component which you distribute (via your Certificate file) which allows people to encrypt those messages to you.</p> <p>A Certificate Signing Request (CSR) is a digital file which contains your public key and your name. You send the CSR to a Certifying Authority (CA), who will convert it into a real Certificate, by signing it.</p> <p>A Certificate contains your RSA public key, your name, the name of the CA, and is digitally signed by the CA. Browsers that know the CA can verify the signature on that Certificate, thereby obtaining your RSA public key. That enables them to send messages which only you can decrypt.</p> <p>See the <a href=\"ssl_intro\">Introduction</a> chapter for a general description of the SSL protocol.</p> <h3><a name=\"startup\" id=\"startup\">Is there a difference on startup between a non-SSL-aware Apache and an SSL-aware Apache?</a></h3> <p>Yes. In general, starting Apache with <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> built-in is just like starting Apache without it. However, if you have a passphrase on your SSL private key file, a startup dialog will pop up which asks you to enter the pass phrase.</p> <p>Having to manually enter the passphrase when starting the server can be problematic - for example, when starting the server from the system boot scripts. In this case, you can follow the steps <a href=\"#removepassphrase\">below</a> to remove the passphrase from your private key. Bear in mind that doing so brings additional security risks - proceed with caution!</p> <h3><a name=\"selfcert\" id=\"selfcert\">How do I create a self-signed SSL Certificate for testing purposes?</a></h3> <ol> <li>Make sure OpenSSL is installed and in your <code>PATH</code>.<br> <br> </li> <li>Run the following command, to create <code>server.key</code> and <code>server.crt</code> files:<br> <code>$ openssl req -new -x509 -nodes -out server.crt -keyout server.key</code><br> These can be used as follows in your <code>httpd.conf</code> file: <pre class=\"prettyprint lang-config\">SSLCertificateFile    \"/path/to/this/server.crt\"\nSSLCertificateKeyFile \"/path/to/this/server.key\"</pre> </li> <li>It is important that you are aware that this <code>server.key</code> does <em>not</em> have any passphrase. To add a passphrase to the key, you should run the following command, and enter &amp; verify the passphrase as requested.<br> <p><code>$ openssl rsa -des3 -in server.key -out server.key.new</code><br> <code>$ mv server.key.new server.key</code><br></p> Please backup the <code>server.key</code> file, and the passphrase you entered, in a secure location. </li> </ol> <h3><a name=\"realcert\" id=\"realcert\">How do I create a real SSL Certificate?</a></h3> <p>Here is a step-by-step description:</p> <ol> <li>Make sure OpenSSL is installed and in your <code>PATH</code>. <br> <br> </li> <li>Create a RSA private key for your Apache server (will be Triple-DES encrypted and PEM formatted):<br> <br> <code>$ openssl genrsa -des3 -out server.key 2048</code><br> <br> Please backup this <code>server.key</code> file and the pass-phrase you entered in a secure location. You can see the details of this RSA private key by using the command:<br> <br> <code>$ openssl rsa -noout -text -in server.key</code><br> <br> If necessary, you can also create a decrypted PEM version (not recommended) of this RSA private key with:<br> <br> <code>$ openssl rsa -in server.key -out server.key.unsecure</code><br> <br> </li> <li>Create a Certificate Signing Request (CSR) with the server RSA private key (output will be PEM formatted):<br> <br> <code>$ openssl req -new -key server.key -out server.csr</code><br> <br> Make sure you enter the FQDN (\"Fully Qualified Domain Name\") of the server when OpenSSL prompts you for the \"CommonName\", i.e. when you generate a CSR for a website which will be later accessed via <code>https://www.foo.dom/</code>, enter \"www.foo.dom\" here. You can see the details of this CSR by using<br> <br> <code>$ openssl req -noout -text -in server.csr</code><br> <br> </li> <li>You now have to send this Certificate Signing Request (CSR) to a Certifying Authority (CA) to be signed. Once the CSR has been signed, you will have a real Certificate, which can be used by Apache. You can have a CSR signed by a commercial CA, or you can create your own CA to sign it.<br> Commercial CAs usually ask you to post the CSR into a web form, pay for the signing, and then send a signed Certificate, which you can store in a server.crt file.<br> For details on how to create your own CA, and use this to sign a CSR, see <a href=\"#ownca\">below</a>.<br> Once your CSR has been signed, you can see the details of the Certificate as follows:<br> <br> <code>$ openssl x509 -noout -text -in server.crt</code><br> </li> <li>You should now have two files: <code>server.key</code> and <code>server.crt</code>. These can be used as follows in your <code>httpd.conf</code> file: <pre class=\"prettyprint lang-config\">SSLCertificateFile    \"/path/to/this/server.crt\"\nSSLCertificateKeyFile \"/path/to/this/server.key\"</pre> The <code>server.csr</code> file is no longer needed. </li> </ol> <h3><a name=\"ownca\" id=\"ownca\">How do I create and use my own Certificate Authority (CA)?</a></h3> <p>The short answer is to use the <code>CA.sh</code> or <code>CA.pl</code> script provided by OpenSSL. Unless you have a good reason not to, you should use these for preference. If you cannot, you can create a self-signed certificate as follows:</p> <ol> <li>Create a RSA private key for your server (will be Triple-DES encrypted and PEM formatted):<br> <br> <code>$ openssl genrsa -des3 -out server.key 2048</code><br> <br> Please backup this <code>server.key</code> file and the pass-phrase you entered in a secure location. You can see the details of this RSA private key by using the command:<br> <br> <code>$ openssl rsa -noout -text -in server.key</code><br> <br> If necessary, you can also create a decrypted PEM version (not recommended) of this RSA private key with:<br> <br> <code>$ openssl rsa -in server.key -out server.key.unsecure</code><br> <br> </li> <li>Create a self-signed certificate (X509 structure) with the RSA key you just created (output will be PEM formatted):<br> <br> <code>$ openssl req -new -x509 -nodes -sha1 -days 365 -key server.key -out server.crt -extensions usr_cert</code><br> <br> This signs the server CSR and results in a <code>server.crt</code> file.<br> You can see the details of this Certificate using:<br> <br> <code>$ openssl x509 -noout -text -in server.crt</code><br> <br> </li> </ol> <h3><a name=\"passphrase\" id=\"passphrase\">How can I change the pass-phrase on my private key file?</a></h3> <p>You simply have to read it with the old pass-phrase and write it again, specifying the new pass-phrase. You can accomplish this with the following commands:</p> <p><code>$ openssl rsa -des3 -in server.key -out server.key.new</code><br> <code>$ mv server.key.new server.key</code><br></p> <p>The first time you're asked for a PEM pass-phrase, you should enter the old pass-phrase. After that, you'll be asked again to enter a pass-phrase - this time, use the new pass-phrase. If you are asked to verify the pass-phrase, you'll need to enter the new pass-phrase a second time.</p> <h3><a name=\"removepassphrase\" id=\"removepassphrase\">How can I get rid of the pass-phrase dialog at Apache startup time?</a></h3> <p>The reason this dialog pops up at startup and every re-start is that the RSA private key inside your server.key file is stored in encrypted format for security reasons. The pass-phrase is needed to decrypt this file, so it can be read and parsed. Removing the pass-phrase removes a layer of security from your server - proceed with caution!</p> <ol> <li>Remove the encryption from the RSA private key (while keeping a backup copy of the original file):<br> <br> <code>$ cp server.key server.key.org</code><br> <code>$ openssl rsa -in server.key.org -out server.key</code><br> <br> </li> <li>Make sure the server.key file is only readable by root:<br> <br> <code>$ chmod 400 server.key</code><br> <br> </li> </ol> <p>Now <code>server.key</code> contains an unencrypted copy of the key. If you point your server at this file, it will not prompt you for a pass-phrase. HOWEVER, if anyone gets this key they will be able to impersonate you on the net. PLEASE make sure that the permissions on this file are such that only root or the web server user can read it (preferably get your web server to start as root but run as another user, and have the key readable only by root).</p> <p>As an alternative approach you can use the ``<code>SSLPassPhraseDialog exec:/path/to/program</code>'' facility. Bear in mind that this is neither more nor less secure, of course.</p> <h3><a name=\"verify\" id=\"verify\">How do I verify that a private key matches its Certificate?</a></h3> <p>A private key contains a series of numbers. Two of these numbers form the \"public key\", the others are part of the \"private key\". The \"public key\" bits are included when you generate a CSR, and subsequently form part of the associated Certificate.</p> <p>To check that the public key in your Certificate matches the public portion of your private key, you simply need to compare these numbers. To view the Certificate and the key run the commands:</p> <p><code>$ openssl x509 -noout -text -in server.crt</code><br> <code>$ openssl rsa -noout -text -in server.key</code></p> <p>The `modulus' and the `public exponent' portions in the key and the Certificate must match. As the public exponent is usually 65537 and it's difficult to visually check that the long modulus numbers are the same, you can use the following approach:</p> <p><code>$ openssl x509 -noout -modulus -in server.crt | openssl md5</code><br> <code>$ openssl rsa -noout -modulus -in server.key | openssl md5</code></p> <p>This leaves you with two rather shorter numbers to compare. It is, in theory, possible that these numbers may be the same, without the modulus numbers being the same, but the chances of this are overwhelmingly remote.</p> <p>Should you wish to check to which key or certificate a particular CSR belongs you can perform the same calculation on the CSR as follows:</p> <pre>$ openssl req -noout -modulus -in server.csr | openssl md5</pre> <h3><a name=\"pemder\" id=\"pemder\">How can I convert a certificate from PEM to DER format?</a></h3> <p>The default certificate format for OpenSSL is PEM, which is simply Base64 encoded DER, with header and footer lines. For some applications (e.g. Microsoft Internet Explorer) you need the certificate in plain DER format. You can convert a PEM file <code>cert.pem</code> into the corresponding DER file <code>cert.der</code> using the following command: <code>$ openssl x509 -in cert.pem -out cert.der -outform DER</code></p> <h3><a name=\"gid\" id=\"gid\">Why do browsers complain that they cannot verify my server certificate?</a></h3> <p>One reason this might happen is because your server certificate is signed by an intermediate CA. Various CAs, such as Verisign or Thawte, have started signing certificates not with their root certificate but with intermediate certificates.</p> <p>Intermediate CA certificates lie between the root CA certificate (which is installed in the browsers) and the server certificate (which you installed on the server). In order for the browser to be able to traverse and verify the trust chain from the server certificate to the root certificate it needs need to be given the intermediate certificates. The CAs should be able to provide you such intermediate certificate packages that can be installed on the server.</p> <p>You need to include those intermediate certificates with the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslcertificatechainfile\">SSLCertificateChainFile</a></code> directive.</p>   <h2 id=\"aboutssl\">The SSL Protocol</h2> <ul> <li><a href=\"#random\">Why do I get lots of random SSL protocol errors under heavy server load?</a></li> <li><a href=\"#load\">Why does my webserver have a higher load, now that it serves SSL encrypted traffic?</a></li> <li><a href=\"#establishing\">Why do HTTPS connections to my server sometimes take up to 30 seconds to establish a connection?</a></li> <li><a href=\"#ciphers\">What SSL Ciphers are supported by mod_ssl?</a></li> <li><a href=\"#adh\">Why do I get ``no shared cipher'' errors, when trying to use Anonymous Diffie-Hellman (ADH) ciphers?</a></li> <li><a href=\"#sharedciphers\">Why do I get a 'no shared ciphers' error when connecting to my newly installed server?</a></li> <li><a href=\"#vhosts\">Why can't I use SSL with name-based/non-IP-based virtual hosts?</a></li> <li><a href=\"#vhosts2\">Is it possible to use Name-Based Virtual Hosting to identify different SSL virtual hosts?</a></li> <li><a href=\"#comp\">How do I get SSL compression working?</a></li> <li><a href=\"#lockicon\">When I use Basic Authentication over HTTPS the lock icon in Netscape browsers stays unlocked when the dialog pops up. Does this mean the username/password is being sent unencrypted?</a></li> <li><a href=\"#msie\">Why do I get I/O errors when connecting via HTTPS to an Apache+mod_ssl server with Microsoft Internet Explorer (MSIE)?</a></li> <li><a href=\"#srp\">How do I enable TLS-SRP?</a></li> <li><a href=\"#javadh\">Why do I get handshake failures with Java-based clients when using a certificate with more than 1024 bits?</a></li> </ul> <h3><a name=\"random\" id=\"random\">Why do I get lots of random SSL protocol errors under heavy server load?</a></h3> <p>There can be a number of reasons for this, but the main one is problems with the SSL session Cache specified by the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslsessioncache\">SSLSessionCache</a></code> directive. The DBM session cache is the most likely source of the problem, so using the SHM session cache (or no cache at all) may help.</p> <h3><a name=\"load\" id=\"load\">Why does my webserver have a higher load, now that it serves SSL encrypted traffic?</a></h3> <p>SSL uses strong cryptographic encryption, which necessitates a lot of number crunching. When you request a webpage via HTTPS, everything (even the images) is encrypted before it is transferred. So increased HTTPS traffic leads to load increases.</p> <h3><a name=\"establishing\" id=\"establishing\">Why do HTTPS connections to my server sometimes take up to 30 seconds to establish a connection?</a></h3> <p>This is usually caused by a <code>/dev/random</code> device for <code class=\"directive\"><a href=\"../mod/mod_ssl#sslrandomseed\">SSLRandomSeed</a></code> which blocks the read(2) call until enough entropy is available to service the request. More information is available in the reference manual for the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslrandomseed\">SSLRandomSeed</a></code> directive.</p> <h3><a name=\"ciphers\" id=\"ciphers\">What SSL Ciphers are supported by mod_ssl?</a></h3> <p>Usually, any SSL ciphers supported by the version of OpenSSL in use, are also supported by <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code>. Which ciphers are available can depend on the way you built OpenSSL. Typically, at least the following ciphers are supported:</p> <ol> <li>RC4 with SHA1</li> <li>AES with SHA1</li> <li>Triple-DES with SHA1</li> </ol> <p>To determine the actual list of ciphers available, you should run the following:</p> <div class=\"example\"><pre>$ openssl ciphers -v</pre></div> <h3><a name=\"adh\" id=\"adh\">Why do I get ``no shared cipher'' errors, when trying to use Anonymous Diffie-Hellman (ADH) ciphers?</a></h3> <p>By default, OpenSSL does <em>not</em> allow ADH ciphers, for security reasons. Please be sure you are aware of the potential side-effects if you choose to enable these ciphers.</p> <p>In order to use Anonymous Diffie-Hellman (ADH) ciphers, you must build OpenSSL with ``<code>-DSSL_ALLOW_ADH</code>'', and then add ``<code>ADH</code>'' into your <code class=\"directive\"><a href=\"../mod/mod_ssl#sslciphersuite\">SSLCipherSuite</a></code>.</p> <h3><a name=\"sharedciphers\" id=\"sharedciphers\">Why do I get a 'no shared ciphers' error when connecting to my newly installed server?</a></h3> <p>Either you have made a mistake with your <code class=\"directive\"><a href=\"../mod/mod_ssl#sslciphersuite\">SSLCipherSuite</a></code> directive (compare it with the pre-configured example in <code>extra/httpd-ssl.conf</code>) or you chose to use DSA/DH algorithms instead of RSA when you generated your private key and ignored or overlooked the warnings. If you have chosen DSA/DH, then your server cannot communicate using RSA-based SSL ciphers (at least until you configure an additional RSA-based certificate/key pair). Modern browsers like NS or IE can only communicate over SSL using RSA ciphers. The result is the \"no shared ciphers\" error. To fix this, regenerate your server certificate/key pair, using the RSA algorithm.</p> <h3><a name=\"vhosts\" id=\"vhosts\">Why can't I use SSL with name-based/non-IP-based virtual hosts?</a></h3> <p>The reason is very technical, and a somewhat \"chicken and egg\" problem. The SSL protocol layer stays below the HTTP protocol layer and encapsulates HTTP. When an SSL connection (HTTPS) is established Apache/mod_ssl has to negotiate the SSL protocol parameters with the client. For this, mod_ssl has to consult the configuration of the virtual server (for instance it has to look for the cipher suite, the server certificate, etc.). But in order to go to the correct virtual server Apache has to know the <code>Host</code> HTTP header field. To do this, the HTTP request header has to be read. This cannot be done before the SSL handshake is finished, but the information is needed in order to complete the SSL handshake phase. See the next question for how to circumvent this issue.</p> <p>Note that if you have a wildcard SSL certificate, or a certificate that has multiple hostnames on it using subjectAltName fields, you can use SSL on name-based virtual hosts without further workarounds.</p> <h3><a name=\"vhosts2\" id=\"vhosts2\">Is it possible to use Name-Based Virtual Hosting to identify different SSL virtual hosts?</a></h3> <p>Name-Based Virtual Hosting is a very popular method of identifying different virtual hosts. It allows you to use the same IP address and the same port number for many different sites. When people move on to SSL, it seems natural to assume that the same method can be used to have lots of different SSL virtual hosts on the same server.</p> <p>It is possible, but only if using a 2.2.12 or later web server, built with 0.9.8j or later OpenSSL. This is because it requires a feature that only the most recent revisions of the SSL specification added, called Server Name Indication (SNI).</p> <p>Note that if you have a wildcard SSL certificate, or a certificate that has multiple hostnames on it using subjectAltName fields, you can use SSL on name-based virtual hosts without further workarounds.</p> <p>The reason is that the SSL protocol is a separate layer which encapsulates the HTTP protocol. So the SSL session is a separate transaction, that takes place before the HTTP session has begun. The server receives an SSL request on IP address X and port Y (usually 443). Since the SSL request did not contain any Host: field, the server had no way to decide which SSL virtual host to use. Usually, it just used the first one it found which matched the port and IP address specified.</p> <p>If you are using a version of the web server and OpenSSL that support SNI, though, and the client's browser also supports SNI, then the hostname is included in the original SSL request, and the web server can select the correct SSL virtual host.</p> <p>You can, of course, use Name-Based Virtual Hosting to identify many non-SSL virtual hosts (all on port 80, for example) and then have a single SSL virtual host (on port 443). But if you do this, you must make sure to put the non-SSL port number on the NameVirtualHost directive, e.g.</p> <pre class=\"prettyprint lang-config\">NameVirtualHost 192.168.1.1:80</pre> <p>Other workaround solutions include: </p> <p>Using separate IP addresses for different SSL hosts. Using different port numbers for different SSL hosts.</p> <h3><a name=\"comp\" id=\"comp\">How do I get SSL compression working?</a></h3> <p>Although SSL compression negotiation was defined in the specification of SSLv2 and TLS, it took until May 2004 for RFC 3749 to define DEFLATE as a negotiable standard compression method. </p> <p>OpenSSL 0.9.8 started to support this by default when compiled with the <code>zlib</code> option. If both the client and the server support compression, it will be used. However, most clients still try to initially connect with an SSLv2 Hello. As SSLv2 did not include an array of preferred compression algorithms in its handshake, compression cannot be negotiated with these clients. If the client disables support for SSLv2, either an SSLv3 or TLS Hello may be sent, depending on which SSL library is used, and compression may be set up. You can verify whether clients make use of SSL compression by logging the <code>%{SSL_COMPRESS_METHOD}x</code> variable. </p> <h3><a name=\"lockicon\" id=\"lockicon\">When I use Basic Authentication over HTTPS the lock icon in Netscape browsers stays unlocked when the dialog pops up. Does this mean the username/password is being sent unencrypted?</a></h3> <p>No, the username/password is transmitted encrypted. The icon in Netscape browsers is not actually synchronized with the SSL/TLS layer. It only toggles to the locked state when the first part of the actual webpage data is transferred, which may confuse people. The Basic Authentication facility is part of the HTTP layer, which is above the SSL/TLS layer in HTTPS. Before any HTTP data communication takes place in HTTPS, the SSL/TLS layer has already completed its handshake phase, and switched to encrypted communication. So don't be confused by this icon.</p> <h3><a name=\"msie\" id=\"msie\">Why do I get I/O errors when connecting via HTTPS to an Apache+mod_ssl server with older versions of Microsoft Internet Explorer (MSIE)?</a></h3> <p>The first reason is that the SSL implementation in some MSIE versions has some subtle bugs related to the HTTP keep-alive facility and the SSL close notify alerts on socket connection close. Additionally the interaction between SSL and HTTP/1.1 features are problematic in some MSIE versions. You can work around these problems by forcing Apache not to use HTTP/1.1, keep-alive connections or send the SSL close notify messages to MSIE clients. This can be done by using the following directive in your SSL-aware virtual host section:</p> <pre class=\"prettyprint lang-config\">SetEnvIf User-Agent \"MSIE [2-5]\" \\\n         nokeepalive ssl-unclean-shutdown \\\n         downgrade-1.0 force-response-1.0</pre> <p>Further, some MSIE versions have problems with particular ciphers. Unfortunately, it is not possible to implement a MSIE-specific workaround for this, because the ciphers are needed as early as the SSL handshake phase. So a MSIE-specific <code class=\"directive\"><a href=\"../mod/mod_setenvif#setenvif\">SetEnvIf</a></code> won't solve these problems. Instead, you will have to make more drastic adjustments to the global parameters. Before you decide to do this, make sure your clients really have problems. If not, do not make these changes - they will affect <em>all</em> your clients, MSIE or otherwise.</p> <h3><a name=\"srp\" id=\"srp\">How do I enable TLS-SRP?</a></h3> <p>TLS-SRP (Secure Remote Password key exchange for TLS, specified in RFC 5054) can supplement or replace certificates in authenticating an SSL connection. To use TLS-SRP, set the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslsrpverifierfile\">SSLSRPVerifierFile</a></code> directive to point to an OpenSSL SRP verifier file. To create the verifier file, use the <code>openssl</code> tool:</p> <div class=\"example\"><pre>openssl srp -srpvfile passwd.srpv -add username</pre></div> <p>After creating this file, specify it in the SSL server configuration:</p> <div class=\"example\"><pre>SSLSRPVerifierFile /path/to/passwd.srpv</pre></div> <p>To force clients to use non-certificate TLS-SRP cipher suites, use the following directive:</p> <div class=\"example\"><pre>SSLCipherSuite \"!DSS:!aRSA:SRP\"</pre></div> <h3><a name=\"javadh\" id=\"javadh\">Why do I get handshake failures with Java-based clients when using a certificate with more than 1024 bits?</a></h3> <p>Beginning with version 2.4.7, <code class=\"module\"><a href=\"../mod/mod_ssl\">mod_ssl</a></code> will use DH parameters which include primes with lengths of more than 1024 bits. Java 7 and earlier limit their support for DH prime sizes to a maximum of 1024 bits, however.</p> <p>If your Java-based client aborts with exceptions such as <code>java.lang.RuntimeException: Could not generate DH keypair</code> and <code>java.security.InvalidAlgorithmParameterException: Prime size must be multiple of 64, and can only range from 512 to 1024 (inclusive)</code>, and httpd logs <code>tlsv1 alert internal error (SSL alert number 80)</code> (at <code class=\"directive\"><a href=\"../mod/core#loglevel\">LogLevel</a></code> <code>info</code> or higher), you can either rearrange mod_ssl's cipher list with <code class=\"directive\"><a href=\"../mod/mod_ssl#sslciphersuite\">SSLCipherSuite</a></code> (possibly in conjunction with <code class=\"directive\"><a href=\"../mod/mod_ssl#sslhonorcipherorder\">SSLHonorCipherOrder</a></code>), or you can use custom DH parameters with a 1024-bit prime, which will always have precedence over any of the built-in DH parameters.</p> <p>To generate custom DH parameters, use the <code>openssl dhparam 1024</code> command. Alternatively, you can use the following standard 1024-bit DH parameters from <a href=\"http://www.ietf.org/rfc/rfc2409.txt\">RFC 2409</a>, section 6.2:</p> <div class=\"example\"><pre>-----BEGIN DH PARAMETERS-----\nMIGHAoGBAP//////////yQ/aoiFowjTExmKLgNwc0SkCTgiKZ8x0Agu+pjsTmyJR\nSgh5jjQE3e+VGbPNOkMbMCsKbfJfFDdP4TVtbVHCReSFtXZiXn7G9ExC6aY37WsL\n/1y29Aa37e44a/taiZ+lrp8kEXxLH+ZJKGZR7OZTgf//////////AgEC\n-----END DH PARAMETERS-----</pre></div> <p>Add the custom parameters including the \"BEGIN DH PARAMETERS\" and \"END DH PARAMETERS\" lines to the end of the first certificate file you have configured using the <code class=\"directive\"><a href=\"../mod/mod_ssl#sslcertificatefile\">SSLCertificateFile</a></code> directive.</p>   <h2 id=\"support\">mod_ssl Support</h2> <ul> <li><a href=\"#resources\">What information resources are available in case of mod_ssl problems?</a></li> <li><a href=\"#contact\">What support contacts are available in case of mod_ssl problems?</a></li> <li><a href=\"#reportdetails\">What information should I provide when writing a bug report?</a></li> <li><a href=\"#coredumphelp\">I had a core dump, can you help me?</a></li> <li><a href=\"#backtrace\">How do I get a backtrace, to help find the reason for my core dump?</a></li> </ul> <h3><a name=\"resources\" id=\"resources\">What information resources are available in case of mod_ssl problems?</a></h3> <p>The following information resources are available. In case of problems you should search here first.</p> <dl> <dt>Answers in the User Manual's F.A.Q. List (this)</dt> <dd>\n<a href=\"http://httpd.apache.org/docs/2.4/ssl/ssl_faq.html\"> http://httpd.apache.org/docs/2.4/ssl/ssl_faq.html</a><br> First check the F.A.Q. (this text). If your problem is a common one, it may have been answered several times before, and been included in this doc. </dd> </dl> <h3><a name=\"contact\" id=\"contact\">What support contacts are available in case of mod_ssl problems?</a></h3> <p>The following lists all support possibilities for mod_ssl, in order of preference. Please go through these possibilities <em>in this order</em> - don't just pick the one you like the look of. </p> <ol> <li>\n<em>Send a Problem Report to the Apache httpd Users Support Mailing List</em><br> <a href=\"mailto:users@httpd.apache.org\"> users@httpd.apache.org</a><br> This is the second way of submitting your problem report. Again, you must subscribe to the list first, but you can then easily discuss your problem with the whole Apache httpd user community. </li> <li>\n<em>Write a Problem Report in the Bug Database</em><br> <a href=\"http://httpd.apache.org/bug_report.html\"> http://httpd.apache.org/bug_report.html</a><br> This is the last way of submitting your problem report. You should only do this if you've already posted to the mailing lists, and had no success. Please follow the instructions on the above page <em>carefully</em>. </li> </ol> <h3><a name=\"reportdetails\" id=\"reportdetails\">What information should I provide when writing a bug report?</a></h3> <p>You should always provide at least the following information:</p> <dl> <dt>Apache httpd and OpenSSL version information</dt> <dd>The Apache version can be determined by running <code>httpd -v</code>. The OpenSSL version can be determined by running <code>openssl version</code>. Alternatively, if you have Lynx installed, you can run the command <code>lynx -mime_header http://localhost/ | grep Server</code> to gather this information in a single step. </dd> <dt>The details on how you built and installed Apache httpd and OpenSSL</dt> <dd>For this you can provide a logfile of your terminal session which shows the configuration and install steps. If this is not possible, you should at least provide the <code class=\"program\"><a href=\"../programs/configure\">configure</a></code> command line you used. </dd> <dt>In case of core dumps please include a Backtrace</dt> <dd>If your Apache httpd dumps its core, please attach a stack-frame ``backtrace'' (see <a href=\"#backtrace\">below</a> for information on how to get this). This information is required in order to find a reason for your core dump. </dd> <dt>A detailed description of your problem</dt> <dd>Don't laugh, we really mean it! Many problem reports don't include a description of what the actual problem is. Without this, it's very difficult for anyone to help you. So, it's in your own interest (you want the problem be solved, don't you?) to include as much detail as possible, please. Of course, you should still include all the essentials above too. </dd> </dl> <h3><a name=\"coredumphelp\" id=\"coredumphelp\">I had a core dump, can you help me?</a></h3> <p>In general no, at least not unless you provide more details about the code location where Apache dumped core. What is usually always required in order to help you is a backtrace (see next question). Without this information it is mostly impossible to find the problem and help you in fixing it.</p> <h3><a name=\"backtrace\" id=\"backtrace\">How do I get a backtrace, to help find the reason for my core dump?</a></h3> <p>Following are the steps you will need to complete, to get a backtrace:</p> <ol> <li>Make sure you have debugging symbols available, at least in Apache. On platforms where you use GCC/GDB, you will have to build Apache+mod_ssl with ``<code>OPTIM=\"-g -ggdb3\"</code>'' to get this. On other platforms at least ``<code>OPTIM=\"-g\"</code>'' is needed. </li> <li>Start the server and try to reproduce the core-dump. For this you may want to use a directive like ``<code>CoreDumpDirectory /tmp</code>'' to make sure that the core-dump file can be written. This should result in a <code>/tmp/core</code> or <code>/tmp/httpd.core</code> file. If you don't get one of these, try running your server under a non-root UID. Many modern kernels do not allow a process to dump core after it has done a <code>setuid()</code> (unless it does an <code>exec()</code>) for security reasons (there can be privileged information left over in memory). If necessary, you can run <code>/path/to/httpd -X</code> manually to force Apache to not fork. </li> <li>Analyze the core-dump. For this, run <code>gdb /path/to/httpd /tmp/httpd.core</code> or a similar command. In GDB, all you have to do then is to enter <code>bt</code>, and voila, you get the backtrace. For other debuggers consult your local debugger manual. </li> </ol><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/ssl/ssl_faq.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/ssl/ssl_faq.html</a>\n  </p>\n</div>\n","rewrite/rewritemap":"<h1>Using RewriteMap</h1>  <p>This document supplements the <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> <a href=\"../mod/mod_rewrite\">reference documentation</a>. It describes the use of the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive, and provides examples of each of the various <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> types.</p> <div class=\"warning\">Note that many of these examples won't work unchanged in your particular server configuration, so it's important that you understand them, rather than merely cutting and pasting the examples into your configuration.</div>     <h2 id=\"introduction\">Introduction</h2> <p> The <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive defines an external function which can be called in the context of <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> or <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> directives to perform rewriting that is too complicated, or too specialized to be performed just by regular expressions. The source of this lookup can be any of the types listed in the sections below, and enumerated in the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> reference documentation.</p> <p>The syntax of the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive is as follows:</p> <pre class=\"prettyprint lang-config\">RewriteMap <em>MapName</em> <em>MapType</em>:<em>MapSource</em>\n</pre> <p>The <a id=\"mapfunc\" name=\"mapfunc\"><em>MapName</em></a> is an arbitray name that you assign to the map, and which you will use in directives later on. Arguments are passed to the map via the following syntax:</p> <p class=\"indent\"> <strong> <code>${</code> <em>MapName</em> <code>:</code> <em>LookupKey</em> <code>}</code> <br> <code>${</code> <em>MapName</em> <code>:</code> <em>LookupKey</em> <code>|</code> <em>DefaultValue</em> <code>}</code> </strong> </p> <p>When such a construct occurs, the map <em>MapName</em> is consulted and the key <em>LookupKey</em> is looked-up. If the key is found, the map-function construct is substituted by <em>SubstValue</em>. If the key is not found then it is substituted by <em>DefaultValue</em> or by the empty string if no <em>DefaultValue</em> was specified.</p> <p>For example, you can define a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> as:</p> <pre class=\"prettyprint lang-config\">RewriteMap examplemap \"txt:/path/to/file/map.txt\"</pre> <p>You would then be able to use this map in a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> as follows:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"^/ex/(.*)\" \"${examplemap:$1}\"</pre> <p>A default value can be specified in the event that nothing is found in the map:</p> <pre class=\"prettyprint lang-config\">RewriteRule \"^/ex/(.*)\" \"${examplemap:$1|/not_found.html}\"</pre> <div class=\"note\">\n<p><strong>Per-directory and .htaccess context</strong></p> <p> The <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive may not be used in <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> sections or <code>.htaccess</code> files. You must declare the map in server or virtualhost context. You may use the map, once created, in your <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> and <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritecond\">RewriteCond</a></code> directives in those scopes. You just can't <strong>declare</strong> it in those scopes.</p> </div> <p>The sections that follow describe the various <em>MapType</em>s that may be used, and give examples of each.</p>   <h2 id=\"int\">int: Internal Function</h2> <p>When a MapType of <code>int</code> is used, the MapSource is one of the available internal <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> functions. Module authors can provide additional internal functions by registering them with the <code>ap_register_rewrite_mapfunc</code> API. The functions that are provided by default are: </p> <ul> <li>\n<strong>toupper</strong>:<br> Converts the key to all upper case.</li> <li>\n<strong>tolower</strong>:<br> Converts the key to all lower case.</li> <li>\n<strong>escape</strong>:<br> Translates special characters in the key to hex-encodings.</li> <li>\n<strong>unescape</strong>:<br> Translates hex-encodings in the key back to special characters.</li> </ul> <p> To use one of these functions, create a <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> referencing the int function, and then use that in your <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code>: </p> <p> <strong>Redirect a URI to an all-lowercase version of itself</strong></p> <pre class=\"prettyprint lang-config\">RewriteMap lc int:tolower\nRewriteRule \"(.*)\" \"${lc:$1}\" [R]</pre> <div class=\"note\"> <p>Please note that the example offered here is for illustration purposes only, and is not a recommendation. If you want to make URLs case-insensitive, consider using <code class=\"module\"><a href=\"../mod/mod_speling\">mod_speling</a></code> instead. </p> </div>   <h2 id=\"txt\">txt: Plain text maps</h2> <p>When a MapType of <code>txt</code> is used, the MapSource is a filesystem path to a plain-text mapping file, containing one space-separated key/value pair per line. Optionally, a line may contain a comment, starting with a '#' character.</p> <p>A valid text rewrite map file will have the following syntax:</p> <div class=\"example\"><pre># Comment line\nMatchingKey SubstValue\nMatchingKey SubstValue # comment</pre></div> <p>When the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> is invoked the argument is looked for in the first argument of a line, and, if found, the substitution value is returned.</p> <p>For example, we can use a mapfile to translate product names to product IDs for easier-to-remember URLs, using the following recipe:</p> <p><strong>Product to ID configuration</strong></p> <pre class=\"prettyprint lang-config\">RewriteMap product2id \"txt:/etc/apache2/productmap.txt\"\nRewriteRule \"^/product/(.*)\" \"/prods.php?id=${product2id:$1|NOTFOUND}\" [PT]</pre> <p>We assume here that the <code>prods.php</code> script knows what to do when it received an argument of <code>id=NOTFOUND</code> when a product is not found in the lookup map.</p> <p>The file <code>/etc/apache2/productmap.txt</code> then contains the following:</p> <div class=\"example\">\n<h3>Product to ID map</h3>\n<pre>##\n## productmap.txt - Product to ID map file\n##\n\ntelevision 993\nstereo 198\nfishingrod 043\nbasketball 418\ntelephone 328</pre>\n</div> <p>Thus, when <code>http://example.com/product/television</code> is requested, the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> is applied, and the request is internally mapped to <code>/prods.php?id=993</code>.</p> <div class=\"note\">\n<p><strong>Note: .htaccess files</strong></p> The example given is crafted to be used in server or virtualhost scope. If you're planning to use this in a <code>.htaccess</code> file, you'll need to remove the leading slash from the rewrite pattern in order for it to match anything: <pre class=\"prettyprint lang-config\">RewriteRule \"^product/(.*)\" \"/prods.php?id=${product2id:$1|NOTFOUND}\" [PT]</pre> </div> <div class=\"note\">\n<p><strong>Cached lookups</strong></p> <p> The looked-up keys are cached by httpd until the <code>mtime</code> (modified time) of the mapfile changes, or the httpd server is restarted. This ensures better performance on maps that are called by many requests. </p> </div>   <h2 id=\"rnd\">rnd: Randomized Plain Text</h2> <p>When a MapType of <code>rnd</code> is used, the MapSource is a filesystem path to a plain-text mapping file, each line of which contains a key, and one or more values separated by <code>|</code>. One of these values will be chosen at random if the key is matched.</p> <p>For example, you can use the following map file and directives to provide a random load balancing between several back-end servers, via a reverse-proxy. Images are sent to one of the servers in the 'static' pool, while everything else is sent to one of the 'dynamic' pool.</p> <div class=\"example\">\n<h3>Rewrite map file</h3>\n<pre>##\n## map.txt -- rewriting map\n##\n\nstatic www1|www2|www3|www4\ndynamic www5|www6</pre>\n</div> <p><strong>Configuration directives</strong></p> <pre class=\"prettyprint lang-config\">RewriteMap servers \"rnd:/path/to/file/map.txt\"\n\nRewriteRule \"^/(.*\\.(png|gif|jpg))\" \"http://${servers:static}/$1\"  [NC,P,L]\nRewriteRule \"^/(.*)\"                \"http://${servers:dynamic}/$1\" [P,L]</pre> <p>So, when an image is requested and the first of these rules is matched, <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> looks up the string <code>static</code> in the map file, which returns one of the specified hostnames at random, which is then used in the <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> target.</p> <p>If you wanted to have one of the servers more likely to be chosen (for example, if one of the server has more memory than the others, and so can handle more requests) simply list it more times in the map file.</p> <div class=\"example\"><pre>static www1|www1|www2|www3|www4</pre></div>   <h2 id=\"dbm\">dbm: DBM Hash File</h2> <p>When a MapType of <code>dbm</code> is used, the MapSource is a filesystem path to a DBM database file containing key/value pairs to be used in the mapping. This works exactly the same way as the <code>txt</code> map, but is much faster, because a DBM is indexed, whereas a text file is not. This allows more rapid access to the desired key.</p> <p>You may optionally specify a particular dbm type:</p> <pre class=\"prettyprint lang-config\">RewriteMap examplemap \"dbm=sdbm:/etc/apache/mapfile.dbm\"</pre> <p>The type can be <code>sdbm</code>, <code>gdbm</code>, <code>ndbm</code> or <code>db</code>. However, it is recommended that you just use the <a href=\"../programs/httxt2dbm\">httxt2dbm</a> utility that is provided with Apache HTTP Server, as it will use the correct DBM library, matching the one that was used when httpd itself was built.</p> <p>To create a dbm file, first create a text map file as described in the <a href=\"#txt\">txt</a> section. Then run <code>httxt2dbm</code>:</p> <div class=\"example\"><pre>$ httxt2dbm -i mapfile.txt -o mapfile.map</pre></div> <p>You can then reference the resulting file in your <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive:</p> <pre class=\"prettyprint lang-config\">RewriteMap mapname \"dbm:/etc/apache/mapfile.map\"</pre> <div class=\"note\"> <p>Note that with some dbm types, more than one file is generated, with a common base name. For example, you may have two files named <code>mapfile.map.dir</code> and <code>mapfiile.map.pag</code>. This is normal, and you need only use the base name <code>mapfile.map</code> in your <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive.</p> </div> <div class=\"note\">\n<p><strong>Cached lookups</strong></p> <p> The looked-up keys are cached by httpd until the <code>mtime</code> (modified time) of the mapfile changes, or the httpd server is restarted. This ensures better performance on maps that are called by many requests. </p> </div>   <h2 id=\"prg\">prg: External Rewriting Program</h2> <p>When a MapType of <code>prg</code> is used, the MapSource is a filesystem path to an executable program which will providing the mapping behavior. This can be a compiled binary file, or a program in an interpreted language such as Perl or Python.</p> <p>This program is started once, when the Apache HTTP Server is started, and then communicates with the rewriting engine via <code>STDIN</code> and <code>STDOUT</code>. That is, for each map function lookup, it expects one argument via <code>STDIN</code>, and should return one new-line terminated response string on <code>STDOUT</code>. If there is no corresponding lookup value, the map program should return the four-character string \"<code>NULL</code>\" to indicate this.</p> <p>External rewriting programs are not started if they're defined in a context that does not have <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriteengine\">RewriteEngine</a></code> set to <code>on</code>.</p> <p>This feature utilizes the <code>rewrite-map</code> mutex, which is required for reliable communication with the program. The mutex mechanism and lock file can be configured with the <code class=\"directive\"><a href=\"../mod/core#mutex\">Mutex</a></code> directive.</p> <p>A simple example is shown here which will replace all dashes with underscores in a request URI.</p> <p><strong>Rewrite configuration</strong></p> <pre class=\"prettyprint lang-config\">RewriteMap d2u \"prg:/www/bin/dash2under.pl\"\nRewriteRule \"-\" \"${d2u:%{REQUEST_URI}}\"</pre> <p><strong>dash2under.pl</strong></p> <pre class=\"prettyprint lang-perl\">#!/usr/bin/perl\n$| = 1; # Turn off I/O buffering\nwhile (&lt;STDIN&gt;) {\n    s/-/_/g; # Replace dashes with underscores\n    print $_;\n}</pre> <div class=\"note\">\n<p><strong>Caution!</strong></p> <ul> <li>Keep your rewrite map program as simple as possible. If the program hangs, it will cause httpd to wait indefinitely for a response from the map, which will, in turn, cause httpd to stop responding to requests.</li> <li>Be sure to turn off buffering in your program. In Perl this is done by the second line in the example script: <code>$| = 1;</code> This will of course vary in other languages. Buffered I/O will cause httpd to wait for the output, and so it will hang.</li> <li>Remember that there is only one copy of the program, started at server startup. All requests will need to go through this one bottleneck. This can cause significant slowdowns if many requests must go through this process, or if the script itself is very slow.</li> </ul> </div>   <h2 id=\"dbd\">dbd or fastdbd: SQL Query</h2> <p>When a MapType of <code>dbd</code> or <code>fastdbd</code> is used, the MapSource is a SQL SELECT statement that takes a single argument and returns a single value.</p> <p><code class=\"module\"><a href=\"../mod/mod_dbd\">mod_dbd</a></code> will need to be configured to point at the right database for this statement to be executed.</p> <p>There are two forms of this MapType. Using a MapType of <code>dbd</code> causes the query to be executed with each map request, while using <code>fastdbd</code> caches the database lookups internally. So, while <code>fastdbd</code> is more efficient, and therefore faster, it won't pick up on changes to the database until the server is restarted.</p> <p>If a query returns more than one row, a random row from the result set is used.</p> <div class=\"example\">\n<h3>Example</h3>\n<pre class=\"prettyprint lang-config\">RewriteMap myquery \"fastdbd:SELECT destination FROM rewrite WHERE source = %s\"</pre> </div>   <h2 id=\"summary\">Summary</h2> <p>The <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive can occur more than once. For each mapping-function use one <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code> directive to declare its rewriting mapfile.</p> <p>While you cannot <strong>declare</strong> a map in per-directory context (<code>.htaccess</code> files or <code class=\"directive\"><a href=\"../mod/core#directory\">&lt;Directory&gt;</a></code> blocks) it is possible to <strong>use</strong> this map in per-directory context.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/rewrite/rewritemap.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/rewrite/rewritemap.html</a>\n  </p>\n</div>\n","vhosts/name-based":"<h1>Name-based Virtual Host Support</h1>  <p>This document describes when and how to use name-based virtual hosts.</p>     <h2 id=\"namevip\">Name-based vs. IP-based Virtual Hosts</h2> <p><a href=\"ip-based\">IP-based virtual hosts</a> use the IP address of the connection to determine the correct virtual host to serve. Therefore you need to have a separate IP address for each host.</p> <p>With name-based virtual hosting, the server relies on the client to report the hostname as part of the HTTP headers. Using this technique, many different hosts can share the same IP address.</p> <p>Name-based virtual hosting is usually simpler, since you need only configure your DNS server to map each hostname to the correct IP address and then configure the Apache HTTP Server to recognize the different hostnames. Name-based virtual hosting also eases the demand for scarce IP addresses. Therefore you should use name-based virtual hosting unless you are using equipment that explicitly demands IP-based hosting. Historical reasons for IP-based virtual hosting based on client support are no longer applicable to a general-purpose web server.</p> <p> Name-based virtual hosting builds off of the IP-based virtual host selection algorithm, meaning that searches for the proper server name occur only between virtual hosts that have the best IP-based address.</p>   <h2 id=\"alg\">How the server selects the proper name-based virtual host</h2> <p>It is important to recognize that the first step in name-based virtual host resolution is IP-based resolution. Name-based virtual host resolution only chooses the most appropriate name-based virtual host after narrowing down the candidates to the best IP-based match. Using a wildcard (*) for the IP address in all of the VirtualHost directives makes this IP-based mapping irrelevant.</p> <p>When a request arrives, the server will find the best (most specific) matching <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> argument based on the IP address and port used by the request. If there is more than one virtual host containing this best-match address and port combination, Apache will further compare the <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> and <code class=\"directive\"><a href=\"../mod/core#serveralias\">ServerAlias</a></code> directives to the server name present in the request.</p> <p>If you omit the <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> directive from any name-based virtual host, the server will default to a fully qualified domain name (FQDN) derived from the system hostname. This implicitly set server name can lead to counter-intuitive virtual host matching and is discouraged.</p> <h3><a name=\"defaultvhost\" id=\"defaultvhost\">The default name-based vhost for an IP and port combination </a></h3> <p> If no matching ServerName or ServerAlias is found in the set of virtual hosts containing the most specific matching IP address and port combination, then <strong>the first listed virtual host</strong> that matches that will be used.</p>   <h2 id=\"using\">Using Name-based Virtual Hosts</h2> <table class=\"related\">\n<tr>\n<th>Related Modules</th>\n<th>Related Directives</th>\n</tr>\n<tr>\n<td><ul><li><code class=\"module\"><a href=\"../mod/core\">core</a></code></li></ul></td>\n<td><ul>\n<li><code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#serveralias\">ServerAlias</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code></li>\n<li><code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code></li>\n</ul></td>\n</tr>\n</table> <p>The first step is to create a <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> block for each different host that you would like to serve. Inside each <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> block, you will need at minimum a <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> directive to designate which host is served and a <code class=\"directive\"><a href=\"../mod/core#documentroot\">DocumentRoot</a></code> directive to show where in the filesystem the content for that host lives.</p> <div class=\"note\">\n<p><strong>Main host goes away</strong></p> <p> Any request that doesn't match an existing <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> is handled by the global server configuration, regardless of the hostname or ServerName.</p> <p> When you add a name-based virtual host to an existing server, and the virtual host arguments match preexisting IP and port combinations, requests will now be handled by an explicit virtual host. In this case, it's usually wise to create a <a href=\"#defaultvhost\">default virtual host</a> with a <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> matching that of the base server. New domains on the same interface and port, but requiring separate configurations, can then be added as subsequent (non-default) virtual hosts.</p> </div> <div class=\"note\">\n<p><strong>ServerName inheritance</strong></p> <p> It is best to always explicitly list a <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> in every name-based virtual host.</p> <p>If a <code class=\"directive\"><a href=\"../mod/core#virtualhost\">VirtualHost</a></code> doesn't specify a <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code>, a server name will be inherited from the base server configuration. If no server name was specified globally, one is detected at startup through reverse DNS resolution of the first listening address. In either case, this inherited server name will influence name-based virtual host resolution, so it is best to always explicitly list a <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> in every name-based virtual host.</p> </div> <p>For example, suppose that you are serving the domain <code>www.example.com</code> and you wish to add the virtual host <code>other.example.com</code>, which points at the same IP address. Then you simply add the following to <code>httpd.conf</code>:</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost *:80&gt;\n    # This first-listed virtual host is also the default for *:80\n    ServerName www.example.com\n    ServerAlias example.com \n    DocumentRoot \"/www/domain\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:80&gt;\n    ServerName other.example.com\n    DocumentRoot \"/www/otherdomain\"\n&lt;/VirtualHost&gt;</pre> <p>You can alternatively specify an explicit IP address in place of the <code>*</code> in <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> directives. For example, you might want to do this in order to run some name-based virtual hosts on one IP address, and either IP-based, or another set of name-based virtual hosts on another address.</p> <p>Many servers want to be accessible by more than one name. This is possible with the <code class=\"directive\"><a href=\"../mod/core#serveralias\">ServerAlias</a></code> directive, placed inside the <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> section. For example in the first <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> block above, the <code class=\"directive\"><a href=\"../mod/core#serveralias\">ServerAlias</a></code> directive indicates that the listed names are other names which people can use to see that same web site:</p> <pre class=\"prettyprint lang-config\">ServerAlias example.com *.example.com</pre> <p>then requests for all hosts in the <code>example.com</code> domain will be served by the <code>www.example.com</code> virtual host. The wildcard characters <code>*</code> and <code>?</code> can be used to match names. Of course, you can't just make up names and place them in <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> or <code>ServerAlias</code>. You must first have your DNS server properly configured to map those names to an IP address associated with your server.</p> <p>Name-based virtual hosts for the best-matching set of <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;virtualhost&gt;</a></code>s are processed in the order they appear in the configuration. The first matching <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> or <code class=\"directive\"><a href=\"../mod/core#serveralias\">ServerAlias</a></code> is used, with no different precedence for wildcards (nor for ServerName vs. ServerAlias). </p> <p>The complete list of names in the <code class=\"directive\"><a href=\"../mod/core#virtualhost\">VirtualHost</a></code> directive are treated just like a (non wildcard) <code class=\"directive\"><a href=\"../mod/core#serveralias\">ServerAlias</a></code>.</p> <p>Finally, you can fine-tune the configuration of the virtual hosts by placing other directives inside the <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> containers. Most directives can be placed in these containers and will then change the configuration only of the relevant virtual host. To find out if a particular directive is allowed, check the Context of the directive. Configuration directives set in the <em>main server context</em> (outside any <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> container) will be used only if they are not overridden by the virtual host settings.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/vhosts/name-based.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/vhosts/name-based.html</a>\n  </p>\n</div>\n","vhosts/examples":"<h1>VirtualHost Examples</h1>  <p>This document attempts to answer the commonly-asked questions about setting up <a href=\"index\">virtual hosts</a>. These scenarios are those involving multiple web sites running on a single server, via <a href=\"name-based\">name-based</a> or <a href=\"ip-based\">IP-based</a> virtual hosts. </p>     <h2 id=\"purename\">Running several name-based web sites on a single IP address.</h2> <p>Your server has multiple hostnames that resolve to a single address, and you want to respond differently for <code>www.example.com</code> and <code>www.example.org</code>.</p> <div class=\"note\">\n<p><strong>Note</strong></p>\n<p>Creating virtual host configurations on your Apache server does not magically cause DNS entries to be created for those host names. You <em>must</em> have the names in DNS, resolving to your IP address, or nobody else will be able to see your web site. You can put entries in your <code>hosts</code> file for local testing, but that will work only from the machine with those <code>hosts</code> entries.</p> </div> <pre class=\"prettyprint lang-config\"># Ensure that Apache listens on port 80\nListen 80\n&lt;VirtualHost *:80&gt;\n    DocumentRoot \"/www/example1\"\n    ServerName www.example.com\n\n    # Other directives here\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:80&gt;\n    DocumentRoot \"/www/example2\"\n    ServerName www.example.org\n\n    # Other directives here\n&lt;/VirtualHost&gt;</pre> <p>The asterisks match all addresses, so the main server serves no requests. Due to the fact that the virtual host with <code>ServerName www.example.com</code> is first in the configuration file, it has the highest priority and can be seen as the <cite>default</cite> or <cite>primary</cite> server. That means that if a request is received that does not match one of the specified <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> directives, it will be served by this first <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code>.</p> <p>The above configuration is what you will want to use in almost all name-based virtual hosting situations. The only thing that this configuration will not work for, in fact, is when you are serving different content based on differing IP addresses or ports.</p> <div class=\"note\"> <p><strong>Note</strong></p> <p>You may replace <code>*</code> with a specific IP address on the system. Such virtual hosts will only be used for HTTP requests received on connection to the specified IP address.</p> <p>However, it is additionally useful to use <code>*</code> on systems where the IP address is not predictable - for example if you have a dynamic IP address with your ISP, and you are using some variety of dynamic DNS solution. Since <code>*</code> matches any IP address, this configuration would work without changes whenever your IP address changes.</p> </div>   <h2 id=\"twoips\">Name-based hosts on more than one IP address.</h2> <div class=\"note\"> <p><strong>Note</strong></p> <p>Any of the techniques discussed here can be extended to any number of IP addresses.</p> </div> <p>The server has two IP addresses. On one (<code>172.20.30.40</code>), we will serve the \"main\" server, <code>server.example.com</code> and on the other (<code>172.20.30.50</code>), we will serve two or more virtual hosts.</p> <pre class=\"prettyprint lang-config\">Listen 80\n\n# This is the \"main\" server running on 172.20.30.40\nServerName server.example.com\nDocumentRoot \"/www/mainserver\"\n\n&lt;VirtualHost 172.20.30.50&gt;\n    DocumentRoot \"/www/example1\"\n    ServerName www.example.com\n\n    # Other directives here ...\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.50&gt;\n    DocumentRoot \"/www/example2\"\n    ServerName www.example.org\n\n    # Other directives here ...\n&lt;/VirtualHost&gt;</pre> <p>Any request to an address other than <code>172.20.30.50</code> will be served from the main server. A request to <code>172.20.30.50</code> with an unknown hostname, or no <code>Host:</code> header, will be served from <code>www.example.com</code>.</p>   <h2 id=\"intraextra\">Serving the same content on different IP addresses (such as an internal and external address).</h2> <p>The server machine has two IP addresses (<code>192.168.1.1</code> and <code>172.20.30.40</code>). The machine is sitting between an internal (intranet) network and an external (internet) network. Outside of the network, the name <code>server.example.com</code> resolves to the external address (<code>172.20.30.40</code>), but inside the network, that same name resolves to the internal address (<code>192.168.1.1</code>).</p> <p>The server can be made to respond to internal and external requests with the same content, with just one <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> section.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost 192.168.1.1 172.20.30.40&gt;\n    DocumentRoot \"/www/server1\"\n    ServerName server.example.com\n    ServerAlias server\n&lt;/VirtualHost&gt;</pre> <p>Now requests from both networks will be served from the same <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code>.</p> <div class=\"note\"> <p><strong>Note:</strong></p>\n<p>On the internal network, one can just use the name <code>server</code> rather than the fully qualified host name <code>server.example.com</code>.</p> <p>Note also that, in the above example, you can replace the list of IP addresses with <code>*</code>, which will cause the server to respond the same on all addresses.</p> </div>   <h2 id=\"port\">Running different sites on different ports.</h2> <p>You have multiple domains going to the same IP and also want to serve multiple ports. The example below illustrates that the name-matching takes place after the best matching IP address and port combination is determined.</p> <pre class=\"prettyprint lang-config\">Listen 80\nListen 8080\n\n&lt;VirtualHost 172.20.30.40:80&gt;\n    ServerName www.example.com\n    DocumentRoot \"/www/domain-80\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40:8080&gt;\n    ServerName www.example.com\n    DocumentRoot \"/www/domain-8080\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40:80&gt;\n    ServerName www.example.org\n    DocumentRoot \"/www/otherdomain-80\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40:8080&gt;\n    ServerName www.example.org\n    DocumentRoot \"/www/otherdomain-8080\"\n&lt;/VirtualHost&gt;</pre>   <h2 id=\"ip\">IP-based virtual hosting</h2> <p>The server has two IP addresses (<code>172.20.30.40</code> and <code>172.20.30.50</code>) which resolve to the names <code>www.example.com</code> and <code>www.example.org</code> respectively.</p> <pre class=\"prettyprint lang-config\">Listen 80\n\n&lt;VirtualHost 172.20.30.40&gt;\n    DocumentRoot \"/www/example1\"\n    ServerName www.example.com\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.50&gt;\n    DocumentRoot \"/www/example2\"\n    ServerName www.example.org\n&lt;/VirtualHost&gt;</pre> <p>Requests for any address not specified in one of the <code>&lt;VirtualHost&gt;</code> directives (such as <code>localhost</code>, for example) will go to the main server, if there is one.</p>   <h2 id=\"ipport\">Mixed port-based and ip-based virtual hosts</h2> <p>The server machine has two IP addresses (<code>172.20.30.40</code> and <code>172.20.30.50</code>) which resolve to the names <code>www.example.com</code> and <code>www.example.org</code> respectively. In each case, we want to run hosts on ports 80 and 8080.</p> <pre class=\"prettyprint lang-config\">Listen 172.20.30.40:80\nListen 172.20.30.40:8080\nListen 172.20.30.50:80\nListen 172.20.30.50:8080\n\n&lt;VirtualHost 172.20.30.40:80&gt;\n    DocumentRoot \"/www/example1-80\"\n    ServerName www.example.com\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40:8080&gt;\n    DocumentRoot \"/www/example1-8080\"\n    ServerName www.example.com\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.50:80&gt;\n    DocumentRoot \"/www/example2-80\"\n    ServerName www.example.org\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.50:8080&gt;\n    DocumentRoot \"/www/example2-8080\"\n    ServerName www.example.org\n&lt;/VirtualHost&gt;</pre>   <h2 id=\"mixed\">Mixed name-based and IP-based vhosts</h2> <p>Any address mentioned in the argument to a virtualhost that never appears in another virtual host is a strictly IP-based virtual host.</p> <pre class=\"prettyprint lang-config\">Listen 80\n&lt;VirtualHost 172.20.30.40&gt;\n    DocumentRoot \"/www/example1\"\n    ServerName www.example.com\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40&gt;\n    DocumentRoot \"/www/example2\"\n    ServerName www.example.org\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40&gt;\n    DocumentRoot \"/www/example3\"\n    ServerName www.example.net\n&lt;/VirtualHost&gt;\n\n# IP-based\n&lt;VirtualHost 172.20.30.50&gt;\n    DocumentRoot \"/www/example4\"\n    ServerName www.example.edu\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.60&gt;\n    DocumentRoot \"/www/example5\"\n    ServerName www.example.gov\n&lt;/VirtualHost&gt;</pre>   <h2 id=\"proxy\">Using <code>Virtual_host</code> and mod_proxy together</h2> <p>The following example allows a front-end machine to proxy a virtual host through to a server running on another machine. In the example, a virtual host of the same name is configured on a machine at <code>192.168.111.2</code>. The <code class=\"directive\"><a href=\"../mod/mod_proxy#proxypreservehost\">ProxyPreserveHost On</a></code> directive is used so that the desired hostname is passed through, in case we are proxying multiple hostnames to a single machine.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost *:*&gt;\n    ProxyPreserveHost On\n    ProxyPass        \"/\" \"http://192.168.111.2/\"\n    ProxyPassReverse \"/\" \"http://192.168.111.2/\"\n    ServerName hostname.example.com\n&lt;/VirtualHost&gt;</pre>   <h2 id=\"default\">Using <code>_default_</code> vhosts</h2> <h3><a name=\"defaultallports\" id=\"defaultallports\"><code>_default_</code> vhosts for all ports</a></h3> <p>Catching <em>every</em> request to any unspecified IP address and port, <em>i.e.</em>, an address/port combination that is not used for any other virtual host.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost _default_:*&gt;\n    DocumentRoot \"/www/default\"\n&lt;/VirtualHost&gt;</pre> <p>Using such a default vhost with a wildcard port effectively prevents any request going to the main server.</p> <p>A default vhost never serves a request that was sent to an address/port that is used for name-based vhosts. If the request contained an unknown or no <code>Host:</code> header it is always served from the primary name-based vhost (the vhost for that address/port appearing first in the configuration file).</p> <p>You can use <code class=\"directive\"><a href=\"../mod/mod_alias#aliasmatch\">AliasMatch</a></code> or <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> to rewrite any request to a single information page (or script).</p> <h3><a name=\"defaultdifferentports\" id=\"defaultdifferentports\"><code>_default_</code> vhosts for different ports</a></h3> <p>Same as setup 1, but the server listens on several ports and we want to use a second <code>_default_</code> vhost for port 80.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost _default_:80&gt;\n    DocumentRoot \"/www/default80\"\n    # ...\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost _default_:*&gt;\n    DocumentRoot \"/www/default\"\n    # ...\n&lt;/VirtualHost&gt;</pre> <p>The default vhost for port 80 (which <em>must</em> appear before any default vhost with a wildcard port) catches all requests that were sent to an unspecified IP address. The main server is never used to serve a request.</p> <h3><a name=\"defaultoneport\" id=\"defaultoneport\"><code>_default_</code> vhosts for one port</a></h3> <p>We want to have a default vhost for port 80, but no other default vhosts.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost _default_:80&gt;\n    DocumentRoot \"/www/default\"\n...\n&lt;/VirtualHost&gt;</pre> <p>A request to an unspecified address on port 80 is served from the default vhost. Any other request to an unspecified address and port is served from the main server.</p> <p>Any use of <code>*</code> in a virtual host declaration will have higher precedence than <code>_default_</code>.</p>   <h2 id=\"migrate\">Migrating a name-based vhost to an IP-based vhost</h2> <p>The name-based vhost with the hostname <code>www.example.org</code> (from our <a href=\"#name\">name-based</a> example, setup 2) should get its own IP address. To avoid problems with name servers or proxies who cached the old IP address for the name-based vhost we want to provide both variants during a migration phase.</p> <p> The solution is easy, because we can simply add the new IP address (<code>172.20.30.50</code>) to the <code>VirtualHost</code> directive.</p> <pre class=\"prettyprint lang-config\">Listen 80\nServerName www.example.com\nDocumentRoot \"/www/example1\"\n\n&lt;VirtualHost 172.20.30.40 172.20.30.50&gt;\n    DocumentRoot \"/www/example2\"\n    ServerName www.example.org\n    # ...\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40&gt;\n    DocumentRoot \"/www/example3\"\n    ServerName www.example.net\n    ServerAlias *.example.net\n    # ...\n&lt;/VirtualHost&gt;</pre> <p>The vhost can now be accessed through the new address (as an IP-based vhost) and through the old address (as a name-based vhost).</p>   <h2 id=\"serverpath\">Using the <code>ServerPath</code> directive</h2> <p>We have a server with two name-based vhosts. In order to match the correct virtual host a client must send the correct <code>Host:</code> header. Old HTTP/1.0 clients do not send such a header and Apache has no clue what vhost the client tried to reach (and serves the request from the primary vhost). To provide as much backward compatibility as possible we create a primary vhost which returns a single page containing links with an URL prefix to the name-based virtual hosts.</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost 172.20.30.40&gt;\n    # primary vhost\n    DocumentRoot \"/www/subdomain\"\n    RewriteEngine On\n    RewriteRule \".\" \"/www/subdomain/index.html\"\n    # ...\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40&gt;\n    DocumentRoot \"/www/subdomain/sub1\"\n    ServerName www.sub1.domain.tld\n    ServerPath \"/sub1/\"\n    RewriteEngine On\n    RewriteRule \"^(/sub1/.*)\" \"/www/subdomain$1\"\n    # ...\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 172.20.30.40&gt;\n    DocumentRoot \"/www/subdomain/sub2\"\n    ServerName www.sub2.domain.tld\n    ServerPath \"/sub2/\"\n    RewriteEngine On\n    RewriteRule \"^(/sub2/.*)\" \"/www/subdomain$1\"\n    # ...\n&lt;/VirtualHost&gt;</pre> <p>Due to the <code class=\"directive\"><a href=\"../mod/core#serverpath\">ServerPath</a></code> directive a request to the URL <code>http://www.sub1.domain.tld/sub1/</code> is <em>always</em> served from the sub1-vhost.<br> A request to the URL <code>http://www.sub1.domain.tld/</code> is only served from the sub1-vhost if the client sent a correct <code>Host:</code> header. If no <code>Host:</code> header is sent the client gets the information page from the primary host.</p> <p>Please note that there is one oddity: A request to <code>http://www.sub2.domain.tld/sub1/</code> is also served from the sub1-vhost if the client sent no <code>Host:</code> header.</p> <p>The <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> directives are used to make sure that a client which sent a correct <code>Host:</code> header can use both URL variants, <em>i.e.</em>, with or without URL prefix.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/vhosts/examples.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/vhosts/examples.html</a>\n  </p>\n</div>\n","vhosts/mass":"<h1>Dynamically Configured Mass Virtual Hosting</h1>  <p>This document describes how to efficiently serve an arbitrary number of virtual hosts with the Apache HTTP Server. A <a href=\"../rewrite/vhosts\">separate document</a> discusses using <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code> to create dynamic mass virtual hosts. </p>     <h2 id=\"motivation\">Motivation</h2> <p>The techniques described here are of interest if your <code>httpd.conf</code> contains many <code>&lt;VirtualHost&gt;</code> sections that are substantially the same, for example:</p> <pre class=\"prettyprint lang-config\">&lt;VirtualHost 111.22.33.44&gt;\n    ServerName                 customer-1.example.com\n    DocumentRoot        \"/www/hosts/customer-1.example.com/docs\"\n    ScriptAlias  \"/cgi-bin/\"  \"/www/hosts/customer-1.example.com/cgi-bin\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 111.22.33.44&gt;\n    ServerName                 customer-2.example.com\n    DocumentRoot        \"/www/hosts/customer-2.example.com/docs\"\n    ScriptAlias  \"/cgi-bin/\"  \"/www/hosts/customer-2.example.com/cgi-bin\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 111.22.33.44&gt;\n    ServerName                 customer-N.example.com\n    DocumentRoot        \"/www/hosts/customer-N.example.com/docs\"\n    ScriptAlias  \"/cgi-bin/\"  \"/www/hosts/customer-N.example.com/cgi-bin\"\n&lt;/VirtualHost&gt;</pre> <p>We wish to replace these multiple <code>&lt;VirtualHost&gt;</code> blocks with a mechanism that works them out dynamically. This has a number of advantages:</p> <ol> <li>Your configuration file is smaller, so Apache starts more quickly and uses less memory. Perhaps more importantly, the smaller configuration is easier to maintain, and leaves less room for errors.</li> <li>Adding virtual hosts is simply a matter of creating the appropriate directories in the filesystem and entries in the DNS - you don't need to reconfigure or restart Apache.</li> </ol> <p>The main disadvantage is that you cannot have a different log file for each virtual host; however, if you have many virtual hosts, doing this can be a bad idea anyway, because of the <a href=\"fd-limits\">number of file descriptors needed</a>. It is better to <a href=\"../logs#piped\">log to a pipe or a fifo</a>, and arrange for the process at the other end to split up the log files into one per virtual host. One example of such a process can be found in the <a href=\"https://httpd.apache.org/docs/2.4/en/programs/other.html#split-logfile\">split-logfile</a> utility.</p>   <h2 id=\"overview\">Overview</h2> <p>A virtual host is defined by two pieces of information: its IP address, and the contents of the <code>Host:</code> header in the HTTP request. The dynamic mass virtual hosting technique used here is based on automatically inserting this information into the pathname of the file that is used to satisfy the request. This can be most easily done by using <code class=\"module\"><a href=\"../mod/mod_vhost_alias\">mod_vhost_alias</a></code> with Apache httpd. Alternatively, <a href=\"../rewrite/vhosts\">mod_rewrite can be used</a>.</p> <p>Both of these modules are disabled by default; you must enable one of them when configuring and building Apache httpd if you want to use this technique.</p> <p>A couple of things need to be determined from the request in order to make the dynamic virtual host look like a normal one. The most important is the server name, which is used by the server to generate self-referential URLs etc. It is configured with the <code>ServerName</code> directive, and it is available to CGIs via the <code>SERVER_NAME</code> environment variable. The actual value used at run time is controlled by the <code class=\"directive\"><a href=\"../mod/core#usecanonicalname\">UseCanonicalName</a></code> setting. With <code>UseCanonicalName Off</code>, the server name is taken from the contents of the <code>Host:</code> header in the request. With <code>UseCanonicalName DNS</code>, it is taken from a reverse DNS lookup of the virtual host's IP address. The former setting is used for name-based dynamic virtual hosting, and the latter is used for IP-based hosting. If httpd cannot work out the server name because there is no <code>Host:</code> header, or the DNS lookup fails, then the value configured with <code>ServerName</code> is used instead.</p> <p>The other thing to determine is the document root (configured with <code>DocumentRoot</code> and available to CGI scripts via the <code>DOCUMENT_ROOT</code> environment variable). In a normal configuration, this is used by the core module when mapping URIs to filenames, but when the server is configured to do dynamic virtual hosting, that job must be taken over by another module (either <code class=\"module\"><a href=\"../mod/mod_vhost_alias\">mod_vhost_alias</a></code> or <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>), which has a different way of doing the mapping. Neither of these modules is responsible for setting the <code>DOCUMENT_ROOT</code> environment variable so if any CGIs or SSI documents make use of it, they will get a misleading value.</p>   <h2 id=\"simple\">Dynamic Virtual Hosts with mod_vhost_alias</h2> <p>This extract from <code>httpd.conf</code> implements the virtual host arrangement outlined in the <a href=\"#motivation\">Motivation</a> section above using <code class=\"module\"><a href=\"../mod/mod_vhost_alias\">mod_vhost_alias</a></code>.</p> <pre class=\"prettyprint lang-config\"># get the server name from the Host: header\nUseCanonicalName Off\n\n# this log format can be split per-virtual-host based on the first field\n# using the split-logfile utility.\nLogFormat \"%V %h %l %u %t \\\"%r\\\" %s %b\" vcommon\nCustomLog \"logs/access_log\" vcommon\n\n# include the server name in the filenames used to satisfy requests\nVirtualDocumentRoot \"/www/hosts/%0/docs\"\nVirtualScriptAlias  \"/www/hosts/%0/cgi-bin\"</pre> <p>This configuration can be changed into an IP-based virtual hosting solution by just turning <code>UseCanonicalName Off</code> into <code>UseCanonicalName DNS</code>. The server name that is inserted into the filename is then derived from the IP address of the virtual host. The variable <code>%0</code> references the requested servername, as indicated in the <code>Host:</code> header.</p> <p>See the <code class=\"module\"><a href=\"../mod/mod_vhost_alias\">mod_vhost_alias</a></code> documentation for more usage examples.</p>   <h2 id=\"homepages\">Simplified Dynamic Virtual Hosts</h2> <p>This is an adjustment of the above system, tailored for an ISP's web hosting server. Using <code>%2</code>, we can select substrings of the server name to use in the filename so that, for example, the documents for <code>www.user.example.com</code> are found in <code>/home/user/www</code>. It uses a single <code>cgi-bin</code> directory instead of one per virtual host.</p> <pre class=\"prettyprint lang-config\">UseCanonicalName Off\n\nLogFormat \"%V %h %l %u %t \\\"%r\\\" %s %b\" vcommon\nCustomLog logs/access_log vcommon\n\n# include part of the server name in the filenames\nVirtualDocumentRoot \"/home/%2/www\"\n\n# single cgi-bin directory\nScriptAlias  \"/cgi-bin/\"  \"/www/std-cgi/\"</pre> <p>There are examples of more complicated <code>VirtualDocumentRoot</code> settings in the <code class=\"module\"><a href=\"../mod/mod_vhost_alias\">mod_vhost_alias</a></code> documentation.</p>   <h2 id=\"combinations\">Using Multiple Virtual Hosting Systems on the Same Server</h2> <p>With more complicated setups, you can use httpd's normal <code>&lt;VirtualHost&gt;</code> directives to control the scope of the various virtual hosting configurations. For example, you could have one IP address for general customers' homepages, and another for commercial customers, with the following setup. This can be combined with conventional <code>&lt;VirtualHost&gt;</code> configuration sections, as shown below.</p> <pre class=\"prettyprint lang-config\">UseCanonicalName Off\n\nLogFormat \"%V %h %l %u %t \\\"%r\\\" %s %b\" vcommon\n\n&lt;Directory \"/www/commercial\"&gt;\n    Options FollowSymLinks\n    AllowOverride All\n&lt;/Directory&gt;\n\n&lt;Directory \"/www/homepages\"&gt;\n    Options FollowSymLinks\n    AllowOverride None\n&lt;/Directory&gt;\n\n&lt;VirtualHost 111.22.33.44&gt;\n    ServerName www.commercial.example.com\n    \n    CustomLog \"logs/access_log.commercial\" vcommon\n    \n    VirtualDocumentRoot \"/www/commercial/%0/docs\"\n    VirtualScriptAlias  \"/www/commercial/%0/cgi-bin\"\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost 111.22.33.45&gt;\n    ServerName www.homepages.example.com\n    \n    CustomLog \"logs/access_log.homepages\" vcommon\n    \n    VirtualDocumentRoot \"/www/homepages/%0/docs\"\n    ScriptAlias         \"/cgi-bin/\" \"/www/std-cgi/\"\n&lt;/VirtualHost&gt;</pre> <div class=\"note\"> <p><strong>Note</strong></p> <p>If the first VirtualHost block does <em>not</em> include a <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> directive, the reverse DNS of the relevant IP will be used instead. If this is not the server name you wish to use, a bogus entry (eg. <code>ServerName none.example.com</code>) can be added to get around this behaviour.</p> </div>   <h2 id=\"ipbased\">More Efficient IP-Based Virtual Hosting</h2> <p>The configuration changes suggested to turn <a href=\"#simple\">the first example</a> into an IP-based virtual hosting setup result in a rather inefficient setup. A new DNS lookup is required for every request. To avoid this overhead, the filesystem can be arranged to correspond to the IP addresses, instead of to the host names, thereby negating the need for a DNS lookup. Logging will also have to be adjusted to fit this system.</p> <pre class=\"prettyprint lang-config\"># get the server name from the reverse DNS of the IP address\nUseCanonicalName DNS\n\n# include the IP address in the logs so they may be split\nLogFormat \"%A %h %l %u %t \\\"%r\\\" %s %b\" vcommon\nCustomLog \"logs/access_log\" vcommon\n\n# include the IP address in the filenames\nVirtualDocumentRootIP \"/www/hosts/%0/docs\"\nVirtualScriptAliasIP  \"/www/hosts/%0/cgi-bin\"</pre>   <h2 id=\"rewrite\">Mass virtual hosts with mod_rewrite</h2> <p> Mass virtual hosting may also be accomplished using <code class=\"module\"><a href=\"../mod/mod_rewrite\">mod_rewrite</a></code>, either using simple <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewriterule\">RewriteRule</a></code> directives, or using more complicated techniques such as storing the vhost definitions externally and accessing them via <code class=\"directive\"><a href=\"../mod/mod_rewrite#rewritemap\">RewriteMap</a></code>. These techniques are discussed in the <a href=\"../rewrite/vhosts\">rewrite documentation</a>.</p><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/vhosts/mass.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/vhosts/mass.html</a>\n  </p>\n</div>\n","vhosts/details":"<h1>An In-Depth Discussion of Virtual Host Matching</h1>  <p>This document attempts to explain exactly what Apache HTTP Server does when deciding what virtual host to serve a request from.</p> <p>Most users should read about <a href=\"name-based#namevip\"> Name-based vs. IP-based Virtual Hosts</a> to decide which type they want to use, then read more about <a href=\"name-based\">name-based</a> or <a href=\"ip-based\">IP-based</a> virtualhosts, and then see <a href=\"examples\">some examples</a>.</p> <p>If you want to understand all the details, then you can come back to this page.</p>     <h2 id=\"configparsing\">Configuration File</h2> <p>There is a <em>main server</em> which consists of all the definitions appearing outside of <code>&lt;VirtualHost&gt;</code> sections.</p> <p>There are virtual servers, called <em>vhosts</em>, which are defined by <code class=\"directive\"><a href=\"../mod/core#virtualhost\">&lt;VirtualHost&gt;</a></code> sections.</p> <p>Each <code>VirtualHost</code> directive includes one or more addresses and optional ports.</p> <p>Hostnames can be used in place of IP addresses in a virtual host definition, but they are resolved at startup and if any name resolutions fail, those virtual host definitions are ignored. This is, therefore, not recommended.</p> <p>The address can be specified as <code>*</code>, which will match a request if no other vhost has the explicit address on which the request was received. </p> <p>The address appearing in the <code>VirtualHost</code> directive can have an optional port. If the port is unspecified, it is treated as a wildcard port, which can also be indicated explicitly using <code>*</code>. The wildcard port matches any port.</p> <p>(Port numbers specified in the <code>VirtualHost</code> directive do not influence what port numbers Apache will listen on, they only control which <code>VirtualHost</code> will be selected to handle a request. Use the <code class=\"directive\"><a href=\"../mod/mpm_common#listen\">Listen</a></code> directive to control the addresses and ports on which the server listens.) </p> <p>Collectively the entire set of addresses (including multiple results from DNS lookups) are called the vhost's <em>address set</em>.</p> <p>Apache automatically discriminates on the basis of the HTTP <code>Host</code> header supplied by the client whenever the most specific match for an IP address and port combination is listed in multiple virtual hosts.</p> <p>The <code class=\"directive\"><a href=\"../mod/core#servername\">ServerName</a></code> directive may appear anywhere within the definition of a server. However, each appearance overrides the previous appearance (within that server). If no <code>ServerName</code> is specified, the server attempts to deduce it from the server's IP address.</p> <p>The first name-based vhost in the configuration file for a given IP:port pair is significant because it is used for all requests received on that address and port for which no other vhost for that IP:port pair has a matching ServerName or ServerAlias. It is also used for all SSL connections if the server does not support <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#servernameindication\" title=\"see glossary\">Server Name Indication</a>.</p> <p>The complete list of names in the <code>VirtualHost</code> directive are treated just like a (non wildcard) <code>ServerAlias</code> (but are not overridden by any <code>ServerAlias</code> statement).</p> <p>For every vhost various default values are set. In particular:</p> <ol> <li>If a vhost has no <code class=\"directive\"><a href=\"../mod/core#serveradmin\">ServerAdmin</a></code>, <code class=\"directive\"><a href=\"../mod/core#timeout\">Timeout</a></code>, <code class=\"directive\"><a href=\"../mod/core#keepalivetimeout\">KeepAliveTimeout</a></code>, <code class=\"directive\"><a href=\"../mod/core#keepalive\">KeepAlive</a></code>, <code class=\"directive\"><a href=\"../mod/core#maxkeepaliverequests\">MaxKeepAliveRequests</a></code>, <code class=\"directive\"><a href=\"../mod/mpm_common#receivebuffersize\">ReceiveBufferSize</a></code>, or <code class=\"directive\"><a href=\"../mod/mpm_common#sendbuffersize\">SendBufferSize</a></code> directive then the respective value is inherited from the main server. (That is, inherited from whatever the final setting of that value is in the main server.)</li> <li>The \"lookup defaults\" that define the default directory permissions for a vhost are merged with those of the main server. This includes any per-directory configuration information for any module.</li> <li>The per-server configs for each module from the main server are merged into the vhost server.</li> </ol> <p>Essentially, the main server is treated as \"defaults\" or a \"base\" on which to build each vhost. But the positioning of these main server definitions in the config file is largely irrelevant -- the entire config of the main server has been parsed when this final merging occurs. So even if a main server definition appears after a vhost definition it might affect the vhost definition.</p> <p>If the main server has no <code>ServerName</code> at this point, then the hostname of the machine that <code class=\"program\"><a href=\"../programs/httpd\">httpd</a></code> is running on is used instead. We will call the <em>main server address set</em> those IP addresses returned by a DNS lookup on the <code>ServerName</code> of the main server.</p> <p>For any undefined <code>ServerName</code> fields, a name-based vhost defaults to the address given first in the <code>VirtualHost</code> statement defining the vhost.</p> <p>Any vhost that includes the magic <code>_default_</code> wildcard is given the same <code>ServerName</code> as the main server.</p>   <h2 id=\"hostmatching\">Virtual Host Matching</h2> <p>The server determines which vhost to use for a request as follows:</p> <h3><a name=\"hashtable\" id=\"hashtable\">IP address lookup</a></h3> <p>When the connection is first received on some address and port, the server looks for all the <code>VirtualHost</code> definitions that have the same IP address and port.</p> <p>If there are no exact matches for the address and port, then wildcard (<code>*</code>) matches are considered.</p> <p>If no matches are found, the request is served by the main server.</p> <p>If there are <code>VirtualHost</code> definitions for the IP address, the next step is to decide if we have to deal with an IP-based or a name-based vhost.</p> <h3><a name=\"ipbased\" id=\"ipbased\">IP-based vhost</a></h3> <p>If there is exactly one <code>VirtualHost</code> directive listing the IP address and port combination that was determined to be the best match, no further actions are performed and the request is served from the matching vhost.</p> <h3><a name=\"namebased\" id=\"namebased\">Name-based vhost</a></h3> <p>If there are multiple <code>VirtualHost</code> directives listing the IP address and port combination that was determined to be the best match, the \"list\" in the remaining steps refers to the list of vhosts that matched, in the order they were in the configuration file.</p> <p>If the connection is using SSL, the server supports <a class=\"glossarylink\" href=\"https://httpd.apache.org/docs/2.4/en/glossary.html#servernameindication\" title=\"see glossary\">Server Name Indication</a>, and the SSL client handshake includes the TLS extension with the requested hostname, then that hostname is used below just like the <code>Host:</code> header would be used on a non-SSL connection. Otherwise, the first name-based vhost whose address matched is used for SSL connections. This is significant because the vhost determines which certificate the server will use for the connection.</p> <p>If the request contains a <code>Host:</code> header field, the list is searched for the first vhost with a matching <code>ServerName</code> or <code>ServerAlias</code>, and the request is served from that vhost. A <code>Host:</code> header field can contain a port number, but Apache always ignores it and matches against the real port to which the client sent the request.</p> <p>The first vhost in the config file with the specified IP address has the highest priority and catches any request to an unknown server name, or a request without a <code>Host:</code> header field (such as a HTTP/1.0 request).</p> <h3><a name=\"persistent\" id=\"persistent\">Persistent connections</a></h3> <p>The <em>IP lookup</em> described above is only done <em>once</em> for a particular TCP/IP session while the <em>name lookup</em> is done on <em>every</em> request during a KeepAlive/persistent connection. In other words, a client may request pages from different name-based vhosts during a single persistent connection.</p> <h3><a name=\"absoluteURI\" id=\"absoluteURI\">Absolute URI</a></h3> <p>If the URI from the request is an absolute URI, and its hostname and port match the main server or one of the configured virtual hosts <em>and</em> match the address and port to which the client sent the request, then the scheme/hostname/port prefix is stripped off and the remaining relative URI is served by the corresponding main server or virtual host. If it does not match, then the URI remains untouched and the request is taken to be a proxy request.</p> <h3><a name=\"observations\" id=\"observations\">Observations</a></h3> <ul> <li>Name-based virtual hosting is a process applied after the server has selected the best matching IP-based virtual host.</li> <li>If you don't care what IP address the client has connected to, use a \"*\" as the address of every virtual host, and name-based virtual hosting is applied across all configured virtual hosts.</li> <li>\n<code>ServerName</code> and <code>ServerAlias</code> checks are never performed for an IP-based vhost.</li> <li>Only the ordering of name-based vhosts for a specific address set is significant. The one name-based vhosts that comes first in the configuration file has the highest priority for its corresponding address set.</li> <li>Any port in the <code>Host:</code> header field is never used during the matching process. Apache always uses the real port to which the client sent the request.</li> <li>If two vhosts have an address in common, those common addresses act as name-based virtual hosts implicitly. This is new behavior as of 2.3.11.</li> <li>The main server is only used to serve a request if the IP address and port number to which the client connected does not match any vhost (including a <code>*</code> vhost). In other words, the main server only catches a request for an unspecified address/port combination (unless there is a <code>_default_</code> vhost which matches that port).</li> <li>You should never specify DNS names in <code>VirtualHost</code> directives because it will force your server to rely on DNS to boot. Furthermore it poses a security threat if you do not control the DNS for all the domains listed. There's <a href=\"../dns-caveats\">more information</a> available on this and the next two topics.</li> <li>\n<code>ServerName</code> should always be set for each vhost. Otherwise A DNS lookup is required for each vhost.</li> </ul>   <h2 id=\"tips\">Tips</h2> <p>In addition to the tips on the <a href=\"../dns-caveats#tips\">DNS Issues</a> page, here are some further tips:</p> <ul> <li>Place all main server definitions before any <code>VirtualHost</code> definitions. (This is to aid the readability of the configuration -- the post-config merging process makes it non-obvious that definitions mixed in around virtual hosts might affect all virtual hosts.)</li> </ul><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/vhosts/details.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/vhosts/details.html</a>\n  </p>\n</div>\n","misc/relevant_standards":"<h1>Relevant Standards</h1>  <p>This page documents all the relevant standards that the Apache HTTP Server follows, along with brief descriptions.</p> <p>In addition to the information listed below, the following resources should be consulted:</p> <ul> <li> <a href=\"http://purl.org/NET/http-errata\"> http://purl.org/NET/http-errata</a> - HTTP/1.1 Specification Errata </li> <li> <a href=\"http://www.rfc-editor.org/errata.php\"> http://www.rfc-editor.org/errata.php</a> - RFC Errata </li> <li> <a href=\"http://ftp.ics.uci.edu/pub/ietf/http/#RFC\"> http://ftp.ics.uci.edu/pub/ietf/http/#RFC</a> - A pre-compiled list of HTTP related RFCs </li> </ul> <div class=\"warning\">\n<p><strong>Notice</strong></p> <p>This document is not yet complete.</p> </div>     <h2 id=\"http_recommendations\">HTTP Recommendations</h2> <p>Regardless of what modules are compiled and used, Apache as a basic web server complies with the following IETF recommendations:</p> <dl> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/rfc1945.txt\">RFC 1945</a> (Informational)</dt> <dd>The Hypertext Transfer Protocol (HTTP) is an application-level protocol with the lightness and speed necessary for distributed, collaborative, hypermedia information systems. This documents HTTP/1.0.</dd> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/rfc2616.txt\">RFC 2616</a> (Standards Track)</dt> <dd>The Hypertext Transfer Protocol (HTTP) is an application-level protocol for distributed, collaborative, hypermedia information systems. This documents HTTP/1.1.</dd> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/rfc2396.txt\">RFC 2396</a> (Standards Track)</dt> <dd>A Uniform Resource Identifier (URI) is a compact string of characters for identifying an abstract or physical resource.</dd> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/rfc4346.txt\">RFC 4346</a> (Standards Track)</dt> <dd>The TLS protocol provides communications security over the Internet. It provides encryption, and is designed to prevent eavesdropping, tampering, and message forgery.</dd> </dl>   <h2 id=\"html_recommendations\">HTML Recommendations</h2> <p>Regarding the Hypertext Markup Language, Apache complies with the following IETF and W3C recommendations:</p> <dl> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/rfc2854.txt\">RFC 2854</a> (Informational)</dt> <dd>This document summarizes the history of HTML development, and defines the \"text/html\" MIME type by pointing to the relevant W3C recommendations.</dd> <dt>\n<a href=\"http://www.w3.org/TR/html401\">HTML 4.01 Specification</a> (<a href=\"http://www.w3.org/MarkUp/html4-updates/errata\">Errata</a>) </dt> <dd>This specification defines the HyperText Markup Language (HTML), the publishing language of the World Wide Web. This specification defines HTML 4.01, which is a subversion of HTML 4.</dd> <dt><a href=\"http://www.w3.org/TR/REC-html32\">HTML 3.2 Reference Specification</a></dt> <dd>The HyperText Markup Language (HTML) is a simple markup language used to create hypertext documents that are portable from one platform to another. HTML documents are SGML documents.</dd> <dt>\n<a href=\"http://www.w3.org/TR/xhtml11/\">XHTML 1.1 - Module-based XHTML</a> (<a href=\"http://www.w3.org/MarkUp/2009/xhtml11-2nd-edition-errata.html\">Errata</a>) </dt> <dd>This Recommendation defines a new XHTML document type that is based upon the module framework and modules defined in Modularization of XHTML.</dd> <dt>\n<a href=\"http://www.w3.org/TR/xhtml1\">XHTML 1.0 The Extensible HyperText Markup Language (Second Edition)</a> (<a href=\"http://www.w3.org/2002/08/REC-xhtml1-20020801-errata/\">Errata</a>) </dt> <dd>This specification defines the Second Edition of XHTML 1.0, a reformulation of HTML 4 as an XML 1.0 application, and three DTDs corresponding to the ones defined by HTML 4.</dd> </dl>   <h2 id=\"authentication\">Authentication</h2> <p>Concerning the different methods of authentication, Apache follows the following IETF recommendations:</p> <dl> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/rfc2617.txt\">RFC 2617</a> (Standards Track)</dt> <dd>\"HTTP/1.0\", includes the specification for a Basic Access Authentication scheme.</dd> </dl>   <h2 id=\"language_country_codes\">Language/Country Codes</h2> <p>The following links document ISO and other language and country code information:</p> <dl> <dt><a href=\"http://www.loc.gov/standards/iso639-2/\">ISO 639-2</a></dt> <dd>ISO 639 provides two sets of language codes, one as a two-letter code set (639-1) and another as a three-letter code set (this part of ISO 639) for the representation of names of languages.</dd> <dt><a href=\"http://www.iso.ch/iso/en/prods-services/iso3166ma/02iso-3166-code-lists/index.html\"> ISO 3166-1</a></dt> <dd>These pages document the country names (official short names in English) in alphabetical order as given in ISO 3166-1 and the corresponding ISO 3166-1-alpha-2 code elements.</dd> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/bcp/bcp47.txt\">BCP 47</a> (Best Current Practice), <a href=\"http://www.rfc-editor.org/rfc/rfc3066.txt\">RFC 3066</a>\n</dt> <dd>This document describes a language tag for use in cases where it is desired to indicate the language used in an information object, how to register values for use in this language tag, and a construct for matching such language tags.</dd> <dt>\n<a href=\"http://www.rfc-editor.org/rfc/rfc3282.txt\">RFC 3282</a> (Standards Track)</dt> <dd>This document defines a \"Content-language:\" header, for use in cases where one desires to indicate the language of something that has RFC 822-like headers, like MIME body parts or Web documents, and an \"Accept-Language:\" header for use in cases where one wishes to indicate one's preferences with regard to language.</dd> </dl><div class=\"_attribution\">\n  <p class=\"_attribution-p\">\n    &copy; 2016 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>\n    <a href=\"https://httpd.apache.org/docs/2.4/en/misc/relevant_standards.html\" class=\"_attribution-link\">https://httpd.apache.org/docs/2.4/en/misc/relevant_standards.html</a>\n  </p>\n</div>\n"}